<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta name="generator" content="Source Insight Version 4.00.0084 Built on 2017-02-26">
<meta charset='UTF-8' />
<style type='text/css'><!--
TD {background-color: #C0C0C0; font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 70%; }
.blurb {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 70%; }
.filename {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 120%; font-weight: bold; }
.dirname {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 100%; font-weight: bold; margin-top: 2.5em;}
--></style>
<title>src\backend\utils\adt\varbit.c</title>
<LINK REL=StyleSheet HREF="../../../../C_Cpp_Source_File.css" TYPE='text/css' MEDIA=screen>
</head>
<body bgcolor=#ffffff>
<table bgcolor='#c0c0c0' width='100%'>
<tr><td><p class='filename'><b>src\backend\utils\adt\varbit.c</b></p></td>
<td align='right'>
Wed Jun 14 08:25:55 2017
</td></tr>
<tr><td><a href='../../../../Contents.html'>Contents</a></td></tr>
</table>
<pre>
</span><span class='Comment_Multi_Line'>/*------------------------------------------------------------------------- 
 * 
 * varbit.c 
 *    Functions for the SQL datatypes BIT() and BIT VARYING(). 
 * 
 * Code originally contributed by Adriaan Joubert. 
 * 
 * Portions Copyright (c) 1996-2017, PostgreSQL Global Development Group 
 * Portions Copyright (c) 1994, Regents of the University of California 
 * 
 * IDENTIFICATION 
 *    src/backend/utils/adt/varbit.c 
 * 
 *------------------------------------------------------------------------- 
 */ 
</span> 
<span class='Keyword'>#include </span><span class='String'>"postgres.h"</span> 
 
<span class='Keyword'>#include </span><span class='String'>"access/htup_details.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"libpq/pqformat.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"nodes/nodeFuncs.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"utils/array.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"utils/builtins.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"utils/varbit.h"</span> 
 
<a name="LN25"></a><span class='Keyword'>#define </span><span class='Declare_Macro'>HEXDIG</span><span class='Parentheses'>(</span><span class='Declare_Parameter'>z</span><span class='Parentheses'>)</span>    <span class='Parentheses'>((</span><a href="varbit.c.html#LN25"><span class='Ref_to_Parameter'>z</span></a><span class='Parentheses'>)</span><span class='Operator'>&LT;</span><span class='Number'>10</span> <span class='Operator'>? </span><span class='Parentheses'>((</span><a href="varbit.c.html#LN25"><span class='Ref_to_Parameter'>z</span></a><span class='Parentheses'>)</span><span class='Operator'>+</span><span class='String'>'0'</span><span class='Parentheses'>)</span> <span class='Operator'>: </span><span class='Parentheses'>((</span><a href="varbit.c.html#LN25"><span class='Ref_to_Parameter'>z</span></a><span class='Parentheses'>)</span><span class='Operator'>-</span><span class='Number'>10</span><span class='Operator'>+</span><span class='String'>'A'</span><span class='Parentheses'>))</span> 
 
<a name="LN27"></a><span class='Keyword'>static </span><a href="../../../include/utils/varbit.h.html#LN24"><span class='Ref_to_Typedef'>VarBit</span></a> <span class='Operator'>*</span><span class='Declare_Prototype'>bit_catenate</span><span class='Parentheses'>(</span><a href="../../../include/utils/varbit.h.html#LN24"><span class='Ref_to_Typedef'>VarBit</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>arg1</span><span class='Delimiter'>, </span><a href="../../../include/utils/varbit.h.html#LN24"><span class='Ref_to_Typedef'>VarBit</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>arg2</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN28"></a><span class='Keyword'>static </span><a href="../../../include/utils/varbit.h.html#LN24"><span class='Ref_to_Typedef'>VarBit</span></a> <span class='Operator'>*</span><span class='Declare_Prototype'>bitsubstring</span><span class='Parentheses'>(</span><a href="../../../include/utils/varbit.h.html#LN24"><span class='Ref_to_Typedef'>VarBit</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>arg</span><span class='Delimiter'>, </span><a href="../../../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a> <span class='Declare_Parameter'>s</span><span class='Delimiter'>, </span><a href="../../../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a> <span class='Declare_Parameter'>l</span><span class='Delimiter'>, 
</span><a name="LN29"></a>             <span class='Keyword'>bool </span><span class='Declare_Parameter'>length_not_specified</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN30"></a><span class='Keyword'>static </span><a href="../../../include/utils/varbit.h.html#LN24"><span class='Ref_to_Typedef'>VarBit</span></a> <span class='Operator'>*</span><span class='Declare_Prototype'>bit_overlay</span><span class='Parentheses'>(</span><a href="../../../include/utils/varbit.h.html#LN24"><span class='Ref_to_Typedef'>VarBit</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>t1</span><span class='Delimiter'>, </span><a href="../../../include/utils/varbit.h.html#LN24"><span class='Ref_to_Typedef'>VarBit</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>t2</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>sp</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>sl</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
 
<span class='Comment_Multi_Line'>/* 
 * common code for bittypmodin and varbittypmodin 
 */ 
</span><span class='Keyword'>static </span><a href="../../../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a> 
<a name="LN37"></a><span class='Declare_Function'>anybit_typmodin</span><span class='Parentheses'>(</span><a href="../../../include/utils/array.h.html#LN75"><span class='Ref_to_Typedef'>ArrayType</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>ta</span><span class='Delimiter'>, </span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>typename</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN39"></a>    <a href="../../../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>       <span class='Declare_Local'>typmod</span><span class='Delimiter'>; 
</span><a name="LN40"></a>    <a href="../../../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>tl</span><span class='Delimiter'>; 
</span><a name="LN41"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>n</span><span class='Delimiter'>; 
</span> 
    <a href="varbit.c.html#LN40"><span class='Ref_To_Local'>tl</span></a> <span class='Operator'>= </span><a href="arrayutils.c.html#LN198"><span class='Ref_to_Func'>ArrayGetIntegerTypmods</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN37"><span class='Ref_to_Parameter'>ta</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="varbit.c.html#LN41"><span class='Ref_To_Local'>n</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * we're not too tense about good error message here because grammar 
     * shouldn't allow wrong number of modifiers for BIT 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="varbit.c.html#LN41"><span class='Ref_To_Local'>n</span></a> <span class='Operator'>!= </span><span class='Number'>1</span><span class='Parentheses'>) 
</span>        <a href="../../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INVALID_PARAMETER_VALUE<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"invalid type modifier"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="varbit.c.html#LN40"><span class='Ref_To_Local'>tl</span></a> <span class='Operator'>&LT; </span><span class='Number'>1</span><span class='Parentheses'>) 
</span>        <a href="../../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INVALID_PARAMETER_VALUE<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"length for type %s must be at least 1"</span><span class='Delimiter'>, 
</span>                        <span class='Keyword'>typename</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="varbit.c.html#LN40"><span class='Ref_To_Local'>tl</span></a> <span class='Operator'>&GT; </span><span class='Parentheses'>(</span><a href="../../../include/access/htup_details.h.html#LN585"><span class='Ref_to_Const'>MaxAttrSize</span></a> <span class='Operator'>* </span><a href="../../../include/pg_config_manual.h.html#LN105"><span class='Ref_to_Const'>BITS_PER_BYTE</span></a><span class='Parentheses'>))</span> 
        <a href="../../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INVALID_PARAMETER_VALUE<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"length for type %s cannot exceed %d"</span><span class='Delimiter'>, 
</span>                        <span class='Keyword'>typename</span><span class='Delimiter'>, </span><a href="../../../include/access/htup_details.h.html#LN585"><span class='Ref_to_Const'>MaxAttrSize</span></a> <span class='Operator'>* </span><a href="../../../include/pg_config_manual.h.html#LN105"><span class='Ref_to_Const'>BITS_PER_BYTE</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
    <a href="varbit.c.html#LN39"><span class='Ref_To_Local'>typmod</span></a> <span class='Operator'>= *</span><a href="varbit.c.html#LN40"><span class='Ref_To_Local'>tl</span></a><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="varbit.c.html#LN39"><span class='Ref_To_Local'>typmod</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end anybit_typmodin &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * common code for bittypmodout and varbittypmodout 
 */ 
</span><span class='Keyword'>static char </span><span class='Operator'>* 
</span><a name="LN74"></a><span class='Declare_Function'>anybit_typmodout</span><span class='Parentheses'>(</span><a href="../../../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a> <span class='Declare_Parameter'>typmod</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN76"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>res</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Keyword'>char </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><span class='Number'>64</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="varbit.c.html#LN74"><span class='Ref_to_Parameter'>typmod</span></a> <span class='Operator'>&GT;= </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>        <a href="../../../pl/plperl/plperl.h.html#LN60"><span class='Ref_to_Macro'>snprintf</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN76"><span class='Ref_To_Local'>res</span></a><span class='Delimiter'>, </span><span class='Number'>64</span><span class='Delimiter'>, </span><span class='String'>"(%d)"</span><span class='Delimiter'>, </span><a href="varbit.c.html#LN74"><span class='Ref_to_Parameter'>typmod</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
        <span class='Operator'>*</span><a href="varbit.c.html#LN76"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><span class='String'>'\0'</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="varbit.c.html#LN76"><span class='Ref_To_Local'>res</span></a><span class='Delimiter'>; 
} 
</span> 
 
<span class='Comment_Multi_Line'>/*---------- 
 *  attypmod -- contains the length of the bit string in bits, or for 
 *             varying bits the maximum length. 
 * 
 *  The data structure contains the following elements: 
 *    header  -- length of the whole data structure (incl header) 
 *               in bytes. (as with all varying length datatypes) 
 *    data section -- private data section for the bits data structures 
 *      bitlength -- length of the bit string in bits 
 *      bitdata   -- bit string, most significant byte first 
 * 
 *  The length of the bitdata vector should always be exactly as many 
 *  bytes as are needed for the given bitlength.  If the bitlength is 
 *  not a multiple of 8, the extra low-order padding bits of the last 
 *  byte must be zeroes. 
 *---------- 
 */ 
</span> 
<span class='Comment_Multi_Line'>/* 
 * bit_in - 
 *    converts a char string to the internal representation of a bitstring. 
 *        The length is determined by the number of bits required plus 
 *        VARHDRSZ bytes or from atttypmod. 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN112"></a><span class='Declare_Function'>bit_in</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN114"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>input_string</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN241"><span class='Ref_to_Macro'>PG_GETARG_CSTRING</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
<span class='Directive'>#ifdef</span> NOT_USED 
<a name="LN117"></a>    <a href="../../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>typelem</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN239"><span class='Ref_to_Macro'>PG_GETARG_OID</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><span class='Directive'>#endif</span> 
<a name="LN119"></a>    <a href="../../../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>       <span class='Declare_Local'>atttypmod</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN233"><span class='Ref_to_Macro'>PG_GETARG_INT32</span></a><span class='Parentheses'>(</span><span class='Number'>2</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN120"></a>    <a href="../../../include/utils/varbit.h.html#LN24"><span class='Ref_to_Typedef'>VarBit</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>result</span><span class='Delimiter'>;</span>         <span class='Comment_Single_Line'>/* The resulting bit string           */ 
</span><a name="LN121"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>sp</span><span class='Delimiter'>;</span>             <span class='Comment_Single_Line'>/* pointer into the character string  */ 
</span><a name="LN122"></a>    <a href="../../../include/c.h.html#LN274"><span class='Ref_to_Typedef'>bits8</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>r</span><span class='Delimiter'>;</span>              <span class='Comment_Single_Line'>/* pointer into the result */ 
</span><a name="LN123"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>len</span><span class='Delimiter'>,</span>            <span class='Comment_Single_Line'>/* Length of the whole data structure */ 
</span><a name="LN124"></a>                <span class='Declare_Local'>bitlen</span><span class='Delimiter'>,</span>         <span class='Comment_Single_Line'>/* Number of bits in the bit string   */ 
</span><a name="LN125"></a>                <span class='Declare_Local'>slen</span><span class='Delimiter'>;</span>           <span class='Comment_Single_Line'>/* Length of the input string         */ 
</span><a name="LN126"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>bit_not_hex</span><span class='Delimiter'>;</span>    <span class='Comment_Single_Line'>/* false = hex string  true = bit string */ 
</span><a name="LN127"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>bc</span><span class='Delimiter'>; 
</span><a name="LN128"></a>    <a href="../../../include/c.h.html#LN274"><span class='Ref_to_Typedef'>bits8</span></a>       <span class='Declare_Local'>x</span> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Check that the first character is a b or an x */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="varbit.c.html#LN114"><span class='Ref_To_Local'>input_string</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>] </span><span class='Operator'>== </span><span class='String'>'b'</span> <span class='Operator'>|| </span><a href="varbit.c.html#LN114"><span class='Ref_To_Local'>input_string</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>] </span><span class='Operator'>== </span><span class='String'>'B'</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="varbit.c.html#LN126"><span class='Ref_To_Local'>bit_not_hex</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>        <a href="varbit.c.html#LN121"><span class='Ref_To_Local'>sp</span></a> <span class='Operator'>= </span><a href="varbit.c.html#LN114"><span class='Ref_To_Local'>input_string</span></a> <span class='Operator'>+ </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="varbit.c.html#LN114"><span class='Ref_To_Local'>input_string</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>] </span><span class='Operator'>== </span><span class='String'>'x'</span> <span class='Operator'>|| </span><a href="varbit.c.html#LN114"><span class='Ref_To_Local'>input_string</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>] </span><span class='Operator'>== </span><span class='String'>'X'</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="varbit.c.html#LN126"><span class='Ref_To_Local'>bit_not_hex</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>        <a href="varbit.c.html#LN121"><span class='Ref_To_Local'>sp</span></a> <span class='Operator'>= </span><a href="varbit.c.html#LN114"><span class='Ref_To_Local'>input_string</span></a> <span class='Operator'>+ </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* 
         * Otherwise it's binary.  This allows things like cast('1001' as bit) 
         * to work transparently. 
         */ 
</span>        <a href="varbit.c.html#LN126"><span class='Ref_To_Local'>bit_not_hex</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>        <a href="varbit.c.html#LN121"><span class='Ref_To_Local'>sp</span></a> <span class='Operator'>= </span><a href="varbit.c.html#LN114"><span class='Ref_To_Local'>input_string</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Determine bitlength from input string.  MaxAllocSize ensures a regular 
     * input is small enough, but we must check hex input. 
     */ 
</span>    <a href="varbit.c.html#LN125"><span class='Ref_To_Local'>slen</span></a> <span class='Operator'>= </span>strlen<span class='Parentheses'>(</span><a href="varbit.c.html#LN121"><span class='Ref_To_Local'>sp</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="varbit.c.html#LN126"><span class='Ref_To_Local'>bit_not_hex</span></a><span class='Parentheses'>) 
</span>        <a href="varbit.c.html#LN124"><span class='Ref_To_Local'>bitlen</span></a> <span class='Operator'>= </span><a href="varbit.c.html#LN125"><span class='Ref_To_Local'>slen</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="varbit.c.html#LN125"><span class='Ref_To_Local'>slen</span></a> <span class='Operator'>&GT; </span><a href="../../../include/utils/varbit.h.html#LN62"><span class='Ref_to_Const'>VARBITMAXLEN</span></a> <span class='Operator'>/ </span><span class='Number'>4</span><span class='Parentheses'>) 
</span>            <a href="../../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                    <span class='Parentheses'>(</span><a href="../../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_PROGRAM_LIMIT_EXCEEDED<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"bit string length exceeds the maximum allowed (%d)"</span><span class='Delimiter'>, 
</span>                        <a href="../../../include/utils/varbit.h.html#LN62"><span class='Ref_to_Const'>VARBITMAXLEN</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>        <a href="varbit.c.html#LN124"><span class='Ref_To_Local'>bitlen</span></a> <span class='Operator'>= </span><a href="varbit.c.html#LN125"><span class='Ref_To_Local'>slen</span></a> <span class='Operator'>* </span><span class='Number'>4</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Sometimes atttypmod is not supplied. If it is supplied we need to make 
     * sure that the bitstring fits. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="varbit.c.html#LN119"><span class='Ref_To_Local'>atttypmod</span></a> <span class='Operator'>&LT;= </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>        <a href="varbit.c.html#LN119"><span class='Ref_To_Local'>atttypmod</span></a> <span class='Operator'>= </span><a href="varbit.c.html#LN124"><span class='Ref_To_Local'>bitlen</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="varbit.c.html#LN124"><span class='Ref_To_Local'>bitlen</span></a> <span class='Operator'>!= </span><a href="varbit.c.html#LN119"><span class='Ref_To_Local'>atttypmod</span></a><span class='Parentheses'>) 
</span>        <a href="../../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_STRING_DATA_LENGTH_MISMATCH<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"bit string length %d does not match type bit(%d)"</span><span class='Delimiter'>, 
</span>                        <a href="varbit.c.html#LN124"><span class='Ref_To_Local'>bitlen</span></a><span class='Delimiter'>, </span><a href="varbit.c.html#LN119"><span class='Ref_To_Local'>atttypmod</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
    <a href="varbit.c.html#LN123"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>= </span><a href="../../../include/utils/varbit.h.html#LN56"><span class='Ref_to_Macro'>VARBITTOTALLEN</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN119"><span class='Ref_To_Local'>atttypmod</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Comment_Multi_Line'>/* set to 0 so that *r is always initialised and string is zero-padded */ 
</span>    <a href="varbit.c.html#LN120"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/utils/varbit.h.html#LN24"><span class='Ref_to_Typedef'>VarBit</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/common/fe_memutils.h.html#LN34"><span class='Ref_to_Proto'>palloc0</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN123"><span class='Ref_To_Local'>len</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../../include/postgres.h.html#LN327"><span class='Ref_to_Macro'>SET_VARSIZE</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN120"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>, </span><a href="varbit.c.html#LN123"><span class='Ref_To_Local'>len</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../../include/utils/varbit.h.html#LN48"><span class='Ref_to_Macro'>VARBITLEN</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN120"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>) </span><span class='Operator'>= </span><a href="varbit.c.html#LN119"><span class='Ref_To_Local'>atttypmod</span></a><span class='Delimiter'>; 
</span> 
    <a href="varbit.c.html#LN122"><span class='Ref_To_Local'>r</span></a> <span class='Operator'>= </span><a href="../../../include/utils/varbit.h.html#LN50"><span class='Ref_to_Macro'>VARBITS</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN120"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="varbit.c.html#LN126"><span class='Ref_To_Local'>bit_not_hex</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* Parse the bit representation of the string */ 
</span>        <span class='Comment_Multi_Line'>/* We know it fits, as bitlen was compared to atttypmod */ 
</span>        <a href="varbit.c.html#LN128"><span class='Ref_To_Local'>x</span></a> <span class='Operator'>= </span><a href="../../../include/c.h.html#LN971"><span class='Ref_to_Const'>HIGHBIT</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>for</span> <span class='Parentheses'>(</span><span class='Delimiter'>; </span><span class='Operator'>*</span><a href="varbit.c.html#LN121"><span class='Ref_To_Local'>sp</span></a><span class='Delimiter'>; </span><a href="varbit.c.html#LN121"><span class='Ref_To_Local'>sp</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="varbit.c.html#LN121"><span class='Ref_To_Local'>sp</span></a> <span class='Operator'>== </span><span class='String'>'1'</span><span class='Parentheses'>) 
</span>                <span class='Operator'>*</span><a href="varbit.c.html#LN122"><span class='Ref_To_Local'>r</span></a> <span class='Operator'>|= </span><a href="varbit.c.html#LN128"><span class='Ref_To_Local'>x</span></a><span class='Delimiter'>; 
</span>            <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="varbit.c.html#LN121"><span class='Ref_To_Local'>sp</span></a> <span class='Operator'>!= </span><span class='String'>'0'</span><span class='Parentheses'>) 
</span>                <a href="../../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                        <span class='Parentheses'>(</span><a href="../../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INVALID_TEXT_REPRESENTATION<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                         <a href="../error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"\"%c\" is not a valid binary digit"</span><span class='Delimiter'>, 
</span>                                <span class='Operator'>*</span><a href="varbit.c.html#LN121"><span class='Ref_To_Local'>sp</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
            <a href="varbit.c.html#LN128"><span class='Ref_To_Local'>x</span></a> <span class='Operator'>&GT;&GT;= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="varbit.c.html#LN128"><span class='Ref_To_Local'>x</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <a href="varbit.c.html#LN128"><span class='Ref_To_Local'>x</span></a> <span class='Operator'>= </span><a href="../../../include/c.h.html#LN971"><span class='Ref_to_Const'>HIGHBIT</span></a><span class='Delimiter'>; 
</span>                <a href="varbit.c.html#LN122"><span class='Ref_To_Local'>r</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if bit_not_hex &raquo; </span> 
    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* Parse the hex representation of the string */ 
</span>        <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="varbit.c.html#LN127"><span class='Ref_To_Local'>bc</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><span class='Operator'>*</span><a href="varbit.c.html#LN121"><span class='Ref_To_Local'>sp</span></a><span class='Delimiter'>; </span><a href="varbit.c.html#LN121"><span class='Ref_To_Local'>sp</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="varbit.c.html#LN121"><span class='Ref_To_Local'>sp</span></a> <span class='Operator'>&GT;= </span><span class='String'>'0'</span> <span class='Operator'>&& *</span><a href="varbit.c.html#LN121"><span class='Ref_To_Local'>sp</span></a> <span class='Operator'>&LT;= </span><span class='String'>'9'</span><span class='Parentheses'>) 
</span>                <a href="varbit.c.html#LN128"><span class='Ref_To_Local'>x</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/c.h.html#LN274"><span class='Ref_to_Typedef'>bits8</span></a><span class='Parentheses'>) (</span><span class='Operator'>*</span><a href="varbit.c.html#LN121"><span class='Ref_To_Local'>sp</span></a> <span class='Operator'>- </span><span class='String'>'0'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="varbit.c.html#LN121"><span class='Ref_To_Local'>sp</span></a> <span class='Operator'>&GT;= </span><span class='String'>'A'</span> <span class='Operator'>&& *</span><a href="varbit.c.html#LN121"><span class='Ref_To_Local'>sp</span></a> <span class='Operator'>&LT;= </span><span class='String'>'F'</span><span class='Parentheses'>) 
</span>                <a href="varbit.c.html#LN128"><span class='Ref_To_Local'>x</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/c.h.html#LN274"><span class='Ref_to_Typedef'>bits8</span></a><span class='Parentheses'>) (</span><span class='Operator'>*</span><a href="varbit.c.html#LN121"><span class='Ref_To_Local'>sp</span></a> <span class='Operator'>- </span><span class='String'>'A'</span><span class='Parentheses'>) </span><span class='Operator'>+ </span><span class='Number'>10</span><span class='Delimiter'>; 
</span>            <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="varbit.c.html#LN121"><span class='Ref_To_Local'>sp</span></a> <span class='Operator'>&GT;= </span><span class='String'>'a'</span> <span class='Operator'>&& *</span><a href="varbit.c.html#LN121"><span class='Ref_To_Local'>sp</span></a> <span class='Operator'>&LT;= </span><span class='String'>'f'</span><span class='Parentheses'>) 
</span>                <a href="varbit.c.html#LN128"><span class='Ref_To_Local'>x</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/c.h.html#LN274"><span class='Ref_to_Typedef'>bits8</span></a><span class='Parentheses'>) (</span><span class='Operator'>*</span><a href="varbit.c.html#LN121"><span class='Ref_To_Local'>sp</span></a> <span class='Operator'>- </span><span class='String'>'a'</span><span class='Parentheses'>) </span><span class='Operator'>+ </span><span class='Number'>10</span><span class='Delimiter'>; 
</span>            <span class='Control'>else</span> 
                <a href="../../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                        <span class='Parentheses'>(</span><a href="../../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INVALID_TEXT_REPRESENTATION<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                         <a href="../error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"\"%c\" is not a valid hexadecimal digit"</span><span class='Delimiter'>, 
</span>                                <span class='Operator'>*</span><a href="varbit.c.html#LN121"><span class='Ref_To_Local'>sp</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="varbit.c.html#LN127"><span class='Ref_To_Local'>bc</span></a><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <span class='Operator'>*</span><a href="varbit.c.html#LN122"><span class='Ref_To_Local'>r</span></a><span class='Operator'>++ |= </span><a href="varbit.c.html#LN128"><span class='Ref_To_Local'>x</span></a><span class='Delimiter'>; 
</span>                <a href="varbit.c.html#LN127"><span class='Ref_To_Local'>bc</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>            <span class='Control'>else</span> 
            <span class='Delimiter'>{ 
</span>                <span class='Operator'>*</span><a href="varbit.c.html#LN122"><span class='Ref_To_Local'>r</span></a> <span class='Operator'>= </span><a href="varbit.c.html#LN128"><span class='Ref_To_Local'>x</span></a> <span class='Operator'>&LT;&LT; </span><span class='Number'>4</span><span class='Delimiter'>; 
</span>                <a href="varbit.c.html#LN127"><span class='Ref_To_Local'>bc</span></a> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>        <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end for bc=0;*sp;sp++ &raquo; </span> 
    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end else &raquo; </span> 
 
    <a href="../../../include/utils/varbit.h.html#LN43"><span class='Ref_to_Macro'>PG_RETURN_VARBIT_P</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN120"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end bit_in &raquo; </span> 
 
 
<a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN245"></a><span class='Declare_Function'>bit_out</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><span class='Directive'>#if</span> <span class='Number'>1</span> 
    <span class='Comment_Multi_Line'>/* same as varbit output */ 
</span>    <span class='Control'>return</span> <a href="varbit.c.html#LN562"><span class='Ref_to_Func'>varbit_out</span></a><span class='Parentheses'>(</span>fcinfo<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><span class='Directive'>#else</span> 
<span class='Inactive_Code'> 
    /* 
     * This is how one would print a hex string, in case someone wants to 
     * write a formatting function. 
     */ 
    VarBit     *s = PG_GETARG_VARBIT_P(0); 
    char       *result, 
               *r; 
    bits8      *sp; 
    int         i, 
                len, 
                bitlen; 
 
    bitlen = VARBITLEN(s); 
    len = (bitlen + 3) / 4; 
    result = (char *) palloc(len + 2); 
    sp = VARBITS(s); 
    r = result; 
    *r++ = 'X'; 
    /* we cheat by knowing that we store full bytes zero padded */ 
    for (i = 0; i &LT; len; i += 2, sp++) 
    { 
        *r++ = HEXDIG((*sp) &GT;&GT; 4); 
        *r++ = HEXDIG((*sp) & 0xF); 
    } 
 
    /* 
     * Go back one step if we printed a hex number that was not part of the 
     * bitstring anymore 
     */ 
    if (i &GT; len) 
        r--; 
    *r = '\0'; 
 
    PG_RETURN_CSTRING(result); 
</span><span class='Directive'>#endif</span> 
<span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end bit_out &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 *      bit_recv            - converts external binary format to bit 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN293"></a><span class='Declare_Function'>bit_recv</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN295"></a>    <a href="../../../include/lib/stringinfo.h.html#LN42"><span class='Ref_to_Typedef'>StringInfo</span></a>  <span class='Declare_Local'>buf</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/lib/stringinfo.h.html#LN42"><span class='Ref_to_Typedef'>StringInfo</span></a><span class='Parentheses'>) </span><a href="../../../include/fmgr.h.html#LN240"><span class='Ref_to_Macro'>PG_GETARG_POINTER</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
<span class='Directive'>#ifdef</span> NOT_USED 
<a name="LN298"></a>    <a href="../../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>typelem</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN239"><span class='Ref_to_Macro'>PG_GETARG_OID</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><span class='Directive'>#endif</span> 
<a name="LN300"></a>    <a href="../../../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>       <span class='Declare_Local'>atttypmod</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN233"><span class='Ref_to_Macro'>PG_GETARG_INT32</span></a><span class='Parentheses'>(</span><span class='Number'>2</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN301"></a>    <a href="../../../include/utils/varbit.h.html#LN24"><span class='Ref_to_Typedef'>VarBit</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span><a name="LN302"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>len</span><span class='Delimiter'>, 
</span><a name="LN303"></a>                <span class='Declare_Local'>bitlen</span><span class='Delimiter'>; 
</span><a name="LN304"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>ipad</span><span class='Delimiter'>; 
</span><a name="LN305"></a>    <a href="../../../include/c.h.html#LN274"><span class='Ref_to_Typedef'>bits8</span></a>       <span class='Declare_Local'>mask</span><span class='Delimiter'>; 
</span> 
    <a href="varbit.c.html#LN303"><span class='Ref_To_Local'>bitlen</span></a> <span class='Operator'>= </span><a href="../../../include/libpq/pqformat.h.html#LN38"><span class='Ref_to_Proto'>pq_getmsgint</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN295"><span class='Ref_To_Local'>buf</span></a><span class='Delimiter'>, </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="varbit.c.html#LN303"><span class='Ref_To_Local'>bitlen</span></a> <span class='Operator'>&LT; </span><span class='Number'>0</span> <span class='Operator'>|| </span><a href="varbit.c.html#LN303"><span class='Ref_To_Local'>bitlen</span></a> <span class='Operator'>&GT; </span><a href="../../../include/utils/varbit.h.html#LN62"><span class='Ref_to_Const'>VARBITMAXLEN</span></a><span class='Parentheses'>) 
</span>        <a href="../../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INVALID_BINARY_REPRESENTATION<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"invalid length in external bit string"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Sometimes atttypmod is not supplied. If it is supplied we need to make 
     * sure that the bitstring fits. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="varbit.c.html#LN300"><span class='Ref_To_Local'>atttypmod</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span> <span class='Operator'>&& </span><a href="varbit.c.html#LN303"><span class='Ref_To_Local'>bitlen</span></a> <span class='Operator'>!= </span><a href="varbit.c.html#LN300"><span class='Ref_To_Local'>atttypmod</span></a><span class='Parentheses'>) 
</span>        <a href="../../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_STRING_DATA_LENGTH_MISMATCH<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"bit string length %d does not match type bit(%d)"</span><span class='Delimiter'>, 
</span>                        <a href="varbit.c.html#LN303"><span class='Ref_To_Local'>bitlen</span></a><span class='Delimiter'>, </span><a href="varbit.c.html#LN300"><span class='Ref_To_Local'>atttypmod</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
    <a href="varbit.c.html#LN302"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>= </span><a href="../../../include/utils/varbit.h.html#LN56"><span class='Ref_to_Macro'>VARBITTOTALLEN</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN303"><span class='Ref_To_Local'>bitlen</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="varbit.c.html#LN301"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/utils/varbit.h.html#LN24"><span class='Ref_to_Typedef'>VarBit</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN302"><span class='Ref_To_Local'>len</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../../include/postgres.h.html#LN327"><span class='Ref_to_Macro'>SET_VARSIZE</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN301"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>, </span><a href="varbit.c.html#LN302"><span class='Ref_To_Local'>len</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../../include/utils/varbit.h.html#LN48"><span class='Ref_to_Macro'>VARBITLEN</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN301"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>) </span><span class='Operator'>= </span><a href="varbit.c.html#LN303"><span class='Ref_To_Local'>bitlen</span></a><span class='Delimiter'>; 
</span> 
    <a href="../../../include/libpq/pqformat.h.html#LN43"><span class='Ref_to_Proto'>pq_copymsgbytes</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN295"><span class='Ref_To_Local'>buf</span></a><span class='Delimiter'>, </span><span class='Parentheses'>(</span><span class='Keyword'>char </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/utils/varbit.h.html#LN50"><span class='Ref_to_Macro'>VARBITS</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN301"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="../../../include/utils/varbit.h.html#LN52"><span class='Ref_to_Macro'>VARBITBYTES</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN301"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Make sure last byte is zero-padded if needed */ 
</span>    <a href="varbit.c.html#LN304"><span class='Ref_To_Local'>ipad</span></a> <span class='Operator'>= </span><a href="../../../include/utils/varbit.h.html#LN54"><span class='Ref_to_Macro'>VARBITPAD</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN301"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="varbit.c.html#LN304"><span class='Ref_To_Local'>ipad</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="varbit.c.html#LN305"><span class='Ref_To_Local'>mask</span></a> <span class='Operator'>= </span><a href="../../../include/utils/varbit.h.html#LN66"><span class='Ref_to_Const'>BITMASK</span></a> <span class='Operator'>&LT;&LT; </span><a href="varbit.c.html#LN304"><span class='Ref_To_Local'>ipad</span></a><span class='Delimiter'>; 
</span>        <span class='Operator'>*</span><span class='Parentheses'>(</span><a href="../../../include/utils/varbit.h.html#LN50"><span class='Ref_to_Macro'>VARBITS</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN301"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>) </span><span class='Operator'>+ </span><a href="../../../include/utils/varbit.h.html#LN52"><span class='Ref_to_Macro'>VARBITBYTES</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN301"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>) </span><span class='Operator'>- </span><span class='Number'>1</span><span class='Parentheses'>)</span> <span class='Operator'>&= </span><a href="varbit.c.html#LN305"><span class='Ref_To_Local'>mask</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="../../../include/utils/varbit.h.html#LN43"><span class='Ref_to_Macro'>PG_RETURN_VARBIT_P</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN301"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end bit_recv &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 *      bit_send            - converts bit to binary format 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN345"></a><span class='Declare_Function'>bit_send</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Comment_Multi_Line'>/* Exactly the same as varbit_send, so share code */ 
</span>    <span class='Control'>return</span> <a href="varbit.c.html#LN660"><span class='Ref_to_Func'>varbit_send</span></a><span class='Parentheses'>(</span>fcinfo<span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * bit() 
 * Converts a bit() type to a specific internal length. 
 * len is the bitlength specified in the column definition. 
 * 
 * If doing implicit cast, raise error when source data is wrong length. 
 * If doing explicit cast, silently truncate or zero-pad to specified length. 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN360"></a><span class='Declare_Function'>bit</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN362"></a>    <a href="../../../include/utils/varbit.h.html#LN24"><span class='Ref_to_Typedef'>VarBit</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>arg</span> <span class='Operator'>= </span><a href="../../../include/utils/varbit.h.html#LN41"><span class='Ref_to_Macro'>PG_GETARG_VARBIT_P</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN363"></a>    <a href="../../../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>       <span class='Declare_Local'>len</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN233"><span class='Ref_to_Macro'>PG_GETARG_INT32</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN364"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>isExplicit</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN238"><span class='Ref_to_Macro'>PG_GETARG_BOOL</span></a><span class='Parentheses'>(</span><span class='Number'>2</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN365"></a>    <a href="../../../include/utils/varbit.h.html#LN24"><span class='Ref_to_Typedef'>VarBit</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span><a name="LN366"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>rlen</span><span class='Delimiter'>; 
</span><a name="LN367"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>ipad</span><span class='Delimiter'>; 
</span><a name="LN368"></a>    <a href="../../../include/c.h.html#LN274"><span class='Ref_to_Typedef'>bits8</span></a>       <span class='Declare_Local'>mask</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* No work if typmod is invalid or supplied data matches it already */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="varbit.c.html#LN363"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>&LT;= </span><span class='Number'>0</span> <span class='Operator'>|| </span><a href="varbit.c.html#LN363"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>&GT; </span><a href="../../../include/utils/varbit.h.html#LN62"><span class='Ref_to_Const'>VARBITMAXLEN</span></a> <span class='Operator'>|| </span><a href="varbit.c.html#LN363"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>== </span><a href="../../../include/utils/varbit.h.html#LN48"><span class='Ref_to_Macro'>VARBITLEN</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN362"><span class='Ref_To_Local'>arg</span></a><span class='Parentheses'>))</span> 
        <a href="../../../include/utils/varbit.h.html#LN43"><span class='Ref_to_Macro'>PG_RETURN_VARBIT_P</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN362"><span class='Ref_To_Local'>arg</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="varbit.c.html#LN364"><span class='Ref_To_Local'>isExplicit</span></a><span class='Parentheses'>) 
</span>        <a href="../../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_STRING_DATA_LENGTH_MISMATCH<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"bit string length %d does not match type bit(%d)"</span><span class='Delimiter'>, 
</span>                        <a href="../../../include/utils/varbit.h.html#LN48"><span class='Ref_to_Macro'>VARBITLEN</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN362"><span class='Ref_To_Local'>arg</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="varbit.c.html#LN363"><span class='Ref_To_Local'>len</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
    <a href="varbit.c.html#LN366"><span class='Ref_To_Local'>rlen</span></a> <span class='Operator'>= </span><a href="../../../include/utils/varbit.h.html#LN56"><span class='Ref_to_Macro'>VARBITTOTALLEN</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN363"><span class='Ref_To_Local'>len</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Comment_Multi_Line'>/* set to 0 so that string is zero-padded */ 
</span>    <a href="varbit.c.html#LN365"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/utils/varbit.h.html#LN24"><span class='Ref_to_Typedef'>VarBit</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/common/fe_memutils.h.html#LN34"><span class='Ref_to_Proto'>palloc0</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN366"><span class='Ref_To_Local'>rlen</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../../include/postgres.h.html#LN327"><span class='Ref_to_Macro'>SET_VARSIZE</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN365"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>, </span><a href="varbit.c.html#LN366"><span class='Ref_To_Local'>rlen</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../../include/utils/varbit.h.html#LN48"><span class='Ref_to_Macro'>VARBITLEN</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN365"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>) </span><span class='Operator'>= </span><a href="varbit.c.html#LN363"><span class='Ref_To_Local'>len</span></a><span class='Delimiter'>; 
</span> 
    memcpy<span class='Parentheses'>(</span><a href="../../../include/utils/varbit.h.html#LN50"><span class='Ref_to_Macro'>VARBITS</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN365"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="../../../include/utils/varbit.h.html#LN50"><span class='Ref_to_Macro'>VARBITS</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN362"><span class='Ref_To_Local'>arg</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>           <a href="../../../interfaces/ecpg/pgtypeslib/numeric.c.html#LN11"><span class='Ref_to_Macro'>Min</span></a><span class='Parentheses'>(</span><a href="../../../include/utils/varbit.h.html#LN52"><span class='Ref_to_Macro'>VARBITBYTES</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN365"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="../../../include/utils/varbit.h.html#LN52"><span class='Ref_to_Macro'>VARBITBYTES</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN362"><span class='Ref_To_Local'>arg</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Make sure last byte is zero-padded if needed.  This is useless but safe 
     * if source data was shorter than target length (we assume the last byte 
     * of the source data was itself correctly zero-padded). 
     */ 
</span>    <a href="varbit.c.html#LN367"><span class='Ref_To_Local'>ipad</span></a> <span class='Operator'>= </span><a href="../../../include/utils/varbit.h.html#LN54"><span class='Ref_to_Macro'>VARBITPAD</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN365"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="varbit.c.html#LN367"><span class='Ref_To_Local'>ipad</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="varbit.c.html#LN368"><span class='Ref_To_Local'>mask</span></a> <span class='Operator'>= </span><a href="../../../include/utils/varbit.h.html#LN66"><span class='Ref_to_Const'>BITMASK</span></a> <span class='Operator'>&LT;&LT; </span><a href="varbit.c.html#LN367"><span class='Ref_To_Local'>ipad</span></a><span class='Delimiter'>; 
</span>        <span class='Operator'>*</span><span class='Parentheses'>(</span><a href="../../../include/utils/varbit.h.html#LN50"><span class='Ref_to_Macro'>VARBITS</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN365"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>) </span><span class='Operator'>+ </span><a href="../../../include/utils/varbit.h.html#LN52"><span class='Ref_to_Macro'>VARBITBYTES</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN365"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>) </span><span class='Operator'>- </span><span class='Number'>1</span><span class='Parentheses'>)</span> <span class='Operator'>&= </span><a href="varbit.c.html#LN368"><span class='Ref_To_Local'>mask</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="../../../include/utils/varbit.h.html#LN43"><span class='Ref_to_Macro'>PG_RETURN_VARBIT_P</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN365"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end bit &raquo; </span> 
 
<a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN405"></a><span class='Declare_Function'>bittypmodin</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN407"></a>    <a href="../../../include/utils/array.h.html#LN75"><span class='Ref_to_Typedef'>ArrayType</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>ta</span> <span class='Operator'>= </span><a href="../../../include/utils/array.h.html#LN243"><span class='Ref_to_Macro'>PG_GETARG_ARRAYTYPE_P</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/fmgr.h.html#LN313"><span class='Ref_to_Macro'>PG_RETURN_INT32</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN36"><span class='Ref_to_Func'>anybit_typmodin</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN407"><span class='Ref_To_Local'>ta</span></a><span class='Delimiter'>, </span><span class='String'>"bit"</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
} 
</span> 
<a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN413"></a><span class='Declare_Function'>bittypmodout</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN415"></a>    <a href="../../../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>       <span class='Declare_Local'>typmod</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN233"><span class='Ref_to_Macro'>PG_GETARG_INT32</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/fmgr.h.html#LN321"><span class='Ref_to_Macro'>PG_RETURN_CSTRING</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN73"><span class='Ref_to_Func'>anybit_typmodout</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN415"><span class='Ref_To_Local'>typmod</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
} 
</span> 
 
<span class='Comment_Multi_Line'>/* 
 * varbit_in - 
 *    converts a string to the internal representation of a bitstring. 
 *      This is the same as bit_in except that atttypmod is taken as 
 *      the maximum length, not the exact length to force the bitstring to. 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN428"></a><span class='Declare_Function'>varbit_in</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN430"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>input_string</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN241"><span class='Ref_to_Macro'>PG_GETARG_CSTRING</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
<span class='Directive'>#ifdef</span> NOT_USED 
<a name="LN433"></a>    <a href="../../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>typelem</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN239"><span class='Ref_to_Macro'>PG_GETARG_OID</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><span class='Directive'>#endif</span> 
<a name="LN435"></a>    <a href="../../../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>       <span class='Declare_Local'>atttypmod</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN233"><span class='Ref_to_Macro'>PG_GETARG_INT32</span></a><span class='Parentheses'>(</span><span class='Number'>2</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN436"></a>    <a href="../../../include/utils/varbit.h.html#LN24"><span class='Ref_to_Typedef'>VarBit</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>result</span><span class='Delimiter'>;</span>         <span class='Comment_Single_Line'>/* The resulting bit string           */ 
</span><a name="LN437"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>sp</span><span class='Delimiter'>;</span>             <span class='Comment_Single_Line'>/* pointer into the character string  */ 
</span><a name="LN438"></a>    <a href="../../../include/c.h.html#LN274"><span class='Ref_to_Typedef'>bits8</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>r</span><span class='Delimiter'>;</span>              <span class='Comment_Single_Line'>/* pointer into the result */ 
</span><a name="LN439"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>len</span><span class='Delimiter'>,</span>            <span class='Comment_Single_Line'>/* Length of the whole data structure */ 
</span><a name="LN440"></a>                <span class='Declare_Local'>bitlen</span><span class='Delimiter'>,</span>         <span class='Comment_Single_Line'>/* Number of bits in the bit string   */ 
</span><a name="LN441"></a>                <span class='Declare_Local'>slen</span><span class='Delimiter'>;</span>           <span class='Comment_Single_Line'>/* Length of the input string         */ 
</span><a name="LN442"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>bit_not_hex</span><span class='Delimiter'>;</span>    <span class='Comment_Single_Line'>/* false = hex string  true = bit string */ 
</span><a name="LN443"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>bc</span><span class='Delimiter'>; 
</span><a name="LN444"></a>    <a href="../../../include/c.h.html#LN274"><span class='Ref_to_Typedef'>bits8</span></a>       <span class='Declare_Local'>x</span> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Check that the first character is a b or an x */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="varbit.c.html#LN430"><span class='Ref_To_Local'>input_string</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>] </span><span class='Operator'>== </span><span class='String'>'b'</span> <span class='Operator'>|| </span><a href="varbit.c.html#LN430"><span class='Ref_To_Local'>input_string</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>] </span><span class='Operator'>== </span><span class='String'>'B'</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="varbit.c.html#LN442"><span class='Ref_To_Local'>bit_not_hex</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>        <a href="varbit.c.html#LN437"><span class='Ref_To_Local'>sp</span></a> <span class='Operator'>= </span><a href="varbit.c.html#LN430"><span class='Ref_To_Local'>input_string</span></a> <span class='Operator'>+ </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="varbit.c.html#LN430"><span class='Ref_To_Local'>input_string</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>] </span><span class='Operator'>== </span><span class='String'>'x'</span> <span class='Operator'>|| </span><a href="varbit.c.html#LN430"><span class='Ref_To_Local'>input_string</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>] </span><span class='Operator'>== </span><span class='String'>'X'</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="varbit.c.html#LN442"><span class='Ref_To_Local'>bit_not_hex</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>        <a href="varbit.c.html#LN437"><span class='Ref_To_Local'>sp</span></a> <span class='Operator'>= </span><a href="varbit.c.html#LN430"><span class='Ref_To_Local'>input_string</span></a> <span class='Operator'>+ </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <a href="varbit.c.html#LN442"><span class='Ref_To_Local'>bit_not_hex</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>        <a href="varbit.c.html#LN437"><span class='Ref_To_Local'>sp</span></a> <span class='Operator'>= </span><a href="varbit.c.html#LN430"><span class='Ref_To_Local'>input_string</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Determine bitlength from input string.  MaxAllocSize ensures a regular 
     * input is small enough, but we must check hex input. 
     */ 
</span>    <a href="varbit.c.html#LN441"><span class='Ref_To_Local'>slen</span></a> <span class='Operator'>= </span>strlen<span class='Parentheses'>(</span><a href="varbit.c.html#LN437"><span class='Ref_To_Local'>sp</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="varbit.c.html#LN442"><span class='Ref_To_Local'>bit_not_hex</span></a><span class='Parentheses'>) 
</span>        <a href="varbit.c.html#LN440"><span class='Ref_To_Local'>bitlen</span></a> <span class='Operator'>= </span><a href="varbit.c.html#LN441"><span class='Ref_To_Local'>slen</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="varbit.c.html#LN441"><span class='Ref_To_Local'>slen</span></a> <span class='Operator'>&GT; </span><a href="../../../include/utils/varbit.h.html#LN62"><span class='Ref_to_Const'>VARBITMAXLEN</span></a> <span class='Operator'>/ </span><span class='Number'>4</span><span class='Parentheses'>) 
</span>            <a href="../../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                    <span class='Parentheses'>(</span><a href="../../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_PROGRAM_LIMIT_EXCEEDED<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"bit string length exceeds the maximum allowed (%d)"</span><span class='Delimiter'>, 
</span>                        <a href="../../../include/utils/varbit.h.html#LN62"><span class='Ref_to_Const'>VARBITMAXLEN</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>        <a href="varbit.c.html#LN440"><span class='Ref_To_Local'>bitlen</span></a> <span class='Operator'>= </span><a href="varbit.c.html#LN441"><span class='Ref_To_Local'>slen</span></a> <span class='Operator'>* </span><span class='Number'>4</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Sometimes atttypmod is not supplied. If it is supplied we need to make 
     * sure that the bitstring fits. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="varbit.c.html#LN435"><span class='Ref_To_Local'>atttypmod</span></a> <span class='Operator'>&LT;= </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>        <a href="varbit.c.html#LN435"><span class='Ref_To_Local'>atttypmod</span></a> <span class='Operator'>= </span><a href="varbit.c.html#LN440"><span class='Ref_To_Local'>bitlen</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="varbit.c.html#LN440"><span class='Ref_To_Local'>bitlen</span></a> <span class='Operator'>&GT; </span><a href="varbit.c.html#LN435"><span class='Ref_To_Local'>atttypmod</span></a><span class='Parentheses'>) 
</span>        <a href="../../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_STRING_DATA_RIGHT_TRUNCATION<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"bit string too long for type bit varying(%d)"</span><span class='Delimiter'>, 
</span>                        <a href="varbit.c.html#LN435"><span class='Ref_To_Local'>atttypmod</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
    <a href="varbit.c.html#LN439"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>= </span><a href="../../../include/utils/varbit.h.html#LN56"><span class='Ref_to_Macro'>VARBITTOTALLEN</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN440"><span class='Ref_To_Local'>bitlen</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Comment_Multi_Line'>/* set to 0 so that *r is always initialised and string is zero-padded */ 
</span>    <a href="varbit.c.html#LN436"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/utils/varbit.h.html#LN24"><span class='Ref_to_Typedef'>VarBit</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/common/fe_memutils.h.html#LN34"><span class='Ref_to_Proto'>palloc0</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN439"><span class='Ref_To_Local'>len</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../../include/postgres.h.html#LN327"><span class='Ref_to_Macro'>SET_VARSIZE</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN436"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>, </span><a href="varbit.c.html#LN439"><span class='Ref_To_Local'>len</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../../include/utils/varbit.h.html#LN48"><span class='Ref_to_Macro'>VARBITLEN</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN436"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>) </span><span class='Operator'>= </span><a href="../../../interfaces/ecpg/pgtypeslib/numeric.c.html#LN11"><span class='Ref_to_Macro'>Min</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN440"><span class='Ref_To_Local'>bitlen</span></a><span class='Delimiter'>, </span><a href="varbit.c.html#LN435"><span class='Ref_To_Local'>atttypmod</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="varbit.c.html#LN438"><span class='Ref_To_Local'>r</span></a> <span class='Operator'>= </span><a href="../../../include/utils/varbit.h.html#LN50"><span class='Ref_to_Macro'>VARBITS</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN436"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="varbit.c.html#LN442"><span class='Ref_To_Local'>bit_not_hex</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* Parse the bit representation of the string */ 
</span>        <span class='Comment_Multi_Line'>/* We know it fits, as bitlen was compared to atttypmod */ 
</span>        <a href="varbit.c.html#LN444"><span class='Ref_To_Local'>x</span></a> <span class='Operator'>= </span><a href="../../../include/c.h.html#LN971"><span class='Ref_to_Const'>HIGHBIT</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>for</span> <span class='Parentheses'>(</span><span class='Delimiter'>; </span><span class='Operator'>*</span><a href="varbit.c.html#LN437"><span class='Ref_To_Local'>sp</span></a><span class='Delimiter'>; </span><a href="varbit.c.html#LN437"><span class='Ref_To_Local'>sp</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="varbit.c.html#LN437"><span class='Ref_To_Local'>sp</span></a> <span class='Operator'>== </span><span class='String'>'1'</span><span class='Parentheses'>) 
</span>                <span class='Operator'>*</span><a href="varbit.c.html#LN438"><span class='Ref_To_Local'>r</span></a> <span class='Operator'>|= </span><a href="varbit.c.html#LN444"><span class='Ref_To_Local'>x</span></a><span class='Delimiter'>; 
</span>            <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="varbit.c.html#LN437"><span class='Ref_To_Local'>sp</span></a> <span class='Operator'>!= </span><span class='String'>'0'</span><span class='Parentheses'>) 
</span>                <a href="../../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                        <span class='Parentheses'>(</span><a href="../../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INVALID_TEXT_REPRESENTATION<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                         <a href="../error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"\"%c\" is not a valid binary digit"</span><span class='Delimiter'>, 
</span>                                <span class='Operator'>*</span><a href="varbit.c.html#LN437"><span class='Ref_To_Local'>sp</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
            <a href="varbit.c.html#LN444"><span class='Ref_To_Local'>x</span></a> <span class='Operator'>&GT;&GT;= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="varbit.c.html#LN444"><span class='Ref_To_Local'>x</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <a href="varbit.c.html#LN444"><span class='Ref_To_Local'>x</span></a> <span class='Operator'>= </span><a href="../../../include/c.h.html#LN971"><span class='Ref_to_Const'>HIGHBIT</span></a><span class='Delimiter'>; 
</span>                <a href="varbit.c.html#LN438"><span class='Ref_To_Local'>r</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if bit_not_hex &raquo; </span> 
    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* Parse the hex representation of the string */ 
</span>        <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="varbit.c.html#LN443"><span class='Ref_To_Local'>bc</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><span class='Operator'>*</span><a href="varbit.c.html#LN437"><span class='Ref_To_Local'>sp</span></a><span class='Delimiter'>; </span><a href="varbit.c.html#LN437"><span class='Ref_To_Local'>sp</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="varbit.c.html#LN437"><span class='Ref_To_Local'>sp</span></a> <span class='Operator'>&GT;= </span><span class='String'>'0'</span> <span class='Operator'>&& *</span><a href="varbit.c.html#LN437"><span class='Ref_To_Local'>sp</span></a> <span class='Operator'>&LT;= </span><span class='String'>'9'</span><span class='Parentheses'>) 
</span>                <a href="varbit.c.html#LN444"><span class='Ref_To_Local'>x</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/c.h.html#LN274"><span class='Ref_to_Typedef'>bits8</span></a><span class='Parentheses'>) (</span><span class='Operator'>*</span><a href="varbit.c.html#LN437"><span class='Ref_To_Local'>sp</span></a> <span class='Operator'>- </span><span class='String'>'0'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="varbit.c.html#LN437"><span class='Ref_To_Local'>sp</span></a> <span class='Operator'>&GT;= </span><span class='String'>'A'</span> <span class='Operator'>&& *</span><a href="varbit.c.html#LN437"><span class='Ref_To_Local'>sp</span></a> <span class='Operator'>&LT;= </span><span class='String'>'F'</span><span class='Parentheses'>) 
</span>                <a href="varbit.c.html#LN444"><span class='Ref_To_Local'>x</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/c.h.html#LN274"><span class='Ref_to_Typedef'>bits8</span></a><span class='Parentheses'>) (</span><span class='Operator'>*</span><a href="varbit.c.html#LN437"><span class='Ref_To_Local'>sp</span></a> <span class='Operator'>- </span><span class='String'>'A'</span><span class='Parentheses'>) </span><span class='Operator'>+ </span><span class='Number'>10</span><span class='Delimiter'>; 
</span>            <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="varbit.c.html#LN437"><span class='Ref_To_Local'>sp</span></a> <span class='Operator'>&GT;= </span><span class='String'>'a'</span> <span class='Operator'>&& *</span><a href="varbit.c.html#LN437"><span class='Ref_To_Local'>sp</span></a> <span class='Operator'>&LT;= </span><span class='String'>'f'</span><span class='Parentheses'>) 
</span>                <a href="varbit.c.html#LN444"><span class='Ref_To_Local'>x</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/c.h.html#LN274"><span class='Ref_to_Typedef'>bits8</span></a><span class='Parentheses'>) (</span><span class='Operator'>*</span><a href="varbit.c.html#LN437"><span class='Ref_To_Local'>sp</span></a> <span class='Operator'>- </span><span class='String'>'a'</span><span class='Parentheses'>) </span><span class='Operator'>+ </span><span class='Number'>10</span><span class='Delimiter'>; 
</span>            <span class='Control'>else</span> 
                <a href="../../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                        <span class='Parentheses'>(</span><a href="../../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INVALID_TEXT_REPRESENTATION<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                         <a href="../error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"\"%c\" is not a valid hexadecimal digit"</span><span class='Delimiter'>, 
</span>                                <span class='Operator'>*</span><a href="varbit.c.html#LN437"><span class='Ref_To_Local'>sp</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="varbit.c.html#LN443"><span class='Ref_To_Local'>bc</span></a><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <span class='Operator'>*</span><a href="varbit.c.html#LN438"><span class='Ref_To_Local'>r</span></a><span class='Operator'>++ |= </span><a href="varbit.c.html#LN444"><span class='Ref_To_Local'>x</span></a><span class='Delimiter'>; 
</span>                <a href="varbit.c.html#LN443"><span class='Ref_To_Local'>bc</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>            <span class='Control'>else</span> 
            <span class='Delimiter'>{ 
</span>                <span class='Operator'>*</span><a href="varbit.c.html#LN438"><span class='Ref_To_Local'>r</span></a> <span class='Operator'>= </span><a href="varbit.c.html#LN444"><span class='Ref_To_Local'>x</span></a> <span class='Operator'>&LT;&LT; </span><span class='Number'>4</span><span class='Delimiter'>; 
</span>                <a href="varbit.c.html#LN443"><span class='Ref_To_Local'>bc</span></a> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>        <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end for bc=0;*sp;sp++ &raquo; </span> 
    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end else &raquo; </span> 
 
    <a href="../../../include/utils/varbit.h.html#LN43"><span class='Ref_to_Macro'>PG_RETURN_VARBIT_P</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN436"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end varbit_in &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * varbit_out - 
 *    Prints the string as bits to preserve length accurately 
 * 
 * XXX varbit_recv() and hex input to varbit_in() can load a value that this 
 * cannot emit.  Consider using hex output for such values. 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN563"></a><span class='Declare_Function'>varbit_out</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN565"></a>    <a href="../../../include/utils/varbit.h.html#LN24"><span class='Ref_to_Typedef'>VarBit</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>s</span> <span class='Operator'>= </span><a href="../../../include/utils/varbit.h.html#LN41"><span class='Ref_to_Macro'>PG_GETARG_VARBIT_P</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN566"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>result</span><span class='Delimiter'>, 
</span><a name="LN567"></a>               <span class='Operator'>*</span><span class='Declare_Local'>r</span><span class='Delimiter'>; 
</span><a name="LN568"></a>    <a href="../../../include/c.h.html#LN274"><span class='Ref_to_Typedef'>bits8</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>sp</span><span class='Delimiter'>; 
</span><a name="LN569"></a>    <a href="../../../include/c.h.html#LN274"><span class='Ref_to_Typedef'>bits8</span></a>       <span class='Declare_Local'>x</span><span class='Delimiter'>; 
</span><a name="LN570"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>i</span><span class='Delimiter'>, 
</span><a name="LN571"></a>                <span class='Declare_Local'>k</span><span class='Delimiter'>, 
</span><a name="LN572"></a>                <span class='Declare_Local'>len</span><span class='Delimiter'>; 
</span> 
    <a href="varbit.c.html#LN572"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>= </span><a href="../../../include/utils/varbit.h.html#LN48"><span class='Ref_to_Macro'>VARBITLEN</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN565"><span class='Ref_To_Local'>s</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="varbit.c.html#LN566"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Keyword'>char </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN572"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>+ </span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="varbit.c.html#LN568"><span class='Ref_To_Local'>sp</span></a> <span class='Operator'>= </span><a href="../../../include/utils/varbit.h.html#LN50"><span class='Ref_to_Macro'>VARBITS</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN565"><span class='Ref_To_Local'>s</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="varbit.c.html#LN567"><span class='Ref_To_Local'>r</span></a> <span class='Operator'>= </span><a href="varbit.c.html#LN566"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="varbit.c.html#LN570"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="varbit.c.html#LN570"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT;= </span><a href="varbit.c.html#LN572"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>- </span><a href="../../../include/pg_config_manual.h.html#LN105"><span class='Ref_to_Const'>BITS_PER_BYTE</span></a><span class='Delimiter'>; </span><a href="varbit.c.html#LN570"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>+= </span><a href="../../../include/pg_config_manual.h.html#LN105"><span class='Ref_to_Const'>BITS_PER_BYTE</span></a><span class='Delimiter'>, </span><a href="varbit.c.html#LN568"><span class='Ref_To_Local'>sp</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* print full bytes */ 
</span>        <a href="varbit.c.html#LN569"><span class='Ref_To_Local'>x</span></a> <span class='Operator'>= *</span><a href="varbit.c.html#LN568"><span class='Ref_To_Local'>sp</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="varbit.c.html#LN571"><span class='Ref_To_Local'>k</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="varbit.c.html#LN571"><span class='Ref_To_Local'>k</span></a> <span class='Operator'>&LT; </span><a href="../../../include/pg_config_manual.h.html#LN105"><span class='Ref_to_Const'>BITS_PER_BYTE</span></a><span class='Delimiter'>; </span><a href="varbit.c.html#LN571"><span class='Ref_To_Local'>k</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Operator'>*</span><a href="varbit.c.html#LN567"><span class='Ref_To_Local'>r</span></a><span class='Operator'>++ = </span><a href="../../../include/c.h.html#LN972"><span class='Ref_to_Macro'>IS_HIGHBIT_SET</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN569"><span class='Ref_To_Local'>x</span></a><span class='Parentheses'>) </span><span class='Operator'>? </span><span class='String'>'1'</span> <span class='Operator'>: </span><span class='String'>'0'</span><span class='Delimiter'>; 
</span>            <a href="varbit.c.html#LN569"><span class='Ref_To_Local'>x</span></a> <span class='Operator'>&LT;&LT;= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="varbit.c.html#LN570"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="varbit.c.html#LN572"><span class='Ref_To_Local'>len</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* print the last partial byte */ 
</span>        <a href="varbit.c.html#LN569"><span class='Ref_To_Local'>x</span></a> <span class='Operator'>= *</span><a href="varbit.c.html#LN568"><span class='Ref_To_Local'>sp</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="varbit.c.html#LN571"><span class='Ref_To_Local'>k</span></a> <span class='Operator'>= </span><a href="varbit.c.html#LN570"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>; </span><a href="varbit.c.html#LN571"><span class='Ref_To_Local'>k</span></a> <span class='Operator'>&LT; </span><a href="varbit.c.html#LN572"><span class='Ref_To_Local'>len</span></a><span class='Delimiter'>; </span><a href="varbit.c.html#LN571"><span class='Ref_To_Local'>k</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Operator'>*</span><a href="varbit.c.html#LN567"><span class='Ref_To_Local'>r</span></a><span class='Operator'>++ = </span><a href="../../../include/c.h.html#LN972"><span class='Ref_to_Macro'>IS_HIGHBIT_SET</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN569"><span class='Ref_To_Local'>x</span></a><span class='Parentheses'>) </span><span class='Operator'>? </span><span class='String'>'1'</span> <span class='Operator'>: </span><span class='String'>'0'</span><span class='Delimiter'>; 
</span>            <a href="varbit.c.html#LN569"><span class='Ref_To_Local'>x</span></a> <span class='Operator'>&LT;&LT;= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>} 
</span>    <span class='Operator'>*</span><a href="varbit.c.html#LN567"><span class='Ref_To_Local'>r</span></a> <span class='Operator'>= </span><span class='String'>'\0'</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/fmgr.h.html#LN321"><span class='Ref_to_Macro'>PG_RETURN_CSTRING</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN566"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end varbit_out &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 *      varbit_recv         - converts external binary format to varbit 
 * 
 * External format is the bitlen as an int32, then the byte array. 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN609"></a><span class='Declare_Function'>varbit_recv</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN611"></a>    <a href="../../../include/lib/stringinfo.h.html#LN42"><span class='Ref_to_Typedef'>StringInfo</span></a>  <span class='Declare_Local'>buf</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/lib/stringinfo.h.html#LN42"><span class='Ref_to_Typedef'>StringInfo</span></a><span class='Parentheses'>) </span><a href="../../../include/fmgr.h.html#LN240"><span class='Ref_to_Macro'>PG_GETARG_POINTER</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
<span class='Directive'>#ifdef</span> NOT_USED 
<a name="LN614"></a>    <a href="../../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>typelem</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN239"><span class='Ref_to_Macro'>PG_GETARG_OID</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><span class='Directive'>#endif</span> 
<a name="LN616"></a>    <a href="../../../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>       <span class='Declare_Local'>atttypmod</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN233"><span class='Ref_to_Macro'>PG_GETARG_INT32</span></a><span class='Parentheses'>(</span><span class='Number'>2</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN617"></a>    <a href="../../../include/utils/varbit.h.html#LN24"><span class='Ref_to_Typedef'>VarBit</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span><a name="LN618"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>len</span><span class='Delimiter'>, 
</span><a name="LN619"></a>                <span class='Declare_Local'>bitlen</span><span class='Delimiter'>; 
</span><a name="LN620"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>ipad</span><span class='Delimiter'>; 
</span><a name="LN621"></a>    <a href="../../../include/c.h.html#LN274"><span class='Ref_to_Typedef'>bits8</span></a>       <span class='Declare_Local'>mask</span><span class='Delimiter'>; 
</span> 
    <a href="varbit.c.html#LN619"><span class='Ref_To_Local'>bitlen</span></a> <span class='Operator'>= </span><a href="../../../include/libpq/pqformat.h.html#LN38"><span class='Ref_to_Proto'>pq_getmsgint</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN611"><span class='Ref_To_Local'>buf</span></a><span class='Delimiter'>, </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="varbit.c.html#LN619"><span class='Ref_To_Local'>bitlen</span></a> <span class='Operator'>&LT; </span><span class='Number'>0</span> <span class='Operator'>|| </span><a href="varbit.c.html#LN619"><span class='Ref_To_Local'>bitlen</span></a> <span class='Operator'>&GT; </span><a href="../../../include/utils/varbit.h.html#LN62"><span class='Ref_to_Const'>VARBITMAXLEN</span></a><span class='Parentheses'>) 
</span>        <a href="../../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INVALID_BINARY_REPRESENTATION<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"invalid length in external bit string"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Sometimes atttypmod is not supplied. If it is supplied we need to make 
     * sure that the bitstring fits. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="varbit.c.html#LN616"><span class='Ref_To_Local'>atttypmod</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span> <span class='Operator'>&& </span><a href="varbit.c.html#LN619"><span class='Ref_To_Local'>bitlen</span></a> <span class='Operator'>&GT; </span><a href="varbit.c.html#LN616"><span class='Ref_To_Local'>atttypmod</span></a><span class='Parentheses'>) 
</span>        <a href="../../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_STRING_DATA_RIGHT_TRUNCATION<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"bit string too long for type bit varying(%d)"</span><span class='Delimiter'>, 
</span>                        <a href="varbit.c.html#LN616"><span class='Ref_To_Local'>atttypmod</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
    <a href="varbit.c.html#LN618"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>= </span><a href="../../../include/utils/varbit.h.html#LN56"><span class='Ref_to_Macro'>VARBITTOTALLEN</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN619"><span class='Ref_To_Local'>bitlen</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="varbit.c.html#LN617"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/utils/varbit.h.html#LN24"><span class='Ref_to_Typedef'>VarBit</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN618"><span class='Ref_To_Local'>len</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../../include/postgres.h.html#LN327"><span class='Ref_to_Macro'>SET_VARSIZE</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN617"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>, </span><a href="varbit.c.html#LN618"><span class='Ref_To_Local'>len</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../../include/utils/varbit.h.html#LN48"><span class='Ref_to_Macro'>VARBITLEN</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN617"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>) </span><span class='Operator'>= </span><a href="varbit.c.html#LN619"><span class='Ref_To_Local'>bitlen</span></a><span class='Delimiter'>; 
</span> 
    <a href="../../../include/libpq/pqformat.h.html#LN43"><span class='Ref_to_Proto'>pq_copymsgbytes</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN611"><span class='Ref_To_Local'>buf</span></a><span class='Delimiter'>, </span><span class='Parentheses'>(</span><span class='Keyword'>char </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/utils/varbit.h.html#LN50"><span class='Ref_to_Macro'>VARBITS</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN617"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="../../../include/utils/varbit.h.html#LN52"><span class='Ref_to_Macro'>VARBITBYTES</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN617"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Make sure last byte is zero-padded if needed */ 
</span>    <a href="varbit.c.html#LN620"><span class='Ref_To_Local'>ipad</span></a> <span class='Operator'>= </span><a href="../../../include/utils/varbit.h.html#LN54"><span class='Ref_to_Macro'>VARBITPAD</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN617"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="varbit.c.html#LN620"><span class='Ref_To_Local'>ipad</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="varbit.c.html#LN621"><span class='Ref_To_Local'>mask</span></a> <span class='Operator'>= </span><a href="../../../include/utils/varbit.h.html#LN66"><span class='Ref_to_Const'>BITMASK</span></a> <span class='Operator'>&LT;&LT; </span><a href="varbit.c.html#LN620"><span class='Ref_To_Local'>ipad</span></a><span class='Delimiter'>; 
</span>        <span class='Operator'>*</span><span class='Parentheses'>(</span><a href="../../../include/utils/varbit.h.html#LN50"><span class='Ref_to_Macro'>VARBITS</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN617"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>) </span><span class='Operator'>+ </span><a href="../../../include/utils/varbit.h.html#LN52"><span class='Ref_to_Macro'>VARBITBYTES</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN617"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>) </span><span class='Operator'>- </span><span class='Number'>1</span><span class='Parentheses'>)</span> <span class='Operator'>&= </span><a href="varbit.c.html#LN621"><span class='Ref_To_Local'>mask</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="../../../include/utils/varbit.h.html#LN43"><span class='Ref_to_Macro'>PG_RETURN_VARBIT_P</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN617"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end varbit_recv &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 *      varbit_send         - converts varbit to binary format 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN661"></a><span class='Declare_Function'>varbit_send</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN663"></a>    <a href="../../../include/utils/varbit.h.html#LN24"><span class='Ref_to_Typedef'>VarBit</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>s</span> <span class='Operator'>= </span><a href="../../../include/utils/varbit.h.html#LN41"><span class='Ref_to_Macro'>PG_GETARG_VARBIT_P</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN664"></a>    <a href="../../../include/lib/stringinfo.h.html#LN34"><span class='Ref_to_Struct'>StringInfoData</span></a> <span class='Declare_Local'>buf</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/libpq/pqformat.h.html#LN31"><span class='Ref_to_Proto'>pq_begintypsend</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="varbit.c.html#LN664"><span class='Ref_To_Local'>buf</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../../include/libpq/pqformat.h.html#LN25"><span class='Ref_to_Proto'>pq_sendint</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="varbit.c.html#LN664"><span class='Ref_To_Local'>buf</span></a><span class='Delimiter'>, </span><a href="../../../include/utils/varbit.h.html#LN48"><span class='Ref_to_Macro'>VARBITLEN</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN663"><span class='Ref_To_Local'>s</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../../../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <a href="../../../include/libpq/pqformat.h.html#LN19"><span class='Ref_to_Proto'>pq_sendbytes</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="varbit.c.html#LN664"><span class='Ref_To_Local'>buf</span></a><span class='Delimiter'>, </span><span class='Parentheses'>(</span><span class='Keyword'>char </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/utils/varbit.h.html#LN50"><span class='Ref_to_Macro'>VARBITS</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN663"><span class='Ref_To_Local'>s</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="../../../include/utils/varbit.h.html#LN52"><span class='Ref_to_Macro'>VARBITBYTES</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN663"><span class='Ref_To_Local'>s</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <a href="../../../include/fmgr.h.html#LN328"><span class='Ref_to_Macro'>PG_RETURN_BYTEA_P</span></a><span class='Parentheses'>(</span><a href="../../../include/libpq/pqformat.h.html#LN32"><span class='Ref_to_Proto'>pq_endtypsend</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="varbit.c.html#LN664"><span class='Ref_To_Local'>buf</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * varbit_transform() 
 * Flatten calls to varbit's length coercion function that set the new maximum 
 * length &GT;= the previous maximum length.  We can ignore the isExplicit 
 * argument, since that only affects truncation cases. 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN679"></a><span class='Declare_Function'>varbit_transform</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN681"></a>    <a href="../../../include/nodes/primnodes.h.html#LN444"><span class='Ref_to_Struct'>FuncExpr</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>expr</span> <span class='Operator'>= </span><a href="../../../include/nodes/nodes.h.html#LN575"><span class='Ref_to_Macro'>castNode</span></a><span class='Parentheses'>(</span><a href="../../../include/nodes/primnodes.h.html#LN444"><span class='Ref_to_Struct'>FuncExpr</span></a><span class='Delimiter'>, </span><a href="../../../include/fmgr.h.html#LN240"><span class='Ref_to_Macro'>PG_GETARG_POINTER</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span><a name="LN682"></a>    <a href="../../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>ret</span> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span><a name="LN683"></a>    <a href="../../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>typmod</span><span class='Delimiter'>; 
</span> 
    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="../../../include/nodes/pg_list.h.html#LN87"><span class='Ref_to_Func'>list_length</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN681"><span class='Ref_To_Local'>expr</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/primnodes.h.html#LN455"><span class='Ref_to_Member'>args</span></a><span class='Parentheses'>) </span><span class='Operator'>&GT;= </span><span class='Number'>2</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="varbit.c.html#LN683"><span class='Ref_To_Local'>typmod</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/nodes/pg_list.h.html#LN115"><span class='Ref_to_Macro'>lsecond</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN681"><span class='Ref_To_Local'>expr</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/primnodes.h.html#LN455"><span class='Ref_to_Member'>args</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/nodes/nodes.h.html#LN559"><span class='Ref_to_Macro'>IsA</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN683"><span class='Ref_To_Local'>typmod</span></a><span class='Delimiter'>, </span><a href="../../../include/nodes/primnodes.h.html#LN188"><span class='Ref_to_Struct'>Const</span></a><span class='Parentheses'>)</span> <span class='Operator'>&&!</span><span class='Parentheses'>((</span><a href="../../../include/nodes/primnodes.h.html#LN188"><span class='Ref_to_Struct'>Const</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="varbit.c.html#LN683"><span class='Ref_To_Local'>typmod</span></a><span class='Parentheses'>)</span><span class='Operator'>-&GT;</span>constisnull<span class='Parentheses'>)</span> 
    <span class='Delimiter'>{ 
</span><a name="LN691"></a>        <a href="../../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a>       <span class='Operator'>*</span><span class='Declare_Local'>source</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/nodes/nodes.h.html#LN508"><span class='Ref_to_Struct'>Node</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/nodes/pg_list.h.html#LN110"><span class='Ref_to_Macro'>linitial</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN681"><span class='Ref_To_Local'>expr</span></a><span class='Operator'>-&GT;</span><a href="../../../include/nodes/primnodes.h.html#LN455"><span class='Ref_to_Member'>args</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN692"></a>        <a href="../../../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>       <span class='Declare_Local'>new_typmod</span> <span class='Operator'>= </span><a href="../../../include/postgres.h.html#LN477"><span class='Ref_to_Macro'>DatumGetInt32</span></a><span class='Parentheses'>(((</span><a href="../../../include/nodes/primnodes.h.html#LN188"><span class='Ref_to_Struct'>Const</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="varbit.c.html#LN683"><span class='Ref_To_Local'>typmod</span></a><span class='Parentheses'>)</span><span class='Operator'>-&GT;</span>constvalue<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN693"></a>        <a href="../../../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>       <span class='Declare_Local'>old_max</span> <span class='Operator'>= </span><a href="../../../include/nodes/nodeFuncs.h.html#LN32"><span class='Ref_to_Proto'>exprTypmod</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN691"><span class='Ref_To_Local'>source</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN694"></a>        <a href="../../../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>       <span class='Declare_Local'>new_max</span> <span class='Operator'>= </span><a href="varbit.c.html#LN692"><span class='Ref_To_Local'>new_typmod</span></a><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* Note: varbit() treats typmod 0 as invalid, so we do too */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="varbit.c.html#LN694"><span class='Ref_To_Local'>new_max</span></a> <span class='Operator'>&LT;= </span><span class='Number'>0</span> <span class='Operator'>|| </span><span class='Parentheses'>(</span><a href="varbit.c.html#LN693"><span class='Ref_To_Local'>old_max</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span> <span class='Operator'>&& </span><a href="varbit.c.html#LN693"><span class='Ref_To_Local'>old_max</span></a> <span class='Operator'>&LT;= </span><a href="varbit.c.html#LN694"><span class='Ref_To_Local'>new_max</span></a><span class='Parentheses'>))</span> 
            <a href="varbit.c.html#LN682"><span class='Ref_To_Local'>ret</span></a> <span class='Operator'>= </span><a href="../../../include/nodes/nodeFuncs.h.html#LN34"><span class='Ref_to_Proto'>relabel_to_typmod</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN691"><span class='Ref_To_Local'>source</span></a><span class='Delimiter'>, </span><a href="varbit.c.html#LN692"><span class='Ref_To_Local'>new_typmod</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="../../../include/fmgr.h.html#LN320"><span class='Ref_to_Macro'>PG_RETURN_POINTER</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN682"><span class='Ref_To_Local'>ret</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end varbit_transform &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * varbit() 
 * Converts a varbit() type to a specific internal length. 
 * len is the maximum bitlength specified in the column definition. 
 * 
 * If doing implicit cast, raise error when source data is too long. 
 * If doing explicit cast, silently truncate to max length. 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN713"></a><span class='Declare_Function'>varbit</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN715"></a>    <a href="../../../include/utils/varbit.h.html#LN24"><span class='Ref_to_Typedef'>VarBit</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>arg</span> <span class='Operator'>= </span><a href="../../../include/utils/varbit.h.html#LN41"><span class='Ref_to_Macro'>PG_GETARG_VARBIT_P</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN716"></a>    <a href="../../../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>       <span class='Declare_Local'>len</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN233"><span class='Ref_to_Macro'>PG_GETARG_INT32</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN717"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>isExplicit</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN238"><span class='Ref_to_Macro'>PG_GETARG_BOOL</span></a><span class='Parentheses'>(</span><span class='Number'>2</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN718"></a>    <a href="../../../include/utils/varbit.h.html#LN24"><span class='Ref_to_Typedef'>VarBit</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span><a name="LN719"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>rlen</span><span class='Delimiter'>; 
</span><a name="LN720"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>ipad</span><span class='Delimiter'>; 
</span><a name="LN721"></a>    <a href="../../../include/c.h.html#LN274"><span class='Ref_to_Typedef'>bits8</span></a>       <span class='Declare_Local'>mask</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* No work if typmod is invalid or supplied data matches it already */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="varbit.c.html#LN716"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>&LT;= </span><span class='Number'>0</span> <span class='Operator'>|| </span><a href="varbit.c.html#LN716"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>&GT;= </span><a href="../../../include/utils/varbit.h.html#LN48"><span class='Ref_to_Macro'>VARBITLEN</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN715"><span class='Ref_To_Local'>arg</span></a><span class='Parentheses'>))</span> 
        <a href="../../../include/utils/varbit.h.html#LN43"><span class='Ref_to_Macro'>PG_RETURN_VARBIT_P</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN715"><span class='Ref_To_Local'>arg</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="varbit.c.html#LN717"><span class='Ref_To_Local'>isExplicit</span></a><span class='Parentheses'>) 
</span>        <a href="../../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_STRING_DATA_RIGHT_TRUNCATION<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"bit string too long for type bit varying(%d)"</span><span class='Delimiter'>, 
</span>                        <a href="varbit.c.html#LN716"><span class='Ref_To_Local'>len</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
    <a href="varbit.c.html#LN719"><span class='Ref_To_Local'>rlen</span></a> <span class='Operator'>= </span><a href="../../../include/utils/varbit.h.html#LN56"><span class='Ref_to_Macro'>VARBITTOTALLEN</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN716"><span class='Ref_To_Local'>len</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="varbit.c.html#LN718"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/utils/varbit.h.html#LN24"><span class='Ref_to_Typedef'>VarBit</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN719"><span class='Ref_To_Local'>rlen</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../../include/postgres.h.html#LN327"><span class='Ref_to_Macro'>SET_VARSIZE</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN718"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>, </span><a href="varbit.c.html#LN719"><span class='Ref_To_Local'>rlen</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../../include/utils/varbit.h.html#LN48"><span class='Ref_to_Macro'>VARBITLEN</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN718"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>) </span><span class='Operator'>= </span><a href="varbit.c.html#LN716"><span class='Ref_To_Local'>len</span></a><span class='Delimiter'>; 
</span> 
    memcpy<span class='Parentheses'>(</span><a href="../../../include/utils/varbit.h.html#LN50"><span class='Ref_to_Macro'>VARBITS</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN718"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="../../../include/utils/varbit.h.html#LN50"><span class='Ref_to_Macro'>VARBITS</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN715"><span class='Ref_To_Local'>arg</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="../../../include/utils/varbit.h.html#LN52"><span class='Ref_to_Macro'>VARBITBYTES</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN718"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Make sure last byte is zero-padded if needed */ 
</span>    <a href="varbit.c.html#LN720"><span class='Ref_To_Local'>ipad</span></a> <span class='Operator'>= </span><a href="../../../include/utils/varbit.h.html#LN54"><span class='Ref_to_Macro'>VARBITPAD</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN718"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="varbit.c.html#LN720"><span class='Ref_To_Local'>ipad</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="varbit.c.html#LN721"><span class='Ref_To_Local'>mask</span></a> <span class='Operator'>= </span><a href="../../../include/utils/varbit.h.html#LN66"><span class='Ref_to_Const'>BITMASK</span></a> <span class='Operator'>&LT;&LT; </span><a href="varbit.c.html#LN720"><span class='Ref_To_Local'>ipad</span></a><span class='Delimiter'>; 
</span>        <span class='Operator'>*</span><span class='Parentheses'>(</span><a href="../../../include/utils/varbit.h.html#LN50"><span class='Ref_to_Macro'>VARBITS</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN718"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>) </span><span class='Operator'>+ </span><a href="../../../include/utils/varbit.h.html#LN52"><span class='Ref_to_Macro'>VARBITBYTES</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN718"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>) </span><span class='Operator'>- </span><span class='Number'>1</span><span class='Parentheses'>)</span> <span class='Operator'>&= </span><a href="varbit.c.html#LN721"><span class='Ref_To_Local'>mask</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="../../../include/utils/varbit.h.html#LN43"><span class='Ref_to_Macro'>PG_RETURN_VARBIT_P</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN718"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end varbit &raquo; </span> 
 
<a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN752"></a><span class='Declare_Function'>varbittypmodin</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN754"></a>    <a href="../../../include/utils/array.h.html#LN75"><span class='Ref_to_Typedef'>ArrayType</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>ta</span> <span class='Operator'>= </span><a href="../../../include/utils/array.h.html#LN243"><span class='Ref_to_Macro'>PG_GETARG_ARRAYTYPE_P</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/fmgr.h.html#LN313"><span class='Ref_to_Macro'>PG_RETURN_INT32</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN36"><span class='Ref_to_Func'>anybit_typmodin</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN754"><span class='Ref_To_Local'>ta</span></a><span class='Delimiter'>, </span><span class='String'>"varbit"</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
} 
</span> 
<a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN760"></a><span class='Declare_Function'>varbittypmodout</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN762"></a>    <a href="../../../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>       <span class='Declare_Local'>typmod</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN233"><span class='Ref_to_Macro'>PG_GETARG_INT32</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/fmgr.h.html#LN321"><span class='Ref_to_Macro'>PG_RETURN_CSTRING</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN73"><span class='Ref_to_Func'>anybit_typmodout</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN762"><span class='Ref_To_Local'>typmod</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
} 
</span> 
 
<span class='Comment_Multi_Line'>/* 
 * Comparison operators 
 * 
 * We only need one set of comparison operators for bitstrings, as the lengths 
 * are stored in the same way for zero-padded and varying bit strings. 
 * 
 * Note that the standard is not unambiguous about the comparison between 
 * zero-padded bit strings and varying bitstrings. If the same value is written 
 * into a zero padded bitstring as into a varying bitstring, but the zero 
 * padded bitstring has greater length, it will be bigger. 
 * 
 * Zeros from the beginning of a bitstring cannot simply be ignored, as they 
 * may be part of a bit string and may be significant. 
 * 
 * Note: btree indexes need these routines not to leak memory; therefore, 
 * be careful to free working copies of toasted datums.  Most places don't 
 * need to be so careful. 
 */ 
</span> 
<span class='Comment_Multi_Line'>/* 
 * bit_cmp 
 * 
 * Compares two bitstrings and returns &LT;0, 0, &GT;0 depending on whether the first 
 * string is smaller, equal, or bigger than the second. All bits are considered 
 * and additional zero bits may make one string smaller/larger than the other, 
 * even if their zero-padded values would be the same. 
 */ 
</span><span class='Keyword'>static </span><a href="../../../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a> 
<a name="LN796"></a><span class='Declare_Function'>bit_cmp</span><span class='Parentheses'>(</span><a href="../../../include/utils/varbit.h.html#LN24"><span class='Ref_to_Typedef'>VarBit</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>arg1</span><span class='Delimiter'>, </span><a href="../../../include/utils/varbit.h.html#LN24"><span class='Ref_to_Typedef'>VarBit</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>arg2</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN798"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>bitlen1</span><span class='Delimiter'>, 
</span><a name="LN799"></a>                <span class='Declare_Local'>bytelen1</span><span class='Delimiter'>, 
</span><a name="LN800"></a>                <span class='Declare_Local'>bitlen2</span><span class='Delimiter'>, 
</span><a name="LN801"></a>                <span class='Declare_Local'>bytelen2</span><span class='Delimiter'>; 
</span><a name="LN802"></a>    <a href="../../../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>       <span class='Declare_Local'>cmp</span><span class='Delimiter'>; 
</span> 
    <a href="varbit.c.html#LN799"><span class='Ref_To_Local'>bytelen1</span></a> <span class='Operator'>= </span><a href="../../../include/utils/varbit.h.html#LN52"><span class='Ref_to_Macro'>VARBITBYTES</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN796"><span class='Ref_to_Parameter'>arg1</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="varbit.c.html#LN801"><span class='Ref_To_Local'>bytelen2</span></a> <span class='Operator'>= </span><a href="../../../include/utils/varbit.h.html#LN52"><span class='Ref_to_Macro'>VARBITBYTES</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN796"><span class='Ref_to_Parameter'>arg2</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="varbit.c.html#LN802"><span class='Ref_To_Local'>cmp</span></a> <span class='Operator'>= </span>memcmp<span class='Parentheses'>(</span><a href="../../../include/utils/varbit.h.html#LN50"><span class='Ref_to_Macro'>VARBITS</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN796"><span class='Ref_to_Parameter'>arg1</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="../../../include/utils/varbit.h.html#LN50"><span class='Ref_to_Macro'>VARBITS</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN796"><span class='Ref_to_Parameter'>arg2</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="../../../interfaces/ecpg/pgtypeslib/numeric.c.html#LN11"><span class='Ref_to_Macro'>Min</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN799"><span class='Ref_To_Local'>bytelen1</span></a><span class='Delimiter'>, </span><a href="varbit.c.html#LN801"><span class='Ref_To_Local'>bytelen2</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="varbit.c.html#LN802"><span class='Ref_To_Local'>cmp</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="varbit.c.html#LN798"><span class='Ref_To_Local'>bitlen1</span></a> <span class='Operator'>= </span><a href="../../../include/utils/varbit.h.html#LN48"><span class='Ref_to_Macro'>VARBITLEN</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN796"><span class='Ref_to_Parameter'>arg1</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="varbit.c.html#LN800"><span class='Ref_To_Local'>bitlen2</span></a> <span class='Operator'>= </span><a href="../../../include/utils/varbit.h.html#LN48"><span class='Ref_to_Macro'>VARBITLEN</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN796"><span class='Ref_to_Parameter'>arg2</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="varbit.c.html#LN798"><span class='Ref_To_Local'>bitlen1</span></a> <span class='Operator'>!= </span><a href="varbit.c.html#LN800"><span class='Ref_To_Local'>bitlen2</span></a><span class='Parentheses'>) 
</span>            <a href="varbit.c.html#LN802"><span class='Ref_To_Local'>cmp</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="varbit.c.html#LN798"><span class='Ref_To_Local'>bitlen1</span></a> <span class='Operator'>&LT; </span><a href="varbit.c.html#LN800"><span class='Ref_To_Local'>bitlen2</span></a><span class='Parentheses'>) </span><span class='Operator'>? -</span><span class='Number'>1</span> <span class='Operator'>: </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>return</span> <a href="varbit.c.html#LN802"><span class='Ref_To_Local'>cmp</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end bit_cmp &raquo; </span> 
 
<a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN819"></a><span class='Declare_Function'>biteq</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN821"></a>    <a href="../../../include/utils/varbit.h.html#LN24"><span class='Ref_to_Typedef'>VarBit</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>arg1</span> <span class='Operator'>= </span><a href="../../../include/utils/varbit.h.html#LN41"><span class='Ref_to_Macro'>PG_GETARG_VARBIT_P</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN822"></a>    <a href="../../../include/utils/varbit.h.html#LN24"><span class='Ref_to_Typedef'>VarBit</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>arg2</span> <span class='Operator'>= </span><a href="../../../include/utils/varbit.h.html#LN41"><span class='Ref_to_Macro'>PG_GETARG_VARBIT_P</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN823"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span><a name="LN824"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>bitlen1</span><span class='Delimiter'>, 
</span><a name="LN825"></a>                <span class='Declare_Local'>bitlen2</span><span class='Delimiter'>; 
</span> 
    <a href="varbit.c.html#LN824"><span class='Ref_To_Local'>bitlen1</span></a> <span class='Operator'>= </span><a href="../../../include/utils/varbit.h.html#LN48"><span class='Ref_to_Macro'>VARBITLEN</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN821"><span class='Ref_To_Local'>arg1</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="varbit.c.html#LN825"><span class='Ref_To_Local'>bitlen2</span></a> <span class='Operator'>= </span><a href="../../../include/utils/varbit.h.html#LN48"><span class='Ref_to_Macro'>VARBITLEN</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN822"><span class='Ref_To_Local'>arg2</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* fast path for different-length inputs */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="varbit.c.html#LN824"><span class='Ref_To_Local'>bitlen1</span></a> <span class='Operator'>!= </span><a href="varbit.c.html#LN825"><span class='Ref_To_Local'>bitlen2</span></a><span class='Parentheses'>) 
</span>        <a href="varbit.c.html#LN823"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
        <a href="varbit.c.html#LN823"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="varbit.c.html#LN795"><span class='Ref_to_Func'>bit_cmp</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN821"><span class='Ref_To_Local'>arg1</span></a><span class='Delimiter'>, </span><a href="varbit.c.html#LN822"><span class='Ref_To_Local'>arg2</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/fmgr.h.html#LN224"><span class='Ref_to_Macro'>PG_FREE_IF_COPY</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN821"><span class='Ref_To_Local'>arg1</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../../include/fmgr.h.html#LN224"><span class='Ref_to_Macro'>PG_FREE_IF_COPY</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN822"><span class='Ref_To_Local'>arg2</span></a><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN823"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end biteq &raquo; </span> 
 
<a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN843"></a><span class='Declare_Function'>bitne</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN845"></a>    <a href="../../../include/utils/varbit.h.html#LN24"><span class='Ref_to_Typedef'>VarBit</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>arg1</span> <span class='Operator'>= </span><a href="../../../include/utils/varbit.h.html#LN41"><span class='Ref_to_Macro'>PG_GETARG_VARBIT_P</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN846"></a>    <a href="../../../include/utils/varbit.h.html#LN24"><span class='Ref_to_Typedef'>VarBit</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>arg2</span> <span class='Operator'>= </span><a href="../../../include/utils/varbit.h.html#LN41"><span class='Ref_to_Macro'>PG_GETARG_VARBIT_P</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN847"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span><a name="LN848"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>bitlen1</span><span class='Delimiter'>, 
</span><a name="LN849"></a>                <span class='Declare_Local'>bitlen2</span><span class='Delimiter'>; 
</span> 
    <a href="varbit.c.html#LN848"><span class='Ref_To_Local'>bitlen1</span></a> <span class='Operator'>= </span><a href="../../../include/utils/varbit.h.html#LN48"><span class='Ref_to_Macro'>VARBITLEN</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN845"><span class='Ref_To_Local'>arg1</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="varbit.c.html#LN849"><span class='Ref_To_Local'>bitlen2</span></a> <span class='Operator'>= </span><a href="../../../include/utils/varbit.h.html#LN48"><span class='Ref_to_Macro'>VARBITLEN</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN846"><span class='Ref_To_Local'>arg2</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* fast path for different-length inputs */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="varbit.c.html#LN848"><span class='Ref_To_Local'>bitlen1</span></a> <span class='Operator'>!= </span><a href="varbit.c.html#LN849"><span class='Ref_To_Local'>bitlen2</span></a><span class='Parentheses'>) 
</span>        <a href="varbit.c.html#LN847"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
        <a href="varbit.c.html#LN847"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="varbit.c.html#LN795"><span class='Ref_to_Func'>bit_cmp</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN845"><span class='Ref_To_Local'>arg1</span></a><span class='Delimiter'>, </span><a href="varbit.c.html#LN846"><span class='Ref_To_Local'>arg2</span></a><span class='Parentheses'>) </span><span class='Operator'>!= </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/fmgr.h.html#LN224"><span class='Ref_to_Macro'>PG_FREE_IF_COPY</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN845"><span class='Ref_To_Local'>arg1</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../../include/fmgr.h.html#LN224"><span class='Ref_to_Macro'>PG_FREE_IF_COPY</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN846"><span class='Ref_To_Local'>arg2</span></a><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN847"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end bitne &raquo; </span> 
 
<a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN867"></a><span class='Declare_Function'>bitlt</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN869"></a>    <a href="../../../include/utils/varbit.h.html#LN24"><span class='Ref_to_Typedef'>VarBit</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>arg1</span> <span class='Operator'>= </span><a href="../../../include/utils/varbit.h.html#LN41"><span class='Ref_to_Macro'>PG_GETARG_VARBIT_P</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN870"></a>    <a href="../../../include/utils/varbit.h.html#LN24"><span class='Ref_to_Typedef'>VarBit</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>arg2</span> <span class='Operator'>= </span><a href="../../../include/utils/varbit.h.html#LN41"><span class='Ref_to_Macro'>PG_GETARG_VARBIT_P</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN871"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span> 
    <a href="varbit.c.html#LN871"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="varbit.c.html#LN795"><span class='Ref_to_Func'>bit_cmp</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN869"><span class='Ref_To_Local'>arg1</span></a><span class='Delimiter'>, </span><a href="varbit.c.html#LN870"><span class='Ref_To_Local'>arg2</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/fmgr.h.html#LN224"><span class='Ref_to_Macro'>PG_FREE_IF_COPY</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN869"><span class='Ref_To_Local'>arg1</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../../include/fmgr.h.html#LN224"><span class='Ref_to_Macro'>PG_FREE_IF_COPY</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN870"><span class='Ref_To_Local'>arg2</span></a><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN871"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN882"></a><span class='Declare_Function'>bitle</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN884"></a>    <a href="../../../include/utils/varbit.h.html#LN24"><span class='Ref_to_Typedef'>VarBit</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>arg1</span> <span class='Operator'>= </span><a href="../../../include/utils/varbit.h.html#LN41"><span class='Ref_to_Macro'>PG_GETARG_VARBIT_P</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN885"></a>    <a href="../../../include/utils/varbit.h.html#LN24"><span class='Ref_to_Typedef'>VarBit</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>arg2</span> <span class='Operator'>= </span><a href="../../../include/utils/varbit.h.html#LN41"><span class='Ref_to_Macro'>PG_GETARG_VARBIT_P</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN886"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span> 
    <a href="varbit.c.html#LN886"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="varbit.c.html#LN795"><span class='Ref_to_Func'>bit_cmp</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN884"><span class='Ref_To_Local'>arg1</span></a><span class='Delimiter'>, </span><a href="varbit.c.html#LN885"><span class='Ref_To_Local'>arg2</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT;= </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/fmgr.h.html#LN224"><span class='Ref_to_Macro'>PG_FREE_IF_COPY</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN884"><span class='Ref_To_Local'>arg1</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../../include/fmgr.h.html#LN224"><span class='Ref_to_Macro'>PG_FREE_IF_COPY</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN885"><span class='Ref_To_Local'>arg2</span></a><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN886"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN897"></a><span class='Declare_Function'>bitgt</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN899"></a>    <a href="../../../include/utils/varbit.h.html#LN24"><span class='Ref_to_Typedef'>VarBit</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>arg1</span> <span class='Operator'>= </span><a href="../../../include/utils/varbit.h.html#LN41"><span class='Ref_to_Macro'>PG_GETARG_VARBIT_P</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN900"></a>    <a href="../../../include/utils/varbit.h.html#LN24"><span class='Ref_to_Typedef'>VarBit</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>arg2</span> <span class='Operator'>= </span><a href="../../../include/utils/varbit.h.html#LN41"><span class='Ref_to_Macro'>PG_GETARG_VARBIT_P</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN901"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span> 
    <a href="varbit.c.html#LN901"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="varbit.c.html#LN795"><span class='Ref_to_Func'>bit_cmp</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN899"><span class='Ref_To_Local'>arg1</span></a><span class='Delimiter'>, </span><a href="varbit.c.html#LN900"><span class='Ref_To_Local'>arg2</span></a><span class='Parentheses'>) </span><span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/fmgr.h.html#LN224"><span class='Ref_to_Macro'>PG_FREE_IF_COPY</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN899"><span class='Ref_To_Local'>arg1</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../../include/fmgr.h.html#LN224"><span class='Ref_to_Macro'>PG_FREE_IF_COPY</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN900"><span class='Ref_To_Local'>arg2</span></a><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN901"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN912"></a><span class='Declare_Function'>bitge</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN914"></a>    <a href="../../../include/utils/varbit.h.html#LN24"><span class='Ref_to_Typedef'>VarBit</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>arg1</span> <span class='Operator'>= </span><a href="../../../include/utils/varbit.h.html#LN41"><span class='Ref_to_Macro'>PG_GETARG_VARBIT_P</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN915"></a>    <a href="../../../include/utils/varbit.h.html#LN24"><span class='Ref_to_Typedef'>VarBit</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>arg2</span> <span class='Operator'>= </span><a href="../../../include/utils/varbit.h.html#LN41"><span class='Ref_to_Macro'>PG_GETARG_VARBIT_P</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN916"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span> 
    <a href="varbit.c.html#LN916"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="varbit.c.html#LN795"><span class='Ref_to_Func'>bit_cmp</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN914"><span class='Ref_To_Local'>arg1</span></a><span class='Delimiter'>, </span><a href="varbit.c.html#LN915"><span class='Ref_To_Local'>arg2</span></a><span class='Parentheses'>) </span><span class='Operator'>&GT;= </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/fmgr.h.html#LN224"><span class='Ref_to_Macro'>PG_FREE_IF_COPY</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN914"><span class='Ref_To_Local'>arg1</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../../include/fmgr.h.html#LN224"><span class='Ref_to_Macro'>PG_FREE_IF_COPY</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN915"><span class='Ref_To_Local'>arg2</span></a><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/fmgr.h.html#LN318"><span class='Ref_to_Macro'>PG_RETURN_BOOL</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN916"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN927"></a><span class='Declare_Function'>bitcmp</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN929"></a>    <a href="../../../include/utils/varbit.h.html#LN24"><span class='Ref_to_Typedef'>VarBit</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>arg1</span> <span class='Operator'>= </span><a href="../../../include/utils/varbit.h.html#LN41"><span class='Ref_to_Macro'>PG_GETARG_VARBIT_P</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN930"></a>    <a href="../../../include/utils/varbit.h.html#LN24"><span class='Ref_to_Typedef'>VarBit</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>arg2</span> <span class='Operator'>= </span><a href="../../../include/utils/varbit.h.html#LN41"><span class='Ref_to_Macro'>PG_GETARG_VARBIT_P</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN931"></a>    <a href="../../../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>       <span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span> 
    <a href="varbit.c.html#LN931"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="varbit.c.html#LN795"><span class='Ref_to_Func'>bit_cmp</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN929"><span class='Ref_To_Local'>arg1</span></a><span class='Delimiter'>, </span><a href="varbit.c.html#LN930"><span class='Ref_To_Local'>arg2</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/fmgr.h.html#LN224"><span class='Ref_to_Macro'>PG_FREE_IF_COPY</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN929"><span class='Ref_To_Local'>arg1</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../../include/fmgr.h.html#LN224"><span class='Ref_to_Macro'>PG_FREE_IF_COPY</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN930"><span class='Ref_To_Local'>arg2</span></a><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/fmgr.h.html#LN313"><span class='Ref_to_Macro'>PG_RETURN_INT32</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN931"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * bitcat 
 * Concatenation of bit strings 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN946"></a><span class='Declare_Function'>bitcat</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN948"></a>    <a href="../../../include/utils/varbit.h.html#LN24"><span class='Ref_to_Typedef'>VarBit</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>arg1</span> <span class='Operator'>= </span><a href="../../../include/utils/varbit.h.html#LN41"><span class='Ref_to_Macro'>PG_GETARG_VARBIT_P</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN949"></a>    <a href="../../../include/utils/varbit.h.html#LN24"><span class='Ref_to_Typedef'>VarBit</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>arg2</span> <span class='Operator'>= </span><a href="../../../include/utils/varbit.h.html#LN41"><span class='Ref_to_Macro'>PG_GETARG_VARBIT_P</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/utils/varbit.h.html#LN43"><span class='Ref_to_Macro'>PG_RETURN_VARBIT_P</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN27"><span class='Ref_to_Proto'>bit_catenate</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN948"><span class='Ref_To_Local'>arg1</span></a><span class='Delimiter'>, </span><a href="varbit.c.html#LN949"><span class='Ref_To_Local'>arg2</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
} 
</span> 
<span class='Keyword'>static </span><a href="../../../include/utils/varbit.h.html#LN24"><span class='Ref_to_Typedef'>VarBit</span></a> <span class='Operator'>* 
</span><a name="LN955"></a><span class='Declare_Function'>bit_catenate</span><span class='Parentheses'>(</span><a href="../../../include/utils/varbit.h.html#LN24"><span class='Ref_to_Typedef'>VarBit</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>arg1</span><span class='Delimiter'>, </span><a href="../../../include/utils/varbit.h.html#LN24"><span class='Ref_to_Typedef'>VarBit</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>arg2</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN957"></a>    <a href="../../../include/utils/varbit.h.html#LN24"><span class='Ref_to_Typedef'>VarBit</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span><a name="LN958"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>bitlen1</span><span class='Delimiter'>, 
</span><a name="LN959"></a>                <span class='Declare_Local'>bitlen2</span><span class='Delimiter'>, 
</span><a name="LN960"></a>                <span class='Declare_Local'>bytelen</span><span class='Delimiter'>, 
</span><a name="LN961"></a>                <span class='Declare_Local'>bit1pad</span><span class='Delimiter'>, 
</span><a name="LN962"></a>                <span class='Declare_Local'>bit2shift</span><span class='Delimiter'>; 
</span><a name="LN963"></a>    <a href="../../../include/c.h.html#LN274"><span class='Ref_to_Typedef'>bits8</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>pr</span><span class='Delimiter'>, 
</span><a name="LN964"></a>               <span class='Operator'>*</span><span class='Declare_Local'>pa</span><span class='Delimiter'>; 
</span> 
    <a href="varbit.c.html#LN958"><span class='Ref_To_Local'>bitlen1</span></a> <span class='Operator'>= </span><a href="../../../include/utils/varbit.h.html#LN48"><span class='Ref_to_Macro'>VARBITLEN</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN955"><span class='Ref_to_Parameter'>arg1</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="varbit.c.html#LN959"><span class='Ref_To_Local'>bitlen2</span></a> <span class='Operator'>= </span><a href="../../../include/utils/varbit.h.html#LN48"><span class='Ref_to_Macro'>VARBITLEN</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN955"><span class='Ref_to_Parameter'>arg2</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="varbit.c.html#LN958"><span class='Ref_To_Local'>bitlen1</span></a> <span class='Operator'>&GT; </span><a href="../../../include/utils/varbit.h.html#LN62"><span class='Ref_to_Const'>VARBITMAXLEN</span></a> <span class='Operator'>- </span><a href="varbit.c.html#LN959"><span class='Ref_To_Local'>bitlen2</span></a><span class='Parentheses'>) 
</span>        <a href="../../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_PROGRAM_LIMIT_EXCEEDED<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"bit string length exceeds the maximum allowed (%d)"</span><span class='Delimiter'>, 
</span>                        <a href="../../../include/utils/varbit.h.html#LN62"><span class='Ref_to_Const'>VARBITMAXLEN</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>    <a href="varbit.c.html#LN960"><span class='Ref_To_Local'>bytelen</span></a> <span class='Operator'>= </span><a href="../../../include/utils/varbit.h.html#LN56"><span class='Ref_to_Macro'>VARBITTOTALLEN</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN958"><span class='Ref_To_Local'>bitlen1</span></a> <span class='Operator'>+ </span><a href="varbit.c.html#LN959"><span class='Ref_To_Local'>bitlen2</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="varbit.c.html#LN957"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/utils/varbit.h.html#LN24"><span class='Ref_to_Typedef'>VarBit</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN960"><span class='Ref_To_Local'>bytelen</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../../include/postgres.h.html#LN327"><span class='Ref_to_Macro'>SET_VARSIZE</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN957"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>, </span><a href="varbit.c.html#LN960"><span class='Ref_To_Local'>bytelen</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../../include/utils/varbit.h.html#LN48"><span class='Ref_to_Macro'>VARBITLEN</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN957"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>) </span><span class='Operator'>= </span><a href="varbit.c.html#LN958"><span class='Ref_To_Local'>bitlen1</span></a> <span class='Operator'>+ </span><a href="varbit.c.html#LN959"><span class='Ref_To_Local'>bitlen2</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Copy the first bitstring in */ 
</span>    memcpy<span class='Parentheses'>(</span><a href="../../../include/utils/varbit.h.html#LN50"><span class='Ref_to_Macro'>VARBITS</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN957"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="../../../include/utils/varbit.h.html#LN50"><span class='Ref_to_Macro'>VARBITS</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN955"><span class='Ref_to_Parameter'>arg1</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="../../../include/utils/varbit.h.html#LN52"><span class='Ref_to_Macro'>VARBITBYTES</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN955"><span class='Ref_to_Parameter'>arg1</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Copy the second bit string */ 
</span>    <a href="varbit.c.html#LN961"><span class='Ref_To_Local'>bit1pad</span></a> <span class='Operator'>= </span><a href="../../../include/utils/varbit.h.html#LN54"><span class='Ref_to_Macro'>VARBITPAD</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN955"><span class='Ref_to_Parameter'>arg1</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="varbit.c.html#LN961"><span class='Ref_To_Local'>bit1pad</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        memcpy<span class='Parentheses'>(</span><a href="../../../include/utils/varbit.h.html#LN50"><span class='Ref_to_Macro'>VARBITS</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN957"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>) </span><span class='Operator'>+ </span><a href="../../../include/utils/varbit.h.html#LN52"><span class='Ref_to_Macro'>VARBITBYTES</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN955"><span class='Ref_to_Parameter'>arg1</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="../../../include/utils/varbit.h.html#LN50"><span class='Ref_to_Macro'>VARBITS</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN955"><span class='Ref_to_Parameter'>arg2</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>               <a href="../../../include/utils/varbit.h.html#LN52"><span class='Ref_to_Macro'>VARBITBYTES</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN955"><span class='Ref_to_Parameter'>arg2</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="varbit.c.html#LN959"><span class='Ref_To_Local'>bitlen2</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* We need to shift all the bits to fit */ 
</span>        <a href="varbit.c.html#LN962"><span class='Ref_To_Local'>bit2shift</span></a> <span class='Operator'>= </span><a href="../../../include/pg_config_manual.h.html#LN105"><span class='Ref_to_Const'>BITS_PER_BYTE</span></a> <span class='Operator'>- </span><a href="varbit.c.html#LN961"><span class='Ref_To_Local'>bit1pad</span></a><span class='Delimiter'>; 
</span>        <a href="varbit.c.html#LN963"><span class='Ref_To_Local'>pr</span></a> <span class='Operator'>= </span><a href="../../../include/utils/varbit.h.html#LN50"><span class='Ref_to_Macro'>VARBITS</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN957"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>) </span><span class='Operator'>+ </span><a href="../../../include/utils/varbit.h.html#LN52"><span class='Ref_to_Macro'>VARBITBYTES</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN955"><span class='Ref_to_Parameter'>arg1</span></a><span class='Parentheses'>) </span><span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>        <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="varbit.c.html#LN964"><span class='Ref_To_Local'>pa</span></a> <span class='Operator'>= </span><a href="../../../include/utils/varbit.h.html#LN50"><span class='Ref_to_Macro'>VARBITS</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN955"><span class='Ref_to_Parameter'>arg2</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; </span><a href="varbit.c.html#LN964"><span class='Ref_To_Local'>pa</span></a> <span class='Operator'>&LT; </span><a href="../../../include/utils/varbit.h.html#LN64"><span class='Ref_to_Macro'>VARBITEND</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN955"><span class='Ref_to_Parameter'>arg2</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; </span><a href="varbit.c.html#LN964"><span class='Ref_To_Local'>pa</span></a><span class='Operator'>++</span><span class='Parentheses'>)</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Operator'>*</span><a href="varbit.c.html#LN963"><span class='Ref_To_Local'>pr</span></a> <span class='Operator'>|= </span><span class='Parentheses'>((</span><span class='Operator'>*</span><a href="varbit.c.html#LN964"><span class='Ref_To_Local'>pa</span></a> <span class='Operator'>&GT;&GT; </span><a href="varbit.c.html#LN962"><span class='Ref_To_Local'>bit2shift</span></a><span class='Parentheses'>) </span><span class='Operator'>& </span><a href="../../../include/utils/varbit.h.html#LN66"><span class='Ref_to_Const'>BITMASK</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="varbit.c.html#LN963"><span class='Ref_To_Local'>pr</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="varbit.c.html#LN963"><span class='Ref_To_Local'>pr</span></a> <span class='Operator'>&LT; </span><a href="../../../include/utils/varbit.h.html#LN64"><span class='Ref_to_Macro'>VARBITEND</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN957"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>))</span> 
                <span class='Operator'>*</span><a href="varbit.c.html#LN963"><span class='Ref_To_Local'>pr</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="varbit.c.html#LN964"><span class='Ref_To_Local'>pa</span></a> <span class='Operator'>&LT;&LT; </span><a href="varbit.c.html#LN961"><span class='Ref_To_Local'>bit1pad</span></a><span class='Parentheses'>) </span><span class='Operator'>& </span><a href="../../../include/utils/varbit.h.html#LN66"><span class='Ref_to_Const'>BITMASK</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>return</span> <a href="varbit.c.html#LN957"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end bit_catenate &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * bitsubstr 
 * retrieve a substring from the bit string. 
 * Note, s is 1-based. 
 * SQL draft 6.10 9) 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN1014"></a><span class='Declare_Function'>bitsubstr</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <a href="../../../include/utils/varbit.h.html#LN43"><span class='Ref_to_Macro'>PG_RETURN_VARBIT_P</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN28"><span class='Ref_to_Proto'>bitsubstring</span></a><span class='Parentheses'>(</span><a href="../../../include/utils/varbit.h.html#LN41"><span class='Ref_to_Macro'>PG_GETARG_VARBIT_P</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                    <a href="../../../include/fmgr.h.html#LN233"><span class='Ref_to_Macro'>PG_GETARG_INT32</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                    <a href="../../../include/fmgr.h.html#LN233"><span class='Ref_to_Macro'>PG_GETARG_INT32</span></a><span class='Parentheses'>(</span><span class='Number'>2</span><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                    <span class='Boolean'>false</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
} 
</span> 
<a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN1023"></a><span class='Declare_Function'>bitsubstr_no_len</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <a href="../../../include/utils/varbit.h.html#LN43"><span class='Ref_to_Macro'>PG_RETURN_VARBIT_P</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN28"><span class='Ref_to_Proto'>bitsubstring</span></a><span class='Parentheses'>(</span><a href="../../../include/utils/varbit.h.html#LN41"><span class='Ref_to_Macro'>PG_GETARG_VARBIT_P</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                    <a href="../../../include/fmgr.h.html#LN233"><span class='Ref_to_Macro'>PG_GETARG_INT32</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                    <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Boolean'>true</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
} 
</span> 
<span class='Keyword'>static </span><a href="../../../include/utils/varbit.h.html#LN24"><span class='Ref_to_Typedef'>VarBit</span></a> <span class='Operator'>* 
</span><a name="LN1031"></a><span class='Declare_Function'>bitsubstring</span><span class='Parentheses'>(</span><a href="../../../include/utils/varbit.h.html#LN24"><span class='Ref_to_Typedef'>VarBit</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>arg</span><span class='Delimiter'>, </span><a href="../../../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a> <span class='Declare_Parameter'>s</span><span class='Delimiter'>, </span><a href="../../../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a> <span class='Declare_Parameter'>l</span><span class='Delimiter'>, </span><span class='Keyword'>bool </span><span class='Declare_Parameter'>length_not_specified</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1033"></a>    <a href="../../../include/utils/varbit.h.html#LN24"><span class='Ref_to_Typedef'>VarBit</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span><a name="LN1034"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>bitlen</span><span class='Delimiter'>, 
</span><a name="LN1035"></a>                <span class='Declare_Local'>rbitlen</span><span class='Delimiter'>, 
</span><a name="LN1036"></a>                <span class='Declare_Local'>len</span><span class='Delimiter'>, 
</span><a name="LN1037"></a>                <span class='Declare_Local'>ipad</span> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>, 
</span><a name="LN1038"></a>                <span class='Declare_Local'>ishift</span><span class='Delimiter'>, 
</span><a name="LN1039"></a>                <span class='Declare_Local'>i</span><span class='Delimiter'>; 
</span><a name="LN1040"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>e</span><span class='Delimiter'>, 
</span><a name="LN1041"></a>                <span class='Declare_Local'>s1</span><span class='Delimiter'>, 
</span><a name="LN1042"></a>                <span class='Declare_Local'>e1</span><span class='Delimiter'>; 
</span><a name="LN1043"></a>    <a href="../../../include/c.h.html#LN274"><span class='Ref_to_Typedef'>bits8</span></a>       <span class='Declare_Local'>mask</span><span class='Delimiter'>, 
</span><a name="LN1044"></a>               <span class='Operator'>*</span><span class='Declare_Local'>r</span><span class='Delimiter'>, 
</span><a name="LN1045"></a>               <span class='Operator'>*</span><span class='Declare_Local'>ps</span><span class='Delimiter'>; 
</span> 
    <a href="varbit.c.html#LN1034"><span class='Ref_To_Local'>bitlen</span></a> <span class='Operator'>= </span><a href="../../../include/utils/varbit.h.html#LN48"><span class='Ref_to_Macro'>VARBITLEN</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1031"><span class='Ref_to_Parameter'>arg</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="varbit.c.html#LN1041"><span class='Ref_To_Local'>s1</span></a> <span class='Operator'>= </span><a href="../../../interfaces/ecpg/pgtypeslib/numeric.c.html#LN10"><span class='Ref_to_Macro'>Max</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1031"><span class='Ref_to_Parameter'>s</span></a><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Comment_Multi_Line'>/* If we do not have an upper bound, use end of string */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="varbit.c.html#LN1031"><span class='Ref_to_Parameter'>length_not_specified</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="varbit.c.html#LN1042"><span class='Ref_To_Local'>e1</span></a> <span class='Operator'>= </span><a href="varbit.c.html#LN1034"><span class='Ref_To_Local'>bitlen</span></a> <span class='Operator'>+ </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <a href="varbit.c.html#LN1040"><span class='Ref_To_Local'>e</span></a> <span class='Operator'>= </span><a href="varbit.c.html#LN1031"><span class='Ref_to_Parameter'>s</span></a> <span class='Operator'>+ </span><a href="varbit.c.html#LN1031"><span class='Ref_to_Parameter'>l</span></a><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * A negative value for L is the only way for the end position to be 
         * before the start. SQL99 says to throw an error. 
         */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="varbit.c.html#LN1040"><span class='Ref_To_Local'>e</span></a> <span class='Operator'>&LT; </span><a href="varbit.c.html#LN1031"><span class='Ref_to_Parameter'>s</span></a><span class='Parentheses'>) 
</span>            <a href="../../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                    <span class='Parentheses'>(</span><a href="../../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_SUBSTRING_ERROR<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                     <a href="../error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"negative substring length not allowed"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>        <a href="varbit.c.html#LN1042"><span class='Ref_To_Local'>e1</span></a> <span class='Operator'>= </span><a href="../../../interfaces/ecpg/pgtypeslib/numeric.c.html#LN11"><span class='Ref_to_Macro'>Min</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1040"><span class='Ref_To_Local'>e</span></a><span class='Delimiter'>, </span><a href="varbit.c.html#LN1034"><span class='Ref_To_Local'>bitlen</span></a> <span class='Operator'>+ </span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="varbit.c.html#LN1041"><span class='Ref_To_Local'>s1</span></a> <span class='Operator'>&GT; </span><a href="varbit.c.html#LN1034"><span class='Ref_To_Local'>bitlen</span></a> <span class='Operator'>|| </span><a href="varbit.c.html#LN1042"><span class='Ref_To_Local'>e1</span></a> <span class='Operator'>&LT;= </span><a href="varbit.c.html#LN1041"><span class='Ref_To_Local'>s1</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* Need to return a zero-length bitstring */ 
</span>        <a href="varbit.c.html#LN1036"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>= </span><a href="../../../include/utils/varbit.h.html#LN56"><span class='Ref_to_Macro'>VARBITTOTALLEN</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="varbit.c.html#LN1033"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/utils/varbit.h.html#LN24"><span class='Ref_to_Typedef'>VarBit</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1036"><span class='Ref_To_Local'>len</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="../../../include/postgres.h.html#LN327"><span class='Ref_to_Macro'>SET_VARSIZE</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1033"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>, </span><a href="varbit.c.html#LN1036"><span class='Ref_To_Local'>len</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="../../../include/utils/varbit.h.html#LN48"><span class='Ref_to_Macro'>VARBITLEN</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1033"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>) </span><span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* 
         * OK, we've got a true substring starting at position s1-1 and ending 
         * at position e1-1 
         */ 
</span>        <a href="varbit.c.html#LN1035"><span class='Ref_To_Local'>rbitlen</span></a> <span class='Operator'>= </span><a href="varbit.c.html#LN1042"><span class='Ref_To_Local'>e1</span></a> <span class='Operator'>- </span><a href="varbit.c.html#LN1041"><span class='Ref_To_Local'>s1</span></a><span class='Delimiter'>; 
</span>        <a href="varbit.c.html#LN1036"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>= </span><a href="../../../include/utils/varbit.h.html#LN56"><span class='Ref_to_Macro'>VARBITTOTALLEN</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1035"><span class='Ref_To_Local'>rbitlen</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="varbit.c.html#LN1033"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/utils/varbit.h.html#LN24"><span class='Ref_to_Typedef'>VarBit</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1036"><span class='Ref_To_Local'>len</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="../../../include/postgres.h.html#LN327"><span class='Ref_to_Macro'>SET_VARSIZE</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1033"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>, </span><a href="varbit.c.html#LN1036"><span class='Ref_To_Local'>len</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="../../../include/utils/varbit.h.html#LN48"><span class='Ref_to_Macro'>VARBITLEN</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1033"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>) </span><span class='Operator'>= </span><a href="varbit.c.html#LN1035"><span class='Ref_To_Local'>rbitlen</span></a><span class='Delimiter'>; 
</span>        <a href="varbit.c.html#LN1036"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>-= </span><a href="../../../include/c.h.html#LN444"><span class='Ref_to_Const'>VARHDRSZ</span></a> <span class='Operator'>+ </span><a href="../../../include/utils/varbit.h.html#LN46"><span class='Ref_to_Const'>VARBITHDRSZ</span></a><span class='Delimiter'>; 
</span>        <span class='Comment_Multi_Line'>/* Are we copying from a byte boundary? */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="varbit.c.html#LN1041"><span class='Ref_To_Local'>s1</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Parentheses'>) </span><span class='Operator'>% </span><a href="../../../include/pg_config_manual.h.html#LN105"><span class='Ref_to_Const'>BITS_PER_BYTE</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* Yep, we are copying bytes */ 
</span>            memcpy<span class='Parentheses'>(</span><a href="../../../include/utils/varbit.h.html#LN50"><span class='Ref_to_Macro'>VARBITS</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1033"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="../../../include/utils/varbit.h.html#LN50"><span class='Ref_to_Macro'>VARBITS</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1031"><span class='Ref_to_Parameter'>arg</span></a><span class='Parentheses'>) </span><span class='Operator'>+ </span><span class='Parentheses'>(</span><a href="varbit.c.html#LN1041"><span class='Ref_To_Local'>s1</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Parentheses'>) </span><span class='Operator'>/ </span><a href="../../../include/pg_config_manual.h.html#LN105"><span class='Ref_to_Const'>BITS_PER_BYTE</span></a><span class='Delimiter'>, 
</span>                   <a href="varbit.c.html#LN1036"><span class='Ref_To_Local'>len</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* Figure out how much we need to shift the sequence by */ 
</span>            <a href="varbit.c.html#LN1038"><span class='Ref_To_Local'>ishift</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="varbit.c.html#LN1041"><span class='Ref_To_Local'>s1</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Parentheses'>) </span><span class='Operator'>% </span><a href="../../../include/pg_config_manual.h.html#LN105"><span class='Ref_to_Const'>BITS_PER_BYTE</span></a><span class='Delimiter'>; 
</span>            <a href="varbit.c.html#LN1044"><span class='Ref_To_Local'>r</span></a> <span class='Operator'>= </span><a href="../../../include/utils/varbit.h.html#LN50"><span class='Ref_to_Macro'>VARBITS</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1033"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="varbit.c.html#LN1045"><span class='Ref_To_Local'>ps</span></a> <span class='Operator'>= </span><a href="../../../include/utils/varbit.h.html#LN50"><span class='Ref_to_Macro'>VARBITS</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1031"><span class='Ref_to_Parameter'>arg</span></a><span class='Parentheses'>) </span><span class='Operator'>+ </span><span class='Parentheses'>(</span><a href="varbit.c.html#LN1041"><span class='Ref_To_Local'>s1</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Parentheses'>) </span><span class='Operator'>/ </span><a href="../../../include/pg_config_manual.h.html#LN105"><span class='Ref_to_Const'>BITS_PER_BYTE</span></a><span class='Delimiter'>; 
</span>            <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="varbit.c.html#LN1039"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="varbit.c.html#LN1039"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="varbit.c.html#LN1036"><span class='Ref_To_Local'>len</span></a><span class='Delimiter'>; </span><a href="varbit.c.html#LN1039"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <span class='Operator'>*</span><a href="varbit.c.html#LN1044"><span class='Ref_To_Local'>r</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="varbit.c.html#LN1045"><span class='Ref_To_Local'>ps</span></a> <span class='Operator'>&LT;&LT; </span><a href="varbit.c.html#LN1038"><span class='Ref_To_Local'>ishift</span></a><span class='Parentheses'>) </span><span class='Operator'>& </span><a href="../../../include/utils/varbit.h.html#LN66"><span class='Ref_to_Const'>BITMASK</span></a><span class='Delimiter'>; 
</span>                <span class='Control'>if</span> <span class='Parentheses'>((</span><span class='Operator'>++</span><a href="varbit.c.html#LN1045"><span class='Ref_To_Local'>ps</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT; </span><a href="../../../include/utils/varbit.h.html#LN64"><span class='Ref_to_Macro'>VARBITEND</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1031"><span class='Ref_to_Parameter'>arg</span></a><span class='Parentheses'>))</span> 
                    <span class='Operator'>*</span><a href="varbit.c.html#LN1044"><span class='Ref_To_Local'>r</span></a> <span class='Operator'>|= *</span><a href="varbit.c.html#LN1045"><span class='Ref_To_Local'>ps</span></a> <span class='Operator'>&GT;&GT; </span><span class='Parentheses'>(</span><a href="../../../include/pg_config_manual.h.html#LN105"><span class='Ref_to_Const'>BITS_PER_BYTE</span></a> <span class='Operator'>- </span><a href="varbit.c.html#LN1038"><span class='Ref_To_Local'>ishift</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <a href="varbit.c.html#LN1044"><span class='Ref_To_Local'>r</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>        <span class='Delimiter'>} 
</span>        <span class='Comment_Multi_Line'>/* Do we need to pad at the end? */ 
</span>        <a href="varbit.c.html#LN1037"><span class='Ref_To_Local'>ipad</span></a> <span class='Operator'>= </span><a href="../../../include/utils/varbit.h.html#LN54"><span class='Ref_to_Macro'>VARBITPAD</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1033"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="varbit.c.html#LN1037"><span class='Ref_To_Local'>ipad</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <a href="varbit.c.html#LN1043"><span class='Ref_To_Local'>mask</span></a> <span class='Operator'>= </span><a href="../../../include/utils/varbit.h.html#LN66"><span class='Ref_to_Const'>BITMASK</span></a> <span class='Operator'>&LT;&LT; </span><a href="varbit.c.html#LN1037"><span class='Ref_To_Local'>ipad</span></a><span class='Delimiter'>; 
</span>            <span class='Operator'>*</span><span class='Parentheses'>(</span><a href="../../../include/utils/varbit.h.html#LN50"><span class='Ref_to_Macro'>VARBITS</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1033"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>) </span><span class='Operator'>+ </span><a href="varbit.c.html#LN1036"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Parentheses'>)</span> <span class='Operator'>&= </span><a href="varbit.c.html#LN1043"><span class='Ref_To_Local'>mask</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end else &raquo; </span> 
 
    <span class='Control'>return</span> <a href="varbit.c.html#LN1033"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end bitsubstring &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * bitoverlay 
 *  Replace specified substring of first string with second 
 * 
 * The SQL standard defines OVERLAY() in terms of substring and concatenation. 
 * This code is a direct implementation of what the standard says. 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN1129"></a><span class='Declare_Function'>bitoverlay</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1131"></a>    <a href="../../../include/utils/varbit.h.html#LN24"><span class='Ref_to_Typedef'>VarBit</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>t1</span> <span class='Operator'>= </span><a href="../../../include/utils/varbit.h.html#LN41"><span class='Ref_to_Macro'>PG_GETARG_VARBIT_P</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1132"></a>    <a href="../../../include/utils/varbit.h.html#LN24"><span class='Ref_to_Typedef'>VarBit</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>t2</span> <span class='Operator'>= </span><a href="../../../include/utils/varbit.h.html#LN41"><span class='Ref_to_Macro'>PG_GETARG_VARBIT_P</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1133"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>sp</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN233"><span class='Ref_to_Macro'>PG_GETARG_INT32</span></a><span class='Parentheses'>(</span><span class='Number'>2</span><span class='Parentheses'>)</span><span class='Delimiter'>;</span>        <span class='Comment_Single_Line'>/* substring start position */ 
</span><a name="LN1134"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>sl</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN233"><span class='Ref_to_Macro'>PG_GETARG_INT32</span></a><span class='Parentheses'>(</span><span class='Number'>3</span><span class='Parentheses'>)</span><span class='Delimiter'>;</span>        <span class='Comment_Single_Line'>/* substring length */ 
</span> 
    <a href="../../../include/utils/varbit.h.html#LN43"><span class='Ref_to_Macro'>PG_RETURN_VARBIT_P</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN30"><span class='Ref_to_Proto'>bit_overlay</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1131"><span class='Ref_To_Local'>t1</span></a><span class='Delimiter'>, </span><a href="varbit.c.html#LN1132"><span class='Ref_To_Local'>t2</span></a><span class='Delimiter'>, </span><a href="varbit.c.html#LN1133"><span class='Ref_To_Local'>sp</span></a><span class='Delimiter'>, </span><a href="varbit.c.html#LN1134"><span class='Ref_To_Local'>sl</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
} 
</span> 
<a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN1140"></a><span class='Declare_Function'>bitoverlay_no_len</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1142"></a>    <a href="../../../include/utils/varbit.h.html#LN24"><span class='Ref_to_Typedef'>VarBit</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>t1</span> <span class='Operator'>= </span><a href="../../../include/utils/varbit.h.html#LN41"><span class='Ref_to_Macro'>PG_GETARG_VARBIT_P</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1143"></a>    <a href="../../../include/utils/varbit.h.html#LN24"><span class='Ref_to_Typedef'>VarBit</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>t2</span> <span class='Operator'>= </span><a href="../../../include/utils/varbit.h.html#LN41"><span class='Ref_to_Macro'>PG_GETARG_VARBIT_P</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1144"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>sp</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN233"><span class='Ref_to_Macro'>PG_GETARG_INT32</span></a><span class='Parentheses'>(</span><span class='Number'>2</span><span class='Parentheses'>)</span><span class='Delimiter'>;</span>        <span class='Comment_Single_Line'>/* substring start position */ 
</span><a name="LN1145"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>sl</span><span class='Delimiter'>; 
</span> 
    <a href="varbit.c.html#LN1145"><span class='Ref_To_Local'>sl</span></a> <span class='Operator'>= </span><a href="../../../include/utils/varbit.h.html#LN48"><span class='Ref_to_Macro'>VARBITLEN</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1143"><span class='Ref_To_Local'>t2</span></a><span class='Parentheses'>)</span><span class='Delimiter'>;</span>         <span class='Comment_Single_Line'>/* defaults to length(t2) */ 
</span>    <a href="../../../include/utils/varbit.h.html#LN43"><span class='Ref_to_Macro'>PG_RETURN_VARBIT_P</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN30"><span class='Ref_to_Proto'>bit_overlay</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1142"><span class='Ref_To_Local'>t1</span></a><span class='Delimiter'>, </span><a href="varbit.c.html#LN1143"><span class='Ref_To_Local'>t2</span></a><span class='Delimiter'>, </span><a href="varbit.c.html#LN1144"><span class='Ref_To_Local'>sp</span></a><span class='Delimiter'>, </span><a href="varbit.c.html#LN1145"><span class='Ref_To_Local'>sl</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
} 
</span> 
<span class='Keyword'>static </span><a href="../../../include/utils/varbit.h.html#LN24"><span class='Ref_to_Typedef'>VarBit</span></a> <span class='Operator'>* 
</span><a name="LN1152"></a><span class='Declare_Function'>bit_overlay</span><span class='Parentheses'>(</span><a href="../../../include/utils/varbit.h.html#LN24"><span class='Ref_to_Typedef'>VarBit</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>t1</span><span class='Delimiter'>, </span><a href="../../../include/utils/varbit.h.html#LN24"><span class='Ref_to_Typedef'>VarBit</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>t2</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>sp</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>sl</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1154"></a>    <a href="../../../include/utils/varbit.h.html#LN24"><span class='Ref_to_Typedef'>VarBit</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span><a name="LN1155"></a>    <a href="../../../include/utils/varbit.h.html#LN24"><span class='Ref_to_Typedef'>VarBit</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>s1</span><span class='Delimiter'>; 
</span><a name="LN1156"></a>    <a href="../../../include/utils/varbit.h.html#LN24"><span class='Ref_to_Typedef'>VarBit</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>s2</span><span class='Delimiter'>; 
</span><a name="LN1157"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>sp_pl_sl</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Check for possible integer-overflow cases.  For negative sp, throw a 
     * "substring length" error because that's what should be expected 
     * according to the spec's definition of OVERLAY(). 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="varbit.c.html#LN1152"><span class='Ref_to_Parameter'>sp</span></a> <span class='Operator'>&LT;= </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>        <a href="../../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_SUBSTRING_ERROR<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"negative substring length not allowed"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>    <a href="varbit.c.html#LN1157"><span class='Ref_To_Local'>sp_pl_sl</span></a> <span class='Operator'>= </span><a href="varbit.c.html#LN1152"><span class='Ref_to_Parameter'>sp</span></a> <span class='Operator'>+ </span><a href="varbit.c.html#LN1152"><span class='Ref_to_Parameter'>sl</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="varbit.c.html#LN1157"><span class='Ref_To_Local'>sp_pl_sl</span></a> <span class='Operator'>&LT;= </span><a href="varbit.c.html#LN1152"><span class='Ref_to_Parameter'>sl</span></a><span class='Parentheses'>) 
</span>        <a href="../../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_NUMERIC_VALUE_OUT_OF_RANGE<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"integer out of range"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
    <a href="varbit.c.html#LN1155"><span class='Ref_To_Local'>s1</span></a> <span class='Operator'>= </span><a href="varbit.c.html#LN28"><span class='Ref_to_Proto'>bitsubstring</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1152"><span class='Ref_to_Parameter'>t1</span></a><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Delimiter'>, </span><a href="varbit.c.html#LN1152"><span class='Ref_to_Parameter'>sp</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="varbit.c.html#LN1156"><span class='Ref_To_Local'>s2</span></a> <span class='Operator'>= </span><a href="varbit.c.html#LN28"><span class='Ref_to_Proto'>bitsubstring</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1152"><span class='Ref_to_Parameter'>t1</span></a><span class='Delimiter'>, </span><a href="varbit.c.html#LN1157"><span class='Ref_To_Local'>sp_pl_sl</span></a><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Boolean'>true</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="varbit.c.html#LN1154"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="varbit.c.html#LN27"><span class='Ref_to_Proto'>bit_catenate</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1155"><span class='Ref_To_Local'>s1</span></a><span class='Delimiter'>, </span><a href="varbit.c.html#LN1152"><span class='Ref_to_Parameter'>t2</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="varbit.c.html#LN1154"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="varbit.c.html#LN27"><span class='Ref_to_Proto'>bit_catenate</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1154"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>, </span><a href="varbit.c.html#LN1156"><span class='Ref_To_Local'>s2</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="varbit.c.html#LN1154"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end bit_overlay &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * bitlength, bitoctetlength 
 * Return the length of a bit string 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN1187"></a><span class='Declare_Function'>bitlength</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1189"></a>    <a href="../../../include/utils/varbit.h.html#LN24"><span class='Ref_to_Typedef'>VarBit</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>arg</span> <span class='Operator'>= </span><a href="../../../include/utils/varbit.h.html#LN41"><span class='Ref_to_Macro'>PG_GETARG_VARBIT_P</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/fmgr.h.html#LN313"><span class='Ref_to_Macro'>PG_RETURN_INT32</span></a><span class='Parentheses'>(</span><a href="../../../include/utils/varbit.h.html#LN48"><span class='Ref_to_Macro'>VARBITLEN</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1189"><span class='Ref_To_Local'>arg</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
} 
</span> 
<a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN1195"></a><span class='Declare_Function'>bitoctetlength</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1197"></a>    <a href="../../../include/utils/varbit.h.html#LN24"><span class='Ref_to_Typedef'>VarBit</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>arg</span> <span class='Operator'>= </span><a href="../../../include/utils/varbit.h.html#LN41"><span class='Ref_to_Macro'>PG_GETARG_VARBIT_P</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/fmgr.h.html#LN313"><span class='Ref_to_Macro'>PG_RETURN_INT32</span></a><span class='Parentheses'>(</span><a href="../../../include/utils/varbit.h.html#LN52"><span class='Ref_to_Macro'>VARBITBYTES</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1197"><span class='Ref_To_Local'>arg</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * bit_and 
 * perform a logical AND on two bit strings. 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN1207"></a><span class='Declare_Function'>bit_and</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1209"></a>    <a href="../../../include/utils/varbit.h.html#LN24"><span class='Ref_to_Typedef'>VarBit</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>arg1</span> <span class='Operator'>= </span><a href="../../../include/utils/varbit.h.html#LN41"><span class='Ref_to_Macro'>PG_GETARG_VARBIT_P</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1210"></a>    <a href="../../../include/utils/varbit.h.html#LN24"><span class='Ref_to_Typedef'>VarBit</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>arg2</span> <span class='Operator'>= </span><a href="../../../include/utils/varbit.h.html#LN41"><span class='Ref_to_Macro'>PG_GETARG_VARBIT_P</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1211"></a>    <a href="../../../include/utils/varbit.h.html#LN24"><span class='Ref_to_Typedef'>VarBit</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span><a name="LN1212"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>len</span><span class='Delimiter'>, 
</span><a name="LN1213"></a>                <span class='Declare_Local'>bitlen1</span><span class='Delimiter'>, 
</span><a name="LN1214"></a>                <span class='Declare_Local'>bitlen2</span><span class='Delimiter'>, 
</span><a name="LN1215"></a>                <span class='Declare_Local'>i</span><span class='Delimiter'>; 
</span><a name="LN1216"></a>    <a href="../../../include/c.h.html#LN274"><span class='Ref_to_Typedef'>bits8</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>p1</span><span class='Delimiter'>, 
</span><a name="LN1217"></a>               <span class='Operator'>*</span><span class='Declare_Local'>p2</span><span class='Delimiter'>, 
</span><a name="LN1218"></a>               <span class='Operator'>*</span><span class='Declare_Local'>r</span><span class='Delimiter'>; 
</span> 
    <a href="varbit.c.html#LN1213"><span class='Ref_To_Local'>bitlen1</span></a> <span class='Operator'>= </span><a href="../../../include/utils/varbit.h.html#LN48"><span class='Ref_to_Macro'>VARBITLEN</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1209"><span class='Ref_To_Local'>arg1</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="varbit.c.html#LN1214"><span class='Ref_To_Local'>bitlen2</span></a> <span class='Operator'>= </span><a href="../../../include/utils/varbit.h.html#LN48"><span class='Ref_to_Macro'>VARBITLEN</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1210"><span class='Ref_To_Local'>arg2</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="varbit.c.html#LN1213"><span class='Ref_To_Local'>bitlen1</span></a> <span class='Operator'>!= </span><a href="varbit.c.html#LN1214"><span class='Ref_To_Local'>bitlen2</span></a><span class='Parentheses'>) 
</span>        <a href="../../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_STRING_DATA_LENGTH_MISMATCH<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"cannot AND bit strings of different sizes"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
    <a href="varbit.c.html#LN1212"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>= </span><a href="../../../include/postgres.h.html#LN303"><span class='Ref_to_Macro'>VARSIZE</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1209"><span class='Ref_To_Local'>arg1</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="varbit.c.html#LN1211"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/utils/varbit.h.html#LN24"><span class='Ref_to_Typedef'>VarBit</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1212"><span class='Ref_To_Local'>len</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../../include/postgres.h.html#LN327"><span class='Ref_to_Macro'>SET_VARSIZE</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1211"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>, </span><a href="varbit.c.html#LN1212"><span class='Ref_To_Local'>len</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../../include/utils/varbit.h.html#LN48"><span class='Ref_to_Macro'>VARBITLEN</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1211"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>) </span><span class='Operator'>= </span><a href="varbit.c.html#LN1213"><span class='Ref_To_Local'>bitlen1</span></a><span class='Delimiter'>; 
</span> 
    <a href="varbit.c.html#LN1216"><span class='Ref_To_Local'>p1</span></a> <span class='Operator'>= </span><a href="../../../include/utils/varbit.h.html#LN50"><span class='Ref_to_Macro'>VARBITS</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1209"><span class='Ref_To_Local'>arg1</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="varbit.c.html#LN1217"><span class='Ref_To_Local'>p2</span></a> <span class='Operator'>= </span><a href="../../../include/utils/varbit.h.html#LN50"><span class='Ref_to_Macro'>VARBITS</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1210"><span class='Ref_To_Local'>arg2</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="varbit.c.html#LN1218"><span class='Ref_To_Local'>r</span></a> <span class='Operator'>= </span><a href="../../../include/utils/varbit.h.html#LN50"><span class='Ref_to_Macro'>VARBITS</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1211"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="varbit.c.html#LN1215"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="varbit.c.html#LN1215"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="../../../include/utils/varbit.h.html#LN52"><span class='Ref_to_Macro'>VARBITBYTES</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1209"><span class='Ref_To_Local'>arg1</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; </span><a href="varbit.c.html#LN1215"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Parentheses'>)</span> 
        <span class='Operator'>*</span><a href="varbit.c.html#LN1218"><span class='Ref_To_Local'>r</span></a><span class='Operator'>++ = *</span><a href="varbit.c.html#LN1216"><span class='Ref_To_Local'>p1</span></a><span class='Operator'>++ & *</span><a href="varbit.c.html#LN1217"><span class='Ref_To_Local'>p2</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Padding is not needed as & of 0 pad is 0 */ 
</span> 
    <a href="../../../include/utils/varbit.h.html#LN43"><span class='Ref_to_Macro'>PG_RETURN_VARBIT_P</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1211"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end bit_and &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * bit_or 
 * perform a logical OR on two bit strings. 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN1248"></a><span class='Declare_Function'>bit_or</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1250"></a>    <a href="../../../include/utils/varbit.h.html#LN24"><span class='Ref_to_Typedef'>VarBit</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>arg1</span> <span class='Operator'>= </span><a href="../../../include/utils/varbit.h.html#LN41"><span class='Ref_to_Macro'>PG_GETARG_VARBIT_P</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1251"></a>    <a href="../../../include/utils/varbit.h.html#LN24"><span class='Ref_to_Typedef'>VarBit</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>arg2</span> <span class='Operator'>= </span><a href="../../../include/utils/varbit.h.html#LN41"><span class='Ref_to_Macro'>PG_GETARG_VARBIT_P</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1252"></a>    <a href="../../../include/utils/varbit.h.html#LN24"><span class='Ref_to_Typedef'>VarBit</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span><a name="LN1253"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>len</span><span class='Delimiter'>, 
</span><a name="LN1254"></a>                <span class='Declare_Local'>bitlen1</span><span class='Delimiter'>, 
</span><a name="LN1255"></a>                <span class='Declare_Local'>bitlen2</span><span class='Delimiter'>, 
</span><a name="LN1256"></a>                <span class='Declare_Local'>i</span><span class='Delimiter'>; 
</span><a name="LN1257"></a>    <a href="../../../include/c.h.html#LN274"><span class='Ref_to_Typedef'>bits8</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>p1</span><span class='Delimiter'>, 
</span><a name="LN1258"></a>               <span class='Operator'>*</span><span class='Declare_Local'>p2</span><span class='Delimiter'>, 
</span><a name="LN1259"></a>               <span class='Operator'>*</span><span class='Declare_Local'>r</span><span class='Delimiter'>; 
</span><a name="LN1260"></a>    <a href="../../../include/c.h.html#LN274"><span class='Ref_to_Typedef'>bits8</span></a>       <span class='Declare_Local'>mask</span><span class='Delimiter'>; 
</span> 
    <a href="varbit.c.html#LN1254"><span class='Ref_To_Local'>bitlen1</span></a> <span class='Operator'>= </span><a href="../../../include/utils/varbit.h.html#LN48"><span class='Ref_to_Macro'>VARBITLEN</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1250"><span class='Ref_To_Local'>arg1</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="varbit.c.html#LN1255"><span class='Ref_To_Local'>bitlen2</span></a> <span class='Operator'>= </span><a href="../../../include/utils/varbit.h.html#LN48"><span class='Ref_to_Macro'>VARBITLEN</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1251"><span class='Ref_To_Local'>arg2</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="varbit.c.html#LN1254"><span class='Ref_To_Local'>bitlen1</span></a> <span class='Operator'>!= </span><a href="varbit.c.html#LN1255"><span class='Ref_To_Local'>bitlen2</span></a><span class='Parentheses'>) 
</span>        <a href="../../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_STRING_DATA_LENGTH_MISMATCH<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"cannot OR bit strings of different sizes"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>    <a href="varbit.c.html#LN1253"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>= </span><a href="../../../include/postgres.h.html#LN303"><span class='Ref_to_Macro'>VARSIZE</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1250"><span class='Ref_To_Local'>arg1</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="varbit.c.html#LN1252"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/utils/varbit.h.html#LN24"><span class='Ref_to_Typedef'>VarBit</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1253"><span class='Ref_To_Local'>len</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../../include/postgres.h.html#LN327"><span class='Ref_to_Macro'>SET_VARSIZE</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1252"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>, </span><a href="varbit.c.html#LN1253"><span class='Ref_To_Local'>len</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../../include/utils/varbit.h.html#LN48"><span class='Ref_to_Macro'>VARBITLEN</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1252"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>) </span><span class='Operator'>= </span><a href="varbit.c.html#LN1254"><span class='Ref_To_Local'>bitlen1</span></a><span class='Delimiter'>; 
</span> 
    <a href="varbit.c.html#LN1257"><span class='Ref_To_Local'>p1</span></a> <span class='Operator'>= </span><a href="../../../include/utils/varbit.h.html#LN50"><span class='Ref_to_Macro'>VARBITS</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1250"><span class='Ref_To_Local'>arg1</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="varbit.c.html#LN1258"><span class='Ref_To_Local'>p2</span></a> <span class='Operator'>= </span><a href="../../../include/utils/varbit.h.html#LN50"><span class='Ref_to_Macro'>VARBITS</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1251"><span class='Ref_To_Local'>arg2</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="varbit.c.html#LN1259"><span class='Ref_To_Local'>r</span></a> <span class='Operator'>= </span><a href="../../../include/utils/varbit.h.html#LN50"><span class='Ref_to_Macro'>VARBITS</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1252"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="varbit.c.html#LN1256"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="varbit.c.html#LN1256"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="../../../include/utils/varbit.h.html#LN52"><span class='Ref_to_Macro'>VARBITBYTES</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1250"><span class='Ref_To_Local'>arg1</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; </span><a href="varbit.c.html#LN1256"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Parentheses'>)</span> 
        <span class='Operator'>*</span><a href="varbit.c.html#LN1259"><span class='Ref_To_Local'>r</span></a><span class='Operator'>++ = *</span><a href="varbit.c.html#LN1257"><span class='Ref_To_Local'>p1</span></a><span class='Operator'>++ | *</span><a href="varbit.c.html#LN1258"><span class='Ref_To_Local'>p2</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Pad the result */ 
</span>    <a href="varbit.c.html#LN1260"><span class='Ref_To_Local'>mask</span></a> <span class='Operator'>= </span><a href="../../../include/utils/varbit.h.html#LN66"><span class='Ref_to_Const'>BITMASK</span></a> <span class='Operator'>&LT;&LT; </span><a href="../../../include/utils/varbit.h.html#LN54"><span class='Ref_to_Macro'>VARBITPAD</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1252"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="varbit.c.html#LN1260"><span class='Ref_To_Local'>mask</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="varbit.c.html#LN1259"><span class='Ref_To_Local'>r</span></a><span class='Operator'>--</span><span class='Delimiter'>; 
</span>        <span class='Operator'>*</span><a href="varbit.c.html#LN1259"><span class='Ref_To_Local'>r</span></a> <span class='Operator'>&= </span><a href="varbit.c.html#LN1260"><span class='Ref_To_Local'>mask</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="../../../include/utils/varbit.h.html#LN43"><span class='Ref_to_Macro'>PG_RETURN_VARBIT_P</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1252"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end bit_or &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * bitxor 
 * perform a logical XOR on two bit strings. 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN1295"></a><span class='Declare_Function'>bitxor</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1297"></a>    <a href="../../../include/utils/varbit.h.html#LN24"><span class='Ref_to_Typedef'>VarBit</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>arg1</span> <span class='Operator'>= </span><a href="../../../include/utils/varbit.h.html#LN41"><span class='Ref_to_Macro'>PG_GETARG_VARBIT_P</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1298"></a>    <a href="../../../include/utils/varbit.h.html#LN24"><span class='Ref_to_Typedef'>VarBit</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>arg2</span> <span class='Operator'>= </span><a href="../../../include/utils/varbit.h.html#LN41"><span class='Ref_to_Macro'>PG_GETARG_VARBIT_P</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1299"></a>    <a href="../../../include/utils/varbit.h.html#LN24"><span class='Ref_to_Typedef'>VarBit</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span><a name="LN1300"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>len</span><span class='Delimiter'>, 
</span><a name="LN1301"></a>                <span class='Declare_Local'>bitlen1</span><span class='Delimiter'>, 
</span><a name="LN1302"></a>                <span class='Declare_Local'>bitlen2</span><span class='Delimiter'>, 
</span><a name="LN1303"></a>                <span class='Declare_Local'>i</span><span class='Delimiter'>; 
</span><a name="LN1304"></a>    <a href="../../../include/c.h.html#LN274"><span class='Ref_to_Typedef'>bits8</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>p1</span><span class='Delimiter'>, 
</span><a name="LN1305"></a>               <span class='Operator'>*</span><span class='Declare_Local'>p2</span><span class='Delimiter'>, 
</span><a name="LN1306"></a>               <span class='Operator'>*</span><span class='Declare_Local'>r</span><span class='Delimiter'>; 
</span><a name="LN1307"></a>    <a href="../../../include/c.h.html#LN274"><span class='Ref_to_Typedef'>bits8</span></a>       <span class='Declare_Local'>mask</span><span class='Delimiter'>; 
</span> 
    <a href="varbit.c.html#LN1301"><span class='Ref_To_Local'>bitlen1</span></a> <span class='Operator'>= </span><a href="../../../include/utils/varbit.h.html#LN48"><span class='Ref_to_Macro'>VARBITLEN</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1297"><span class='Ref_To_Local'>arg1</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="varbit.c.html#LN1302"><span class='Ref_To_Local'>bitlen2</span></a> <span class='Operator'>= </span><a href="../../../include/utils/varbit.h.html#LN48"><span class='Ref_to_Macro'>VARBITLEN</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1298"><span class='Ref_To_Local'>arg2</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="varbit.c.html#LN1301"><span class='Ref_To_Local'>bitlen1</span></a> <span class='Operator'>!= </span><a href="varbit.c.html#LN1302"><span class='Ref_To_Local'>bitlen2</span></a><span class='Parentheses'>) 
</span>        <a href="../../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_STRING_DATA_LENGTH_MISMATCH<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"cannot XOR bit strings of different sizes"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
    <a href="varbit.c.html#LN1300"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>= </span><a href="../../../include/postgres.h.html#LN303"><span class='Ref_to_Macro'>VARSIZE</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1297"><span class='Ref_To_Local'>arg1</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="varbit.c.html#LN1299"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/utils/varbit.h.html#LN24"><span class='Ref_to_Typedef'>VarBit</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1300"><span class='Ref_To_Local'>len</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../../include/postgres.h.html#LN327"><span class='Ref_to_Macro'>SET_VARSIZE</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1299"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>, </span><a href="varbit.c.html#LN1300"><span class='Ref_To_Local'>len</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../../include/utils/varbit.h.html#LN48"><span class='Ref_to_Macro'>VARBITLEN</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1299"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>) </span><span class='Operator'>= </span><a href="varbit.c.html#LN1301"><span class='Ref_To_Local'>bitlen1</span></a><span class='Delimiter'>; 
</span> 
    <a href="varbit.c.html#LN1304"><span class='Ref_To_Local'>p1</span></a> <span class='Operator'>= </span><a href="../../../include/utils/varbit.h.html#LN50"><span class='Ref_to_Macro'>VARBITS</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1297"><span class='Ref_To_Local'>arg1</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="varbit.c.html#LN1305"><span class='Ref_To_Local'>p2</span></a> <span class='Operator'>= </span><a href="../../../include/utils/varbit.h.html#LN50"><span class='Ref_to_Macro'>VARBITS</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1298"><span class='Ref_To_Local'>arg2</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="varbit.c.html#LN1306"><span class='Ref_To_Local'>r</span></a> <span class='Operator'>= </span><a href="../../../include/utils/varbit.h.html#LN50"><span class='Ref_to_Macro'>VARBITS</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1299"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="varbit.c.html#LN1303"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="varbit.c.html#LN1303"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="../../../include/utils/varbit.h.html#LN52"><span class='Ref_to_Macro'>VARBITBYTES</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1297"><span class='Ref_To_Local'>arg1</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; </span><a href="varbit.c.html#LN1303"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Parentheses'>)</span> 
        <span class='Operator'>*</span><a href="varbit.c.html#LN1306"><span class='Ref_To_Local'>r</span></a><span class='Operator'>++ = *</span><a href="varbit.c.html#LN1304"><span class='Ref_To_Local'>p1</span></a><span class='Operator'>++ ^ *</span><a href="varbit.c.html#LN1305"><span class='Ref_To_Local'>p2</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Pad the result */ 
</span>    <a href="varbit.c.html#LN1307"><span class='Ref_To_Local'>mask</span></a> <span class='Operator'>= </span><a href="../../../include/utils/varbit.h.html#LN66"><span class='Ref_to_Const'>BITMASK</span></a> <span class='Operator'>&LT;&LT; </span><a href="../../../include/utils/varbit.h.html#LN54"><span class='Ref_to_Macro'>VARBITPAD</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1299"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="varbit.c.html#LN1307"><span class='Ref_To_Local'>mask</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="varbit.c.html#LN1306"><span class='Ref_To_Local'>r</span></a><span class='Operator'>--</span><span class='Delimiter'>; 
</span>        <span class='Operator'>*</span><a href="varbit.c.html#LN1306"><span class='Ref_To_Local'>r</span></a> <span class='Operator'>&= </span><a href="varbit.c.html#LN1307"><span class='Ref_To_Local'>mask</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="../../../include/utils/varbit.h.html#LN43"><span class='Ref_to_Macro'>PG_RETURN_VARBIT_P</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1299"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end bitxor &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * bitnot 
 * perform a logical NOT on a bit string. 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN1343"></a><span class='Declare_Function'>bitnot</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1345"></a>    <a href="../../../include/utils/varbit.h.html#LN24"><span class='Ref_to_Typedef'>VarBit</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>arg</span> <span class='Operator'>= </span><a href="../../../include/utils/varbit.h.html#LN41"><span class='Ref_to_Macro'>PG_GETARG_VARBIT_P</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1346"></a>    <a href="../../../include/utils/varbit.h.html#LN24"><span class='Ref_to_Typedef'>VarBit</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span><a name="LN1347"></a>    <a href="../../../include/c.h.html#LN274"><span class='Ref_to_Typedef'>bits8</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>p</span><span class='Delimiter'>, 
</span><a name="LN1348"></a>               <span class='Operator'>*</span><span class='Declare_Local'>r</span><span class='Delimiter'>; 
</span><a name="LN1349"></a>    <a href="../../../include/c.h.html#LN274"><span class='Ref_to_Typedef'>bits8</span></a>       <span class='Declare_Local'>mask</span><span class='Delimiter'>; 
</span> 
    <a href="varbit.c.html#LN1346"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/utils/varbit.h.html#LN24"><span class='Ref_to_Typedef'>VarBit</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><a href="../../../include/postgres.h.html#LN303"><span class='Ref_to_Macro'>VARSIZE</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1345"><span class='Ref_To_Local'>arg</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <a href="../../../include/postgres.h.html#LN327"><span class='Ref_to_Macro'>SET_VARSIZE</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1346"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>, </span><a href="../../../include/postgres.h.html#LN303"><span class='Ref_to_Macro'>VARSIZE</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1345"><span class='Ref_To_Local'>arg</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <a href="../../../include/utils/varbit.h.html#LN48"><span class='Ref_to_Macro'>VARBITLEN</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1346"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>) </span><span class='Operator'>= </span><a href="../../../include/utils/varbit.h.html#LN48"><span class='Ref_to_Macro'>VARBITLEN</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1345"><span class='Ref_To_Local'>arg</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="varbit.c.html#LN1347"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>= </span><a href="../../../include/utils/varbit.h.html#LN50"><span class='Ref_to_Macro'>VARBITS</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1345"><span class='Ref_To_Local'>arg</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="varbit.c.html#LN1348"><span class='Ref_To_Local'>r</span></a> <span class='Operator'>= </span><a href="../../../include/utils/varbit.h.html#LN50"><span class='Ref_to_Macro'>VARBITS</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1346"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>for</span> <span class='Parentheses'>(</span><span class='Delimiter'>; </span><a href="varbit.c.html#LN1347"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>&LT; </span><a href="../../../include/utils/varbit.h.html#LN64"><span class='Ref_to_Macro'>VARBITEND</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1345"><span class='Ref_To_Local'>arg</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; </span><a href="varbit.c.html#LN1347"><span class='Ref_To_Local'>p</span></a><span class='Operator'>++</span><span class='Parentheses'>)</span> 
        <span class='Operator'>*</span><a href="varbit.c.html#LN1348"><span class='Ref_To_Local'>r</span></a><span class='Operator'>++ = ~*</span><a href="varbit.c.html#LN1347"><span class='Ref_To_Local'>p</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Pad the result */ 
</span>    <a href="varbit.c.html#LN1349"><span class='Ref_To_Local'>mask</span></a> <span class='Operator'>= </span><a href="../../../include/utils/varbit.h.html#LN66"><span class='Ref_to_Const'>BITMASK</span></a> <span class='Operator'>&LT;&LT; </span><a href="../../../include/utils/varbit.h.html#LN54"><span class='Ref_to_Macro'>VARBITPAD</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1346"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="varbit.c.html#LN1349"><span class='Ref_To_Local'>mask</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="varbit.c.html#LN1348"><span class='Ref_To_Local'>r</span></a><span class='Operator'>--</span><span class='Delimiter'>; 
</span>        <span class='Operator'>*</span><a href="varbit.c.html#LN1348"><span class='Ref_To_Local'>r</span></a> <span class='Operator'>&= </span><a href="varbit.c.html#LN1349"><span class='Ref_To_Local'>mask</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="../../../include/utils/varbit.h.html#LN43"><span class='Ref_to_Macro'>PG_RETURN_VARBIT_P</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1346"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end bitnot &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * bitshiftleft 
 * do a left shift (i.e. towards the beginning of the string) 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN1376"></a><span class='Declare_Function'>bitshiftleft</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1378"></a>    <a href="../../../include/utils/varbit.h.html#LN24"><span class='Ref_to_Typedef'>VarBit</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>arg</span> <span class='Operator'>= </span><a href="../../../include/utils/varbit.h.html#LN41"><span class='Ref_to_Macro'>PG_GETARG_VARBIT_P</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1379"></a>    <a href="../../../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>       <span class='Declare_Local'>shft</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN233"><span class='Ref_to_Macro'>PG_GETARG_INT32</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1380"></a>    <a href="../../../include/utils/varbit.h.html#LN24"><span class='Ref_to_Typedef'>VarBit</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span><a name="LN1381"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>byte_shift</span><span class='Delimiter'>, 
</span><a name="LN1382"></a>                <span class='Declare_Local'>ishift</span><span class='Delimiter'>, 
</span><a name="LN1383"></a>                <span class='Declare_Local'>len</span><span class='Delimiter'>; 
</span><a name="LN1384"></a>    <a href="../../../include/c.h.html#LN274"><span class='Ref_to_Typedef'>bits8</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>p</span><span class='Delimiter'>, 
</span><a name="LN1385"></a>               <span class='Operator'>*</span><span class='Declare_Local'>r</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Negative shift is a shift to the right */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="varbit.c.html#LN1379"><span class='Ref_To_Local'>shft</span></a> <span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* Prevent integer overflow in negation */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="varbit.c.html#LN1379"><span class='Ref_To_Local'>shft</span></a> <span class='Operator'>&LT; -</span><a href="../../../include/utils/varbit.h.html#LN62"><span class='Ref_to_Const'>VARBITMAXLEN</span></a><span class='Parentheses'>) 
</span>            <a href="varbit.c.html#LN1379"><span class='Ref_To_Local'>shft</span></a> <span class='Operator'>= -</span><a href="../../../include/utils/varbit.h.html#LN62"><span class='Ref_to_Const'>VARBITMAXLEN</span></a><span class='Delimiter'>; 
</span>        <a href="../../../include/fmgr.h.html#LN312"><span class='Ref_to_Macro'>PG_RETURN_DATUM</span></a><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN585"><span class='Ref_to_Macro'>DirectFunctionCall2</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1440"><span class='Ref_to_Func'>bitshiftright</span></a><span class='Delimiter'>, 
</span>                                            <a href="../../../include/utils/varbit.h.html#LN40"><span class='Ref_to_Macro'>VarBitPGetDatum</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1378"><span class='Ref_To_Local'>arg</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                            <a href="../../../include/postgres.h.html#LN484"><span class='Ref_to_Macro'>Int32GetDatum</span></a><span class='Parentheses'>(</span><span class='Operator'>-</span><a href="varbit.c.html#LN1379"><span class='Ref_To_Local'>shft</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="varbit.c.html#LN1380"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/utils/varbit.h.html#LN24"><span class='Ref_to_Typedef'>VarBit</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><a href="../../../include/postgres.h.html#LN303"><span class='Ref_to_Macro'>VARSIZE</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1378"><span class='Ref_To_Local'>arg</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <a href="../../../include/postgres.h.html#LN327"><span class='Ref_to_Macro'>SET_VARSIZE</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1380"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>, </span><a href="../../../include/postgres.h.html#LN303"><span class='Ref_to_Macro'>VARSIZE</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1378"><span class='Ref_To_Local'>arg</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <a href="../../../include/utils/varbit.h.html#LN48"><span class='Ref_to_Macro'>VARBITLEN</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1380"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>) </span><span class='Operator'>= </span><a href="../../../include/utils/varbit.h.html#LN48"><span class='Ref_to_Macro'>VARBITLEN</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1378"><span class='Ref_To_Local'>arg</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="varbit.c.html#LN1385"><span class='Ref_To_Local'>r</span></a> <span class='Operator'>= </span><a href="../../../include/utils/varbit.h.html#LN50"><span class='Ref_to_Macro'>VARBITS</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1380"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* If we shifted all the bits out, return an all-zero string */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="varbit.c.html#LN1379"><span class='Ref_To_Local'>shft</span></a> <span class='Operator'>&GT;= </span><a href="../../../include/utils/varbit.h.html#LN48"><span class='Ref_to_Macro'>VARBITLEN</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1378"><span class='Ref_To_Local'>arg</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span>        <a href="../../../include/c.h.html#LN856"><span class='Ref_to_Macro'>MemSet</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1385"><span class='Ref_To_Local'>r</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Delimiter'>, </span><a href="../../../include/utils/varbit.h.html#LN52"><span class='Ref_to_Macro'>VARBITBYTES</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1378"><span class='Ref_To_Local'>arg</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <a href="../../../include/utils/varbit.h.html#LN43"><span class='Ref_to_Macro'>PG_RETURN_VARBIT_P</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1380"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="varbit.c.html#LN1381"><span class='Ref_To_Local'>byte_shift</span></a> <span class='Operator'>= </span><a href="varbit.c.html#LN1379"><span class='Ref_To_Local'>shft</span></a> <span class='Operator'>/ </span><a href="../../../include/pg_config_manual.h.html#LN105"><span class='Ref_to_Const'>BITS_PER_BYTE</span></a><span class='Delimiter'>; 
</span>    <a href="varbit.c.html#LN1382"><span class='Ref_To_Local'>ishift</span></a> <span class='Operator'>= </span><a href="varbit.c.html#LN1379"><span class='Ref_To_Local'>shft</span></a> <span class='Operator'>% </span><a href="../../../include/pg_config_manual.h.html#LN105"><span class='Ref_to_Const'>BITS_PER_BYTE</span></a><span class='Delimiter'>; 
</span>    <a href="varbit.c.html#LN1384"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>= </span><a href="../../../include/utils/varbit.h.html#LN50"><span class='Ref_to_Macro'>VARBITS</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1378"><span class='Ref_To_Local'>arg</span></a><span class='Parentheses'>) </span><span class='Operator'>+ </span><a href="varbit.c.html#LN1381"><span class='Ref_To_Local'>byte_shift</span></a><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="varbit.c.html#LN1382"><span class='Ref_To_Local'>ishift</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* Special case: we can do a memcpy */ 
</span>        <a href="varbit.c.html#LN1383"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>= </span><a href="../../../include/utils/varbit.h.html#LN52"><span class='Ref_to_Macro'>VARBITBYTES</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1378"><span class='Ref_To_Local'>arg</span></a><span class='Parentheses'>) </span><span class='Operator'>- </span><a href="varbit.c.html#LN1381"><span class='Ref_To_Local'>byte_shift</span></a><span class='Delimiter'>; 
</span>        memcpy<span class='Parentheses'>(</span><a href="varbit.c.html#LN1385"><span class='Ref_To_Local'>r</span></a><span class='Delimiter'>, </span><a href="varbit.c.html#LN1384"><span class='Ref_To_Local'>p</span></a><span class='Delimiter'>, </span><a href="varbit.c.html#LN1383"><span class='Ref_To_Local'>len</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="../../../include/c.h.html#LN856"><span class='Ref_to_Macro'>MemSet</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1385"><span class='Ref_To_Local'>r</span></a> <span class='Operator'>+ </span><a href="varbit.c.html#LN1383"><span class='Ref_To_Local'>len</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Delimiter'>, </span><a href="varbit.c.html#LN1381"><span class='Ref_To_Local'>byte_shift</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Control'>for</span> <span class='Parentheses'>(</span><span class='Delimiter'>; </span><a href="varbit.c.html#LN1384"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>&LT; </span><a href="../../../include/utils/varbit.h.html#LN64"><span class='Ref_to_Macro'>VARBITEND</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1378"><span class='Ref_To_Local'>arg</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; </span><a href="varbit.c.html#LN1385"><span class='Ref_To_Local'>r</span></a><span class='Operator'>++</span><span class='Parentheses'>)</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Operator'>*</span><a href="varbit.c.html#LN1385"><span class='Ref_To_Local'>r</span></a> <span class='Operator'>= *</span><a href="varbit.c.html#LN1384"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>&LT;&LT; </span><a href="varbit.c.html#LN1382"><span class='Ref_To_Local'>ishift</span></a><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>((</span><span class='Operator'>++</span><a href="varbit.c.html#LN1384"><span class='Ref_To_Local'>p</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT; </span><a href="../../../include/utils/varbit.h.html#LN64"><span class='Ref_to_Macro'>VARBITEND</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1378"><span class='Ref_To_Local'>arg</span></a><span class='Parentheses'>))</span> 
                <span class='Operator'>*</span><a href="varbit.c.html#LN1385"><span class='Ref_To_Local'>r</span></a> <span class='Operator'>|= *</span><a href="varbit.c.html#LN1384"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>&GT;&GT; </span><span class='Parentheses'>(</span><a href="../../../include/pg_config_manual.h.html#LN105"><span class='Ref_to_Const'>BITS_PER_BYTE</span></a> <span class='Operator'>- </span><a href="varbit.c.html#LN1382"><span class='Ref_To_Local'>ishift</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>for</span> <span class='Parentheses'>(</span><span class='Delimiter'>; </span><a href="varbit.c.html#LN1385"><span class='Ref_To_Local'>r</span></a> <span class='Operator'>&LT; </span><a href="../../../include/utils/varbit.h.html#LN64"><span class='Ref_to_Macro'>VARBITEND</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1380"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; </span><a href="varbit.c.html#LN1385"><span class='Ref_To_Local'>r</span></a><span class='Operator'>++</span><span class='Parentheses'>)</span> 
            <span class='Operator'>*</span><a href="varbit.c.html#LN1385"><span class='Ref_To_Local'>r</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="../../../include/utils/varbit.h.html#LN43"><span class='Ref_to_Macro'>PG_RETURN_VARBIT_P</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1380"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end bitshiftleft &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * bitshiftright 
 * do a right shift (i.e. towards the end of the string) 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN1441"></a><span class='Declare_Function'>bitshiftright</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1443"></a>    <a href="../../../include/utils/varbit.h.html#LN24"><span class='Ref_to_Typedef'>VarBit</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>arg</span> <span class='Operator'>= </span><a href="../../../include/utils/varbit.h.html#LN41"><span class='Ref_to_Macro'>PG_GETARG_VARBIT_P</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1444"></a>    <a href="../../../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>       <span class='Declare_Local'>shft</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN233"><span class='Ref_to_Macro'>PG_GETARG_INT32</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1445"></a>    <a href="../../../include/utils/varbit.h.html#LN24"><span class='Ref_to_Typedef'>VarBit</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span><a name="LN1446"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>byte_shift</span><span class='Delimiter'>, 
</span><a name="LN1447"></a>                <span class='Declare_Local'>ishift</span><span class='Delimiter'>, 
</span><a name="LN1448"></a>                <span class='Declare_Local'>len</span><span class='Delimiter'>; 
</span><a name="LN1449"></a>    <a href="../../../include/c.h.html#LN274"><span class='Ref_to_Typedef'>bits8</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>p</span><span class='Delimiter'>, 
</span><a name="LN1450"></a>               <span class='Operator'>*</span><span class='Declare_Local'>r</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Negative shift is a shift to the left */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="varbit.c.html#LN1444"><span class='Ref_To_Local'>shft</span></a> <span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* Prevent integer overflow in negation */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="varbit.c.html#LN1444"><span class='Ref_To_Local'>shft</span></a> <span class='Operator'>&LT; -</span><a href="../../../include/utils/varbit.h.html#LN62"><span class='Ref_to_Const'>VARBITMAXLEN</span></a><span class='Parentheses'>) 
</span>            <a href="varbit.c.html#LN1444"><span class='Ref_To_Local'>shft</span></a> <span class='Operator'>= -</span><a href="../../../include/utils/varbit.h.html#LN62"><span class='Ref_to_Const'>VARBITMAXLEN</span></a><span class='Delimiter'>; 
</span>        <a href="../../../include/fmgr.h.html#LN312"><span class='Ref_to_Macro'>PG_RETURN_DATUM</span></a><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN585"><span class='Ref_to_Macro'>DirectFunctionCall2</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1375"><span class='Ref_to_Func'>bitshiftleft</span></a><span class='Delimiter'>, 
</span>                                            <a href="../../../include/utils/varbit.h.html#LN40"><span class='Ref_to_Macro'>VarBitPGetDatum</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1443"><span class='Ref_To_Local'>arg</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                            <a href="../../../include/postgres.h.html#LN484"><span class='Ref_to_Macro'>Int32GetDatum</span></a><span class='Parentheses'>(</span><span class='Operator'>-</span><a href="varbit.c.html#LN1444"><span class='Ref_To_Local'>shft</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="varbit.c.html#LN1445"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/utils/varbit.h.html#LN24"><span class='Ref_to_Typedef'>VarBit</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><a href="../../../include/postgres.h.html#LN303"><span class='Ref_to_Macro'>VARSIZE</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1443"><span class='Ref_To_Local'>arg</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <a href="../../../include/postgres.h.html#LN327"><span class='Ref_to_Macro'>SET_VARSIZE</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1445"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>, </span><a href="../../../include/postgres.h.html#LN303"><span class='Ref_to_Macro'>VARSIZE</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1443"><span class='Ref_To_Local'>arg</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <a href="../../../include/utils/varbit.h.html#LN48"><span class='Ref_to_Macro'>VARBITLEN</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1445"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>) </span><span class='Operator'>= </span><a href="../../../include/utils/varbit.h.html#LN48"><span class='Ref_to_Macro'>VARBITLEN</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1443"><span class='Ref_To_Local'>arg</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="varbit.c.html#LN1450"><span class='Ref_To_Local'>r</span></a> <span class='Operator'>= </span><a href="../../../include/utils/varbit.h.html#LN50"><span class='Ref_to_Macro'>VARBITS</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1445"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* If we shifted all the bits out, return an all-zero string */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="varbit.c.html#LN1444"><span class='Ref_To_Local'>shft</span></a> <span class='Operator'>&GT;= </span><a href="../../../include/utils/varbit.h.html#LN48"><span class='Ref_to_Macro'>VARBITLEN</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1443"><span class='Ref_To_Local'>arg</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span>        <a href="../../../include/c.h.html#LN856"><span class='Ref_to_Macro'>MemSet</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1450"><span class='Ref_To_Local'>r</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Delimiter'>, </span><a href="../../../include/utils/varbit.h.html#LN52"><span class='Ref_to_Macro'>VARBITBYTES</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1443"><span class='Ref_To_Local'>arg</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <a href="../../../include/utils/varbit.h.html#LN43"><span class='Ref_to_Macro'>PG_RETURN_VARBIT_P</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1445"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="varbit.c.html#LN1446"><span class='Ref_To_Local'>byte_shift</span></a> <span class='Operator'>= </span><a href="varbit.c.html#LN1444"><span class='Ref_To_Local'>shft</span></a> <span class='Operator'>/ </span><a href="../../../include/pg_config_manual.h.html#LN105"><span class='Ref_to_Const'>BITS_PER_BYTE</span></a><span class='Delimiter'>; 
</span>    <a href="varbit.c.html#LN1447"><span class='Ref_To_Local'>ishift</span></a> <span class='Operator'>= </span><a href="varbit.c.html#LN1444"><span class='Ref_To_Local'>shft</span></a> <span class='Operator'>% </span><a href="../../../include/pg_config_manual.h.html#LN105"><span class='Ref_to_Const'>BITS_PER_BYTE</span></a><span class='Delimiter'>; 
</span>    <a href="varbit.c.html#LN1449"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>= </span><a href="../../../include/utils/varbit.h.html#LN50"><span class='Ref_to_Macro'>VARBITS</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1443"><span class='Ref_To_Local'>arg</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Set the first part of the result to 0 */ 
</span>    <a href="../../../include/c.h.html#LN856"><span class='Ref_to_Macro'>MemSet</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1450"><span class='Ref_To_Local'>r</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Delimiter'>, </span><a href="varbit.c.html#LN1446"><span class='Ref_To_Local'>byte_shift</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="varbit.c.html#LN1450"><span class='Ref_To_Local'>r</span></a> <span class='Operator'>+= </span><a href="varbit.c.html#LN1446"><span class='Ref_To_Local'>byte_shift</span></a><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="varbit.c.html#LN1447"><span class='Ref_To_Local'>ishift</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* Special case: we can do a memcpy */ 
</span>        <a href="varbit.c.html#LN1448"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>= </span><a href="../../../include/utils/varbit.h.html#LN52"><span class='Ref_to_Macro'>VARBITBYTES</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1443"><span class='Ref_To_Local'>arg</span></a><span class='Parentheses'>) </span><span class='Operator'>- </span><a href="varbit.c.html#LN1446"><span class='Ref_To_Local'>byte_shift</span></a><span class='Delimiter'>; 
</span>        memcpy<span class='Parentheses'>(</span><a href="varbit.c.html#LN1450"><span class='Ref_To_Local'>r</span></a><span class='Delimiter'>, </span><a href="varbit.c.html#LN1449"><span class='Ref_To_Local'>p</span></a><span class='Delimiter'>, </span><a href="varbit.c.html#LN1448"><span class='Ref_To_Local'>len</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="varbit.c.html#LN1450"><span class='Ref_To_Local'>r</span></a> <span class='Operator'>&LT; </span><a href="../../../include/utils/varbit.h.html#LN64"><span class='Ref_to_Macro'>VARBITEND</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1445"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>))</span> 
            <span class='Operator'>*</span><a href="varbit.c.html#LN1450"><span class='Ref_To_Local'>r</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>;</span>             <span class='Comment_Single_Line'>/* initialize first byte */ 
</span>        <span class='Control'>for</span> <span class='Parentheses'>(</span><span class='Delimiter'>; </span><a href="varbit.c.html#LN1450"><span class='Ref_To_Local'>r</span></a> <span class='Operator'>&LT; </span><a href="../../../include/utils/varbit.h.html#LN64"><span class='Ref_to_Macro'>VARBITEND</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1445"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; </span><a href="varbit.c.html#LN1449"><span class='Ref_To_Local'>p</span></a><span class='Operator'>++</span><span class='Parentheses'>)</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Operator'>*</span><a href="varbit.c.html#LN1450"><span class='Ref_To_Local'>r</span></a> <span class='Operator'>|= *</span><a href="varbit.c.html#LN1449"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>&GT;&GT; </span><a href="varbit.c.html#LN1447"><span class='Ref_To_Local'>ishift</span></a><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>((</span><span class='Operator'>++</span><a href="varbit.c.html#LN1450"><span class='Ref_To_Local'>r</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT; </span><a href="../../../include/utils/varbit.h.html#LN64"><span class='Ref_to_Macro'>VARBITEND</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1445"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>))</span> 
                <span class='Operator'>*</span><a href="varbit.c.html#LN1450"><span class='Ref_To_Local'>r</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="varbit.c.html#LN1449"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>&LT;&LT; </span><span class='Parentheses'>(</span><a href="../../../include/pg_config_manual.h.html#LN105"><span class='Ref_to_Const'>BITS_PER_BYTE</span></a> <span class='Operator'>- </span><a href="varbit.c.html#LN1447"><span class='Ref_To_Local'>ishift</span></a><span class='Parentheses'>))</span> <span class='Operator'>& </span><a href="../../../include/utils/varbit.h.html#LN66"><span class='Ref_to_Const'>BITMASK</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="../../../include/utils/varbit.h.html#LN43"><span class='Ref_to_Macro'>PG_RETURN_VARBIT_P</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1445"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end bitshiftright &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * This is not defined in any standard. We retain the natural ordering of 
 * bits here, as it just seems more intuitive. 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN1509"></a><span class='Declare_Function'>bitfromint4</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1511"></a>    <a href="../../../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>       <span class='Declare_Local'>a</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN233"><span class='Ref_to_Macro'>PG_GETARG_INT32</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1512"></a>    <a href="../../../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>       <span class='Declare_Local'>typmod</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN233"><span class='Ref_to_Macro'>PG_GETARG_INT32</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1513"></a>    <a href="../../../include/utils/varbit.h.html#LN24"><span class='Ref_to_Typedef'>VarBit</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span><a name="LN1514"></a>    <a href="../../../include/c.h.html#LN274"><span class='Ref_to_Typedef'>bits8</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>r</span><span class='Delimiter'>; 
</span><a name="LN1515"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>rlen</span><span class='Delimiter'>; 
</span><a name="LN1516"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>destbitsleft</span><span class='Delimiter'>, 
</span><a name="LN1517"></a>                <span class='Declare_Local'>srcbitsleft</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="varbit.c.html#LN1512"><span class='Ref_To_Local'>typmod</span></a> <span class='Operator'>&LT;= </span><span class='Number'>0</span> <span class='Operator'>|| </span><a href="varbit.c.html#LN1512"><span class='Ref_To_Local'>typmod</span></a> <span class='Operator'>&GT; </span><a href="../../../include/utils/varbit.h.html#LN62"><span class='Ref_to_Const'>VARBITMAXLEN</span></a><span class='Parentheses'>) 
</span>        <a href="varbit.c.html#LN1512"><span class='Ref_To_Local'>typmod</span></a> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>;</span>             <span class='Comment_Single_Line'>/* default bit length */ 
</span> 
    <a href="varbit.c.html#LN1515"><span class='Ref_To_Local'>rlen</span></a> <span class='Operator'>= </span><a href="../../../include/utils/varbit.h.html#LN56"><span class='Ref_to_Macro'>VARBITTOTALLEN</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1512"><span class='Ref_To_Local'>typmod</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="varbit.c.html#LN1513"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/utils/varbit.h.html#LN24"><span class='Ref_to_Typedef'>VarBit</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1515"><span class='Ref_To_Local'>rlen</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../../include/postgres.h.html#LN327"><span class='Ref_to_Macro'>SET_VARSIZE</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1513"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>, </span><a href="varbit.c.html#LN1515"><span class='Ref_To_Local'>rlen</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../../include/utils/varbit.h.html#LN48"><span class='Ref_to_Macro'>VARBITLEN</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1513"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>) </span><span class='Operator'>= </span><a href="varbit.c.html#LN1512"><span class='Ref_To_Local'>typmod</span></a><span class='Delimiter'>; 
</span> 
    <a href="varbit.c.html#LN1514"><span class='Ref_To_Local'>r</span></a> <span class='Operator'>= </span><a href="../../../include/utils/varbit.h.html#LN50"><span class='Ref_to_Macro'>VARBITS</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1513"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="varbit.c.html#LN1516"><span class='Ref_To_Local'>destbitsleft</span></a> <span class='Operator'>= </span><a href="varbit.c.html#LN1512"><span class='Ref_To_Local'>typmod</span></a><span class='Delimiter'>; 
</span>    <a href="varbit.c.html#LN1517"><span class='Ref_To_Local'>srcbitsleft</span></a> <span class='Operator'>= </span><span class='Number'>32</span><span class='Delimiter'>; 
</span>    <span class='Comment_Multi_Line'>/* drop any input bits that don't fit */ 
</span>    <a href="varbit.c.html#LN1517"><span class='Ref_To_Local'>srcbitsleft</span></a> <span class='Operator'>= </span><a href="../../../interfaces/ecpg/pgtypeslib/numeric.c.html#LN11"><span class='Ref_to_Macro'>Min</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1517"><span class='Ref_To_Local'>srcbitsleft</span></a><span class='Delimiter'>, </span><a href="varbit.c.html#LN1516"><span class='Ref_To_Local'>destbitsleft</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Comment_Multi_Line'>/* sign-fill any excess bytes in output */ 
</span>    <span class='Control'>while</span> <span class='Parentheses'>(</span><a href="varbit.c.html#LN1516"><span class='Ref_To_Local'>destbitsleft</span></a> <span class='Operator'>&GT;= </span><a href="varbit.c.html#LN1517"><span class='Ref_To_Local'>srcbitsleft</span></a> <span class='Operator'>+ </span><span class='Number'>8</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Operator'>*</span><a href="varbit.c.html#LN1514"><span class='Ref_To_Local'>r</span></a><span class='Operator'>++ = </span><span class='Parentheses'>(</span><a href="../../../include/c.h.html#LN274"><span class='Ref_to_Typedef'>bits8</span></a><span class='Parentheses'>) ((</span><a href="varbit.c.html#LN1511"><span class='Ref_To_Local'>a</span></a> <span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>) </span><span class='Operator'>? </span><a href="../../../include/utils/varbit.h.html#LN66"><span class='Ref_to_Const'>BITMASK</span></a> <span class='Operator'>: </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="varbit.c.html#LN1516"><span class='Ref_To_Local'>destbitsleft</span></a> <span class='Operator'>-= </span><span class='Number'>8</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Comment_Multi_Line'>/* store first fractional byte */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="varbit.c.html#LN1516"><span class='Ref_To_Local'>destbitsleft</span></a> <span class='Operator'>&GT; </span><a href="varbit.c.html#LN1517"><span class='Ref_To_Local'>srcbitsleft</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN1541"></a>        <span class='Keyword'>int</span>         <span class='Declare_Local'>val</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Keyword'>int</span><span class='Parentheses'>) (</span><a href="varbit.c.html#LN1511"><span class='Ref_To_Local'>a</span></a> <span class='Operator'>&GT;&GT; </span><span class='Parentheses'>(</span><a href="varbit.c.html#LN1516"><span class='Ref_To_Local'>destbitsleft</span></a> <span class='Operator'>- </span><span class='Number'>8</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* Force sign-fill in case the compiler implements &GT;&GT; as zero-fill */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="varbit.c.html#LN1511"><span class='Ref_To_Local'>a</span></a> <span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>            <a href="varbit.c.html#LN1541"><span class='Ref_To_Local'>val</span></a> <span class='Operator'>|= </span><span class='Parentheses'>(</span><span class='Operator'>-</span><span class='Number'>1</span><span class='Parentheses'>) </span><span class='Operator'>&LT;&LT; </span><span class='Parentheses'>(</span><a href="varbit.c.html#LN1517"><span class='Ref_To_Local'>srcbitsleft</span></a> <span class='Operator'>+ </span><span class='Number'>8</span> <span class='Operator'>- </span><a href="varbit.c.html#LN1516"><span class='Ref_To_Local'>destbitsleft</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Operator'>*</span><a href="varbit.c.html#LN1514"><span class='Ref_To_Local'>r</span></a><span class='Operator'>++ = </span><span class='Parentheses'>(</span><a href="../../../include/c.h.html#LN274"><span class='Ref_to_Typedef'>bits8</span></a><span class='Parentheses'>) (</span><a href="varbit.c.html#LN1541"><span class='Ref_To_Local'>val</span></a> <span class='Operator'>& </span><a href="../../../include/utils/varbit.h.html#LN66"><span class='Ref_to_Const'>BITMASK</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="varbit.c.html#LN1516"><span class='Ref_To_Local'>destbitsleft</span></a> <span class='Operator'>-= </span><span class='Number'>8</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Comment_Multi_Line'>/* Now srcbitsleft and destbitsleft are the same, need not track both */ 
</span>    <span class='Comment_Multi_Line'>/* store whole bytes */ 
</span>    <span class='Control'>while</span> <span class='Parentheses'>(</span><a href="varbit.c.html#LN1516"><span class='Ref_To_Local'>destbitsleft</span></a> <span class='Operator'>&GT;= </span><span class='Number'>8</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Operator'>*</span><a href="varbit.c.html#LN1514"><span class='Ref_To_Local'>r</span></a><span class='Operator'>++ = </span><span class='Parentheses'>(</span><a href="../../../include/c.h.html#LN274"><span class='Ref_to_Typedef'>bits8</span></a><span class='Parentheses'>) ((</span><a href="varbit.c.html#LN1511"><span class='Ref_To_Local'>a</span></a> <span class='Operator'>&GT;&GT; </span><span class='Parentheses'>(</span><a href="varbit.c.html#LN1516"><span class='Ref_To_Local'>destbitsleft</span></a> <span class='Operator'>- </span><span class='Number'>8</span><span class='Parentheses'>))</span> <span class='Operator'>& </span><a href="../../../include/utils/varbit.h.html#LN66"><span class='Ref_to_Const'>BITMASK</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="varbit.c.html#LN1516"><span class='Ref_To_Local'>destbitsleft</span></a> <span class='Operator'>-= </span><span class='Number'>8</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Comment_Multi_Line'>/* store last fractional byte */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="varbit.c.html#LN1516"><span class='Ref_To_Local'>destbitsleft</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>        <span class='Operator'>*</span><a href="varbit.c.html#LN1514"><span class='Ref_To_Local'>r</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/c.h.html#LN274"><span class='Ref_to_Typedef'>bits8</span></a><span class='Parentheses'>) ((</span><a href="varbit.c.html#LN1511"><span class='Ref_To_Local'>a</span></a> <span class='Operator'>&LT;&LT; </span><span class='Parentheses'>(</span><span class='Number'>8</span> <span class='Operator'>- </span><a href="varbit.c.html#LN1516"><span class='Ref_To_Local'>destbitsleft</span></a><span class='Parentheses'>))</span> <span class='Operator'>& </span><a href="../../../include/utils/varbit.h.html#LN66"><span class='Ref_to_Const'>BITMASK</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/utils/varbit.h.html#LN43"><span class='Ref_to_Macro'>PG_RETURN_VARBIT_P</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1513"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end bitfromint4 &raquo; </span> 
 
<a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN1564"></a><span class='Declare_Function'>bittoint4</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1566"></a>    <a href="../../../include/utils/varbit.h.html#LN24"><span class='Ref_to_Typedef'>VarBit</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>arg</span> <span class='Operator'>= </span><a href="../../../include/utils/varbit.h.html#LN41"><span class='Ref_to_Macro'>PG_GETARG_VARBIT_P</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1567"></a>    <a href="../../../include/c.h.html#LN267"><span class='Ref_to_Typedef'>uint32</span></a>      <span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span><a name="LN1568"></a>    <a href="../../../include/c.h.html#LN274"><span class='Ref_to_Typedef'>bits8</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>r</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Check that the bit string is not too long */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/utils/varbit.h.html#LN48"><span class='Ref_to_Macro'>VARBITLEN</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1566"><span class='Ref_To_Local'>arg</span></a><span class='Parentheses'>) </span><span class='Operator'>&GT; </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="varbit.c.html#LN1567"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>) </span><span class='Operator'>* </span><a href="../../../include/pg_config_manual.h.html#LN105"><span class='Ref_to_Const'>BITS_PER_BYTE</span></a><span class='Parentheses'>)</span> 
        <a href="../../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_NUMERIC_VALUE_OUT_OF_RANGE<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"integer out of range"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
    <a href="varbit.c.html#LN1567"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="varbit.c.html#LN1568"><span class='Ref_To_Local'>r</span></a> <span class='Operator'>= </span><a href="../../../include/utils/varbit.h.html#LN50"><span class='Ref_to_Macro'>VARBITS</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1566"><span class='Ref_To_Local'>arg</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; </span><a href="varbit.c.html#LN1568"><span class='Ref_To_Local'>r</span></a> <span class='Operator'>&LT; </span><a href="../../../include/utils/varbit.h.html#LN64"><span class='Ref_to_Macro'>VARBITEND</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1566"><span class='Ref_To_Local'>arg</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; </span><a href="varbit.c.html#LN1568"><span class='Ref_To_Local'>r</span></a><span class='Operator'>++</span><span class='Parentheses'>)</span> 
    <span class='Delimiter'>{ 
</span>        <a href="varbit.c.html#LN1567"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>&LT;&LT;= </span><a href="../../../include/pg_config_manual.h.html#LN105"><span class='Ref_to_Const'>BITS_PER_BYTE</span></a><span class='Delimiter'>; 
</span>        <a href="varbit.c.html#LN1567"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>|= *</span><a href="varbit.c.html#LN1568"><span class='Ref_To_Local'>r</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Comment_Multi_Line'>/* Now shift the result to take account of the padding at the end */ 
</span><a name="LN1583"></a>    <a href="varbit.c.html#LN1567"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>&GT;&GT;= </span><span class='Declare_Local'>VARBITPAD</span><span class='Parentheses'>(</span><a href="varbit.c.html#LN1566"><span class='Ref_To_Local'>arg</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/fmgr.h.html#LN313"><span class='Ref_to_Macro'>PG_RETURN_INT32</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1567"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end bittoint4 &raquo; </span> 
 
<a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN1589"></a><span class='Declare_Function'>bitfromint8</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1591"></a>    <a href="../../../include/c.h.html#LN294"><span class='Ref_to_Typedef'>int64</span></a>       <span class='Declare_Local'>a</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN246"><span class='Ref_to_Macro'>PG_GETARG_INT64</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1592"></a>    <a href="../../../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>       <span class='Declare_Local'>typmod</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN233"><span class='Ref_to_Macro'>PG_GETARG_INT32</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1593"></a>    <a href="../../../include/utils/varbit.h.html#LN24"><span class='Ref_to_Typedef'>VarBit</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span><a name="LN1594"></a>    <a href="../../../include/c.h.html#LN274"><span class='Ref_to_Typedef'>bits8</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>r</span><span class='Delimiter'>; 
</span><a name="LN1595"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>rlen</span><span class='Delimiter'>; 
</span><a name="LN1596"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>destbitsleft</span><span class='Delimiter'>, 
</span><a name="LN1597"></a>                <span class='Declare_Local'>srcbitsleft</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="varbit.c.html#LN1592"><span class='Ref_To_Local'>typmod</span></a> <span class='Operator'>&LT;= </span><span class='Number'>0</span> <span class='Operator'>|| </span><a href="varbit.c.html#LN1592"><span class='Ref_To_Local'>typmod</span></a> <span class='Operator'>&GT; </span><a href="../../../include/utils/varbit.h.html#LN62"><span class='Ref_to_Const'>VARBITMAXLEN</span></a><span class='Parentheses'>) 
</span>        <a href="varbit.c.html#LN1592"><span class='Ref_To_Local'>typmod</span></a> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>;</span>             <span class='Comment_Single_Line'>/* default bit length */ 
</span> 
    <a href="varbit.c.html#LN1595"><span class='Ref_To_Local'>rlen</span></a> <span class='Operator'>= </span><a href="../../../include/utils/varbit.h.html#LN56"><span class='Ref_to_Macro'>VARBITTOTALLEN</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1592"><span class='Ref_To_Local'>typmod</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="varbit.c.html#LN1593"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/utils/varbit.h.html#LN24"><span class='Ref_to_Typedef'>VarBit</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1595"><span class='Ref_To_Local'>rlen</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../../include/postgres.h.html#LN327"><span class='Ref_to_Macro'>SET_VARSIZE</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1593"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>, </span><a href="varbit.c.html#LN1595"><span class='Ref_To_Local'>rlen</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../../include/utils/varbit.h.html#LN48"><span class='Ref_to_Macro'>VARBITLEN</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1593"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>) </span><span class='Operator'>= </span><a href="varbit.c.html#LN1592"><span class='Ref_To_Local'>typmod</span></a><span class='Delimiter'>; 
</span> 
    <a href="varbit.c.html#LN1594"><span class='Ref_To_Local'>r</span></a> <span class='Operator'>= </span><a href="../../../include/utils/varbit.h.html#LN50"><span class='Ref_to_Macro'>VARBITS</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1593"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="varbit.c.html#LN1596"><span class='Ref_To_Local'>destbitsleft</span></a> <span class='Operator'>= </span><a href="varbit.c.html#LN1592"><span class='Ref_To_Local'>typmod</span></a><span class='Delimiter'>; 
</span>    <a href="varbit.c.html#LN1597"><span class='Ref_To_Local'>srcbitsleft</span></a> <span class='Operator'>= </span><span class='Number'>64</span><span class='Delimiter'>; 
</span>    <span class='Comment_Multi_Line'>/* drop any input bits that don't fit */ 
</span>    <a href="varbit.c.html#LN1597"><span class='Ref_To_Local'>srcbitsleft</span></a> <span class='Operator'>= </span><a href="../../../interfaces/ecpg/pgtypeslib/numeric.c.html#LN11"><span class='Ref_to_Macro'>Min</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1597"><span class='Ref_To_Local'>srcbitsleft</span></a><span class='Delimiter'>, </span><a href="varbit.c.html#LN1596"><span class='Ref_To_Local'>destbitsleft</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Comment_Multi_Line'>/* sign-fill any excess bytes in output */ 
</span>    <span class='Control'>while</span> <span class='Parentheses'>(</span><a href="varbit.c.html#LN1596"><span class='Ref_To_Local'>destbitsleft</span></a> <span class='Operator'>&GT;= </span><a href="varbit.c.html#LN1597"><span class='Ref_To_Local'>srcbitsleft</span></a> <span class='Operator'>+ </span><span class='Number'>8</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Operator'>*</span><a href="varbit.c.html#LN1594"><span class='Ref_To_Local'>r</span></a><span class='Operator'>++ = </span><span class='Parentheses'>(</span><a href="../../../include/c.h.html#LN274"><span class='Ref_to_Typedef'>bits8</span></a><span class='Parentheses'>) ((</span><a href="varbit.c.html#LN1591"><span class='Ref_To_Local'>a</span></a> <span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>) </span><span class='Operator'>? </span><a href="../../../include/utils/varbit.h.html#LN66"><span class='Ref_to_Const'>BITMASK</span></a> <span class='Operator'>: </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="varbit.c.html#LN1596"><span class='Ref_To_Local'>destbitsleft</span></a> <span class='Operator'>-= </span><span class='Number'>8</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Comment_Multi_Line'>/* store first fractional byte */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="varbit.c.html#LN1596"><span class='Ref_To_Local'>destbitsleft</span></a> <span class='Operator'>&GT; </span><a href="varbit.c.html#LN1597"><span class='Ref_To_Local'>srcbitsleft</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN1621"></a>        <span class='Keyword'>int</span>         <span class='Declare_Local'>val</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Keyword'>int</span><span class='Parentheses'>) (</span><a href="varbit.c.html#LN1591"><span class='Ref_To_Local'>a</span></a> <span class='Operator'>&GT;&GT; </span><span class='Parentheses'>(</span><a href="varbit.c.html#LN1596"><span class='Ref_To_Local'>destbitsleft</span></a> <span class='Operator'>- </span><span class='Number'>8</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* Force sign-fill in case the compiler implements &GT;&GT; as zero-fill */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="varbit.c.html#LN1591"><span class='Ref_To_Local'>a</span></a> <span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>            <a href="varbit.c.html#LN1621"><span class='Ref_To_Local'>val</span></a> <span class='Operator'>|= </span><span class='Parentheses'>(</span><span class='Operator'>-</span><span class='Number'>1</span><span class='Parentheses'>) </span><span class='Operator'>&LT;&LT; </span><span class='Parentheses'>(</span><a href="varbit.c.html#LN1597"><span class='Ref_To_Local'>srcbitsleft</span></a> <span class='Operator'>+ </span><span class='Number'>8</span> <span class='Operator'>- </span><a href="varbit.c.html#LN1596"><span class='Ref_To_Local'>destbitsleft</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Operator'>*</span><a href="varbit.c.html#LN1594"><span class='Ref_To_Local'>r</span></a><span class='Operator'>++ = </span><span class='Parentheses'>(</span><a href="../../../include/c.h.html#LN274"><span class='Ref_to_Typedef'>bits8</span></a><span class='Parentheses'>) (</span><a href="varbit.c.html#LN1621"><span class='Ref_To_Local'>val</span></a> <span class='Operator'>& </span><a href="../../../include/utils/varbit.h.html#LN66"><span class='Ref_to_Const'>BITMASK</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="varbit.c.html#LN1596"><span class='Ref_To_Local'>destbitsleft</span></a> <span class='Operator'>-= </span><span class='Number'>8</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Comment_Multi_Line'>/* Now srcbitsleft and destbitsleft are the same, need not track both */ 
</span>    <span class='Comment_Multi_Line'>/* store whole bytes */ 
</span>    <span class='Control'>while</span> <span class='Parentheses'>(</span><a href="varbit.c.html#LN1596"><span class='Ref_To_Local'>destbitsleft</span></a> <span class='Operator'>&GT;= </span><span class='Number'>8</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Operator'>*</span><a href="varbit.c.html#LN1594"><span class='Ref_To_Local'>r</span></a><span class='Operator'>++ = </span><span class='Parentheses'>(</span><a href="../../../include/c.h.html#LN274"><span class='Ref_to_Typedef'>bits8</span></a><span class='Parentheses'>) ((</span><a href="varbit.c.html#LN1591"><span class='Ref_To_Local'>a</span></a> <span class='Operator'>&GT;&GT; </span><span class='Parentheses'>(</span><a href="varbit.c.html#LN1596"><span class='Ref_To_Local'>destbitsleft</span></a> <span class='Operator'>- </span><span class='Number'>8</span><span class='Parentheses'>))</span> <span class='Operator'>& </span><a href="../../../include/utils/varbit.h.html#LN66"><span class='Ref_to_Const'>BITMASK</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="varbit.c.html#LN1596"><span class='Ref_To_Local'>destbitsleft</span></a> <span class='Operator'>-= </span><span class='Number'>8</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Comment_Multi_Line'>/* store last fractional byte */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="varbit.c.html#LN1596"><span class='Ref_To_Local'>destbitsleft</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>        <span class='Operator'>*</span><a href="varbit.c.html#LN1594"><span class='Ref_To_Local'>r</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/c.h.html#LN274"><span class='Ref_to_Typedef'>bits8</span></a><span class='Parentheses'>) ((</span><a href="varbit.c.html#LN1591"><span class='Ref_To_Local'>a</span></a> <span class='Operator'>&LT;&LT; </span><span class='Parentheses'>(</span><span class='Number'>8</span> <span class='Operator'>- </span><a href="varbit.c.html#LN1596"><span class='Ref_To_Local'>destbitsleft</span></a><span class='Parentheses'>))</span> <span class='Operator'>& </span><a href="../../../include/utils/varbit.h.html#LN66"><span class='Ref_to_Const'>BITMASK</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/utils/varbit.h.html#LN43"><span class='Ref_to_Macro'>PG_RETURN_VARBIT_P</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1593"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end bitfromint8 &raquo; </span> 
 
<a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN1644"></a><span class='Declare_Function'>bittoint8</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1646"></a>    <a href="../../../include/utils/varbit.h.html#LN24"><span class='Ref_to_Typedef'>VarBit</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>arg</span> <span class='Operator'>= </span><a href="../../../include/utils/varbit.h.html#LN41"><span class='Ref_to_Macro'>PG_GETARG_VARBIT_P</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1647"></a>    <a href="../../../include/c.h.html#LN297"><span class='Ref_to_Typedef'>uint64</span></a>      <span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span><a name="LN1648"></a>    <a href="../../../include/c.h.html#LN274"><span class='Ref_to_Typedef'>bits8</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>r</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Check that the bit string is not too long */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/utils/varbit.h.html#LN48"><span class='Ref_to_Macro'>VARBITLEN</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1646"><span class='Ref_To_Local'>arg</span></a><span class='Parentheses'>) </span><span class='Operator'>&GT; </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="varbit.c.html#LN1647"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>) </span><span class='Operator'>* </span><a href="../../../include/pg_config_manual.h.html#LN105"><span class='Ref_to_Const'>BITS_PER_BYTE</span></a><span class='Parentheses'>)</span> 
        <a href="../../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_NUMERIC_VALUE_OUT_OF_RANGE<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"bigint out of range"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
    <a href="varbit.c.html#LN1647"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="varbit.c.html#LN1648"><span class='Ref_To_Local'>r</span></a> <span class='Operator'>= </span><a href="../../../include/utils/varbit.h.html#LN50"><span class='Ref_to_Macro'>VARBITS</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1646"><span class='Ref_To_Local'>arg</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; </span><a href="varbit.c.html#LN1648"><span class='Ref_To_Local'>r</span></a> <span class='Operator'>&LT; </span><a href="../../../include/utils/varbit.h.html#LN64"><span class='Ref_to_Macro'>VARBITEND</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1646"><span class='Ref_To_Local'>arg</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; </span><a href="varbit.c.html#LN1648"><span class='Ref_To_Local'>r</span></a><span class='Operator'>++</span><span class='Parentheses'>)</span> 
    <span class='Delimiter'>{ 
</span>        <a href="varbit.c.html#LN1647"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>&LT;&LT;= </span><a href="../../../include/pg_config_manual.h.html#LN105"><span class='Ref_to_Const'>BITS_PER_BYTE</span></a><span class='Delimiter'>; 
</span>        <a href="varbit.c.html#LN1647"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>|= *</span><a href="varbit.c.html#LN1648"><span class='Ref_To_Local'>r</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Comment_Multi_Line'>/* Now shift the result to take account of the padding at the end */ 
</span><a name="LN1663"></a>    <a href="varbit.c.html#LN1647"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>&GT;&GT;= </span><span class='Declare_Local'>VARBITPAD</span><span class='Parentheses'>(</span><a href="varbit.c.html#LN1646"><span class='Ref_To_Local'>arg</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/fmgr.h.html#LN326"><span class='Ref_to_Macro'>PG_RETURN_INT64</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1647"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end bittoint8 &raquo; </span> 
 
 
<span class='Comment_Multi_Line'>/* 
 * Determines the position of S2 in the bitstring S1 (1-based string). 
 * If S2 does not appear in S1 this function returns 0. 
 * If S2 is of length 0 this function returns 1. 
 * Compatible in usage with POSITION() functions for other data types. 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN1676"></a><span class='Declare_Function'>bitposition</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1678"></a>    <a href="../../../include/utils/varbit.h.html#LN24"><span class='Ref_to_Typedef'>VarBit</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>str</span> <span class='Operator'>= </span><a href="../../../include/utils/varbit.h.html#LN41"><span class='Ref_to_Macro'>PG_GETARG_VARBIT_P</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1679"></a>    <a href="../../../include/utils/varbit.h.html#LN24"><span class='Ref_to_Typedef'>VarBit</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>substr</span> <span class='Operator'>= </span><a href="../../../include/utils/varbit.h.html#LN41"><span class='Ref_to_Macro'>PG_GETARG_VARBIT_P</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1680"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>substr_length</span><span class='Delimiter'>, 
</span><a name="LN1681"></a>                <span class='Declare_Local'>str_length</span><span class='Delimiter'>, 
</span><a name="LN1682"></a>                <span class='Declare_Local'>i</span><span class='Delimiter'>, 
</span><a name="LN1683"></a>                <span class='Declare_Local'>is</span><span class='Delimiter'>; 
</span><a name="LN1684"></a>    <a href="../../../include/c.h.html#LN274"><span class='Ref_to_Typedef'>bits8</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>s</span><span class='Delimiter'>,</span>              <span class='Comment_Single_Line'>/* pointer into substring */ 
</span><a name="LN1685"></a>               <span class='Operator'>*</span><span class='Declare_Local'>p</span><span class='Delimiter'>;</span>              <span class='Comment_Single_Line'>/* pointer into str */ 
</span><a name="LN1686"></a>    <a href="../../../include/c.h.html#LN274"><span class='Ref_to_Typedef'>bits8</span></a>       <span class='Declare_Local'>cmp</span><span class='Delimiter'>,</span>            <span class='Comment_Single_Line'>/* shifted substring byte to compare */ 
</span><a name="LN1687"></a>                <span class='Declare_Local'>mask1</span><span class='Delimiter'>,</span>          <span class='Comment_Single_Line'>/* mask for substring byte shifted right */ 
</span><a name="LN1688"></a>                <span class='Declare_Local'>mask2</span><span class='Delimiter'>,</span>          <span class='Comment_Single_Line'>/* mask for substring byte shifted left */ 
</span><a name="LN1689"></a>                <span class='Declare_Local'>end_mask</span><span class='Delimiter'>,</span>       <span class='Comment_Single_Line'>/* pad mask for last substring byte */ 
</span><a name="LN1690"></a>                <span class='Declare_Local'>str_mask</span><span class='Delimiter'>;</span>       <span class='Comment_Single_Line'>/* pad mask for last string byte */ 
</span><a name="LN1691"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>is_match</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Get the substring length */ 
</span>    <a href="varbit.c.html#LN1680"><span class='Ref_To_Local'>substr_length</span></a> <span class='Operator'>= </span><a href="../../../include/utils/varbit.h.html#LN48"><span class='Ref_to_Macro'>VARBITLEN</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1679"><span class='Ref_To_Local'>substr</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="varbit.c.html#LN1681"><span class='Ref_To_Local'>str_length</span></a> <span class='Operator'>= </span><a href="../../../include/utils/varbit.h.html#LN48"><span class='Ref_to_Macro'>VARBITLEN</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1678"><span class='Ref_To_Local'>str</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* String has zero length or substring longer than string, return 0 */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="varbit.c.html#LN1681"><span class='Ref_To_Local'>str_length</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>) </span><span class='Operator'>|| </span><span class='Parentheses'>(</span><a href="varbit.c.html#LN1680"><span class='Ref_To_Local'>substr_length</span></a> <span class='Operator'>&GT; </span><a href="varbit.c.html#LN1681"><span class='Ref_To_Local'>str_length</span></a><span class='Parentheses'>))</span> 
        <a href="../../../include/fmgr.h.html#LN313"><span class='Ref_to_Macro'>PG_RETURN_INT32</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* zero-length substring means return 1 */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="varbit.c.html#LN1680"><span class='Ref_To_Local'>substr_length</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>        <a href="../../../include/fmgr.h.html#LN313"><span class='Ref_to_Macro'>PG_RETURN_INT32</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Initialise the padding masks */ 
</span>    <a href="varbit.c.html#LN1689"><span class='Ref_To_Local'>end_mask</span></a> <span class='Operator'>= </span><a href="../../../include/utils/varbit.h.html#LN66"><span class='Ref_to_Const'>BITMASK</span></a> <span class='Operator'>&LT;&LT; </span><a href="../../../include/utils/varbit.h.html#LN54"><span class='Ref_to_Macro'>VARBITPAD</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1679"><span class='Ref_To_Local'>substr</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="varbit.c.html#LN1690"><span class='Ref_To_Local'>str_mask</span></a> <span class='Operator'>= </span><a href="../../../include/utils/varbit.h.html#LN66"><span class='Ref_to_Const'>BITMASK</span></a> <span class='Operator'>&LT;&LT; </span><a href="../../../include/utils/varbit.h.html#LN54"><span class='Ref_to_Macro'>VARBITPAD</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1678"><span class='Ref_To_Local'>str</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="varbit.c.html#LN1682"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="varbit.c.html#LN1682"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="../../../include/utils/varbit.h.html#LN52"><span class='Ref_to_Macro'>VARBITBYTES</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1678"><span class='Ref_To_Local'>str</span></a><span class='Parentheses'>) </span><span class='Operator'>- </span><a href="../../../include/utils/varbit.h.html#LN52"><span class='Ref_to_Macro'>VARBITBYTES</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1679"><span class='Ref_To_Local'>substr</span></a><span class='Parentheses'>) </span><span class='Operator'>+ </span><span class='Number'>1</span><span class='Delimiter'>; </span><a href="varbit.c.html#LN1682"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Parentheses'>)</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="varbit.c.html#LN1683"><span class='Ref_To_Local'>is</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="varbit.c.html#LN1683"><span class='Ref_To_Local'>is</span></a> <span class='Operator'>&LT; </span><a href="../../../include/pg_config_manual.h.html#LN105"><span class='Ref_to_Const'>BITS_PER_BYTE</span></a><span class='Delimiter'>; </span><a href="varbit.c.html#LN1683"><span class='Ref_To_Local'>is</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <a href="varbit.c.html#LN1691"><span class='Ref_To_Local'>is_match</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>            <a href="varbit.c.html#LN1685"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>= </span><a href="../../../include/utils/varbit.h.html#LN50"><span class='Ref_to_Macro'>VARBITS</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1678"><span class='Ref_To_Local'>str</span></a><span class='Parentheses'>) </span><span class='Operator'>+ </span><a href="varbit.c.html#LN1682"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>; 
</span>            <a href="varbit.c.html#LN1687"><span class='Ref_To_Local'>mask1</span></a> <span class='Operator'>= </span><a href="../../../include/utils/varbit.h.html#LN66"><span class='Ref_to_Const'>BITMASK</span></a> <span class='Operator'>&GT;&GT; </span><a href="varbit.c.html#LN1683"><span class='Ref_To_Local'>is</span></a><span class='Delimiter'>; 
</span>            <a href="varbit.c.html#LN1688"><span class='Ref_To_Local'>mask2</span></a> <span class='Operator'>= ~</span><a href="varbit.c.html#LN1687"><span class='Ref_To_Local'>mask1</span></a><span class='Delimiter'>; 
</span>            <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="varbit.c.html#LN1684"><span class='Ref_To_Local'>s</span></a> <span class='Operator'>= </span><a href="../../../include/utils/varbit.h.html#LN50"><span class='Ref_to_Macro'>VARBITS</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1679"><span class='Ref_To_Local'>substr</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                 <a href="varbit.c.html#LN1691"><span class='Ref_To_Local'>is_match</span></a> <span class='Operator'>&& </span><a href="varbit.c.html#LN1684"><span class='Ref_To_Local'>s</span></a> <span class='Operator'>&LT; </span><a href="../../../include/utils/varbit.h.html#LN64"><span class='Ref_to_Macro'>VARBITEND</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1679"><span class='Ref_To_Local'>substr</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; </span><a href="varbit.c.html#LN1684"><span class='Ref_To_Local'>s</span></a><span class='Operator'>++</span><span class='Parentheses'>)</span> 
            <span class='Delimiter'>{ 
</span>                <a href="varbit.c.html#LN1686"><span class='Ref_To_Local'>cmp</span></a> <span class='Operator'>= *</span><a href="varbit.c.html#LN1684"><span class='Ref_To_Local'>s</span></a> <span class='Operator'>&GT;&GT; </span><a href="varbit.c.html#LN1683"><span class='Ref_To_Local'>is</span></a><span class='Delimiter'>; 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="varbit.c.html#LN1684"><span class='Ref_To_Local'>s</span></a> <span class='Operator'>== </span><a href="../../../include/utils/varbit.h.html#LN64"><span class='Ref_to_Macro'>VARBITEND</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1679"><span class='Ref_To_Local'>substr</span></a><span class='Parentheses'>) </span><span class='Operator'>- </span><span class='Number'>1</span><span class='Parentheses'>)</span> 
                <span class='Delimiter'>{ 
</span>                    <a href="varbit.c.html#LN1687"><span class='Ref_To_Local'>mask1</span></a> <span class='Operator'>&= </span><a href="varbit.c.html#LN1689"><span class='Ref_To_Local'>end_mask</span></a> <span class='Operator'>&GT;&GT; </span><a href="varbit.c.html#LN1683"><span class='Ref_To_Local'>is</span></a><span class='Delimiter'>; 
</span>                    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="varbit.c.html#LN1685"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>== </span><a href="../../../include/utils/varbit.h.html#LN64"><span class='Ref_to_Macro'>VARBITEND</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1678"><span class='Ref_To_Local'>str</span></a><span class='Parentheses'>) </span><span class='Operator'>- </span><span class='Number'>1</span><span class='Parentheses'>)</span> 
                    <span class='Delimiter'>{ 
</span>                        <span class='Comment_Multi_Line'>/* Check that there is enough of str left */ 
</span>                        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="varbit.c.html#LN1687"><span class='Ref_To_Local'>mask1</span></a> <span class='Operator'>& ~</span><a href="varbit.c.html#LN1690"><span class='Ref_To_Local'>str_mask</span></a><span class='Parentheses'>) 
</span>                        <span class='Delimiter'>{ 
</span>                            <a href="varbit.c.html#LN1691"><span class='Ref_To_Local'>is_match</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>                            <span class='Control'>break</span><span class='Delimiter'>; 
</span>                        <span class='Delimiter'>} 
</span>                        <a href="varbit.c.html#LN1687"><span class='Ref_To_Local'>mask1</span></a> <span class='Operator'>&= </span><a href="varbit.c.html#LN1690"><span class='Ref_To_Local'>str_mask</span></a><span class='Delimiter'>; 
</span>                    <span class='Delimiter'>} 
</span>                <span class='Delimiter'>} 
</span>                <a href="varbit.c.html#LN1691"><span class='Ref_To_Local'>is_match</span></a> <span class='Operator'>= </span><span class='Parentheses'>((</span><a href="varbit.c.html#LN1686"><span class='Ref_To_Local'>cmp</span></a> <span class='Operator'>^ *</span><a href="varbit.c.html#LN1685"><span class='Ref_To_Local'>p</span></a><span class='Parentheses'>) </span><span class='Operator'>& </span><a href="varbit.c.html#LN1687"><span class='Ref_To_Local'>mask1</span></a><span class='Parentheses'>)</span> <span class='Operator'>== </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="varbit.c.html#LN1691"><span class='Ref_To_Local'>is_match</span></a><span class='Parentheses'>) 
</span>                    <span class='Control'>break</span><span class='Delimiter'>; 
</span>                <span class='Comment_Multi_Line'>/* Move on to the next byte */ 
</span>                <a href="varbit.c.html#LN1685"><span class='Ref_To_Local'>p</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="varbit.c.html#LN1685"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>== </span><a href="../../../include/utils/varbit.h.html#LN64"><span class='Ref_to_Macro'>VARBITEND</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1678"><span class='Ref_To_Local'>str</span></a><span class='Parentheses'>))</span> 
                <span class='Delimiter'>{ 
</span>                    <a href="varbit.c.html#LN1688"><span class='Ref_To_Local'>mask2</span></a> <span class='Operator'>= </span><a href="varbit.c.html#LN1689"><span class='Ref_To_Local'>end_mask</span></a> <span class='Operator'>&LT;&LT; </span><span class='Parentheses'>(</span><a href="../../../include/pg_config_manual.h.html#LN105"><span class='Ref_to_Const'>BITS_PER_BYTE</span></a> <span class='Operator'>- </span><a href="varbit.c.html#LN1683"><span class='Ref_To_Local'>is</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                    <a href="varbit.c.html#LN1691"><span class='Ref_To_Local'>is_match</span></a> <span class='Operator'>= </span><a href="varbit.c.html#LN1688"><span class='Ref_To_Local'>mask2</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Delimiter'>; 
</span><span class='Directive'>#if</span> <span class='Number'>0</span> 
<span class='Inactive_Code'>                    elog(DEBUG4, "S. %d %d em=%2x sm=%2x r=%d", 
                         i, is, end_mask, mask2, is_match); 
</span><span class='Directive'>#endif</span> 
                    <span class='Control'>break</span><span class='Delimiter'>; 
</span>                <span class='Delimiter'>} 
</span>                <a href="varbit.c.html#LN1686"><span class='Ref_To_Local'>cmp</span></a> <span class='Operator'>= *</span><a href="varbit.c.html#LN1684"><span class='Ref_To_Local'>s</span></a> <span class='Operator'>&LT;&LT; </span><span class='Parentheses'>(</span><a href="../../../include/pg_config_manual.h.html#LN105"><span class='Ref_to_Const'>BITS_PER_BYTE</span></a> <span class='Operator'>- </span><a href="varbit.c.html#LN1683"><span class='Ref_To_Local'>is</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="varbit.c.html#LN1684"><span class='Ref_To_Local'>s</span></a> <span class='Operator'>== </span><a href="../../../include/utils/varbit.h.html#LN64"><span class='Ref_to_Macro'>VARBITEND</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1679"><span class='Ref_To_Local'>substr</span></a><span class='Parentheses'>) </span><span class='Operator'>- </span><span class='Number'>1</span><span class='Parentheses'>)</span> 
                <span class='Delimiter'>{ 
</span>                    <a href="varbit.c.html#LN1688"><span class='Ref_To_Local'>mask2</span></a> <span class='Operator'>&= </span><a href="varbit.c.html#LN1689"><span class='Ref_To_Local'>end_mask</span></a> <span class='Operator'>&LT;&LT; </span><span class='Parentheses'>(</span><a href="../../../include/pg_config_manual.h.html#LN105"><span class='Ref_to_Const'>BITS_PER_BYTE</span></a> <span class='Operator'>- </span><a href="varbit.c.html#LN1683"><span class='Ref_To_Local'>is</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="varbit.c.html#LN1685"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>== </span><a href="../../../include/utils/varbit.h.html#LN64"><span class='Ref_to_Macro'>VARBITEND</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1678"><span class='Ref_To_Local'>str</span></a><span class='Parentheses'>) </span><span class='Operator'>- </span><span class='Number'>1</span><span class='Parentheses'>)</span> 
                    <span class='Delimiter'>{ 
</span>                        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="varbit.c.html#LN1688"><span class='Ref_To_Local'>mask2</span></a> <span class='Operator'>& ~</span><a href="varbit.c.html#LN1690"><span class='Ref_To_Local'>str_mask</span></a><span class='Parentheses'>) 
</span>                        <span class='Delimiter'>{ 
</span>                            <a href="varbit.c.html#LN1691"><span class='Ref_To_Local'>is_match</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>                            <span class='Control'>break</span><span class='Delimiter'>; 
</span>                        <span class='Delimiter'>} 
</span>                        <a href="varbit.c.html#LN1688"><span class='Ref_To_Local'>mask2</span></a> <span class='Operator'>&= </span><a href="varbit.c.html#LN1690"><span class='Ref_To_Local'>str_mask</span></a><span class='Delimiter'>; 
</span>                    <span class='Delimiter'>} 
</span>                <span class='Delimiter'>} 
</span>                <a href="varbit.c.html#LN1691"><span class='Ref_To_Local'>is_match</span></a> <span class='Operator'>= </span><span class='Parentheses'>((</span><a href="varbit.c.html#LN1686"><span class='Ref_To_Local'>cmp</span></a> <span class='Operator'>^ *</span><a href="varbit.c.html#LN1685"><span class='Ref_To_Local'>p</span></a><span class='Parentheses'>) </span><span class='Operator'>& </span><a href="varbit.c.html#LN1688"><span class='Ref_To_Local'>mask2</span></a><span class='Parentheses'>)</span> <span class='Operator'>== </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end for s=VARBITS(substr);is_... &raquo; </span> 
            <span class='Comment_Multi_Line'>/* Have we found a match? */ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="varbit.c.html#LN1691"><span class='Ref_To_Local'>is_match</span></a><span class='Parentheses'>) 
</span>                <a href="../../../include/fmgr.h.html#LN313"><span class='Ref_to_Macro'>PG_RETURN_INT32</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1682"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>* </span><a href="../../../include/pg_config_manual.h.html#LN105"><span class='Ref_to_Const'>BITS_PER_BYTE</span></a> <span class='Operator'>+ </span><a href="varbit.c.html#LN1683"><span class='Ref_To_Local'>is</span></a> <span class='Operator'>+ </span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end for is=0;is&LT;BITS_PER_BYTE... &raquo; </span> 
    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end for i=0;i&LT;VARBITBYTES(str... &raquo; </span> 
    <a href="../../../include/fmgr.h.html#LN313"><span class='Ref_to_Macro'>PG_RETURN_INT32</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end bitposition &raquo; </span> 
 
 
<span class='Comment_Multi_Line'>/* 
 * bitsetbit 
 * 
 * Given an instance of type 'bit' creates a new one with 
 * the Nth bit set to the given value. 
 * 
 * The bit location is specified left-to-right in a zero-based fashion 
 * consistent with the other get_bit and set_bit functions, but 
 * inconsistent with the standard substring, position, overlay functions 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN1785"></a><span class='Declare_Function'>bitsetbit</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1787"></a>    <a href="../../../include/utils/varbit.h.html#LN24"><span class='Ref_to_Typedef'>VarBit</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>arg1</span> <span class='Operator'>= </span><a href="../../../include/utils/varbit.h.html#LN41"><span class='Ref_to_Macro'>PG_GETARG_VARBIT_P</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1788"></a>    <a href="../../../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>       <span class='Declare_Local'>n</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN233"><span class='Ref_to_Macro'>PG_GETARG_INT32</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1789"></a>    <a href="../../../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>       <span class='Declare_Local'>newBit</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN233"><span class='Ref_to_Macro'>PG_GETARG_INT32</span></a><span class='Parentheses'>(</span><span class='Number'>2</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1790"></a>    <a href="../../../include/utils/varbit.h.html#LN24"><span class='Ref_to_Typedef'>VarBit</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span><a name="LN1791"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>len</span><span class='Delimiter'>, 
</span><a name="LN1792"></a>                <span class='Declare_Local'>bitlen</span><span class='Delimiter'>; 
</span><a name="LN1793"></a>    <a href="../../../include/c.h.html#LN274"><span class='Ref_to_Typedef'>bits8</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>r</span><span class='Delimiter'>, 
</span><a name="LN1794"></a>               <span class='Operator'>*</span><span class='Declare_Local'>p</span><span class='Delimiter'>; 
</span><a name="LN1795"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>byteNo</span><span class='Delimiter'>, 
</span><a name="LN1796"></a>                <span class='Declare_Local'>bitNo</span><span class='Delimiter'>; 
</span> 
    <a href="varbit.c.html#LN1792"><span class='Ref_To_Local'>bitlen</span></a> <span class='Operator'>= </span><a href="../../../include/utils/varbit.h.html#LN48"><span class='Ref_to_Macro'>VARBITLEN</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1787"><span class='Ref_To_Local'>arg1</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="varbit.c.html#LN1788"><span class='Ref_To_Local'>n</span></a> <span class='Operator'>&LT; </span><span class='Number'>0</span> <span class='Operator'>|| </span><a href="varbit.c.html#LN1788"><span class='Ref_To_Local'>n</span></a> <span class='Operator'>&GT;= </span><a href="varbit.c.html#LN1792"><span class='Ref_To_Local'>bitlen</span></a><span class='Parentheses'>) 
</span>        <a href="../../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_ARRAY_SUBSCRIPT_ERROR<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"bit index %d out of valid range (0..%d)"</span><span class='Delimiter'>, 
</span>                        <a href="varbit.c.html#LN1788"><span class='Ref_To_Local'>n</span></a><span class='Delimiter'>, </span><a href="varbit.c.html#LN1792"><span class='Ref_To_Local'>bitlen</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * sanity check! 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="varbit.c.html#LN1789"><span class='Ref_To_Local'>newBit</span></a> <span class='Operator'>!= </span><span class='Number'>0</span> <span class='Operator'>&& </span><a href="varbit.c.html#LN1789"><span class='Ref_To_Local'>newBit</span></a> <span class='Operator'>!= </span><span class='Number'>1</span><span class='Parentheses'>) 
</span>        <a href="../../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_INVALID_PARAMETER_VALUE<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"new bit must be 0 or 1"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
    <a href="varbit.c.html#LN1791"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>= </span><a href="../../../include/postgres.h.html#LN303"><span class='Ref_to_Macro'>VARSIZE</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1787"><span class='Ref_To_Local'>arg1</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="varbit.c.html#LN1790"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/utils/varbit.h.html#LN24"><span class='Ref_to_Typedef'>VarBit</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../../include/common/fe_memutils.h.html#LN33"><span class='Ref_to_Proto'>palloc</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1791"><span class='Ref_To_Local'>len</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../../include/postgres.h.html#LN327"><span class='Ref_to_Macro'>SET_VARSIZE</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1790"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>, </span><a href="varbit.c.html#LN1791"><span class='Ref_To_Local'>len</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../../include/utils/varbit.h.html#LN48"><span class='Ref_to_Macro'>VARBITLEN</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1790"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>) </span><span class='Operator'>= </span><a href="varbit.c.html#LN1792"><span class='Ref_To_Local'>bitlen</span></a><span class='Delimiter'>; 
</span> 
    <a href="varbit.c.html#LN1794"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>= </span><a href="../../../include/utils/varbit.h.html#LN50"><span class='Ref_to_Macro'>VARBITS</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1787"><span class='Ref_To_Local'>arg1</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="varbit.c.html#LN1793"><span class='Ref_To_Local'>r</span></a> <span class='Operator'>= </span><a href="../../../include/utils/varbit.h.html#LN50"><span class='Ref_to_Macro'>VARBITS</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1790"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    memcpy<span class='Parentheses'>(</span><a href="varbit.c.html#LN1793"><span class='Ref_To_Local'>r</span></a><span class='Delimiter'>, </span><a href="varbit.c.html#LN1794"><span class='Ref_To_Local'>p</span></a><span class='Delimiter'>, </span><a href="../../../include/utils/varbit.h.html#LN52"><span class='Ref_to_Macro'>VARBITBYTES</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1787"><span class='Ref_To_Local'>arg1</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <a href="varbit.c.html#LN1795"><span class='Ref_To_Local'>byteNo</span></a> <span class='Operator'>= </span><a href="varbit.c.html#LN1788"><span class='Ref_To_Local'>n</span></a> <span class='Operator'>/ </span><a href="../../../include/pg_config_manual.h.html#LN105"><span class='Ref_to_Const'>BITS_PER_BYTE</span></a><span class='Delimiter'>; 
</span>    <a href="varbit.c.html#LN1796"><span class='Ref_To_Local'>bitNo</span></a> <span class='Operator'>= </span><a href="../../../include/pg_config_manual.h.html#LN105"><span class='Ref_to_Const'>BITS_PER_BYTE</span></a> <span class='Operator'>- </span><span class='Number'>1</span> <span class='Operator'>- </span><span class='Parentheses'>(</span><a href="varbit.c.html#LN1788"><span class='Ref_To_Local'>n</span></a> <span class='Operator'>% </span><a href="../../../include/pg_config_manual.h.html#LN105"><span class='Ref_to_Const'>BITS_PER_BYTE</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Update the byte. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="varbit.c.html#LN1789"><span class='Ref_To_Local'>newBit</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>        <a href="varbit.c.html#LN1793"><span class='Ref_To_Local'>r</span></a><span class='Delimiter'>[</span><a href="varbit.c.html#LN1795"><span class='Ref_To_Local'>byteNo</span></a><span class='Delimiter'>] </span><span class='Operator'>&= </span><span class='Parentheses'>(</span><span class='Operator'>~</span><span class='Parentheses'>(</span><span class='Number'>1</span> <span class='Operator'>&LT;&LT; </span><a href="varbit.c.html#LN1796"><span class='Ref_To_Local'>bitNo</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
        <a href="varbit.c.html#LN1793"><span class='Ref_To_Local'>r</span></a><span class='Delimiter'>[</span><a href="varbit.c.html#LN1795"><span class='Ref_To_Local'>byteNo</span></a><span class='Delimiter'>] </span><span class='Operator'>|= </span><span class='Parentheses'>(</span><span class='Number'>1</span> <span class='Operator'>&LT;&LT; </span><a href="varbit.c.html#LN1796"><span class='Ref_To_Local'>bitNo</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/utils/varbit.h.html#LN43"><span class='Ref_to_Macro'>PG_RETURN_VARBIT_P</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1790"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end bitsetbit &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * bitgetbit 
 * 
 * returns the value of the Nth bit of a bit array (0 or 1). 
 * 
 * The bit location is specified left-to-right in a zero-based fashion 
 * consistent with the other get_bit and set_bit functions, but 
 * inconsistent with the standard substring, position, overlay functions 
 */ 
</span><a href="../../../include/postgres.h.html#LN371"><span class='Ref_to_Typedef'>Datum</span></a> 
<a name="LN1847"></a><span class='Declare_Function'>bitgetbit</span><span class='Parentheses'>(</span><a href="../../../include/fmgr.h.html#LN157"><span class='Ref_to_Const'>PG_FUNCTION_ARGS</span></a><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1849"></a>    <a href="../../../include/utils/varbit.h.html#LN24"><span class='Ref_to_Typedef'>VarBit</span></a>     <span class='Operator'>*</span><span class='Declare_Local'>arg1</span> <span class='Operator'>= </span><a href="../../../include/utils/varbit.h.html#LN41"><span class='Ref_to_Macro'>PG_GETARG_VARBIT_P</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1850"></a>    <a href="../../../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>       <span class='Declare_Local'>n</span> <span class='Operator'>= </span><a href="../../../include/fmgr.h.html#LN233"><span class='Ref_to_Macro'>PG_GETARG_INT32</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1851"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>bitlen</span><span class='Delimiter'>; 
</span><a name="LN1852"></a>    <a href="../../../include/c.h.html#LN274"><span class='Ref_to_Typedef'>bits8</span></a>      <span class='Operator'>*</span><span class='Declare_Local'>p</span><span class='Delimiter'>; 
</span><a name="LN1853"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>byteNo</span><span class='Delimiter'>, 
</span><a name="LN1854"></a>                <span class='Declare_Local'>bitNo</span><span class='Delimiter'>; 
</span> 
    <a href="varbit.c.html#LN1851"><span class='Ref_To_Local'>bitlen</span></a> <span class='Operator'>= </span><a href="../../../include/utils/varbit.h.html#LN48"><span class='Ref_to_Macro'>VARBITLEN</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1849"><span class='Ref_To_Local'>arg1</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="varbit.c.html#LN1850"><span class='Ref_To_Local'>n</span></a> <span class='Operator'>&LT; </span><span class='Number'>0</span> <span class='Operator'>|| </span><a href="varbit.c.html#LN1850"><span class='Ref_To_Local'>n</span></a> <span class='Operator'>&GT;= </span><a href="varbit.c.html#LN1851"><span class='Ref_To_Local'>bitlen</span></a><span class='Parentheses'>) 
</span>        <a href="../../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                <span class='Parentheses'>(</span><a href="../../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_ARRAY_SUBSCRIPT_ERROR<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <a href="../error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"bit index %d out of valid range (0..%d)"</span><span class='Delimiter'>, 
</span>                        <a href="varbit.c.html#LN1850"><span class='Ref_To_Local'>n</span></a><span class='Delimiter'>, </span><a href="varbit.c.html#LN1851"><span class='Ref_To_Local'>bitlen</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
    <a href="varbit.c.html#LN1852"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>= </span><a href="../../../include/utils/varbit.h.html#LN50"><span class='Ref_to_Macro'>VARBITS</span></a><span class='Parentheses'>(</span><a href="varbit.c.html#LN1849"><span class='Ref_To_Local'>arg1</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="varbit.c.html#LN1853"><span class='Ref_To_Local'>byteNo</span></a> <span class='Operator'>= </span><a href="varbit.c.html#LN1850"><span class='Ref_To_Local'>n</span></a> <span class='Operator'>/ </span><a href="../../../include/pg_config_manual.h.html#LN105"><span class='Ref_to_Const'>BITS_PER_BYTE</span></a><span class='Delimiter'>; 
</span>    <a href="varbit.c.html#LN1854"><span class='Ref_To_Local'>bitNo</span></a> <span class='Operator'>= </span><a href="../../../include/pg_config_manual.h.html#LN105"><span class='Ref_to_Const'>BITS_PER_BYTE</span></a> <span class='Operator'>- </span><span class='Number'>1</span> <span class='Operator'>- </span><span class='Parentheses'>(</span><a href="varbit.c.html#LN1850"><span class='Ref_To_Local'>n</span></a> <span class='Operator'>% </span><a href="../../../include/pg_config_manual.h.html#LN105"><span class='Ref_to_Const'>BITS_PER_BYTE</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="varbit.c.html#LN1852"><span class='Ref_To_Local'>p</span></a><span class='Delimiter'>[</span><a href="varbit.c.html#LN1853"><span class='Ref_To_Local'>byteNo</span></a><span class='Delimiter'>] </span><span class='Operator'>& </span><span class='Parentheses'>(</span><span class='Number'>1</span> <span class='Operator'>&LT;&LT; </span><a href="varbit.c.html#LN1854"><span class='Ref_To_Local'>bitNo</span></a><span class='Parentheses'>))</span> 
        <a href="../../../include/fmgr.h.html#LN313"><span class='Ref_to_Macro'>PG_RETURN_INT32</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
        <a href="../../../include/fmgr.h.html#LN313"><span class='Ref_to_Macro'>PG_RETURN_INT32</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end bitgetbit &raquo; </span> 
</pre>
<table bgcolor='#c0c0c0' width='100%'><tr><td><a href='../../../../Contents.html'>Contents</a></td></tr>
</table><hr><p class='blurb' align='center'><a href='http://www.sourceinsight.com'>HTML Created by Source Insight Version 4.00.0084 Built on 2017-02-26</a></p>
</body></html>