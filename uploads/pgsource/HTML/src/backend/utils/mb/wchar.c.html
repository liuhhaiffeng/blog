<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta name="generator" content="Source Insight Version 4.00.0084 Built on 2017-02-26">
<meta charset='UTF-8' />
<style type='text/css'><!--
TD {background-color: #C0C0C0; font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 70%; }
.blurb {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 70%; }
.filename {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 120%; font-weight: bold; }
.dirname {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 100%; font-weight: bold; margin-top: 2.5em;}
--></style>
<title>src\backend\utils\mb\wchar.c</title>
<LINK REL=StyleSheet HREF="../../../../C_Cpp_Source_File.css" TYPE='text/css' MEDIA=screen>
</head>
<body bgcolor=#ffffff>
<table bgcolor='#c0c0c0' width='100%'>
<tr><td><p class='filename'><b>src\backend\utils\mb\wchar.c</b></p></td>
<td align='right'>
Wed Jun 14 08:25:57 2017
</td></tr>
<tr><td><a href='../../../../Contents.html'>Contents</a></td></tr>
</table>
<pre>
<span class='Comment_Multi_Line'>/* 
 * conversion functions between pg_wchar and multibyte streams. 
 * Tatsuo Ishii 
 * src/backend/utils/mb/wchar.c 
 * 
 */ 
/* can be used in either frontend or backend */ 
</span><span class='Directive'>#ifdef</span> <a href="../../../bin/pg_waldump/rmgrdesc.c.html#LN7"><span class='Ref_to_Const'>FRONTEND</span></a> 
<span class='Keyword'>#include </span><span class='String'>"postgres_fe.h"</span> 
<span class='Directive'>#else</span> 
<span class='Keyword'>#include </span><span class='String'>"postgres.h"</span> 
<span class='Directive'>#endif</span> 
 
<span class='Keyword'>#include </span><span class='String'>"mb/pg_wchar.h"</span> 
 
 
<span class='Comment_Multi_Line'>/* 
 * conversion to pg_wchar is done by "table driven." 
 * to add an encoding support, define mb2wchar_with_len(), mblen(), dsplen() 
 * for the particular encoding. Note that if the encoding is only 
 * supported in the client, you don't need to define 
 * mb2wchar_with_len() function (SJIS is the case). 
 * 
 * These functions generally assume that their input is validly formed. 
 * The "verifier" functions, further down in the file, have to be more 
 * paranoid.  We expect that mblen() does not need to examine more than 
 * the first byte of the character to discover the correct length. 
 * 
 * Note: for the display output of psql to work properly, the return values 
 * of the dsplen functions must conform to the Unicode standard. In particular 
 * the NUL character is zero width and control characters are generally 
 * width -1. It is recommended that non-ASCII encodings refer their ASCII 
 * subset to the ASCII routines to ensure consistency. 
 */ 
</span> 
<span class='Comment_Multi_Line'>/* 
 * SQL/ASCII 
 */ 
</span><span class='Keyword'>static int 
</span><a name="LN39"></a><span class='Declare_Function'>pg_ascii2wchar_with_len</span><span class='Parentheses'>(</span><span class='Keyword'>const unsigned char </span><span class='Operator'>*</span><span class='Declare_Parameter'>from</span><span class='Delimiter'>, </span><a href="../../../include/mb/pg_wchar.h.html#LN24"><span class='Ref_to_Typedef'>pg_wchar</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>to</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>len</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN41"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>cnt</span> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>while</span> <span class='Parentheses'>(</span><a href="wchar.c.html#LN39"><span class='Ref_to_Parameter'>len</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span> <span class='Operator'>&& *</span><a href="wchar.c.html#LN39"><span class='Ref_to_Parameter'>from</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Operator'>*</span><a href="wchar.c.html#LN39"><span class='Ref_to_Parameter'>to</span></a><span class='Operator'>++ = *</span><a href="wchar.c.html#LN39"><span class='Ref_to_Parameter'>from</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>        <a href="wchar.c.html#LN39"><span class='Ref_to_Parameter'>len</span></a><span class='Operator'>--</span><span class='Delimiter'>; 
</span>        <a href="wchar.c.html#LN41"><span class='Ref_To_Local'>cnt</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Operator'>*</span><a href="wchar.c.html#LN39"><span class='Ref_to_Parameter'>to</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <a href="wchar.c.html#LN41"><span class='Ref_To_Local'>cnt</span></a><span class='Delimiter'>; 
} 
</span> 
<span class='Keyword'>static int 
</span><a name="LN54"></a><span class='Declare_Function'>pg_ascii_mblen</span><span class='Parentheses'>(</span><span class='Keyword'>const unsigned char </span><span class='Operator'>*</span><span class='Declare_Parameter'>s</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>return</span> <span class='Number'>1</span><span class='Delimiter'>; 
} 
</span> 
<span class='Keyword'>static int 
</span><a name="LN60"></a><span class='Declare_Function'>pg_ascii_dsplen</span><span class='Parentheses'>(</span><span class='Keyword'>const unsigned char </span><span class='Operator'>*</span><span class='Declare_Parameter'>s</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="wchar.c.html#LN60"><span class='Ref_to_Parameter'>s</span></a> <span class='Operator'>== </span><span class='String'>'\0'</span><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <span class='Number'>0</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="wchar.c.html#LN60"><span class='Ref_to_Parameter'>s</span></a> <span class='Operator'>&LT; </span><span class='Number'>0x20</span> <span class='Operator'>|| *</span><a href="wchar.c.html#LN60"><span class='Ref_to_Parameter'>s</span></a> <span class='Operator'>== </span><span class='Number'>0x7f</span><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <span class='Number'>1</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * EUC 
 */ 
</span><span class='Keyword'>static int 
</span><a name="LN74"></a><span class='Declare_Function'>pg_euc2wchar_with_len</span><span class='Parentheses'>(</span><span class='Keyword'>const unsigned char </span><span class='Operator'>*</span><span class='Declare_Parameter'>from</span><span class='Delimiter'>, </span><a href="../../../include/mb/pg_wchar.h.html#LN24"><span class='Ref_to_Typedef'>pg_wchar</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>to</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>len</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN76"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>cnt</span> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>while</span> <span class='Parentheses'>(</span><a href="wchar.c.html#LN74"><span class='Ref_to_Parameter'>len</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span> <span class='Operator'>&& *</span><a href="wchar.c.html#LN74"><span class='Ref_to_Parameter'>from</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="wchar.c.html#LN74"><span class='Ref_to_Parameter'>from</span></a> <span class='Operator'>== </span><a href="../../../include/mb/pg_wchar.h.html#LN34"><span class='Ref_to_Const'>SS2</span></a> <span class='Operator'>&& </span><a href="wchar.c.html#LN74"><span class='Ref_to_Parameter'>len</span></a> <span class='Operator'>&GT;= </span><span class='Number'>2</span><span class='Parentheses'>)</span>   <span class='Comment_Multi_Line'>/* JIS X 0201 (so called "1 byte 
                                         * KANA") */ 
</span>        <span class='Delimiter'>{ 
</span>            <a href="wchar.c.html#LN74"><span class='Ref_to_Parameter'>from</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>            <span class='Operator'>*</span><a href="wchar.c.html#LN74"><span class='Ref_to_Parameter'>to</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/mb/pg_wchar.h.html#LN34"><span class='Ref_to_Const'>SS2</span></a> <span class='Operator'>&LT;&LT; </span><span class='Number'>8</span><span class='Parentheses'>) </span><span class='Operator'>| *</span><a href="wchar.c.html#LN74"><span class='Ref_to_Parameter'>from</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>            <a href="wchar.c.html#LN74"><span class='Ref_to_Parameter'>len</span></a> <span class='Operator'>-= </span><span class='Number'>2</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="wchar.c.html#LN74"><span class='Ref_to_Parameter'>from</span></a> <span class='Operator'>== </span><a href="../../../include/mb/pg_wchar.h.html#LN35"><span class='Ref_to_Const'>SS3</span></a> <span class='Operator'>&& </span><a href="wchar.c.html#LN74"><span class='Ref_to_Parameter'>len</span></a> <span class='Operator'>&GT;= </span><span class='Number'>3</span><span class='Parentheses'>)</span>      <span class='Comment_Single_Line'>/* JIS X 0212 KANJI */ 
</span>        <span class='Delimiter'>{ 
</span>            <a href="wchar.c.html#LN74"><span class='Ref_to_Parameter'>from</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>            <span class='Operator'>*</span><a href="wchar.c.html#LN74"><span class='Ref_to_Parameter'>to</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/mb/pg_wchar.h.html#LN35"><span class='Ref_to_Const'>SS3</span></a> <span class='Operator'>&LT;&LT; </span><span class='Number'>16</span><span class='Parentheses'>) </span><span class='Operator'>| </span><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="wchar.c.html#LN74"><span class='Ref_to_Parameter'>from</span></a><span class='Operator'>++ &LT;&LT; </span><span class='Number'>8</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Operator'>*</span><a href="wchar.c.html#LN74"><span class='Ref_to_Parameter'>to</span></a> <span class='Operator'>|= *</span><a href="wchar.c.html#LN74"><span class='Ref_to_Parameter'>from</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>            <a href="wchar.c.html#LN74"><span class='Ref_to_Parameter'>len</span></a> <span class='Operator'>-= </span><span class='Number'>3</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/c.h.html#LN972"><span class='Ref_to_Macro'>IS_HIGHBIT_SET</span></a><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="wchar.c.html#LN74"><span class='Ref_to_Parameter'>from</span></a><span class='Parentheses'>) </span><span class='Operator'>&& </span><a href="wchar.c.html#LN74"><span class='Ref_to_Parameter'>len</span></a> <span class='Operator'>&GT;= </span><span class='Number'>2</span><span class='Parentheses'>)</span>     <span class='Comment_Single_Line'>/* JIS X 0208 KANJI */ 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Operator'>*</span><a href="wchar.c.html#LN74"><span class='Ref_to_Parameter'>to</span></a> <span class='Operator'>= *</span><a href="wchar.c.html#LN74"><span class='Ref_to_Parameter'>from</span></a><span class='Operator'>++ &LT;&LT; </span><span class='Number'>8</span><span class='Delimiter'>; 
</span>            <span class='Operator'>*</span><a href="wchar.c.html#LN74"><span class='Ref_to_Parameter'>to</span></a> <span class='Operator'>|= *</span><a href="wchar.c.html#LN74"><span class='Ref_to_Parameter'>from</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>            <a href="wchar.c.html#LN74"><span class='Ref_to_Parameter'>len</span></a> <span class='Operator'>-= </span><span class='Number'>2</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span>    <span class='Comment_Single_Line'>/* must be ASCII */ 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Operator'>*</span><a href="wchar.c.html#LN74"><span class='Ref_to_Parameter'>to</span></a> <span class='Operator'>= *</span><a href="wchar.c.html#LN74"><span class='Ref_to_Parameter'>from</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>            <a href="wchar.c.html#LN74"><span class='Ref_to_Parameter'>len</span></a><span class='Operator'>--</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <a href="wchar.c.html#LN74"><span class='Ref_to_Parameter'>to</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>        <a href="wchar.c.html#LN76"><span class='Ref_To_Local'>cnt</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end while len&GT;0&&*from &raquo; </span> 
    <span class='Operator'>*</span><a href="wchar.c.html#LN74"><span class='Ref_to_Parameter'>to</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <a href="wchar.c.html#LN76"><span class='Ref_To_Local'>cnt</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end pg_euc2wchar_with_len &raquo; </span> 
 
<span class='Keyword'>static inline int 
</span><a name="LN113"></a><span class='Declare_Function'>pg_euc_mblen</span><span class='Parentheses'>(</span><span class='Keyword'>const unsigned char </span><span class='Operator'>*</span><span class='Declare_Parameter'>s</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN115"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>len</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="wchar.c.html#LN113"><span class='Ref_to_Parameter'>s</span></a> <span class='Operator'>== </span><a href="../../../include/mb/pg_wchar.h.html#LN34"><span class='Ref_to_Const'>SS2</span></a><span class='Parentheses'>) 
</span>        <a href="wchar.c.html#LN115"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>= </span><span class='Number'>2</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="wchar.c.html#LN113"><span class='Ref_to_Parameter'>s</span></a> <span class='Operator'>== </span><a href="../../../include/mb/pg_wchar.h.html#LN35"><span class='Ref_to_Const'>SS3</span></a><span class='Parentheses'>) 
</span>        <a href="wchar.c.html#LN115"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>= </span><span class='Number'>3</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/c.h.html#LN972"><span class='Ref_to_Macro'>IS_HIGHBIT_SET</span></a><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="wchar.c.html#LN113"><span class='Ref_to_Parameter'>s</span></a><span class='Parentheses'>))</span> 
        <a href="wchar.c.html#LN115"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>= </span><span class='Number'>2</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
        <a href="wchar.c.html#LN115"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <a href="wchar.c.html#LN115"><span class='Ref_To_Local'>len</span></a><span class='Delimiter'>; 
} 
</span> 
<span class='Keyword'>static inline int 
</span><a name="LN129"></a><span class='Declare_Function'>pg_euc_dsplen</span><span class='Parentheses'>(</span><span class='Keyword'>const unsigned char </span><span class='Operator'>*</span><span class='Declare_Parameter'>s</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN131"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>len</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="wchar.c.html#LN129"><span class='Ref_to_Parameter'>s</span></a> <span class='Operator'>== </span><a href="../../../include/mb/pg_wchar.h.html#LN34"><span class='Ref_to_Const'>SS2</span></a><span class='Parentheses'>) 
</span>        <a href="wchar.c.html#LN131"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>= </span><span class='Number'>2</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="wchar.c.html#LN129"><span class='Ref_to_Parameter'>s</span></a> <span class='Operator'>== </span><a href="../../../include/mb/pg_wchar.h.html#LN35"><span class='Ref_to_Const'>SS3</span></a><span class='Parentheses'>) 
</span>        <a href="wchar.c.html#LN131"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>= </span><span class='Number'>2</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/c.h.html#LN972"><span class='Ref_to_Macro'>IS_HIGHBIT_SET</span></a><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="wchar.c.html#LN129"><span class='Ref_to_Parameter'>s</span></a><span class='Parentheses'>))</span> 
        <a href="wchar.c.html#LN131"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>= </span><span class='Number'>2</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
        <a href="wchar.c.html#LN131"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>= </span><a href="wchar.c.html#LN59"><span class='Ref_to_Func'>pg_ascii_dsplen</span></a><span class='Parentheses'>(</span><a href="wchar.c.html#LN129"><span class='Ref_to_Parameter'>s</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <a href="wchar.c.html#LN131"><span class='Ref_To_Local'>len</span></a><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * EUC_JP 
 */ 
</span><span class='Keyword'>static int 
</span><a name="LN148"></a><span class='Declare_Function'>pg_eucjp2wchar_with_len</span><span class='Parentheses'>(</span><span class='Keyword'>const unsigned char </span><span class='Operator'>*</span><span class='Declare_Parameter'>from</span><span class='Delimiter'>, </span><a href="../../../include/mb/pg_wchar.h.html#LN24"><span class='Ref_to_Typedef'>pg_wchar</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>to</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>len</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>return</span> <a href="wchar.c.html#LN73"><span class='Ref_to_Func'>pg_euc2wchar_with_len</span></a><span class='Parentheses'>(</span><a href="wchar.c.html#LN148"><span class='Ref_to_Parameter'>from</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN148"><span class='Ref_to_Parameter'>to</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN148"><span class='Ref_to_Parameter'>len</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Keyword'>static int 
</span><a name="LN154"></a><span class='Declare_Function'>pg_eucjp_mblen</span><span class='Parentheses'>(</span><span class='Keyword'>const unsigned char </span><span class='Operator'>*</span><span class='Declare_Parameter'>s</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>return</span> <a href="wchar.c.html#LN112"><span class='Ref_to_Func'>pg_euc_mblen</span></a><span class='Parentheses'>(</span><a href="wchar.c.html#LN154"><span class='Ref_to_Parameter'>s</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Keyword'>static int 
</span><a name="LN160"></a><span class='Declare_Function'>pg_eucjp_dsplen</span><span class='Parentheses'>(</span><span class='Keyword'>const unsigned char </span><span class='Operator'>*</span><span class='Declare_Parameter'>s</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN162"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>len</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="wchar.c.html#LN160"><span class='Ref_to_Parameter'>s</span></a> <span class='Operator'>== </span><a href="../../../include/mb/pg_wchar.h.html#LN34"><span class='Ref_to_Const'>SS2</span></a><span class='Parentheses'>) 
</span>        <a href="wchar.c.html#LN162"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="wchar.c.html#LN160"><span class='Ref_to_Parameter'>s</span></a> <span class='Operator'>== </span><a href="../../../include/mb/pg_wchar.h.html#LN35"><span class='Ref_to_Const'>SS3</span></a><span class='Parentheses'>) 
</span>        <a href="wchar.c.html#LN162"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>= </span><span class='Number'>2</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/c.h.html#LN972"><span class='Ref_to_Macro'>IS_HIGHBIT_SET</span></a><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="wchar.c.html#LN160"><span class='Ref_to_Parameter'>s</span></a><span class='Parentheses'>))</span> 
        <a href="wchar.c.html#LN162"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>= </span><span class='Number'>2</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
        <a href="wchar.c.html#LN162"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>= </span><a href="wchar.c.html#LN59"><span class='Ref_to_Func'>pg_ascii_dsplen</span></a><span class='Parentheses'>(</span><a href="wchar.c.html#LN160"><span class='Ref_to_Parameter'>s</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <a href="wchar.c.html#LN162"><span class='Ref_To_Local'>len</span></a><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * EUC_KR 
 */ 
</span><span class='Keyword'>static int 
</span><a name="LN179"></a><span class='Declare_Function'>pg_euckr2wchar_with_len</span><span class='Parentheses'>(</span><span class='Keyword'>const unsigned char </span><span class='Operator'>*</span><span class='Declare_Parameter'>from</span><span class='Delimiter'>, </span><a href="../../../include/mb/pg_wchar.h.html#LN24"><span class='Ref_to_Typedef'>pg_wchar</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>to</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>len</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>return</span> <a href="wchar.c.html#LN73"><span class='Ref_to_Func'>pg_euc2wchar_with_len</span></a><span class='Parentheses'>(</span><a href="wchar.c.html#LN179"><span class='Ref_to_Parameter'>from</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN179"><span class='Ref_to_Parameter'>to</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN179"><span class='Ref_to_Parameter'>len</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Keyword'>static int 
</span><a name="LN185"></a><span class='Declare_Function'>pg_euckr_mblen</span><span class='Parentheses'>(</span><span class='Keyword'>const unsigned char </span><span class='Operator'>*</span><span class='Declare_Parameter'>s</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>return</span> <a href="wchar.c.html#LN112"><span class='Ref_to_Func'>pg_euc_mblen</span></a><span class='Parentheses'>(</span><a href="wchar.c.html#LN185"><span class='Ref_to_Parameter'>s</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Keyword'>static int 
</span><a name="LN191"></a><span class='Declare_Function'>pg_euckr_dsplen</span><span class='Parentheses'>(</span><span class='Keyword'>const unsigned char </span><span class='Operator'>*</span><span class='Declare_Parameter'>s</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>return</span> <a href="wchar.c.html#LN128"><span class='Ref_to_Func'>pg_euc_dsplen</span></a><span class='Parentheses'>(</span><a href="wchar.c.html#LN191"><span class='Ref_to_Parameter'>s</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * EUC_CN 
 * 
 */ 
</span><span class='Keyword'>static int 
</span><a name="LN201"></a><span class='Declare_Function'>pg_euccn2wchar_with_len</span><span class='Parentheses'>(</span><span class='Keyword'>const unsigned char </span><span class='Operator'>*</span><span class='Declare_Parameter'>from</span><span class='Delimiter'>, </span><a href="../../../include/mb/pg_wchar.h.html#LN24"><span class='Ref_to_Typedef'>pg_wchar</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>to</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>len</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN203"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>cnt</span> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>while</span> <span class='Parentheses'>(</span><a href="wchar.c.html#LN201"><span class='Ref_to_Parameter'>len</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span> <span class='Operator'>&& *</span><a href="wchar.c.html#LN201"><span class='Ref_to_Parameter'>from</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="wchar.c.html#LN201"><span class='Ref_to_Parameter'>from</span></a> <span class='Operator'>== </span><a href="../../../include/mb/pg_wchar.h.html#LN34"><span class='Ref_to_Const'>SS2</span></a> <span class='Operator'>&& </span><a href="wchar.c.html#LN201"><span class='Ref_to_Parameter'>len</span></a> <span class='Operator'>&GT;= </span><span class='Number'>3</span><span class='Parentheses'>)</span>   <span class='Comment_Single_Line'>/* code set 2 (unused?) */ 
</span>        <span class='Delimiter'>{ 
</span>            <a href="wchar.c.html#LN201"><span class='Ref_to_Parameter'>from</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>            <span class='Operator'>*</span><a href="wchar.c.html#LN201"><span class='Ref_to_Parameter'>to</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/mb/pg_wchar.h.html#LN34"><span class='Ref_to_Const'>SS2</span></a> <span class='Operator'>&LT;&LT; </span><span class='Number'>16</span><span class='Parentheses'>) </span><span class='Operator'>| </span><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="wchar.c.html#LN201"><span class='Ref_to_Parameter'>from</span></a><span class='Operator'>++ &LT;&LT; </span><span class='Number'>8</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Operator'>*</span><a href="wchar.c.html#LN201"><span class='Ref_to_Parameter'>to</span></a> <span class='Operator'>|= *</span><a href="wchar.c.html#LN201"><span class='Ref_to_Parameter'>from</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>            <a href="wchar.c.html#LN201"><span class='Ref_to_Parameter'>len</span></a> <span class='Operator'>-= </span><span class='Number'>3</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="wchar.c.html#LN201"><span class='Ref_to_Parameter'>from</span></a> <span class='Operator'>== </span><a href="../../../include/mb/pg_wchar.h.html#LN35"><span class='Ref_to_Const'>SS3</span></a> <span class='Operator'>&& </span><a href="wchar.c.html#LN201"><span class='Ref_to_Parameter'>len</span></a> <span class='Operator'>&GT;= </span><span class='Number'>3</span><span class='Parentheses'>)</span>      <span class='Comment_Single_Line'>/* code set 3 (unused ?) */ 
</span>        <span class='Delimiter'>{ 
</span>            <a href="wchar.c.html#LN201"><span class='Ref_to_Parameter'>from</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>            <span class='Operator'>*</span><a href="wchar.c.html#LN201"><span class='Ref_to_Parameter'>to</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/mb/pg_wchar.h.html#LN35"><span class='Ref_to_Const'>SS3</span></a> <span class='Operator'>&LT;&LT; </span><span class='Number'>16</span><span class='Parentheses'>) </span><span class='Operator'>| </span><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="wchar.c.html#LN201"><span class='Ref_to_Parameter'>from</span></a><span class='Operator'>++ &LT;&LT; </span><span class='Number'>8</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Operator'>*</span><a href="wchar.c.html#LN201"><span class='Ref_to_Parameter'>to</span></a> <span class='Operator'>|= *</span><a href="wchar.c.html#LN201"><span class='Ref_to_Parameter'>from</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>            <a href="wchar.c.html#LN201"><span class='Ref_to_Parameter'>len</span></a> <span class='Operator'>-= </span><span class='Number'>3</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/c.h.html#LN972"><span class='Ref_to_Macro'>IS_HIGHBIT_SET</span></a><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="wchar.c.html#LN201"><span class='Ref_to_Parameter'>from</span></a><span class='Parentheses'>) </span><span class='Operator'>&& </span><a href="wchar.c.html#LN201"><span class='Ref_to_Parameter'>len</span></a> <span class='Operator'>&GT;= </span><span class='Number'>2</span><span class='Parentheses'>)</span>     <span class='Comment_Single_Line'>/* code set 1 */ 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Operator'>*</span><a href="wchar.c.html#LN201"><span class='Ref_to_Parameter'>to</span></a> <span class='Operator'>= *</span><a href="wchar.c.html#LN201"><span class='Ref_to_Parameter'>from</span></a><span class='Operator'>++ &LT;&LT; </span><span class='Number'>8</span><span class='Delimiter'>; 
</span>            <span class='Operator'>*</span><a href="wchar.c.html#LN201"><span class='Ref_to_Parameter'>to</span></a> <span class='Operator'>|= *</span><a href="wchar.c.html#LN201"><span class='Ref_to_Parameter'>from</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>            <a href="wchar.c.html#LN201"><span class='Ref_to_Parameter'>len</span></a> <span class='Operator'>-= </span><span class='Number'>2</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Operator'>*</span><a href="wchar.c.html#LN201"><span class='Ref_to_Parameter'>to</span></a> <span class='Operator'>= *</span><a href="wchar.c.html#LN201"><span class='Ref_to_Parameter'>from</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>            <a href="wchar.c.html#LN201"><span class='Ref_to_Parameter'>len</span></a><span class='Operator'>--</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <a href="wchar.c.html#LN201"><span class='Ref_to_Parameter'>to</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>        <a href="wchar.c.html#LN203"><span class='Ref_To_Local'>cnt</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end while len&GT;0&&*from &raquo; </span> 
    <span class='Operator'>*</span><a href="wchar.c.html#LN201"><span class='Ref_to_Parameter'>to</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <a href="wchar.c.html#LN203"><span class='Ref_To_Local'>cnt</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end pg_euccn2wchar_with_len &raquo; </span> 
 
<span class='Keyword'>static int 
</span><a name="LN240"></a><span class='Declare_Function'>pg_euccn_mblen</span><span class='Parentheses'>(</span><span class='Keyword'>const unsigned char </span><span class='Operator'>*</span><span class='Declare_Parameter'>s</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN242"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>len</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/c.h.html#LN972"><span class='Ref_to_Macro'>IS_HIGHBIT_SET</span></a><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="wchar.c.html#LN240"><span class='Ref_to_Parameter'>s</span></a><span class='Parentheses'>))</span> 
        <a href="wchar.c.html#LN242"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>= </span><span class='Number'>2</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
        <a href="wchar.c.html#LN242"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <a href="wchar.c.html#LN242"><span class='Ref_To_Local'>len</span></a><span class='Delimiter'>; 
} 
</span> 
<span class='Keyword'>static int 
</span><a name="LN252"></a><span class='Declare_Function'>pg_euccn_dsplen</span><span class='Parentheses'>(</span><span class='Keyword'>const unsigned char </span><span class='Operator'>*</span><span class='Declare_Parameter'>s</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN254"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>len</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/c.h.html#LN972"><span class='Ref_to_Macro'>IS_HIGHBIT_SET</span></a><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="wchar.c.html#LN252"><span class='Ref_to_Parameter'>s</span></a><span class='Parentheses'>))</span> 
        <a href="wchar.c.html#LN254"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>= </span><span class='Number'>2</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
        <a href="wchar.c.html#LN254"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>= </span><a href="wchar.c.html#LN59"><span class='Ref_to_Func'>pg_ascii_dsplen</span></a><span class='Parentheses'>(</span><a href="wchar.c.html#LN252"><span class='Ref_to_Parameter'>s</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <a href="wchar.c.html#LN254"><span class='Ref_To_Local'>len</span></a><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * EUC_TW 
 * 
 */ 
</span><span class='Keyword'>static int 
</span><a name="LN268"></a><span class='Declare_Function'>pg_euctw2wchar_with_len</span><span class='Parentheses'>(</span><span class='Keyword'>const unsigned char </span><span class='Operator'>*</span><span class='Declare_Parameter'>from</span><span class='Delimiter'>, </span><a href="../../../include/mb/pg_wchar.h.html#LN24"><span class='Ref_to_Typedef'>pg_wchar</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>to</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>len</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN270"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>cnt</span> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>while</span> <span class='Parentheses'>(</span><a href="wchar.c.html#LN268"><span class='Ref_to_Parameter'>len</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span> <span class='Operator'>&& *</span><a href="wchar.c.html#LN268"><span class='Ref_to_Parameter'>from</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="wchar.c.html#LN268"><span class='Ref_to_Parameter'>from</span></a> <span class='Operator'>== </span><a href="../../../include/mb/pg_wchar.h.html#LN34"><span class='Ref_to_Const'>SS2</span></a> <span class='Operator'>&& </span><a href="wchar.c.html#LN268"><span class='Ref_to_Parameter'>len</span></a> <span class='Operator'>&GT;= </span><span class='Number'>4</span><span class='Parentheses'>)</span>   <span class='Comment_Single_Line'>/* code set 2 */ 
</span>        <span class='Delimiter'>{ 
</span>            <a href="wchar.c.html#LN268"><span class='Ref_to_Parameter'>from</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>            <span class='Operator'>*</span><a href="wchar.c.html#LN268"><span class='Ref_to_Parameter'>to</span></a> <span class='Operator'>= </span><span class='Parentheses'>(((</span><a href="../../../include/c.h.html#LN267"><span class='Ref_to_Typedef'>uint32</span></a><span class='Parentheses'>) </span><a href="../../../include/mb/pg_wchar.h.html#LN34"><span class='Ref_to_Const'>SS2</span></a><span class='Parentheses'>)</span> <span class='Operator'>&LT;&LT; </span><span class='Number'>24</span><span class='Parentheses'>)</span> <span class='Operator'>| </span><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="wchar.c.html#LN268"><span class='Ref_to_Parameter'>from</span></a><span class='Operator'>++ &LT;&LT; </span><span class='Number'>16</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Operator'>*</span><a href="wchar.c.html#LN268"><span class='Ref_to_Parameter'>to</span></a> <span class='Operator'>|= *</span><a href="wchar.c.html#LN268"><span class='Ref_to_Parameter'>from</span></a><span class='Operator'>++ &LT;&LT; </span><span class='Number'>8</span><span class='Delimiter'>; 
</span>            <span class='Operator'>*</span><a href="wchar.c.html#LN268"><span class='Ref_to_Parameter'>to</span></a> <span class='Operator'>|= *</span><a href="wchar.c.html#LN268"><span class='Ref_to_Parameter'>from</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>            <a href="wchar.c.html#LN268"><span class='Ref_to_Parameter'>len</span></a> <span class='Operator'>-= </span><span class='Number'>4</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="wchar.c.html#LN268"><span class='Ref_to_Parameter'>from</span></a> <span class='Operator'>== </span><a href="../../../include/mb/pg_wchar.h.html#LN35"><span class='Ref_to_Const'>SS3</span></a> <span class='Operator'>&& </span><a href="wchar.c.html#LN268"><span class='Ref_to_Parameter'>len</span></a> <span class='Operator'>&GT;= </span><span class='Number'>3</span><span class='Parentheses'>)</span>      <span class='Comment_Single_Line'>/* code set 3 (unused?) */ 
</span>        <span class='Delimiter'>{ 
</span>            <a href="wchar.c.html#LN268"><span class='Ref_to_Parameter'>from</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>            <span class='Operator'>*</span><a href="wchar.c.html#LN268"><span class='Ref_to_Parameter'>to</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../../include/mb/pg_wchar.h.html#LN35"><span class='Ref_to_Const'>SS3</span></a> <span class='Operator'>&LT;&LT; </span><span class='Number'>16</span><span class='Parentheses'>) </span><span class='Operator'>| </span><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="wchar.c.html#LN268"><span class='Ref_to_Parameter'>from</span></a><span class='Operator'>++ &LT;&LT; </span><span class='Number'>8</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Operator'>*</span><a href="wchar.c.html#LN268"><span class='Ref_to_Parameter'>to</span></a> <span class='Operator'>|= *</span><a href="wchar.c.html#LN268"><span class='Ref_to_Parameter'>from</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>            <a href="wchar.c.html#LN268"><span class='Ref_to_Parameter'>len</span></a> <span class='Operator'>-= </span><span class='Number'>3</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/c.h.html#LN972"><span class='Ref_to_Macro'>IS_HIGHBIT_SET</span></a><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="wchar.c.html#LN268"><span class='Ref_to_Parameter'>from</span></a><span class='Parentheses'>) </span><span class='Operator'>&& </span><a href="wchar.c.html#LN268"><span class='Ref_to_Parameter'>len</span></a> <span class='Operator'>&GT;= </span><span class='Number'>2</span><span class='Parentheses'>)</span>     <span class='Comment_Single_Line'>/* code set 2 */ 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Operator'>*</span><a href="wchar.c.html#LN268"><span class='Ref_to_Parameter'>to</span></a> <span class='Operator'>= *</span><a href="wchar.c.html#LN268"><span class='Ref_to_Parameter'>from</span></a><span class='Operator'>++ &LT;&LT; </span><span class='Number'>8</span><span class='Delimiter'>; 
</span>            <span class='Operator'>*</span><a href="wchar.c.html#LN268"><span class='Ref_to_Parameter'>to</span></a> <span class='Operator'>|= *</span><a href="wchar.c.html#LN268"><span class='Ref_to_Parameter'>from</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>            <a href="wchar.c.html#LN268"><span class='Ref_to_Parameter'>len</span></a> <span class='Operator'>-= </span><span class='Number'>2</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Operator'>*</span><a href="wchar.c.html#LN268"><span class='Ref_to_Parameter'>to</span></a> <span class='Operator'>= *</span><a href="wchar.c.html#LN268"><span class='Ref_to_Parameter'>from</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>            <a href="wchar.c.html#LN268"><span class='Ref_to_Parameter'>len</span></a><span class='Operator'>--</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <a href="wchar.c.html#LN268"><span class='Ref_to_Parameter'>to</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>        <a href="wchar.c.html#LN270"><span class='Ref_To_Local'>cnt</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end while len&GT;0&&*from &raquo; </span> 
    <span class='Operator'>*</span><a href="wchar.c.html#LN268"><span class='Ref_to_Parameter'>to</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <a href="wchar.c.html#LN270"><span class='Ref_To_Local'>cnt</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end pg_euctw2wchar_with_len &raquo; </span> 
 
<span class='Keyword'>static int 
</span><a name="LN308"></a><span class='Declare_Function'>pg_euctw_mblen</span><span class='Parentheses'>(</span><span class='Keyword'>const unsigned char </span><span class='Operator'>*</span><span class='Declare_Parameter'>s</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN310"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>len</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="wchar.c.html#LN308"><span class='Ref_to_Parameter'>s</span></a> <span class='Operator'>== </span><a href="../../../include/mb/pg_wchar.h.html#LN34"><span class='Ref_to_Const'>SS2</span></a><span class='Parentheses'>) 
</span>        <a href="wchar.c.html#LN310"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>= </span><span class='Number'>4</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="wchar.c.html#LN308"><span class='Ref_to_Parameter'>s</span></a> <span class='Operator'>== </span><a href="../../../include/mb/pg_wchar.h.html#LN35"><span class='Ref_to_Const'>SS3</span></a><span class='Parentheses'>) 
</span>        <a href="wchar.c.html#LN310"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>= </span><span class='Number'>3</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/c.h.html#LN972"><span class='Ref_to_Macro'>IS_HIGHBIT_SET</span></a><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="wchar.c.html#LN308"><span class='Ref_to_Parameter'>s</span></a><span class='Parentheses'>))</span> 
        <a href="wchar.c.html#LN310"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>= </span><span class='Number'>2</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
        <a href="wchar.c.html#LN310"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <a href="wchar.c.html#LN310"><span class='Ref_To_Local'>len</span></a><span class='Delimiter'>; 
} 
</span> 
<span class='Keyword'>static int 
</span><a name="LN324"></a><span class='Declare_Function'>pg_euctw_dsplen</span><span class='Parentheses'>(</span><span class='Keyword'>const unsigned char </span><span class='Operator'>*</span><span class='Declare_Parameter'>s</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN326"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>len</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="wchar.c.html#LN324"><span class='Ref_to_Parameter'>s</span></a> <span class='Operator'>== </span><a href="../../../include/mb/pg_wchar.h.html#LN34"><span class='Ref_to_Const'>SS2</span></a><span class='Parentheses'>) 
</span>        <a href="wchar.c.html#LN326"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>= </span><span class='Number'>2</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="wchar.c.html#LN324"><span class='Ref_to_Parameter'>s</span></a> <span class='Operator'>== </span><a href="../../../include/mb/pg_wchar.h.html#LN35"><span class='Ref_to_Const'>SS3</span></a><span class='Parentheses'>) 
</span>        <a href="wchar.c.html#LN326"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>= </span><span class='Number'>2</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/c.h.html#LN972"><span class='Ref_to_Macro'>IS_HIGHBIT_SET</span></a><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="wchar.c.html#LN324"><span class='Ref_to_Parameter'>s</span></a><span class='Parentheses'>))</span> 
        <a href="wchar.c.html#LN326"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>= </span><span class='Number'>2</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
        <a href="wchar.c.html#LN326"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>= </span><a href="wchar.c.html#LN59"><span class='Ref_to_Func'>pg_ascii_dsplen</span></a><span class='Parentheses'>(</span><a href="wchar.c.html#LN324"><span class='Ref_to_Parameter'>s</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <a href="wchar.c.html#LN326"><span class='Ref_To_Local'>len</span></a><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * Convert pg_wchar to EUC_* encoding. 
 * caller must allocate enough space for "to", including a trailing zero! 
 * len: length of from. 
 * "from" not necessarily null terminated. 
 */ 
</span><span class='Keyword'>static int 
</span><a name="LN346"></a><span class='Declare_Function'>pg_wchar2euc_with_len</span><span class='Parentheses'>(</span><span class='Keyword'>const </span><a href="../../../include/mb/pg_wchar.h.html#LN24"><span class='Ref_to_Typedef'>pg_wchar</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>from</span><span class='Delimiter'>, </span><span class='Keyword'>unsigned char </span><span class='Operator'>*</span><span class='Declare_Parameter'>to</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>len</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN348"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>cnt</span> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>while</span> <span class='Parentheses'>(</span><a href="wchar.c.html#LN346"><span class='Ref_to_Parameter'>len</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span> <span class='Operator'>&& *</span><a href="wchar.c.html#LN346"><span class='Ref_to_Parameter'>from</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN352"></a>        <span class='Keyword'>unsigned char </span><span class='Declare_Local'>c</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="wchar.c.html#LN352"><span class='Ref_To_Local'>c</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="wchar.c.html#LN346"><span class='Ref_to_Parameter'>from</span></a> <span class='Operator'>&GT;&GT; </span><span class='Number'>24</span><span class='Parentheses'>)))</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Operator'>*</span><a href="wchar.c.html#LN346"><span class='Ref_to_Parameter'>to</span></a><span class='Operator'>++ = </span><a href="wchar.c.html#LN352"><span class='Ref_To_Local'>c</span></a><span class='Delimiter'>; 
</span>            <span class='Operator'>*</span><a href="wchar.c.html#LN346"><span class='Ref_to_Parameter'>to</span></a><span class='Operator'>++ = </span><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="wchar.c.html#LN346"><span class='Ref_to_Parameter'>from</span></a> <span class='Operator'>&GT;&GT; </span><span class='Number'>16</span><span class='Parentheses'>) </span><span class='Operator'>& </span><span class='Number'>0xff</span><span class='Delimiter'>; 
</span>            <span class='Operator'>*</span><a href="wchar.c.html#LN346"><span class='Ref_to_Parameter'>to</span></a><span class='Operator'>++ = </span><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="wchar.c.html#LN346"><span class='Ref_to_Parameter'>from</span></a> <span class='Operator'>&GT;&GT; </span><span class='Number'>8</span><span class='Parentheses'>) </span><span class='Operator'>& </span><span class='Number'>0xff</span><span class='Delimiter'>; 
</span>            <span class='Operator'>*</span><a href="wchar.c.html#LN346"><span class='Ref_to_Parameter'>to</span></a><span class='Operator'>++ = *</span><a href="wchar.c.html#LN346"><span class='Ref_to_Parameter'>from</span></a> <span class='Operator'>& </span><span class='Number'>0xff</span><span class='Delimiter'>; 
</span>            <a href="wchar.c.html#LN348"><span class='Ref_To_Local'>cnt</span></a> <span class='Operator'>+= </span><span class='Number'>4</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="wchar.c.html#LN352"><span class='Ref_To_Local'>c</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="wchar.c.html#LN346"><span class='Ref_to_Parameter'>from</span></a> <span class='Operator'>&GT;&GT; </span><span class='Number'>16</span><span class='Parentheses'>)))</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Operator'>*</span><a href="wchar.c.html#LN346"><span class='Ref_to_Parameter'>to</span></a><span class='Operator'>++ = </span><a href="wchar.c.html#LN352"><span class='Ref_To_Local'>c</span></a><span class='Delimiter'>; 
</span>            <span class='Operator'>*</span><a href="wchar.c.html#LN346"><span class='Ref_to_Parameter'>to</span></a><span class='Operator'>++ = </span><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="wchar.c.html#LN346"><span class='Ref_to_Parameter'>from</span></a> <span class='Operator'>&GT;&GT; </span><span class='Number'>8</span><span class='Parentheses'>) </span><span class='Operator'>& </span><span class='Number'>0xff</span><span class='Delimiter'>; 
</span>            <span class='Operator'>*</span><a href="wchar.c.html#LN346"><span class='Ref_to_Parameter'>to</span></a><span class='Operator'>++ = *</span><a href="wchar.c.html#LN346"><span class='Ref_to_Parameter'>from</span></a> <span class='Operator'>& </span><span class='Number'>0xff</span><span class='Delimiter'>; 
</span>            <a href="wchar.c.html#LN348"><span class='Ref_To_Local'>cnt</span></a> <span class='Operator'>+= </span><span class='Number'>3</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="wchar.c.html#LN352"><span class='Ref_To_Local'>c</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="wchar.c.html#LN346"><span class='Ref_to_Parameter'>from</span></a> <span class='Operator'>&GT;&GT; </span><span class='Number'>8</span><span class='Parentheses'>)))</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Operator'>*</span><a href="wchar.c.html#LN346"><span class='Ref_to_Parameter'>to</span></a><span class='Operator'>++ = </span><a href="wchar.c.html#LN352"><span class='Ref_To_Local'>c</span></a><span class='Delimiter'>; 
</span>            <span class='Operator'>*</span><a href="wchar.c.html#LN346"><span class='Ref_to_Parameter'>to</span></a><span class='Operator'>++ = *</span><a href="wchar.c.html#LN346"><span class='Ref_to_Parameter'>from</span></a> <span class='Operator'>& </span><span class='Number'>0xff</span><span class='Delimiter'>; 
</span>            <a href="wchar.c.html#LN348"><span class='Ref_To_Local'>cnt</span></a> <span class='Operator'>+= </span><span class='Number'>2</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Operator'>*</span><a href="wchar.c.html#LN346"><span class='Ref_to_Parameter'>to</span></a><span class='Operator'>++ = *</span><a href="wchar.c.html#LN346"><span class='Ref_to_Parameter'>from</span></a><span class='Delimiter'>; 
</span>            <a href="wchar.c.html#LN348"><span class='Ref_To_Local'>cnt</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <a href="wchar.c.html#LN346"><span class='Ref_to_Parameter'>from</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>        <a href="wchar.c.html#LN346"><span class='Ref_to_Parameter'>len</span></a><span class='Operator'>--</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end while len&GT;0&&*from &raquo; </span> 
    <span class='Operator'>*</span><a href="wchar.c.html#LN346"><span class='Ref_to_Parameter'>to</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <a href="wchar.c.html#LN348"><span class='Ref_To_Local'>cnt</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end pg_wchar2euc_with_len &raquo; </span> 
 
 
<span class='Comment_Multi_Line'>/* 
 * JOHAB 
 */ 
</span><span class='Keyword'>static int 
</span><a name="LN392"></a><span class='Declare_Function'>pg_johab_mblen</span><span class='Parentheses'>(</span><span class='Keyword'>const unsigned char </span><span class='Operator'>*</span><span class='Declare_Parameter'>s</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>return</span> <a href="wchar.c.html#LN112"><span class='Ref_to_Func'>pg_euc_mblen</span></a><span class='Parentheses'>(</span><a href="wchar.c.html#LN392"><span class='Ref_to_Parameter'>s</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Keyword'>static int 
</span><a name="LN398"></a><span class='Declare_Function'>pg_johab_dsplen</span><span class='Parentheses'>(</span><span class='Keyword'>const unsigned char </span><span class='Operator'>*</span><span class='Declare_Parameter'>s</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>return</span> <a href="wchar.c.html#LN128"><span class='Ref_to_Func'>pg_euc_dsplen</span></a><span class='Parentheses'>(</span><a href="wchar.c.html#LN398"><span class='Ref_to_Parameter'>s</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * convert UTF8 string to pg_wchar (UCS-4) 
 * caller must allocate enough space for "to", including a trailing zero! 
 * len: length of from. 
 * "from" not necessarily null terminated. 
 */ 
</span><span class='Keyword'>static int 
</span><a name="LN410"></a><span class='Declare_Function'>pg_utf2wchar_with_len</span><span class='Parentheses'>(</span><span class='Keyword'>const unsigned char </span><span class='Operator'>*</span><span class='Declare_Parameter'>from</span><span class='Delimiter'>, </span><a href="../../../include/mb/pg_wchar.h.html#LN24"><span class='Ref_to_Typedef'>pg_wchar</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>to</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>len</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN412"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>cnt</span> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span><a name="LN413"></a>    <a href="../../../include/c.h.html#LN267"><span class='Ref_to_Typedef'>uint32</span></a>      <span class='Declare_Local'>c1</span><span class='Delimiter'>, 
</span><a name="LN414"></a>                <span class='Declare_Local'>c2</span><span class='Delimiter'>, 
</span><a name="LN415"></a>                <span class='Declare_Local'>c3</span><span class='Delimiter'>, 
</span><a name="LN416"></a>                <span class='Declare_Local'>c4</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>while</span> <span class='Parentheses'>(</span><a href="wchar.c.html#LN410"><span class='Ref_to_Parameter'>len</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span> <span class='Operator'>&& *</span><a href="wchar.c.html#LN410"><span class='Ref_to_Parameter'>from</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>((</span><span class='Operator'>*</span><a href="wchar.c.html#LN410"><span class='Ref_to_Parameter'>from</span></a> <span class='Operator'>& </span><span class='Number'>0x80</span><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Operator'>*</span><a href="wchar.c.html#LN410"><span class='Ref_to_Parameter'>to</span></a> <span class='Operator'>= *</span><a href="wchar.c.html#LN410"><span class='Ref_to_Parameter'>from</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>            <a href="wchar.c.html#LN410"><span class='Ref_to_Parameter'>len</span></a><span class='Operator'>--</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>((</span><span class='Operator'>*</span><a href="wchar.c.html#LN410"><span class='Ref_to_Parameter'>from</span></a> <span class='Operator'>& </span><span class='Number'>0xe0</span><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0xc0</span><span class='Parentheses'>)</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="wchar.c.html#LN410"><span class='Ref_to_Parameter'>len</span></a> <span class='Operator'>&LT; </span><span class='Number'>2</span><span class='Parentheses'>) 
</span>                <span class='Control'>break</span><span class='Delimiter'>;</span>          <span class='Comment_Single_Line'>/* drop trailing incomplete char */ 
</span>            <a href="wchar.c.html#LN413"><span class='Ref_To_Local'>c1</span></a> <span class='Operator'>= *</span><a href="wchar.c.html#LN410"><span class='Ref_to_Parameter'>from</span></a><span class='Operator'>++ & </span><span class='Number'>0x1f</span><span class='Delimiter'>; 
</span>            <a href="wchar.c.html#LN414"><span class='Ref_To_Local'>c2</span></a> <span class='Operator'>= *</span><a href="wchar.c.html#LN410"><span class='Ref_to_Parameter'>from</span></a><span class='Operator'>++ & </span><span class='Number'>0x3f</span><span class='Delimiter'>; 
</span>            <span class='Operator'>*</span><a href="wchar.c.html#LN410"><span class='Ref_to_Parameter'>to</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="wchar.c.html#LN413"><span class='Ref_To_Local'>c1</span></a> <span class='Operator'>&LT;&LT; </span><span class='Number'>6</span><span class='Parentheses'>) </span><span class='Operator'>| </span><a href="wchar.c.html#LN414"><span class='Ref_To_Local'>c2</span></a><span class='Delimiter'>; 
</span>            <a href="wchar.c.html#LN410"><span class='Ref_to_Parameter'>len</span></a> <span class='Operator'>-= </span><span class='Number'>2</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>((</span><span class='Operator'>*</span><a href="wchar.c.html#LN410"><span class='Ref_to_Parameter'>from</span></a> <span class='Operator'>& </span><span class='Number'>0xf0</span><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0xe0</span><span class='Parentheses'>)</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="wchar.c.html#LN410"><span class='Ref_to_Parameter'>len</span></a> <span class='Operator'>&LT; </span><span class='Number'>3</span><span class='Parentheses'>) 
</span>                <span class='Control'>break</span><span class='Delimiter'>;</span>          <span class='Comment_Single_Line'>/* drop trailing incomplete char */ 
</span>            <a href="wchar.c.html#LN413"><span class='Ref_To_Local'>c1</span></a> <span class='Operator'>= *</span><a href="wchar.c.html#LN410"><span class='Ref_to_Parameter'>from</span></a><span class='Operator'>++ & </span><span class='Number'>0x0f</span><span class='Delimiter'>; 
</span>            <a href="wchar.c.html#LN414"><span class='Ref_To_Local'>c2</span></a> <span class='Operator'>= *</span><a href="wchar.c.html#LN410"><span class='Ref_to_Parameter'>from</span></a><span class='Operator'>++ & </span><span class='Number'>0x3f</span><span class='Delimiter'>; 
</span>            <a href="wchar.c.html#LN415"><span class='Ref_To_Local'>c3</span></a> <span class='Operator'>= *</span><a href="wchar.c.html#LN410"><span class='Ref_to_Parameter'>from</span></a><span class='Operator'>++ & </span><span class='Number'>0x3f</span><span class='Delimiter'>; 
</span>            <span class='Operator'>*</span><a href="wchar.c.html#LN410"><span class='Ref_to_Parameter'>to</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="wchar.c.html#LN413"><span class='Ref_To_Local'>c1</span></a> <span class='Operator'>&LT;&LT; </span><span class='Number'>12</span><span class='Parentheses'>) </span><span class='Operator'>| </span><span class='Parentheses'>(</span><a href="wchar.c.html#LN414"><span class='Ref_To_Local'>c2</span></a> <span class='Operator'>&LT;&LT; </span><span class='Number'>6</span><span class='Parentheses'>) </span><span class='Operator'>| </span><a href="wchar.c.html#LN415"><span class='Ref_To_Local'>c3</span></a><span class='Delimiter'>; 
</span>            <a href="wchar.c.html#LN410"><span class='Ref_to_Parameter'>len</span></a> <span class='Operator'>-= </span><span class='Number'>3</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>((</span><span class='Operator'>*</span><a href="wchar.c.html#LN410"><span class='Ref_to_Parameter'>from</span></a> <span class='Operator'>& </span><span class='Number'>0xf8</span><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0xf0</span><span class='Parentheses'>)</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="wchar.c.html#LN410"><span class='Ref_to_Parameter'>len</span></a> <span class='Operator'>&LT; </span><span class='Number'>4</span><span class='Parentheses'>) 
</span>                <span class='Control'>break</span><span class='Delimiter'>;</span>          <span class='Comment_Single_Line'>/* drop trailing incomplete char */ 
</span>            <a href="wchar.c.html#LN413"><span class='Ref_To_Local'>c1</span></a> <span class='Operator'>= *</span><a href="wchar.c.html#LN410"><span class='Ref_to_Parameter'>from</span></a><span class='Operator'>++ & </span><span class='Number'>0x07</span><span class='Delimiter'>; 
</span>            <a href="wchar.c.html#LN414"><span class='Ref_To_Local'>c2</span></a> <span class='Operator'>= *</span><a href="wchar.c.html#LN410"><span class='Ref_to_Parameter'>from</span></a><span class='Operator'>++ & </span><span class='Number'>0x3f</span><span class='Delimiter'>; 
</span>            <a href="wchar.c.html#LN415"><span class='Ref_To_Local'>c3</span></a> <span class='Operator'>= *</span><a href="wchar.c.html#LN410"><span class='Ref_to_Parameter'>from</span></a><span class='Operator'>++ & </span><span class='Number'>0x3f</span><span class='Delimiter'>; 
</span>            <a href="wchar.c.html#LN416"><span class='Ref_To_Local'>c4</span></a> <span class='Operator'>= *</span><a href="wchar.c.html#LN410"><span class='Ref_to_Parameter'>from</span></a><span class='Operator'>++ & </span><span class='Number'>0x3f</span><span class='Delimiter'>; 
</span>            <span class='Operator'>*</span><a href="wchar.c.html#LN410"><span class='Ref_to_Parameter'>to</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="wchar.c.html#LN413"><span class='Ref_To_Local'>c1</span></a> <span class='Operator'>&LT;&LT; </span><span class='Number'>18</span><span class='Parentheses'>) </span><span class='Operator'>| </span><span class='Parentheses'>(</span><a href="wchar.c.html#LN414"><span class='Ref_To_Local'>c2</span></a> <span class='Operator'>&LT;&LT; </span><span class='Number'>12</span><span class='Parentheses'>) </span><span class='Operator'>| </span><span class='Parentheses'>(</span><a href="wchar.c.html#LN415"><span class='Ref_To_Local'>c3</span></a> <span class='Operator'>&LT;&LT; </span><span class='Number'>6</span><span class='Parentheses'>) </span><span class='Operator'>| </span><a href="wchar.c.html#LN416"><span class='Ref_To_Local'>c4</span></a><span class='Delimiter'>; 
</span>            <a href="wchar.c.html#LN410"><span class='Ref_to_Parameter'>len</span></a> <span class='Operator'>-= </span><span class='Number'>4</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* treat a bogus char as length 1; not ours to raise error */ 
</span>            <span class='Operator'>*</span><a href="wchar.c.html#LN410"><span class='Ref_to_Parameter'>to</span></a> <span class='Operator'>= *</span><a href="wchar.c.html#LN410"><span class='Ref_to_Parameter'>from</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>            <a href="wchar.c.html#LN410"><span class='Ref_to_Parameter'>len</span></a><span class='Operator'>--</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <a href="wchar.c.html#LN410"><span class='Ref_to_Parameter'>to</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>        <a href="wchar.c.html#LN412"><span class='Ref_To_Local'>cnt</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end while len&GT;0&&*from &raquo; </span> 
    <span class='Operator'>*</span><a href="wchar.c.html#LN410"><span class='Ref_to_Parameter'>to</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <a href="wchar.c.html#LN412"><span class='Ref_To_Local'>cnt</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end pg_utf2wchar_with_len &raquo; </span> 
 
 
<span class='Comment_Multi_Line'>/* 
 * Map a Unicode code point to UTF-8.  utf8string must have 4 bytes of 
 * space allocated. 
 */ 
</span><span class='Keyword'>unsigned char </span><span class='Operator'>* 
</span><a name="LN474"></a><span class='Declare_Function'>unicode_to_utf8</span><span class='Parentheses'>(</span><a href="../../../include/mb/pg_wchar.h.html#LN24"><span class='Ref_to_Typedef'>pg_wchar</span></a> <span class='Declare_Parameter'>c</span><span class='Delimiter'>, </span><span class='Keyword'>unsigned char </span><span class='Operator'>*</span><span class='Declare_Parameter'>utf8string</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="wchar.c.html#LN474"><span class='Ref_to_Parameter'>c</span></a> <span class='Operator'>&LT;= </span><span class='Number'>0x7F</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="wchar.c.html#LN474"><span class='Ref_to_Parameter'>utf8string</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="wchar.c.html#LN474"><span class='Ref_to_Parameter'>c</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="wchar.c.html#LN474"><span class='Ref_to_Parameter'>c</span></a> <span class='Operator'>&LT;= </span><span class='Number'>0x7FF</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="wchar.c.html#LN474"><span class='Ref_to_Parameter'>utf8string</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Number'>0xC0</span> <span class='Operator'>| </span><span class='Parentheses'>((</span><a href="wchar.c.html#LN474"><span class='Ref_to_Parameter'>c</span></a> <span class='Operator'>&GT;&GT; </span><span class='Number'>6</span><span class='Parentheses'>) </span><span class='Operator'>& </span><span class='Number'>0x1F</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="wchar.c.html#LN474"><span class='Ref_to_Parameter'>utf8string</span></a><span class='Delimiter'>[</span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Number'>0x80</span> <span class='Operator'>| </span><span class='Parentheses'>(</span><a href="wchar.c.html#LN474"><span class='Ref_to_Parameter'>c</span></a> <span class='Operator'>& </span><span class='Number'>0x3F</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="wchar.c.html#LN474"><span class='Ref_to_Parameter'>c</span></a> <span class='Operator'>&LT;= </span><span class='Number'>0xFFFF</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="wchar.c.html#LN474"><span class='Ref_to_Parameter'>utf8string</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Number'>0xE0</span> <span class='Operator'>| </span><span class='Parentheses'>((</span><a href="wchar.c.html#LN474"><span class='Ref_to_Parameter'>c</span></a> <span class='Operator'>&GT;&GT; </span><span class='Number'>12</span><span class='Parentheses'>) </span><span class='Operator'>& </span><span class='Number'>0x0F</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="wchar.c.html#LN474"><span class='Ref_to_Parameter'>utf8string</span></a><span class='Delimiter'>[</span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Number'>0x80</span> <span class='Operator'>| </span><span class='Parentheses'>((</span><a href="wchar.c.html#LN474"><span class='Ref_to_Parameter'>c</span></a> <span class='Operator'>&GT;&GT; </span><span class='Number'>6</span><span class='Parentheses'>) </span><span class='Operator'>& </span><span class='Number'>0x3F</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="wchar.c.html#LN474"><span class='Ref_to_Parameter'>utf8string</span></a><span class='Delimiter'>[</span><span class='Number'>2</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Number'>0x80</span> <span class='Operator'>| </span><span class='Parentheses'>(</span><a href="wchar.c.html#LN474"><span class='Ref_to_Parameter'>c</span></a> <span class='Operator'>& </span><span class='Number'>0x3F</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <a href="wchar.c.html#LN474"><span class='Ref_to_Parameter'>utf8string</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Number'>0xF0</span> <span class='Operator'>| </span><span class='Parentheses'>((</span><a href="wchar.c.html#LN474"><span class='Ref_to_Parameter'>c</span></a> <span class='Operator'>&GT;&GT; </span><span class='Number'>18</span><span class='Parentheses'>) </span><span class='Operator'>& </span><span class='Number'>0x07</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="wchar.c.html#LN474"><span class='Ref_to_Parameter'>utf8string</span></a><span class='Delimiter'>[</span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Number'>0x80</span> <span class='Operator'>| </span><span class='Parentheses'>((</span><a href="wchar.c.html#LN474"><span class='Ref_to_Parameter'>c</span></a> <span class='Operator'>&GT;&GT; </span><span class='Number'>12</span><span class='Parentheses'>) </span><span class='Operator'>& </span><span class='Number'>0x3F</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="wchar.c.html#LN474"><span class='Ref_to_Parameter'>utf8string</span></a><span class='Delimiter'>[</span><span class='Number'>2</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Number'>0x80</span> <span class='Operator'>| </span><span class='Parentheses'>((</span><a href="wchar.c.html#LN474"><span class='Ref_to_Parameter'>c</span></a> <span class='Operator'>&GT;&GT; </span><span class='Number'>6</span><span class='Parentheses'>) </span><span class='Operator'>& </span><span class='Number'>0x3F</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="wchar.c.html#LN474"><span class='Ref_to_Parameter'>utf8string</span></a><span class='Delimiter'>[</span><span class='Number'>3</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Number'>0x80</span> <span class='Operator'>| </span><span class='Parentheses'>(</span><a href="wchar.c.html#LN474"><span class='Ref_to_Parameter'>c</span></a> <span class='Operator'>& </span><span class='Number'>0x3F</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>return</span> <a href="wchar.c.html#LN474"><span class='Ref_to_Parameter'>utf8string</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end unicode_to_utf8 &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * Trivial conversion from pg_wchar to UTF-8. 
 * caller should allocate enough space for "to" 
 * len: length of from. 
 * "from" not necessarily null terminated. 
 */ 
</span><span class='Keyword'>static int 
</span><a name="LN509"></a><span class='Declare_Function'>pg_wchar2utf_with_len</span><span class='Parentheses'>(</span><span class='Keyword'>const </span><a href="../../../include/mb/pg_wchar.h.html#LN24"><span class='Ref_to_Typedef'>pg_wchar</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>from</span><span class='Delimiter'>, </span><span class='Keyword'>unsigned char </span><span class='Operator'>*</span><span class='Declare_Parameter'>to</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>len</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN511"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>cnt</span> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>while</span> <span class='Parentheses'>(</span><a href="wchar.c.html#LN509"><span class='Ref_to_Parameter'>len</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span> <span class='Operator'>&& *</span><a href="wchar.c.html#LN509"><span class='Ref_to_Parameter'>from</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN515"></a>        <span class='Keyword'>int</span>         <span class='Declare_Local'>char_len</span><span class='Delimiter'>; 
</span> 
        <a href="wchar.c.html#LN473"><span class='Ref_to_Func'>unicode_to_utf8</span></a><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="wchar.c.html#LN509"><span class='Ref_to_Parameter'>from</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN509"><span class='Ref_to_Parameter'>to</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="wchar.c.html#LN515"><span class='Ref_To_Local'>char_len</span></a> <span class='Operator'>= </span><a href="wchar.c.html#LN539"><span class='Ref_to_Func'>pg_utf_mblen</span></a><span class='Parentheses'>(</span><a href="wchar.c.html#LN509"><span class='Ref_to_Parameter'>to</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="wchar.c.html#LN511"><span class='Ref_To_Local'>cnt</span></a> <span class='Operator'>+= </span><a href="wchar.c.html#LN515"><span class='Ref_To_Local'>char_len</span></a><span class='Delimiter'>; 
</span>        <a href="wchar.c.html#LN509"><span class='Ref_to_Parameter'>to</span></a> <span class='Operator'>+= </span><a href="wchar.c.html#LN515"><span class='Ref_To_Local'>char_len</span></a><span class='Delimiter'>; 
</span>        <a href="wchar.c.html#LN509"><span class='Ref_to_Parameter'>from</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>        <a href="wchar.c.html#LN509"><span class='Ref_to_Parameter'>len</span></a><span class='Operator'>--</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Operator'>*</span><a href="wchar.c.html#LN509"><span class='Ref_to_Parameter'>to</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <a href="wchar.c.html#LN511"><span class='Ref_To_Local'>cnt</span></a><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * Return the byte length of a UTF8 character pointed to by s 
 * 
 * Note: in the current implementation we do not support UTF8 sequences 
 * of more than 4 bytes; hence do NOT return a value larger than 4. 
 * We return "1" for any leading byte that is either flat-out illegal or 
 * indicates a length larger than we support. 
 * 
 * pg_utf2wchar_with_len(), utf8_to_unicode(), pg_utf8_islegal(), and perhaps 
 * other places would need to be fixed to change this. 
 */ 
</span><span class='Keyword'>int 
</span><a name="LN540"></a><span class='Declare_Function'>pg_utf_mblen</span><span class='Parentheses'>(</span><span class='Keyword'>const unsigned char </span><span class='Operator'>*</span><span class='Declare_Parameter'>s</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN542"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>len</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>((</span><span class='Operator'>*</span><a href="wchar.c.html#LN540"><span class='Ref_to_Parameter'>s</span></a> <span class='Operator'>& </span><span class='Number'>0x80</span><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <a href="wchar.c.html#LN542"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>((</span><span class='Operator'>*</span><a href="wchar.c.html#LN540"><span class='Ref_to_Parameter'>s</span></a> <span class='Operator'>& </span><span class='Number'>0xe0</span><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0xc0</span><span class='Parentheses'>)</span> 
        <a href="wchar.c.html#LN542"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>= </span><span class='Number'>2</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>((</span><span class='Operator'>*</span><a href="wchar.c.html#LN540"><span class='Ref_to_Parameter'>s</span></a> <span class='Operator'>& </span><span class='Number'>0xf0</span><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0xe0</span><span class='Parentheses'>)</span> 
        <a href="wchar.c.html#LN542"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>= </span><span class='Number'>3</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>((</span><span class='Operator'>*</span><a href="wchar.c.html#LN540"><span class='Ref_to_Parameter'>s</span></a> <span class='Operator'>& </span><span class='Number'>0xf8</span><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0xf0</span><span class='Parentheses'>)</span> 
        <a href="wchar.c.html#LN542"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>= </span><span class='Number'>4</span><span class='Delimiter'>; 
</span><span class='Directive'>#ifdef</span> NOT_USED 
    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>((</span><span class='Operator'>*</span><a href="wchar.c.html#LN540"><span class='Ref_to_Parameter'>s</span></a> <span class='Operator'>& </span><span class='Number'>0xfc</span><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0xf8</span><span class='Parentheses'>)</span> 
        <a href="wchar.c.html#LN542"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>= </span><span class='Number'>5</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>((</span><span class='Operator'>*</span><a href="wchar.c.html#LN540"><span class='Ref_to_Parameter'>s</span></a> <span class='Operator'>& </span><span class='Number'>0xfe</span><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0xfc</span><span class='Parentheses'>)</span> 
        <a href="wchar.c.html#LN542"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>= </span><span class='Number'>6</span><span class='Delimiter'>; 
</span><span class='Directive'>#endif</span> 
    <span class='Control'>else</span> 
        <a href="wchar.c.html#LN542"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <a href="wchar.c.html#LN542"><span class='Ref_To_Local'>len</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end pg_utf_mblen &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * This is an implementation of wcwidth() and wcswidth() as defined in 
 * "The Single UNIX Specification, Version 2, The Open Group, 1997" 
 * &LT;http://www.UNIX-systems.org/online.html&GT; 
 * 
 * Markus Kuhn -- 2001-09-08 -- public domain 
 * 
 * customised for PostgreSQL 
 * 
 * original available at : http://www.cl.cam.ac.uk/~mgk25/ucs/wcwidth.c 
 */ 
</span> 
<a name="LN575"></a><span class='Control'>struct</span> <span class='Declare_Struct'>mbinterval</span> 
<span class='Delimiter'>{ 
</span><a name="LN577"></a>    <span class='Keyword'>unsigned short </span><span class='Declare_Member'>first</span><span class='Delimiter'>; 
</span><a name="LN578"></a>    <span class='Keyword'>unsigned short </span><span class='Declare_Member'>last</span><span class='Delimiter'>; 
}; 
</span> 
<span class='Comment_Multi_Line'>/* auxiliary function for binary search in interval table */ 
</span><span class='Keyword'>static int 
</span><a name="LN583"></a><span class='Declare_Function'>mbbisearch</span><span class='Parentheses'>(</span><a href="../../../include/mb/pg_wchar.h.html#LN24"><span class='Ref_to_Typedef'>pg_wchar</span></a> <span class='Declare_Parameter'>ucs</span><span class='Delimiter'>, </span><span class='Keyword'>const </span><span class='Control'>struct</span> <a href="wchar.c.html#LN575"><span class='Ref_to_Struct'>mbinterval</span></a> <span class='Operator'>* </span><span class='Declare_Parameter'>table</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>max</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN585"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>min</span> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span><a name="LN586"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>mid</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="wchar.c.html#LN583"><span class='Ref_to_Parameter'>ucs</span></a> <span class='Operator'>&LT; </span><a href="wchar.c.html#LN583"><span class='Ref_to_Parameter'>table</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="wchar.c.html#LN577"><span class='Ref_to_Member'>first</span></a> <span class='Operator'>|| </span><a href="wchar.c.html#LN583"><span class='Ref_to_Parameter'>ucs</span></a> <span class='Operator'>&GT; </span><a href="wchar.c.html#LN583"><span class='Ref_to_Parameter'>table</span></a><span class='Delimiter'>[</span><a href="wchar.c.html#LN583"><span class='Ref_to_Parameter'>max</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="wchar.c.html#LN578"><span class='Ref_to_Member'>last</span></a><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <span class='Number'>0</span><span class='Delimiter'>; 
</span>    <span class='Control'>while</span> <span class='Parentheses'>(</span><a href="wchar.c.html#LN583"><span class='Ref_to_Parameter'>max</span></a> <span class='Operator'>&GT;= </span><a href="wchar.c.html#LN585"><span class='Ref_To_Local'>min</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="wchar.c.html#LN586"><span class='Ref_To_Local'>mid</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="wchar.c.html#LN585"><span class='Ref_To_Local'>min</span></a> <span class='Operator'>+ </span><a href="wchar.c.html#LN583"><span class='Ref_to_Parameter'>max</span></a><span class='Parentheses'>) </span><span class='Operator'>/ </span><span class='Number'>2</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="wchar.c.html#LN583"><span class='Ref_to_Parameter'>ucs</span></a> <span class='Operator'>&GT; </span><a href="wchar.c.html#LN583"><span class='Ref_to_Parameter'>table</span></a><span class='Delimiter'>[</span><a href="wchar.c.html#LN586"><span class='Ref_To_Local'>mid</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="wchar.c.html#LN578"><span class='Ref_to_Member'>last</span></a><span class='Parentheses'>) 
</span>            <a href="wchar.c.html#LN585"><span class='Ref_To_Local'>min</span></a> <span class='Operator'>= </span><a href="wchar.c.html#LN586"><span class='Ref_To_Local'>mid</span></a> <span class='Operator'>+ </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="wchar.c.html#LN583"><span class='Ref_to_Parameter'>ucs</span></a> <span class='Operator'>&LT; </span><a href="wchar.c.html#LN583"><span class='Ref_to_Parameter'>table</span></a><span class='Delimiter'>[</span><a href="wchar.c.html#LN586"><span class='Ref_To_Local'>mid</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="wchar.c.html#LN577"><span class='Ref_to_Member'>first</span></a><span class='Parentheses'>) 
</span>            <a href="wchar.c.html#LN583"><span class='Ref_to_Parameter'>max</span></a> <span class='Operator'>= </span><a href="wchar.c.html#LN586"><span class='Ref_To_Local'>mid</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> 
            <span class='Control'>return</span> <span class='Number'>1</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>return</span> <span class='Number'>0</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end mbbisearch &raquo; </span> 
 
 
<span class='Comment_Multi_Line'>/* The following functions define the column width of an ISO 10646 
 * character as follows: 
 * 
 *    - The null character (U+0000) has a column width of 0. 
 * 
 *    - Other C0/C1 control characters and DEL will lead to a return 
 *      value of -1. 
 * 
 *    - Non-spacing and enclosing combining characters (general 
 *      category code Mn or Me in the Unicode database) have a 
 *      column width of 0. 
 * 
 *    - Other format characters (general category code Cf in the Unicode 
 *      database) and ZERO WIDTH SPACE (U+200B) have a column width of 0. 
 * 
 *    - Hangul Jamo medial vowels and final consonants (U+1160-U+11FF) 
 *      have a column width of 0. 
 * 
 *    - Spacing characters in the East Asian Wide (W) or East Asian 
 *      FullWidth (F) category as defined in Unicode Technical 
 *      Report #11 have a column width of 2. 
 * 
 *    - All remaining characters (including all printable 
 *      ISO 8859-1 and WGL4 characters, Unicode control characters, 
 *      etc.) have a column width of 1. 
 * 
 * This implementation assumes that wchar_t characters are encoded 
 * in ISO 10646. 
 */ 
</span> 
<span class='Keyword'>static int 
</span><a name="LN636"></a><span class='Declare_Function'>ucs_wcwidth</span><span class='Parentheses'>(</span><a href="../../../include/mb/pg_wchar.h.html#LN24"><span class='Ref_to_Typedef'>pg_wchar</span></a> <span class='Declare_Parameter'>ucs</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Comment_Multi_Line'>/* sorted list of non-overlapping intervals of non-spacing characters */ 
</span><a name="LN639"></a>    <span class='Keyword'>static const </span><span class='Control'>struct</span> <a href="wchar.c.html#LN575"><span class='Ref_to_Struct'>mbinterval</span></a> <span class='Declare_Local'>combining</span><span class='Delimiter'>[] </span><span class='Operator'>= </span><span class='Delimiter'>{ 
</span>        <span class='Delimiter'>{</span><span class='Number'>0x0300</span><span class='Delimiter'>, </span><span class='Number'>0x034E</span><span class='Delimiter'>}, {</span><span class='Number'>0x0360</span><span class='Delimiter'>, </span><span class='Number'>0x0362</span><span class='Delimiter'>}, {</span><span class='Number'>0x0483</span><span class='Delimiter'>, </span><span class='Number'>0x0486</span><span class='Delimiter'>}, 
</span>        <span class='Delimiter'>{</span><span class='Number'>0x0488</span><span class='Delimiter'>, </span><span class='Number'>0x0489</span><span class='Delimiter'>}, {</span><span class='Number'>0x0591</span><span class='Delimiter'>, </span><span class='Number'>0x05A1</span><span class='Delimiter'>}, {</span><span class='Number'>0x05A3</span><span class='Delimiter'>, </span><span class='Number'>0x05B9</span><span class='Delimiter'>}, 
</span>        <span class='Delimiter'>{</span><span class='Number'>0x05BB</span><span class='Delimiter'>, </span><span class='Number'>0x05BD</span><span class='Delimiter'>}, {</span><span class='Number'>0x05BF</span><span class='Delimiter'>, </span><span class='Number'>0x05BF</span><span class='Delimiter'>}, {</span><span class='Number'>0x05C1</span><span class='Delimiter'>, </span><span class='Number'>0x05C2</span><span class='Delimiter'>}, 
</span>        <span class='Delimiter'>{</span><span class='Number'>0x05C4</span><span class='Delimiter'>, </span><span class='Number'>0x05C4</span><span class='Delimiter'>}, {</span><span class='Number'>0x064B</span><span class='Delimiter'>, </span><span class='Number'>0x0655</span><span class='Delimiter'>}, {</span><span class='Number'>0x0670</span><span class='Delimiter'>, </span><span class='Number'>0x0670</span><span class='Delimiter'>}, 
</span>        <span class='Delimiter'>{</span><span class='Number'>0x06D6</span><span class='Delimiter'>, </span><span class='Number'>0x06E4</span><span class='Delimiter'>}, {</span><span class='Number'>0x06E7</span><span class='Delimiter'>, </span><span class='Number'>0x06E8</span><span class='Delimiter'>}, {</span><span class='Number'>0x06EA</span><span class='Delimiter'>, </span><span class='Number'>0x06ED</span><span class='Delimiter'>}, 
</span>        <span class='Delimiter'>{</span><span class='Number'>0x070F</span><span class='Delimiter'>, </span><span class='Number'>0x070F</span><span class='Delimiter'>}, {</span><span class='Number'>0x0711</span><span class='Delimiter'>, </span><span class='Number'>0x0711</span><span class='Delimiter'>}, {</span><span class='Number'>0x0730</span><span class='Delimiter'>, </span><span class='Number'>0x074A</span><span class='Delimiter'>}, 
</span>        <span class='Delimiter'>{</span><span class='Number'>0x07A6</span><span class='Delimiter'>, </span><span class='Number'>0x07B0</span><span class='Delimiter'>}, {</span><span class='Number'>0x0901</span><span class='Delimiter'>, </span><span class='Number'>0x0902</span><span class='Delimiter'>}, {</span><span class='Number'>0x093C</span><span class='Delimiter'>, </span><span class='Number'>0x093C</span><span class='Delimiter'>}, 
</span>        <span class='Delimiter'>{</span><span class='Number'>0x0941</span><span class='Delimiter'>, </span><span class='Number'>0x0948</span><span class='Delimiter'>}, {</span><span class='Number'>0x094D</span><span class='Delimiter'>, </span><span class='Number'>0x094D</span><span class='Delimiter'>}, {</span><span class='Number'>0x0951</span><span class='Delimiter'>, </span><span class='Number'>0x0954</span><span class='Delimiter'>}, 
</span>        <span class='Delimiter'>{</span><span class='Number'>0x0962</span><span class='Delimiter'>, </span><span class='Number'>0x0963</span><span class='Delimiter'>}, {</span><span class='Number'>0x0981</span><span class='Delimiter'>, </span><span class='Number'>0x0981</span><span class='Delimiter'>}, {</span><span class='Number'>0x09BC</span><span class='Delimiter'>, </span><span class='Number'>0x09BC</span><span class='Delimiter'>}, 
</span>        <span class='Delimiter'>{</span><span class='Number'>0x09C1</span><span class='Delimiter'>, </span><span class='Number'>0x09C4</span><span class='Delimiter'>}, {</span><span class='Number'>0x09CD</span><span class='Delimiter'>, </span><span class='Number'>0x09CD</span><span class='Delimiter'>}, {</span><span class='Number'>0x09E2</span><span class='Delimiter'>, </span><span class='Number'>0x09E3</span><span class='Delimiter'>}, 
</span>        <span class='Delimiter'>{</span><span class='Number'>0x0A02</span><span class='Delimiter'>, </span><span class='Number'>0x0A02</span><span class='Delimiter'>}, {</span><span class='Number'>0x0A3C</span><span class='Delimiter'>, </span><span class='Number'>0x0A3C</span><span class='Delimiter'>}, {</span><span class='Number'>0x0A41</span><span class='Delimiter'>, </span><span class='Number'>0x0A42</span><span class='Delimiter'>}, 
</span>        <span class='Delimiter'>{</span><span class='Number'>0x0A47</span><span class='Delimiter'>, </span><span class='Number'>0x0A48</span><span class='Delimiter'>}, {</span><span class='Number'>0x0A4B</span><span class='Delimiter'>, </span><span class='Number'>0x0A4D</span><span class='Delimiter'>}, {</span><span class='Number'>0x0A70</span><span class='Delimiter'>, </span><span class='Number'>0x0A71</span><span class='Delimiter'>}, 
</span>        <span class='Delimiter'>{</span><span class='Number'>0x0A81</span><span class='Delimiter'>, </span><span class='Number'>0x0A82</span><span class='Delimiter'>}, {</span><span class='Number'>0x0ABC</span><span class='Delimiter'>, </span><span class='Number'>0x0ABC</span><span class='Delimiter'>}, {</span><span class='Number'>0x0AC1</span><span class='Delimiter'>, </span><span class='Number'>0x0AC5</span><span class='Delimiter'>}, 
</span>        <span class='Delimiter'>{</span><span class='Number'>0x0AC7</span><span class='Delimiter'>, </span><span class='Number'>0x0AC8</span><span class='Delimiter'>}, {</span><span class='Number'>0x0ACD</span><span class='Delimiter'>, </span><span class='Number'>0x0ACD</span><span class='Delimiter'>}, {</span><span class='Number'>0x0B01</span><span class='Delimiter'>, </span><span class='Number'>0x0B01</span><span class='Delimiter'>}, 
</span>        <span class='Delimiter'>{</span><span class='Number'>0x0B3C</span><span class='Delimiter'>, </span><span class='Number'>0x0B3C</span><span class='Delimiter'>}, {</span><span class='Number'>0x0B3F</span><span class='Delimiter'>, </span><span class='Number'>0x0B3F</span><span class='Delimiter'>}, {</span><span class='Number'>0x0B41</span><span class='Delimiter'>, </span><span class='Number'>0x0B43</span><span class='Delimiter'>}, 
</span>        <span class='Delimiter'>{</span><span class='Number'>0x0B4D</span><span class='Delimiter'>, </span><span class='Number'>0x0B4D</span><span class='Delimiter'>}, {</span><span class='Number'>0x0B56</span><span class='Delimiter'>, </span><span class='Number'>0x0B56</span><span class='Delimiter'>}, {</span><span class='Number'>0x0B82</span><span class='Delimiter'>, </span><span class='Number'>0x0B82</span><span class='Delimiter'>}, 
</span>        <span class='Delimiter'>{</span><span class='Number'>0x0BC0</span><span class='Delimiter'>, </span><span class='Number'>0x0BC0</span><span class='Delimiter'>}, {</span><span class='Number'>0x0BCD</span><span class='Delimiter'>, </span><span class='Number'>0x0BCD</span><span class='Delimiter'>}, {</span><span class='Number'>0x0C3E</span><span class='Delimiter'>, </span><span class='Number'>0x0C40</span><span class='Delimiter'>}, 
</span>        <span class='Delimiter'>{</span><span class='Number'>0x0C46</span><span class='Delimiter'>, </span><span class='Number'>0x0C48</span><span class='Delimiter'>}, {</span><span class='Number'>0x0C4A</span><span class='Delimiter'>, </span><span class='Number'>0x0C4D</span><span class='Delimiter'>}, {</span><span class='Number'>0x0C55</span><span class='Delimiter'>, </span><span class='Number'>0x0C56</span><span class='Delimiter'>}, 
</span>        <span class='Delimiter'>{</span><span class='Number'>0x0CBF</span><span class='Delimiter'>, </span><span class='Number'>0x0CBF</span><span class='Delimiter'>}, {</span><span class='Number'>0x0CC6</span><span class='Delimiter'>, </span><span class='Number'>0x0CC6</span><span class='Delimiter'>}, {</span><span class='Number'>0x0CCC</span><span class='Delimiter'>, </span><span class='Number'>0x0CCD</span><span class='Delimiter'>}, 
</span>        <span class='Delimiter'>{</span><span class='Number'>0x0D41</span><span class='Delimiter'>, </span><span class='Number'>0x0D43</span><span class='Delimiter'>}, {</span><span class='Number'>0x0D4D</span><span class='Delimiter'>, </span><span class='Number'>0x0D4D</span><span class='Delimiter'>}, {</span><span class='Number'>0x0DCA</span><span class='Delimiter'>, </span><span class='Number'>0x0DCA</span><span class='Delimiter'>}, 
</span>        <span class='Delimiter'>{</span><span class='Number'>0x0DD2</span><span class='Delimiter'>, </span><span class='Number'>0x0DD4</span><span class='Delimiter'>}, {</span><span class='Number'>0x0DD6</span><span class='Delimiter'>, </span><span class='Number'>0x0DD6</span><span class='Delimiter'>}, {</span><span class='Number'>0x0E31</span><span class='Delimiter'>, </span><span class='Number'>0x0E31</span><span class='Delimiter'>}, 
</span>        <span class='Delimiter'>{</span><span class='Number'>0x0E34</span><span class='Delimiter'>, </span><span class='Number'>0x0E3A</span><span class='Delimiter'>}, {</span><span class='Number'>0x0E47</span><span class='Delimiter'>, </span><span class='Number'>0x0E4E</span><span class='Delimiter'>}, {</span><span class='Number'>0x0EB1</span><span class='Delimiter'>, </span><span class='Number'>0x0EB1</span><span class='Delimiter'>}, 
</span>        <span class='Delimiter'>{</span><span class='Number'>0x0EB4</span><span class='Delimiter'>, </span><span class='Number'>0x0EB9</span><span class='Delimiter'>}, {</span><span class='Number'>0x0EBB</span><span class='Delimiter'>, </span><span class='Number'>0x0EBC</span><span class='Delimiter'>}, {</span><span class='Number'>0x0EC8</span><span class='Delimiter'>, </span><span class='Number'>0x0ECD</span><span class='Delimiter'>}, 
</span>        <span class='Delimiter'>{</span><span class='Number'>0x0F18</span><span class='Delimiter'>, </span><span class='Number'>0x0F19</span><span class='Delimiter'>}, {</span><span class='Number'>0x0F35</span><span class='Delimiter'>, </span><span class='Number'>0x0F35</span><span class='Delimiter'>}, {</span><span class='Number'>0x0F37</span><span class='Delimiter'>, </span><span class='Number'>0x0F37</span><span class='Delimiter'>}, 
</span>        <span class='Delimiter'>{</span><span class='Number'>0x0F39</span><span class='Delimiter'>, </span><span class='Number'>0x0F39</span><span class='Delimiter'>}, {</span><span class='Number'>0x0F71</span><span class='Delimiter'>, </span><span class='Number'>0x0F7E</span><span class='Delimiter'>}, {</span><span class='Number'>0x0F80</span><span class='Delimiter'>, </span><span class='Number'>0x0F84</span><span class='Delimiter'>}, 
</span>        <span class='Delimiter'>{</span><span class='Number'>0x0F86</span><span class='Delimiter'>, </span><span class='Number'>0x0F87</span><span class='Delimiter'>}, {</span><span class='Number'>0x0F90</span><span class='Delimiter'>, </span><span class='Number'>0x0F97</span><span class='Delimiter'>}, {</span><span class='Number'>0x0F99</span><span class='Delimiter'>, </span><span class='Number'>0x0FBC</span><span class='Delimiter'>}, 
</span>        <span class='Delimiter'>{</span><span class='Number'>0x0FC6</span><span class='Delimiter'>, </span><span class='Number'>0x0FC6</span><span class='Delimiter'>}, {</span><span class='Number'>0x102D</span><span class='Delimiter'>, </span><span class='Number'>0x1030</span><span class='Delimiter'>}, {</span><span class='Number'>0x1032</span><span class='Delimiter'>, </span><span class='Number'>0x1032</span><span class='Delimiter'>}, 
</span>        <span class='Delimiter'>{</span><span class='Number'>0x1036</span><span class='Delimiter'>, </span><span class='Number'>0x1037</span><span class='Delimiter'>}, {</span><span class='Number'>0x1039</span><span class='Delimiter'>, </span><span class='Number'>0x1039</span><span class='Delimiter'>}, {</span><span class='Number'>0x1058</span><span class='Delimiter'>, </span><span class='Number'>0x1059</span><span class='Delimiter'>}, 
</span>        <span class='Delimiter'>{</span><span class='Number'>0x1160</span><span class='Delimiter'>, </span><span class='Number'>0x11FF</span><span class='Delimiter'>}, {</span><span class='Number'>0x17B7</span><span class='Delimiter'>, </span><span class='Number'>0x17BD</span><span class='Delimiter'>}, {</span><span class='Number'>0x17C6</span><span class='Delimiter'>, </span><span class='Number'>0x17C6</span><span class='Delimiter'>}, 
</span>        <span class='Delimiter'>{</span><span class='Number'>0x17C9</span><span class='Delimiter'>, </span><span class='Number'>0x17D3</span><span class='Delimiter'>}, {</span><span class='Number'>0x180B</span><span class='Delimiter'>, </span><span class='Number'>0x180E</span><span class='Delimiter'>}, {</span><span class='Number'>0x18A9</span><span class='Delimiter'>, </span><span class='Number'>0x18A9</span><span class='Delimiter'>}, 
</span>        <span class='Delimiter'>{</span><span class='Number'>0x200B</span><span class='Delimiter'>, </span><span class='Number'>0x200F</span><span class='Delimiter'>}, {</span><span class='Number'>0x202A</span><span class='Delimiter'>, </span><span class='Number'>0x202E</span><span class='Delimiter'>}, {</span><span class='Number'>0x206A</span><span class='Delimiter'>, </span><span class='Number'>0x206F</span><span class='Delimiter'>}, 
</span>        <span class='Delimiter'>{</span><span class='Number'>0x20D0</span><span class='Delimiter'>, </span><span class='Number'>0x20E3</span><span class='Delimiter'>}, {</span><span class='Number'>0x302A</span><span class='Delimiter'>, </span><span class='Number'>0x302F</span><span class='Delimiter'>}, {</span><span class='Number'>0x3099</span><span class='Delimiter'>, </span><span class='Number'>0x309A</span><span class='Delimiter'>}, 
</span>        <span class='Delimiter'>{</span><span class='Number'>0xFB1E</span><span class='Delimiter'>, </span><span class='Number'>0xFB1E</span><span class='Delimiter'>}, {</span><span class='Number'>0xFE20</span><span class='Delimiter'>, </span><span class='Number'>0xFE23</span><span class='Delimiter'>}, {</span><span class='Number'>0xFEFF</span><span class='Delimiter'>, </span><span class='Number'>0xFEFF</span><span class='Delimiter'>}, 
</span>        <span class='Delimiter'>{</span><span class='Number'>0xFFF9</span><span class='Delimiter'>, </span><span class='Number'>0xFFFB</span><span class='Delimiter'>} 
</span>    <span class='Delimiter'>}; 
</span> 
    <span class='Comment_Multi_Line'>/* test for 8-bit control characters */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="wchar.c.html#LN636"><span class='Ref_to_Parameter'>ucs</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <span class='Number'>0</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="wchar.c.html#LN636"><span class='Ref_to_Parameter'>ucs</span></a> <span class='Operator'>&LT; </span><span class='Number'>0x20</span> <span class='Operator'>|| </span><span class='Parentheses'>(</span><a href="wchar.c.html#LN636"><span class='Ref_to_Parameter'>ucs</span></a> <span class='Operator'>&GT;= </span><span class='Number'>0x7f</span> <span class='Operator'>&& </span><a href="wchar.c.html#LN636"><span class='Ref_to_Parameter'>ucs</span></a> <span class='Operator'>&LT; </span><span class='Number'>0xa0</span><span class='Parentheses'>) </span><span class='Operator'>|| </span><a href="wchar.c.html#LN636"><span class='Ref_to_Parameter'>ucs</span></a> <span class='Operator'>&GT; </span><span class='Number'>0x0010ffff</span><span class='Parentheses'>)</span> 
        <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* binary search in table of non-spacing characters */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="wchar.c.html#LN582"><span class='Ref_to_Func'>mbbisearch</span></a><span class='Parentheses'>(</span><a href="wchar.c.html#LN636"><span class='Ref_to_Parameter'>ucs</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN639"><span class='Ref_To_Local'>combining</span></a><span class='Delimiter'>, 
</span>                   <span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="wchar.c.html#LN639"><span class='Ref_To_Local'>combining</span></a><span class='Parentheses'>) </span><span class='Operator'>/ </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><span class='Control'>struct</span> <a href="wchar.c.html#LN575"><span class='Ref_to_Struct'>mbinterval</span></a><span class='Parentheses'>) </span><span class='Operator'>- </span><span class='Number'>1</span><span class='Parentheses'>))</span> 
        <span class='Control'>return</span> <span class='Number'>0</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * if we arrive here, ucs is not a combining or C0/C1 control character 
     */ 
</span> 
    <span class='Control'>return</span> <span class='Number'>1</span> <span class='Operator'>+ 
</span>        <span class='Parentheses'>(</span><a href="wchar.c.html#LN636"><span class='Ref_to_Parameter'>ucs</span></a> <span class='Operator'>&GT;= </span><span class='Number'>0x1100</span> <span class='Operator'>&& 
</span>         <span class='Parentheses'>(</span><a href="wchar.c.html#LN636"><span class='Ref_to_Parameter'>ucs</span></a> <span class='Operator'>&LT;= </span><span class='Number'>0x115f</span> <span class='Operator'>||</span>      <span class='Comment_Single_Line'>/* Hangul Jamo init. consonants */ 
</span>          <span class='Parentheses'>(</span><a href="wchar.c.html#LN636"><span class='Ref_to_Parameter'>ucs</span></a> <span class='Operator'>&GT;= </span><span class='Number'>0x2e80</span> <span class='Operator'>&& </span><a href="wchar.c.html#LN636"><span class='Ref_to_Parameter'>ucs</span></a> <span class='Operator'>&LT;= </span><span class='Number'>0xa4cf</span> <span class='Operator'>&& </span><span class='Parentheses'>(</span><a href="wchar.c.html#LN636"><span class='Ref_to_Parameter'>ucs</span></a> <span class='Operator'>& ~</span><span class='Number'>0x0011</span><span class='Parentheses'>) </span><span class='Operator'>!= </span><span class='Number'>0x300a</span> <span class='Operator'>&& 
</span>           <a href="wchar.c.html#LN636"><span class='Ref_to_Parameter'>ucs</span></a> <span class='Operator'>!= </span><span class='Number'>0x303f</span><span class='Parentheses'>)</span> <span class='Operator'>||</span>    <span class='Comment_Single_Line'>/* CJK ... Yi */ 
</span>          <span class='Parentheses'>(</span><a href="wchar.c.html#LN636"><span class='Ref_to_Parameter'>ucs</span></a> <span class='Operator'>&GT;= </span><span class='Number'>0xac00</span> <span class='Operator'>&& </span><a href="wchar.c.html#LN636"><span class='Ref_to_Parameter'>ucs</span></a> <span class='Operator'>&LT;= </span><span class='Number'>0xd7a3</span><span class='Parentheses'>)</span> <span class='Operator'>||</span>   <span class='Comment_Single_Line'>/* Hangul Syllables */ 
</span>          <span class='Parentheses'>(</span><a href="wchar.c.html#LN636"><span class='Ref_to_Parameter'>ucs</span></a> <span class='Operator'>&GT;= </span><span class='Number'>0xf900</span> <span class='Operator'>&& </span><a href="wchar.c.html#LN636"><span class='Ref_to_Parameter'>ucs</span></a> <span class='Operator'>&LT;= </span><span class='Number'>0xfaff</span><span class='Parentheses'>)</span> <span class='Operator'>||</span>   <span class='Comment_Multi_Line'>/* CJK Compatibility 
                                                 * Ideographs */ 
</span>          <span class='Parentheses'>(</span><a href="wchar.c.html#LN636"><span class='Ref_to_Parameter'>ucs</span></a> <span class='Operator'>&GT;= </span><span class='Number'>0xfe30</span> <span class='Operator'>&& </span><a href="wchar.c.html#LN636"><span class='Ref_to_Parameter'>ucs</span></a> <span class='Operator'>&LT;= </span><span class='Number'>0xfe6f</span><span class='Parentheses'>)</span> <span class='Operator'>||</span>   <span class='Comment_Single_Line'>/* CJK Compatibility Forms */ 
</span>          <span class='Parentheses'>(</span><a href="wchar.c.html#LN636"><span class='Ref_to_Parameter'>ucs</span></a> <span class='Operator'>&GT;= </span><span class='Number'>0xff00</span> <span class='Operator'>&& </span><a href="wchar.c.html#LN636"><span class='Ref_to_Parameter'>ucs</span></a> <span class='Operator'>&LT;= </span><span class='Number'>0xff5f</span><span class='Parentheses'>)</span> <span class='Operator'>||</span>   <span class='Comment_Single_Line'>/* Fullwidth Forms */ 
</span>          <span class='Parentheses'>(</span><a href="wchar.c.html#LN636"><span class='Ref_to_Parameter'>ucs</span></a> <span class='Operator'>&GT;= </span><span class='Number'>0xffe0</span> <span class='Operator'>&& </span><a href="wchar.c.html#LN636"><span class='Ref_to_Parameter'>ucs</span></a> <span class='Operator'>&LT;= </span><span class='Number'>0xffe6</span><span class='Parentheses'>)</span> <span class='Operator'>|| 
</span>          <span class='Parentheses'>(</span><a href="wchar.c.html#LN636"><span class='Ref_to_Parameter'>ucs</span></a> <span class='Operator'>&GT;= </span><span class='Number'>0x20000</span> <span class='Operator'>&& </span><a href="wchar.c.html#LN636"><span class='Ref_to_Parameter'>ucs</span></a> <span class='Operator'>&LT;= </span><span class='Number'>0x2ffff</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end ucs_wcwidth &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * Convert a UTF-8 character to a Unicode code point. 
 * This is a one-character version of pg_utf2wchar_with_len. 
 * 
 * No error checks here, c must point to a long-enough string. 
 */ 
</span><a href="../../../include/mb/pg_wchar.h.html#LN24"><span class='Ref_to_Typedef'>pg_wchar</span></a> 
<a name="LN713"></a><span class='Declare_Function'>utf8_to_unicode</span><span class='Parentheses'>(</span><span class='Keyword'>const unsigned char </span><span class='Operator'>*</span><span class='Declare_Parameter'>c</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>((</span><span class='Operator'>*</span><a href="wchar.c.html#LN713"><span class='Ref_to_Parameter'>c</span></a> <span class='Operator'>& </span><span class='Number'>0x80</span><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <span class='Control'>return</span> <span class='Parentheses'>(</span><a href="../../../include/mb/pg_wchar.h.html#LN24"><span class='Ref_to_Typedef'>pg_wchar</span></a><span class='Parentheses'>) </span><a href="wchar.c.html#LN713"><span class='Ref_to_Parameter'>c</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>]; 
</span>    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>((</span><span class='Operator'>*</span><a href="wchar.c.html#LN713"><span class='Ref_to_Parameter'>c</span></a> <span class='Operator'>& </span><span class='Number'>0xe0</span><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0xc0</span><span class='Parentheses'>)</span> 
        <span class='Control'>return</span> <span class='Parentheses'>(</span><a href="../../../include/mb/pg_wchar.h.html#LN24"><span class='Ref_to_Typedef'>pg_wchar</span></a><span class='Parentheses'>) (((</span><a href="wchar.c.html#LN713"><span class='Ref_to_Parameter'>c</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>] </span><span class='Operator'>& </span><span class='Number'>0x1f</span><span class='Parentheses'>) </span><span class='Operator'>&LT;&LT; </span><span class='Number'>6</span><span class='Parentheses'>)</span> <span class='Operator'>| 
</span>                           <span class='Parentheses'>(</span><a href="wchar.c.html#LN713"><span class='Ref_to_Parameter'>c</span></a><span class='Delimiter'>[</span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>& </span><span class='Number'>0x3f</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>((</span><span class='Operator'>*</span><a href="wchar.c.html#LN713"><span class='Ref_to_Parameter'>c</span></a> <span class='Operator'>& </span><span class='Number'>0xf0</span><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0xe0</span><span class='Parentheses'>)</span> 
        <span class='Control'>return</span> <span class='Parentheses'>(</span><a href="../../../include/mb/pg_wchar.h.html#LN24"><span class='Ref_to_Typedef'>pg_wchar</span></a><span class='Parentheses'>) (((</span><a href="wchar.c.html#LN713"><span class='Ref_to_Parameter'>c</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>] </span><span class='Operator'>& </span><span class='Number'>0x0f</span><span class='Parentheses'>) </span><span class='Operator'>&LT;&LT; </span><span class='Number'>12</span><span class='Parentheses'>)</span> <span class='Operator'>| 
</span>                           <span class='Parentheses'>((</span><a href="wchar.c.html#LN713"><span class='Ref_to_Parameter'>c</span></a><span class='Delimiter'>[</span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>& </span><span class='Number'>0x3f</span><span class='Parentheses'>) </span><span class='Operator'>&LT;&LT; </span><span class='Number'>6</span><span class='Parentheses'>)</span> <span class='Operator'>| 
</span>                           <span class='Parentheses'>(</span><a href="wchar.c.html#LN713"><span class='Ref_to_Parameter'>c</span></a><span class='Delimiter'>[</span><span class='Number'>2</span><span class='Delimiter'>] </span><span class='Operator'>& </span><span class='Number'>0x3f</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>((</span><span class='Operator'>*</span><a href="wchar.c.html#LN713"><span class='Ref_to_Parameter'>c</span></a> <span class='Operator'>& </span><span class='Number'>0xf8</span><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0xf0</span><span class='Parentheses'>)</span> 
        <span class='Control'>return</span> <span class='Parentheses'>(</span><a href="../../../include/mb/pg_wchar.h.html#LN24"><span class='Ref_to_Typedef'>pg_wchar</span></a><span class='Parentheses'>) (((</span><a href="wchar.c.html#LN713"><span class='Ref_to_Parameter'>c</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>] </span><span class='Operator'>& </span><span class='Number'>0x07</span><span class='Parentheses'>) </span><span class='Operator'>&LT;&LT; </span><span class='Number'>18</span><span class='Parentheses'>)</span> <span class='Operator'>| 
</span>                           <span class='Parentheses'>((</span><a href="wchar.c.html#LN713"><span class='Ref_to_Parameter'>c</span></a><span class='Delimiter'>[</span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>& </span><span class='Number'>0x3f</span><span class='Parentheses'>) </span><span class='Operator'>&LT;&LT; </span><span class='Number'>12</span><span class='Parentheses'>)</span> <span class='Operator'>| 
</span>                           <span class='Parentheses'>((</span><a href="wchar.c.html#LN713"><span class='Ref_to_Parameter'>c</span></a><span class='Delimiter'>[</span><span class='Number'>2</span><span class='Delimiter'>] </span><span class='Operator'>& </span><span class='Number'>0x3f</span><span class='Parentheses'>) </span><span class='Operator'>&LT;&LT; </span><span class='Number'>6</span><span class='Parentheses'>)</span> <span class='Operator'>| 
</span>                           <span class='Parentheses'>(</span><a href="wchar.c.html#LN713"><span class='Ref_to_Parameter'>c</span></a><span class='Delimiter'>[</span><span class='Number'>3</span><span class='Delimiter'>] </span><span class='Operator'>& </span><span class='Number'>0x3f</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
        <span class='Comment_Multi_Line'>/* that is an invalid code on purpose */ 
</span>        <span class='Control'>return</span> <span class='Number'>0xffffffff</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end utf8_to_unicode &raquo; </span> 
 
<span class='Keyword'>static int 
</span><a name="LN735"></a><span class='Declare_Function'>pg_utf_dsplen</span><span class='Parentheses'>(</span><span class='Keyword'>const unsigned char </span><span class='Operator'>*</span><span class='Declare_Parameter'>s</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>return</span> <a href="wchar.c.html#LN635"><span class='Ref_to_Func'>ucs_wcwidth</span></a><span class='Parentheses'>(</span><a href="../../../fe_utils/mbprint.c.html#LN51"><span class='Ref_to_Func'>utf8_to_unicode</span></a><span class='Parentheses'>(</span><a href="wchar.c.html#LN735"><span class='Ref_to_Parameter'>s</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * convert mule internal code to pg_wchar 
 * caller should allocate enough space for "to" 
 * len: length of from. 
 * "from" not necessarily null terminated. 
 */ 
</span><span class='Keyword'>static int 
</span><a name="LN747"></a><span class='Declare_Function'>pg_mule2wchar_with_len</span><span class='Parentheses'>(</span><span class='Keyword'>const unsigned char </span><span class='Operator'>*</span><span class='Declare_Parameter'>from</span><span class='Delimiter'>, </span><a href="../../../include/mb/pg_wchar.h.html#LN24"><span class='Ref_to_Typedef'>pg_wchar</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>to</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>len</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN749"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>cnt</span> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>while</span> <span class='Parentheses'>(</span><a href="wchar.c.html#LN747"><span class='Ref_to_Parameter'>len</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span> <span class='Operator'>&& *</span><a href="wchar.c.html#LN747"><span class='Ref_to_Parameter'>from</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/mb/pg_wchar.h.html#LN122"><span class='Ref_to_Macro'>IS_LC1</span></a><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="wchar.c.html#LN747"><span class='Ref_to_Parameter'>from</span></a><span class='Parentheses'>) </span><span class='Operator'>&& </span><a href="wchar.c.html#LN747"><span class='Ref_to_Parameter'>len</span></a> <span class='Operator'>&GT;= </span><span class='Number'>2</span><span class='Parentheses'>)</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Operator'>*</span><a href="wchar.c.html#LN747"><span class='Ref_to_Parameter'>to</span></a> <span class='Operator'>= *</span><a href="wchar.c.html#LN747"><span class='Ref_to_Parameter'>from</span></a><span class='Operator'>++ &LT;&LT; </span><span class='Number'>16</span><span class='Delimiter'>; 
</span>            <span class='Operator'>*</span><a href="wchar.c.html#LN747"><span class='Ref_to_Parameter'>to</span></a> <span class='Operator'>|= *</span><a href="wchar.c.html#LN747"><span class='Ref_to_Parameter'>from</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>            <a href="wchar.c.html#LN747"><span class='Ref_to_Parameter'>len</span></a> <span class='Operator'>-= </span><span class='Number'>2</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/mb/pg_wchar.h.html#LN149"><span class='Ref_to_Macro'>IS_LCPRV1</span></a><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="wchar.c.html#LN747"><span class='Ref_to_Parameter'>from</span></a><span class='Parentheses'>) </span><span class='Operator'>&& </span><a href="wchar.c.html#LN747"><span class='Ref_to_Parameter'>len</span></a> <span class='Operator'>&GT;= </span><span class='Number'>3</span><span class='Parentheses'>)</span> 
        <span class='Delimiter'>{ 
</span>            <a href="wchar.c.html#LN747"><span class='Ref_to_Parameter'>from</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>            <span class='Operator'>*</span><a href="wchar.c.html#LN747"><span class='Ref_to_Parameter'>to</span></a> <span class='Operator'>= *</span><a href="wchar.c.html#LN747"><span class='Ref_to_Parameter'>from</span></a><span class='Operator'>++ &LT;&LT; </span><span class='Number'>16</span><span class='Delimiter'>; 
</span>            <span class='Operator'>*</span><a href="wchar.c.html#LN747"><span class='Ref_to_Parameter'>to</span></a> <span class='Operator'>|= *</span><a href="wchar.c.html#LN747"><span class='Ref_to_Parameter'>from</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>            <a href="wchar.c.html#LN747"><span class='Ref_to_Parameter'>len</span></a> <span class='Operator'>-= </span><span class='Number'>3</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/mb/pg_wchar.h.html#LN141"><span class='Ref_to_Macro'>IS_LC2</span></a><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="wchar.c.html#LN747"><span class='Ref_to_Parameter'>from</span></a><span class='Parentheses'>) </span><span class='Operator'>&& </span><a href="wchar.c.html#LN747"><span class='Ref_to_Parameter'>len</span></a> <span class='Operator'>&GT;= </span><span class='Number'>3</span><span class='Parentheses'>)</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Operator'>*</span><a href="wchar.c.html#LN747"><span class='Ref_to_Parameter'>to</span></a> <span class='Operator'>= *</span><a href="wchar.c.html#LN747"><span class='Ref_to_Parameter'>from</span></a><span class='Operator'>++ &LT;&LT; </span><span class='Number'>16</span><span class='Delimiter'>; 
</span>            <span class='Operator'>*</span><a href="wchar.c.html#LN747"><span class='Ref_to_Parameter'>to</span></a> <span class='Operator'>|= *</span><a href="wchar.c.html#LN747"><span class='Ref_to_Parameter'>from</span></a><span class='Operator'>++ &LT;&LT; </span><span class='Number'>8</span><span class='Delimiter'>; 
</span>            <span class='Operator'>*</span><a href="wchar.c.html#LN747"><span class='Ref_to_Parameter'>to</span></a> <span class='Operator'>|= *</span><a href="wchar.c.html#LN747"><span class='Ref_to_Parameter'>from</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>            <a href="wchar.c.html#LN747"><span class='Ref_to_Parameter'>len</span></a> <span class='Operator'>-= </span><span class='Number'>3</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/mb/pg_wchar.h.html#LN161"><span class='Ref_to_Macro'>IS_LCPRV2</span></a><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="wchar.c.html#LN747"><span class='Ref_to_Parameter'>from</span></a><span class='Parentheses'>) </span><span class='Operator'>&& </span><a href="wchar.c.html#LN747"><span class='Ref_to_Parameter'>len</span></a> <span class='Operator'>&GT;= </span><span class='Number'>4</span><span class='Parentheses'>)</span> 
        <span class='Delimiter'>{ 
</span>            <a href="wchar.c.html#LN747"><span class='Ref_to_Parameter'>from</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>            <span class='Operator'>*</span><a href="wchar.c.html#LN747"><span class='Ref_to_Parameter'>to</span></a> <span class='Operator'>= *</span><a href="wchar.c.html#LN747"><span class='Ref_to_Parameter'>from</span></a><span class='Operator'>++ &LT;&LT; </span><span class='Number'>16</span><span class='Delimiter'>; 
</span>            <span class='Operator'>*</span><a href="wchar.c.html#LN747"><span class='Ref_to_Parameter'>to</span></a> <span class='Operator'>|= *</span><a href="wchar.c.html#LN747"><span class='Ref_to_Parameter'>from</span></a><span class='Operator'>++ &LT;&LT; </span><span class='Number'>8</span><span class='Delimiter'>; 
</span>            <span class='Operator'>*</span><a href="wchar.c.html#LN747"><span class='Ref_to_Parameter'>to</span></a> <span class='Operator'>|= *</span><a href="wchar.c.html#LN747"><span class='Ref_to_Parameter'>from</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>            <a href="wchar.c.html#LN747"><span class='Ref_to_Parameter'>len</span></a> <span class='Operator'>-= </span><span class='Number'>4</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> 
        <span class='Delimiter'>{</span>                       <span class='Comment_Single_Line'>/* assume ASCII */ 
</span>            <span class='Operator'>*</span><a href="wchar.c.html#LN747"><span class='Ref_to_Parameter'>to</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Keyword'>unsigned char</span><span class='Parentheses'>) </span><span class='Operator'>*</span><a href="wchar.c.html#LN747"><span class='Ref_to_Parameter'>from</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>            <a href="wchar.c.html#LN747"><span class='Ref_to_Parameter'>len</span></a><span class='Operator'>--</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <a href="wchar.c.html#LN747"><span class='Ref_to_Parameter'>to</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>        <a href="wchar.c.html#LN749"><span class='Ref_To_Local'>cnt</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end while len&GT;0&&*from &raquo; </span> 
    <span class='Operator'>*</span><a href="wchar.c.html#LN747"><span class='Ref_to_Parameter'>to</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <a href="wchar.c.html#LN749"><span class='Ref_To_Local'>cnt</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end pg_mule2wchar_with_len &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * convert pg_wchar to mule internal code 
 * caller should allocate enough space for "to" 
 * len: length of from. 
 * "from" not necessarily null terminated. 
 */ 
</span><span class='Keyword'>static int 
</span><a name="LN800"></a><span class='Declare_Function'>pg_wchar2mule_with_len</span><span class='Parentheses'>(</span><span class='Keyword'>const </span><a href="../../../include/mb/pg_wchar.h.html#LN24"><span class='Ref_to_Typedef'>pg_wchar</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>from</span><span class='Delimiter'>, </span><span class='Keyword'>unsigned char </span><span class='Operator'>*</span><span class='Declare_Parameter'>to</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>len</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN802"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>cnt</span> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>while</span> <span class='Parentheses'>(</span><a href="wchar.c.html#LN800"><span class='Ref_to_Parameter'>len</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span> <span class='Operator'>&& *</span><a href="wchar.c.html#LN800"><span class='Ref_to_Parameter'>from</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN806"></a>        <span class='Keyword'>unsigned char </span><span class='Declare_Local'>lb</span><span class='Delimiter'>; 
</span> 
        <a href="wchar.c.html#LN806"><span class='Ref_To_Local'>lb</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="wchar.c.html#LN800"><span class='Ref_to_Parameter'>from</span></a> <span class='Operator'>&GT;&GT; </span><span class='Number'>16</span><span class='Parentheses'>) </span><span class='Operator'>& </span><span class='Number'>0xff</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/mb/pg_wchar.h.html#LN122"><span class='Ref_to_Macro'>IS_LC1</span></a><span class='Parentheses'>(</span><a href="wchar.c.html#LN806"><span class='Ref_To_Local'>lb</span></a><span class='Parentheses'>))</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Operator'>*</span><a href="wchar.c.html#LN800"><span class='Ref_to_Parameter'>to</span></a><span class='Operator'>++ = </span><a href="wchar.c.html#LN806"><span class='Ref_To_Local'>lb</span></a><span class='Delimiter'>; 
</span>            <span class='Operator'>*</span><a href="wchar.c.html#LN800"><span class='Ref_to_Parameter'>to</span></a><span class='Operator'>++ = *</span><a href="wchar.c.html#LN800"><span class='Ref_to_Parameter'>from</span></a> <span class='Operator'>& </span><span class='Number'>0xff</span><span class='Delimiter'>; 
</span>            <a href="wchar.c.html#LN802"><span class='Ref_To_Local'>cnt</span></a> <span class='Operator'>+= </span><span class='Number'>2</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/mb/pg_wchar.h.html#LN141"><span class='Ref_to_Macro'>IS_LC2</span></a><span class='Parentheses'>(</span><a href="wchar.c.html#LN806"><span class='Ref_To_Local'>lb</span></a><span class='Parentheses'>))</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Operator'>*</span><a href="wchar.c.html#LN800"><span class='Ref_to_Parameter'>to</span></a><span class='Operator'>++ = </span><a href="wchar.c.html#LN806"><span class='Ref_To_Local'>lb</span></a><span class='Delimiter'>; 
</span>            <span class='Operator'>*</span><a href="wchar.c.html#LN800"><span class='Ref_to_Parameter'>to</span></a><span class='Operator'>++ = </span><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="wchar.c.html#LN800"><span class='Ref_to_Parameter'>from</span></a> <span class='Operator'>&GT;&GT; </span><span class='Number'>8</span><span class='Parentheses'>) </span><span class='Operator'>& </span><span class='Number'>0xff</span><span class='Delimiter'>; 
</span>            <span class='Operator'>*</span><a href="wchar.c.html#LN800"><span class='Ref_to_Parameter'>to</span></a><span class='Operator'>++ = *</span><a href="wchar.c.html#LN800"><span class='Ref_to_Parameter'>from</span></a> <span class='Operator'>& </span><span class='Number'>0xff</span><span class='Delimiter'>; 
</span>            <a href="wchar.c.html#LN802"><span class='Ref_To_Local'>cnt</span></a> <span class='Operator'>+= </span><span class='Number'>3</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/mb/pg_wchar.h.html#LN150"><span class='Ref_to_Macro'>IS_LCPRV1_A_RANGE</span></a><span class='Parentheses'>(</span><a href="wchar.c.html#LN806"><span class='Ref_To_Local'>lb</span></a><span class='Parentheses'>))</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Operator'>*</span><a href="wchar.c.html#LN800"><span class='Ref_to_Parameter'>to</span></a><span class='Operator'>++ = </span><a href="../../../include/mb/pg_wchar.h.html#LN147"><span class='Ref_to_Const'>LCPRV1_A</span></a><span class='Delimiter'>; 
</span>            <span class='Operator'>*</span><a href="wchar.c.html#LN800"><span class='Ref_to_Parameter'>to</span></a><span class='Operator'>++ = </span><a href="wchar.c.html#LN806"><span class='Ref_To_Local'>lb</span></a><span class='Delimiter'>; 
</span>            <span class='Operator'>*</span><a href="wchar.c.html#LN800"><span class='Ref_to_Parameter'>to</span></a><span class='Operator'>++ = *</span><a href="wchar.c.html#LN800"><span class='Ref_to_Parameter'>from</span></a> <span class='Operator'>& </span><span class='Number'>0xff</span><span class='Delimiter'>; 
</span>            <a href="wchar.c.html#LN802"><span class='Ref_To_Local'>cnt</span></a> <span class='Operator'>+= </span><span class='Number'>3</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/mb/pg_wchar.h.html#LN152"><span class='Ref_to_Macro'>IS_LCPRV1_B_RANGE</span></a><span class='Parentheses'>(</span><a href="wchar.c.html#LN806"><span class='Ref_To_Local'>lb</span></a><span class='Parentheses'>))</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Operator'>*</span><a href="wchar.c.html#LN800"><span class='Ref_to_Parameter'>to</span></a><span class='Operator'>++ = </span><a href="../../../include/mb/pg_wchar.h.html#LN148"><span class='Ref_to_Const'>LCPRV1_B</span></a><span class='Delimiter'>; 
</span>            <span class='Operator'>*</span><a href="wchar.c.html#LN800"><span class='Ref_to_Parameter'>to</span></a><span class='Operator'>++ = </span><a href="wchar.c.html#LN806"><span class='Ref_To_Local'>lb</span></a><span class='Delimiter'>; 
</span>            <span class='Operator'>*</span><a href="wchar.c.html#LN800"><span class='Ref_to_Parameter'>to</span></a><span class='Operator'>++ = *</span><a href="wchar.c.html#LN800"><span class='Ref_to_Parameter'>from</span></a> <span class='Operator'>& </span><span class='Number'>0xff</span><span class='Delimiter'>; 
</span>            <a href="wchar.c.html#LN802"><span class='Ref_To_Local'>cnt</span></a> <span class='Operator'>+= </span><span class='Number'>3</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/mb/pg_wchar.h.html#LN162"><span class='Ref_to_Macro'>IS_LCPRV2_A_RANGE</span></a><span class='Parentheses'>(</span><a href="wchar.c.html#LN806"><span class='Ref_To_Local'>lb</span></a><span class='Parentheses'>))</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Operator'>*</span><a href="wchar.c.html#LN800"><span class='Ref_to_Parameter'>to</span></a><span class='Operator'>++ = </span><a href="../../../include/mb/pg_wchar.h.html#LN159"><span class='Ref_to_Const'>LCPRV2_A</span></a><span class='Delimiter'>; 
</span>            <span class='Operator'>*</span><a href="wchar.c.html#LN800"><span class='Ref_to_Parameter'>to</span></a><span class='Operator'>++ = </span><a href="wchar.c.html#LN806"><span class='Ref_To_Local'>lb</span></a><span class='Delimiter'>; 
</span>            <span class='Operator'>*</span><a href="wchar.c.html#LN800"><span class='Ref_to_Parameter'>to</span></a><span class='Operator'>++ = </span><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="wchar.c.html#LN800"><span class='Ref_to_Parameter'>from</span></a> <span class='Operator'>&GT;&GT; </span><span class='Number'>8</span><span class='Parentheses'>) </span><span class='Operator'>& </span><span class='Number'>0xff</span><span class='Delimiter'>; 
</span>            <span class='Operator'>*</span><a href="wchar.c.html#LN800"><span class='Ref_to_Parameter'>to</span></a><span class='Operator'>++ = *</span><a href="wchar.c.html#LN800"><span class='Ref_to_Parameter'>from</span></a> <span class='Operator'>& </span><span class='Number'>0xff</span><span class='Delimiter'>; 
</span>            <a href="wchar.c.html#LN802"><span class='Ref_To_Local'>cnt</span></a> <span class='Operator'>+= </span><span class='Number'>4</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/mb/pg_wchar.h.html#LN164"><span class='Ref_to_Macro'>IS_LCPRV2_B_RANGE</span></a><span class='Parentheses'>(</span><a href="wchar.c.html#LN806"><span class='Ref_To_Local'>lb</span></a><span class='Parentheses'>))</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Operator'>*</span><a href="wchar.c.html#LN800"><span class='Ref_to_Parameter'>to</span></a><span class='Operator'>++ = </span><a href="../../../include/mb/pg_wchar.h.html#LN160"><span class='Ref_to_Const'>LCPRV2_B</span></a><span class='Delimiter'>; 
</span>            <span class='Operator'>*</span><a href="wchar.c.html#LN800"><span class='Ref_to_Parameter'>to</span></a><span class='Operator'>++ = </span><a href="wchar.c.html#LN806"><span class='Ref_To_Local'>lb</span></a><span class='Delimiter'>; 
</span>            <span class='Operator'>*</span><a href="wchar.c.html#LN800"><span class='Ref_to_Parameter'>to</span></a><span class='Operator'>++ = </span><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="wchar.c.html#LN800"><span class='Ref_to_Parameter'>from</span></a> <span class='Operator'>&GT;&GT; </span><span class='Number'>8</span><span class='Parentheses'>) </span><span class='Operator'>& </span><span class='Number'>0xff</span><span class='Delimiter'>; 
</span>            <span class='Operator'>*</span><a href="wchar.c.html#LN800"><span class='Ref_to_Parameter'>to</span></a><span class='Operator'>++ = *</span><a href="wchar.c.html#LN800"><span class='Ref_to_Parameter'>from</span></a> <span class='Operator'>& </span><span class='Number'>0xff</span><span class='Delimiter'>; 
</span>            <a href="wchar.c.html#LN802"><span class='Ref_To_Local'>cnt</span></a> <span class='Operator'>+= </span><span class='Number'>4</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Operator'>*</span><a href="wchar.c.html#LN800"><span class='Ref_to_Parameter'>to</span></a><span class='Operator'>++ = *</span><a href="wchar.c.html#LN800"><span class='Ref_to_Parameter'>from</span></a> <span class='Operator'>& </span><span class='Number'>0xff</span><span class='Delimiter'>; 
</span>            <a href="wchar.c.html#LN802"><span class='Ref_To_Local'>cnt</span></a> <span class='Operator'>+= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <a href="wchar.c.html#LN800"><span class='Ref_to_Parameter'>from</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>        <a href="wchar.c.html#LN800"><span class='Ref_to_Parameter'>len</span></a><span class='Operator'>--</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end while len&GT;0&&*from &raquo; </span> 
    <span class='Operator'>*</span><a href="wchar.c.html#LN800"><span class='Ref_to_Parameter'>to</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <a href="wchar.c.html#LN802"><span class='Ref_To_Local'>cnt</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end pg_wchar2mule_with_len &raquo; </span> 
 
<span class='Keyword'>int 
</span><a name="LN865"></a><span class='Declare_Function'>pg_mule_mblen</span><span class='Parentheses'>(</span><span class='Keyword'>const unsigned char </span><span class='Operator'>*</span><span class='Declare_Parameter'>s</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN867"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>len</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/mb/pg_wchar.h.html#LN122"><span class='Ref_to_Macro'>IS_LC1</span></a><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="wchar.c.html#LN865"><span class='Ref_to_Parameter'>s</span></a><span class='Parentheses'>))</span> 
        <a href="wchar.c.html#LN867"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>= </span><span class='Number'>2</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/mb/pg_wchar.h.html#LN149"><span class='Ref_to_Macro'>IS_LCPRV1</span></a><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="wchar.c.html#LN865"><span class='Ref_to_Parameter'>s</span></a><span class='Parentheses'>))</span> 
        <a href="wchar.c.html#LN867"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>= </span><span class='Number'>3</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/mb/pg_wchar.h.html#LN141"><span class='Ref_to_Macro'>IS_LC2</span></a><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="wchar.c.html#LN865"><span class='Ref_to_Parameter'>s</span></a><span class='Parentheses'>))</span> 
        <a href="wchar.c.html#LN867"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>= </span><span class='Number'>3</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/mb/pg_wchar.h.html#LN161"><span class='Ref_to_Macro'>IS_LCPRV2</span></a><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="wchar.c.html#LN865"><span class='Ref_to_Parameter'>s</span></a><span class='Parentheses'>))</span> 
        <a href="wchar.c.html#LN867"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>= </span><span class='Number'>4</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
        <a href="wchar.c.html#LN867"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>;</span>                <span class='Comment_Single_Line'>/* assume ASCII */ 
</span>    <span class='Control'>return</span> <a href="wchar.c.html#LN867"><span class='Ref_To_Local'>len</span></a><span class='Delimiter'>; 
} 
</span> 
<span class='Keyword'>static int 
</span><a name="LN883"></a><span class='Declare_Function'>pg_mule_dsplen</span><span class='Parentheses'>(</span><span class='Keyword'>const unsigned char </span><span class='Operator'>*</span><span class='Declare_Parameter'>s</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN885"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>len</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Note: it's not really appropriate to assume that all multibyte charsets 
     * are double-wide on screen.  But this seems an okay approximation for 
     * the MULE charsets we currently support. 
     */ 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/mb/pg_wchar.h.html#LN122"><span class='Ref_to_Macro'>IS_LC1</span></a><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="wchar.c.html#LN883"><span class='Ref_to_Parameter'>s</span></a><span class='Parentheses'>))</span> 
        <a href="wchar.c.html#LN885"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/mb/pg_wchar.h.html#LN149"><span class='Ref_to_Macro'>IS_LCPRV1</span></a><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="wchar.c.html#LN883"><span class='Ref_to_Parameter'>s</span></a><span class='Parentheses'>))</span> 
        <a href="wchar.c.html#LN885"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/mb/pg_wchar.h.html#LN141"><span class='Ref_to_Macro'>IS_LC2</span></a><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="wchar.c.html#LN883"><span class='Ref_to_Parameter'>s</span></a><span class='Parentheses'>))</span> 
        <a href="wchar.c.html#LN885"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>= </span><span class='Number'>2</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/mb/pg_wchar.h.html#LN161"><span class='Ref_to_Macro'>IS_LCPRV2</span></a><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="wchar.c.html#LN883"><span class='Ref_to_Parameter'>s</span></a><span class='Parentheses'>))</span> 
        <a href="wchar.c.html#LN885"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>= </span><span class='Number'>2</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
        <a href="wchar.c.html#LN885"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>;</span>                <span class='Comment_Single_Line'>/* assume ASCII */ 
</span> 
    <span class='Control'>return</span> <a href="wchar.c.html#LN885"><span class='Ref_To_Local'>len</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end pg_mule_dsplen &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * ISO8859-1 
 */ 
</span><span class='Keyword'>static int 
</span><a name="LN911"></a><span class='Declare_Function'>pg_latin12wchar_with_len</span><span class='Parentheses'>(</span><span class='Keyword'>const unsigned char </span><span class='Operator'>*</span><span class='Declare_Parameter'>from</span><span class='Delimiter'>, </span><a href="../../../include/mb/pg_wchar.h.html#LN24"><span class='Ref_to_Typedef'>pg_wchar</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>to</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>len</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN913"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>cnt</span> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>while</span> <span class='Parentheses'>(</span><a href="wchar.c.html#LN911"><span class='Ref_to_Parameter'>len</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span> <span class='Operator'>&& *</span><a href="wchar.c.html#LN911"><span class='Ref_to_Parameter'>from</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Operator'>*</span><a href="wchar.c.html#LN911"><span class='Ref_to_Parameter'>to</span></a><span class='Operator'>++ = *</span><a href="wchar.c.html#LN911"><span class='Ref_to_Parameter'>from</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>        <a href="wchar.c.html#LN911"><span class='Ref_to_Parameter'>len</span></a><span class='Operator'>--</span><span class='Delimiter'>; 
</span>        <a href="wchar.c.html#LN913"><span class='Ref_To_Local'>cnt</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Operator'>*</span><a href="wchar.c.html#LN911"><span class='Ref_to_Parameter'>to</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <a href="wchar.c.html#LN913"><span class='Ref_To_Local'>cnt</span></a><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * Trivial conversion from pg_wchar to single byte encoding. Just ignores 
 * high bits. 
 * caller should allocate enough space for "to" 
 * len: length of from. 
 * "from" not necessarily null terminated. 
 */ 
</span><span class='Keyword'>static int 
</span><a name="LN933"></a><span class='Declare_Function'>pg_wchar2single_with_len</span><span class='Parentheses'>(</span><span class='Keyword'>const </span><a href="../../../include/mb/pg_wchar.h.html#LN24"><span class='Ref_to_Typedef'>pg_wchar</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>from</span><span class='Delimiter'>, </span><span class='Keyword'>unsigned char </span><span class='Operator'>*</span><span class='Declare_Parameter'>to</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>len</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN935"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>cnt</span> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>while</span> <span class='Parentheses'>(</span><a href="wchar.c.html#LN933"><span class='Ref_to_Parameter'>len</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span> <span class='Operator'>&& *</span><a href="wchar.c.html#LN933"><span class='Ref_to_Parameter'>from</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Operator'>*</span><a href="wchar.c.html#LN933"><span class='Ref_to_Parameter'>to</span></a><span class='Operator'>++ = *</span><a href="wchar.c.html#LN933"><span class='Ref_to_Parameter'>from</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>        <a href="wchar.c.html#LN933"><span class='Ref_to_Parameter'>len</span></a><span class='Operator'>--</span><span class='Delimiter'>; 
</span>        <a href="wchar.c.html#LN935"><span class='Ref_To_Local'>cnt</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Operator'>*</span><a href="wchar.c.html#LN933"><span class='Ref_to_Parameter'>to</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <a href="wchar.c.html#LN935"><span class='Ref_To_Local'>cnt</span></a><span class='Delimiter'>; 
} 
</span> 
<span class='Keyword'>static int 
</span><a name="LN948"></a><span class='Declare_Function'>pg_latin1_mblen</span><span class='Parentheses'>(</span><span class='Keyword'>const unsigned char </span><span class='Operator'>*</span><span class='Declare_Parameter'>s</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>return</span> <span class='Number'>1</span><span class='Delimiter'>; 
} 
</span> 
<span class='Keyword'>static int 
</span><a name="LN954"></a><span class='Declare_Function'>pg_latin1_dsplen</span><span class='Parentheses'>(</span><span class='Keyword'>const unsigned char </span><span class='Operator'>*</span><span class='Declare_Parameter'>s</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>return</span> <a href="wchar.c.html#LN59"><span class='Ref_to_Func'>pg_ascii_dsplen</span></a><span class='Parentheses'>(</span><a href="wchar.c.html#LN954"><span class='Ref_to_Parameter'>s</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * SJIS 
 */ 
</span><span class='Keyword'>static int 
</span><a name="LN963"></a><span class='Declare_Function'>pg_sjis_mblen</span><span class='Parentheses'>(</span><span class='Keyword'>const unsigned char </span><span class='Operator'>*</span><span class='Declare_Parameter'>s</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN965"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>len</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="wchar.c.html#LN963"><span class='Ref_to_Parameter'>s</span></a> <span class='Operator'>&GT;= </span><span class='Number'>0xa1</span> <span class='Operator'>&& *</span><a href="wchar.c.html#LN963"><span class='Ref_to_Parameter'>s</span></a> <span class='Operator'>&LT;= </span><span class='Number'>0xdf</span><span class='Parentheses'>) 
</span>        <a href="wchar.c.html#LN965"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>;</span>                <span class='Comment_Single_Line'>/* 1 byte kana? */ 
</span>    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/c.h.html#LN972"><span class='Ref_to_Macro'>IS_HIGHBIT_SET</span></a><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="wchar.c.html#LN963"><span class='Ref_to_Parameter'>s</span></a><span class='Parentheses'>))</span> 
        <a href="wchar.c.html#LN965"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>= </span><span class='Number'>2</span><span class='Delimiter'>;</span>                <span class='Comment_Single_Line'>/* kanji? */ 
</span>    <span class='Control'>else</span> 
        <a href="wchar.c.html#LN965"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>;</span>                <span class='Comment_Single_Line'>/* should be ASCII */ 
</span>    <span class='Control'>return</span> <a href="wchar.c.html#LN965"><span class='Ref_To_Local'>len</span></a><span class='Delimiter'>; 
} 
</span> 
<span class='Keyword'>static int 
</span><a name="LN977"></a><span class='Declare_Function'>pg_sjis_dsplen</span><span class='Parentheses'>(</span><span class='Keyword'>const unsigned char </span><span class='Operator'>*</span><span class='Declare_Parameter'>s</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN979"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>len</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="wchar.c.html#LN977"><span class='Ref_to_Parameter'>s</span></a> <span class='Operator'>&GT;= </span><span class='Number'>0xa1</span> <span class='Operator'>&& *</span><a href="wchar.c.html#LN977"><span class='Ref_to_Parameter'>s</span></a> <span class='Operator'>&LT;= </span><span class='Number'>0xdf</span><span class='Parentheses'>) 
</span>        <a href="wchar.c.html#LN979"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>;</span>                <span class='Comment_Single_Line'>/* 1 byte kana? */ 
</span>    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/c.h.html#LN972"><span class='Ref_to_Macro'>IS_HIGHBIT_SET</span></a><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="wchar.c.html#LN977"><span class='Ref_to_Parameter'>s</span></a><span class='Parentheses'>))</span> 
        <a href="wchar.c.html#LN979"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>= </span><span class='Number'>2</span><span class='Delimiter'>;</span>                <span class='Comment_Single_Line'>/* kanji? */ 
</span>    <span class='Control'>else</span> 
        <a href="wchar.c.html#LN979"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>= </span><a href="wchar.c.html#LN59"><span class='Ref_to_Func'>pg_ascii_dsplen</span></a><span class='Parentheses'>(</span><a href="wchar.c.html#LN977"><span class='Ref_to_Parameter'>s</span></a><span class='Parentheses'>)</span><span class='Delimiter'>;</span>       <span class='Comment_Single_Line'>/* should be ASCII */ 
</span>    <span class='Control'>return</span> <a href="wchar.c.html#LN979"><span class='Ref_To_Local'>len</span></a><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * Big5 
 */ 
</span><span class='Keyword'>static int 
</span><a name="LN994"></a><span class='Declare_Function'>pg_big5_mblen</span><span class='Parentheses'>(</span><span class='Keyword'>const unsigned char </span><span class='Operator'>*</span><span class='Declare_Parameter'>s</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN996"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>len</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/c.h.html#LN972"><span class='Ref_to_Macro'>IS_HIGHBIT_SET</span></a><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="wchar.c.html#LN994"><span class='Ref_to_Parameter'>s</span></a><span class='Parentheses'>))</span> 
        <a href="wchar.c.html#LN996"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>= </span><span class='Number'>2</span><span class='Delimiter'>;</span>                <span class='Comment_Single_Line'>/* kanji? */ 
</span>    <span class='Control'>else</span> 
        <a href="wchar.c.html#LN996"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>;</span>                <span class='Comment_Single_Line'>/* should be ASCII */ 
</span>    <span class='Control'>return</span> <a href="wchar.c.html#LN996"><span class='Ref_To_Local'>len</span></a><span class='Delimiter'>; 
} 
</span> 
<span class='Keyword'>static int 
</span><a name="LN1006"></a><span class='Declare_Function'>pg_big5_dsplen</span><span class='Parentheses'>(</span><span class='Keyword'>const unsigned char </span><span class='Operator'>*</span><span class='Declare_Parameter'>s</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1008"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>len</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/c.h.html#LN972"><span class='Ref_to_Macro'>IS_HIGHBIT_SET</span></a><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="wchar.c.html#LN1006"><span class='Ref_to_Parameter'>s</span></a><span class='Parentheses'>))</span> 
        <a href="wchar.c.html#LN1008"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>= </span><span class='Number'>2</span><span class='Delimiter'>;</span>                <span class='Comment_Single_Line'>/* kanji? */ 
</span>    <span class='Control'>else</span> 
        <a href="wchar.c.html#LN1008"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>= </span><a href="wchar.c.html#LN59"><span class='Ref_to_Func'>pg_ascii_dsplen</span></a><span class='Parentheses'>(</span><a href="wchar.c.html#LN1006"><span class='Ref_to_Parameter'>s</span></a><span class='Parentheses'>)</span><span class='Delimiter'>;</span>       <span class='Comment_Single_Line'>/* should be ASCII */ 
</span>    <span class='Control'>return</span> <a href="wchar.c.html#LN1008"><span class='Ref_To_Local'>len</span></a><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * GBK 
 */ 
</span><span class='Keyword'>static int 
</span><a name="LN1021"></a><span class='Declare_Function'>pg_gbk_mblen</span><span class='Parentheses'>(</span><span class='Keyword'>const unsigned char </span><span class='Operator'>*</span><span class='Declare_Parameter'>s</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1023"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>len</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/c.h.html#LN972"><span class='Ref_to_Macro'>IS_HIGHBIT_SET</span></a><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="wchar.c.html#LN1021"><span class='Ref_to_Parameter'>s</span></a><span class='Parentheses'>))</span> 
        <a href="wchar.c.html#LN1023"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>= </span><span class='Number'>2</span><span class='Delimiter'>;</span>                <span class='Comment_Single_Line'>/* kanji? */ 
</span>    <span class='Control'>else</span> 
        <a href="wchar.c.html#LN1023"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>;</span>                <span class='Comment_Single_Line'>/* should be ASCII */ 
</span>    <span class='Control'>return</span> <a href="wchar.c.html#LN1023"><span class='Ref_To_Local'>len</span></a><span class='Delimiter'>; 
} 
</span> 
<span class='Keyword'>static int 
</span><a name="LN1033"></a><span class='Declare_Function'>pg_gbk_dsplen</span><span class='Parentheses'>(</span><span class='Keyword'>const unsigned char </span><span class='Operator'>*</span><span class='Declare_Parameter'>s</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1035"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>len</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/c.h.html#LN972"><span class='Ref_to_Macro'>IS_HIGHBIT_SET</span></a><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="wchar.c.html#LN1033"><span class='Ref_to_Parameter'>s</span></a><span class='Parentheses'>))</span> 
        <a href="wchar.c.html#LN1035"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>= </span><span class='Number'>2</span><span class='Delimiter'>;</span>                <span class='Comment_Single_Line'>/* kanji? */ 
</span>    <span class='Control'>else</span> 
        <a href="wchar.c.html#LN1035"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>= </span><a href="wchar.c.html#LN59"><span class='Ref_to_Func'>pg_ascii_dsplen</span></a><span class='Parentheses'>(</span><a href="wchar.c.html#LN1033"><span class='Ref_to_Parameter'>s</span></a><span class='Parentheses'>)</span><span class='Delimiter'>;</span>       <span class='Comment_Single_Line'>/* should be ASCII */ 
</span>    <span class='Control'>return</span> <a href="wchar.c.html#LN1035"><span class='Ref_To_Local'>len</span></a><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * UHC 
 */ 
</span><span class='Keyword'>static int 
</span><a name="LN1048"></a><span class='Declare_Function'>pg_uhc_mblen</span><span class='Parentheses'>(</span><span class='Keyword'>const unsigned char </span><span class='Operator'>*</span><span class='Declare_Parameter'>s</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1050"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>len</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/c.h.html#LN972"><span class='Ref_to_Macro'>IS_HIGHBIT_SET</span></a><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="wchar.c.html#LN1048"><span class='Ref_to_Parameter'>s</span></a><span class='Parentheses'>))</span> 
        <a href="wchar.c.html#LN1050"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>= </span><span class='Number'>2</span><span class='Delimiter'>;</span>                <span class='Comment_Single_Line'>/* 2byte? */ 
</span>    <span class='Control'>else</span> 
        <a href="wchar.c.html#LN1050"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>;</span>                <span class='Comment_Single_Line'>/* should be ASCII */ 
</span>    <span class='Control'>return</span> <a href="wchar.c.html#LN1050"><span class='Ref_To_Local'>len</span></a><span class='Delimiter'>; 
} 
</span> 
<span class='Keyword'>static int 
</span><a name="LN1060"></a><span class='Declare_Function'>pg_uhc_dsplen</span><span class='Parentheses'>(</span><span class='Keyword'>const unsigned char </span><span class='Operator'>*</span><span class='Declare_Parameter'>s</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1062"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>len</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/c.h.html#LN972"><span class='Ref_to_Macro'>IS_HIGHBIT_SET</span></a><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="wchar.c.html#LN1060"><span class='Ref_to_Parameter'>s</span></a><span class='Parentheses'>))</span> 
        <a href="wchar.c.html#LN1062"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>= </span><span class='Number'>2</span><span class='Delimiter'>;</span>                <span class='Comment_Single_Line'>/* 2byte? */ 
</span>    <span class='Control'>else</span> 
        <a href="wchar.c.html#LN1062"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>= </span><a href="wchar.c.html#LN59"><span class='Ref_to_Func'>pg_ascii_dsplen</span></a><span class='Parentheses'>(</span><a href="wchar.c.html#LN1060"><span class='Ref_to_Parameter'>s</span></a><span class='Parentheses'>)</span><span class='Delimiter'>;</span>       <span class='Comment_Single_Line'>/* should be ASCII */ 
</span>    <span class='Control'>return</span> <a href="wchar.c.html#LN1062"><span class='Ref_To_Local'>len</span></a><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * GB18030 
 *  Added by Bill Huang &LT;bhuang@redhat.com&GT;,&LT;bill_huanghb@ybb.ne.jp&GT; 
 */ 
</span><span class='Keyword'>static int 
</span><a name="LN1076"></a><span class='Declare_Function'>pg_gb18030_mblen</span><span class='Parentheses'>(</span><span class='Keyword'>const unsigned char </span><span class='Operator'>*</span><span class='Declare_Parameter'>s</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1078"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>len</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../../include/c.h.html#LN972"><span class='Ref_to_Macro'>IS_HIGHBIT_SET</span></a><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="wchar.c.html#LN1076"><span class='Ref_to_Parameter'>s</span></a><span class='Parentheses'>))</span> 
        <a href="wchar.c.html#LN1078"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>;</span>                <span class='Comment_Single_Line'>/* ASCII */ 
</span>    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><span class='Parentheses'>(</span><a href="wchar.c.html#LN1076"><span class='Ref_to_Parameter'>s</span></a> <span class='Operator'>+ </span><span class='Number'>1</span><span class='Parentheses'>) </span><span class='Operator'>&GT;= </span><span class='Number'>0x30</span> <span class='Operator'>&& *</span><span class='Parentheses'>(</span><a href="wchar.c.html#LN1076"><span class='Ref_to_Parameter'>s</span></a> <span class='Operator'>+ </span><span class='Number'>1</span><span class='Parentheses'>) </span><span class='Operator'>&LT;= </span><span class='Number'>0x39</span><span class='Parentheses'>)</span> 
        <a href="wchar.c.html#LN1078"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>= </span><span class='Number'>4</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
        <a href="wchar.c.html#LN1078"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>= </span><span class='Number'>2</span><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <a href="wchar.c.html#LN1078"><span class='Ref_To_Local'>len</span></a><span class='Delimiter'>; 
} 
</span> 
<span class='Keyword'>static int 
</span><a name="LN1090"></a><span class='Declare_Function'>pg_gb18030_dsplen</span><span class='Parentheses'>(</span><span class='Keyword'>const unsigned char </span><span class='Operator'>*</span><span class='Declare_Parameter'>s</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1092"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>len</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/c.h.html#LN972"><span class='Ref_to_Macro'>IS_HIGHBIT_SET</span></a><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="wchar.c.html#LN1090"><span class='Ref_to_Parameter'>s</span></a><span class='Parentheses'>))</span> 
        <a href="wchar.c.html#LN1092"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>= </span><span class='Number'>2</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
        <a href="wchar.c.html#LN1092"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>= </span><a href="wchar.c.html#LN59"><span class='Ref_to_Func'>pg_ascii_dsplen</span></a><span class='Parentheses'>(</span><a href="wchar.c.html#LN1090"><span class='Ref_to_Parameter'>s</span></a><span class='Parentheses'>)</span><span class='Delimiter'>;</span>       <span class='Comment_Single_Line'>/* ASCII */ 
</span>    <span class='Control'>return</span> <a href="wchar.c.html#LN1092"><span class='Ref_To_Local'>len</span></a><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 *------------------------------------------------------------------- 
 * multibyte sequence validators 
 * 
 * These functions accept "s", a pointer to the first byte of a string, 
 * and "len", the remaining length of the string.  If there is a validly 
 * encoded character beginning at *s, return its length in bytes; else 
 * return -1. 
 * 
 * The functions can assume that len &GT; 0 and that *s != '\0', but they must 
 * test for and reject zeroes in any additional bytes of a multibyte character. 
 * 
 * Note that this definition allows the function for a single-byte 
 * encoding to be just "return 1". 
 *------------------------------------------------------------------- 
 */ 
</span> 
<span class='Keyword'>static int 
</span><a name="LN1119"></a><span class='Declare_Function'>pg_ascii_verifier</span><span class='Parentheses'>(</span><span class='Keyword'>const unsigned char </span><span class='Operator'>*</span><span class='Declare_Parameter'>s</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>len</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>return</span> <span class='Number'>1</span><span class='Delimiter'>; 
} 
</span> 
<a name="LN1124"></a><span class='Keyword'>#define </span><span class='Declare_Macro'>IS_EUC_RANGE_VALID</span><span class='Parentheses'>(</span><span class='Declare_Parameter'>c</span><span class='Parentheses'>)</span>   <span class='Parentheses'>((</span><a href="wchar.c.html#LN1124"><span class='Ref_to_Parameter'>c</span></a><span class='Parentheses'>) </span><span class='Operator'>&GT;= </span><span class='Number'>0xa1</span> <span class='Operator'>&& </span><span class='Parentheses'>(</span><a href="wchar.c.html#LN1124"><span class='Ref_to_Parameter'>c</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT;= </span><span class='Number'>0xfe</span><span class='Parentheses'>)</span> 
 
<span class='Keyword'>static int 
</span><a name="LN1127"></a><span class='Declare_Function'>pg_eucjp_verifier</span><span class='Parentheses'>(</span><span class='Keyword'>const unsigned char </span><span class='Operator'>*</span><span class='Declare_Parameter'>s</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>len</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1129"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>l</span><span class='Delimiter'>; 
</span><a name="LN1130"></a>    <span class='Keyword'>unsigned char </span><span class='Declare_Local'>c1</span><span class='Delimiter'>, 
</span><a name="LN1131"></a>                <span class='Declare_Local'>c2</span><span class='Delimiter'>; 
</span> 
    <a href="wchar.c.html#LN1130"><span class='Ref_To_Local'>c1</span></a> <span class='Operator'>= *</span><a href="wchar.c.html#LN1127"><span class='Ref_to_Parameter'>s</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>switch</span> <span class='Parentheses'>(</span><a href="wchar.c.html#LN1130"><span class='Ref_To_Local'>c1</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>case</span> <a href="../../../include/mb/pg_wchar.h.html#LN34"><span class='Ref_to_Const'>SS2</span></a><span class='Operator'>:</span>               <span class='Comment_Single_Line'>/* JIS X 0201 */ 
</span>            <a href="wchar.c.html#LN1129"><span class='Ref_To_Local'>l</span></a> <span class='Operator'>= </span><span class='Number'>2</span><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="wchar.c.html#LN1129"><span class='Ref_To_Local'>l</span></a> <span class='Operator'>&GT; </span><a href="wchar.c.html#LN1127"><span class='Ref_to_Parameter'>len</span></a><span class='Parentheses'>) 
</span>                <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>            <a href="wchar.c.html#LN1131"><span class='Ref_To_Local'>c2</span></a> <span class='Operator'>= *</span><a href="wchar.c.html#LN1127"><span class='Ref_to_Parameter'>s</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="wchar.c.html#LN1131"><span class='Ref_To_Local'>c2</span></a> <span class='Operator'>&LT; </span><span class='Number'>0xa1</span> <span class='Operator'>|| </span><a href="wchar.c.html#LN1131"><span class='Ref_To_Local'>c2</span></a> <span class='Operator'>&GT; </span><span class='Number'>0xdf</span><span class='Parentheses'>) 
</span>                <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>case</span> <a href="../../../include/mb/pg_wchar.h.html#LN35"><span class='Ref_to_Const'>SS3</span></a><span class='Operator'>:</span>               <span class='Comment_Single_Line'>/* JIS X 0212 */ 
</span>            <a href="wchar.c.html#LN1129"><span class='Ref_To_Local'>l</span></a> <span class='Operator'>= </span><span class='Number'>3</span><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="wchar.c.html#LN1129"><span class='Ref_To_Local'>l</span></a> <span class='Operator'>&GT; </span><a href="wchar.c.html#LN1127"><span class='Ref_to_Parameter'>len</span></a><span class='Parentheses'>) 
</span>                <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>            <a href="wchar.c.html#LN1131"><span class='Ref_To_Local'>c2</span></a> <span class='Operator'>= *</span><a href="wchar.c.html#LN1127"><span class='Ref_to_Parameter'>s</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="wchar.c.html#LN1124"><span class='Ref_to_Macro'>IS_EUC_RANGE_VALID</span></a><span class='Parentheses'>(</span><a href="wchar.c.html#LN1131"><span class='Ref_To_Local'>c2</span></a><span class='Parentheses'>))</span> 
                <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>            <a href="wchar.c.html#LN1131"><span class='Ref_To_Local'>c2</span></a> <span class='Operator'>= *</span><a href="wchar.c.html#LN1127"><span class='Ref_to_Parameter'>s</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="wchar.c.html#LN1124"><span class='Ref_to_Macro'>IS_EUC_RANGE_VALID</span></a><span class='Parentheses'>(</span><a href="wchar.c.html#LN1131"><span class='Ref_To_Local'>c2</span></a><span class='Parentheses'>))</span> 
                <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>default</span><span class='Operator'>: 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/c.h.html#LN972"><span class='Ref_to_Macro'>IS_HIGHBIT_SET</span></a><span class='Parentheses'>(</span><a href="wchar.c.html#LN1130"><span class='Ref_To_Local'>c1</span></a><span class='Parentheses'>))</span>     <span class='Comment_Single_Line'>/* JIS X 0208? */ 
</span>            <span class='Delimiter'>{ 
</span>                <a href="wchar.c.html#LN1129"><span class='Ref_To_Local'>l</span></a> <span class='Operator'>= </span><span class='Number'>2</span><span class='Delimiter'>; 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="wchar.c.html#LN1129"><span class='Ref_To_Local'>l</span></a> <span class='Operator'>&GT; </span><a href="wchar.c.html#LN1127"><span class='Ref_to_Parameter'>len</span></a><span class='Parentheses'>) 
</span>                    <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="wchar.c.html#LN1124"><span class='Ref_to_Macro'>IS_EUC_RANGE_VALID</span></a><span class='Parentheses'>(</span><a href="wchar.c.html#LN1130"><span class='Ref_To_Local'>c1</span></a><span class='Parentheses'>))</span> 
                    <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>                <a href="wchar.c.html#LN1131"><span class='Ref_To_Local'>c2</span></a> <span class='Operator'>= *</span><a href="wchar.c.html#LN1127"><span class='Ref_to_Parameter'>s</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="wchar.c.html#LN1124"><span class='Ref_to_Macro'>IS_EUC_RANGE_VALID</span></a><span class='Parentheses'>(</span><a href="wchar.c.html#LN1131"><span class='Ref_To_Local'>c2</span></a><span class='Parentheses'>))</span> 
                    <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>            <span class='Control'>else</span> 
                <span class='Comment_Multi_Line'>/* must be ASCII */ 
</span>            <span class='Delimiter'>{ 
</span>                <a href="wchar.c.html#LN1129"><span class='Ref_To_Local'>l</span></a> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end switch c1 &raquo; </span> 
 
    <span class='Control'>return</span> <a href="wchar.c.html#LN1129"><span class='Ref_To_Local'>l</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end pg_eucjp_verifier &raquo; </span> 
 
<span class='Keyword'>static int 
</span><a name="LN1182"></a><span class='Declare_Function'>pg_euckr_verifier</span><span class='Parentheses'>(</span><span class='Keyword'>const unsigned char </span><span class='Operator'>*</span><span class='Declare_Parameter'>s</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>len</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1184"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>l</span><span class='Delimiter'>; 
</span><a name="LN1185"></a>    <span class='Keyword'>unsigned char </span><span class='Declare_Local'>c1</span><span class='Delimiter'>, 
</span><a name="LN1186"></a>                <span class='Declare_Local'>c2</span><span class='Delimiter'>; 
</span> 
    <a href="wchar.c.html#LN1185"><span class='Ref_To_Local'>c1</span></a> <span class='Operator'>= *</span><a href="wchar.c.html#LN1182"><span class='Ref_to_Parameter'>s</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/c.h.html#LN972"><span class='Ref_to_Macro'>IS_HIGHBIT_SET</span></a><span class='Parentheses'>(</span><a href="wchar.c.html#LN1185"><span class='Ref_To_Local'>c1</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span>        <a href="wchar.c.html#LN1184"><span class='Ref_To_Local'>l</span></a> <span class='Operator'>= </span><span class='Number'>2</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="wchar.c.html#LN1184"><span class='Ref_To_Local'>l</span></a> <span class='Operator'>&GT; </span><a href="wchar.c.html#LN1182"><span class='Ref_to_Parameter'>len</span></a><span class='Parentheses'>) 
</span>            <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="wchar.c.html#LN1124"><span class='Ref_to_Macro'>IS_EUC_RANGE_VALID</span></a><span class='Parentheses'>(</span><a href="wchar.c.html#LN1185"><span class='Ref_To_Local'>c1</span></a><span class='Parentheses'>))</span> 
            <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>        <a href="wchar.c.html#LN1186"><span class='Ref_To_Local'>c2</span></a> <span class='Operator'>= *</span><a href="wchar.c.html#LN1182"><span class='Ref_to_Parameter'>s</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="wchar.c.html#LN1124"><span class='Ref_to_Macro'>IS_EUC_RANGE_VALID</span></a><span class='Parentheses'>(</span><a href="wchar.c.html#LN1186"><span class='Ref_To_Local'>c2</span></a><span class='Parentheses'>))</span> 
            <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> 
        <span class='Comment_Multi_Line'>/* must be ASCII */ 
</span>    <span class='Delimiter'>{ 
</span>        <a href="wchar.c.html#LN1184"><span class='Ref_To_Local'>l</span></a> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>return</span> <a href="wchar.c.html#LN1184"><span class='Ref_To_Local'>l</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end pg_euckr_verifier &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* EUC-CN byte sequences are exactly same as EUC-KR */ 
</span><a name="LN1211"></a><span class='Keyword'>#define </span><span class='Declare_Constant'>pg_euccn_verifier</span>   <a href="wchar.c.html#LN1181"><span class='Ref_to_Func'>pg_euckr_verifier</span></a> 
 
<span class='Keyword'>static int 
</span><a name="LN1214"></a><span class='Declare_Function'>pg_euctw_verifier</span><span class='Parentheses'>(</span><span class='Keyword'>const unsigned char </span><span class='Operator'>*</span><span class='Declare_Parameter'>s</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>len</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1216"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>l</span><span class='Delimiter'>; 
</span><a name="LN1217"></a>    <span class='Keyword'>unsigned char </span><span class='Declare_Local'>c1</span><span class='Delimiter'>, 
</span><a name="LN1218"></a>                <span class='Declare_Local'>c2</span><span class='Delimiter'>; 
</span> 
    <a href="wchar.c.html#LN1217"><span class='Ref_To_Local'>c1</span></a> <span class='Operator'>= *</span><a href="wchar.c.html#LN1214"><span class='Ref_to_Parameter'>s</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>switch</span> <span class='Parentheses'>(</span><a href="wchar.c.html#LN1217"><span class='Ref_To_Local'>c1</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>case</span> <a href="../../../include/mb/pg_wchar.h.html#LN34"><span class='Ref_to_Const'>SS2</span></a><span class='Operator'>:</span>               <span class='Comment_Single_Line'>/* CNS 11643 Plane 1-7 */ 
</span>            <a href="wchar.c.html#LN1216"><span class='Ref_To_Local'>l</span></a> <span class='Operator'>= </span><span class='Number'>4</span><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="wchar.c.html#LN1216"><span class='Ref_To_Local'>l</span></a> <span class='Operator'>&GT; </span><a href="wchar.c.html#LN1214"><span class='Ref_to_Parameter'>len</span></a><span class='Parentheses'>) 
</span>                <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>            <a href="wchar.c.html#LN1218"><span class='Ref_To_Local'>c2</span></a> <span class='Operator'>= *</span><a href="wchar.c.html#LN1214"><span class='Ref_to_Parameter'>s</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="wchar.c.html#LN1218"><span class='Ref_To_Local'>c2</span></a> <span class='Operator'>&LT; </span><span class='Number'>0xa1</span> <span class='Operator'>|| </span><a href="wchar.c.html#LN1218"><span class='Ref_To_Local'>c2</span></a> <span class='Operator'>&GT; </span><span class='Number'>0xa7</span><span class='Parentheses'>) 
</span>                <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>            <a href="wchar.c.html#LN1218"><span class='Ref_To_Local'>c2</span></a> <span class='Operator'>= *</span><a href="wchar.c.html#LN1214"><span class='Ref_to_Parameter'>s</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="wchar.c.html#LN1124"><span class='Ref_to_Macro'>IS_EUC_RANGE_VALID</span></a><span class='Parentheses'>(</span><a href="wchar.c.html#LN1218"><span class='Ref_To_Local'>c2</span></a><span class='Parentheses'>))</span> 
                <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>            <a href="wchar.c.html#LN1218"><span class='Ref_To_Local'>c2</span></a> <span class='Operator'>= *</span><a href="wchar.c.html#LN1214"><span class='Ref_to_Parameter'>s</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="wchar.c.html#LN1124"><span class='Ref_to_Macro'>IS_EUC_RANGE_VALID</span></a><span class='Parentheses'>(</span><a href="wchar.c.html#LN1218"><span class='Ref_To_Local'>c2</span></a><span class='Parentheses'>))</span> 
                <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>case</span> <a href="../../../include/mb/pg_wchar.h.html#LN35"><span class='Ref_to_Const'>SS3</span></a><span class='Operator'>:</span>               <span class='Comment_Single_Line'>/* unused */ 
</span>            <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>default</span><span class='Operator'>: 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/c.h.html#LN972"><span class='Ref_to_Macro'>IS_HIGHBIT_SET</span></a><span class='Parentheses'>(</span><a href="wchar.c.html#LN1217"><span class='Ref_To_Local'>c1</span></a><span class='Parentheses'>))</span>     <span class='Comment_Single_Line'>/* CNS 11643 Plane 1 */ 
</span>            <span class='Delimiter'>{ 
</span>                <a href="wchar.c.html#LN1216"><span class='Ref_To_Local'>l</span></a> <span class='Operator'>= </span><span class='Number'>2</span><span class='Delimiter'>; 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="wchar.c.html#LN1216"><span class='Ref_To_Local'>l</span></a> <span class='Operator'>&GT; </span><a href="wchar.c.html#LN1214"><span class='Ref_to_Parameter'>len</span></a><span class='Parentheses'>) 
</span>                    <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>                <span class='Comment_Multi_Line'>/* no further range check on c1? */ 
</span>                <a href="wchar.c.html#LN1218"><span class='Ref_To_Local'>c2</span></a> <span class='Operator'>= *</span><a href="wchar.c.html#LN1214"><span class='Ref_to_Parameter'>s</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="wchar.c.html#LN1124"><span class='Ref_to_Macro'>IS_EUC_RANGE_VALID</span></a><span class='Parentheses'>(</span><a href="wchar.c.html#LN1218"><span class='Ref_To_Local'>c2</span></a><span class='Parentheses'>))</span> 
                    <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>            <span class='Control'>else</span> 
                <span class='Comment_Multi_Line'>/* must be ASCII */ 
</span>            <span class='Delimiter'>{ 
</span>                <a href="wchar.c.html#LN1216"><span class='Ref_To_Local'>l</span></a> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end switch c1 &raquo; </span> 
    <span class='Control'>return</span> <a href="wchar.c.html#LN1216"><span class='Ref_To_Local'>l</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end pg_euctw_verifier &raquo; </span> 
 
<span class='Keyword'>static int 
</span><a name="LN1264"></a><span class='Declare_Function'>pg_johab_verifier</span><span class='Parentheses'>(</span><span class='Keyword'>const unsigned char </span><span class='Operator'>*</span><span class='Declare_Parameter'>s</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>len</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1266"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>l</span><span class='Delimiter'>, 
</span><a name="LN1267"></a>                <span class='Declare_Local'>mbl</span><span class='Delimiter'>; 
</span><a name="LN1268"></a>    <span class='Keyword'>unsigned char </span><span class='Declare_Local'>c</span><span class='Delimiter'>; 
</span> 
    <a href="wchar.c.html#LN1266"><span class='Ref_To_Local'>l</span></a> <span class='Operator'>= </span><a href="wchar.c.html#LN1267"><span class='Ref_To_Local'>mbl</span></a> <span class='Operator'>= </span><a href="wchar.c.html#LN391"><span class='Ref_to_Func'>pg_johab_mblen</span></a><span class='Parentheses'>(</span><a href="wchar.c.html#LN1264"><span class='Ref_to_Parameter'>s</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="wchar.c.html#LN1264"><span class='Ref_to_Parameter'>len</span></a> <span class='Operator'>&LT; </span><a href="wchar.c.html#LN1266"><span class='Ref_To_Local'>l</span></a><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../../include/c.h.html#LN972"><span class='Ref_to_Macro'>IS_HIGHBIT_SET</span></a><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="wchar.c.html#LN1264"><span class='Ref_to_Parameter'>s</span></a><span class='Parentheses'>))</span> 
        <span class='Control'>return</span> <a href="wchar.c.html#LN1267"><span class='Ref_To_Local'>mbl</span></a><span class='Delimiter'>; 
</span> 
    <span class='Control'>while</span> <span class='Parentheses'>(</span><span class='Operator'>--</span><a href="wchar.c.html#LN1266"><span class='Ref_To_Local'>l</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="wchar.c.html#LN1268"><span class='Ref_To_Local'>c</span></a> <span class='Operator'>= *++</span><a href="wchar.c.html#LN1264"><span class='Ref_to_Parameter'>s</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="wchar.c.html#LN1124"><span class='Ref_to_Macro'>IS_EUC_RANGE_VALID</span></a><span class='Parentheses'>(</span><a href="wchar.c.html#LN1268"><span class='Ref_To_Local'>c</span></a><span class='Parentheses'>))</span> 
            <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>return</span> <a href="wchar.c.html#LN1267"><span class='Ref_To_Local'>mbl</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end pg_johab_verifier &raquo; </span> 
 
<span class='Keyword'>static int 
</span><a name="LN1288"></a><span class='Declare_Function'>pg_mule_verifier</span><span class='Parentheses'>(</span><span class='Keyword'>const unsigned char </span><span class='Operator'>*</span><span class='Declare_Parameter'>s</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>len</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1290"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>l</span><span class='Delimiter'>, 
</span><a name="LN1291"></a>                <span class='Declare_Local'>mbl</span><span class='Delimiter'>; 
</span><a name="LN1292"></a>    <span class='Keyword'>unsigned char </span><span class='Declare_Local'>c</span><span class='Delimiter'>; 
</span> 
    <a href="wchar.c.html#LN1290"><span class='Ref_To_Local'>l</span></a> <span class='Operator'>= </span><a href="wchar.c.html#LN1291"><span class='Ref_To_Local'>mbl</span></a> <span class='Operator'>= </span><a href="../../../include/mb/pg_wchar.h.html#LN526"><span class='Ref_to_Proto'>pg_mule_mblen</span></a><span class='Parentheses'>(</span><a href="wchar.c.html#LN1288"><span class='Ref_to_Parameter'>s</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="wchar.c.html#LN1288"><span class='Ref_to_Parameter'>len</span></a> <span class='Operator'>&LT; </span><a href="wchar.c.html#LN1290"><span class='Ref_To_Local'>l</span></a><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>while</span> <span class='Parentheses'>(</span><span class='Operator'>--</span><a href="wchar.c.html#LN1290"><span class='Ref_To_Local'>l</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="wchar.c.html#LN1292"><span class='Ref_To_Local'>c</span></a> <span class='Operator'>= *++</span><a href="wchar.c.html#LN1288"><span class='Ref_to_Parameter'>s</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../../include/c.h.html#LN972"><span class='Ref_to_Macro'>IS_HIGHBIT_SET</span></a><span class='Parentheses'>(</span><a href="wchar.c.html#LN1292"><span class='Ref_To_Local'>c</span></a><span class='Parentheses'>))</span> 
            <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>return</span> <a href="wchar.c.html#LN1291"><span class='Ref_To_Local'>mbl</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end pg_mule_verifier &raquo; </span> 
 
<span class='Keyword'>static int 
</span><a name="LN1309"></a><span class='Declare_Function'>pg_latin1_verifier</span><span class='Parentheses'>(</span><span class='Keyword'>const unsigned char </span><span class='Operator'>*</span><span class='Declare_Parameter'>s</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>len</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>return</span> <span class='Number'>1</span><span class='Delimiter'>; 
} 
</span> 
<span class='Keyword'>static int 
</span><a name="LN1315"></a><span class='Declare_Function'>pg_sjis_verifier</span><span class='Parentheses'>(</span><span class='Keyword'>const unsigned char </span><span class='Operator'>*</span><span class='Declare_Parameter'>s</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>len</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1317"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>l</span><span class='Delimiter'>, 
</span><a name="LN1318"></a>                <span class='Declare_Local'>mbl</span><span class='Delimiter'>; 
</span><a name="LN1319"></a>    <span class='Keyword'>unsigned char </span><span class='Declare_Local'>c1</span><span class='Delimiter'>, 
</span><a name="LN1320"></a>                <span class='Declare_Local'>c2</span><span class='Delimiter'>; 
</span> 
    <a href="wchar.c.html#LN1317"><span class='Ref_To_Local'>l</span></a> <span class='Operator'>= </span><a href="wchar.c.html#LN1318"><span class='Ref_To_Local'>mbl</span></a> <span class='Operator'>= </span><a href="wchar.c.html#LN962"><span class='Ref_to_Func'>pg_sjis_mblen</span></a><span class='Parentheses'>(</span><a href="wchar.c.html#LN1315"><span class='Ref_to_Parameter'>s</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="wchar.c.html#LN1315"><span class='Ref_to_Parameter'>len</span></a> <span class='Operator'>&LT; </span><a href="wchar.c.html#LN1317"><span class='Ref_To_Local'>l</span></a><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="wchar.c.html#LN1317"><span class='Ref_To_Local'>l</span></a> <span class='Operator'>== </span><span class='Number'>1</span><span class='Parentheses'>)</span>                 <span class='Comment_Single_Line'>/* pg_sjis_mblen already verified it */ 
</span>        <span class='Control'>return</span> <a href="wchar.c.html#LN1318"><span class='Ref_To_Local'>mbl</span></a><span class='Delimiter'>; 
</span> 
    <a href="wchar.c.html#LN1319"><span class='Ref_To_Local'>c1</span></a> <span class='Operator'>= *</span><a href="wchar.c.html#LN1315"><span class='Ref_to_Parameter'>s</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>    <a href="wchar.c.html#LN1320"><span class='Ref_To_Local'>c2</span></a> <span class='Operator'>= *</span><a href="wchar.c.html#LN1315"><span class='Ref_to_Parameter'>s</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../../include/mb/pg_wchar.h.html#LN40"><span class='Ref_to_Macro'>ISSJISHEAD</span></a><span class='Parentheses'>(</span><a href="wchar.c.html#LN1319"><span class='Ref_To_Local'>c1</span></a><span class='Parentheses'>) </span><span class='Operator'>|| !</span><a href="../../../include/mb/pg_wchar.h.html#LN41"><span class='Ref_to_Macro'>ISSJISTAIL</span></a><span class='Parentheses'>(</span><a href="wchar.c.html#LN1320"><span class='Ref_To_Local'>c2</span></a><span class='Parentheses'>))</span> 
        <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <a href="wchar.c.html#LN1318"><span class='Ref_To_Local'>mbl</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end pg_sjis_verifier &raquo; </span> 
 
<span class='Keyword'>static int 
</span><a name="LN1338"></a><span class='Declare_Function'>pg_big5_verifier</span><span class='Parentheses'>(</span><span class='Keyword'>const unsigned char </span><span class='Operator'>*</span><span class='Declare_Parameter'>s</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>len</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1340"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>l</span><span class='Delimiter'>, 
</span><a name="LN1341"></a>                <span class='Declare_Local'>mbl</span><span class='Delimiter'>; 
</span> 
    <a href="wchar.c.html#LN1340"><span class='Ref_To_Local'>l</span></a> <span class='Operator'>= </span><a href="wchar.c.html#LN1341"><span class='Ref_To_Local'>mbl</span></a> <span class='Operator'>= </span><a href="wchar.c.html#LN993"><span class='Ref_to_Func'>pg_big5_mblen</span></a><span class='Parentheses'>(</span><a href="wchar.c.html#LN1338"><span class='Ref_to_Parameter'>s</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="wchar.c.html#LN1338"><span class='Ref_to_Parameter'>len</span></a> <span class='Operator'>&LT; </span><a href="wchar.c.html#LN1340"><span class='Ref_To_Local'>l</span></a><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>while</span> <span class='Parentheses'>(</span><span class='Operator'>--</span><a href="wchar.c.html#LN1340"><span class='Ref_To_Local'>l</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*++</span><a href="wchar.c.html#LN1338"><span class='Ref_to_Parameter'>s</span></a> <span class='Operator'>== </span><span class='String'>'\0'</span><span class='Parentheses'>) 
</span>            <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>return</span> <a href="wchar.c.html#LN1341"><span class='Ref_To_Local'>mbl</span></a><span class='Delimiter'>; 
} 
</span> 
<span class='Keyword'>static int 
</span><a name="LN1358"></a><span class='Declare_Function'>pg_gbk_verifier</span><span class='Parentheses'>(</span><span class='Keyword'>const unsigned char </span><span class='Operator'>*</span><span class='Declare_Parameter'>s</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>len</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1360"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>l</span><span class='Delimiter'>, 
</span><a name="LN1361"></a>                <span class='Declare_Local'>mbl</span><span class='Delimiter'>; 
</span> 
    <a href="wchar.c.html#LN1360"><span class='Ref_To_Local'>l</span></a> <span class='Operator'>= </span><a href="wchar.c.html#LN1361"><span class='Ref_To_Local'>mbl</span></a> <span class='Operator'>= </span><a href="wchar.c.html#LN1020"><span class='Ref_to_Func'>pg_gbk_mblen</span></a><span class='Parentheses'>(</span><a href="wchar.c.html#LN1358"><span class='Ref_to_Parameter'>s</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="wchar.c.html#LN1358"><span class='Ref_to_Parameter'>len</span></a> <span class='Operator'>&LT; </span><a href="wchar.c.html#LN1360"><span class='Ref_To_Local'>l</span></a><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>while</span> <span class='Parentheses'>(</span><span class='Operator'>--</span><a href="wchar.c.html#LN1360"><span class='Ref_To_Local'>l</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*++</span><a href="wchar.c.html#LN1358"><span class='Ref_to_Parameter'>s</span></a> <span class='Operator'>== </span><span class='String'>'\0'</span><span class='Parentheses'>) 
</span>            <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>return</span> <a href="wchar.c.html#LN1361"><span class='Ref_To_Local'>mbl</span></a><span class='Delimiter'>; 
} 
</span> 
<span class='Keyword'>static int 
</span><a name="LN1378"></a><span class='Declare_Function'>pg_uhc_verifier</span><span class='Parentheses'>(</span><span class='Keyword'>const unsigned char </span><span class='Operator'>*</span><span class='Declare_Parameter'>s</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>len</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1380"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>l</span><span class='Delimiter'>, 
</span><a name="LN1381"></a>                <span class='Declare_Local'>mbl</span><span class='Delimiter'>; 
</span> 
    <a href="wchar.c.html#LN1380"><span class='Ref_To_Local'>l</span></a> <span class='Operator'>= </span><a href="wchar.c.html#LN1381"><span class='Ref_To_Local'>mbl</span></a> <span class='Operator'>= </span><a href="wchar.c.html#LN1047"><span class='Ref_to_Func'>pg_uhc_mblen</span></a><span class='Parentheses'>(</span><a href="wchar.c.html#LN1378"><span class='Ref_to_Parameter'>s</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="wchar.c.html#LN1378"><span class='Ref_to_Parameter'>len</span></a> <span class='Operator'>&LT; </span><a href="wchar.c.html#LN1380"><span class='Ref_To_Local'>l</span></a><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>while</span> <span class='Parentheses'>(</span><span class='Operator'>--</span><a href="wchar.c.html#LN1380"><span class='Ref_To_Local'>l</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*++</span><a href="wchar.c.html#LN1378"><span class='Ref_to_Parameter'>s</span></a> <span class='Operator'>== </span><span class='String'>'\0'</span><span class='Parentheses'>) 
</span>            <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>return</span> <a href="wchar.c.html#LN1381"><span class='Ref_To_Local'>mbl</span></a><span class='Delimiter'>; 
} 
</span> 
<span class='Keyword'>static int 
</span><a name="LN1398"></a><span class='Declare_Function'>pg_gb18030_verifier</span><span class='Parentheses'>(</span><span class='Keyword'>const unsigned char </span><span class='Operator'>*</span><span class='Declare_Parameter'>s</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>len</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1400"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>l</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../../include/c.h.html#LN972"><span class='Ref_to_Macro'>IS_HIGHBIT_SET</span></a><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="wchar.c.html#LN1398"><span class='Ref_to_Parameter'>s</span></a><span class='Parentheses'>))</span> 
        <a href="wchar.c.html#LN1400"><span class='Ref_To_Local'>l</span></a> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>;</span>                  <span class='Comment_Single_Line'>/* ASCII */ 
</span>    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="wchar.c.html#LN1398"><span class='Ref_to_Parameter'>len</span></a> <span class='Operator'>&GT;= </span><span class='Number'>4</span> <span class='Operator'>&& *</span><span class='Parentheses'>(</span><a href="wchar.c.html#LN1398"><span class='Ref_to_Parameter'>s</span></a> <span class='Operator'>+ </span><span class='Number'>1</span><span class='Parentheses'>) </span><span class='Operator'>&GT;= </span><span class='Number'>0x30</span> <span class='Operator'>&& *</span><span class='Parentheses'>(</span><a href="wchar.c.html#LN1398"><span class='Ref_to_Parameter'>s</span></a> <span class='Operator'>+ </span><span class='Number'>1</span><span class='Parentheses'>) </span><span class='Operator'>&LT;= </span><span class='Number'>0x39</span><span class='Parentheses'>)</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* Should be 4-byte, validate remaining bytes */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="wchar.c.html#LN1398"><span class='Ref_to_Parameter'>s</span></a> <span class='Operator'>&GT;= </span><span class='Number'>0x81</span> <span class='Operator'>&& *</span><a href="wchar.c.html#LN1398"><span class='Ref_to_Parameter'>s</span></a> <span class='Operator'>&LT;= </span><span class='Number'>0xfe</span> <span class='Operator'>&& 
</span>            <span class='Operator'>*</span><span class='Parentheses'>(</span><a href="wchar.c.html#LN1398"><span class='Ref_to_Parameter'>s</span></a> <span class='Operator'>+ </span><span class='Number'>2</span><span class='Parentheses'>) </span><span class='Operator'>&GT;= </span><span class='Number'>0x81</span> <span class='Operator'>&& *</span><span class='Parentheses'>(</span><a href="wchar.c.html#LN1398"><span class='Ref_to_Parameter'>s</span></a> <span class='Operator'>+ </span><span class='Number'>2</span><span class='Parentheses'>) </span><span class='Operator'>&LT;= </span><span class='Number'>0xfe</span> <span class='Operator'>&& 
</span>            <span class='Operator'>*</span><span class='Parentheses'>(</span><a href="wchar.c.html#LN1398"><span class='Ref_to_Parameter'>s</span></a> <span class='Operator'>+ </span><span class='Number'>3</span><span class='Parentheses'>) </span><span class='Operator'>&GT;= </span><span class='Number'>0x30</span> <span class='Operator'>&& *</span><span class='Parentheses'>(</span><a href="wchar.c.html#LN1398"><span class='Ref_to_Parameter'>s</span></a> <span class='Operator'>+ </span><span class='Number'>3</span><span class='Parentheses'>) </span><span class='Operator'>&LT;= </span><span class='Number'>0x39</span><span class='Parentheses'>)</span> 
            <a href="wchar.c.html#LN1400"><span class='Ref_To_Local'>l</span></a> <span class='Operator'>= </span><span class='Number'>4</span><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> 
            <a href="wchar.c.html#LN1400"><span class='Ref_To_Local'>l</span></a> <span class='Operator'>= -</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="wchar.c.html#LN1398"><span class='Ref_to_Parameter'>len</span></a> <span class='Operator'>&GT;= </span><span class='Number'>2</span> <span class='Operator'>&& *</span><a href="wchar.c.html#LN1398"><span class='Ref_to_Parameter'>s</span></a> <span class='Operator'>&GT;= </span><span class='Number'>0x81</span> <span class='Operator'>&& *</span><a href="wchar.c.html#LN1398"><span class='Ref_to_Parameter'>s</span></a> <span class='Operator'>&LT;= </span><span class='Number'>0xfe</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* Should be 2-byte, validate */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>((</span><span class='Operator'>*</span><span class='Parentheses'>(</span><a href="wchar.c.html#LN1398"><span class='Ref_to_Parameter'>s</span></a> <span class='Operator'>+ </span><span class='Number'>1</span><span class='Parentheses'>) </span><span class='Operator'>&GT;= </span><span class='Number'>0x40</span> <span class='Operator'>&& *</span><span class='Parentheses'>(</span><a href="wchar.c.html#LN1398"><span class='Ref_to_Parameter'>s</span></a> <span class='Operator'>+ </span><span class='Number'>1</span><span class='Parentheses'>) </span><span class='Operator'>&LT;= </span><span class='Number'>0x7e</span><span class='Parentheses'>)</span> <span class='Operator'>|| 
</span>            <span class='Parentheses'>(</span><span class='Operator'>*</span><span class='Parentheses'>(</span><a href="wchar.c.html#LN1398"><span class='Ref_to_Parameter'>s</span></a> <span class='Operator'>+ </span><span class='Number'>1</span><span class='Parentheses'>) </span><span class='Operator'>&GT;= </span><span class='Number'>0x80</span> <span class='Operator'>&& *</span><span class='Parentheses'>(</span><a href="wchar.c.html#LN1398"><span class='Ref_to_Parameter'>s</span></a> <span class='Operator'>+ </span><span class='Number'>1</span><span class='Parentheses'>) </span><span class='Operator'>&LT;= </span><span class='Number'>0xfe</span><span class='Parentheses'>))</span> 
            <a href="wchar.c.html#LN1400"><span class='Ref_To_Local'>l</span></a> <span class='Operator'>= </span><span class='Number'>2</span><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> 
            <a href="wchar.c.html#LN1400"><span class='Ref_To_Local'>l</span></a> <span class='Operator'>= -</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> 
        <a href="wchar.c.html#LN1400"><span class='Ref_To_Local'>l</span></a> <span class='Operator'>= -</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <a href="wchar.c.html#LN1400"><span class='Ref_To_Local'>l</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end pg_gb18030_verifier &raquo; </span> 
 
<span class='Keyword'>static int 
</span><a name="LN1429"></a><span class='Declare_Function'>pg_utf8_verifier</span><span class='Parentheses'>(</span><span class='Keyword'>const unsigned char </span><span class='Operator'>*</span><span class='Declare_Parameter'>s</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>len</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1431"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>l</span> <span class='Operator'>= </span><a href="wchar.c.html#LN539"><span class='Ref_to_Func'>pg_utf_mblen</span></a><span class='Parentheses'>(</span><a href="wchar.c.html#LN1429"><span class='Ref_to_Parameter'>s</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="wchar.c.html#LN1429"><span class='Ref_to_Parameter'>len</span></a> <span class='Operator'>&LT; </span><a href="wchar.c.html#LN1431"><span class='Ref_To_Local'>l</span></a><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../../include/mb/pg_wchar.h.html#LN616"><span class='Ref_to_Proto'>pg_utf8_islegal</span></a><span class='Parentheses'>(</span><a href="wchar.c.html#LN1429"><span class='Ref_to_Parameter'>s</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN1431"><span class='Ref_To_Local'>l</span></a><span class='Parentheses'>))</span> 
        <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="wchar.c.html#LN1431"><span class='Ref_To_Local'>l</span></a><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * Check for validity of a single UTF-8 encoded character 
 * 
 * This directly implements the rules in RFC3629.  The bizarre-looking 
 * restrictions on the second byte are meant to ensure that there isn't 
 * more than one encoding of a given Unicode character point; that is, 
 * you may not use a longer-than-necessary byte sequence with high order 
 * zero bits to represent a character that would fit in fewer bytes. 
 * To do otherwise is to create security hazards (eg, create an apparent 
 * non-ASCII character that decodes to plain ASCII). 
 * 
 * length is assumed to have been obtained by pg_utf_mblen(), and the 
 * caller must have checked that that many bytes are present in the buffer. 
 */ 
</span><span class='Keyword'>bool 
</span><a name="LN1457"></a><span class='Declare_Function'>pg_utf8_islegal</span><span class='Parentheses'>(</span><span class='Keyword'>const unsigned char </span><span class='Operator'>*</span><span class='Declare_Parameter'>source</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>length</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1459"></a>    <span class='Keyword'>unsigned char </span><span class='Declare_Local'>a</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>switch</span> <span class='Parentheses'>(</span><a href="wchar.c.html#LN1457"><span class='Ref_to_Parameter'>length</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>default</span><span class='Operator'>: 
</span>            <span class='Comment_Multi_Line'>/* reject lengths 5 and 6 for now */ 
</span>            <span class='Control'>return</span> <span class='Boolean'>false</span><span class='Delimiter'>; 
</span>        <span class='Control'>case</span> <span class='Number'>4</span><span class='Operator'>: 
</span>            <a href="wchar.c.html#LN1459"><span class='Ref_To_Local'>a</span></a> <span class='Operator'>= </span><a href="wchar.c.html#LN1457"><span class='Ref_to_Parameter'>source</span></a><span class='Delimiter'>[</span><span class='Number'>3</span><span class='Delimiter'>]; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="wchar.c.html#LN1459"><span class='Ref_To_Local'>a</span></a> <span class='Operator'>&LT; </span><span class='Number'>0x80</span> <span class='Operator'>|| </span><a href="wchar.c.html#LN1459"><span class='Ref_To_Local'>a</span></a> <span class='Operator'>&GT; </span><span class='Number'>0xBF</span><span class='Parentheses'>) 
</span>                <span class='Control'>return</span> <span class='Boolean'>false</span><span class='Delimiter'>; 
</span>            <span class='Comment_Multi_Line'>/* FALL THRU */ 
</span>        <span class='Control'>case</span> <span class='Number'>3</span><span class='Operator'>: 
</span>            <a href="wchar.c.html#LN1459"><span class='Ref_To_Local'>a</span></a> <span class='Operator'>= </span><a href="wchar.c.html#LN1457"><span class='Ref_to_Parameter'>source</span></a><span class='Delimiter'>[</span><span class='Number'>2</span><span class='Delimiter'>]; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="wchar.c.html#LN1459"><span class='Ref_To_Local'>a</span></a> <span class='Operator'>&LT; </span><span class='Number'>0x80</span> <span class='Operator'>|| </span><a href="wchar.c.html#LN1459"><span class='Ref_To_Local'>a</span></a> <span class='Operator'>&GT; </span><span class='Number'>0xBF</span><span class='Parentheses'>) 
</span>                <span class='Control'>return</span> <span class='Boolean'>false</span><span class='Delimiter'>; 
</span>            <span class='Comment_Multi_Line'>/* FALL THRU */ 
</span>        <span class='Control'>case</span> <span class='Number'>2</span><span class='Operator'>: 
</span>            <a href="wchar.c.html#LN1459"><span class='Ref_To_Local'>a</span></a> <span class='Operator'>= </span><a href="wchar.c.html#LN1457"><span class='Ref_to_Parameter'>source</span></a><span class='Delimiter'>[</span><span class='Number'>1</span><span class='Delimiter'>]; 
</span>            <span class='Control'>switch</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="wchar.c.html#LN1457"><span class='Ref_to_Parameter'>source</span></a><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <span class='Control'>case</span> <span class='Number'>0xE0</span><span class='Operator'>: 
</span>                    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="wchar.c.html#LN1459"><span class='Ref_To_Local'>a</span></a> <span class='Operator'>&LT; </span><span class='Number'>0xA0</span> <span class='Operator'>|| </span><a href="wchar.c.html#LN1459"><span class='Ref_To_Local'>a</span></a> <span class='Operator'>&GT; </span><span class='Number'>0xBF</span><span class='Parentheses'>) 
</span>                        <span class='Control'>return</span> <span class='Boolean'>false</span><span class='Delimiter'>; 
</span>                    <span class='Control'>break</span><span class='Delimiter'>; 
</span>                <span class='Control'>case</span> <span class='Number'>0xED</span><span class='Operator'>: 
</span>                    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="wchar.c.html#LN1459"><span class='Ref_To_Local'>a</span></a> <span class='Operator'>&LT; </span><span class='Number'>0x80</span> <span class='Operator'>|| </span><a href="wchar.c.html#LN1459"><span class='Ref_To_Local'>a</span></a> <span class='Operator'>&GT; </span><span class='Number'>0x9F</span><span class='Parentheses'>) 
</span>                        <span class='Control'>return</span> <span class='Boolean'>false</span><span class='Delimiter'>; 
</span>                    <span class='Control'>break</span><span class='Delimiter'>; 
</span>                <span class='Control'>case</span> <span class='Number'>0xF0</span><span class='Operator'>: 
</span>                    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="wchar.c.html#LN1459"><span class='Ref_To_Local'>a</span></a> <span class='Operator'>&LT; </span><span class='Number'>0x90</span> <span class='Operator'>|| </span><a href="wchar.c.html#LN1459"><span class='Ref_To_Local'>a</span></a> <span class='Operator'>&GT; </span><span class='Number'>0xBF</span><span class='Parentheses'>) 
</span>                        <span class='Control'>return</span> <span class='Boolean'>false</span><span class='Delimiter'>; 
</span>                    <span class='Control'>break</span><span class='Delimiter'>; 
</span>                <span class='Control'>case</span> <span class='Number'>0xF4</span><span class='Operator'>: 
</span>                    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="wchar.c.html#LN1459"><span class='Ref_To_Local'>a</span></a> <span class='Operator'>&LT; </span><span class='Number'>0x80</span> <span class='Operator'>|| </span><a href="wchar.c.html#LN1459"><span class='Ref_To_Local'>a</span></a> <span class='Operator'>&GT; </span><span class='Number'>0x8F</span><span class='Parentheses'>) 
</span>                        <span class='Control'>return</span> <span class='Boolean'>false</span><span class='Delimiter'>; 
</span>                    <span class='Control'>break</span><span class='Delimiter'>; 
</span>                <span class='Control'>default</span><span class='Operator'>: 
</span>                    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="wchar.c.html#LN1459"><span class='Ref_To_Local'>a</span></a> <span class='Operator'>&LT; </span><span class='Number'>0x80</span> <span class='Operator'>|| </span><a href="wchar.c.html#LN1459"><span class='Ref_To_Local'>a</span></a> <span class='Operator'>&GT; </span><span class='Number'>0xBF</span><span class='Parentheses'>) 
</span>                        <span class='Control'>return</span> <span class='Boolean'>false</span><span class='Delimiter'>; 
</span>                    <span class='Control'>break</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end switch *source &raquo; </span> 
            <span class='Comment_Multi_Line'>/* FALL THRU */ 
</span>        <span class='Control'>case</span> <span class='Number'>1</span><span class='Operator'>: 
</span>            <a href="wchar.c.html#LN1459"><span class='Ref_To_Local'>a</span></a> <span class='Operator'>= *</span><a href="wchar.c.html#LN1457"><span class='Ref_to_Parameter'>source</span></a><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="wchar.c.html#LN1459"><span class='Ref_To_Local'>a</span></a> <span class='Operator'>&GT;= </span><span class='Number'>0x80</span> <span class='Operator'>&& </span><a href="wchar.c.html#LN1459"><span class='Ref_To_Local'>a</span></a> <span class='Operator'>&LT; </span><span class='Number'>0xC2</span><span class='Parentheses'>) 
</span>                <span class='Control'>return</span> <span class='Boolean'>false</span><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="wchar.c.html#LN1459"><span class='Ref_To_Local'>a</span></a> <span class='Operator'>&GT; </span><span class='Number'>0xF4</span><span class='Parentheses'>) 
</span>                <span class='Control'>return</span> <span class='Boolean'>false</span><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end switch length &raquo; </span> 
    <span class='Control'>return</span> <span class='Boolean'>true</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end pg_utf8_islegal &raquo; </span> 
 
<span class='Directive'>#ifndef</span> <a href="../../../bin/pg_waldump/rmgrdesc.c.html#LN7"><span class='Ref_to_Const'>FRONTEND</span></a> 
 
<span class='Comment_Multi_Line'>/* 
 * Generic character incrementer function. 
 * 
 * Not knowing anything about the properties of the encoding in use, we just 
 * keep incrementing the last byte until we get a validly-encoded result, 
 * or we run out of values to try.  We don't bother to try incrementing 
 * higher-order bytes, so there's no growth in runtime for wider characters. 
 * (If we did try to do that, we'd need to consider the likelihood that 255 
 * is not a valid final byte in the encoding.) 
 */ 
</span><span class='Keyword'>static bool 
</span><a name="LN1526"></a><span class='Declare_Function'>pg_generic_charinc</span><span class='Parentheses'>(</span><span class='Keyword'>unsigned char </span><span class='Operator'>*</span><span class='Declare_Parameter'>charptr</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>len</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1528"></a>    <span class='Keyword'>unsigned char </span><span class='Operator'>*</span><span class='Declare_Local'>lastbyte</span> <span class='Operator'>= </span><a href="wchar.c.html#LN1526"><span class='Ref_to_Parameter'>charptr</span></a> <span class='Operator'>+ </span><a href="wchar.c.html#LN1526"><span class='Ref_to_Parameter'>len</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>; 
</span><a name="LN1529"></a>    <a href="../../../include/mb/pg_wchar.h.html#LN357"><span class='Ref_to_Typedef'>mbverifier</span></a>  <span class='Declare_Local'>mbverify</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* We can just invoke the character verifier directly. */ 
</span>    <a href="wchar.c.html#LN1529"><span class='Ref_To_Local'>mbverify</span></a> <span class='Operator'>= </span><a href="wchar.c.html#LN1728"><span class='Ref_to_Global_Var'>pg_wchar_table</span></a><span class='Delimiter'>[</span><a href="../../../include/mb/pg_wchar.h.html#LN545"><span class='Ref_to_Proto'>GetDatabaseEncoding</span></a><span class='Parentheses'>()</span><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="../../../include/mb/pg_wchar.h.html#LN367"><span class='Ref_to_Member'>mbverify</span></a><span class='Delimiter'>; 
</span> 
    <span class='Control'>while</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="wchar.c.html#LN1528"><span class='Ref_To_Local'>lastbyte</span></a> <span class='Operator'>&LT; </span><span class='Parentheses'>(</span><span class='Keyword'>unsigned char</span><span class='Parentheses'>) </span><span class='Number'>255</span><span class='Parentheses'>)</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="wchar.c.html#LN1528"><span class='Ref_To_Local'>lastbyte</span></a><span class='Parentheses'>)</span><span class='Operator'>++</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>((</span><span class='Operator'>*</span><a href="wchar.c.html#LN1529"><span class='Ref_To_Local'>mbverify</span></a><span class='Parentheses'>) (</span><a href="wchar.c.html#LN1526"><span class='Ref_to_Parameter'>charptr</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN1526"><span class='Ref_to_Parameter'>len</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span><a href="wchar.c.html#LN1526"><span class='Ref_to_Parameter'>len</span></a><span class='Parentheses'>)</span> 
            <span class='Control'>return</span> <span class='Boolean'>true</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>return</span> <span class='Boolean'>false</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * UTF-8 character incrementer function. 
 * 
 * For a one-byte character less than 0x7F, we just increment the byte. 
 * 
 * For a multibyte character, every byte but the first must fall between 0x80 
 * and 0xBF; and the first byte must be between 0xC0 and 0xF4.  We increment 
 * the last byte that's not already at its maximum value.  If we can't find a 
 * byte that's less than the maximum allowable value, we simply fail.  We also 
 * need some special-case logic to skip regions used for surrogate pair 
 * handling, as those should not occur in valid UTF-8. 
 * 
 * Note that we don't reset lower-order bytes back to their minimums, since 
 * we can't afford to make an exhaustive search (see make_greater_string). 
 */ 
</span><span class='Keyword'>static bool 
</span><a name="LN1560"></a><span class='Declare_Function'>pg_utf8_increment</span><span class='Parentheses'>(</span><span class='Keyword'>unsigned char </span><span class='Operator'>*</span><span class='Declare_Parameter'>charptr</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>length</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1562"></a>    <span class='Keyword'>unsigned char </span><span class='Declare_Local'>a</span><span class='Delimiter'>; 
</span><a name="LN1563"></a>    <span class='Keyword'>unsigned char </span><span class='Declare_Local'>limit</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>switch</span> <span class='Parentheses'>(</span><a href="wchar.c.html#LN1560"><span class='Ref_to_Parameter'>length</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>default</span><span class='Operator'>: 
</span>            <span class='Comment_Multi_Line'>/* reject lengths 5 and 6 for now */ 
</span>            <span class='Control'>return</span> <span class='Boolean'>false</span><span class='Delimiter'>; 
</span>        <span class='Control'>case</span> <span class='Number'>4</span><span class='Operator'>: 
</span>            <a href="wchar.c.html#LN1562"><span class='Ref_To_Local'>a</span></a> <span class='Operator'>= </span><a href="wchar.c.html#LN1560"><span class='Ref_to_Parameter'>charptr</span></a><span class='Delimiter'>[</span><span class='Number'>3</span><span class='Delimiter'>]; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="wchar.c.html#LN1562"><span class='Ref_To_Local'>a</span></a> <span class='Operator'>&LT; </span><span class='Number'>0xBF</span><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <a href="wchar.c.html#LN1560"><span class='Ref_to_Parameter'>charptr</span></a><span class='Delimiter'>[</span><span class='Number'>3</span><span class='Delimiter'>]</span><span class='Operator'>++</span><span class='Delimiter'>; 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>            <span class='Comment_Multi_Line'>/* FALL THRU */ 
</span>        <span class='Control'>case</span> <span class='Number'>3</span><span class='Operator'>: 
</span>            <a href="wchar.c.html#LN1562"><span class='Ref_To_Local'>a</span></a> <span class='Operator'>= </span><a href="wchar.c.html#LN1560"><span class='Ref_to_Parameter'>charptr</span></a><span class='Delimiter'>[</span><span class='Number'>2</span><span class='Delimiter'>]; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="wchar.c.html#LN1562"><span class='Ref_To_Local'>a</span></a> <span class='Operator'>&LT; </span><span class='Number'>0xBF</span><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <a href="wchar.c.html#LN1560"><span class='Ref_to_Parameter'>charptr</span></a><span class='Delimiter'>[</span><span class='Number'>2</span><span class='Delimiter'>]</span><span class='Operator'>++</span><span class='Delimiter'>; 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>            <span class='Comment_Multi_Line'>/* FALL THRU */ 
</span>        <span class='Control'>case</span> <span class='Number'>2</span><span class='Operator'>: 
</span>            <a href="wchar.c.html#LN1562"><span class='Ref_To_Local'>a</span></a> <span class='Operator'>= </span><a href="wchar.c.html#LN1560"><span class='Ref_to_Parameter'>charptr</span></a><span class='Delimiter'>[</span><span class='Number'>1</span><span class='Delimiter'>]; 
</span>            <span class='Control'>switch</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="wchar.c.html#LN1560"><span class='Ref_to_Parameter'>charptr</span></a><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <span class='Control'>case</span> <span class='Number'>0xED</span><span class='Operator'>: 
</span>                    <a href="wchar.c.html#LN1563"><span class='Ref_To_Local'>limit</span></a> <span class='Operator'>= </span><span class='Number'>0x9F</span><span class='Delimiter'>; 
</span>                    <span class='Control'>break</span><span class='Delimiter'>; 
</span>                <span class='Control'>case</span> <span class='Number'>0xF4</span><span class='Operator'>: 
</span>                    <a href="wchar.c.html#LN1563"><span class='Ref_To_Local'>limit</span></a> <span class='Operator'>= </span><span class='Number'>0x8F</span><span class='Delimiter'>; 
</span>                    <span class='Control'>break</span><span class='Delimiter'>; 
</span>                <span class='Control'>default</span><span class='Operator'>: 
</span>                    <a href="wchar.c.html#LN1563"><span class='Ref_To_Local'>limit</span></a> <span class='Operator'>= </span><span class='Number'>0xBF</span><span class='Delimiter'>; 
</span>                    <span class='Control'>break</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="wchar.c.html#LN1562"><span class='Ref_To_Local'>a</span></a> <span class='Operator'>&LT; </span><a href="wchar.c.html#LN1563"><span class='Ref_To_Local'>limit</span></a><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <a href="wchar.c.html#LN1560"><span class='Ref_to_Parameter'>charptr</span></a><span class='Delimiter'>[</span><span class='Number'>1</span><span class='Delimiter'>]</span><span class='Operator'>++</span><span class='Delimiter'>; 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>            <span class='Comment_Multi_Line'>/* FALL THRU */ 
</span>        <span class='Control'>case</span> <span class='Number'>1</span><span class='Operator'>: 
</span>            <a href="wchar.c.html#LN1562"><span class='Ref_To_Local'>a</span></a> <span class='Operator'>= *</span><a href="wchar.c.html#LN1560"><span class='Ref_to_Parameter'>charptr</span></a><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="wchar.c.html#LN1562"><span class='Ref_To_Local'>a</span></a> <span class='Operator'>== </span><span class='Number'>0x7F</span> <span class='Operator'>|| </span><a href="wchar.c.html#LN1562"><span class='Ref_To_Local'>a</span></a> <span class='Operator'>== </span><span class='Number'>0xDF</span> <span class='Operator'>|| </span><a href="wchar.c.html#LN1562"><span class='Ref_To_Local'>a</span></a> <span class='Operator'>== </span><span class='Number'>0xEF</span> <span class='Operator'>|| </span><a href="wchar.c.html#LN1562"><span class='Ref_To_Local'>a</span></a> <span class='Operator'>== </span><span class='Number'>0xF4</span><span class='Parentheses'>) 
</span>                <span class='Control'>return</span> <span class='Boolean'>false</span><span class='Delimiter'>; 
</span>            <a href="wchar.c.html#LN1560"><span class='Ref_to_Parameter'>charptr</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>]</span><span class='Operator'>++</span><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end switch length &raquo; </span> 
 
    <span class='Control'>return</span> <span class='Boolean'>true</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end pg_utf8_increment &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * EUC-JP character incrementer function. 
 * 
 * If the sequence starts with SS2 (0x8e), it must be a two-byte sequence 
 * representing JIS X 0201 characters with the second byte ranging between 
 * 0xa1 and 0xdf.  We just increment the last byte if it's less than 0xdf, 
 * and otherwise rewrite the whole sequence to 0xa1 0xa1. 
 * 
 * If the sequence starts with SS3 (0x8f), it must be a three-byte sequence 
 * in which the last two bytes range between 0xa1 and 0xfe.  The last byte 
 * is incremented if possible, otherwise the second-to-last byte. 
 * 
 * If the sequence starts with a value other than the above and its MSB 
 * is set, it must be a two-byte sequence representing JIS X 0208 characters 
 * with both bytes ranging between 0xa1 and 0xfe.  The last byte is 
 * incremented if possible, otherwise the second-to-last byte. 
 * 
 * Otherwise, the sequence is a single-byte ASCII character. It is 
 * incremented up to 0x7f. 
 */ 
</span><span class='Keyword'>static bool 
</span><a name="LN1638"></a><span class='Declare_Function'>pg_eucjp_increment</span><span class='Parentheses'>(</span><span class='Keyword'>unsigned char </span><span class='Operator'>*</span><span class='Declare_Parameter'>charptr</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>length</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1640"></a>    <span class='Keyword'>unsigned char </span><span class='Declare_Local'>c1</span><span class='Delimiter'>, 
</span><a name="LN1641"></a>                <span class='Declare_Local'>c2</span><span class='Delimiter'>; 
</span><a name="LN1642"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>i</span><span class='Delimiter'>; 
</span> 
    <a href="wchar.c.html#LN1640"><span class='Ref_To_Local'>c1</span></a> <span class='Operator'>= *</span><a href="wchar.c.html#LN1638"><span class='Ref_to_Parameter'>charptr</span></a><span class='Delimiter'>; 
</span> 
    <span class='Control'>switch</span> <span class='Parentheses'>(</span><a href="wchar.c.html#LN1640"><span class='Ref_To_Local'>c1</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>case</span> <a href="../../../include/mb/pg_wchar.h.html#LN34"><span class='Ref_to_Const'>SS2</span></a><span class='Operator'>:</span>               <span class='Comment_Single_Line'>/* JIS X 0201 */ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="wchar.c.html#LN1638"><span class='Ref_to_Parameter'>length</span></a> <span class='Operator'>!= </span><span class='Number'>2</span><span class='Parentheses'>) 
</span>                <span class='Control'>return</span> <span class='Boolean'>false</span><span class='Delimiter'>; 
</span> 
            <a href="wchar.c.html#LN1641"><span class='Ref_To_Local'>c2</span></a> <span class='Operator'>= </span><a href="wchar.c.html#LN1638"><span class='Ref_to_Parameter'>charptr</span></a><span class='Delimiter'>[</span><span class='Number'>1</span><span class='Delimiter'>]; 
</span> 
            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="wchar.c.html#LN1641"><span class='Ref_To_Local'>c2</span></a> <span class='Operator'>&GT;= </span><span class='Number'>0xdf</span><span class='Parentheses'>) 
</span>                <a href="wchar.c.html#LN1638"><span class='Ref_to_Parameter'>charptr</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="wchar.c.html#LN1638"><span class='Ref_to_Parameter'>charptr</span></a><span class='Delimiter'>[</span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Number'>0xa1</span><span class='Delimiter'>; 
</span>            <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="wchar.c.html#LN1641"><span class='Ref_To_Local'>c2</span></a> <span class='Operator'>&LT; </span><span class='Number'>0xa1</span><span class='Parentheses'>) 
</span>                <a href="wchar.c.html#LN1638"><span class='Ref_to_Parameter'>charptr</span></a><span class='Delimiter'>[</span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Number'>0xa1</span><span class='Delimiter'>; 
</span>            <span class='Control'>else</span> 
                <a href="wchar.c.html#LN1638"><span class='Ref_to_Parameter'>charptr</span></a><span class='Delimiter'>[</span><span class='Number'>1</span><span class='Delimiter'>]</span><span class='Operator'>++</span><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>case</span> <a href="../../../include/mb/pg_wchar.h.html#LN35"><span class='Ref_to_Const'>SS3</span></a><span class='Operator'>:</span>               <span class='Comment_Single_Line'>/* JIS X 0212 */ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="wchar.c.html#LN1638"><span class='Ref_to_Parameter'>length</span></a> <span class='Operator'>!= </span><span class='Number'>3</span><span class='Parentheses'>) 
</span>                <span class='Control'>return</span> <span class='Boolean'>false</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="wchar.c.html#LN1642"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>2</span><span class='Delimiter'>; </span><a href="wchar.c.html#LN1642"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="wchar.c.html#LN1642"><span class='Ref_To_Local'>i</span></a><span class='Operator'>--</span><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <a href="wchar.c.html#LN1641"><span class='Ref_To_Local'>c2</span></a> <span class='Operator'>= </span><a href="wchar.c.html#LN1638"><span class='Ref_to_Parameter'>charptr</span></a><span class='Delimiter'>[</span><a href="wchar.c.html#LN1642"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]; 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="wchar.c.html#LN1641"><span class='Ref_To_Local'>c2</span></a> <span class='Operator'>&LT; </span><span class='Number'>0xa1</span><span class='Parentheses'>) 
</span>                <span class='Delimiter'>{ 
</span>                    <a href="wchar.c.html#LN1638"><span class='Ref_to_Parameter'>charptr</span></a><span class='Delimiter'>[</span><a href="wchar.c.html#LN1642"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Number'>0xa1</span><span class='Delimiter'>; 
</span>                    <span class='Control'>return</span> <span class='Boolean'>true</span><span class='Delimiter'>; 
</span>                <span class='Delimiter'>} 
</span>                <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="wchar.c.html#LN1641"><span class='Ref_To_Local'>c2</span></a> <span class='Operator'>&LT; </span><span class='Number'>0xfe</span><span class='Parentheses'>) 
</span>                <span class='Delimiter'>{ 
</span>                    <a href="wchar.c.html#LN1638"><span class='Ref_to_Parameter'>charptr</span></a><span class='Delimiter'>[</span><a href="wchar.c.html#LN1642"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Operator'>++</span><span class='Delimiter'>; 
</span>                    <span class='Control'>return</span> <span class='Boolean'>true</span><span class='Delimiter'>; 
</span>                <span class='Delimiter'>} 
</span>            <span class='Delimiter'>} 
</span> 
            <span class='Comment_Multi_Line'>/* Out of 3-byte code region */ 
</span>            <span class='Control'>return</span> <span class='Boolean'>false</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>default</span><span class='Operator'>: 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/c.h.html#LN972"><span class='Ref_to_Macro'>IS_HIGHBIT_SET</span></a><span class='Parentheses'>(</span><a href="wchar.c.html#LN1640"><span class='Ref_To_Local'>c1</span></a><span class='Parentheses'>))</span>     <span class='Comment_Single_Line'>/* JIS X 0208? */ 
</span>            <span class='Delimiter'>{ 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="wchar.c.html#LN1638"><span class='Ref_to_Parameter'>length</span></a> <span class='Operator'>!= </span><span class='Number'>2</span><span class='Parentheses'>) 
</span>                    <span class='Control'>return</span> <span class='Boolean'>false</span><span class='Delimiter'>; 
</span> 
                <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="wchar.c.html#LN1642"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>; </span><a href="wchar.c.html#LN1642"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&GT;= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="wchar.c.html#LN1642"><span class='Ref_To_Local'>i</span></a><span class='Operator'>--</span><span class='Parentheses'>) 
</span>                <span class='Delimiter'>{ 
</span>                    <a href="wchar.c.html#LN1641"><span class='Ref_To_Local'>c2</span></a> <span class='Operator'>= </span><a href="wchar.c.html#LN1638"><span class='Ref_to_Parameter'>charptr</span></a><span class='Delimiter'>[</span><a href="wchar.c.html#LN1642"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]; 
</span>                    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="wchar.c.html#LN1641"><span class='Ref_To_Local'>c2</span></a> <span class='Operator'>&LT; </span><span class='Number'>0xa1</span><span class='Parentheses'>) 
</span>                    <span class='Delimiter'>{ 
</span>                        <a href="wchar.c.html#LN1638"><span class='Ref_to_Parameter'>charptr</span></a><span class='Delimiter'>[</span><a href="wchar.c.html#LN1642"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Number'>0xa1</span><span class='Delimiter'>; 
</span>                        <span class='Control'>return</span> <span class='Boolean'>true</span><span class='Delimiter'>; 
</span>                    <span class='Delimiter'>} 
</span>                    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="wchar.c.html#LN1641"><span class='Ref_To_Local'>c2</span></a> <span class='Operator'>&LT; </span><span class='Number'>0xfe</span><span class='Parentheses'>) 
</span>                    <span class='Delimiter'>{ 
</span>                        <a href="wchar.c.html#LN1638"><span class='Ref_to_Parameter'>charptr</span></a><span class='Delimiter'>[</span><a href="wchar.c.html#LN1642"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Operator'>++</span><span class='Delimiter'>; 
</span>                        <span class='Control'>return</span> <span class='Boolean'>true</span><span class='Delimiter'>; 
</span>                    <span class='Delimiter'>} 
</span>                <span class='Delimiter'>} 
</span> 
                <span class='Comment_Multi_Line'>/* Out of 2 byte code region */ 
</span>                <span class='Control'>return</span> <span class='Boolean'>false</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if IS_HIGHBIT_SET(c1) &raquo; </span> 
            <span class='Control'>else</span> 
            <span class='Delimiter'>{</span>                   <span class='Comment_Single_Line'>/* ASCII, single byte */ 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="wchar.c.html#LN1640"><span class='Ref_To_Local'>c1</span></a> <span class='Operator'>&GT; </span><span class='Number'>0x7e</span><span class='Parentheses'>) 
</span>                    <span class='Control'>return</span> <span class='Boolean'>false</span><span class='Delimiter'>; 
</span>                <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="wchar.c.html#LN1638"><span class='Ref_to_Parameter'>charptr</span></a><span class='Parentheses'>)</span><span class='Operator'>++</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end switch c1 &raquo; </span> 
 
    <span class='Control'>return</span> <span class='Boolean'>true</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end pg_eucjp_increment &raquo; </span> 
<span class='Directive'>#endif</span>   <span class='Comment_Single_Line'>/* !FRONTEND */ 
</span> 
 
<span class='Comment_Multi_Line'>/* 
 *------------------------------------------------------------------- 
 * encoding info table 
 * XXX must be sorted by the same order as enum pg_enc (in mb/pg_wchar.h) 
 *------------------------------------------------------------------- 
 */ 
</span><a name="LN1728"></a><span class='Keyword'>const </span><a href="../../../include/mb/pg_wchar.h.html#LN359"><span class='Ref_to_Typedef'>pg_wchar_tbl</span></a> <span class='Declare_Var'>pg_wchar_table</span><span class='Delimiter'>[] </span><span class='Operator'>= </span><span class='Delimiter'>{ 
</span>    <span class='Delimiter'>{</span><a href="wchar.c.html#LN38"><span class='Ref_to_Func'>pg_ascii2wchar_with_len</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN932"><span class='Ref_to_Func'>pg_wchar2single_with_len</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN53"><span class='Ref_to_Func'>pg_ascii_mblen</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN59"><span class='Ref_to_Func'>pg_ascii_dsplen</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN1118"><span class='Ref_to_Func'>pg_ascii_verifier</span></a><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Delimiter'>}, </span><span class='Comment_Single_Line'>/* PG_SQL_ASCII */ 
</span>    <span class='Delimiter'>{</span><a href="wchar.c.html#LN147"><span class='Ref_to_Func'>pg_eucjp2wchar_with_len</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN345"><span class='Ref_to_Func'>pg_wchar2euc_with_len</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN153"><span class='Ref_to_Func'>pg_eucjp_mblen</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN159"><span class='Ref_to_Func'>pg_eucjp_dsplen</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN1126"><span class='Ref_to_Func'>pg_eucjp_verifier</span></a><span class='Delimiter'>, </span><span class='Number'>3</span><span class='Delimiter'>},</span>    <span class='Comment_Single_Line'>/* PG_EUC_JP */ 
</span>    <span class='Delimiter'>{</span><a href="wchar.c.html#LN200"><span class='Ref_to_Func'>pg_euccn2wchar_with_len</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN345"><span class='Ref_to_Func'>pg_wchar2euc_with_len</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN239"><span class='Ref_to_Func'>pg_euccn_mblen</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN251"><span class='Ref_to_Func'>pg_euccn_dsplen</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN1211"><span class='Ref_to_Const'>pg_euccn_verifier</span></a><span class='Delimiter'>, </span><span class='Number'>2</span><span class='Delimiter'>},</span>    <span class='Comment_Single_Line'>/* PG_EUC_CN */ 
</span>    <span class='Delimiter'>{</span><a href="wchar.c.html#LN178"><span class='Ref_to_Func'>pg_euckr2wchar_with_len</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN345"><span class='Ref_to_Func'>pg_wchar2euc_with_len</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN184"><span class='Ref_to_Func'>pg_euckr_mblen</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN190"><span class='Ref_to_Func'>pg_euckr_dsplen</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN1181"><span class='Ref_to_Func'>pg_euckr_verifier</span></a><span class='Delimiter'>, </span><span class='Number'>3</span><span class='Delimiter'>},</span>    <span class='Comment_Single_Line'>/* PG_EUC_KR */ 
</span>    <span class='Delimiter'>{</span><a href="wchar.c.html#LN267"><span class='Ref_to_Func'>pg_euctw2wchar_with_len</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN345"><span class='Ref_to_Func'>pg_wchar2euc_with_len</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN307"><span class='Ref_to_Func'>pg_euctw_mblen</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN323"><span class='Ref_to_Func'>pg_euctw_dsplen</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN1213"><span class='Ref_to_Func'>pg_euctw_verifier</span></a><span class='Delimiter'>, </span><span class='Number'>4</span><span class='Delimiter'>},</span>    <span class='Comment_Single_Line'>/* PG_EUC_TW */ 
</span>    <span class='Delimiter'>{</span><a href="wchar.c.html#LN147"><span class='Ref_to_Func'>pg_eucjp2wchar_with_len</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN345"><span class='Ref_to_Func'>pg_wchar2euc_with_len</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN153"><span class='Ref_to_Func'>pg_eucjp_mblen</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN159"><span class='Ref_to_Func'>pg_eucjp_dsplen</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN1126"><span class='Ref_to_Func'>pg_eucjp_verifier</span></a><span class='Delimiter'>, </span><span class='Number'>3</span><span class='Delimiter'>},</span>    <span class='Comment_Single_Line'>/* PG_EUC_JIS_2004 */ 
</span>    <span class='Delimiter'>{</span><a href="wchar.c.html#LN409"><span class='Ref_to_Func'>pg_utf2wchar_with_len</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN508"><span class='Ref_to_Func'>pg_wchar2utf_with_len</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN539"><span class='Ref_to_Func'>pg_utf_mblen</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN734"><span class='Ref_to_Func'>pg_utf_dsplen</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN1428"><span class='Ref_to_Func'>pg_utf8_verifier</span></a><span class='Delimiter'>, </span><span class='Number'>4</span><span class='Delimiter'>},</span>   <span class='Comment_Single_Line'>/* PG_UTF8 */ 
</span>    <span class='Delimiter'>{</span><a href="wchar.c.html#LN746"><span class='Ref_to_Func'>pg_mule2wchar_with_len</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN799"><span class='Ref_to_Func'>pg_wchar2mule_with_len</span></a><span class='Delimiter'>, </span><a href="../../../include/mb/pg_wchar.h.html#LN526"><span class='Ref_to_Proto'>pg_mule_mblen</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN882"><span class='Ref_to_Func'>pg_mule_dsplen</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN1287"><span class='Ref_to_Func'>pg_mule_verifier</span></a><span class='Delimiter'>, </span><span class='Number'>4</span><span class='Delimiter'>},</span>       <span class='Comment_Single_Line'>/* PG_MULE_INTERNAL */ 
</span>    <span class='Delimiter'>{</span><a href="wchar.c.html#LN910"><span class='Ref_to_Func'>pg_latin12wchar_with_len</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN932"><span class='Ref_to_Func'>pg_wchar2single_with_len</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN947"><span class='Ref_to_Func'>pg_latin1_mblen</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN953"><span class='Ref_to_Func'>pg_latin1_dsplen</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN1308"><span class='Ref_to_Func'>pg_latin1_verifier</span></a><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Delimiter'>},</span>     <span class='Comment_Single_Line'>/* PG_LATIN1 */ 
</span>    <span class='Delimiter'>{</span><a href="wchar.c.html#LN910"><span class='Ref_to_Func'>pg_latin12wchar_with_len</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN932"><span class='Ref_to_Func'>pg_wchar2single_with_len</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN947"><span class='Ref_to_Func'>pg_latin1_mblen</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN953"><span class='Ref_to_Func'>pg_latin1_dsplen</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN1308"><span class='Ref_to_Func'>pg_latin1_verifier</span></a><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Delimiter'>},</span>     <span class='Comment_Single_Line'>/* PG_LATIN2 */ 
</span>    <span class='Delimiter'>{</span><a href="wchar.c.html#LN910"><span class='Ref_to_Func'>pg_latin12wchar_with_len</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN932"><span class='Ref_to_Func'>pg_wchar2single_with_len</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN947"><span class='Ref_to_Func'>pg_latin1_mblen</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN953"><span class='Ref_to_Func'>pg_latin1_dsplen</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN1308"><span class='Ref_to_Func'>pg_latin1_verifier</span></a><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Delimiter'>},</span>     <span class='Comment_Single_Line'>/* PG_LATIN3 */ 
</span>    <span class='Delimiter'>{</span><a href="wchar.c.html#LN910"><span class='Ref_to_Func'>pg_latin12wchar_with_len</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN932"><span class='Ref_to_Func'>pg_wchar2single_with_len</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN947"><span class='Ref_to_Func'>pg_latin1_mblen</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN953"><span class='Ref_to_Func'>pg_latin1_dsplen</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN1308"><span class='Ref_to_Func'>pg_latin1_verifier</span></a><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Delimiter'>},</span>     <span class='Comment_Single_Line'>/* PG_LATIN4 */ 
</span>    <span class='Delimiter'>{</span><a href="wchar.c.html#LN910"><span class='Ref_to_Func'>pg_latin12wchar_with_len</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN932"><span class='Ref_to_Func'>pg_wchar2single_with_len</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN947"><span class='Ref_to_Func'>pg_latin1_mblen</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN953"><span class='Ref_to_Func'>pg_latin1_dsplen</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN1308"><span class='Ref_to_Func'>pg_latin1_verifier</span></a><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Delimiter'>},</span>     <span class='Comment_Single_Line'>/* PG_LATIN5 */ 
</span>    <span class='Delimiter'>{</span><a href="wchar.c.html#LN910"><span class='Ref_to_Func'>pg_latin12wchar_with_len</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN932"><span class='Ref_to_Func'>pg_wchar2single_with_len</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN947"><span class='Ref_to_Func'>pg_latin1_mblen</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN953"><span class='Ref_to_Func'>pg_latin1_dsplen</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN1308"><span class='Ref_to_Func'>pg_latin1_verifier</span></a><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Delimiter'>},</span>     <span class='Comment_Single_Line'>/* PG_LATIN6 */ 
</span>    <span class='Delimiter'>{</span><a href="wchar.c.html#LN910"><span class='Ref_to_Func'>pg_latin12wchar_with_len</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN932"><span class='Ref_to_Func'>pg_wchar2single_with_len</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN947"><span class='Ref_to_Func'>pg_latin1_mblen</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN953"><span class='Ref_to_Func'>pg_latin1_dsplen</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN1308"><span class='Ref_to_Func'>pg_latin1_verifier</span></a><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Delimiter'>},</span>     <span class='Comment_Single_Line'>/* PG_LATIN7 */ 
</span>    <span class='Delimiter'>{</span><a href="wchar.c.html#LN910"><span class='Ref_to_Func'>pg_latin12wchar_with_len</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN932"><span class='Ref_to_Func'>pg_wchar2single_with_len</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN947"><span class='Ref_to_Func'>pg_latin1_mblen</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN953"><span class='Ref_to_Func'>pg_latin1_dsplen</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN1308"><span class='Ref_to_Func'>pg_latin1_verifier</span></a><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Delimiter'>},</span>     <span class='Comment_Single_Line'>/* PG_LATIN8 */ 
</span>    <span class='Delimiter'>{</span><a href="wchar.c.html#LN910"><span class='Ref_to_Func'>pg_latin12wchar_with_len</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN932"><span class='Ref_to_Func'>pg_wchar2single_with_len</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN947"><span class='Ref_to_Func'>pg_latin1_mblen</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN953"><span class='Ref_to_Func'>pg_latin1_dsplen</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN1308"><span class='Ref_to_Func'>pg_latin1_verifier</span></a><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Delimiter'>},</span>     <span class='Comment_Single_Line'>/* PG_LATIN9 */ 
</span>    <span class='Delimiter'>{</span><a href="wchar.c.html#LN910"><span class='Ref_to_Func'>pg_latin12wchar_with_len</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN932"><span class='Ref_to_Func'>pg_wchar2single_with_len</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN947"><span class='Ref_to_Func'>pg_latin1_mblen</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN953"><span class='Ref_to_Func'>pg_latin1_dsplen</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN1308"><span class='Ref_to_Func'>pg_latin1_verifier</span></a><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Delimiter'>},</span>     <span class='Comment_Single_Line'>/* PG_LATIN10 */ 
</span>    <span class='Delimiter'>{</span><a href="wchar.c.html#LN910"><span class='Ref_to_Func'>pg_latin12wchar_with_len</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN932"><span class='Ref_to_Func'>pg_wchar2single_with_len</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN947"><span class='Ref_to_Func'>pg_latin1_mblen</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN953"><span class='Ref_to_Func'>pg_latin1_dsplen</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN1308"><span class='Ref_to_Func'>pg_latin1_verifier</span></a><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Delimiter'>},</span>     <span class='Comment_Single_Line'>/* PG_WIN1256 */ 
</span>    <span class='Delimiter'>{</span><a href="wchar.c.html#LN910"><span class='Ref_to_Func'>pg_latin12wchar_with_len</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN932"><span class='Ref_to_Func'>pg_wchar2single_with_len</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN947"><span class='Ref_to_Func'>pg_latin1_mblen</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN953"><span class='Ref_to_Func'>pg_latin1_dsplen</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN1308"><span class='Ref_to_Func'>pg_latin1_verifier</span></a><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Delimiter'>},</span>     <span class='Comment_Single_Line'>/* PG_WIN1258 */ 
</span>    <span class='Delimiter'>{</span><a href="wchar.c.html#LN910"><span class='Ref_to_Func'>pg_latin12wchar_with_len</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN932"><span class='Ref_to_Func'>pg_wchar2single_with_len</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN947"><span class='Ref_to_Func'>pg_latin1_mblen</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN953"><span class='Ref_to_Func'>pg_latin1_dsplen</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN1308"><span class='Ref_to_Func'>pg_latin1_verifier</span></a><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Delimiter'>},</span>     <span class='Comment_Single_Line'>/* PG_WIN866 */ 
</span>    <span class='Delimiter'>{</span><a href="wchar.c.html#LN910"><span class='Ref_to_Func'>pg_latin12wchar_with_len</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN932"><span class='Ref_to_Func'>pg_wchar2single_with_len</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN947"><span class='Ref_to_Func'>pg_latin1_mblen</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN953"><span class='Ref_to_Func'>pg_latin1_dsplen</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN1308"><span class='Ref_to_Func'>pg_latin1_verifier</span></a><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Delimiter'>},</span>     <span class='Comment_Single_Line'>/* PG_WIN874 */ 
</span>    <span class='Delimiter'>{</span><a href="wchar.c.html#LN910"><span class='Ref_to_Func'>pg_latin12wchar_with_len</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN932"><span class='Ref_to_Func'>pg_wchar2single_with_len</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN947"><span class='Ref_to_Func'>pg_latin1_mblen</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN953"><span class='Ref_to_Func'>pg_latin1_dsplen</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN1308"><span class='Ref_to_Func'>pg_latin1_verifier</span></a><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Delimiter'>},</span>     <span class='Comment_Single_Line'>/* PG_KOI8R */ 
</span>    <span class='Delimiter'>{</span><a href="wchar.c.html#LN910"><span class='Ref_to_Func'>pg_latin12wchar_with_len</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN932"><span class='Ref_to_Func'>pg_wchar2single_with_len</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN947"><span class='Ref_to_Func'>pg_latin1_mblen</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN953"><span class='Ref_to_Func'>pg_latin1_dsplen</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN1308"><span class='Ref_to_Func'>pg_latin1_verifier</span></a><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Delimiter'>},</span>     <span class='Comment_Single_Line'>/* PG_WIN1251 */ 
</span>    <span class='Delimiter'>{</span><a href="wchar.c.html#LN910"><span class='Ref_to_Func'>pg_latin12wchar_with_len</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN932"><span class='Ref_to_Func'>pg_wchar2single_with_len</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN947"><span class='Ref_to_Func'>pg_latin1_mblen</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN953"><span class='Ref_to_Func'>pg_latin1_dsplen</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN1308"><span class='Ref_to_Func'>pg_latin1_verifier</span></a><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Delimiter'>},</span>     <span class='Comment_Single_Line'>/* PG_WIN1252 */ 
</span>    <span class='Delimiter'>{</span><a href="wchar.c.html#LN910"><span class='Ref_to_Func'>pg_latin12wchar_with_len</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN932"><span class='Ref_to_Func'>pg_wchar2single_with_len</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN947"><span class='Ref_to_Func'>pg_latin1_mblen</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN953"><span class='Ref_to_Func'>pg_latin1_dsplen</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN1308"><span class='Ref_to_Func'>pg_latin1_verifier</span></a><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Delimiter'>},</span>     <span class='Comment_Single_Line'>/* ISO-8859-5 */ 
</span>    <span class='Delimiter'>{</span><a href="wchar.c.html#LN910"><span class='Ref_to_Func'>pg_latin12wchar_with_len</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN932"><span class='Ref_to_Func'>pg_wchar2single_with_len</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN947"><span class='Ref_to_Func'>pg_latin1_mblen</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN953"><span class='Ref_to_Func'>pg_latin1_dsplen</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN1308"><span class='Ref_to_Func'>pg_latin1_verifier</span></a><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Delimiter'>},</span>     <span class='Comment_Single_Line'>/* ISO-8859-6 */ 
</span>    <span class='Delimiter'>{</span><a href="wchar.c.html#LN910"><span class='Ref_to_Func'>pg_latin12wchar_with_len</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN932"><span class='Ref_to_Func'>pg_wchar2single_with_len</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN947"><span class='Ref_to_Func'>pg_latin1_mblen</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN953"><span class='Ref_to_Func'>pg_latin1_dsplen</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN1308"><span class='Ref_to_Func'>pg_latin1_verifier</span></a><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Delimiter'>},</span>     <span class='Comment_Single_Line'>/* ISO-8859-7 */ 
</span>    <span class='Delimiter'>{</span><a href="wchar.c.html#LN910"><span class='Ref_to_Func'>pg_latin12wchar_with_len</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN932"><span class='Ref_to_Func'>pg_wchar2single_with_len</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN947"><span class='Ref_to_Func'>pg_latin1_mblen</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN953"><span class='Ref_to_Func'>pg_latin1_dsplen</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN1308"><span class='Ref_to_Func'>pg_latin1_verifier</span></a><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Delimiter'>},</span>     <span class='Comment_Single_Line'>/* ISO-8859-8 */ 
</span>    <span class='Delimiter'>{</span><a href="wchar.c.html#LN910"><span class='Ref_to_Func'>pg_latin12wchar_with_len</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN932"><span class='Ref_to_Func'>pg_wchar2single_with_len</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN947"><span class='Ref_to_Func'>pg_latin1_mblen</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN953"><span class='Ref_to_Func'>pg_latin1_dsplen</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN1308"><span class='Ref_to_Func'>pg_latin1_verifier</span></a><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Delimiter'>},</span>     <span class='Comment_Single_Line'>/* PG_WIN1250 */ 
</span>    <span class='Delimiter'>{</span><a href="wchar.c.html#LN910"><span class='Ref_to_Func'>pg_latin12wchar_with_len</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN932"><span class='Ref_to_Func'>pg_wchar2single_with_len</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN947"><span class='Ref_to_Func'>pg_latin1_mblen</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN953"><span class='Ref_to_Func'>pg_latin1_dsplen</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN1308"><span class='Ref_to_Func'>pg_latin1_verifier</span></a><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Delimiter'>},</span>     <span class='Comment_Single_Line'>/* PG_WIN1253 */ 
</span>    <span class='Delimiter'>{</span><a href="wchar.c.html#LN910"><span class='Ref_to_Func'>pg_latin12wchar_with_len</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN932"><span class='Ref_to_Func'>pg_wchar2single_with_len</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN947"><span class='Ref_to_Func'>pg_latin1_mblen</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN953"><span class='Ref_to_Func'>pg_latin1_dsplen</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN1308"><span class='Ref_to_Func'>pg_latin1_verifier</span></a><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Delimiter'>},</span>     <span class='Comment_Single_Line'>/* PG_WIN1254 */ 
</span>    <span class='Delimiter'>{</span><a href="wchar.c.html#LN910"><span class='Ref_to_Func'>pg_latin12wchar_with_len</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN932"><span class='Ref_to_Func'>pg_wchar2single_with_len</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN947"><span class='Ref_to_Func'>pg_latin1_mblen</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN953"><span class='Ref_to_Func'>pg_latin1_dsplen</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN1308"><span class='Ref_to_Func'>pg_latin1_verifier</span></a><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Delimiter'>},</span>     <span class='Comment_Single_Line'>/* PG_WIN1255 */ 
</span>    <span class='Delimiter'>{</span><a href="wchar.c.html#LN910"><span class='Ref_to_Func'>pg_latin12wchar_with_len</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN932"><span class='Ref_to_Func'>pg_wchar2single_with_len</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN947"><span class='Ref_to_Func'>pg_latin1_mblen</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN953"><span class='Ref_to_Func'>pg_latin1_dsplen</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN1308"><span class='Ref_to_Func'>pg_latin1_verifier</span></a><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Delimiter'>},</span>     <span class='Comment_Single_Line'>/* PG_WIN1257 */ 
</span>    <span class='Delimiter'>{</span><a href="wchar.c.html#LN910"><span class='Ref_to_Func'>pg_latin12wchar_with_len</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN932"><span class='Ref_to_Func'>pg_wchar2single_with_len</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN947"><span class='Ref_to_Func'>pg_latin1_mblen</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN953"><span class='Ref_to_Func'>pg_latin1_dsplen</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN1308"><span class='Ref_to_Func'>pg_latin1_verifier</span></a><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Delimiter'>},</span>     <span class='Comment_Single_Line'>/* PG_KOI8U */ 
</span>    <span class='Delimiter'>{</span><span class='Number'>0</span><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Delimiter'>, </span><a href="wchar.c.html#LN962"><span class='Ref_to_Func'>pg_sjis_mblen</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN976"><span class='Ref_to_Func'>pg_sjis_dsplen</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN1314"><span class='Ref_to_Func'>pg_sjis_verifier</span></a><span class='Delimiter'>, </span><span class='Number'>2</span><span class='Delimiter'>}, </span><span class='Comment_Single_Line'>/* PG_SJIS */ 
</span>    <span class='Delimiter'>{</span><span class='Number'>0</span><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Delimiter'>, </span><a href="wchar.c.html#LN993"><span class='Ref_to_Func'>pg_big5_mblen</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN1005"><span class='Ref_to_Func'>pg_big5_dsplen</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN1337"><span class='Ref_to_Func'>pg_big5_verifier</span></a><span class='Delimiter'>, </span><span class='Number'>2</span><span class='Delimiter'>}, </span><span class='Comment_Single_Line'>/* PG_BIG5 */ 
</span>    <span class='Delimiter'>{</span><span class='Number'>0</span><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Delimiter'>, </span><a href="wchar.c.html#LN1020"><span class='Ref_to_Func'>pg_gbk_mblen</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN1032"><span class='Ref_to_Func'>pg_gbk_dsplen</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN1357"><span class='Ref_to_Func'>pg_gbk_verifier</span></a><span class='Delimiter'>, </span><span class='Number'>2</span><span class='Delimiter'>},</span>    <span class='Comment_Single_Line'>/* PG_GBK */ 
</span>    <span class='Delimiter'>{</span><span class='Number'>0</span><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Delimiter'>, </span><a href="wchar.c.html#LN1047"><span class='Ref_to_Func'>pg_uhc_mblen</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN1059"><span class='Ref_to_Func'>pg_uhc_dsplen</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN1377"><span class='Ref_to_Func'>pg_uhc_verifier</span></a><span class='Delimiter'>, </span><span class='Number'>2</span><span class='Delimiter'>},</span>    <span class='Comment_Single_Line'>/* PG_UHC */ 
</span>    <span class='Delimiter'>{</span><span class='Number'>0</span><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Delimiter'>, </span><a href="wchar.c.html#LN1075"><span class='Ref_to_Func'>pg_gb18030_mblen</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN1089"><span class='Ref_to_Func'>pg_gb18030_dsplen</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN1397"><span class='Ref_to_Func'>pg_gb18030_verifier</span></a><span class='Delimiter'>, </span><span class='Number'>4</span><span class='Delimiter'>},</span>        <span class='Comment_Single_Line'>/* PG_GB18030 */ 
</span>    <span class='Delimiter'>{</span><span class='Number'>0</span><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Delimiter'>, </span><a href="wchar.c.html#LN391"><span class='Ref_to_Func'>pg_johab_mblen</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN397"><span class='Ref_to_Func'>pg_johab_dsplen</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN1263"><span class='Ref_to_Func'>pg_johab_verifier</span></a><span class='Delimiter'>, </span><span class='Number'>3</span><span class='Delimiter'>},</span>      <span class='Comment_Single_Line'>/* PG_JOHAB */ 
</span>    <span class='Delimiter'>{</span><span class='Number'>0</span><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Delimiter'>, </span><a href="wchar.c.html#LN962"><span class='Ref_to_Func'>pg_sjis_mblen</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN976"><span class='Ref_to_Func'>pg_sjis_dsplen</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN1314"><span class='Ref_to_Func'>pg_sjis_verifier</span></a><span class='Delimiter'>, </span><span class='Number'>2</span><span class='Delimiter'>}</span>  <span class='Comment_Single_Line'>/* PG_SHIFT_JIS_2004 */ 
</span><span class='Delimiter'>}; 
</span> 
<span class='Comment_Multi_Line'>/* returns the byte length of a word for mule internal code */ 
</span><span class='Keyword'>int 
</span><a name="LN1775"></a><span class='Declare_Function'>pg_mic_mblen</span><span class='Parentheses'>(</span><span class='Keyword'>const unsigned char </span><span class='Operator'>*</span><span class='Declare_Parameter'>mbstr</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>return</span> <a href="../../../include/mb/pg_wchar.h.html#LN526"><span class='Ref_to_Proto'>pg_mule_mblen</span></a><span class='Parentheses'>(</span><a href="wchar.c.html#LN1775"><span class='Ref_to_Parameter'>mbstr</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * Returns the byte length of a multibyte character. 
 */ 
</span><span class='Keyword'>int 
</span><a name="LN1784"></a><span class='Declare_Function'>pg_encoding_mblen</span><span class='Parentheses'>(</span><span class='Keyword'>int </span><span class='Declare_Parameter'>encoding</span><span class='Delimiter'>, </span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>mbstr</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>return</span> <span class='Parentheses'>(</span><a href="../../../include/mb/pg_wchar.h.html#LN298"><span class='Ref_to_Macro'>PG_VALID_ENCODING</span></a><span class='Parentheses'>(</span><a href="wchar.c.html#LN1784"><span class='Ref_to_Parameter'>encoding</span></a><span class='Parentheses'>)</span> <span class='Operator'>? 
</span>        <span class='Parentheses'>((</span><span class='Operator'>*</span><a href="wchar.c.html#LN1728"><span class='Ref_to_Global_Var'>pg_wchar_table</span></a><span class='Delimiter'>[</span><a href="wchar.c.html#LN1784"><span class='Ref_to_Parameter'>encoding</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="../../../include/mb/pg_wchar.h.html#LN365"><span class='Ref_to_Member'>mblen</span></a><span class='Parentheses'>)</span> <span class='Parentheses'>((</span><span class='Keyword'>const unsigned char </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="wchar.c.html#LN1784"><span class='Ref_to_Parameter'>mbstr</span></a><span class='Parentheses'>))</span> <span class='Operator'>: 
</span>    <span class='Parentheses'>((</span><span class='Operator'>*</span><a href="wchar.c.html#LN1728"><span class='Ref_to_Global_Var'>pg_wchar_table</span></a><span class='Delimiter'>[</span><a href="../../../include/mb/pg_wchar.h.html#LN237"><span class='Ref_to_EnumConst'>PG_SQL_ASCII</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="../../../include/mb/pg_wchar.h.html#LN365"><span class='Ref_to_Member'>mblen</span></a><span class='Parentheses'>)</span> <span class='Parentheses'>((</span><span class='Keyword'>const unsigned char </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="wchar.c.html#LN1784"><span class='Ref_to_Parameter'>mbstr</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * Returns the display length of a multibyte character. 
 */ 
</span><span class='Keyword'>int 
</span><a name="LN1795"></a><span class='Declare_Function'>pg_encoding_dsplen</span><span class='Parentheses'>(</span><span class='Keyword'>int </span><span class='Declare_Parameter'>encoding</span><span class='Delimiter'>, </span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>mbstr</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>return</span> <span class='Parentheses'>(</span><a href="../../../include/mb/pg_wchar.h.html#LN298"><span class='Ref_to_Macro'>PG_VALID_ENCODING</span></a><span class='Parentheses'>(</span><a href="wchar.c.html#LN1795"><span class='Ref_to_Parameter'>encoding</span></a><span class='Parentheses'>)</span> <span class='Operator'>? 
</span>       <span class='Parentheses'>((</span><span class='Operator'>*</span><a href="wchar.c.html#LN1728"><span class='Ref_to_Global_Var'>pg_wchar_table</span></a><span class='Delimiter'>[</span><a href="wchar.c.html#LN1795"><span class='Ref_to_Parameter'>encoding</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="../../../include/mb/pg_wchar.h.html#LN366"><span class='Ref_to_Member'>dsplen</span></a><span class='Parentheses'>)</span> <span class='Parentheses'>((</span><span class='Keyword'>const unsigned char </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="wchar.c.html#LN1795"><span class='Ref_to_Parameter'>mbstr</span></a><span class='Parentheses'>))</span> <span class='Operator'>: 
</span>    <span class='Parentheses'>((</span><span class='Operator'>*</span><a href="wchar.c.html#LN1728"><span class='Ref_to_Global_Var'>pg_wchar_table</span></a><span class='Delimiter'>[</span><a href="../../../include/mb/pg_wchar.h.html#LN237"><span class='Ref_to_EnumConst'>PG_SQL_ASCII</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="../../../include/mb/pg_wchar.h.html#LN366"><span class='Ref_to_Member'>dsplen</span></a><span class='Parentheses'>)</span> <span class='Parentheses'>((</span><span class='Keyword'>const unsigned char </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="wchar.c.html#LN1795"><span class='Ref_to_Parameter'>mbstr</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * Verify the first multibyte character of the given string. 
 * Return its byte length if good, -1 if bad.  (See comments above for 
 * full details of the mbverify API.) 
 */ 
</span><span class='Keyword'>int 
</span><a name="LN1808"></a><span class='Declare_Function'>pg_encoding_verifymb</span><span class='Parentheses'>(</span><span class='Keyword'>int </span><span class='Declare_Parameter'>encoding</span><span class='Delimiter'>, </span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>mbstr</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>len</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>return</span> <span class='Parentheses'>(</span><a href="../../../include/mb/pg_wchar.h.html#LN298"><span class='Ref_to_Macro'>PG_VALID_ENCODING</span></a><span class='Parentheses'>(</span><a href="wchar.c.html#LN1808"><span class='Ref_to_Parameter'>encoding</span></a><span class='Parentheses'>)</span> <span class='Operator'>? 
</span>            <span class='Parentheses'>((</span><span class='Operator'>*</span><a href="wchar.c.html#LN1728"><span class='Ref_to_Global_Var'>pg_wchar_table</span></a><span class='Delimiter'>[</span><a href="wchar.c.html#LN1808"><span class='Ref_to_Parameter'>encoding</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="../../../include/mb/pg_wchar.h.html#LN367"><span class='Ref_to_Member'>mbverify</span></a><span class='Parentheses'>)</span> <span class='Parentheses'>((</span><span class='Keyword'>const unsigned char </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="wchar.c.html#LN1808"><span class='Ref_to_Parameter'>mbstr</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN1808"><span class='Ref_to_Parameter'>len</span></a><span class='Parentheses'>))</span> <span class='Operator'>: 
</span>            <span class='Parentheses'>((</span><span class='Operator'>*</span><a href="wchar.c.html#LN1728"><span class='Ref_to_Global_Var'>pg_wchar_table</span></a><span class='Delimiter'>[</span><a href="../../../include/mb/pg_wchar.h.html#LN237"><span class='Ref_to_EnumConst'>PG_SQL_ASCII</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="../../../include/mb/pg_wchar.h.html#LN367"><span class='Ref_to_Member'>mbverify</span></a><span class='Parentheses'>)</span> <span class='Parentheses'>((</span><span class='Keyword'>const unsigned char </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="wchar.c.html#LN1808"><span class='Ref_to_Parameter'>mbstr</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN1808"><span class='Ref_to_Parameter'>len</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * fetch maximum length of a given encoding 
 */ 
</span><span class='Keyword'>int 
</span><a name="LN1819"></a><span class='Declare_Function'>pg_encoding_max_length</span><span class='Parentheses'>(</span><span class='Keyword'>int </span><span class='Declare_Parameter'>encoding</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="../../../include/mb/pg_wchar.h.html#LN298"><span class='Ref_to_Macro'>PG_VALID_ENCODING</span></a><span class='Parentheses'>(</span><a href="wchar.c.html#LN1819"><span class='Ref_to_Parameter'>encoding</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="wchar.c.html#LN1728"><span class='Ref_to_Global_Var'>pg_wchar_table</span></a><span class='Delimiter'>[</span><a href="wchar.c.html#LN1819"><span class='Ref_to_Parameter'>encoding</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="../../../include/mb/pg_wchar.h.html#LN368"><span class='Ref_to_Member'>maxmblen</span></a><span class='Delimiter'>; 
} 
</span> 
<span class='Directive'>#ifndef</span> <a href="../../../bin/pg_waldump/rmgrdesc.c.html#LN7"><span class='Ref_to_Const'>FRONTEND</span></a> 
 
<span class='Comment_Multi_Line'>/* 
 * fetch maximum length of the encoding for the current database 
 */ 
</span><span class='Keyword'>int 
</span><a name="LN1832"></a><span class='Declare_Function'>pg_database_encoding_max_length</span><span class='Parentheses'>(</span><span class='Keyword'>void</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>return</span> <a href="wchar.c.html#LN1728"><span class='Ref_to_Global_Var'>pg_wchar_table</span></a><span class='Delimiter'>[</span><a href="../../../include/mb/pg_wchar.h.html#LN545"><span class='Ref_to_Proto'>GetDatabaseEncoding</span></a><span class='Parentheses'>()</span><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="../../../include/mb/pg_wchar.h.html#LN368"><span class='Ref_to_Member'>maxmblen</span></a><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * get the character incrementer for the encoding for the current database 
 */ 
</span><a href="../../../include/mb/pg_wchar.h.html#LN355"><span class='Ref_to_Typedef'>mbcharacter_incrementer</span></a> 
<a name="LN1841"></a><span class='Declare_Function'>pg_database_encoding_character_incrementer</span><span class='Parentheses'>(</span><span class='Keyword'>void</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Comment_Multi_Line'>/* 
     * Eventually it might be best to add a field to pg_wchar_table[], but for 
     * now we just use a switch. 
     */ 
</span>    <span class='Control'>switch</span> <span class='Parentheses'>(</span><a href="../../../include/mb/pg_wchar.h.html#LN545"><span class='Ref_to_Proto'>GetDatabaseEncoding</span></a><span class='Parentheses'>())</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Control'>case</span> <a href="../../../fe_utils/mbprint.c.html#LN42"><span class='Ref_to_Const'>PG_UTF8</span></a><span class='Operator'>: 
</span>            <span class='Control'>return</span> <a href="wchar.c.html#LN1559"><span class='Ref_to_Func'>pg_utf8_increment</span></a><span class='Delimiter'>; 
</span> 
        <span class='Control'>case</span> <a href="../../../include/mb/pg_wchar.h.html#LN238"><span class='Ref_to_EnumConst'>PG_EUC_JP</span></a><span class='Operator'>: 
</span>            <span class='Control'>return</span> <a href="wchar.c.html#LN1637"><span class='Ref_to_Func'>pg_eucjp_increment</span></a><span class='Delimiter'>; 
</span> 
        <span class='Control'>default</span><span class='Operator'>: 
</span>            <span class='Control'>return</span> <a href="wchar.c.html#LN1525"><span class='Ref_to_Func'>pg_generic_charinc</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * Verify mbstr to make sure that it is validly encoded in the current 
 * database encoding.  Otherwise same as pg_verify_mbstr(). 
 */ 
</span><span class='Keyword'>bool 
</span><a name="LN1865"></a><span class='Declare_Function'>pg_verifymbstr</span><span class='Parentheses'>(</span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>mbstr</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>len</span><span class='Delimiter'>, </span><span class='Keyword'>bool </span><span class='Declare_Parameter'>noError</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>return</span> 
        <a href="../../../include/mb/pg_wchar.h.html#LN588"><span class='Ref_to_Proto'>pg_verify_mbstr_len</span></a><span class='Parentheses'>(</span><a href="../../../include/mb/pg_wchar.h.html#LN545"><span class='Ref_to_Proto'>GetDatabaseEncoding</span></a><span class='Parentheses'>()</span><span class='Delimiter'>, </span><a href="wchar.c.html#LN1865"><span class='Ref_to_Parameter'>mbstr</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN1865"><span class='Ref_to_Parameter'>len</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN1865"><span class='Ref_to_Parameter'>noError</span></a><span class='Parentheses'>)</span> <span class='Operator'>&GT;= </span><span class='Number'>0</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * Verify mbstr to make sure that it is validly encoded in the specified 
 * encoding. 
 */ 
</span><span class='Keyword'>bool 
</span><a name="LN1876"></a><span class='Declare_Function'>pg_verify_mbstr</span><span class='Parentheses'>(</span><span class='Keyword'>int </span><span class='Declare_Parameter'>encoding</span><span class='Delimiter'>, </span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>mbstr</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>len</span><span class='Delimiter'>, </span><span class='Keyword'>bool </span><span class='Declare_Parameter'>noError</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>return</span> <a href="../../../include/mb/pg_wchar.h.html#LN588"><span class='Ref_to_Proto'>pg_verify_mbstr_len</span></a><span class='Parentheses'>(</span><a href="wchar.c.html#LN1876"><span class='Ref_to_Parameter'>encoding</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN1876"><span class='Ref_to_Parameter'>mbstr</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN1876"><span class='Ref_to_Parameter'>len</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN1876"><span class='Ref_to_Parameter'>noError</span></a><span class='Parentheses'>) </span><span class='Operator'>&GT;= </span><span class='Number'>0</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * Verify mbstr to make sure that it is validly encoded in the specified 
 * encoding. 
 * 
 * mbstr is not necessarily zero terminated; length of mbstr is 
 * specified by len. 
 * 
 * If OK, return length of string in the encoding. 
 * If a problem is found, return -1 when noError is 
 * true; when noError is false, ereport() a descriptive message. 
 */ 
</span><span class='Keyword'>int 
</span><a name="LN1893"></a><span class='Declare_Function'>pg_verify_mbstr_len</span><span class='Parentheses'>(</span><span class='Keyword'>int </span><span class='Declare_Parameter'>encoding</span><span class='Delimiter'>, </span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>mbstr</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>len</span><span class='Delimiter'>, </span><span class='Keyword'>bool </span><span class='Declare_Parameter'>noError</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1895"></a>    <a href="../../../include/mb/pg_wchar.h.html#LN357"><span class='Ref_to_Typedef'>mbverifier</span></a>  <span class='Declare_Local'>mbverify</span><span class='Delimiter'>; 
</span><a name="LN1896"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>mb_len</span><span class='Delimiter'>; 
</span> 
    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="../../../include/mb/pg_wchar.h.html#LN298"><span class='Ref_to_Macro'>PG_VALID_ENCODING</span></a><span class='Parentheses'>(</span><a href="wchar.c.html#LN1893"><span class='Ref_to_Parameter'>encoding</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * In single-byte encodings, we need only reject nulls (\0). 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/mb/pg_wchar.h.html#LN534"><span class='Ref_to_Proto'>pg_encoding_max_length</span></a><span class='Parentheses'>(</span><a href="wchar.c.html#LN1893"><span class='Ref_to_Parameter'>encoding</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT;= </span><span class='Number'>1</span><span class='Parentheses'>)</span> 
    <span class='Delimiter'>{ 
</span><a name="LN1905"></a>        <span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Local'>nullpos</span> <span class='Operator'>= </span>memchr<span class='Parentheses'>(</span><a href="wchar.c.html#LN1893"><span class='Ref_to_Parameter'>mbstr</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Delimiter'>, </span><a href="wchar.c.html#LN1893"><span class='Ref_to_Parameter'>len</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="wchar.c.html#LN1905"><span class='Ref_To_Local'>nullpos</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>            <span class='Control'>return</span> <a href="wchar.c.html#LN1893"><span class='Ref_to_Parameter'>len</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="wchar.c.html#LN1893"><span class='Ref_to_Parameter'>noError</span></a><span class='Parentheses'>) 
</span>            <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>        <a href="wchar.c.html#LN1993"><span class='Ref_to_Func'>report_invalid_encoding</span></a><span class='Parentheses'>(</span><a href="wchar.c.html#LN1893"><span class='Ref_to_Parameter'>encoding</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN1905"><span class='Ref_To_Local'>nullpos</span></a><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* fetch function pointer just once */ 
</span>    <a href="wchar.c.html#LN1895"><span class='Ref_To_Local'>mbverify</span></a> <span class='Operator'>= </span><a href="wchar.c.html#LN1728"><span class='Ref_to_Global_Var'>pg_wchar_table</span></a><span class='Delimiter'>[</span><a href="wchar.c.html#LN1893"><span class='Ref_to_Parameter'>encoding</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="../../../include/mb/pg_wchar.h.html#LN367"><span class='Ref_to_Member'>mbverify</span></a><span class='Delimiter'>; 
</span> 
    <a href="wchar.c.html#LN1896"><span class='Ref_To_Local'>mb_len</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>while</span> <span class='Parentheses'>(</span><a href="wchar.c.html#LN1893"><span class='Ref_to_Parameter'>len</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN1921"></a>        <span class='Keyword'>int</span>         <span class='Declare_Local'>l</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* fast path for ASCII-subset characters */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../../include/c.h.html#LN972"><span class='Ref_to_Macro'>IS_HIGHBIT_SET</span></a><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="wchar.c.html#LN1893"><span class='Ref_to_Parameter'>mbstr</span></a><span class='Parentheses'>))</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="wchar.c.html#LN1893"><span class='Ref_to_Parameter'>mbstr</span></a> <span class='Operator'>!= </span><span class='String'>'\0'</span><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <a href="wchar.c.html#LN1896"><span class='Ref_To_Local'>mb_len</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>                <a href="wchar.c.html#LN1893"><span class='Ref_to_Parameter'>mbstr</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>                <a href="wchar.c.html#LN1893"><span class='Ref_to_Parameter'>len</span></a><span class='Operator'>--</span><span class='Delimiter'>; 
</span>                <span class='Control'>continue</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="wchar.c.html#LN1893"><span class='Ref_to_Parameter'>noError</span></a><span class='Parentheses'>) 
</span>                <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>            <a href="wchar.c.html#LN1993"><span class='Ref_to_Func'>report_invalid_encoding</span></a><span class='Parentheses'>(</span><a href="wchar.c.html#LN1893"><span class='Ref_to_Parameter'>encoding</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN1893"><span class='Ref_to_Parameter'>mbstr</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN1893"><span class='Ref_to_Parameter'>len</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span> 
        <a href="wchar.c.html#LN1921"><span class='Ref_To_Local'>l</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="wchar.c.html#LN1895"><span class='Ref_To_Local'>mbverify</span></a><span class='Parentheses'>) ((</span><span class='Keyword'>const unsigned char </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="wchar.c.html#LN1893"><span class='Ref_to_Parameter'>mbstr</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN1893"><span class='Ref_to_Parameter'>len</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="wchar.c.html#LN1921"><span class='Ref_To_Local'>l</span></a> <span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="wchar.c.html#LN1893"><span class='Ref_to_Parameter'>noError</span></a><span class='Parentheses'>) 
</span>                <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>            <a href="wchar.c.html#LN1993"><span class='Ref_to_Func'>report_invalid_encoding</span></a><span class='Parentheses'>(</span><a href="wchar.c.html#LN1893"><span class='Ref_to_Parameter'>encoding</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN1893"><span class='Ref_to_Parameter'>mbstr</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN1893"><span class='Ref_to_Parameter'>len</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span> 
        <a href="wchar.c.html#LN1893"><span class='Ref_to_Parameter'>mbstr</span></a> <span class='Operator'>+= </span><a href="wchar.c.html#LN1921"><span class='Ref_To_Local'>l</span></a><span class='Delimiter'>; 
</span>        <a href="wchar.c.html#LN1893"><span class='Ref_to_Parameter'>len</span></a> <span class='Operator'>-= </span><a href="wchar.c.html#LN1921"><span class='Ref_To_Local'>l</span></a><span class='Delimiter'>; 
</span>        <a href="wchar.c.html#LN1896"><span class='Ref_To_Local'>mb_len</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end while len&GT;0 &raquo; </span> 
    <span class='Control'>return</span> <a href="wchar.c.html#LN1896"><span class='Ref_To_Local'>mb_len</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end pg_verify_mbstr_len &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * check_encoding_conversion_args: check arguments of a conversion function 
 * 
 * "expected" arguments can be either an encoding ID or -1 to indicate that 
 * the caller will check whether it accepts the ID. 
 * 
 * Note: the errors here are not really user-facing, so elog instead of 
 * ereport seems sufficient.  Also, we trust that the "expected" encoding 
 * arguments are valid encoding IDs, but we don't trust the actuals. 
 */ 
</span><span class='Keyword'>void 
</span><a name="LN1965"></a><span class='Declare_Function'>check_encoding_conversion_args</span><span class='Parentheses'>(</span><span class='Keyword'>int </span><span class='Declare_Parameter'>src_encoding</span><span class='Delimiter'>, 
</span><a name="LN1966"></a>                               <span class='Keyword'>int </span><span class='Declare_Parameter'>dest_encoding</span><span class='Delimiter'>, 
</span><a name="LN1967"></a>                               <span class='Keyword'>int </span><span class='Declare_Parameter'>len</span><span class='Delimiter'>, 
</span><a name="LN1968"></a>                               <span class='Keyword'>int </span><span class='Declare_Parameter'>expected_src_encoding</span><span class='Delimiter'>, 
</span><a name="LN1969"></a>                               <span class='Keyword'>int </span><span class='Declare_Parameter'>expected_dest_encoding</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../../include/mb/pg_wchar.h.html#LN298"><span class='Ref_to_Macro'>PG_VALID_ENCODING</span></a><span class='Parentheses'>(</span><a href="wchar.c.html#LN1965"><span class='Ref_to_Parameter'>src_encoding</span></a><span class='Parentheses'>))</span> 
        <a href="../../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"invalid source encoding ID: %d"</span><span class='Delimiter'>, </span><a href="wchar.c.html#LN1965"><span class='Ref_to_Parameter'>src_encoding</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="wchar.c.html#LN1965"><span class='Ref_to_Parameter'>src_encoding</span></a> <span class='Operator'>!= </span><a href="wchar.c.html#LN1968"><span class='Ref_to_Parameter'>expected_src_encoding</span></a> <span class='Operator'>&& </span><a href="wchar.c.html#LN1968"><span class='Ref_to_Parameter'>expected_src_encoding</span></a> <span class='Operator'>&GT;= </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>        <a href="../../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"expected source encoding \"%s\", but got \"%s\""</span><span class='Delimiter'>, 
</span>             <a href="encnames.c.html#LN306"><span class='Ref_to_Global_Var'>pg_enc2name_tbl</span></a><span class='Delimiter'>[</span><a href="wchar.c.html#LN1968"><span class='Ref_to_Parameter'>expected_src_encoding</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="../../../include/mb/pg_wchar.h.html#LN314"><span class='Ref_to_Member'>name</span></a><span class='Delimiter'>, 
</span>             <a href="encnames.c.html#LN306"><span class='Ref_to_Global_Var'>pg_enc2name_tbl</span></a><span class='Delimiter'>[</span><a href="wchar.c.html#LN1965"><span class='Ref_to_Parameter'>src_encoding</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="../../../include/mb/pg_wchar.h.html#LN314"><span class='Ref_to_Member'>name</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../../include/mb/pg_wchar.h.html#LN298"><span class='Ref_to_Macro'>PG_VALID_ENCODING</span></a><span class='Parentheses'>(</span><a href="wchar.c.html#LN1966"><span class='Ref_to_Parameter'>dest_encoding</span></a><span class='Parentheses'>))</span> 
        <a href="../../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"invalid destination encoding ID: %d"</span><span class='Delimiter'>, </span><a href="wchar.c.html#LN1966"><span class='Ref_to_Parameter'>dest_encoding</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="wchar.c.html#LN1966"><span class='Ref_to_Parameter'>dest_encoding</span></a> <span class='Operator'>!= </span><a href="wchar.c.html#LN1969"><span class='Ref_to_Parameter'>expected_dest_encoding</span></a> <span class='Operator'>&& </span><a href="wchar.c.html#LN1969"><span class='Ref_to_Parameter'>expected_dest_encoding</span></a> <span class='Operator'>&GT;= </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>        <a href="../../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"expected destination encoding \"%s\", but got \"%s\""</span><span class='Delimiter'>, 
</span>             <a href="encnames.c.html#LN306"><span class='Ref_to_Global_Var'>pg_enc2name_tbl</span></a><span class='Delimiter'>[</span><a href="wchar.c.html#LN1969"><span class='Ref_to_Parameter'>expected_dest_encoding</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="../../../include/mb/pg_wchar.h.html#LN314"><span class='Ref_to_Member'>name</span></a><span class='Delimiter'>, 
</span>             <a href="encnames.c.html#LN306"><span class='Ref_to_Global_Var'>pg_enc2name_tbl</span></a><span class='Delimiter'>[</span><a href="wchar.c.html#LN1966"><span class='Ref_to_Parameter'>dest_encoding</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="../../../include/mb/pg_wchar.h.html#LN314"><span class='Ref_to_Member'>name</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="wchar.c.html#LN1967"><span class='Ref_to_Parameter'>len</span></a> <span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>        <a href="../../bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"encoding conversion length must not be negative"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end check_encoding_conversion_args &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * report_invalid_encoding: complain about invalid multibyte character 
 * 
 * note: len is remaining length of string, not length of character; 
 * len must be greater than zero, as we always examine the first byte. 
 */ 
</span><span class='Keyword'>void 
</span><a name="LN1994"></a><span class='Declare_Function'>report_invalid_encoding</span><span class='Parentheses'>(</span><span class='Keyword'>int </span><span class='Declare_Parameter'>encoding</span><span class='Delimiter'>, </span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>mbstr</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>len</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1996"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>l</span> <span class='Operator'>= </span><a href="../../../include/mb/pg_wchar.h.html#LN523"><span class='Ref_to_Proto'>pg_encoding_mblen</span></a><span class='Parentheses'>(</span><a href="wchar.c.html#LN1994"><span class='Ref_to_Parameter'>encoding</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN1994"><span class='Ref_to_Parameter'>mbstr</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1997"></a>    <span class='Keyword'>char</span>        <span class='Declare_Local'>buf</span><span class='Delimiter'>[</span><span class='Number'>8</span> <span class='Operator'>* </span><span class='Number'>5</span> <span class='Operator'>+ </span><span class='Number'>1</span><span class='Delimiter'>]; 
</span><a name="LN1998"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>p</span> <span class='Operator'>= </span><a href="wchar.c.html#LN1997"><span class='Ref_To_Local'>buf</span></a><span class='Delimiter'>; 
</span><a name="LN1999"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>j</span><span class='Delimiter'>, 
</span><a name="LN2000"></a>                <span class='Declare_Local'>jlimit</span><span class='Delimiter'>; 
</span> 
    <a href="wchar.c.html#LN2000"><span class='Ref_To_Local'>jlimit</span></a> <span class='Operator'>= </span><a href="../../../interfaces/ecpg/pgtypeslib/numeric.c.html#LN11"><span class='Ref_to_Macro'>Min</span></a><span class='Parentheses'>(</span><a href="wchar.c.html#LN1996"><span class='Ref_To_Local'>l</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN1994"><span class='Ref_to_Parameter'>len</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="wchar.c.html#LN2000"><span class='Ref_To_Local'>jlimit</span></a> <span class='Operator'>= </span><a href="../../../interfaces/ecpg/pgtypeslib/numeric.c.html#LN11"><span class='Ref_to_Macro'>Min</span></a><span class='Parentheses'>(</span><a href="wchar.c.html#LN2000"><span class='Ref_To_Local'>jlimit</span></a><span class='Delimiter'>, </span><span class='Number'>8</span><span class='Parentheses'>)</span><span class='Delimiter'>;</span>    <span class='Comment_Single_Line'>/* prevent buffer overrun */ 
</span> 
    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="wchar.c.html#LN1999"><span class='Ref_To_Local'>j</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="wchar.c.html#LN1999"><span class='Ref_To_Local'>j</span></a> <span class='Operator'>&LT; </span><a href="wchar.c.html#LN2000"><span class='Ref_To_Local'>jlimit</span></a><span class='Delimiter'>; </span><a href="wchar.c.html#LN1999"><span class='Ref_To_Local'>j</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="wchar.c.html#LN1998"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>+= </span><a href="../../../include/port.h.html#LN170"><span class='Ref_to_Macro'>sprintf</span></a><span class='Parentheses'>(</span><a href="wchar.c.html#LN1998"><span class='Ref_To_Local'>p</span></a><span class='Delimiter'>, </span><span class='String'>"0x%02x"</span><span class='Delimiter'>, </span><span class='Parentheses'>(</span><span class='Keyword'>unsigned char</span><span class='Parentheses'>) </span><a href="wchar.c.html#LN1994"><span class='Ref_to_Parameter'>mbstr</span></a><span class='Delimiter'>[</span><a href="wchar.c.html#LN1999"><span class='Ref_To_Local'>j</span></a><span class='Delimiter'>]</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="wchar.c.html#LN1999"><span class='Ref_To_Local'>j</span></a> <span class='Operator'>&LT; </span><a href="wchar.c.html#LN2000"><span class='Ref_To_Local'>jlimit</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Parentheses'>) 
</span>            <a href="wchar.c.html#LN1998"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>+= </span><a href="../../../include/port.h.html#LN170"><span class='Ref_to_Macro'>sprintf</span></a><span class='Parentheses'>(</span><a href="wchar.c.html#LN1998"><span class='Ref_To_Local'>p</span></a><span class='Delimiter'>, </span><span class='String'>" "</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="../../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>            <span class='Parentheses'>(</span><a href="../../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_CHARACTER_NOT_IN_REPERTOIRE<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>             <a href="../error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"invalid byte sequence for encoding \"%s\": %s"</span><span class='Delimiter'>, 
</span>                    <a href="encnames.c.html#LN306"><span class='Ref_to_Global_Var'>pg_enc2name_tbl</span></a><span class='Delimiter'>[</span><a href="wchar.c.html#LN1994"><span class='Ref_to_Parameter'>encoding</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="../../../include/mb/pg_wchar.h.html#LN314"><span class='Ref_to_Member'>name</span></a><span class='Delimiter'>, 
</span>                    <a href="wchar.c.html#LN1997"><span class='Ref_To_Local'>buf</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end report_invalid_encoding &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * report_untranslatable_char: complain about untranslatable character 
 * 
 * note: len is remaining length of string, not length of character; 
 * len must be greater than zero, as we always examine the first byte. 
 */ 
</span><span class='Keyword'>void 
</span><a name="LN2026"></a><span class='Declare_Function'>report_untranslatable_char</span><span class='Parentheses'>(</span><span class='Keyword'>int </span><span class='Declare_Parameter'>src_encoding</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>dest_encoding</span><span class='Delimiter'>, 
</span><a name="LN2027"></a>                           <span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>mbstr</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>len</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN2029"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>l</span> <span class='Operator'>= </span><a href="../../../include/mb/pg_wchar.h.html#LN523"><span class='Ref_to_Proto'>pg_encoding_mblen</span></a><span class='Parentheses'>(</span><a href="wchar.c.html#LN2026"><span class='Ref_to_Parameter'>src_encoding</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN2027"><span class='Ref_to_Parameter'>mbstr</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN2030"></a>    <span class='Keyword'>char</span>        <span class='Declare_Local'>buf</span><span class='Delimiter'>[</span><span class='Number'>8</span> <span class='Operator'>* </span><span class='Number'>5</span> <span class='Operator'>+ </span><span class='Number'>1</span><span class='Delimiter'>]; 
</span><a name="LN2031"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>p</span> <span class='Operator'>= </span><a href="wchar.c.html#LN2030"><span class='Ref_To_Local'>buf</span></a><span class='Delimiter'>; 
</span><a name="LN2032"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>j</span><span class='Delimiter'>, 
</span><a name="LN2033"></a>                <span class='Declare_Local'>jlimit</span><span class='Delimiter'>; 
</span> 
    <a href="wchar.c.html#LN2033"><span class='Ref_To_Local'>jlimit</span></a> <span class='Operator'>= </span><a href="../../../interfaces/ecpg/pgtypeslib/numeric.c.html#LN11"><span class='Ref_to_Macro'>Min</span></a><span class='Parentheses'>(</span><a href="wchar.c.html#LN2029"><span class='Ref_To_Local'>l</span></a><span class='Delimiter'>, </span><a href="wchar.c.html#LN2027"><span class='Ref_to_Parameter'>len</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="wchar.c.html#LN2033"><span class='Ref_To_Local'>jlimit</span></a> <span class='Operator'>= </span><a href="../../../interfaces/ecpg/pgtypeslib/numeric.c.html#LN11"><span class='Ref_to_Macro'>Min</span></a><span class='Parentheses'>(</span><a href="wchar.c.html#LN2033"><span class='Ref_To_Local'>jlimit</span></a><span class='Delimiter'>, </span><span class='Number'>8</span><span class='Parentheses'>)</span><span class='Delimiter'>;</span>    <span class='Comment_Single_Line'>/* prevent buffer overrun */ 
</span> 
    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="wchar.c.html#LN2032"><span class='Ref_To_Local'>j</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="wchar.c.html#LN2032"><span class='Ref_To_Local'>j</span></a> <span class='Operator'>&LT; </span><a href="wchar.c.html#LN2033"><span class='Ref_To_Local'>jlimit</span></a><span class='Delimiter'>; </span><a href="wchar.c.html#LN2032"><span class='Ref_To_Local'>j</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="wchar.c.html#LN2031"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>+= </span><a href="../../../include/port.h.html#LN170"><span class='Ref_to_Macro'>sprintf</span></a><span class='Parentheses'>(</span><a href="wchar.c.html#LN2031"><span class='Ref_To_Local'>p</span></a><span class='Delimiter'>, </span><span class='String'>"0x%02x"</span><span class='Delimiter'>, </span><span class='Parentheses'>(</span><span class='Keyword'>unsigned char</span><span class='Parentheses'>) </span><a href="wchar.c.html#LN2027"><span class='Ref_to_Parameter'>mbstr</span></a><span class='Delimiter'>[</span><a href="wchar.c.html#LN2032"><span class='Ref_To_Local'>j</span></a><span class='Delimiter'>]</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="wchar.c.html#LN2032"><span class='Ref_To_Local'>j</span></a> <span class='Operator'>&LT; </span><a href="wchar.c.html#LN2033"><span class='Ref_To_Local'>jlimit</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Parentheses'>) 
</span>            <a href="wchar.c.html#LN2031"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>+= </span><a href="../../../include/port.h.html#LN170"><span class='Ref_to_Macro'>sprintf</span></a><span class='Parentheses'>(</span><a href="wchar.c.html#LN2031"><span class='Ref_To_Local'>p</span></a><span class='Delimiter'>, </span><span class='String'>" "</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="../../../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../../../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>            <span class='Parentheses'>(</span><a href="../../../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_UNTRANSLATABLE_CHARACTER<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>             <a href="../error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"character with byte sequence %s in encoding \"%s\" has no equivalent in encoding \"%s\""</span><span class='Delimiter'>, 
</span>                    <a href="wchar.c.html#LN2030"><span class='Ref_To_Local'>buf</span></a><span class='Delimiter'>, 
</span>                    <a href="encnames.c.html#LN306"><span class='Ref_to_Global_Var'>pg_enc2name_tbl</span></a><span class='Delimiter'>[</span><a href="wchar.c.html#LN2026"><span class='Ref_to_Parameter'>src_encoding</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="../../../include/mb/pg_wchar.h.html#LN314"><span class='Ref_to_Member'>name</span></a><span class='Delimiter'>, 
</span>                    <a href="encnames.c.html#LN306"><span class='Ref_to_Global_Var'>pg_enc2name_tbl</span></a><span class='Delimiter'>[</span><a href="wchar.c.html#LN2026"><span class='Ref_to_Parameter'>dest_encoding</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="../../../include/mb/pg_wchar.h.html#LN314"><span class='Ref_to_Member'>name</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end report_untranslatable_char &raquo; </span> 
 
<span class='Directive'>#endif</span>   <span class='Comment_Single_Line'>/* !FRONTEND */ 
</span></pre>
<table bgcolor='#c0c0c0' width='100%'><tr><td><a href='../../../../Contents.html'>Contents</a></td></tr>
</table><hr><p class='blurb' align='center'><a href='http://www.sourceinsight.com'>HTML Created by Source Insight Version 4.00.0084 Built on 2017-02-26</a></p>
</body></html>