<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta name="generator" content="Source Insight Version 4.00.0084 Built on 2017-02-26">
<meta charset='UTF-8' />
<style type='text/css'><!--
TD {background-color: #C0C0C0; font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 70%; }
.blurb {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 70%; }
.filename {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 120%; font-weight: bold; }
.dirname {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 100%; font-weight: bold; margin-top: 2.5em;}
--></style>
<title>src\bin\pg_upgrade\controldata.c</title>
<LINK REL=StyleSheet HREF="../../../C_Cpp_Source_File.css" TYPE='text/css' MEDIA=screen>
</head>
<body bgcolor=#ffffff>
<table bgcolor='#c0c0c0' width='100%'>
<tr><td><p class='filename'><b>src\bin\pg_upgrade\controldata.c</b></p></td>
<td align='right'>
Wed Jun 14 08:26:01 2017
</td></tr>
<tr><td><a href='../../../Contents.html'>Contents</a></td></tr>
</table>
<pre>
<span class='Comment_Multi_Line'>/* 
 *  controldata.c 
 * 
 *  controldata functions 
 * 
 *  Copyright (c) 2010-2017, PostgreSQL Global Development Group 
 *  src/bin/pg_upgrade/controldata.c 
 */ 
</span> 
<span class='Keyword'>#include </span><span class='String'>"postgres_fe.h"</span> 
 
<span class='Keyword'>#include </span><span class='String'>"pg_upgrade.h"</span> 
 
<span class='Keyword'>#include </span><span class='String'>&LT;ctype.h&GT;</span> 
 
<span class='Comment_Multi_Line'>/* 
 * get_control_data() 
 * 
 * gets pg_control information in "ctrl". Assumes that bindir and 
 * datadir are valid absolute paths to postgresql bin and pgdata 
 * directories respectively *and* pg_resetwal is version compatible 
 * with datadir. The main purpose of this function is to get pg_control 
 * data in a version independent manner. 
 * 
 * The approach taken here is to invoke pg_resetwal with -n option 
 * and then pipe its output. With little string parsing we get the 
 * pg_control data.  pg_resetwal cannot be run while the server is running 
 * so we use pg_controldata;  pg_controldata doesn't provide all the fields 
 * we need to actually perform the upgrade, but it provides enough for 
 * check mode.  We do not implement pg_resetwal -n because it is hard to 
 * return valid xid data for a running server. 
 */ 
</span><span class='Keyword'>void 
</span><a name="LN33"></a><span class='Declare_Function'>get_control_data</span><span class='Parentheses'>(</span><a href="pg_upgrade.h.html#LN259"><span class='Ref_to_Typedef'>ClusterInfo</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>cluster</span><span class='Delimiter'>, </span><span class='Keyword'>bool </span><span class='Declare_Parameter'>live_check</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN35"></a>    <span class='Keyword'>char</span>        <span class='Declare_Local'>cmd</span><span class='Delimiter'>[</span><a href="../../include/pg_config_manual.h.html#LN88"><span class='Ref_to_Const'>MAXPGPATH</span></a><span class='Delimiter'>]; 
</span><a name="LN36"></a>    <span class='Keyword'>char</span>        <span class='Declare_Local'>bufin</span><span class='Delimiter'>[</span><a href="pg_upgrade.h.html#LN20"><span class='Ref_to_Const'>MAX_STRING</span></a><span class='Delimiter'>]; 
</span><a name="LN37"></a>    FILE       <span class='Operator'>*</span><span class='Declare_Local'>output</span><span class='Delimiter'>; 
</span><a name="LN38"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>p</span><span class='Delimiter'>; 
</span><a name="LN39"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>got_tli</span> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span><a name="LN40"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>got_log_id</span> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span><a name="LN41"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>got_log_seg</span> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span><a name="LN42"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>got_xid</span> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span><a name="LN43"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>got_oid</span> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span><a name="LN44"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>got_multi</span> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span><a name="LN45"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>got_oldestmulti</span> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span><a name="LN46"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>got_mxoff</span> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span><a name="LN47"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>got_nextxlogfile</span> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span><a name="LN48"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>got_float8_pass_by_value</span> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span><a name="LN49"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>got_align</span> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span><a name="LN50"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>got_blocksz</span> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span><a name="LN51"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>got_largesz</span> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span><a name="LN52"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>got_walsz</span> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span><a name="LN53"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>got_walseg</span> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span><a name="LN54"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>got_ident</span> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span><a name="LN55"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>got_index</span> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span><a name="LN56"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>got_toast</span> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span><a name="LN57"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>got_large_object</span> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span><a name="LN58"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>got_date_is_int</span> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span><a name="LN59"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>got_data_checksum_version</span> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span><a name="LN60"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>lc_collate</span> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span><a name="LN61"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>lc_ctype</span> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span><a name="LN62"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>lc_monetary</span> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span><a name="LN63"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>lc_numeric</span> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span><a name="LN64"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>lc_time</span> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span><a name="LN65"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>lang</span> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span><a name="LN66"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>language</span> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span><a name="LN67"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>lc_all</span> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span><a name="LN68"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>lc_messages</span> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span><a name="LN69"></a>    <a href="../../include/c.h.html#LN267"><span class='Ref_to_Typedef'>uint32</span></a>      <span class='Declare_Local'>tli</span> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span><a name="LN70"></a>    <a href="../../include/c.h.html#LN267"><span class='Ref_to_Typedef'>uint32</span></a>      <span class='Declare_Local'>logid</span> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span><a name="LN71"></a>    <a href="../../include/c.h.html#LN267"><span class='Ref_to_Typedef'>uint32</span></a>      <span class='Declare_Local'>segno</span> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span><a name="LN72"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>resetwal_bin</span><span class='Delimiter'>; 
</span> 
 
    <span class='Comment_Multi_Line'>/* 
     * Because we test the pg_resetwal output as strings, it has to be in 
     * English.  Copied from pg_regress.c. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span>getenv<span class='Parentheses'>(</span><span class='String'>"LC_COLLATE"</span><span class='Parentheses'>))</span> 
        <a href="controldata.c.html#LN60"><span class='Ref_To_Local'>lc_collate</span></a> <span class='Operator'>= </span><a href="../../include/common/fe_memutils.h.html#LN24"><span class='Ref_to_Proto'>pg_strdup</span></a><span class='Parentheses'>(</span>getenv<span class='Parentheses'>(</span><span class='String'>"LC_COLLATE"</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span>getenv<span class='Parentheses'>(</span><span class='String'>"LC_CTYPE"</span><span class='Parentheses'>))</span> 
        <a href="controldata.c.html#LN61"><span class='Ref_To_Local'>lc_ctype</span></a> <span class='Operator'>= </span><a href="../../include/common/fe_memutils.h.html#LN24"><span class='Ref_to_Proto'>pg_strdup</span></a><span class='Parentheses'>(</span>getenv<span class='Parentheses'>(</span><span class='String'>"LC_CTYPE"</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span>getenv<span class='Parentheses'>(</span><span class='String'>"LC_MONETARY"</span><span class='Parentheses'>))</span> 
        <a href="controldata.c.html#LN62"><span class='Ref_To_Local'>lc_monetary</span></a> <span class='Operator'>= </span><a href="../../include/common/fe_memutils.h.html#LN24"><span class='Ref_to_Proto'>pg_strdup</span></a><span class='Parentheses'>(</span>getenv<span class='Parentheses'>(</span><span class='String'>"LC_MONETARY"</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span>getenv<span class='Parentheses'>(</span><span class='String'>"LC_NUMERIC"</span><span class='Parentheses'>))</span> 
        <a href="controldata.c.html#LN63"><span class='Ref_To_Local'>lc_numeric</span></a> <span class='Operator'>= </span><a href="../../include/common/fe_memutils.h.html#LN24"><span class='Ref_to_Proto'>pg_strdup</span></a><span class='Parentheses'>(</span>getenv<span class='Parentheses'>(</span><span class='String'>"LC_NUMERIC"</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span>getenv<span class='Parentheses'>(</span><span class='String'>"LC_TIME"</span><span class='Parentheses'>))</span> 
        <a href="controldata.c.html#LN64"><span class='Ref_To_Local'>lc_time</span></a> <span class='Operator'>= </span><a href="../../include/common/fe_memutils.h.html#LN24"><span class='Ref_to_Proto'>pg_strdup</span></a><span class='Parentheses'>(</span>getenv<span class='Parentheses'>(</span><span class='String'>"LC_TIME"</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span>getenv<span class='Parentheses'>(</span><span class='String'>"LANG"</span><span class='Parentheses'>))</span> 
        <a href="controldata.c.html#LN65"><span class='Ref_To_Local'>lang</span></a> <span class='Operator'>= </span><a href="../../include/common/fe_memutils.h.html#LN24"><span class='Ref_to_Proto'>pg_strdup</span></a><span class='Parentheses'>(</span>getenv<span class='Parentheses'>(</span><span class='String'>"LANG"</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span>getenv<span class='Parentheses'>(</span><span class='String'>"LANGUAGE"</span><span class='Parentheses'>))</span> 
        <a href="controldata.c.html#LN66"><span class='Ref_To_Local'>language</span></a> <span class='Operator'>= </span><a href="../../include/common/fe_memutils.h.html#LN24"><span class='Ref_to_Proto'>pg_strdup</span></a><span class='Parentheses'>(</span>getenv<span class='Parentheses'>(</span><span class='String'>"LANGUAGE"</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span>getenv<span class='Parentheses'>(</span><span class='String'>"LC_ALL"</span><span class='Parentheses'>))</span> 
        <a href="controldata.c.html#LN67"><span class='Ref_To_Local'>lc_all</span></a> <span class='Operator'>= </span><a href="../../include/common/fe_memutils.h.html#LN24"><span class='Ref_to_Proto'>pg_strdup</span></a><span class='Parentheses'>(</span>getenv<span class='Parentheses'>(</span><span class='String'>"LC_ALL"</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span>getenv<span class='Parentheses'>(</span><span class='String'>"LC_MESSAGES"</span><span class='Parentheses'>))</span> 
        <a href="controldata.c.html#LN68"><span class='Ref_To_Local'>lc_messages</span></a> <span class='Operator'>= </span><a href="../../include/common/fe_memutils.h.html#LN24"><span class='Ref_to_Proto'>pg_strdup</span></a><span class='Parentheses'>(</span>getenv<span class='Parentheses'>(</span><span class='String'>"LC_MESSAGES"</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <a href="util.c.html#LN252"><span class='Ref_to_Func'>pg_putenv</span></a><span class='Parentheses'>(</span><span class='String'>"LC_COLLATE"</span><span class='Delimiter'>, </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="util.c.html#LN252"><span class='Ref_to_Func'>pg_putenv</span></a><span class='Parentheses'>(</span><span class='String'>"LC_CTYPE"</span><span class='Delimiter'>, </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="util.c.html#LN252"><span class='Ref_to_Func'>pg_putenv</span></a><span class='Parentheses'>(</span><span class='String'>"LC_MONETARY"</span><span class='Delimiter'>, </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="util.c.html#LN252"><span class='Ref_to_Func'>pg_putenv</span></a><span class='Parentheses'>(</span><span class='String'>"LC_NUMERIC"</span><span class='Delimiter'>, </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="util.c.html#LN252"><span class='Ref_to_Func'>pg_putenv</span></a><span class='Parentheses'>(</span><span class='String'>"LC_TIME"</span><span class='Delimiter'>, </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="util.c.html#LN252"><span class='Ref_to_Func'>pg_putenv</span></a><span class='Parentheses'>(</span><span class='String'>"LANG"</span><span class='Delimiter'>, 
</span><span class='Directive'>#ifndef</span> <a href="../../include/c.h.html#LN61"><span class='Ref_to_Const'>WIN32</span></a> 
              <span class='Null_Value'>NULL</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><span class='Directive'>#else</span> 
    <span class='Comment_Multi_Line'>/* On Windows the default locale cannot be English, so force it */ 
</span>              <span class='String'>"en"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><span class='Directive'>#endif</span> 
    <a href="util.c.html#LN252"><span class='Ref_to_Func'>pg_putenv</span></a><span class='Parentheses'>(</span><span class='String'>"LANGUAGE"</span><span class='Delimiter'>, </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="util.c.html#LN252"><span class='Ref_to_Func'>pg_putenv</span></a><span class='Parentheses'>(</span><span class='String'>"LC_ALL"</span><span class='Delimiter'>, </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="util.c.html#LN252"><span class='Ref_to_Func'>pg_putenv</span></a><span class='Parentheses'>(</span><span class='String'>"LC_MESSAGES"</span><span class='Delimiter'>, </span><span class='String'>"C"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* pg_resetxlog has been renamed to pg_resetwal in version 10 */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="pg_upgrade.h.html#LN28"><span class='Ref_to_Macro'>GET_MAJOR_VERSION</span></a><span class='Parentheses'>(</span><a href="controldata.c.html#LN33"><span class='Ref_to_Parameter'>cluster</span></a><span class='Operator'>-&GT;</span><a href="pg_upgrade.h.html#LN273"><span class='Ref_to_Member'>bin_version</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT; </span><span class='Number'>1000</span><span class='Parentheses'>)</span> 
        <a href="controldata.c.html#LN72"><span class='Ref_To_Local'>resetwal_bin</span></a> <span class='Operator'>= </span><span class='String'>"pg_resetxlog\" -n"</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
        <a href="controldata.c.html#LN72"><span class='Ref_To_Local'>resetwal_bin</span></a> <span class='Operator'>= </span><span class='String'>"pg_resetwal\" -n"</span><span class='Delimiter'>; 
</span>    <a href="../../pl/plperl/plperl.h.html#LN60"><span class='Ref_to_Macro'>snprintf</span></a><span class='Parentheses'>(</span><a href="controldata.c.html#LN35"><span class='Ref_To_Local'>cmd</span></a><span class='Delimiter'>, </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="controldata.c.html#LN35"><span class='Ref_To_Local'>cmd</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><span class='String'>"\"%s/%s \"%s\""</span><span class='Delimiter'>, 
</span>             <a href="controldata.c.html#LN33"><span class='Ref_to_Parameter'>cluster</span></a><span class='Operator'>-&GT;</span><a href="pg_upgrade.h.html#LN266"><span class='Ref_to_Member'>bindir</span></a><span class='Delimiter'>, 
</span>             <a href="controldata.c.html#LN33"><span class='Ref_to_Parameter'>live_check</span></a> <span class='Operator'>? </span><span class='String'>"pg_controldata\""</span> <span class='Operator'>: </span><a href="controldata.c.html#LN72"><span class='Ref_To_Local'>resetwal_bin</span></a><span class='Delimiter'>, 
</span>             <a href="controldata.c.html#LN33"><span class='Ref_to_Parameter'>cluster</span></a><span class='Operator'>-&GT;</span><a href="pg_upgrade.h.html#LN263"><span class='Ref_to_Member'>pgdata</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    fflush<span class='Parentheses'>(</span>stdout<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    fflush<span class='Parentheses'>(</span>stderr<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="controldata.c.html#LN37"><span class='Ref_To_Local'>output</span></a> <span class='Operator'>= </span><a href="../../include/port.h.html#LN313"><span class='Ref_to_Macro'>popen</span></a><span class='Parentheses'>(</span><a href="controldata.c.html#LN35"><span class='Ref_To_Local'>cmd</span></a><span class='Delimiter'>, </span><span class='String'>"r"</span><span class='Parentheses'>))</span> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span> 
        <a href="../pg_rewind/logging.c.html#LN81"><span class='Ref_to_Func'>pg_fatal</span></a><span class='Parentheses'>(</span><span class='String'>"could not get control data using %s: %s\n"</span><span class='Delimiter'>, 
</span>                 <a href="controldata.c.html#LN35"><span class='Ref_To_Local'>cmd</span></a><span class='Delimiter'>, </span><a href="../../port/strerror.c.html#LN17"><span class='Ref_to_Func'>strerror</span></a><span class='Parentheses'>(</span>errno<span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Only in &LT;= 9.2 */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="pg_upgrade.h.html#LN28"><span class='Ref_to_Macro'>GET_MAJOR_VERSION</span></a><span class='Parentheses'>(</span><a href="controldata.c.html#LN33"><span class='Ref_to_Parameter'>cluster</span></a><span class='Operator'>-&GT;</span><a href="pg_upgrade.h.html#LN271"><span class='Ref_to_Member'>major_version</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT;= </span><span class='Number'>902</span><span class='Parentheses'>)</span> 
    <span class='Delimiter'>{ 
</span>        <a href="controldata.c.html#LN33"><span class='Ref_to_Parameter'>cluster</span></a><span class='Operator'>-&GT;</span><a href="pg_upgrade.h.html#LN261"><span class='Ref_to_Member'>controldata</span></a><span class='Operator'>.</span><a href="pg_upgrade.h.html#LN226"><span class='Ref_to_Member'>data_checksum_version</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>        <a href="controldata.c.html#LN59"><span class='Ref_To_Local'>got_data_checksum_version</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* we have the result of cmd in "output". so parse it line by line now */ 
</span>    <span class='Control'>while</span> <span class='Parentheses'>(</span>fgets<span class='Parentheses'>(</span><a href="controldata.c.html#LN36"><span class='Ref_To_Local'>bufin</span></a><span class='Delimiter'>, </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="controldata.c.html#LN36"><span class='Ref_To_Local'>bufin</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="controldata.c.html#LN37"><span class='Ref_To_Local'>output</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span>        <a href="../pg_rewind/logging.c.html#LN67"><span class='Ref_to_Func'>pg_log</span></a><span class='Parentheses'>(</span><a href="pg_upgrade.h.html#LN243"><span class='Ref_to_EnumConst'>PG_VERBOSE</span></a><span class='Delimiter'>, </span><span class='String'>"%s"</span><span class='Delimiter'>, </span><a href="controldata.c.html#LN36"><span class='Ref_To_Local'>bufin</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>= </span>strstr<span class='Parentheses'>(</span><a href="controldata.c.html#LN36"><span class='Ref_To_Local'>bufin</span></a><span class='Delimiter'>, </span><span class='String'>"pg_control version number:"</span><span class='Parentheses'>))</span> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span> 
        <span class='Delimiter'>{ 
</span>            <a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>= </span>strchr<span class='Parentheses'>(</span><a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a><span class='Delimiter'>, </span><span class='String'>':'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL </span><span class='Operator'>|| </span>strlen<span class='Parentheses'>(</span><a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT;= </span><span class='Number'>1</span><span class='Parentheses'>)</span> 
                <a href="../pg_rewind/logging.c.html#LN81"><span class='Ref_to_Func'>pg_fatal</span></a><span class='Parentheses'>(</span><span class='String'>"%d: pg_resetwal problem\n"</span><span class='Delimiter'>, </span>__LINE__<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a><span class='Operator'>++</span><span class='Delimiter'>;</span>                <span class='Comment_Single_Line'>/* remove ':' char */ 
</span>            <a href="controldata.c.html#LN33"><span class='Ref_to_Parameter'>cluster</span></a><span class='Operator'>-&GT;</span><a href="pg_upgrade.h.html#LN261"><span class='Ref_to_Member'>controldata</span></a><span class='Operator'>.</span><a href="pg_upgrade.h.html#LN206"><span class='Ref_to_Member'>ctrl_ver</span></a> <span class='Operator'>= </span><a href="util.c.html#LN239"><span class='Ref_to_Func'>str2uint</span></a><span class='Parentheses'>(</span><a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>= </span>strstr<span class='Parentheses'>(</span><a href="controldata.c.html#LN36"><span class='Ref_To_Local'>bufin</span></a><span class='Delimiter'>, </span><span class='String'>"Catalog version number:"</span><span class='Parentheses'>))</span> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span> 
        <span class='Delimiter'>{ 
</span>            <a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>= </span>strchr<span class='Parentheses'>(</span><a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a><span class='Delimiter'>, </span><span class='String'>':'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL </span><span class='Operator'>|| </span>strlen<span class='Parentheses'>(</span><a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT;= </span><span class='Number'>1</span><span class='Parentheses'>)</span> 
                <a href="../pg_rewind/logging.c.html#LN81"><span class='Ref_to_Func'>pg_fatal</span></a><span class='Parentheses'>(</span><span class='String'>"%d: controldata retrieval problem\n"</span><span class='Delimiter'>, </span>__LINE__<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a><span class='Operator'>++</span><span class='Delimiter'>;</span>                <span class='Comment_Single_Line'>/* remove ':' char */ 
</span>            <a href="controldata.c.html#LN33"><span class='Ref_to_Parameter'>cluster</span></a><span class='Operator'>-&GT;</span><a href="pg_upgrade.h.html#LN261"><span class='Ref_to_Member'>controldata</span></a><span class='Operator'>.</span><a href="pg_upgrade.h.html#LN207"><span class='Ref_to_Member'>cat_ver</span></a> <span class='Operator'>= </span><a href="util.c.html#LN239"><span class='Ref_to_Func'>str2uint</span></a><span class='Parentheses'>(</span><a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>= </span>strstr<span class='Parentheses'>(</span><a href="controldata.c.html#LN36"><span class='Ref_To_Local'>bufin</span></a><span class='Delimiter'>, </span><span class='String'>"Latest checkpoint's TimeLineID:"</span><span class='Parentheses'>))</span> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span> 
        <span class='Delimiter'>{ 
</span>            <a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>= </span>strchr<span class='Parentheses'>(</span><a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a><span class='Delimiter'>, </span><span class='String'>':'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL </span><span class='Operator'>|| </span>strlen<span class='Parentheses'>(</span><a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT;= </span><span class='Number'>1</span><span class='Parentheses'>)</span> 
                <a href="../pg_rewind/logging.c.html#LN81"><span class='Ref_to_Func'>pg_fatal</span></a><span class='Parentheses'>(</span><span class='String'>"%d: controldata retrieval problem\n"</span><span class='Delimiter'>, </span>__LINE__<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a><span class='Operator'>++</span><span class='Delimiter'>;</span>                <span class='Comment_Single_Line'>/* remove ':' char */ 
</span>            <a href="controldata.c.html#LN69"><span class='Ref_To_Local'>tli</span></a> <span class='Operator'>= </span><a href="util.c.html#LN239"><span class='Ref_to_Func'>str2uint</span></a><span class='Parentheses'>(</span><a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="controldata.c.html#LN39"><span class='Ref_To_Local'>got_tli</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>= </span>strstr<span class='Parentheses'>(</span><a href="controldata.c.html#LN36"><span class='Ref_To_Local'>bufin</span></a><span class='Delimiter'>, </span><span class='String'>"First log file ID after reset:"</span><span class='Parentheses'>))</span> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span> 
        <span class='Delimiter'>{ 
</span>            <a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>= </span>strchr<span class='Parentheses'>(</span><a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a><span class='Delimiter'>, </span><span class='String'>':'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL </span><span class='Operator'>|| </span>strlen<span class='Parentheses'>(</span><a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT;= </span><span class='Number'>1</span><span class='Parentheses'>)</span> 
                <a href="../pg_rewind/logging.c.html#LN81"><span class='Ref_to_Func'>pg_fatal</span></a><span class='Parentheses'>(</span><span class='String'>"%d: controldata retrieval problem\n"</span><span class='Delimiter'>, </span>__LINE__<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a><span class='Operator'>++</span><span class='Delimiter'>;</span>                <span class='Comment_Single_Line'>/* remove ':' char */ 
</span>            <a href="controldata.c.html#LN70"><span class='Ref_To_Local'>logid</span></a> <span class='Operator'>= </span><a href="util.c.html#LN239"><span class='Ref_to_Func'>str2uint</span></a><span class='Parentheses'>(</span><a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="controldata.c.html#LN40"><span class='Ref_To_Local'>got_log_id</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>= </span>strstr<span class='Parentheses'>(</span><a href="controldata.c.html#LN36"><span class='Ref_To_Local'>bufin</span></a><span class='Delimiter'>, </span><span class='String'>"First log file segment after reset:"</span><span class='Parentheses'>))</span> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span> 
        <span class='Delimiter'>{ 
</span>            <a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>= </span>strchr<span class='Parentheses'>(</span><a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a><span class='Delimiter'>, </span><span class='String'>':'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL </span><span class='Operator'>|| </span>strlen<span class='Parentheses'>(</span><a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT;= </span><span class='Number'>1</span><span class='Parentheses'>)</span> 
                <a href="../pg_rewind/logging.c.html#LN81"><span class='Ref_to_Func'>pg_fatal</span></a><span class='Parentheses'>(</span><span class='String'>"%d: controldata retrieval problem\n"</span><span class='Delimiter'>, </span>__LINE__<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a><span class='Operator'>++</span><span class='Delimiter'>;</span>                <span class='Comment_Single_Line'>/* remove ':' char */ 
</span>            <a href="controldata.c.html#LN71"><span class='Ref_To_Local'>segno</span></a> <span class='Operator'>= </span><a href="util.c.html#LN239"><span class='Ref_to_Func'>str2uint</span></a><span class='Parentheses'>(</span><a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="controldata.c.html#LN41"><span class='Ref_To_Local'>got_log_seg</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>= </span>strstr<span class='Parentheses'>(</span><a href="controldata.c.html#LN36"><span class='Ref_To_Local'>bufin</span></a><span class='Delimiter'>, </span><span class='String'>"Latest checkpoint's NextXID:"</span><span class='Parentheses'>))</span> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span> 
        <span class='Delimiter'>{ 
</span>            <a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>= </span>strchr<span class='Parentheses'>(</span><a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a><span class='Delimiter'>, </span><span class='String'>':'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL </span><span class='Operator'>|| </span>strlen<span class='Parentheses'>(</span><a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT;= </span><span class='Number'>1</span><span class='Parentheses'>)</span> 
                <a href="../pg_rewind/logging.c.html#LN81"><span class='Ref_to_Func'>pg_fatal</span></a><span class='Parentheses'>(</span><span class='String'>"%d: controldata retrieval problem\n"</span><span class='Delimiter'>, </span>__LINE__<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a><span class='Operator'>++</span><span class='Delimiter'>;</span>                <span class='Comment_Single_Line'>/* remove ':' char */ 
</span>            <a href="controldata.c.html#LN33"><span class='Ref_to_Parameter'>cluster</span></a><span class='Operator'>-&GT;</span><a href="pg_upgrade.h.html#LN261"><span class='Ref_to_Member'>controldata</span></a><span class='Operator'>.</span><a href="pg_upgrade.h.html#LN210"><span class='Ref_to_Member'>chkpnt_nxtepoch</span></a> <span class='Operator'>= </span><a href="util.c.html#LN239"><span class='Ref_to_Func'>str2uint</span></a><span class='Parentheses'>(</span><a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <span class='Comment_Multi_Line'>/* 
             * Delimiter changed from '/' to ':' in 9.6.  We don't test for 
             * the catalog version of the change because the catalog version 
             * is pulled from pg_controldata too, and it isn't worth adding an 
             * order dependency for this --- we just check the string. 
             */ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span>strchr<span class='Parentheses'>(</span><a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a><span class='Delimiter'>, </span><span class='String'>'/'</span><span class='Parentheses'>) </span><span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span> 
                <a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>= </span>strchr<span class='Parentheses'>(</span><a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a><span class='Delimiter'>, </span><span class='String'>'/'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="pg_upgrade.h.html#LN28"><span class='Ref_to_Macro'>GET_MAJOR_VERSION</span></a><span class='Parentheses'>(</span><a href="controldata.c.html#LN33"><span class='Ref_to_Parameter'>cluster</span></a><span class='Operator'>-&GT;</span><a href="pg_upgrade.h.html#LN271"><span class='Ref_to_Member'>major_version</span></a><span class='Parentheses'>) </span><span class='Operator'>&GT;= </span><span class='Number'>906</span><span class='Parentheses'>)</span> 
                <a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>= </span>strchr<span class='Parentheses'>(</span><a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a><span class='Delimiter'>, </span><span class='String'>':'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>else</span> 
                <a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL </span><span class='Operator'>|| </span>strlen<span class='Parentheses'>(</span><a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT;= </span><span class='Number'>1</span><span class='Parentheses'>)</span> 
                <a href="../pg_rewind/logging.c.html#LN81"><span class='Ref_to_Func'>pg_fatal</span></a><span class='Parentheses'>(</span><span class='String'>"%d: controldata retrieval problem\n"</span><span class='Delimiter'>, </span>__LINE__<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a><span class='Operator'>++</span><span class='Delimiter'>;</span>                <span class='Comment_Single_Line'>/* remove '/' or ':' char */ 
</span>            <a href="controldata.c.html#LN33"><span class='Ref_to_Parameter'>cluster</span></a><span class='Operator'>-&GT;</span><a href="pg_upgrade.h.html#LN261"><span class='Ref_to_Member'>controldata</span></a><span class='Operator'>.</span><a href="pg_upgrade.h.html#LN209"><span class='Ref_to_Member'>chkpnt_nxtxid</span></a> <span class='Operator'>= </span><a href="util.c.html#LN239"><span class='Ref_to_Func'>str2uint</span></a><span class='Parentheses'>(</span><a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="controldata.c.html#LN42"><span class='Ref_To_Local'>got_xid</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if (p=strstr(bufin,"Late... &raquo; </span> 
        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>= </span>strstr<span class='Parentheses'>(</span><a href="controldata.c.html#LN36"><span class='Ref_To_Local'>bufin</span></a><span class='Delimiter'>, </span><span class='String'>"Latest checkpoint's NextOID:"</span><span class='Parentheses'>))</span> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span> 
        <span class='Delimiter'>{ 
</span>            <a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>= </span>strchr<span class='Parentheses'>(</span><a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a><span class='Delimiter'>, </span><span class='String'>':'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL </span><span class='Operator'>|| </span>strlen<span class='Parentheses'>(</span><a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT;= </span><span class='Number'>1</span><span class='Parentheses'>)</span> 
                <a href="../pg_rewind/logging.c.html#LN81"><span class='Ref_to_Func'>pg_fatal</span></a><span class='Parentheses'>(</span><span class='String'>"%d: controldata retrieval problem\n"</span><span class='Delimiter'>, </span>__LINE__<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a><span class='Operator'>++</span><span class='Delimiter'>;</span>                <span class='Comment_Single_Line'>/* remove ':' char */ 
</span>            <a href="controldata.c.html#LN33"><span class='Ref_to_Parameter'>cluster</span></a><span class='Operator'>-&GT;</span><a href="pg_upgrade.h.html#LN261"><span class='Ref_to_Member'>controldata</span></a><span class='Operator'>.</span><a href="pg_upgrade.h.html#LN211"><span class='Ref_to_Member'>chkpnt_nxtoid</span></a> <span class='Operator'>= </span><a href="util.c.html#LN239"><span class='Ref_to_Func'>str2uint</span></a><span class='Parentheses'>(</span><a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="controldata.c.html#LN43"><span class='Ref_To_Local'>got_oid</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>= </span>strstr<span class='Parentheses'>(</span><a href="controldata.c.html#LN36"><span class='Ref_To_Local'>bufin</span></a><span class='Delimiter'>, </span><span class='String'>"Latest checkpoint's NextMultiXactId:"</span><span class='Parentheses'>))</span> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span> 
        <span class='Delimiter'>{ 
</span>            <a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>= </span>strchr<span class='Parentheses'>(</span><a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a><span class='Delimiter'>, </span><span class='String'>':'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL </span><span class='Operator'>|| </span>strlen<span class='Parentheses'>(</span><a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT;= </span><span class='Number'>1</span><span class='Parentheses'>)</span> 
                <a href="../pg_rewind/logging.c.html#LN81"><span class='Ref_to_Func'>pg_fatal</span></a><span class='Parentheses'>(</span><span class='String'>"%d: controldata retrieval problem\n"</span><span class='Delimiter'>, </span>__LINE__<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a><span class='Operator'>++</span><span class='Delimiter'>;</span>                <span class='Comment_Single_Line'>/* remove ':' char */ 
</span>            <a href="controldata.c.html#LN33"><span class='Ref_to_Parameter'>cluster</span></a><span class='Operator'>-&GT;</span><a href="pg_upgrade.h.html#LN261"><span class='Ref_to_Member'>controldata</span></a><span class='Operator'>.</span><a href="pg_upgrade.h.html#LN212"><span class='Ref_to_Member'>chkpnt_nxtmulti</span></a> <span class='Operator'>= </span><a href="util.c.html#LN239"><span class='Ref_to_Func'>str2uint</span></a><span class='Parentheses'>(</span><a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="controldata.c.html#LN44"><span class='Ref_To_Local'>got_multi</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>= </span>strstr<span class='Parentheses'>(</span><a href="controldata.c.html#LN36"><span class='Ref_To_Local'>bufin</span></a><span class='Delimiter'>, </span><span class='String'>"Latest checkpoint's oldestMultiXid:"</span><span class='Parentheses'>))</span> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span> 
        <span class='Delimiter'>{ 
</span>            <a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>= </span>strchr<span class='Parentheses'>(</span><a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a><span class='Delimiter'>, </span><span class='String'>':'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL </span><span class='Operator'>|| </span>strlen<span class='Parentheses'>(</span><a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT;= </span><span class='Number'>1</span><span class='Parentheses'>)</span> 
                <a href="../pg_rewind/logging.c.html#LN81"><span class='Ref_to_Func'>pg_fatal</span></a><span class='Parentheses'>(</span><span class='String'>"%d: controldata retrieval problem\n"</span><span class='Delimiter'>, </span>__LINE__<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a><span class='Operator'>++</span><span class='Delimiter'>;</span>                <span class='Comment_Single_Line'>/* remove ':' char */ 
</span>            <a href="controldata.c.html#LN33"><span class='Ref_to_Parameter'>cluster</span></a><span class='Operator'>-&GT;</span><a href="pg_upgrade.h.html#LN261"><span class='Ref_to_Member'>controldata</span></a><span class='Operator'>.</span><a href="pg_upgrade.h.html#LN214"><span class='Ref_to_Member'>chkpnt_oldstMulti</span></a> <span class='Operator'>= </span><a href="util.c.html#LN239"><span class='Ref_to_Func'>str2uint</span></a><span class='Parentheses'>(</span><a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="controldata.c.html#LN45"><span class='Ref_To_Local'>got_oldestmulti</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>= </span>strstr<span class='Parentheses'>(</span><a href="controldata.c.html#LN36"><span class='Ref_To_Local'>bufin</span></a><span class='Delimiter'>, </span><span class='String'>"Latest checkpoint's NextMultiOffset:"</span><span class='Parentheses'>))</span> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span> 
        <span class='Delimiter'>{ 
</span>            <a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>= </span>strchr<span class='Parentheses'>(</span><a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a><span class='Delimiter'>, </span><span class='String'>':'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL </span><span class='Operator'>|| </span>strlen<span class='Parentheses'>(</span><a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT;= </span><span class='Number'>1</span><span class='Parentheses'>)</span> 
                <a href="../pg_rewind/logging.c.html#LN81"><span class='Ref_to_Func'>pg_fatal</span></a><span class='Parentheses'>(</span><span class='String'>"%d: controldata retrieval problem\n"</span><span class='Delimiter'>, </span>__LINE__<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a><span class='Operator'>++</span><span class='Delimiter'>;</span>                <span class='Comment_Single_Line'>/* remove ':' char */ 
</span>            <a href="controldata.c.html#LN33"><span class='Ref_to_Parameter'>cluster</span></a><span class='Operator'>-&GT;</span><a href="pg_upgrade.h.html#LN261"><span class='Ref_to_Member'>controldata</span></a><span class='Operator'>.</span><a href="pg_upgrade.h.html#LN213"><span class='Ref_to_Member'>chkpnt_nxtmxoff</span></a> <span class='Operator'>= </span><a href="util.c.html#LN239"><span class='Ref_to_Func'>str2uint</span></a><span class='Parentheses'>(</span><a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="controldata.c.html#LN46"><span class='Ref_To_Local'>got_mxoff</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>= </span>strstr<span class='Parentheses'>(</span><a href="controldata.c.html#LN36"><span class='Ref_To_Local'>bufin</span></a><span class='Delimiter'>, </span><span class='String'>"First log segment after reset:"</span><span class='Parentheses'>))</span> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* Skip the colon and any whitespace after it */ 
</span>            <a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>= </span>strchr<span class='Parentheses'>(</span><a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a><span class='Delimiter'>, </span><span class='String'>':'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL </span><span class='Operator'>|| </span>strlen<span class='Parentheses'>(</span><a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT;= </span><span class='Number'>1</span><span class='Parentheses'>)</span> 
                <a href="../pg_rewind/logging.c.html#LN81"><span class='Ref_to_Func'>pg_fatal</span></a><span class='Parentheses'>(</span><span class='String'>"%d: controldata retrieval problem\n"</span><span class='Delimiter'>, </span>__LINE__<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>= </span>strpbrk<span class='Parentheses'>(</span><a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a><span class='Delimiter'>, </span><span class='String'>"01234567890ABCDEF"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL </span><span class='Operator'>|| </span>strlen<span class='Parentheses'>(</span><a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT;= </span><span class='Number'>1</span><span class='Parentheses'>)</span> 
                <a href="../pg_rewind/logging.c.html#LN81"><span class='Ref_to_Func'>pg_fatal</span></a><span class='Parentheses'>(</span><span class='String'>"%d: controldata retrieval problem\n"</span><span class='Delimiter'>, </span>__LINE__<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <span class='Comment_Multi_Line'>/* Make sure it looks like a valid WAL file name */ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span>strspn<span class='Parentheses'>(</span><a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a><span class='Delimiter'>, </span><span class='String'>"0123456789ABCDEF"</span><span class='Parentheses'>) </span><span class='Operator'>!= </span><span class='Number'>24</span><span class='Parentheses'>)</span> 
                <a href="../pg_rewind/logging.c.html#LN81"><span class='Ref_to_Func'>pg_fatal</span></a><span class='Parentheses'>(</span><span class='String'>"%d: controldata retrieval problem\n"</span><span class='Delimiter'>, </span>__LINE__<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <a href="../../port/strlcpy.c.html#LN43"><span class='Ref_to_Func'>strlcpy</span></a><span class='Parentheses'>(</span><a href="controldata.c.html#LN33"><span class='Ref_to_Parameter'>cluster</span></a><span class='Operator'>-&GT;</span><a href="pg_upgrade.h.html#LN261"><span class='Ref_to_Member'>controldata</span></a><span class='Operator'>.</span><a href="pg_upgrade.h.html#LN208"><span class='Ref_to_Member'>nextxlogfile</span></a><span class='Delimiter'>, </span><a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a><span class='Delimiter'>, </span><span class='Number'>25</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="controldata.c.html#LN47"><span class='Ref_To_Local'>got_nextxlogfile</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>= </span>strstr<span class='Parentheses'>(</span><a href="controldata.c.html#LN36"><span class='Ref_To_Local'>bufin</span></a><span class='Delimiter'>, </span><span class='String'>"Float8 argument passing:"</span><span class='Parentheses'>))</span> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span> 
        <span class='Delimiter'>{ 
</span>            <a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>= </span>strchr<span class='Parentheses'>(</span><a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a><span class='Delimiter'>, </span><span class='String'>':'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL </span><span class='Operator'>|| </span>strlen<span class='Parentheses'>(</span><a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT;= </span><span class='Number'>1</span><span class='Parentheses'>)</span> 
                <a href="../pg_rewind/logging.c.html#LN81"><span class='Ref_to_Func'>pg_fatal</span></a><span class='Parentheses'>(</span><span class='String'>"%d: controldata retrieval problem\n"</span><span class='Delimiter'>, </span>__LINE__<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a><span class='Operator'>++</span><span class='Delimiter'>;</span>                <span class='Comment_Single_Line'>/* remove ':' char */ 
</span>            <span class='Comment_Multi_Line'>/* used later for contrib check */ 
</span>            <a href="controldata.c.html#LN33"><span class='Ref_to_Parameter'>cluster</span></a><span class='Operator'>-&GT;</span><a href="pg_upgrade.h.html#LN261"><span class='Ref_to_Member'>controldata</span></a><span class='Operator'>.</span><a href="pg_upgrade.h.html#LN225"><span class='Ref_to_Member'>float8_pass_by_value</span></a> <span class='Operator'>= </span>strstr<span class='Parentheses'>(</span><a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a><span class='Delimiter'>, </span><span class='String'>"by value"</span><span class='Parentheses'>) </span><span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>            <a href="controldata.c.html#LN48"><span class='Ref_To_Local'>got_float8_pass_by_value</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>= </span>strstr<span class='Parentheses'>(</span><a href="controldata.c.html#LN36"><span class='Ref_To_Local'>bufin</span></a><span class='Delimiter'>, </span><span class='String'>"Maximum data alignment:"</span><span class='Parentheses'>))</span> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span> 
        <span class='Delimiter'>{ 
</span>            <a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>= </span>strchr<span class='Parentheses'>(</span><a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a><span class='Delimiter'>, </span><span class='String'>':'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL </span><span class='Operator'>|| </span>strlen<span class='Parentheses'>(</span><a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT;= </span><span class='Number'>1</span><span class='Parentheses'>)</span> 
                <a href="../pg_rewind/logging.c.html#LN81"><span class='Ref_to_Func'>pg_fatal</span></a><span class='Parentheses'>(</span><span class='String'>"%d: controldata retrieval problem\n"</span><span class='Delimiter'>, </span>__LINE__<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a><span class='Operator'>++</span><span class='Delimiter'>;</span>                <span class='Comment_Single_Line'>/* remove ':' char */ 
</span>            <a href="controldata.c.html#LN33"><span class='Ref_to_Parameter'>cluster</span></a><span class='Operator'>-&GT;</span><a href="pg_upgrade.h.html#LN261"><span class='Ref_to_Member'>controldata</span></a><span class='Operator'>.</span><a href="pg_upgrade.h.html#LN215"><span class='Ref_to_Member'>align</span></a> <span class='Operator'>= </span><a href="util.c.html#LN239"><span class='Ref_to_Func'>str2uint</span></a><span class='Parentheses'>(</span><a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="controldata.c.html#LN49"><span class='Ref_To_Local'>got_align</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>= </span>strstr<span class='Parentheses'>(</span><a href="controldata.c.html#LN36"><span class='Ref_To_Local'>bufin</span></a><span class='Delimiter'>, </span><span class='String'>"Database block size:"</span><span class='Parentheses'>))</span> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span> 
        <span class='Delimiter'>{ 
</span>            <a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>= </span>strchr<span class='Parentheses'>(</span><a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a><span class='Delimiter'>, </span><span class='String'>':'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL </span><span class='Operator'>|| </span>strlen<span class='Parentheses'>(</span><a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT;= </span><span class='Number'>1</span><span class='Parentheses'>)</span> 
                <a href="../pg_rewind/logging.c.html#LN81"><span class='Ref_to_Func'>pg_fatal</span></a><span class='Parentheses'>(</span><span class='String'>"%d: controldata retrieval problem\n"</span><span class='Delimiter'>, </span>__LINE__<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a><span class='Operator'>++</span><span class='Delimiter'>;</span>                <span class='Comment_Single_Line'>/* remove ':' char */ 
</span>            <a href="controldata.c.html#LN33"><span class='Ref_to_Parameter'>cluster</span></a><span class='Operator'>-&GT;</span><a href="pg_upgrade.h.html#LN261"><span class='Ref_to_Member'>controldata</span></a><span class='Operator'>.</span><a href="pg_upgrade.h.html#LN216"><span class='Ref_to_Member'>blocksz</span></a> <span class='Operator'>= </span><a href="util.c.html#LN239"><span class='Ref_to_Func'>str2uint</span></a><span class='Parentheses'>(</span><a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="controldata.c.html#LN50"><span class='Ref_To_Local'>got_blocksz</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>= </span>strstr<span class='Parentheses'>(</span><a href="controldata.c.html#LN36"><span class='Ref_To_Local'>bufin</span></a><span class='Delimiter'>, </span><span class='String'>"Blocks per segment of large relation:"</span><span class='Parentheses'>))</span> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span> 
        <span class='Delimiter'>{ 
</span>            <a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>= </span>strchr<span class='Parentheses'>(</span><a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a><span class='Delimiter'>, </span><span class='String'>':'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL </span><span class='Operator'>|| </span>strlen<span class='Parentheses'>(</span><a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT;= </span><span class='Number'>1</span><span class='Parentheses'>)</span> 
                <a href="../pg_rewind/logging.c.html#LN81"><span class='Ref_to_Func'>pg_fatal</span></a><span class='Parentheses'>(</span><span class='String'>"%d: controldata retrieval problem\n"</span><span class='Delimiter'>, </span>__LINE__<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a><span class='Operator'>++</span><span class='Delimiter'>;</span>                <span class='Comment_Single_Line'>/* remove ':' char */ 
</span>            <a href="controldata.c.html#LN33"><span class='Ref_to_Parameter'>cluster</span></a><span class='Operator'>-&GT;</span><a href="pg_upgrade.h.html#LN261"><span class='Ref_to_Member'>controldata</span></a><span class='Operator'>.</span><a href="pg_upgrade.h.html#LN217"><span class='Ref_to_Member'>largesz</span></a> <span class='Operator'>= </span><a href="util.c.html#LN239"><span class='Ref_to_Func'>str2uint</span></a><span class='Parentheses'>(</span><a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="controldata.c.html#LN51"><span class='Ref_To_Local'>got_largesz</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>= </span>strstr<span class='Parentheses'>(</span><a href="controldata.c.html#LN36"><span class='Ref_To_Local'>bufin</span></a><span class='Delimiter'>, </span><span class='String'>"WAL block size:"</span><span class='Parentheses'>))</span> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span> 
        <span class='Delimiter'>{ 
</span>            <a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>= </span>strchr<span class='Parentheses'>(</span><a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a><span class='Delimiter'>, </span><span class='String'>':'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL </span><span class='Operator'>|| </span>strlen<span class='Parentheses'>(</span><a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT;= </span><span class='Number'>1</span><span class='Parentheses'>)</span> 
                <a href="../pg_rewind/logging.c.html#LN81"><span class='Ref_to_Func'>pg_fatal</span></a><span class='Parentheses'>(</span><span class='String'>"%d: controldata retrieval problem\n"</span><span class='Delimiter'>, </span>__LINE__<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a><span class='Operator'>++</span><span class='Delimiter'>;</span>                <span class='Comment_Single_Line'>/* remove ':' char */ 
</span>            <a href="controldata.c.html#LN33"><span class='Ref_to_Parameter'>cluster</span></a><span class='Operator'>-&GT;</span><a href="pg_upgrade.h.html#LN261"><span class='Ref_to_Member'>controldata</span></a><span class='Operator'>.</span><a href="pg_upgrade.h.html#LN218"><span class='Ref_to_Member'>walsz</span></a> <span class='Operator'>= </span><a href="util.c.html#LN239"><span class='Ref_to_Func'>str2uint</span></a><span class='Parentheses'>(</span><a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="controldata.c.html#LN52"><span class='Ref_To_Local'>got_walsz</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>= </span>strstr<span class='Parentheses'>(</span><a href="controldata.c.html#LN36"><span class='Ref_To_Local'>bufin</span></a><span class='Delimiter'>, </span><span class='String'>"Bytes per WAL segment:"</span><span class='Parentheses'>))</span> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span> 
        <span class='Delimiter'>{ 
</span>            <a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>= </span>strchr<span class='Parentheses'>(</span><a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a><span class='Delimiter'>, </span><span class='String'>':'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL </span><span class='Operator'>|| </span>strlen<span class='Parentheses'>(</span><a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT;= </span><span class='Number'>1</span><span class='Parentheses'>)</span> 
                <a href="../pg_rewind/logging.c.html#LN81"><span class='Ref_to_Func'>pg_fatal</span></a><span class='Parentheses'>(</span><span class='String'>"%d: controldata retrieval problem\n"</span><span class='Delimiter'>, </span>__LINE__<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a><span class='Operator'>++</span><span class='Delimiter'>;</span>                <span class='Comment_Single_Line'>/* remove ':' char */ 
</span>            <a href="controldata.c.html#LN33"><span class='Ref_to_Parameter'>cluster</span></a><span class='Operator'>-&GT;</span><a href="pg_upgrade.h.html#LN261"><span class='Ref_to_Member'>controldata</span></a><span class='Operator'>.</span><a href="pg_upgrade.h.html#LN219"><span class='Ref_to_Member'>walseg</span></a> <span class='Operator'>= </span><a href="util.c.html#LN239"><span class='Ref_to_Func'>str2uint</span></a><span class='Parentheses'>(</span><a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="controldata.c.html#LN53"><span class='Ref_To_Local'>got_walseg</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>= </span>strstr<span class='Parentheses'>(</span><a href="controldata.c.html#LN36"><span class='Ref_To_Local'>bufin</span></a><span class='Delimiter'>, </span><span class='String'>"Maximum length of identifiers:"</span><span class='Parentheses'>))</span> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span> 
        <span class='Delimiter'>{ 
</span>            <a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>= </span>strchr<span class='Parentheses'>(</span><a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a><span class='Delimiter'>, </span><span class='String'>':'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL </span><span class='Operator'>|| </span>strlen<span class='Parentheses'>(</span><a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT;= </span><span class='Number'>1</span><span class='Parentheses'>)</span> 
                <a href="../pg_rewind/logging.c.html#LN81"><span class='Ref_to_Func'>pg_fatal</span></a><span class='Parentheses'>(</span><span class='String'>"%d: controldata retrieval problem\n"</span><span class='Delimiter'>, </span>__LINE__<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a><span class='Operator'>++</span><span class='Delimiter'>;</span>                <span class='Comment_Single_Line'>/* remove ':' char */ 
</span>            <a href="controldata.c.html#LN33"><span class='Ref_to_Parameter'>cluster</span></a><span class='Operator'>-&GT;</span><a href="pg_upgrade.h.html#LN261"><span class='Ref_to_Member'>controldata</span></a><span class='Operator'>.</span><a href="pg_upgrade.h.html#LN220"><span class='Ref_to_Member'>ident</span></a> <span class='Operator'>= </span><a href="util.c.html#LN239"><span class='Ref_to_Func'>str2uint</span></a><span class='Parentheses'>(</span><a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="controldata.c.html#LN54"><span class='Ref_To_Local'>got_ident</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>= </span>strstr<span class='Parentheses'>(</span><a href="controldata.c.html#LN36"><span class='Ref_To_Local'>bufin</span></a><span class='Delimiter'>, </span><span class='String'>"Maximum columns in an index:"</span><span class='Parentheses'>))</span> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span> 
        <span class='Delimiter'>{ 
</span>            <a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>= </span>strchr<span class='Parentheses'>(</span><a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a><span class='Delimiter'>, </span><span class='String'>':'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL </span><span class='Operator'>|| </span>strlen<span class='Parentheses'>(</span><a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT;= </span><span class='Number'>1</span><span class='Parentheses'>)</span> 
                <a href="../pg_rewind/logging.c.html#LN81"><span class='Ref_to_Func'>pg_fatal</span></a><span class='Parentheses'>(</span><span class='String'>"%d: controldata retrieval problem\n"</span><span class='Delimiter'>, </span>__LINE__<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a><span class='Operator'>++</span><span class='Delimiter'>;</span>                <span class='Comment_Single_Line'>/* remove ':' char */ 
</span>            <a href="controldata.c.html#LN33"><span class='Ref_to_Parameter'>cluster</span></a><span class='Operator'>-&GT;</span><a href="pg_upgrade.h.html#LN261"><span class='Ref_to_Member'>controldata</span></a><span class='Operator'>.</span><a href="pg_upgrade.h.html#LN221"><span class='Ref_to_Member'>index</span></a> <span class='Operator'>= </span><a href="util.c.html#LN239"><span class='Ref_to_Func'>str2uint</span></a><span class='Parentheses'>(</span><a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="controldata.c.html#LN55"><span class='Ref_To_Local'>got_index</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>= </span>strstr<span class='Parentheses'>(</span><a href="controldata.c.html#LN36"><span class='Ref_To_Local'>bufin</span></a><span class='Delimiter'>, </span><span class='String'>"Maximum size of a TOAST chunk:"</span><span class='Parentheses'>))</span> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span> 
        <span class='Delimiter'>{ 
</span>            <a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>= </span>strchr<span class='Parentheses'>(</span><a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a><span class='Delimiter'>, </span><span class='String'>':'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL </span><span class='Operator'>|| </span>strlen<span class='Parentheses'>(</span><a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT;= </span><span class='Number'>1</span><span class='Parentheses'>)</span> 
                <a href="../pg_rewind/logging.c.html#LN81"><span class='Ref_to_Func'>pg_fatal</span></a><span class='Parentheses'>(</span><span class='String'>"%d: controldata retrieval problem\n"</span><span class='Delimiter'>, </span>__LINE__<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a><span class='Operator'>++</span><span class='Delimiter'>;</span>                <span class='Comment_Single_Line'>/* remove ':' char */ 
</span>            <a href="controldata.c.html#LN33"><span class='Ref_to_Parameter'>cluster</span></a><span class='Operator'>-&GT;</span><a href="pg_upgrade.h.html#LN261"><span class='Ref_to_Member'>controldata</span></a><span class='Operator'>.</span><a href="pg_upgrade.h.html#LN222"><span class='Ref_to_Member'>toast</span></a> <span class='Operator'>= </span><a href="util.c.html#LN239"><span class='Ref_to_Func'>str2uint</span></a><span class='Parentheses'>(</span><a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="controldata.c.html#LN56"><span class='Ref_To_Local'>got_toast</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>= </span>strstr<span class='Parentheses'>(</span><a href="controldata.c.html#LN36"><span class='Ref_To_Local'>bufin</span></a><span class='Delimiter'>, </span><span class='String'>"Size of a large-object chunk:"</span><span class='Parentheses'>))</span> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span> 
        <span class='Delimiter'>{ 
</span>            <a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>= </span>strchr<span class='Parentheses'>(</span><a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a><span class='Delimiter'>, </span><span class='String'>':'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL </span><span class='Operator'>|| </span>strlen<span class='Parentheses'>(</span><a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT;= </span><span class='Number'>1</span><span class='Parentheses'>)</span> 
                <a href="../pg_rewind/logging.c.html#LN81"><span class='Ref_to_Func'>pg_fatal</span></a><span class='Parentheses'>(</span><span class='String'>"%d: controldata retrieval problem\n"</span><span class='Delimiter'>, </span>__LINE__<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a><span class='Operator'>++</span><span class='Delimiter'>;</span>                <span class='Comment_Single_Line'>/* remove ':' char */ 
</span>            <a href="controldata.c.html#LN33"><span class='Ref_to_Parameter'>cluster</span></a><span class='Operator'>-&GT;</span><a href="pg_upgrade.h.html#LN261"><span class='Ref_to_Member'>controldata</span></a><span class='Operator'>.</span><a href="pg_upgrade.h.html#LN223"><span class='Ref_to_Member'>large_object</span></a> <span class='Operator'>= </span><a href="util.c.html#LN239"><span class='Ref_to_Func'>str2uint</span></a><span class='Parentheses'>(</span><a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="controldata.c.html#LN57"><span class='Ref_To_Local'>got_large_object</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>= </span>strstr<span class='Parentheses'>(</span><a href="controldata.c.html#LN36"><span class='Ref_To_Local'>bufin</span></a><span class='Delimiter'>, </span><span class='String'>"Date/time type storage:"</span><span class='Parentheses'>))</span> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span> 
        <span class='Delimiter'>{ 
</span>            <a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>= </span>strchr<span class='Parentheses'>(</span><a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a><span class='Delimiter'>, </span><span class='String'>':'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL </span><span class='Operator'>|| </span>strlen<span class='Parentheses'>(</span><a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT;= </span><span class='Number'>1</span><span class='Parentheses'>)</span> 
                <a href="../pg_rewind/logging.c.html#LN81"><span class='Ref_to_Func'>pg_fatal</span></a><span class='Parentheses'>(</span><span class='String'>"%d: controldata retrieval problem\n"</span><span class='Delimiter'>, </span>__LINE__<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a><span class='Operator'>++</span><span class='Delimiter'>;</span>                <span class='Comment_Single_Line'>/* remove ':' char */ 
</span>            <a href="controldata.c.html#LN33"><span class='Ref_to_Parameter'>cluster</span></a><span class='Operator'>-&GT;</span><a href="pg_upgrade.h.html#LN261"><span class='Ref_to_Member'>controldata</span></a><span class='Operator'>.</span><a href="pg_upgrade.h.html#LN224"><span class='Ref_to_Member'>date_is_int</span></a> <span class='Operator'>= </span>strstr<span class='Parentheses'>(</span><a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a><span class='Delimiter'>, </span><span class='String'>"64-bit integers"</span><span class='Parentheses'>) </span><span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>            <a href="controldata.c.html#LN58"><span class='Ref_To_Local'>got_date_is_int</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>= </span>strstr<span class='Parentheses'>(</span><a href="controldata.c.html#LN36"><span class='Ref_To_Local'>bufin</span></a><span class='Delimiter'>, </span><span class='String'>"checksum"</span><span class='Parentheses'>))</span> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span> 
        <span class='Delimiter'>{ 
</span>            <a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>= </span>strchr<span class='Parentheses'>(</span><a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a><span class='Delimiter'>, </span><span class='String'>':'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL </span><span class='Operator'>|| </span>strlen<span class='Parentheses'>(</span><a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT;= </span><span class='Number'>1</span><span class='Parentheses'>)</span> 
                <a href="../pg_rewind/logging.c.html#LN81"><span class='Ref_to_Func'>pg_fatal</span></a><span class='Parentheses'>(</span><span class='String'>"%d: controldata retrieval problem\n"</span><span class='Delimiter'>, </span>__LINE__<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a><span class='Operator'>++</span><span class='Delimiter'>;</span>                <span class='Comment_Single_Line'>/* remove ':' char */ 
</span>            <span class='Comment_Multi_Line'>/* used later for contrib check */ 
</span>            <a href="controldata.c.html#LN33"><span class='Ref_to_Parameter'>cluster</span></a><span class='Operator'>-&GT;</span><a href="pg_upgrade.h.html#LN261"><span class='Ref_to_Member'>controldata</span></a><span class='Operator'>.</span><a href="pg_upgrade.h.html#LN226"><span class='Ref_to_Member'>data_checksum_version</span></a> <span class='Operator'>= </span><a href="util.c.html#LN239"><span class='Ref_to_Func'>str2uint</span></a><span class='Parentheses'>(</span><a href="controldata.c.html#LN38"><span class='Ref_To_Local'>p</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="controldata.c.html#LN59"><span class='Ref_To_Local'>got_data_checksum_version</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end while fgets(bufin,sizeof(bu... &raquo; </span> 
 
    <a href="../../include/port.h.html#LN314"><span class='Ref_to_Macro'>pclose</span></a><span class='Parentheses'>(</span><a href="controldata.c.html#LN37"><span class='Ref_To_Local'>output</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Restore environment variables 
     */ 
</span>    <a href="util.c.html#LN252"><span class='Ref_to_Func'>pg_putenv</span></a><span class='Parentheses'>(</span><span class='String'>"LC_COLLATE"</span><span class='Delimiter'>, </span><a href="controldata.c.html#LN60"><span class='Ref_To_Local'>lc_collate</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="util.c.html#LN252"><span class='Ref_to_Func'>pg_putenv</span></a><span class='Parentheses'>(</span><span class='String'>"LC_CTYPE"</span><span class='Delimiter'>, </span><a href="controldata.c.html#LN61"><span class='Ref_To_Local'>lc_ctype</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="util.c.html#LN252"><span class='Ref_to_Func'>pg_putenv</span></a><span class='Parentheses'>(</span><span class='String'>"LC_MONETARY"</span><span class='Delimiter'>, </span><a href="controldata.c.html#LN62"><span class='Ref_To_Local'>lc_monetary</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="util.c.html#LN252"><span class='Ref_to_Func'>pg_putenv</span></a><span class='Parentheses'>(</span><span class='String'>"LC_NUMERIC"</span><span class='Delimiter'>, </span><a href="controldata.c.html#LN63"><span class='Ref_To_Local'>lc_numeric</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="util.c.html#LN252"><span class='Ref_to_Func'>pg_putenv</span></a><span class='Parentheses'>(</span><span class='String'>"LC_TIME"</span><span class='Delimiter'>, </span><a href="controldata.c.html#LN64"><span class='Ref_To_Local'>lc_time</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="util.c.html#LN252"><span class='Ref_to_Func'>pg_putenv</span></a><span class='Parentheses'>(</span><span class='String'>"LANG"</span><span class='Delimiter'>, </span><a href="controldata.c.html#LN65"><span class='Ref_To_Local'>lang</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="util.c.html#LN252"><span class='Ref_to_Func'>pg_putenv</span></a><span class='Parentheses'>(</span><span class='String'>"LANGUAGE"</span><span class='Delimiter'>, </span><a href="controldata.c.html#LN66"><span class='Ref_To_Local'>language</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="util.c.html#LN252"><span class='Ref_to_Func'>pg_putenv</span></a><span class='Parentheses'>(</span><span class='String'>"LC_ALL"</span><span class='Delimiter'>, </span><a href="controldata.c.html#LN67"><span class='Ref_To_Local'>lc_all</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="util.c.html#LN252"><span class='Ref_to_Func'>pg_putenv</span></a><span class='Parentheses'>(</span><span class='String'>"LC_MESSAGES"</span><span class='Delimiter'>, </span><a href="controldata.c.html#LN68"><span class='Ref_To_Local'>lc_messages</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../include/common/fe_memutils.h.html#LN29"><span class='Ref_to_Proto'>pg_free</span></a><span class='Parentheses'>(</span><a href="controldata.c.html#LN60"><span class='Ref_To_Local'>lc_collate</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../include/common/fe_memutils.h.html#LN29"><span class='Ref_to_Proto'>pg_free</span></a><span class='Parentheses'>(</span><a href="controldata.c.html#LN61"><span class='Ref_To_Local'>lc_ctype</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../include/common/fe_memutils.h.html#LN29"><span class='Ref_to_Proto'>pg_free</span></a><span class='Parentheses'>(</span><a href="controldata.c.html#LN62"><span class='Ref_To_Local'>lc_monetary</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../include/common/fe_memutils.h.html#LN29"><span class='Ref_to_Proto'>pg_free</span></a><span class='Parentheses'>(</span><a href="controldata.c.html#LN63"><span class='Ref_To_Local'>lc_numeric</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../include/common/fe_memutils.h.html#LN29"><span class='Ref_to_Proto'>pg_free</span></a><span class='Parentheses'>(</span><a href="controldata.c.html#LN64"><span class='Ref_To_Local'>lc_time</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../include/common/fe_memutils.h.html#LN29"><span class='Ref_to_Proto'>pg_free</span></a><span class='Parentheses'>(</span><a href="controldata.c.html#LN65"><span class='Ref_To_Local'>lang</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../include/common/fe_memutils.h.html#LN29"><span class='Ref_to_Proto'>pg_free</span></a><span class='Parentheses'>(</span><a href="controldata.c.html#LN66"><span class='Ref_To_Local'>language</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../include/common/fe_memutils.h.html#LN29"><span class='Ref_to_Proto'>pg_free</span></a><span class='Parentheses'>(</span><a href="controldata.c.html#LN67"><span class='Ref_To_Local'>lc_all</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../include/common/fe_memutils.h.html#LN29"><span class='Ref_to_Proto'>pg_free</span></a><span class='Parentheses'>(</span><a href="controldata.c.html#LN68"><span class='Ref_To_Local'>lc_messages</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Before 9.3, pg_resetwal reported the xlogid and segno of the first log 
     * file after reset as separate lines. Starting with 9.3, it reports the 
     * WAL file name. If the old cluster is older than 9.3, we construct the 
     * WAL file name from the xlogid and segno. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="pg_upgrade.h.html#LN28"><span class='Ref_to_Macro'>GET_MAJOR_VERSION</span></a><span class='Parentheses'>(</span><a href="controldata.c.html#LN33"><span class='Ref_to_Parameter'>cluster</span></a><span class='Operator'>-&GT;</span><a href="pg_upgrade.h.html#LN271"><span class='Ref_to_Member'>major_version</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT;= </span><span class='Number'>902</span><span class='Parentheses'>)</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="controldata.c.html#LN39"><span class='Ref_To_Local'>got_tli</span></a> <span class='Operator'>&& </span><a href="controldata.c.html#LN40"><span class='Ref_To_Local'>got_log_id</span></a> <span class='Operator'>&& </span><a href="controldata.c.html#LN41"><span class='Ref_To_Local'>got_log_seg</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <a href="../../pl/plperl/plperl.h.html#LN60"><span class='Ref_to_Macro'>snprintf</span></a><span class='Parentheses'>(</span><a href="controldata.c.html#LN33"><span class='Ref_to_Parameter'>cluster</span></a><span class='Operator'>-&GT;</span><a href="pg_upgrade.h.html#LN261"><span class='Ref_to_Member'>controldata</span></a><span class='Operator'>.</span><a href="pg_upgrade.h.html#LN208"><span class='Ref_to_Member'>nextxlogfile</span></a><span class='Delimiter'>, </span><span class='Number'>25</span><span class='Delimiter'>, </span><span class='String'>"%08X%08X%08X"</span><span class='Delimiter'>, 
</span>                     <a href="controldata.c.html#LN69"><span class='Ref_To_Local'>tli</span></a><span class='Delimiter'>, </span><a href="controldata.c.html#LN70"><span class='Ref_To_Local'>logid</span></a><span class='Delimiter'>, </span><a href="controldata.c.html#LN71"><span class='Ref_To_Local'>segno</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="controldata.c.html#LN47"><span class='Ref_To_Local'>got_nextxlogfile</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* verify that we got all the mandatory pg_control data */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="controldata.c.html#LN42"><span class='Ref_To_Local'>got_xid</span></a> <span class='Operator'>|| !</span><a href="controldata.c.html#LN43"><span class='Ref_To_Local'>got_oid</span></a> <span class='Operator'>|| 
</span>        <span class='Operator'>!</span><a href="controldata.c.html#LN44"><span class='Ref_To_Local'>got_multi</span></a> <span class='Operator'>|| 
</span>        <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="controldata.c.html#LN45"><span class='Ref_To_Local'>got_oldestmulti</span></a> <span class='Operator'>&& 
</span>         <a href="controldata.c.html#LN33"><span class='Ref_to_Parameter'>cluster</span></a><span class='Operator'>-&GT;</span><a href="pg_upgrade.h.html#LN261"><span class='Ref_to_Member'>controldata</span></a><span class='Operator'>.</span><a href="pg_upgrade.h.html#LN207"><span class='Ref_to_Member'>cat_ver</span></a> <span class='Operator'>&GT;= </span><a href="pg_upgrade.h.html#LN119"><span class='Ref_to_Const'>MULTIXACT_FORMATCHANGE_CAT_VER</span></a><span class='Parentheses'>) </span><span class='Operator'>|| 
</span>        <span class='Operator'>!</span><a href="controldata.c.html#LN46"><span class='Ref_To_Local'>got_mxoff</span></a> <span class='Operator'>|| </span><span class='Parentheses'>(</span><span class='Operator'>!</span><a href="controldata.c.html#LN33"><span class='Ref_to_Parameter'>live_check</span></a> <span class='Operator'>&& !</span><a href="controldata.c.html#LN47"><span class='Ref_To_Local'>got_nextxlogfile</span></a><span class='Parentheses'>) </span><span class='Operator'>|| 
</span>        <span class='Operator'>!</span><a href="controldata.c.html#LN48"><span class='Ref_To_Local'>got_float8_pass_by_value</span></a> <span class='Operator'>|| !</span><a href="controldata.c.html#LN49"><span class='Ref_To_Local'>got_align</span></a> <span class='Operator'>|| !</span><a href="controldata.c.html#LN50"><span class='Ref_To_Local'>got_blocksz</span></a> <span class='Operator'>|| 
</span>        <span class='Operator'>!</span><a href="controldata.c.html#LN51"><span class='Ref_To_Local'>got_largesz</span></a> <span class='Operator'>|| !</span><a href="controldata.c.html#LN52"><span class='Ref_To_Local'>got_walsz</span></a> <span class='Operator'>|| !</span><a href="controldata.c.html#LN53"><span class='Ref_To_Local'>got_walseg</span></a> <span class='Operator'>|| !</span><a href="controldata.c.html#LN54"><span class='Ref_To_Local'>got_ident</span></a> <span class='Operator'>|| 
</span>        <span class='Operator'>!</span><a href="controldata.c.html#LN55"><span class='Ref_To_Local'>got_index</span></a> <span class='Operator'>|| !</span><a href="controldata.c.html#LN56"><span class='Ref_To_Local'>got_toast</span></a> <span class='Operator'>|| 
</span>        <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="controldata.c.html#LN57"><span class='Ref_To_Local'>got_large_object</span></a> <span class='Operator'>&& 
</span>         <a href="controldata.c.html#LN33"><span class='Ref_to_Parameter'>cluster</span></a><span class='Operator'>-&GT;</span><a href="pg_upgrade.h.html#LN261"><span class='Ref_to_Member'>controldata</span></a><span class='Operator'>.</span><a href="pg_upgrade.h.html#LN206"><span class='Ref_to_Member'>ctrl_ver</span></a> <span class='Operator'>&GT;= </span><a href="pg_upgrade.h.html#LN125"><span class='Ref_to_Const'>LARGE_OBJECT_SIZE_PG_CONTROL_VER</span></a><span class='Parentheses'>) </span><span class='Operator'>|| 
</span>        <span class='Operator'>!</span><a href="controldata.c.html#LN58"><span class='Ref_To_Local'>got_date_is_int</span></a> <span class='Operator'>|| !</span><a href="controldata.c.html#LN59"><span class='Ref_To_Local'>got_data_checksum_version</span></a><span class='Parentheses'>)</span> 
    <span class='Delimiter'>{ 
</span>        <a href="../pg_rewind/logging.c.html#LN67"><span class='Ref_to_Func'>pg_log</span></a><span class='Parentheses'>(</span><a href="pg_upgrade.h.html#LN245"><span class='Ref_to_EnumConst'>PG_REPORT</span></a><span class='Delimiter'>, 
</span>               <span class='String'>"The %s cluster lacks some required control information:\n"</span><span class='Delimiter'>, 
</span>               <a href="pg_upgrade.h.html#LN96"><span class='Ref_to_Macro'>CLUSTER_NAME</span></a><span class='Parentheses'>(</span><a href="controldata.c.html#LN33"><span class='Ref_to_Parameter'>cluster</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="controldata.c.html#LN42"><span class='Ref_To_Local'>got_xid</span></a><span class='Parentheses'>) 
</span>            <a href="../pg_rewind/logging.c.html#LN67"><span class='Ref_to_Func'>pg_log</span></a><span class='Parentheses'>(</span><a href="pg_upgrade.h.html#LN245"><span class='Ref_to_EnumConst'>PG_REPORT</span></a><span class='Delimiter'>, </span><span class='String'>"  checkpoint next XID\n"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="controldata.c.html#LN43"><span class='Ref_To_Local'>got_oid</span></a><span class='Parentheses'>) 
</span>            <a href="../pg_rewind/logging.c.html#LN67"><span class='Ref_to_Func'>pg_log</span></a><span class='Parentheses'>(</span><a href="pg_upgrade.h.html#LN245"><span class='Ref_to_EnumConst'>PG_REPORT</span></a><span class='Delimiter'>, </span><span class='String'>"  latest checkpoint next OID\n"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="controldata.c.html#LN44"><span class='Ref_To_Local'>got_multi</span></a><span class='Parentheses'>) 
</span>            <a href="../pg_rewind/logging.c.html#LN67"><span class='Ref_to_Func'>pg_log</span></a><span class='Parentheses'>(</span><a href="pg_upgrade.h.html#LN245"><span class='Ref_to_EnumConst'>PG_REPORT</span></a><span class='Delimiter'>, </span><span class='String'>"  latest checkpoint next MultiXactId\n"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="controldata.c.html#LN45"><span class='Ref_To_Local'>got_oldestmulti</span></a> <span class='Operator'>&& 
</span>            <a href="controldata.c.html#LN33"><span class='Ref_to_Parameter'>cluster</span></a><span class='Operator'>-&GT;</span><a href="pg_upgrade.h.html#LN261"><span class='Ref_to_Member'>controldata</span></a><span class='Operator'>.</span><a href="pg_upgrade.h.html#LN207"><span class='Ref_to_Member'>cat_ver</span></a> <span class='Operator'>&GT;= </span><a href="pg_upgrade.h.html#LN119"><span class='Ref_to_Const'>MULTIXACT_FORMATCHANGE_CAT_VER</span></a><span class='Parentheses'>) 
</span>            <a href="../pg_rewind/logging.c.html#LN67"><span class='Ref_to_Func'>pg_log</span></a><span class='Parentheses'>(</span><a href="pg_upgrade.h.html#LN245"><span class='Ref_to_EnumConst'>PG_REPORT</span></a><span class='Delimiter'>, </span><span class='String'>"  latest checkpoint oldest MultiXactId\n"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="controldata.c.html#LN46"><span class='Ref_To_Local'>got_mxoff</span></a><span class='Parentheses'>) 
</span>            <a href="../pg_rewind/logging.c.html#LN67"><span class='Ref_to_Func'>pg_log</span></a><span class='Parentheses'>(</span><a href="pg_upgrade.h.html#LN245"><span class='Ref_to_EnumConst'>PG_REPORT</span></a><span class='Delimiter'>, </span><span class='String'>"  latest checkpoint next MultiXactOffset\n"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="controldata.c.html#LN33"><span class='Ref_to_Parameter'>live_check</span></a> <span class='Operator'>&& !</span><a href="controldata.c.html#LN47"><span class='Ref_To_Local'>got_nextxlogfile</span></a><span class='Parentheses'>) 
</span>            <a href="../pg_rewind/logging.c.html#LN67"><span class='Ref_to_Func'>pg_log</span></a><span class='Parentheses'>(</span><a href="pg_upgrade.h.html#LN245"><span class='Ref_to_EnumConst'>PG_REPORT</span></a><span class='Delimiter'>, </span><span class='String'>"  first WAL segment after reset\n"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="controldata.c.html#LN48"><span class='Ref_To_Local'>got_float8_pass_by_value</span></a><span class='Parentheses'>) 
</span>            <a href="../pg_rewind/logging.c.html#LN67"><span class='Ref_to_Func'>pg_log</span></a><span class='Parentheses'>(</span><a href="pg_upgrade.h.html#LN245"><span class='Ref_to_EnumConst'>PG_REPORT</span></a><span class='Delimiter'>, </span><span class='String'>"  float8 argument passing method\n"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="controldata.c.html#LN49"><span class='Ref_To_Local'>got_align</span></a><span class='Parentheses'>) 
</span>            <a href="../pg_rewind/logging.c.html#LN67"><span class='Ref_to_Func'>pg_log</span></a><span class='Parentheses'>(</span><a href="pg_upgrade.h.html#LN245"><span class='Ref_to_EnumConst'>PG_REPORT</span></a><span class='Delimiter'>, </span><span class='String'>"  maximum alignment\n"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="controldata.c.html#LN50"><span class='Ref_To_Local'>got_blocksz</span></a><span class='Parentheses'>) 
</span>            <a href="../pg_rewind/logging.c.html#LN67"><span class='Ref_to_Func'>pg_log</span></a><span class='Parentheses'>(</span><a href="pg_upgrade.h.html#LN245"><span class='Ref_to_EnumConst'>PG_REPORT</span></a><span class='Delimiter'>, </span><span class='String'>"  block size\n"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="controldata.c.html#LN51"><span class='Ref_To_Local'>got_largesz</span></a><span class='Parentheses'>) 
</span>            <a href="../pg_rewind/logging.c.html#LN67"><span class='Ref_to_Func'>pg_log</span></a><span class='Parentheses'>(</span><a href="pg_upgrade.h.html#LN245"><span class='Ref_to_EnumConst'>PG_REPORT</span></a><span class='Delimiter'>, </span><span class='String'>"  large relation segment size\n"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="controldata.c.html#LN52"><span class='Ref_To_Local'>got_walsz</span></a><span class='Parentheses'>) 
</span>            <a href="../pg_rewind/logging.c.html#LN67"><span class='Ref_to_Func'>pg_log</span></a><span class='Parentheses'>(</span><a href="pg_upgrade.h.html#LN245"><span class='Ref_to_EnumConst'>PG_REPORT</span></a><span class='Delimiter'>, </span><span class='String'>"  WAL block size\n"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="controldata.c.html#LN53"><span class='Ref_To_Local'>got_walseg</span></a><span class='Parentheses'>) 
</span>            <a href="../pg_rewind/logging.c.html#LN67"><span class='Ref_to_Func'>pg_log</span></a><span class='Parentheses'>(</span><a href="pg_upgrade.h.html#LN245"><span class='Ref_to_EnumConst'>PG_REPORT</span></a><span class='Delimiter'>, </span><span class='String'>"  WAL segment size\n"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="controldata.c.html#LN54"><span class='Ref_To_Local'>got_ident</span></a><span class='Parentheses'>) 
</span>            <a href="../pg_rewind/logging.c.html#LN67"><span class='Ref_to_Func'>pg_log</span></a><span class='Parentheses'>(</span><a href="pg_upgrade.h.html#LN245"><span class='Ref_to_EnumConst'>PG_REPORT</span></a><span class='Delimiter'>, </span><span class='String'>"  maximum identifier length\n"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="controldata.c.html#LN55"><span class='Ref_To_Local'>got_index</span></a><span class='Parentheses'>) 
</span>            <a href="../pg_rewind/logging.c.html#LN67"><span class='Ref_to_Func'>pg_log</span></a><span class='Parentheses'>(</span><a href="pg_upgrade.h.html#LN245"><span class='Ref_to_EnumConst'>PG_REPORT</span></a><span class='Delimiter'>, </span><span class='String'>"  maximum number of indexed columns\n"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="controldata.c.html#LN56"><span class='Ref_To_Local'>got_toast</span></a><span class='Parentheses'>) 
</span>            <a href="../pg_rewind/logging.c.html#LN67"><span class='Ref_to_Func'>pg_log</span></a><span class='Parentheses'>(</span><a href="pg_upgrade.h.html#LN245"><span class='Ref_to_EnumConst'>PG_REPORT</span></a><span class='Delimiter'>, </span><span class='String'>"  maximum TOAST chunk size\n"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="controldata.c.html#LN57"><span class='Ref_To_Local'>got_large_object</span></a> <span class='Operator'>&& 
</span>            <a href="controldata.c.html#LN33"><span class='Ref_to_Parameter'>cluster</span></a><span class='Operator'>-&GT;</span><a href="pg_upgrade.h.html#LN261"><span class='Ref_to_Member'>controldata</span></a><span class='Operator'>.</span><a href="pg_upgrade.h.html#LN206"><span class='Ref_to_Member'>ctrl_ver</span></a> <span class='Operator'>&GT;= </span><a href="pg_upgrade.h.html#LN125"><span class='Ref_to_Const'>LARGE_OBJECT_SIZE_PG_CONTROL_VER</span></a><span class='Parentheses'>) 
</span>            <a href="../pg_rewind/logging.c.html#LN67"><span class='Ref_to_Func'>pg_log</span></a><span class='Parentheses'>(</span><a href="pg_upgrade.h.html#LN245"><span class='Ref_to_EnumConst'>PG_REPORT</span></a><span class='Delimiter'>, </span><span class='String'>"  large-object chunk size\n"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="controldata.c.html#LN58"><span class='Ref_To_Local'>got_date_is_int</span></a><span class='Parentheses'>) 
</span>            <a href="../pg_rewind/logging.c.html#LN67"><span class='Ref_to_Func'>pg_log</span></a><span class='Parentheses'>(</span><a href="pg_upgrade.h.html#LN245"><span class='Ref_to_EnumConst'>PG_REPORT</span></a><span class='Delimiter'>, </span><span class='String'>"  dates/times are integers?\n"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* value added in Postgres 9.3 */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="controldata.c.html#LN59"><span class='Ref_To_Local'>got_data_checksum_version</span></a><span class='Parentheses'>) 
</span>            <a href="../pg_rewind/logging.c.html#LN67"><span class='Ref_to_Func'>pg_log</span></a><span class='Parentheses'>(</span><a href="pg_upgrade.h.html#LN245"><span class='Ref_to_EnumConst'>PG_REPORT</span></a><span class='Delimiter'>, </span><span class='String'>"  data checksum version\n"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <a href="../pg_rewind/logging.c.html#LN81"><span class='Ref_to_Func'>pg_fatal</span></a><span class='Parentheses'>(</span><span class='String'>"Cannot continue without required control information, terminating\n"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if !got_xid||!got_oid||!... &raquo; </span> 
<span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end get_control_data &raquo; </span> 
 
 
<span class='Comment_Multi_Line'>/* 
 * check_control_data() 
 * 
 * check to make sure the control data settings are compatible 
 */ 
</span><span class='Keyword'>void 
</span><a name="LN548"></a><span class='Declare_Function'>check_control_data</span><span class='Parentheses'>(</span><a href="pg_upgrade.h.html#LN204"><span class='Ref_to_Typedef'>ControlData</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>oldctrl</span><span class='Delimiter'>, 
</span><a name="LN549"></a>                   <a href="pg_upgrade.h.html#LN204"><span class='Ref_to_Typedef'>ControlData</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>newctrl</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="controldata.c.html#LN548"><span class='Ref_to_Parameter'>oldctrl</span></a><span class='Operator'>-&GT;</span><a href="pg_upgrade.h.html#LN215"><span class='Ref_to_Member'>align</span></a> <span class='Operator'>== </span><span class='Number'>0</span> <span class='Operator'>|| </span><a href="controldata.c.html#LN548"><span class='Ref_to_Parameter'>oldctrl</span></a><span class='Operator'>-&GT;</span><a href="pg_upgrade.h.html#LN215"><span class='Ref_to_Member'>align</span></a> <span class='Operator'>!= </span><a href="controldata.c.html#LN549"><span class='Ref_to_Parameter'>newctrl</span></a><span class='Operator'>-&GT;</span><a href="pg_upgrade.h.html#LN215"><span class='Ref_to_Member'>align</span></a><span class='Parentheses'>) 
</span>        <a href="../pg_rewind/logging.c.html#LN81"><span class='Ref_to_Func'>pg_fatal</span></a><span class='Parentheses'>(</span><span class='String'>"old and new pg_controldata alignments are invalid or do not match\n"</span> 
               <span class='String'>"Likely one cluster is a 32-bit install, the other 64-bit\n"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="controldata.c.html#LN548"><span class='Ref_to_Parameter'>oldctrl</span></a><span class='Operator'>-&GT;</span><a href="pg_upgrade.h.html#LN216"><span class='Ref_to_Member'>blocksz</span></a> <span class='Operator'>== </span><span class='Number'>0</span> <span class='Operator'>|| </span><a href="controldata.c.html#LN548"><span class='Ref_to_Parameter'>oldctrl</span></a><span class='Operator'>-&GT;</span><a href="pg_upgrade.h.html#LN216"><span class='Ref_to_Member'>blocksz</span></a> <span class='Operator'>!= </span><a href="controldata.c.html#LN549"><span class='Ref_to_Parameter'>newctrl</span></a><span class='Operator'>-&GT;</span><a href="pg_upgrade.h.html#LN216"><span class='Ref_to_Member'>blocksz</span></a><span class='Parentheses'>) 
</span>        <a href="../pg_rewind/logging.c.html#LN81"><span class='Ref_to_Func'>pg_fatal</span></a><span class='Parentheses'>(</span><span class='String'>"old and new pg_controldata block sizes are invalid or do not match\n"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="controldata.c.html#LN548"><span class='Ref_to_Parameter'>oldctrl</span></a><span class='Operator'>-&GT;</span><a href="pg_upgrade.h.html#LN217"><span class='Ref_to_Member'>largesz</span></a> <span class='Operator'>== </span><span class='Number'>0</span> <span class='Operator'>|| </span><a href="controldata.c.html#LN548"><span class='Ref_to_Parameter'>oldctrl</span></a><span class='Operator'>-&GT;</span><a href="pg_upgrade.h.html#LN217"><span class='Ref_to_Member'>largesz</span></a> <span class='Operator'>!= </span><a href="controldata.c.html#LN549"><span class='Ref_to_Parameter'>newctrl</span></a><span class='Operator'>-&GT;</span><a href="pg_upgrade.h.html#LN217"><span class='Ref_to_Member'>largesz</span></a><span class='Parentheses'>) 
</span>        <a href="../pg_rewind/logging.c.html#LN81"><span class='Ref_to_Func'>pg_fatal</span></a><span class='Parentheses'>(</span><span class='String'>"old and new pg_controldata maximum relation segment sizes are invalid or do not match\n"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="controldata.c.html#LN548"><span class='Ref_to_Parameter'>oldctrl</span></a><span class='Operator'>-&GT;</span><a href="pg_upgrade.h.html#LN218"><span class='Ref_to_Member'>walsz</span></a> <span class='Operator'>== </span><span class='Number'>0</span> <span class='Operator'>|| </span><a href="controldata.c.html#LN548"><span class='Ref_to_Parameter'>oldctrl</span></a><span class='Operator'>-&GT;</span><a href="pg_upgrade.h.html#LN218"><span class='Ref_to_Member'>walsz</span></a> <span class='Operator'>!= </span><a href="controldata.c.html#LN549"><span class='Ref_to_Parameter'>newctrl</span></a><span class='Operator'>-&GT;</span><a href="pg_upgrade.h.html#LN218"><span class='Ref_to_Member'>walsz</span></a><span class='Parentheses'>) 
</span>        <a href="../pg_rewind/logging.c.html#LN81"><span class='Ref_to_Func'>pg_fatal</span></a><span class='Parentheses'>(</span><span class='String'>"old and new pg_controldata WAL block sizes are invalid or do not match\n"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="controldata.c.html#LN548"><span class='Ref_to_Parameter'>oldctrl</span></a><span class='Operator'>-&GT;</span><a href="pg_upgrade.h.html#LN219"><span class='Ref_to_Member'>walseg</span></a> <span class='Operator'>== </span><span class='Number'>0</span> <span class='Operator'>|| </span><a href="controldata.c.html#LN548"><span class='Ref_to_Parameter'>oldctrl</span></a><span class='Operator'>-&GT;</span><a href="pg_upgrade.h.html#LN219"><span class='Ref_to_Member'>walseg</span></a> <span class='Operator'>!= </span><a href="controldata.c.html#LN549"><span class='Ref_to_Parameter'>newctrl</span></a><span class='Operator'>-&GT;</span><a href="pg_upgrade.h.html#LN219"><span class='Ref_to_Member'>walseg</span></a><span class='Parentheses'>) 
</span>        <a href="../pg_rewind/logging.c.html#LN81"><span class='Ref_to_Func'>pg_fatal</span></a><span class='Parentheses'>(</span><span class='String'>"old and new pg_controldata WAL segment sizes are invalid or do not match\n"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="controldata.c.html#LN548"><span class='Ref_to_Parameter'>oldctrl</span></a><span class='Operator'>-&GT;</span><a href="pg_upgrade.h.html#LN220"><span class='Ref_to_Member'>ident</span></a> <span class='Operator'>== </span><span class='Number'>0</span> <span class='Operator'>|| </span><a href="controldata.c.html#LN548"><span class='Ref_to_Parameter'>oldctrl</span></a><span class='Operator'>-&GT;</span><a href="pg_upgrade.h.html#LN220"><span class='Ref_to_Member'>ident</span></a> <span class='Operator'>!= </span><a href="controldata.c.html#LN549"><span class='Ref_to_Parameter'>newctrl</span></a><span class='Operator'>-&GT;</span><a href="pg_upgrade.h.html#LN220"><span class='Ref_to_Member'>ident</span></a><span class='Parentheses'>) 
</span>        <a href="../pg_rewind/logging.c.html#LN81"><span class='Ref_to_Func'>pg_fatal</span></a><span class='Parentheses'>(</span><span class='String'>"old and new pg_controldata maximum identifier lengths are invalid or do not match\n"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="controldata.c.html#LN548"><span class='Ref_to_Parameter'>oldctrl</span></a><span class='Operator'>-&GT;</span><a href="pg_upgrade.h.html#LN221"><span class='Ref_to_Member'>index</span></a> <span class='Operator'>== </span><span class='Number'>0</span> <span class='Operator'>|| </span><a href="controldata.c.html#LN548"><span class='Ref_to_Parameter'>oldctrl</span></a><span class='Operator'>-&GT;</span><a href="pg_upgrade.h.html#LN221"><span class='Ref_to_Member'>index</span></a> <span class='Operator'>!= </span><a href="controldata.c.html#LN549"><span class='Ref_to_Parameter'>newctrl</span></a><span class='Operator'>-&GT;</span><a href="pg_upgrade.h.html#LN221"><span class='Ref_to_Member'>index</span></a><span class='Parentheses'>) 
</span>        <a href="../pg_rewind/logging.c.html#LN81"><span class='Ref_to_Func'>pg_fatal</span></a><span class='Parentheses'>(</span><span class='String'>"old and new pg_controldata maximum indexed columns are invalid or do not match\n"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="controldata.c.html#LN548"><span class='Ref_to_Parameter'>oldctrl</span></a><span class='Operator'>-&GT;</span><a href="pg_upgrade.h.html#LN222"><span class='Ref_to_Member'>toast</span></a> <span class='Operator'>== </span><span class='Number'>0</span> <span class='Operator'>|| </span><a href="controldata.c.html#LN548"><span class='Ref_to_Parameter'>oldctrl</span></a><span class='Operator'>-&GT;</span><a href="pg_upgrade.h.html#LN222"><span class='Ref_to_Member'>toast</span></a> <span class='Operator'>!= </span><a href="controldata.c.html#LN549"><span class='Ref_to_Parameter'>newctrl</span></a><span class='Operator'>-&GT;</span><a href="pg_upgrade.h.html#LN222"><span class='Ref_to_Member'>toast</span></a><span class='Parentheses'>) 
</span>        <a href="../pg_rewind/logging.c.html#LN81"><span class='Ref_to_Func'>pg_fatal</span></a><span class='Parentheses'>(</span><span class='String'>"old and new pg_controldata maximum TOAST chunk sizes are invalid or do not match\n"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* large_object added in 9.5, so it might not exist in the old cluster */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="controldata.c.html#LN548"><span class='Ref_to_Parameter'>oldctrl</span></a><span class='Operator'>-&GT;</span><a href="pg_upgrade.h.html#LN223"><span class='Ref_to_Member'>large_object</span></a> <span class='Operator'>!= </span><span class='Number'>0</span> <span class='Operator'>&& 
</span>        <a href="controldata.c.html#LN548"><span class='Ref_to_Parameter'>oldctrl</span></a><span class='Operator'>-&GT;</span><a href="pg_upgrade.h.html#LN223"><span class='Ref_to_Member'>large_object</span></a> <span class='Operator'>!= </span><a href="controldata.c.html#LN549"><span class='Ref_to_Parameter'>newctrl</span></a><span class='Operator'>-&GT;</span><a href="pg_upgrade.h.html#LN223"><span class='Ref_to_Member'>large_object</span></a><span class='Parentheses'>) 
</span>        <a href="../pg_rewind/logging.c.html#LN81"><span class='Ref_to_Func'>pg_fatal</span></a><span class='Parentheses'>(</span><span class='String'>"old and new pg_controldata large-object chunk sizes are invalid or do not match\n"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="controldata.c.html#LN548"><span class='Ref_to_Parameter'>oldctrl</span></a><span class='Operator'>-&GT;</span><a href="pg_upgrade.h.html#LN224"><span class='Ref_to_Member'>date_is_int</span></a> <span class='Operator'>!= </span><a href="controldata.c.html#LN549"><span class='Ref_to_Parameter'>newctrl</span></a><span class='Operator'>-&GT;</span><a href="pg_upgrade.h.html#LN224"><span class='Ref_to_Member'>date_is_int</span></a><span class='Parentheses'>) 
</span>        <a href="../pg_rewind/logging.c.html#LN81"><span class='Ref_to_Func'>pg_fatal</span></a><span class='Parentheses'>(</span><span class='String'>"old and new pg_controldata date/time storage types do not match\n"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * float8_pass_by_value does not need to match, but is used in 
     * check_for_isn_and_int8_passing_mismatch(). 
     */ 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * We might eventually allow upgrades from checksum to no-checksum 
     * clusters. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="controldata.c.html#LN548"><span class='Ref_to_Parameter'>oldctrl</span></a><span class='Operator'>-&GT;</span><a href="pg_upgrade.h.html#LN226"><span class='Ref_to_Member'>data_checksum_version</span></a> <span class='Operator'>== </span><span class='Number'>0</span> <span class='Operator'>&& 
</span>        <a href="controldata.c.html#LN549"><span class='Ref_to_Parameter'>newctrl</span></a><span class='Operator'>-&GT;</span><a href="pg_upgrade.h.html#LN226"><span class='Ref_to_Member'>data_checksum_version</span></a> <span class='Operator'>!= </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>        <a href="../pg_rewind/logging.c.html#LN81"><span class='Ref_to_Func'>pg_fatal</span></a><span class='Parentheses'>(</span><span class='String'>"old cluster does not use data checksums but the new one does\n"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="controldata.c.html#LN548"><span class='Ref_to_Parameter'>oldctrl</span></a><span class='Operator'>-&GT;</span><a href="pg_upgrade.h.html#LN226"><span class='Ref_to_Member'>data_checksum_version</span></a> <span class='Operator'>!= </span><span class='Number'>0</span> <span class='Operator'>&& 
</span>             <a href="controldata.c.html#LN549"><span class='Ref_to_Parameter'>newctrl</span></a><span class='Operator'>-&GT;</span><a href="pg_upgrade.h.html#LN226"><span class='Ref_to_Member'>data_checksum_version</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>        <a href="../pg_rewind/logging.c.html#LN81"><span class='Ref_to_Func'>pg_fatal</span></a><span class='Parentheses'>(</span><span class='String'>"old cluster uses data checksums but the new one does not\n"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="controldata.c.html#LN548"><span class='Ref_to_Parameter'>oldctrl</span></a><span class='Operator'>-&GT;</span><a href="pg_upgrade.h.html#LN226"><span class='Ref_to_Member'>data_checksum_version</span></a> <span class='Operator'>!= </span><a href="controldata.c.html#LN549"><span class='Ref_to_Parameter'>newctrl</span></a><span class='Operator'>-&GT;</span><a href="pg_upgrade.h.html#LN226"><span class='Ref_to_Member'>data_checksum_version</span></a><span class='Parentheses'>) 
</span>        <a href="../pg_rewind/logging.c.html#LN81"><span class='Ref_to_Func'>pg_fatal</span></a><span class='Parentheses'>(</span><span class='String'>"old and new cluster pg_controldata checksum versions do not match\n"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end check_control_data &raquo; </span> 
 
 
<span class='Keyword'>void 
</span><a name="LN605"></a><span class='Declare_Function'>disable_old_cluster</span><span class='Parentheses'>(</span><span class='Keyword'>void</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN607"></a>    <span class='Keyword'>char</span>        <span class='Declare_Local'>old_path</span><span class='Delimiter'>[</span><a href="../../include/pg_config_manual.h.html#LN88"><span class='Ref_to_Const'>MAXPGPATH</span></a><span class='Delimiter'>], 
</span><a name="LN608"></a>                <span class='Declare_Local'>new_path</span><span class='Delimiter'>[</span><a href="../../include/pg_config_manual.h.html#LN88"><span class='Ref_to_Const'>MAXPGPATH</span></a><span class='Delimiter'>]; 
</span> 
    <span class='Comment_Multi_Line'>/* rename pg_control so old server cannot be accidentally started */ 
</span>    <a href="util.c.html#LN68"><span class='Ref_to_Func'>prep_status</span></a><span class='Parentheses'>(</span><span class='String'>"Adding \".old\" suffix to old global/pg_control"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="../../pl/plperl/plperl.h.html#LN60"><span class='Ref_to_Macro'>snprintf</span></a><span class='Parentheses'>(</span><a href="controldata.c.html#LN607"><span class='Ref_To_Local'>old_path</span></a><span class='Delimiter'>, </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="controldata.c.html#LN607"><span class='Ref_To_Local'>old_path</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><span class='String'>"%s/global/pg_control"</span><span class='Delimiter'>, </span><a href="pg_upgrade.c.html#LN55"><span class='Ref_to_Global_Var'>old_cluster</span></a><span class='Operator'>.</span><a href="pg_upgrade.h.html#LN263"><span class='Ref_to_Member'>pgdata</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../pl/plperl/plperl.h.html#LN60"><span class='Ref_to_Macro'>snprintf</span></a><span class='Parentheses'>(</span><a href="controldata.c.html#LN608"><span class='Ref_To_Local'>new_path</span></a><span class='Delimiter'>, </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="controldata.c.html#LN608"><span class='Ref_To_Local'>new_path</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><span class='String'>"%s/global/pg_control.old"</span><span class='Delimiter'>, </span><a href="pg_upgrade.c.html#LN55"><span class='Ref_to_Global_Var'>old_cluster</span></a><span class='Operator'>.</span><a href="pg_upgrade.h.html#LN263"><span class='Ref_to_Member'>pgdata</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="pg_upgrade.h.html#LN72"><span class='Ref_to_Const'>pg_mv_file</span></a><span class='Parentheses'>(</span><a href="controldata.c.html#LN607"><span class='Ref_To_Local'>old_path</span></a><span class='Delimiter'>, </span><a href="controldata.c.html#LN608"><span class='Ref_To_Local'>new_path</span></a><span class='Parentheses'>) </span><span class='Operator'>!= </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <a href="../pg_rewind/logging.c.html#LN81"><span class='Ref_to_Func'>pg_fatal</span></a><span class='Parentheses'>(</span><span class='String'>"Unable to rename %s to %s.\n"</span><span class='Delimiter'>, </span><a href="controldata.c.html#LN607"><span class='Ref_To_Local'>old_path</span></a><span class='Delimiter'>, </span><a href="controldata.c.html#LN608"><span class='Ref_To_Local'>new_path</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="util.c.html#LN170"><span class='Ref_to_Func'>check_ok</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span> 
    <a href="../pg_rewind/logging.c.html#LN67"><span class='Ref_to_Func'>pg_log</span></a><span class='Parentheses'>(</span><a href="pg_upgrade.h.html#LN245"><span class='Ref_to_EnumConst'>PG_REPORT</span></a><span class='Delimiter'>, </span><span class='String'>"\n"</span> 
           <span class='String'>"If you want to start the old cluster, you will need to remove\n"</span> 
           <span class='String'>"the \".old\" suffix from %s/global/pg_control.old.\n"</span> 
         <span class='String'>"Because \"link\" mode was used, the old cluster cannot be safely\n"</span> 
    <span class='String'>"started once the new cluster has been started.\n\n"</span><span class='Delimiter'>, </span><a href="pg_upgrade.c.html#LN55"><span class='Ref_to_Global_Var'>old_cluster</span></a><span class='Operator'>.</span><a href="pg_upgrade.h.html#LN263"><span class='Ref_to_Member'>pgdata</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end disable_old_cluster &raquo; </span> 
</pre>
<table bgcolor='#c0c0c0' width='100%'><tr><td><a href='../../../Contents.html'>Contents</a></td></tr>
</table><hr><p class='blurb' align='center'><a href='http://www.sourceinsight.com'>HTML Created by Source Insight Version 4.00.0084 Built on 2017-02-26</a></p>
</body></html>