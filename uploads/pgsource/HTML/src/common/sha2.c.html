<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta name="generator" content="Source Insight Version 4.00.0084 Built on 2017-02-26">
<meta charset='UTF-8' />
<style type='text/css'><!--
TD {background-color: #C0C0C0; font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 70%; }
.blurb {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 70%; }
.filename {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 120%; font-weight: bold; }
.dirname {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 100%; font-weight: bold; margin-top: 2.5em;}
--></style>
<title>src\common\sha2.c</title>
<LINK REL=StyleSheet HREF="../../C_Cpp_Source_File.css" TYPE='text/css' MEDIA=screen>
</head>
<body bgcolor=#ffffff>
<table bgcolor='#c0c0c0' width='100%'>
<tr><td><p class='filename'><b>src\common\sha2.c</b></p></td>
<td align='right'>
Wed Jun 14 08:26:02 2017
</td></tr>
<tr><td><a href='../../Contents.html'>Contents</a></td></tr>
</table>
<pre>
<span class='Comment_Multi_Line'>/*------------------------------------------------------------------------- 
 * 
 * sha2.c 
 *    Set of SHA functions for SHA-224, SHA-256, SHA-384 and SHA-512. 
 * 
 * This is the set of in-core functions used when there are no other 
 * alternative options like OpenSSL. 
 * 
 * Portions Copyright (c) 2016, PostgreSQL Global Development Group 
 * 
 * IDENTIFICATION 
 *    src/common/sha2.c 
 * 
 *------------------------------------------------------------------------- 
 */ 
</span> 
<span class='Comment_Multi_Line'>/*  $OpenBSD: sha2.c,v 1.6 2004/05/03 02:57:36 millert Exp $    */ 
/* 
 * FILE:    sha2.c 
 * AUTHOR:  Aaron D. Gifford &LT;me@aarongifford.com&GT; 
 * 
 * Copyright (c) 2000-2001, Aaron D. Gifford 
 * All rights reserved. 
 * 
 * Redistribution and use in source and binary forms, with or without 
 * modification, are permitted provided that the following conditions 
 * are met: 
 * 1. Redistributions of source code must retain the above copyright 
 *    notice, this list of conditions and the following disclaimer. 
 * 2. Redistributions in binary form must reproduce the above copyright 
 *    notice, this list of conditions and the following disclaimer in the 
 *    documentation and/or other materials provided with the distribution. 
 * 3. Neither the name of the copyright holder nor the names of contributors 
 *    may be used to endorse or promote products derived from this software 
 *    without specific prior written permission. 
 * 
 * THIS SOFTWARE IS PROVIDED BY THE AUTHOR AND CONTRIBUTOR(S) ``AS IS'' AND 
 * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE 
 * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE 
 * ARE DISCLAIMED.  IN NO EVENT SHALL THE AUTHOR OR CONTRIBUTOR(S) BE LIABLE 
 * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL 
 * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS 
 * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) 
 * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT 
 * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY 
 * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF 
 * SUCH DAMAGE. 
 * 
 * $From: sha2.c,v 1.1 2001/11/08 00:01:51 adg Exp adg $ 
 */ 
</span> 
 
<span class='Directive'>#ifndef</span> <a href="../bin/pg_waldump/rmgrdesc.c.html#LN7"><span class='Ref_to_Const'>FRONTEND</span></a> 
<span class='Keyword'>#include </span><span class='String'>"postgres.h"</span> 
<span class='Directive'>#else</span> 
<span class='Keyword'>#include </span><span class='String'>"postgres_fe.h"</span> 
<span class='Directive'>#endif</span> 
 
<span class='Keyword'>#include </span><span class='String'>&LT;sys/param.h&GT;</span> 
 
<span class='Keyword'>#include </span><span class='String'>"common/sha2.h"</span> 
 
<span class='Comment_Multi_Line'>/* 
 * UNROLLED TRANSFORM LOOP NOTE: 
 * You can define SHA2_UNROLL_TRANSFORM to use the unrolled transform 
 * loop version for the hash transform rounds (defined using macros 
 * later in this file).  Either define on the command line, for example: 
 * 
 *   cc -DSHA2_UNROLL_TRANSFORM -o sha2 sha2.c sha2prog.c 
 * 
 * or define below: 
 * 
 *   #define SHA2_UNROLL_TRANSFORM 
 * 
 */ 
</span> 
<span class='Comment_Multi_Line'>/*** SHA-256/384/512 Various Length Definitions ***********************/ 
</span><a name="LN77"></a><span class='Keyword'>#define </span><span class='Declare_Constant'>PG_SHA256_SHORT_BLOCK_LENGTH</span>    <span class='Parentheses'>(</span><a href="../include/common/sha2.h.html#LN60"><span class='Ref_to_Const'>PG_SHA256_BLOCK_LENGTH</span></a> <span class='Operator'>- </span><span class='Number'>8</span><span class='Parentheses'>) 
</span><a name="LN78"></a><span class='Keyword'>#define </span><span class='Declare_Constant'>PG_SHA384_SHORT_BLOCK_LENGTH</span>    <span class='Parentheses'>(</span><a href="../include/common/sha2.h.html#LN63"><span class='Ref_to_Const'>PG_SHA384_BLOCK_LENGTH</span></a> <span class='Operator'>- </span><span class='Number'>16</span><span class='Parentheses'>) 
</span><a name="LN79"></a><span class='Keyword'>#define </span><span class='Declare_Constant'>PG_SHA512_SHORT_BLOCK_LENGTH</span>    <span class='Parentheses'>(</span><a href="../include/common/sha2.h.html#LN66"><span class='Ref_to_Const'>PG_SHA512_BLOCK_LENGTH</span></a> <span class='Operator'>- </span><span class='Number'>16</span><span class='Parentheses'>) 
</span> 
<span class='Comment_Multi_Line'>/*** ENDIAN REVERSAL MACROS *******************************************/ 
</span><span class='Directive'>#ifndef</span> WORDS_BIGENDIAN 
<a name="LN83"></a><span class='Keyword'>#define </span><span class='Declare_Macro'>REVERSE32</span><span class='Parentheses'>(</span><span class='Declare_Parameter'>w</span><span class='Delimiter'>,</span><span class='Declare_Parameter'>x</span><span class='Parentheses'>)</span>  <span class='Delimiter'>{ </span><span class='Operator'>\ 
</span>    <a href="../include/c.h.html#LN267"><span class='Ref_to_Typedef'>uint32</span></a> tmp <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="sha2.c.html#LN83"><span class='Ref_to_Parameter'>w</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; </span><span class='Operator'>\ 
</span>    tmp <span class='Operator'>= </span><span class='Parentheses'>(</span>tmp <span class='Operator'>&GT;&GT; </span><span class='Number'>16</span><span class='Parentheses'>) </span><span class='Operator'>| </span><span class='Parentheses'>(</span>tmp <span class='Operator'>&LT;&LT; </span><span class='Number'>16</span><span class='Parentheses'>)</span><span class='Delimiter'>; </span><span class='Operator'>\ 
</span>    <span class='Parentheses'>(</span><a href="sha2.c.html#LN83"><span class='Ref_to_Parameter'>x</span></a><span class='Parentheses'>) </span><span class='Operator'>= </span><span class='Parentheses'>((</span>tmp <span class='Operator'>& </span><span class='Number'>0xff00ff00UL</span><span class='Parentheses'>) </span><span class='Operator'>&GT;&GT; </span><span class='Number'>8</span><span class='Parentheses'>)</span> <span class='Operator'>| </span><span class='Parentheses'>((</span>tmp <span class='Operator'>& </span><span class='Number'>0x00ff00ffUL</span><span class='Parentheses'>) </span><span class='Operator'>&LT;&LT; </span><span class='Number'>8</span><span class='Parentheses'>)</span><span class='Delimiter'>; </span><span class='Operator'>\ 
</span><span class='Delimiter'>} 
</span><a name="LN88"></a><span class='Keyword'>#define </span><span class='Declare_Macro'>REVERSE64</span><span class='Parentheses'>(</span><span class='Declare_Parameter'>w</span><span class='Delimiter'>,</span><span class='Declare_Parameter'>x</span><span class='Parentheses'>)</span>  <span class='Delimiter'>{ </span><span class='Operator'>\ 
</span>    <a href="../include/c.h.html#LN297"><span class='Ref_to_Typedef'>uint64</span></a> tmp <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="sha2.c.html#LN88"><span class='Ref_to_Parameter'>w</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; </span><span class='Operator'>\ 
</span>    tmp <span class='Operator'>= </span><span class='Parentheses'>(</span>tmp <span class='Operator'>&GT;&GT; </span><span class='Number'>32</span><span class='Parentheses'>) </span><span class='Operator'>| </span><span class='Parentheses'>(</span>tmp <span class='Operator'>&LT;&LT; </span><span class='Number'>32</span><span class='Parentheses'>)</span><span class='Delimiter'>; </span><span class='Operator'>\ 
</span>    tmp <span class='Operator'>= </span><span class='Parentheses'>((</span>tmp <span class='Operator'>& </span><span class='Number'>0xff00ff00ff00ff00ULL</span><span class='Parentheses'>) </span><span class='Operator'>&GT;&GT; </span><span class='Number'>8</span><span class='Parentheses'>)</span> <span class='Operator'>| \ 
</span>          <span class='Parentheses'>((</span>tmp <span class='Operator'>& </span><span class='Number'>0x00ff00ff00ff00ffULL</span><span class='Parentheses'>) </span><span class='Operator'>&LT;&LT; </span><span class='Number'>8</span><span class='Parentheses'>)</span><span class='Delimiter'>; </span><span class='Operator'>\ 
</span>    <span class='Parentheses'>(</span><a href="sha2.c.html#LN88"><span class='Ref_to_Parameter'>x</span></a><span class='Parentheses'>) </span><span class='Operator'>= </span><span class='Parentheses'>((</span>tmp <span class='Operator'>& </span><span class='Number'>0xffff0000ffff0000ULL</span><span class='Parentheses'>) </span><span class='Operator'>&GT;&GT; </span><span class='Number'>16</span><span class='Parentheses'>)</span> <span class='Operator'>| \ 
</span>          <span class='Parentheses'>((</span>tmp <span class='Operator'>& </span><span class='Number'>0x0000ffff0000ffffULL</span><span class='Parentheses'>) </span><span class='Operator'>&LT;&LT; </span><span class='Number'>16</span><span class='Parentheses'>)</span><span class='Delimiter'>; </span><span class='Operator'>\ 
</span><span class='Delimiter'>} 
</span><span class='Directive'>#endif</span>   <span class='Comment_Single_Line'>/* not bigendian */ 
</span> 
<span class='Comment_Multi_Line'>/* 
 * Macro for incrementally adding the unsigned 64-bit integer n to the 
 * unsigned 128-bit integer (represented using a two-element array of 
 * 64-bit words): 
 */ 
</span><a name="LN103"></a><span class='Keyword'>#define </span><span class='Declare_Macro'>ADDINC128</span><span class='Parentheses'>(</span><span class='Declare_Parameter'>w</span><span class='Delimiter'>,</span><span class='Declare_Parameter'>n</span><span class='Parentheses'>)</span>  <span class='Delimiter'>{ </span><span class='Operator'>\ 
</span>    <span class='Parentheses'>(</span><a href="sha2.c.html#LN103"><span class='Ref_to_Parameter'>w</span></a><span class='Parentheses'>)</span><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>] </span><span class='Operator'>+= </span><span class='Parentheses'>(</span><a href="../include/c.h.html#LN297"><span class='Ref_to_Typedef'>uint64</span></a><span class='Parentheses'>)(</span><a href="sha2.c.html#LN103"><span class='Ref_to_Parameter'>n</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; </span><span class='Operator'>\ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="sha2.c.html#LN103"><span class='Ref_to_Parameter'>w</span></a><span class='Parentheses'>)</span><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>] </span><span class='Operator'>&LT; </span><span class='Parentheses'>(</span><a href="sha2.c.html#LN103"><span class='Ref_to_Parameter'>n</span></a><span class='Parentheses'>))</span> <span class='Delimiter'>{ </span><span class='Operator'>\ 
</span>        <span class='Parentheses'>(</span><a href="sha2.c.html#LN103"><span class='Ref_to_Parameter'>w</span></a><span class='Parentheses'>)</span><span class='Delimiter'>[</span><span class='Number'>1</span><span class='Delimiter'>]</span><span class='Operator'>++</span><span class='Delimiter'>; </span><span class='Operator'>\ 
</span>    <span class='Delimiter'>} </span><span class='Operator'>\ 
</span><span class='Delimiter'>} 
</span> 
<span class='Comment_Multi_Line'>/*** THE SIX LOGICAL FUNCTIONS ****************************************/ 
/* 
 * Bit shifting and rotation (used by the six SHA-XYZ logical functions: 
 * 
 *   NOTE:  The naming of R and S appears backwards here (R is a SHIFT and 
 *   S is a ROTATION) because the SHA-256/384/512 description document 
 *   (see http://www.iwar.org.uk/comsec/resources/cipher/sha256-384-512.pdf) 
 *   uses this same "backwards" definition. 
 */ 
/* Shift-right (used in SHA-256, SHA-384, and SHA-512): */ 
</span><a name="LN120"></a><span class='Keyword'>#define </span><span class='Declare_Macro'>R</span><span class='Parentheses'>(</span><span class='Declare_Parameter'>b</span><span class='Delimiter'>,</span><span class='Declare_Parameter'>x</span><span class='Parentheses'>)</span>      <span class='Parentheses'>((</span><a href="sha2.c.html#LN120"><span class='Ref_to_Parameter'>x</span></a><span class='Parentheses'>) </span><span class='Operator'>&GT;&GT; </span><span class='Parentheses'>(</span><a href="sha2.c.html#LN120"><span class='Ref_to_Parameter'>b</span></a><span class='Parentheses'>))</span> 
<span class='Comment_Multi_Line'>/* 32-bit Rotate-right (used in SHA-256): */ 
</span><a name="LN122"></a><span class='Keyword'>#define </span><span class='Declare_Macro'>S32</span><span class='Parentheses'>(</span><span class='Declare_Parameter'>b</span><span class='Delimiter'>,</span><span class='Declare_Parameter'>x</span><span class='Parentheses'>)</span>    <span class='Parentheses'>(((</span><a href="sha2.c.html#LN122"><span class='Ref_to_Parameter'>x</span></a><span class='Parentheses'>)</span> <span class='Operator'>&GT;&GT; </span><span class='Parentheses'>(</span><a href="sha2.c.html#LN122"><span class='Ref_to_Parameter'>b</span></a><span class='Parentheses'>))</span> <span class='Operator'>| </span><span class='Parentheses'>((</span><a href="sha2.c.html#LN122"><span class='Ref_to_Parameter'>x</span></a><span class='Parentheses'>)</span> <span class='Operator'>&LT;&LT; </span><span class='Parentheses'>(</span><span class='Number'>32</span> <span class='Operator'>- </span><span class='Parentheses'>(</span><a href="sha2.c.html#LN122"><span class='Ref_to_Parameter'>b</span></a><span class='Parentheses'>))))</span> 
<span class='Comment_Multi_Line'>/* 64-bit Rotate-right (used in SHA-384 and SHA-512): */ 
</span><a name="LN124"></a><span class='Keyword'>#define </span><span class='Declare_Macro'>S64</span><span class='Parentheses'>(</span><span class='Declare_Parameter'>b</span><span class='Delimiter'>,</span><span class='Declare_Parameter'>x</span><span class='Parentheses'>)</span>    <span class='Parentheses'>(((</span><a href="sha2.c.html#LN124"><span class='Ref_to_Parameter'>x</span></a><span class='Parentheses'>)</span> <span class='Operator'>&GT;&GT; </span><span class='Parentheses'>(</span><a href="sha2.c.html#LN124"><span class='Ref_to_Parameter'>b</span></a><span class='Parentheses'>))</span> <span class='Operator'>| </span><span class='Parentheses'>((</span><a href="sha2.c.html#LN124"><span class='Ref_to_Parameter'>x</span></a><span class='Parentheses'>)</span> <span class='Operator'>&LT;&LT; </span><span class='Parentheses'>(</span><span class='Number'>64</span> <span class='Operator'>- </span><span class='Parentheses'>(</span><a href="sha2.c.html#LN124"><span class='Ref_to_Parameter'>b</span></a><span class='Parentheses'>))))</span> 
 
<span class='Comment_Multi_Line'>/* Two of six logical functions used in SHA-256, SHA-384, and SHA-512: */ 
</span><a name="LN127"></a><span class='Keyword'>#define </span><span class='Declare_Macro'>Ch</span><span class='Parentheses'>(</span><span class='Declare_Parameter'>x</span><span class='Delimiter'>,</span><span class='Declare_Parameter'>y</span><span class='Delimiter'>,</span><span class='Declare_Parameter'>z</span><span class='Parentheses'>)</span>   <span class='Parentheses'>(((</span><a href="sha2.c.html#LN127"><span class='Ref_to_Parameter'>x</span></a><span class='Parentheses'>)</span> <span class='Operator'>& </span><span class='Parentheses'>(</span><a href="sha2.c.html#LN127"><span class='Ref_to_Parameter'>y</span></a><span class='Parentheses'>))</span> <span class='Operator'>^ </span><span class='Parentheses'>((</span><span class='Operator'>~</span><span class='Parentheses'>(</span><a href="sha2.c.html#LN127"><span class='Ref_to_Parameter'>x</span></a><span class='Parentheses'>))</span> <span class='Operator'>& </span><span class='Parentheses'>(</span><a href="sha2.c.html#LN127"><span class='Ref_to_Parameter'>z</span></a><span class='Parentheses'>)))</span> 
<a name="LN128"></a><span class='Keyword'>#define </span><span class='Declare_Macro'>Maj</span><span class='Parentheses'>(</span><span class='Declare_Parameter'>x</span><span class='Delimiter'>,</span><span class='Declare_Parameter'>y</span><span class='Delimiter'>,</span><span class='Declare_Parameter'>z</span><span class='Parentheses'>)</span>  <span class='Parentheses'>(((</span><a href="sha2.c.html#LN128"><span class='Ref_to_Parameter'>x</span></a><span class='Parentheses'>) </span><span class='Operator'>& </span><span class='Parentheses'>(</span><a href="sha2.c.html#LN128"><span class='Ref_to_Parameter'>y</span></a><span class='Parentheses'>))</span> <span class='Operator'>^ </span><span class='Parentheses'>((</span><a href="sha2.c.html#LN128"><span class='Ref_to_Parameter'>x</span></a><span class='Parentheses'>) </span><span class='Operator'>& </span><span class='Parentheses'>(</span><a href="sha2.c.html#LN128"><span class='Ref_to_Parameter'>z</span></a><span class='Parentheses'>))</span> <span class='Operator'>^ </span><span class='Parentheses'>((</span><a href="sha2.c.html#LN128"><span class='Ref_to_Parameter'>y</span></a><span class='Parentheses'>) </span><span class='Operator'>& </span><span class='Parentheses'>(</span><a href="sha2.c.html#LN128"><span class='Ref_to_Parameter'>z</span></a><span class='Parentheses'>)))</span> 
 
<span class='Comment_Multi_Line'>/* Four of six logical functions used in SHA-256: */ 
</span><a name="LN131"></a><span class='Keyword'>#define </span><span class='Declare_Macro'>Sigma0_256</span><span class='Parentheses'>(</span><span class='Declare_Parameter'>x</span><span class='Parentheses'>)</span>   <span class='Parentheses'>(</span><a href="sha2.c.html#LN122"><span class='Ref_to_Macro'>S32</span></a><span class='Parentheses'>(</span><span class='Number'>2</span><span class='Delimiter'>,</span>  <span class='Parentheses'>(</span><a href="sha2.c.html#LN131"><span class='Ref_to_Parameter'>x</span></a><span class='Parentheses'>))</span> <span class='Operator'>^ </span><a href="sha2.c.html#LN122"><span class='Ref_to_Macro'>S32</span></a><span class='Parentheses'>(</span><span class='Number'>13</span><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="sha2.c.html#LN131"><span class='Ref_to_Parameter'>x</span></a><span class='Parentheses'>))</span> <span class='Operator'>^ </span><a href="sha2.c.html#LN122"><span class='Ref_to_Macro'>S32</span></a><span class='Parentheses'>(</span><span class='Number'>22</span><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="sha2.c.html#LN131"><span class='Ref_to_Parameter'>x</span></a><span class='Parentheses'>)))</span> 
<a name="LN132"></a><span class='Keyword'>#define </span><span class='Declare_Macro'>Sigma1_256</span><span class='Parentheses'>(</span><span class='Declare_Parameter'>x</span><span class='Parentheses'>)</span>   <span class='Parentheses'>(</span><a href="sha2.c.html#LN122"><span class='Ref_to_Macro'>S32</span></a><span class='Parentheses'>(</span><span class='Number'>6</span><span class='Delimiter'>,</span>  <span class='Parentheses'>(</span><a href="sha2.c.html#LN132"><span class='Ref_to_Parameter'>x</span></a><span class='Parentheses'>))</span> <span class='Operator'>^ </span><a href="sha2.c.html#LN122"><span class='Ref_to_Macro'>S32</span></a><span class='Parentheses'>(</span><span class='Number'>11</span><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="sha2.c.html#LN132"><span class='Ref_to_Parameter'>x</span></a><span class='Parentheses'>))</span> <span class='Operator'>^ </span><a href="sha2.c.html#LN122"><span class='Ref_to_Macro'>S32</span></a><span class='Parentheses'>(</span><span class='Number'>25</span><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="sha2.c.html#LN132"><span class='Ref_to_Parameter'>x</span></a><span class='Parentheses'>)))</span> 
<a name="LN133"></a><span class='Keyword'>#define </span><span class='Declare_Macro'>sigma0_256</span><span class='Parentheses'>(</span><span class='Declare_Parameter'>x</span><span class='Parentheses'>)</span>   <span class='Parentheses'>(</span><a href="sha2.c.html#LN122"><span class='Ref_to_Macro'>S32</span></a><span class='Parentheses'>(</span><span class='Number'>7</span><span class='Delimiter'>,</span>  <span class='Parentheses'>(</span><a href="sha2.c.html#LN133"><span class='Ref_to_Parameter'>x</span></a><span class='Parentheses'>))</span> <span class='Operator'>^ </span><a href="sha2.c.html#LN122"><span class='Ref_to_Macro'>S32</span></a><span class='Parentheses'>(</span><span class='Number'>18</span><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="sha2.c.html#LN133"><span class='Ref_to_Parameter'>x</span></a><span class='Parentheses'>))</span> <span class='Operator'>^ </span><a href="sha2.c.html#LN120"><span class='Ref_to_Macro'>R</span></a><span class='Parentheses'>(</span><span class='Number'>3</span> <span class='Delimiter'>,</span>   <span class='Parentheses'>(</span><a href="sha2.c.html#LN133"><span class='Ref_to_Parameter'>x</span></a><span class='Parentheses'>)))</span> 
<a name="LN134"></a><span class='Keyword'>#define </span><span class='Declare_Macro'>sigma1_256</span><span class='Parentheses'>(</span><span class='Declare_Parameter'>x</span><span class='Parentheses'>)</span>   <span class='Parentheses'>(</span><a href="sha2.c.html#LN122"><span class='Ref_to_Macro'>S32</span></a><span class='Parentheses'>(</span><span class='Number'>17</span><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="sha2.c.html#LN134"><span class='Ref_to_Parameter'>x</span></a><span class='Parentheses'>))</span> <span class='Operator'>^ </span><a href="sha2.c.html#LN122"><span class='Ref_to_Macro'>S32</span></a><span class='Parentheses'>(</span><span class='Number'>19</span><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="sha2.c.html#LN134"><span class='Ref_to_Parameter'>x</span></a><span class='Parentheses'>))</span> <span class='Operator'>^ </span><a href="sha2.c.html#LN120"><span class='Ref_to_Macro'>R</span></a><span class='Parentheses'>(</span><span class='Number'>10</span><span class='Delimiter'>,</span>   <span class='Parentheses'>(</span><a href="sha2.c.html#LN134"><span class='Ref_to_Parameter'>x</span></a><span class='Parentheses'>)))</span> 
 
<span class='Comment_Multi_Line'>/* Four of six logical functions used in SHA-384 and SHA-512: */ 
</span><a name="LN137"></a><span class='Keyword'>#define </span><span class='Declare_Macro'>Sigma0_512</span><span class='Parentheses'>(</span><span class='Declare_Parameter'>x</span><span class='Parentheses'>)</span>   <span class='Parentheses'>(</span><a href="sha2.c.html#LN124"><span class='Ref_to_Macro'>S64</span></a><span class='Parentheses'>(</span><span class='Number'>28</span><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="sha2.c.html#LN137"><span class='Ref_to_Parameter'>x</span></a><span class='Parentheses'>))</span> <span class='Operator'>^ </span><a href="sha2.c.html#LN124"><span class='Ref_to_Macro'>S64</span></a><span class='Parentheses'>(</span><span class='Number'>34</span><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="sha2.c.html#LN137"><span class='Ref_to_Parameter'>x</span></a><span class='Parentheses'>))</span> <span class='Operator'>^ </span><a href="sha2.c.html#LN124"><span class='Ref_to_Macro'>S64</span></a><span class='Parentheses'>(</span><span class='Number'>39</span><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="sha2.c.html#LN137"><span class='Ref_to_Parameter'>x</span></a><span class='Parentheses'>)))</span> 
<a name="LN138"></a><span class='Keyword'>#define </span><span class='Declare_Macro'>Sigma1_512</span><span class='Parentheses'>(</span><span class='Declare_Parameter'>x</span><span class='Parentheses'>)</span>   <span class='Parentheses'>(</span><a href="sha2.c.html#LN124"><span class='Ref_to_Macro'>S64</span></a><span class='Parentheses'>(</span><span class='Number'>14</span><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="sha2.c.html#LN138"><span class='Ref_to_Parameter'>x</span></a><span class='Parentheses'>))</span> <span class='Operator'>^ </span><a href="sha2.c.html#LN124"><span class='Ref_to_Macro'>S64</span></a><span class='Parentheses'>(</span><span class='Number'>18</span><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="sha2.c.html#LN138"><span class='Ref_to_Parameter'>x</span></a><span class='Parentheses'>))</span> <span class='Operator'>^ </span><a href="sha2.c.html#LN124"><span class='Ref_to_Macro'>S64</span></a><span class='Parentheses'>(</span><span class='Number'>41</span><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="sha2.c.html#LN138"><span class='Ref_to_Parameter'>x</span></a><span class='Parentheses'>)))</span> 
<a name="LN139"></a><span class='Keyword'>#define </span><span class='Declare_Macro'>sigma0_512</span><span class='Parentheses'>(</span><span class='Declare_Parameter'>x</span><span class='Parentheses'>)</span>   <span class='Parentheses'>(</span><a href="sha2.c.html#LN124"><span class='Ref_to_Macro'>S64</span></a><span class='Parentheses'>(</span> <span class='Number'>1</span><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="sha2.c.html#LN139"><span class='Ref_to_Parameter'>x</span></a><span class='Parentheses'>))</span> <span class='Operator'>^ </span><a href="sha2.c.html#LN124"><span class='Ref_to_Macro'>S64</span></a><span class='Parentheses'>(</span> <span class='Number'>8</span><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="sha2.c.html#LN139"><span class='Ref_to_Parameter'>x</span></a><span class='Parentheses'>))</span> <span class='Operator'>^ </span><a href="sha2.c.html#LN120"><span class='Ref_to_Macro'>R</span></a><span class='Parentheses'>(</span> <span class='Number'>7</span><span class='Delimiter'>,</span>   <span class='Parentheses'>(</span><a href="sha2.c.html#LN139"><span class='Ref_to_Parameter'>x</span></a><span class='Parentheses'>)))</span> 
<a name="LN140"></a><span class='Keyword'>#define </span><span class='Declare_Macro'>sigma1_512</span><span class='Parentheses'>(</span><span class='Declare_Parameter'>x</span><span class='Parentheses'>)</span>   <span class='Parentheses'>(</span><a href="sha2.c.html#LN124"><span class='Ref_to_Macro'>S64</span></a><span class='Parentheses'>(</span><span class='Number'>19</span><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="sha2.c.html#LN140"><span class='Ref_to_Parameter'>x</span></a><span class='Parentheses'>))</span> <span class='Operator'>^ </span><a href="sha2.c.html#LN124"><span class='Ref_to_Macro'>S64</span></a><span class='Parentheses'>(</span><span class='Number'>61</span><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="sha2.c.html#LN140"><span class='Ref_to_Parameter'>x</span></a><span class='Parentheses'>))</span> <span class='Operator'>^ </span><a href="sha2.c.html#LN120"><span class='Ref_to_Macro'>R</span></a><span class='Parentheses'>(</span> <span class='Number'>6</span><span class='Delimiter'>,</span>   <span class='Parentheses'>(</span><a href="sha2.c.html#LN140"><span class='Ref_to_Parameter'>x</span></a><span class='Parentheses'>)))</span> 
 
<span class='Comment_Multi_Line'>/*** INTERNAL FUNCTION PROTOTYPES *************************************/ 
/* NOTE: These should not be accessed directly from outside this 
 * library -- they are intended for private internal visibility/use 
 * only. 
 */ 
</span><a name="LN147"></a><span class='Keyword'>static void </span><span class='Declare_Prototype'>SHA512_Last</span><span class='Parentheses'>(</span><a href="../include/common/sha2.h.html#LN83"><span class='Ref_to_Struct'>pg_sha512_ctx</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>context</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN148"></a><span class='Keyword'>static void </span><span class='Declare_Prototype'>SHA256_Transform</span><span class='Parentheses'>(</span><a href="../include/common/sha2.h.html#LN77"><span class='Ref_to_Struct'>pg_sha256_ctx</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>context</span><span class='Delimiter'>, </span><span class='Keyword'>const </span><a href="../include/c.h.html#LN265"><span class='Ref_to_Typedef'>uint8</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>data</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN149"></a><span class='Keyword'>static void </span><span class='Declare_Prototype'>SHA512_Transform</span><span class='Parentheses'>(</span><a href="../include/common/sha2.h.html#LN83"><span class='Ref_to_Struct'>pg_sha512_ctx</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>context</span><span class='Delimiter'>, </span><span class='Keyword'>const </span><a href="../include/c.h.html#LN265"><span class='Ref_to_Typedef'>uint8</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>data</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
<span class='Comment_Multi_Line'>/*** SHA-XYZ INITIAL HASH VALUES AND CONSTANTS ************************/ 
/* Hash constant words K for SHA-256: */ 
</span><a name="LN153"></a><span class='Keyword'>static const </span><a href="../include/c.h.html#LN267"><span class='Ref_to_Typedef'>uint32</span></a> <span class='Declare_Var'>K256</span><span class='Delimiter'>[</span><span class='Number'>64</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Delimiter'>{ 
</span>    <span class='Number'>0x428a2f98UL</span><span class='Delimiter'>, </span><span class='Number'>0x71374491UL</span><span class='Delimiter'>, </span><span class='Number'>0xb5c0fbcfUL</span><span class='Delimiter'>, </span><span class='Number'>0xe9b5dba5UL</span><span class='Delimiter'>, 
</span>    <span class='Number'>0x3956c25bUL</span><span class='Delimiter'>, </span><span class='Number'>0x59f111f1UL</span><span class='Delimiter'>, </span><span class='Number'>0x923f82a4UL</span><span class='Delimiter'>, </span><span class='Number'>0xab1c5ed5UL</span><span class='Delimiter'>, 
</span>    <span class='Number'>0xd807aa98UL</span><span class='Delimiter'>, </span><span class='Number'>0x12835b01UL</span><span class='Delimiter'>, </span><span class='Number'>0x243185beUL</span><span class='Delimiter'>, </span><span class='Number'>0x550c7dc3UL</span><span class='Delimiter'>, 
</span>    <span class='Number'>0x72be5d74UL</span><span class='Delimiter'>, </span><span class='Number'>0x80deb1feUL</span><span class='Delimiter'>, </span><span class='Number'>0x9bdc06a7UL</span><span class='Delimiter'>, </span><span class='Number'>0xc19bf174UL</span><span class='Delimiter'>, 
</span>    <span class='Number'>0xe49b69c1UL</span><span class='Delimiter'>, </span><span class='Number'>0xefbe4786UL</span><span class='Delimiter'>, </span><span class='Number'>0x0fc19dc6UL</span><span class='Delimiter'>, </span><span class='Number'>0x240ca1ccUL</span><span class='Delimiter'>, 
</span>    <span class='Number'>0x2de92c6fUL</span><span class='Delimiter'>, </span><span class='Number'>0x4a7484aaUL</span><span class='Delimiter'>, </span><span class='Number'>0x5cb0a9dcUL</span><span class='Delimiter'>, </span><span class='Number'>0x76f988daUL</span><span class='Delimiter'>, 
</span>    <span class='Number'>0x983e5152UL</span><span class='Delimiter'>, </span><span class='Number'>0xa831c66dUL</span><span class='Delimiter'>, </span><span class='Number'>0xb00327c8UL</span><span class='Delimiter'>, </span><span class='Number'>0xbf597fc7UL</span><span class='Delimiter'>, 
</span>    <span class='Number'>0xc6e00bf3UL</span><span class='Delimiter'>, </span><span class='Number'>0xd5a79147UL</span><span class='Delimiter'>, </span><span class='Number'>0x06ca6351UL</span><span class='Delimiter'>, </span><span class='Number'>0x14292967UL</span><span class='Delimiter'>, 
</span>    <span class='Number'>0x27b70a85UL</span><span class='Delimiter'>, </span><span class='Number'>0x2e1b2138UL</span><span class='Delimiter'>, </span><span class='Number'>0x4d2c6dfcUL</span><span class='Delimiter'>, </span><span class='Number'>0x53380d13UL</span><span class='Delimiter'>, 
</span>    <span class='Number'>0x650a7354UL</span><span class='Delimiter'>, </span><span class='Number'>0x766a0abbUL</span><span class='Delimiter'>, </span><span class='Number'>0x81c2c92eUL</span><span class='Delimiter'>, </span><span class='Number'>0x92722c85UL</span><span class='Delimiter'>, 
</span>    <span class='Number'>0xa2bfe8a1UL</span><span class='Delimiter'>, </span><span class='Number'>0xa81a664bUL</span><span class='Delimiter'>, </span><span class='Number'>0xc24b8b70UL</span><span class='Delimiter'>, </span><span class='Number'>0xc76c51a3UL</span><span class='Delimiter'>, 
</span>    <span class='Number'>0xd192e819UL</span><span class='Delimiter'>, </span><span class='Number'>0xd6990624UL</span><span class='Delimiter'>, </span><span class='Number'>0xf40e3585UL</span><span class='Delimiter'>, </span><span class='Number'>0x106aa070UL</span><span class='Delimiter'>, 
</span>    <span class='Number'>0x19a4c116UL</span><span class='Delimiter'>, </span><span class='Number'>0x1e376c08UL</span><span class='Delimiter'>, </span><span class='Number'>0x2748774cUL</span><span class='Delimiter'>, </span><span class='Number'>0x34b0bcb5UL</span><span class='Delimiter'>, 
</span>    <span class='Number'>0x391c0cb3UL</span><span class='Delimiter'>, </span><span class='Number'>0x4ed8aa4aUL</span><span class='Delimiter'>, </span><span class='Number'>0x5b9cca4fUL</span><span class='Delimiter'>, </span><span class='Number'>0x682e6ff3UL</span><span class='Delimiter'>, 
</span>    <span class='Number'>0x748f82eeUL</span><span class='Delimiter'>, </span><span class='Number'>0x78a5636fUL</span><span class='Delimiter'>, </span><span class='Number'>0x84c87814UL</span><span class='Delimiter'>, </span><span class='Number'>0x8cc70208UL</span><span class='Delimiter'>, 
</span>    <span class='Number'>0x90befffaUL</span><span class='Delimiter'>, </span><span class='Number'>0xa4506cebUL</span><span class='Delimiter'>, </span><span class='Number'>0xbef9a3f7UL</span><span class='Delimiter'>, </span><span class='Number'>0xc67178f2UL</span> 
<span class='Delimiter'>}; 
</span> 
<span class='Comment_Multi_Line'>/* Initial hash value H for SHA-224: */ 
</span><a name="LN173"></a><span class='Keyword'>static const </span><a href="../include/c.h.html#LN267"><span class='Ref_to_Typedef'>uint32</span></a> <span class='Declare_Var'>sha224_initial_hash_value</span><span class='Delimiter'>[</span><span class='Number'>8</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Delimiter'>{ 
</span>    <span class='Number'>0xc1059ed8UL</span><span class='Delimiter'>, 
</span>    <span class='Number'>0x367cd507UL</span><span class='Delimiter'>, 
</span>    <span class='Number'>0x3070dd17UL</span><span class='Delimiter'>, 
</span>    <span class='Number'>0xf70e5939UL</span><span class='Delimiter'>, 
</span>    <span class='Number'>0xffc00b31UL</span><span class='Delimiter'>, 
</span>    <span class='Number'>0x68581511UL</span><span class='Delimiter'>, 
</span>    <span class='Number'>0x64f98fa7UL</span><span class='Delimiter'>, 
</span>    <span class='Number'>0xbefa4fa4UL</span> 
<span class='Delimiter'>}; 
</span> 
<span class='Comment_Multi_Line'>/* Initial hash value H for SHA-256: */ 
</span><a name="LN185"></a><span class='Keyword'>static const </span><a href="../include/c.h.html#LN267"><span class='Ref_to_Typedef'>uint32</span></a> <span class='Declare_Var'>sha256_initial_hash_value</span><span class='Delimiter'>[</span><span class='Number'>8</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Delimiter'>{ 
</span>    <span class='Number'>0x6a09e667UL</span><span class='Delimiter'>, 
</span>    <span class='Number'>0xbb67ae85UL</span><span class='Delimiter'>, 
</span>    <span class='Number'>0x3c6ef372UL</span><span class='Delimiter'>, 
</span>    <span class='Number'>0xa54ff53aUL</span><span class='Delimiter'>, 
</span>    <span class='Number'>0x510e527fUL</span><span class='Delimiter'>, 
</span>    <span class='Number'>0x9b05688cUL</span><span class='Delimiter'>, 
</span>    <span class='Number'>0x1f83d9abUL</span><span class='Delimiter'>, 
</span>    <span class='Number'>0x5be0cd19UL</span> 
<span class='Delimiter'>}; 
</span> 
<span class='Comment_Multi_Line'>/* Hash constant words K for SHA-384 and SHA-512: */ 
</span><a name="LN197"></a><span class='Keyword'>static const </span><a href="../include/c.h.html#LN297"><span class='Ref_to_Typedef'>uint64</span></a> <span class='Declare_Var'>K512</span><span class='Delimiter'>[</span><span class='Number'>80</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Delimiter'>{ 
</span>    <span class='Number'>0x428a2f98d728ae22ULL</span><span class='Delimiter'>, </span><span class='Number'>0x7137449123ef65cdULL</span><span class='Delimiter'>, 
</span>    <span class='Number'>0xb5c0fbcfec4d3b2fULL</span><span class='Delimiter'>, </span><span class='Number'>0xe9b5dba58189dbbcULL</span><span class='Delimiter'>, 
</span>    <span class='Number'>0x3956c25bf348b538ULL</span><span class='Delimiter'>, </span><span class='Number'>0x59f111f1b605d019ULL</span><span class='Delimiter'>, 
</span>    <span class='Number'>0x923f82a4af194f9bULL</span><span class='Delimiter'>, </span><span class='Number'>0xab1c5ed5da6d8118ULL</span><span class='Delimiter'>, 
</span>    <span class='Number'>0xd807aa98a3030242ULL</span><span class='Delimiter'>, </span><span class='Number'>0x12835b0145706fbeULL</span><span class='Delimiter'>, 
</span>    <span class='Number'>0x243185be4ee4b28cULL</span><span class='Delimiter'>, </span><span class='Number'>0x550c7dc3d5ffb4e2ULL</span><span class='Delimiter'>, 
</span>    <span class='Number'>0x72be5d74f27b896fULL</span><span class='Delimiter'>, </span><span class='Number'>0x80deb1fe3b1696b1ULL</span><span class='Delimiter'>, 
</span>    <span class='Number'>0x9bdc06a725c71235ULL</span><span class='Delimiter'>, </span><span class='Number'>0xc19bf174cf692694ULL</span><span class='Delimiter'>, 
</span>    <span class='Number'>0xe49b69c19ef14ad2ULL</span><span class='Delimiter'>, </span><span class='Number'>0xefbe4786384f25e3ULL</span><span class='Delimiter'>, 
</span>    <span class='Number'>0x0fc19dc68b8cd5b5ULL</span><span class='Delimiter'>, </span><span class='Number'>0x240ca1cc77ac9c65ULL</span><span class='Delimiter'>, 
</span>    <span class='Number'>0x2de92c6f592b0275ULL</span><span class='Delimiter'>, </span><span class='Number'>0x4a7484aa6ea6e483ULL</span><span class='Delimiter'>, 
</span>    <span class='Number'>0x5cb0a9dcbd41fbd4ULL</span><span class='Delimiter'>, </span><span class='Number'>0x76f988da831153b5ULL</span><span class='Delimiter'>, 
</span>    <span class='Number'>0x983e5152ee66dfabULL</span><span class='Delimiter'>, </span><span class='Number'>0xa831c66d2db43210ULL</span><span class='Delimiter'>, 
</span>    <span class='Number'>0xb00327c898fb213fULL</span><span class='Delimiter'>, </span><span class='Number'>0xbf597fc7beef0ee4ULL</span><span class='Delimiter'>, 
</span>    <span class='Number'>0xc6e00bf33da88fc2ULL</span><span class='Delimiter'>, </span><span class='Number'>0xd5a79147930aa725ULL</span><span class='Delimiter'>, 
</span>    <span class='Number'>0x06ca6351e003826fULL</span><span class='Delimiter'>, </span><span class='Number'>0x142929670a0e6e70ULL</span><span class='Delimiter'>, 
</span>    <span class='Number'>0x27b70a8546d22ffcULL</span><span class='Delimiter'>, </span><span class='Number'>0x2e1b21385c26c926ULL</span><span class='Delimiter'>, 
</span>    <span class='Number'>0x4d2c6dfc5ac42aedULL</span><span class='Delimiter'>, </span><span class='Number'>0x53380d139d95b3dfULL</span><span class='Delimiter'>, 
</span>    <span class='Number'>0x650a73548baf63deULL</span><span class='Delimiter'>, </span><span class='Number'>0x766a0abb3c77b2a8ULL</span><span class='Delimiter'>, 
</span>    <span class='Number'>0x81c2c92e47edaee6ULL</span><span class='Delimiter'>, </span><span class='Number'>0x92722c851482353bULL</span><span class='Delimiter'>, 
</span>    <span class='Number'>0xa2bfe8a14cf10364ULL</span><span class='Delimiter'>, </span><span class='Number'>0xa81a664bbc423001ULL</span><span class='Delimiter'>, 
</span>    <span class='Number'>0xc24b8b70d0f89791ULL</span><span class='Delimiter'>, </span><span class='Number'>0xc76c51a30654be30ULL</span><span class='Delimiter'>, 
</span>    <span class='Number'>0xd192e819d6ef5218ULL</span><span class='Delimiter'>, </span><span class='Number'>0xd69906245565a910ULL</span><span class='Delimiter'>, 
</span>    <span class='Number'>0xf40e35855771202aULL</span><span class='Delimiter'>, </span><span class='Number'>0x106aa07032bbd1b8ULL</span><span class='Delimiter'>, 
</span>    <span class='Number'>0x19a4c116b8d2d0c8ULL</span><span class='Delimiter'>, </span><span class='Number'>0x1e376c085141ab53ULL</span><span class='Delimiter'>, 
</span>    <span class='Number'>0x2748774cdf8eeb99ULL</span><span class='Delimiter'>, </span><span class='Number'>0x34b0bcb5e19b48a8ULL</span><span class='Delimiter'>, 
</span>    <span class='Number'>0x391c0cb3c5c95a63ULL</span><span class='Delimiter'>, </span><span class='Number'>0x4ed8aa4ae3418acbULL</span><span class='Delimiter'>, 
</span>    <span class='Number'>0x5b9cca4f7763e373ULL</span><span class='Delimiter'>, </span><span class='Number'>0x682e6ff3d6b2b8a3ULL</span><span class='Delimiter'>, 
</span>    <span class='Number'>0x748f82ee5defb2fcULL</span><span class='Delimiter'>, </span><span class='Number'>0x78a5636f43172f60ULL</span><span class='Delimiter'>, 
</span>    <span class='Number'>0x84c87814a1f0ab72ULL</span><span class='Delimiter'>, </span><span class='Number'>0x8cc702081a6439ecULL</span><span class='Delimiter'>, 
</span>    <span class='Number'>0x90befffa23631e28ULL</span><span class='Delimiter'>, </span><span class='Number'>0xa4506cebde82bde9ULL</span><span class='Delimiter'>, 
</span>    <span class='Number'>0xbef9a3f7b2c67915ULL</span><span class='Delimiter'>, </span><span class='Number'>0xc67178f2e372532bULL</span><span class='Delimiter'>, 
</span>    <span class='Number'>0xca273eceea26619cULL</span><span class='Delimiter'>, </span><span class='Number'>0xd186b8c721c0c207ULL</span><span class='Delimiter'>, 
</span>    <span class='Number'>0xeada7dd6cde0eb1eULL</span><span class='Delimiter'>, </span><span class='Number'>0xf57d4f7fee6ed178ULL</span><span class='Delimiter'>, 
</span>    <span class='Number'>0x06f067aa72176fbaULL</span><span class='Delimiter'>, </span><span class='Number'>0x0a637dc5a2c898a6ULL</span><span class='Delimiter'>, 
</span>    <span class='Number'>0x113f9804bef90daeULL</span><span class='Delimiter'>, </span><span class='Number'>0x1b710b35131c471bULL</span><span class='Delimiter'>, 
</span>    <span class='Number'>0x28db77f523047d84ULL</span><span class='Delimiter'>, </span><span class='Number'>0x32caab7b40c72493ULL</span><span class='Delimiter'>, 
</span>    <span class='Number'>0x3c9ebe0a15c9bebcULL</span><span class='Delimiter'>, </span><span class='Number'>0x431d67c49c100d4cULL</span><span class='Delimiter'>, 
</span>    <span class='Number'>0x4cc5d4becb3e42b6ULL</span><span class='Delimiter'>, </span><span class='Number'>0x597f299cfc657e2aULL</span><span class='Delimiter'>, 
</span>    <span class='Number'>0x5fcb6fab3ad6faecULL</span><span class='Delimiter'>, </span><span class='Number'>0x6c44198c4a475817ULL</span> 
<span class='Delimiter'>}; 
</span> 
<span class='Comment_Multi_Line'>/* Initial hash value H for SHA-384 */ 
</span><a name="LN241"></a><span class='Keyword'>static const </span><a href="../include/c.h.html#LN297"><span class='Ref_to_Typedef'>uint64</span></a> <span class='Declare_Var'>sha384_initial_hash_value</span><span class='Delimiter'>[</span><span class='Number'>8</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Delimiter'>{ 
</span>    <span class='Number'>0xcbbb9d5dc1059ed8ULL</span><span class='Delimiter'>, 
</span>    <span class='Number'>0x629a292a367cd507ULL</span><span class='Delimiter'>, 
</span>    <span class='Number'>0x9159015a3070dd17ULL</span><span class='Delimiter'>, 
</span>    <span class='Number'>0x152fecd8f70e5939ULL</span><span class='Delimiter'>, 
</span>    <span class='Number'>0x67332667ffc00b31ULL</span><span class='Delimiter'>, 
</span>    <span class='Number'>0x8eb44a8768581511ULL</span><span class='Delimiter'>, 
</span>    <span class='Number'>0xdb0c2e0d64f98fa7ULL</span><span class='Delimiter'>, 
</span>    <span class='Number'>0x47b5481dbefa4fa4ULL</span> 
<span class='Delimiter'>}; 
</span> 
<span class='Comment_Multi_Line'>/* Initial hash value H for SHA-512 */ 
</span><a name="LN253"></a><span class='Keyword'>static const </span><a href="../include/c.h.html#LN297"><span class='Ref_to_Typedef'>uint64</span></a> <span class='Declare_Var'>sha512_initial_hash_value</span><span class='Delimiter'>[</span><span class='Number'>8</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Delimiter'>{ 
</span>    <span class='Number'>0x6a09e667f3bcc908ULL</span><span class='Delimiter'>, 
</span>    <span class='Number'>0xbb67ae8584caa73bULL</span><span class='Delimiter'>, 
</span>    <span class='Number'>0x3c6ef372fe94f82bULL</span><span class='Delimiter'>, 
</span>    <span class='Number'>0xa54ff53a5f1d36f1ULL</span><span class='Delimiter'>, 
</span>    <span class='Number'>0x510e527fade682d1ULL</span><span class='Delimiter'>, 
</span>    <span class='Number'>0x9b05688c2b3e6c1fULL</span><span class='Delimiter'>, 
</span>    <span class='Number'>0x1f83d9abfb41bd6bULL</span><span class='Delimiter'>, 
</span>    <span class='Number'>0x5be0cd19137e2179ULL</span> 
<span class='Delimiter'>}; 
</span> 
 
<span class='Comment_Multi_Line'>/*** SHA-256: *********************************************************/ 
</span><span class='Keyword'>void 
</span><a name="LN267"></a><span class='Declare_Function'>pg_sha256_init</span><span class='Parentheses'>(</span><a href="../include/common/sha2.h.html#LN77"><span class='Ref_to_Struct'>pg_sha256_ctx</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>context</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="sha2.c.html#LN267"><span class='Ref_to_Parameter'>context</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>        <span class='Control'>return</span><span class='Delimiter'>; 
</span>    memcpy<span class='Parentheses'>(</span><a href="sha2.c.html#LN267"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN79"><span class='Ref_to_Member'>state</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN185"><span class='Ref_to_Global_Var'>sha256_initial_hash_value</span></a><span class='Delimiter'>, </span><a href="../include/common/sha2.h.html#LN61"><span class='Ref_to_Const'>PG_SHA256_DIGEST_LENGTH</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    memset<span class='Parentheses'>(</span><a href="sha2.c.html#LN267"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN81"><span class='Ref_to_Member'>buffer</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Delimiter'>, </span><a href="../include/common/sha2.h.html#LN60"><span class='Ref_to_Const'>PG_SHA256_BLOCK_LENGTH</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="sha2.c.html#LN267"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN80"><span class='Ref_to_Member'>bitcount</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
} 
</span> 
<span class='Directive'>#ifdef</span> SHA2_UNROLL_TRANSFORM 
 
<span class='Comment_Multi_Line'>/* Unrolled SHA-256 round macros: */ 
</span> 
<a name="LN280"></a><span class='Keyword'>#define </span><span class='Declare_Macro'>ROUND256_0_TO_15</span><span class='Parentheses'>(</span><span class='Declare_Parameter'>a</span><span class='Delimiter'>,</span><span class='Declare_Parameter'>b</span><span class='Delimiter'>,</span><span class='Declare_Parameter'>c</span><span class='Delimiter'>,</span><span class='Declare_Parameter'>d</span><span class='Delimiter'>,</span><span class='Declare_Parameter'>e</span><span class='Delimiter'>,</span><span class='Declare_Parameter'>f</span><span class='Delimiter'>,</span><span class='Declare_Parameter'>g</span><span class='Delimiter'>,</span><span class='Declare_Parameter'>h</span><span class='Parentheses'>) </span><span class='Control'>do</span> <span class='Delimiter'>{</span>                  <span class='Operator'>\ 
</span>    W256<span class='Delimiter'>[</span>j<span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../include/c.h.html#LN267"><span class='Ref_to_Typedef'>uint32</span></a><span class='Parentheses'>)</span>data<span class='Delimiter'>[</span><span class='Number'>3</span><span class='Delimiter'>] </span><span class='Operator'>| </span><span class='Parentheses'>((</span><a href="../include/c.h.html#LN267"><span class='Ref_to_Typedef'>uint32</span></a><span class='Parentheses'>)</span>data<span class='Delimiter'>[</span><span class='Number'>2</span><span class='Delimiter'>] </span><span class='Operator'>&LT;&LT; </span><span class='Number'>8</span><span class='Parentheses'>)</span> <span class='Operator'>|</span>        <span class='Operator'>\ 
</span>        <span class='Parentheses'>((</span><a href="../include/c.h.html#LN267"><span class='Ref_to_Typedef'>uint32</span></a><span class='Parentheses'>)</span>data<span class='Delimiter'>[</span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>&LT;&LT; </span><span class='Number'>16</span><span class='Parentheses'>)</span> <span class='Operator'>| </span><span class='Parentheses'>((</span><a href="../include/c.h.html#LN267"><span class='Ref_to_Typedef'>uint32</span></a><span class='Parentheses'>)</span>data<span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>] </span><span class='Operator'>&LT;&LT; </span><span class='Number'>24</span><span class='Parentheses'>)</span><span class='Delimiter'>;</span>      <span class='Operator'>\ 
</span>    data <span class='Operator'>+= </span><span class='Number'>4</span><span class='Delimiter'>;</span>                              <span class='Operator'>\ 
</span>    T1 <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="sha2.c.html#LN280"><span class='Ref_to_Parameter'>h</span></a><span class='Parentheses'>) </span><span class='Operator'>+ </span><a href="sha2.c.html#LN132"><span class='Ref_to_Macro'>Sigma1_256</span></a><span class='Parentheses'>((</span><a href="sha2.c.html#LN280"><span class='Ref_to_Parameter'>e</span></a><span class='Parentheses'>))</span> <span class='Operator'>+ </span><a href="sha2.c.html#LN127"><span class='Ref_to_Macro'>Ch</span></a><span class='Parentheses'>((</span><a href="sha2.c.html#LN280"><span class='Ref_to_Parameter'>e</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="sha2.c.html#LN280"><span class='Ref_to_Parameter'>f</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="sha2.c.html#LN280"><span class='Ref_to_Parameter'>g</span></a><span class='Parentheses'>))</span> <span class='Operator'>+ </span><a href="sha2.c.html#LN153"><span class='Ref_to_Global_Var'>K256</span></a><span class='Delimiter'>[</span>j<span class='Delimiter'>] </span><span class='Operator'>+ </span>W256<span class='Delimiter'>[</span>j<span class='Delimiter'>]; </span><span class='Operator'>\ 
</span>    <span class='Parentheses'>(</span><a href="sha2.c.html#LN280"><span class='Ref_to_Parameter'>d</span></a><span class='Parentheses'>) </span><span class='Operator'>+= </span>T1<span class='Delimiter'>;</span>                              <span class='Operator'>\ 
</span>    <span class='Parentheses'>(</span><a href="sha2.c.html#LN280"><span class='Ref_to_Parameter'>h</span></a><span class='Parentheses'>) </span><span class='Operator'>= </span>T1 <span class='Operator'>+ </span><a href="sha2.c.html#LN131"><span class='Ref_to_Macro'>Sigma0_256</span></a><span class='Parentheses'>((</span><a href="sha2.c.html#LN280"><span class='Ref_to_Parameter'>a</span></a><span class='Parentheses'>))</span> <span class='Operator'>+ </span><a href="sha2.c.html#LN128"><span class='Ref_to_Macro'>Maj</span></a><span class='Parentheses'>((</span><a href="sha2.c.html#LN280"><span class='Ref_to_Parameter'>a</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="sha2.c.html#LN280"><span class='Ref_to_Parameter'>b</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="sha2.c.html#LN280"><span class='Ref_to_Parameter'>c</span></a><span class='Parentheses'>))</span><span class='Delimiter'>;</span>            <span class='Operator'>\ 
</span>    j<span class='Operator'>++</span><span class='Delimiter'>;</span>                                    <span class='Operator'>\ 
</span><span class='Delimiter'>} </span><span class='Control'>while</span><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>) 
</span> 
<a name="LN290"></a><span class='Keyword'>#define </span><span class='Declare_Macro'>ROUND256</span><span class='Parentheses'>(</span><span class='Declare_Parameter'>a</span><span class='Delimiter'>,</span><span class='Declare_Parameter'>b</span><span class='Delimiter'>,</span><span class='Declare_Parameter'>c</span><span class='Delimiter'>,</span><span class='Declare_Parameter'>d</span><span class='Delimiter'>,</span><span class='Declare_Parameter'>e</span><span class='Delimiter'>,</span><span class='Declare_Parameter'>f</span><span class='Delimiter'>,</span><span class='Declare_Parameter'>g</span><span class='Delimiter'>,</span><span class='Declare_Parameter'>h</span><span class='Parentheses'>) </span><span class='Control'>do</span> <span class='Delimiter'>{</span>                      <span class='Operator'>\ 
</span>    s0 <span class='Operator'>= </span>W256<span class='Delimiter'>[</span><span class='Parentheses'>(</span>j<span class='Operator'>+</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Operator'>&</span><span class='Number'>0x0f</span><span class='Delimiter'>];</span>                          <span class='Operator'>\ 
</span>    s0 <span class='Operator'>= </span><a href="sha2.c.html#LN133"><span class='Ref_to_Macro'>sigma0_256</span></a><span class='Parentheses'>(</span>s0<span class='Parentheses'>)</span><span class='Delimiter'>;</span>                            <span class='Operator'>\ 
</span>    <a href="../interfaces/ecpg/test/preproc/strings.h.html#LN0"><span class='Ref_to_Global_Var'>s1</span></a> <span class='Operator'>= </span>W256<span class='Delimiter'>[</span><span class='Parentheses'>(</span>j<span class='Operator'>+</span><span class='Number'>14</span><span class='Parentheses'>)</span><span class='Operator'>&</span><span class='Number'>0x0f</span><span class='Delimiter'>];</span>                         <span class='Operator'>\ 
</span>    <a href="../interfaces/ecpg/test/preproc/strings.h.html#LN0"><span class='Ref_to_Global_Var'>s1</span></a> <span class='Operator'>= </span><a href="sha2.c.html#LN134"><span class='Ref_to_Macro'>sigma1_256</span></a><span class='Parentheses'>(</span><a href="../interfaces/ecpg/test/preproc/strings.h.html#LN0"><span class='Ref_to_Global_Var'>s1</span></a><span class='Parentheses'>)</span><span class='Delimiter'>;</span>                            <span class='Operator'>\ 
</span>    T1 <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="sha2.c.html#LN290"><span class='Ref_to_Parameter'>h</span></a><span class='Parentheses'>) </span><span class='Operator'>+ </span><a href="sha2.c.html#LN132"><span class='Ref_to_Macro'>Sigma1_256</span></a><span class='Parentheses'>((</span><a href="sha2.c.html#LN290"><span class='Ref_to_Parameter'>e</span></a><span class='Parentheses'>))</span> <span class='Operator'>+ </span><a href="sha2.c.html#LN127"><span class='Ref_to_Macro'>Ch</span></a><span class='Parentheses'>((</span><a href="sha2.c.html#LN290"><span class='Ref_to_Parameter'>e</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="sha2.c.html#LN290"><span class='Ref_to_Parameter'>f</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="sha2.c.html#LN290"><span class='Ref_to_Parameter'>g</span></a><span class='Parentheses'>))</span> <span class='Operator'>+ </span><a href="sha2.c.html#LN153"><span class='Ref_to_Global_Var'>K256</span></a><span class='Delimiter'>[</span>j<span class='Delimiter'>] </span><span class='Operator'>+</span>      <span class='Operator'>\ 
</span>         <span class='Parentheses'>(</span>W256<span class='Delimiter'>[</span>j<span class='Operator'>&</span><span class='Number'>0x0f</span><span class='Delimiter'>] </span><span class='Operator'>+= </span><a href="../interfaces/ecpg/test/preproc/strings.h.html#LN0"><span class='Ref_to_Global_Var'>s1</span></a> <span class='Operator'>+ </span>W256<span class='Delimiter'>[</span><span class='Parentheses'>(</span>j<span class='Operator'>+</span><span class='Number'>9</span><span class='Parentheses'>)</span><span class='Operator'>&</span><span class='Number'>0x0f</span><span class='Delimiter'>] </span><span class='Operator'>+ </span>s0<span class='Parentheses'>)</span><span class='Delimiter'>;</span>          <span class='Operator'>\ 
</span>    <span class='Parentheses'>(</span><a href="sha2.c.html#LN290"><span class='Ref_to_Parameter'>d</span></a><span class='Parentheses'>) </span><span class='Operator'>+= </span>T1<span class='Delimiter'>;</span>                              <span class='Operator'>\ 
</span>    <span class='Parentheses'>(</span><a href="sha2.c.html#LN290"><span class='Ref_to_Parameter'>h</span></a><span class='Parentheses'>) </span><span class='Operator'>= </span>T1 <span class='Operator'>+ </span><a href="sha2.c.html#LN131"><span class='Ref_to_Macro'>Sigma0_256</span></a><span class='Parentheses'>((</span><a href="sha2.c.html#LN290"><span class='Ref_to_Parameter'>a</span></a><span class='Parentheses'>))</span> <span class='Operator'>+ </span><a href="sha2.c.html#LN128"><span class='Ref_to_Macro'>Maj</span></a><span class='Parentheses'>((</span><a href="sha2.c.html#LN290"><span class='Ref_to_Parameter'>a</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="sha2.c.html#LN290"><span class='Ref_to_Parameter'>b</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="sha2.c.html#LN290"><span class='Ref_to_Parameter'>c</span></a><span class='Parentheses'>))</span><span class='Delimiter'>;</span>            <span class='Operator'>\ 
</span>    j<span class='Operator'>++</span><span class='Delimiter'>;</span>                                    <span class='Operator'>\ 
</span><span class='Delimiter'>} </span><span class='Control'>while</span><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>) 
</span> 
<span class='Keyword'>static void 
</span><a name="LN303"></a><span class='Declare_Function'>SHA256_Transform</span><span class='Parentheses'>(</span><a href="../include/common/sha2.h.html#LN77"><span class='Ref_to_Struct'>pg_sha256_ctx</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>context</span><span class='Delimiter'>, </span><span class='Keyword'>const </span><a href="../include/c.h.html#LN265"><span class='Ref_to_Typedef'>uint8</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>data</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN305"></a>    <a href="../include/c.h.html#LN267"><span class='Ref_to_Typedef'>uint32</span></a>      <span class='Declare_Local'>a</span><span class='Delimiter'>, 
</span><a name="LN306"></a>                <span class='Declare_Local'>b</span><span class='Delimiter'>, 
</span><a name="LN307"></a>                <span class='Declare_Local'>c</span><span class='Delimiter'>, 
</span><a name="LN308"></a>                <span class='Declare_Local'>d</span><span class='Delimiter'>, 
</span><a name="LN309"></a>                <span class='Declare_Local'>e</span><span class='Delimiter'>, 
</span><a name="LN310"></a>                <span class='Declare_Local'>f</span><span class='Delimiter'>, 
</span><a name="LN311"></a>                <span class='Declare_Local'>g</span><span class='Delimiter'>, 
</span><a name="LN312"></a>                <span class='Declare_Local'>h</span><span class='Delimiter'>, 
</span><a name="LN313"></a>                <span class='Declare_Local'>s0</span><span class='Delimiter'>, 
</span><a name="LN314"></a>                <span class='Declare_Local'>s1</span><span class='Delimiter'>; 
</span><a name="LN315"></a>    <a href="../include/c.h.html#LN267"><span class='Ref_to_Typedef'>uint32</span></a>      <span class='Declare_Local'>T1</span><span class='Delimiter'>, 
</span><a name="LN316"></a>               <span class='Operator'>*</span><span class='Declare_Local'>W256</span><span class='Delimiter'>; 
</span><a name="LN317"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>j</span><span class='Delimiter'>; 
</span> 
    <a href="sha2.c.html#LN316"><span class='Ref_To_Local'>W256</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../include/c.h.html#LN267"><span class='Ref_to_Typedef'>uint32</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="sha2.c.html#LN303"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN81"><span class='Ref_to_Member'>buffer</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Initialize registers with the prev. intermediate value */ 
</span>    <a href="sha2.c.html#LN305"><span class='Ref_To_Local'>a</span></a> <span class='Operator'>= </span><a href="sha2.c.html#LN303"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN79"><span class='Ref_to_Member'>state</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>]; 
</span>    <a href="sha2.c.html#LN306"><span class='Ref_To_Local'>b</span></a> <span class='Operator'>= </span><a href="sha2.c.html#LN303"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN79"><span class='Ref_to_Member'>state</span></a><span class='Delimiter'>[</span><span class='Number'>1</span><span class='Delimiter'>]; 
</span>    <a href="sha2.c.html#LN307"><span class='Ref_To_Local'>c</span></a> <span class='Operator'>= </span><a href="sha2.c.html#LN303"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN79"><span class='Ref_to_Member'>state</span></a><span class='Delimiter'>[</span><span class='Number'>2</span><span class='Delimiter'>]; 
</span>    <a href="sha2.c.html#LN308"><span class='Ref_To_Local'>d</span></a> <span class='Operator'>= </span><a href="sha2.c.html#LN303"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN79"><span class='Ref_to_Member'>state</span></a><span class='Delimiter'>[</span><span class='Number'>3</span><span class='Delimiter'>]; 
</span>    <a href="sha2.c.html#LN309"><span class='Ref_To_Local'>e</span></a> <span class='Operator'>= </span><a href="sha2.c.html#LN303"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN79"><span class='Ref_to_Member'>state</span></a><span class='Delimiter'>[</span><span class='Number'>4</span><span class='Delimiter'>]; 
</span>    <a href="sha2.c.html#LN310"><span class='Ref_To_Local'>f</span></a> <span class='Operator'>= </span><a href="sha2.c.html#LN303"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN79"><span class='Ref_to_Member'>state</span></a><span class='Delimiter'>[</span><span class='Number'>5</span><span class='Delimiter'>]; 
</span>    <a href="sha2.c.html#LN311"><span class='Ref_To_Local'>g</span></a> <span class='Operator'>= </span><a href="sha2.c.html#LN303"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN79"><span class='Ref_to_Member'>state</span></a><span class='Delimiter'>[</span><span class='Number'>6</span><span class='Delimiter'>]; 
</span>    <a href="sha2.c.html#LN312"><span class='Ref_To_Local'>h</span></a> <span class='Operator'>= </span><a href="sha2.c.html#LN303"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN79"><span class='Ref_to_Member'>state</span></a><span class='Delimiter'>[</span><span class='Number'>7</span><span class='Delimiter'>]; 
</span> 
    <a href="sha2.c.html#LN317"><span class='Ref_To_Local'>j</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <span class='Control'>do</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* Rounds 0 to 15 (unrolled): */ 
</span>        <a href="sha2.c.html#LN280"><span class='Ref_to_Macro'>ROUND256_0_TO_15</span></a><span class='Parentheses'>(</span><a href="sha2.c.html#LN305"><span class='Ref_To_Local'>a</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN306"><span class='Ref_To_Local'>b</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN307"><span class='Ref_To_Local'>c</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN308"><span class='Ref_To_Local'>d</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN309"><span class='Ref_To_Local'>e</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN310"><span class='Ref_To_Local'>f</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN311"><span class='Ref_To_Local'>g</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN312"><span class='Ref_To_Local'>h</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="sha2.c.html#LN280"><span class='Ref_to_Macro'>ROUND256_0_TO_15</span></a><span class='Parentheses'>(</span><a href="sha2.c.html#LN312"><span class='Ref_To_Local'>h</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN305"><span class='Ref_To_Local'>a</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN306"><span class='Ref_To_Local'>b</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN307"><span class='Ref_To_Local'>c</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN308"><span class='Ref_To_Local'>d</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN309"><span class='Ref_To_Local'>e</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN310"><span class='Ref_To_Local'>f</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN311"><span class='Ref_To_Local'>g</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="sha2.c.html#LN280"><span class='Ref_to_Macro'>ROUND256_0_TO_15</span></a><span class='Parentheses'>(</span><a href="sha2.c.html#LN311"><span class='Ref_To_Local'>g</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN312"><span class='Ref_To_Local'>h</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN305"><span class='Ref_To_Local'>a</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN306"><span class='Ref_To_Local'>b</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN307"><span class='Ref_To_Local'>c</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN308"><span class='Ref_To_Local'>d</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN309"><span class='Ref_To_Local'>e</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN310"><span class='Ref_To_Local'>f</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="sha2.c.html#LN280"><span class='Ref_to_Macro'>ROUND256_0_TO_15</span></a><span class='Parentheses'>(</span><a href="sha2.c.html#LN310"><span class='Ref_To_Local'>f</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN311"><span class='Ref_To_Local'>g</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN312"><span class='Ref_To_Local'>h</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN305"><span class='Ref_To_Local'>a</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN306"><span class='Ref_To_Local'>b</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN307"><span class='Ref_To_Local'>c</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN308"><span class='Ref_To_Local'>d</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN309"><span class='Ref_To_Local'>e</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="sha2.c.html#LN280"><span class='Ref_to_Macro'>ROUND256_0_TO_15</span></a><span class='Parentheses'>(</span><a href="sha2.c.html#LN309"><span class='Ref_To_Local'>e</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN310"><span class='Ref_To_Local'>f</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN311"><span class='Ref_To_Local'>g</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN312"><span class='Ref_To_Local'>h</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN305"><span class='Ref_To_Local'>a</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN306"><span class='Ref_To_Local'>b</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN307"><span class='Ref_To_Local'>c</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN308"><span class='Ref_To_Local'>d</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="sha2.c.html#LN280"><span class='Ref_to_Macro'>ROUND256_0_TO_15</span></a><span class='Parentheses'>(</span><a href="sha2.c.html#LN308"><span class='Ref_To_Local'>d</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN309"><span class='Ref_To_Local'>e</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN310"><span class='Ref_To_Local'>f</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN311"><span class='Ref_To_Local'>g</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN312"><span class='Ref_To_Local'>h</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN305"><span class='Ref_To_Local'>a</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN306"><span class='Ref_To_Local'>b</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN307"><span class='Ref_To_Local'>c</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="sha2.c.html#LN280"><span class='Ref_to_Macro'>ROUND256_0_TO_15</span></a><span class='Parentheses'>(</span><a href="sha2.c.html#LN307"><span class='Ref_To_Local'>c</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN308"><span class='Ref_To_Local'>d</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN309"><span class='Ref_To_Local'>e</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN310"><span class='Ref_To_Local'>f</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN311"><span class='Ref_To_Local'>g</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN312"><span class='Ref_To_Local'>h</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN305"><span class='Ref_To_Local'>a</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN306"><span class='Ref_To_Local'>b</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="sha2.c.html#LN280"><span class='Ref_to_Macro'>ROUND256_0_TO_15</span></a><span class='Parentheses'>(</span><a href="sha2.c.html#LN306"><span class='Ref_To_Local'>b</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN307"><span class='Ref_To_Local'>c</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN308"><span class='Ref_To_Local'>d</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN309"><span class='Ref_To_Local'>e</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN310"><span class='Ref_To_Local'>f</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN311"><span class='Ref_To_Local'>g</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN312"><span class='Ref_To_Local'>h</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN305"><span class='Ref_To_Local'>a</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} </span><span class='Control'>while</span> <span class='Parentheses'>(</span><a href="sha2.c.html#LN317"><span class='Ref_To_Local'>j</span></a> <span class='Operator'>&LT; </span><span class='Number'>16</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Now for the remaining rounds to 64: */ 
</span>    <span class='Control'>do</span> 
    <span class='Delimiter'>{ 
</span>        <a href="sha2.c.html#LN290"><span class='Ref_to_Macro'>ROUND256</span></a><span class='Parentheses'>(</span><a href="sha2.c.html#LN305"><span class='Ref_To_Local'>a</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN306"><span class='Ref_To_Local'>b</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN307"><span class='Ref_To_Local'>c</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN308"><span class='Ref_To_Local'>d</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN309"><span class='Ref_To_Local'>e</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN310"><span class='Ref_To_Local'>f</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN311"><span class='Ref_To_Local'>g</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN312"><span class='Ref_To_Local'>h</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="sha2.c.html#LN290"><span class='Ref_to_Macro'>ROUND256</span></a><span class='Parentheses'>(</span><a href="sha2.c.html#LN312"><span class='Ref_To_Local'>h</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN305"><span class='Ref_To_Local'>a</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN306"><span class='Ref_To_Local'>b</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN307"><span class='Ref_To_Local'>c</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN308"><span class='Ref_To_Local'>d</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN309"><span class='Ref_To_Local'>e</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN310"><span class='Ref_To_Local'>f</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN311"><span class='Ref_To_Local'>g</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="sha2.c.html#LN290"><span class='Ref_to_Macro'>ROUND256</span></a><span class='Parentheses'>(</span><a href="sha2.c.html#LN311"><span class='Ref_To_Local'>g</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN312"><span class='Ref_To_Local'>h</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN305"><span class='Ref_To_Local'>a</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN306"><span class='Ref_To_Local'>b</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN307"><span class='Ref_To_Local'>c</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN308"><span class='Ref_To_Local'>d</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN309"><span class='Ref_To_Local'>e</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN310"><span class='Ref_To_Local'>f</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="sha2.c.html#LN290"><span class='Ref_to_Macro'>ROUND256</span></a><span class='Parentheses'>(</span><a href="sha2.c.html#LN310"><span class='Ref_To_Local'>f</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN311"><span class='Ref_To_Local'>g</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN312"><span class='Ref_To_Local'>h</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN305"><span class='Ref_To_Local'>a</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN306"><span class='Ref_To_Local'>b</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN307"><span class='Ref_To_Local'>c</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN308"><span class='Ref_To_Local'>d</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN309"><span class='Ref_To_Local'>e</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="sha2.c.html#LN290"><span class='Ref_to_Macro'>ROUND256</span></a><span class='Parentheses'>(</span><a href="sha2.c.html#LN309"><span class='Ref_To_Local'>e</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN310"><span class='Ref_To_Local'>f</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN311"><span class='Ref_To_Local'>g</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN312"><span class='Ref_To_Local'>h</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN305"><span class='Ref_To_Local'>a</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN306"><span class='Ref_To_Local'>b</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN307"><span class='Ref_To_Local'>c</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN308"><span class='Ref_To_Local'>d</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="sha2.c.html#LN290"><span class='Ref_to_Macro'>ROUND256</span></a><span class='Parentheses'>(</span><a href="sha2.c.html#LN308"><span class='Ref_To_Local'>d</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN309"><span class='Ref_To_Local'>e</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN310"><span class='Ref_To_Local'>f</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN311"><span class='Ref_To_Local'>g</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN312"><span class='Ref_To_Local'>h</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN305"><span class='Ref_To_Local'>a</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN306"><span class='Ref_To_Local'>b</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN307"><span class='Ref_To_Local'>c</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="sha2.c.html#LN290"><span class='Ref_to_Macro'>ROUND256</span></a><span class='Parentheses'>(</span><a href="sha2.c.html#LN307"><span class='Ref_To_Local'>c</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN308"><span class='Ref_To_Local'>d</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN309"><span class='Ref_To_Local'>e</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN310"><span class='Ref_To_Local'>f</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN311"><span class='Ref_To_Local'>g</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN312"><span class='Ref_To_Local'>h</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN305"><span class='Ref_To_Local'>a</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN306"><span class='Ref_To_Local'>b</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="sha2.c.html#LN290"><span class='Ref_to_Macro'>ROUND256</span></a><span class='Parentheses'>(</span><a href="sha2.c.html#LN306"><span class='Ref_To_Local'>b</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN307"><span class='Ref_To_Local'>c</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN308"><span class='Ref_To_Local'>d</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN309"><span class='Ref_To_Local'>e</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN310"><span class='Ref_To_Local'>f</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN311"><span class='Ref_To_Local'>g</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN312"><span class='Ref_To_Local'>h</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN305"><span class='Ref_To_Local'>a</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} </span><span class='Control'>while</span> <span class='Parentheses'>(</span><a href="sha2.c.html#LN317"><span class='Ref_To_Local'>j</span></a> <span class='Operator'>&LT; </span><span class='Number'>64</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Compute the current intermediate hash value */ 
</span>    <a href="sha2.c.html#LN303"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN79"><span class='Ref_to_Member'>state</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>] </span><span class='Operator'>+= </span><a href="sha2.c.html#LN305"><span class='Ref_To_Local'>a</span></a><span class='Delimiter'>; 
</span>    <a href="sha2.c.html#LN303"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN79"><span class='Ref_to_Member'>state</span></a><span class='Delimiter'>[</span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>+= </span><a href="sha2.c.html#LN306"><span class='Ref_To_Local'>b</span></a><span class='Delimiter'>; 
</span>    <a href="sha2.c.html#LN303"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN79"><span class='Ref_to_Member'>state</span></a><span class='Delimiter'>[</span><span class='Number'>2</span><span class='Delimiter'>] </span><span class='Operator'>+= </span><a href="sha2.c.html#LN307"><span class='Ref_To_Local'>c</span></a><span class='Delimiter'>; 
</span>    <a href="sha2.c.html#LN303"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN79"><span class='Ref_to_Member'>state</span></a><span class='Delimiter'>[</span><span class='Number'>3</span><span class='Delimiter'>] </span><span class='Operator'>+= </span><a href="sha2.c.html#LN308"><span class='Ref_To_Local'>d</span></a><span class='Delimiter'>; 
</span>    <a href="sha2.c.html#LN303"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN79"><span class='Ref_to_Member'>state</span></a><span class='Delimiter'>[</span><span class='Number'>4</span><span class='Delimiter'>] </span><span class='Operator'>+= </span><a href="sha2.c.html#LN309"><span class='Ref_To_Local'>e</span></a><span class='Delimiter'>; 
</span>    <a href="sha2.c.html#LN303"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN79"><span class='Ref_to_Member'>state</span></a><span class='Delimiter'>[</span><span class='Number'>5</span><span class='Delimiter'>] </span><span class='Operator'>+= </span><a href="sha2.c.html#LN310"><span class='Ref_To_Local'>f</span></a><span class='Delimiter'>; 
</span>    <a href="sha2.c.html#LN303"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN79"><span class='Ref_to_Member'>state</span></a><span class='Delimiter'>[</span><span class='Number'>6</span><span class='Delimiter'>] </span><span class='Operator'>+= </span><a href="sha2.c.html#LN311"><span class='Ref_To_Local'>g</span></a><span class='Delimiter'>; 
</span>    <a href="sha2.c.html#LN303"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN79"><span class='Ref_to_Member'>state</span></a><span class='Delimiter'>[</span><span class='Number'>7</span><span class='Delimiter'>] </span><span class='Operator'>+= </span><a href="sha2.c.html#LN312"><span class='Ref_To_Local'>h</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Clean up */ 
</span>    <a href="sha2.c.html#LN305"><span class='Ref_To_Local'>a</span></a> <span class='Operator'>= </span><a href="sha2.c.html#LN306"><span class='Ref_To_Local'>b</span></a> <span class='Operator'>= </span><a href="sha2.c.html#LN307"><span class='Ref_To_Local'>c</span></a> <span class='Operator'>= </span><a href="sha2.c.html#LN308"><span class='Ref_To_Local'>d</span></a> <span class='Operator'>= </span><a href="sha2.c.html#LN309"><span class='Ref_To_Local'>e</span></a> <span class='Operator'>= </span><a href="sha2.c.html#LN310"><span class='Ref_To_Local'>f</span></a> <span class='Operator'>= </span><a href="sha2.c.html#LN311"><span class='Ref_To_Local'>g</span></a> <span class='Operator'>= </span><a href="sha2.c.html#LN312"><span class='Ref_To_Local'>h</span></a> <span class='Operator'>= </span><a href="sha2.c.html#LN315"><span class='Ref_To_Local'>T1</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end SHA256_Transform &raquo; </span> 
<span class='Directive'>#else</span>                           <span class='Comment_Single_Line'>/* SHA2_UNROLL_TRANSFORM */ 
</span> 
<span class='Keyword'>static void 
</span><a name="LN374"></a><span class='Declare_Function'>SHA256_Transform</span><span class='Parentheses'>(</span><a href="../include/common/sha2.h.html#LN77"><span class='Ref_to_Struct'>pg_sha256_ctx</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>context</span><span class='Delimiter'>, </span><span class='Keyword'>const </span><a href="../include/c.h.html#LN265"><span class='Ref_to_Typedef'>uint8</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>data</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN376"></a>    <a href="../include/c.h.html#LN267"><span class='Ref_to_Typedef'>uint32</span></a>      <span class='Declare_Local'>a</span><span class='Delimiter'>, 
</span><a name="LN377"></a>                <span class='Declare_Local'>b</span><span class='Delimiter'>, 
</span><a name="LN378"></a>                <span class='Declare_Local'>c</span><span class='Delimiter'>, 
</span><a name="LN379"></a>                <span class='Declare_Local'>d</span><span class='Delimiter'>, 
</span><a name="LN380"></a>                <span class='Declare_Local'>e</span><span class='Delimiter'>, 
</span><a name="LN381"></a>                <span class='Declare_Local'>f</span><span class='Delimiter'>, 
</span><a name="LN382"></a>                <span class='Declare_Local'>g</span><span class='Delimiter'>, 
</span><a name="LN383"></a>                <span class='Declare_Local'>h</span><span class='Delimiter'>, 
</span><a name="LN384"></a>                <span class='Declare_Local'>s0</span><span class='Delimiter'>, 
</span><a name="LN385"></a>                <span class='Declare_Local'>s1</span><span class='Delimiter'>; 
</span><a name="LN386"></a>    <a href="../include/c.h.html#LN267"><span class='Ref_to_Typedef'>uint32</span></a>      <span class='Declare_Local'>T1</span><span class='Delimiter'>, 
</span><a name="LN387"></a>                <span class='Declare_Local'>T2</span><span class='Delimiter'>, 
</span><a name="LN388"></a>               <span class='Operator'>*</span><span class='Declare_Local'>W256</span><span class='Delimiter'>; 
</span><a name="LN389"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>j</span><span class='Delimiter'>; 
</span> 
    <a href="sha2.c.html#LN388"><span class='Ref_To_Local'>W256</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../include/c.h.html#LN267"><span class='Ref_to_Typedef'>uint32</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="sha2.c.html#LN374"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN81"><span class='Ref_to_Member'>buffer</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Initialize registers with the prev. intermediate value */ 
</span>    <a href="sha2.c.html#LN376"><span class='Ref_To_Local'>a</span></a> <span class='Operator'>= </span><a href="sha2.c.html#LN374"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN79"><span class='Ref_to_Member'>state</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>]; 
</span>    <a href="sha2.c.html#LN377"><span class='Ref_To_Local'>b</span></a> <span class='Operator'>= </span><a href="sha2.c.html#LN374"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN79"><span class='Ref_to_Member'>state</span></a><span class='Delimiter'>[</span><span class='Number'>1</span><span class='Delimiter'>]; 
</span>    <a href="sha2.c.html#LN378"><span class='Ref_To_Local'>c</span></a> <span class='Operator'>= </span><a href="sha2.c.html#LN374"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN79"><span class='Ref_to_Member'>state</span></a><span class='Delimiter'>[</span><span class='Number'>2</span><span class='Delimiter'>]; 
</span>    <a href="sha2.c.html#LN379"><span class='Ref_To_Local'>d</span></a> <span class='Operator'>= </span><a href="sha2.c.html#LN374"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN79"><span class='Ref_to_Member'>state</span></a><span class='Delimiter'>[</span><span class='Number'>3</span><span class='Delimiter'>]; 
</span>    <a href="sha2.c.html#LN380"><span class='Ref_To_Local'>e</span></a> <span class='Operator'>= </span><a href="sha2.c.html#LN374"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN79"><span class='Ref_to_Member'>state</span></a><span class='Delimiter'>[</span><span class='Number'>4</span><span class='Delimiter'>]; 
</span>    <a href="sha2.c.html#LN381"><span class='Ref_To_Local'>f</span></a> <span class='Operator'>= </span><a href="sha2.c.html#LN374"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN79"><span class='Ref_to_Member'>state</span></a><span class='Delimiter'>[</span><span class='Number'>5</span><span class='Delimiter'>]; 
</span>    <a href="sha2.c.html#LN382"><span class='Ref_To_Local'>g</span></a> <span class='Operator'>= </span><a href="sha2.c.html#LN374"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN79"><span class='Ref_to_Member'>state</span></a><span class='Delimiter'>[</span><span class='Number'>6</span><span class='Delimiter'>]; 
</span>    <a href="sha2.c.html#LN383"><span class='Ref_To_Local'>h</span></a> <span class='Operator'>= </span><a href="sha2.c.html#LN374"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN79"><span class='Ref_to_Member'>state</span></a><span class='Delimiter'>[</span><span class='Number'>7</span><span class='Delimiter'>]; 
</span> 
    <a href="sha2.c.html#LN389"><span class='Ref_To_Local'>j</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <span class='Control'>do</span> 
    <span class='Delimiter'>{ 
</span>        <a href="sha2.c.html#LN388"><span class='Ref_To_Local'>W256</span></a><span class='Delimiter'>[</span><a href="sha2.c.html#LN389"><span class='Ref_To_Local'>j</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../include/c.h.html#LN267"><span class='Ref_to_Typedef'>uint32</span></a><span class='Parentheses'>) </span><a href="sha2.c.html#LN374"><span class='Ref_to_Parameter'>data</span></a><span class='Delimiter'>[</span><span class='Number'>3</span><span class='Delimiter'>] </span><span class='Operator'>| </span><span class='Parentheses'>((</span><a href="../include/c.h.html#LN267"><span class='Ref_to_Typedef'>uint32</span></a><span class='Parentheses'>) </span><a href="sha2.c.html#LN374"><span class='Ref_to_Parameter'>data</span></a><span class='Delimiter'>[</span><span class='Number'>2</span><span class='Delimiter'>] </span><span class='Operator'>&LT;&LT; </span><span class='Number'>8</span><span class='Parentheses'>)</span> <span class='Operator'>| 
</span>            <span class='Parentheses'>((</span><a href="../include/c.h.html#LN267"><span class='Ref_to_Typedef'>uint32</span></a><span class='Parentheses'>) </span><a href="sha2.c.html#LN374"><span class='Ref_to_Parameter'>data</span></a><span class='Delimiter'>[</span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>&LT;&LT; </span><span class='Number'>16</span><span class='Parentheses'>)</span> <span class='Operator'>| </span><span class='Parentheses'>((</span><a href="../include/c.h.html#LN267"><span class='Ref_to_Typedef'>uint32</span></a><span class='Parentheses'>) </span><a href="sha2.c.html#LN374"><span class='Ref_to_Parameter'>data</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>] </span><span class='Operator'>&LT;&LT; </span><span class='Number'>24</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="sha2.c.html#LN374"><span class='Ref_to_Parameter'>data</span></a> <span class='Operator'>+= </span><span class='Number'>4</span><span class='Delimiter'>; 
</span>        <span class='Comment_Multi_Line'>/* Apply the SHA-256 compression function to update a..h */ 
</span>        <a href="sha2.c.html#LN386"><span class='Ref_To_Local'>T1</span></a> <span class='Operator'>= </span><a href="sha2.c.html#LN383"><span class='Ref_To_Local'>h</span></a> <span class='Operator'>+ </span><a href="sha2.c.html#LN132"><span class='Ref_to_Macro'>Sigma1_256</span></a><span class='Parentheses'>(</span><a href="sha2.c.html#LN380"><span class='Ref_To_Local'>e</span></a><span class='Parentheses'>) </span><span class='Operator'>+ </span><a href="sha2.c.html#LN127"><span class='Ref_to_Macro'>Ch</span></a><span class='Parentheses'>(</span><a href="sha2.c.html#LN380"><span class='Ref_To_Local'>e</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN381"><span class='Ref_To_Local'>f</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN382"><span class='Ref_To_Local'>g</span></a><span class='Parentheses'>) </span><span class='Operator'>+ </span><a href="sha2.c.html#LN153"><span class='Ref_to_Global_Var'>K256</span></a><span class='Delimiter'>[</span><a href="sha2.c.html#LN389"><span class='Ref_To_Local'>j</span></a><span class='Delimiter'>] </span><span class='Operator'>+ </span><a href="sha2.c.html#LN388"><span class='Ref_To_Local'>W256</span></a><span class='Delimiter'>[</span><a href="sha2.c.html#LN389"><span class='Ref_To_Local'>j</span></a><span class='Delimiter'>]; 
</span>        <a href="sha2.c.html#LN387"><span class='Ref_To_Local'>T2</span></a> <span class='Operator'>= </span><a href="sha2.c.html#LN131"><span class='Ref_to_Macro'>Sigma0_256</span></a><span class='Parentheses'>(</span><a href="sha2.c.html#LN376"><span class='Ref_To_Local'>a</span></a><span class='Parentheses'>) </span><span class='Operator'>+ </span><a href="sha2.c.html#LN128"><span class='Ref_to_Macro'>Maj</span></a><span class='Parentheses'>(</span><a href="sha2.c.html#LN376"><span class='Ref_To_Local'>a</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN377"><span class='Ref_To_Local'>b</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN378"><span class='Ref_To_Local'>c</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="sha2.c.html#LN383"><span class='Ref_To_Local'>h</span></a> <span class='Operator'>= </span><a href="sha2.c.html#LN382"><span class='Ref_To_Local'>g</span></a><span class='Delimiter'>; 
</span>        <a href="sha2.c.html#LN382"><span class='Ref_To_Local'>g</span></a> <span class='Operator'>= </span><a href="sha2.c.html#LN381"><span class='Ref_To_Local'>f</span></a><span class='Delimiter'>; 
</span>        <a href="sha2.c.html#LN381"><span class='Ref_To_Local'>f</span></a> <span class='Operator'>= </span><a href="sha2.c.html#LN380"><span class='Ref_To_Local'>e</span></a><span class='Delimiter'>; 
</span>        <a href="sha2.c.html#LN380"><span class='Ref_To_Local'>e</span></a> <span class='Operator'>= </span><a href="sha2.c.html#LN379"><span class='Ref_To_Local'>d</span></a> <span class='Operator'>+ </span><a href="sha2.c.html#LN386"><span class='Ref_To_Local'>T1</span></a><span class='Delimiter'>; 
</span>        <a href="sha2.c.html#LN379"><span class='Ref_To_Local'>d</span></a> <span class='Operator'>= </span><a href="sha2.c.html#LN378"><span class='Ref_To_Local'>c</span></a><span class='Delimiter'>; 
</span>        <a href="sha2.c.html#LN378"><span class='Ref_To_Local'>c</span></a> <span class='Operator'>= </span><a href="sha2.c.html#LN377"><span class='Ref_To_Local'>b</span></a><span class='Delimiter'>; 
</span>        <a href="sha2.c.html#LN377"><span class='Ref_To_Local'>b</span></a> <span class='Operator'>= </span><a href="sha2.c.html#LN376"><span class='Ref_To_Local'>a</span></a><span class='Delimiter'>; 
</span>        <a href="sha2.c.html#LN376"><span class='Ref_To_Local'>a</span></a> <span class='Operator'>= </span><a href="sha2.c.html#LN386"><span class='Ref_To_Local'>T1</span></a> <span class='Operator'>+ </span><a href="sha2.c.html#LN387"><span class='Ref_To_Local'>T2</span></a><span class='Delimiter'>; 
</span> 
        <a href="sha2.c.html#LN389"><span class='Ref_To_Local'>j</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} </span><span class='Control'>while</span> <span class='Parentheses'>(</span><a href="sha2.c.html#LN389"><span class='Ref_To_Local'>j</span></a> <span class='Operator'>&LT; </span><span class='Number'>16</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>do</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* Part of the message block expansion: */ 
</span>        <a href="sha2.c.html#LN384"><span class='Ref_To_Local'>s0</span></a> <span class='Operator'>= </span><a href="sha2.c.html#LN388"><span class='Ref_To_Local'>W256</span></a><span class='Delimiter'>[</span><span class='Parentheses'>(</span><a href="sha2.c.html#LN389"><span class='Ref_To_Local'>j</span></a> <span class='Operator'>+ </span><span class='Number'>1</span><span class='Parentheses'>) </span><span class='Operator'>& </span><span class='Number'>0x0f</span><span class='Delimiter'>]; 
</span>        <a href="sha2.c.html#LN384"><span class='Ref_To_Local'>s0</span></a> <span class='Operator'>= </span><a href="sha2.c.html#LN133"><span class='Ref_to_Macro'>sigma0_256</span></a><span class='Parentheses'>(</span><a href="sha2.c.html#LN384"><span class='Ref_To_Local'>s0</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="sha2.c.html#LN385"><span class='Ref_To_Local'>s1</span></a> <span class='Operator'>= </span><a href="sha2.c.html#LN388"><span class='Ref_To_Local'>W256</span></a><span class='Delimiter'>[</span><span class='Parentheses'>(</span><a href="sha2.c.html#LN389"><span class='Ref_To_Local'>j</span></a> <span class='Operator'>+ </span><span class='Number'>14</span><span class='Parentheses'>) </span><span class='Operator'>& </span><span class='Number'>0x0f</span><span class='Delimiter'>]; 
</span>        <a href="sha2.c.html#LN385"><span class='Ref_To_Local'>s1</span></a> <span class='Operator'>= </span><a href="sha2.c.html#LN134"><span class='Ref_to_Macro'>sigma1_256</span></a><span class='Parentheses'>(</span><a href="sha2.c.html#LN385"><span class='Ref_To_Local'>s1</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* Apply the SHA-256 compression function to update a..h */ 
</span>        <a href="sha2.c.html#LN386"><span class='Ref_To_Local'>T1</span></a> <span class='Operator'>= </span><a href="sha2.c.html#LN383"><span class='Ref_To_Local'>h</span></a> <span class='Operator'>+ </span><a href="sha2.c.html#LN132"><span class='Ref_to_Macro'>Sigma1_256</span></a><span class='Parentheses'>(</span><a href="sha2.c.html#LN380"><span class='Ref_To_Local'>e</span></a><span class='Parentheses'>) </span><span class='Operator'>+ </span><a href="sha2.c.html#LN127"><span class='Ref_to_Macro'>Ch</span></a><span class='Parentheses'>(</span><a href="sha2.c.html#LN380"><span class='Ref_To_Local'>e</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN381"><span class='Ref_To_Local'>f</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN382"><span class='Ref_To_Local'>g</span></a><span class='Parentheses'>) </span><span class='Operator'>+ </span><a href="sha2.c.html#LN153"><span class='Ref_to_Global_Var'>K256</span></a><span class='Delimiter'>[</span><a href="sha2.c.html#LN389"><span class='Ref_To_Local'>j</span></a><span class='Delimiter'>] </span><span class='Operator'>+ 
</span>            <span class='Parentheses'>(</span><a href="sha2.c.html#LN388"><span class='Ref_To_Local'>W256</span></a><span class='Delimiter'>[</span><a href="sha2.c.html#LN389"><span class='Ref_To_Local'>j</span></a> <span class='Operator'>& </span><span class='Number'>0x0f</span><span class='Delimiter'>] </span><span class='Operator'>+= </span><a href="sha2.c.html#LN385"><span class='Ref_To_Local'>s1</span></a> <span class='Operator'>+ </span><a href="sha2.c.html#LN388"><span class='Ref_To_Local'>W256</span></a><span class='Delimiter'>[</span><span class='Parentheses'>(</span><a href="sha2.c.html#LN389"><span class='Ref_To_Local'>j</span></a> <span class='Operator'>+ </span><span class='Number'>9</span><span class='Parentheses'>) </span><span class='Operator'>& </span><span class='Number'>0x0f</span><span class='Delimiter'>] </span><span class='Operator'>+ </span><a href="sha2.c.html#LN384"><span class='Ref_To_Local'>s0</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="sha2.c.html#LN387"><span class='Ref_To_Local'>T2</span></a> <span class='Operator'>= </span><a href="sha2.c.html#LN131"><span class='Ref_to_Macro'>Sigma0_256</span></a><span class='Parentheses'>(</span><a href="sha2.c.html#LN376"><span class='Ref_To_Local'>a</span></a><span class='Parentheses'>) </span><span class='Operator'>+ </span><a href="sha2.c.html#LN128"><span class='Ref_to_Macro'>Maj</span></a><span class='Parentheses'>(</span><a href="sha2.c.html#LN376"><span class='Ref_To_Local'>a</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN377"><span class='Ref_To_Local'>b</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN378"><span class='Ref_To_Local'>c</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="sha2.c.html#LN383"><span class='Ref_To_Local'>h</span></a> <span class='Operator'>= </span><a href="sha2.c.html#LN382"><span class='Ref_To_Local'>g</span></a><span class='Delimiter'>; 
</span>        <a href="sha2.c.html#LN382"><span class='Ref_To_Local'>g</span></a> <span class='Operator'>= </span><a href="sha2.c.html#LN381"><span class='Ref_To_Local'>f</span></a><span class='Delimiter'>; 
</span>        <a href="sha2.c.html#LN381"><span class='Ref_To_Local'>f</span></a> <span class='Operator'>= </span><a href="sha2.c.html#LN380"><span class='Ref_To_Local'>e</span></a><span class='Delimiter'>; 
</span>        <a href="sha2.c.html#LN380"><span class='Ref_To_Local'>e</span></a> <span class='Operator'>= </span><a href="sha2.c.html#LN379"><span class='Ref_To_Local'>d</span></a> <span class='Operator'>+ </span><a href="sha2.c.html#LN386"><span class='Ref_To_Local'>T1</span></a><span class='Delimiter'>; 
</span>        <a href="sha2.c.html#LN379"><span class='Ref_To_Local'>d</span></a> <span class='Operator'>= </span><a href="sha2.c.html#LN378"><span class='Ref_To_Local'>c</span></a><span class='Delimiter'>; 
</span>        <a href="sha2.c.html#LN378"><span class='Ref_To_Local'>c</span></a> <span class='Operator'>= </span><a href="sha2.c.html#LN377"><span class='Ref_To_Local'>b</span></a><span class='Delimiter'>; 
</span>        <a href="sha2.c.html#LN377"><span class='Ref_To_Local'>b</span></a> <span class='Operator'>= </span><a href="sha2.c.html#LN376"><span class='Ref_To_Local'>a</span></a><span class='Delimiter'>; 
</span>        <a href="sha2.c.html#LN376"><span class='Ref_To_Local'>a</span></a> <span class='Operator'>= </span><a href="sha2.c.html#LN386"><span class='Ref_To_Local'>T1</span></a> <span class='Operator'>+ </span><a href="sha2.c.html#LN387"><span class='Ref_To_Local'>T2</span></a><span class='Delimiter'>; 
</span> 
        <a href="sha2.c.html#LN389"><span class='Ref_To_Local'>j</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end do &raquo; </span> <span class='Control'>while</span> <span class='Parentheses'>(</span><a href="sha2.c.html#LN389"><span class='Ref_To_Local'>j</span></a> <span class='Operator'>&LT; </span><span class='Number'>64</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Compute the current intermediate hash value */ 
</span>    <a href="sha2.c.html#LN374"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN79"><span class='Ref_to_Member'>state</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>] </span><span class='Operator'>+= </span><a href="sha2.c.html#LN376"><span class='Ref_To_Local'>a</span></a><span class='Delimiter'>; 
</span>    <a href="sha2.c.html#LN374"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN79"><span class='Ref_to_Member'>state</span></a><span class='Delimiter'>[</span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>+= </span><a href="sha2.c.html#LN377"><span class='Ref_To_Local'>b</span></a><span class='Delimiter'>; 
</span>    <a href="sha2.c.html#LN374"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN79"><span class='Ref_to_Member'>state</span></a><span class='Delimiter'>[</span><span class='Number'>2</span><span class='Delimiter'>] </span><span class='Operator'>+= </span><a href="sha2.c.html#LN378"><span class='Ref_To_Local'>c</span></a><span class='Delimiter'>; 
</span>    <a href="sha2.c.html#LN374"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN79"><span class='Ref_to_Member'>state</span></a><span class='Delimiter'>[</span><span class='Number'>3</span><span class='Delimiter'>] </span><span class='Operator'>+= </span><a href="sha2.c.html#LN379"><span class='Ref_To_Local'>d</span></a><span class='Delimiter'>; 
</span>    <a href="sha2.c.html#LN374"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN79"><span class='Ref_to_Member'>state</span></a><span class='Delimiter'>[</span><span class='Number'>4</span><span class='Delimiter'>] </span><span class='Operator'>+= </span><a href="sha2.c.html#LN380"><span class='Ref_To_Local'>e</span></a><span class='Delimiter'>; 
</span>    <a href="sha2.c.html#LN374"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN79"><span class='Ref_to_Member'>state</span></a><span class='Delimiter'>[</span><span class='Number'>5</span><span class='Delimiter'>] </span><span class='Operator'>+= </span><a href="sha2.c.html#LN381"><span class='Ref_To_Local'>f</span></a><span class='Delimiter'>; 
</span>    <a href="sha2.c.html#LN374"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN79"><span class='Ref_to_Member'>state</span></a><span class='Delimiter'>[</span><span class='Number'>6</span><span class='Delimiter'>] </span><span class='Operator'>+= </span><a href="sha2.c.html#LN382"><span class='Ref_To_Local'>g</span></a><span class='Delimiter'>; 
</span>    <a href="sha2.c.html#LN374"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN79"><span class='Ref_to_Member'>state</span></a><span class='Delimiter'>[</span><span class='Number'>7</span><span class='Delimiter'>] </span><span class='Operator'>+= </span><a href="sha2.c.html#LN383"><span class='Ref_To_Local'>h</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Clean up */ 
</span>    <a href="sha2.c.html#LN376"><span class='Ref_To_Local'>a</span></a> <span class='Operator'>= </span><a href="sha2.c.html#LN377"><span class='Ref_To_Local'>b</span></a> <span class='Operator'>= </span><a href="sha2.c.html#LN378"><span class='Ref_To_Local'>c</span></a> <span class='Operator'>= </span><a href="sha2.c.html#LN379"><span class='Ref_To_Local'>d</span></a> <span class='Operator'>= </span><a href="sha2.c.html#LN380"><span class='Ref_To_Local'>e</span></a> <span class='Operator'>= </span><a href="sha2.c.html#LN381"><span class='Ref_To_Local'>f</span></a> <span class='Operator'>= </span><a href="sha2.c.html#LN382"><span class='Ref_To_Local'>g</span></a> <span class='Operator'>= </span><a href="sha2.c.html#LN383"><span class='Ref_To_Local'>h</span></a> <span class='Operator'>= </span><a href="sha2.c.html#LN386"><span class='Ref_To_Local'>T1</span></a> <span class='Operator'>= </span><a href="sha2.c.html#LN387"><span class='Ref_To_Local'>T2</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end SHA256_Transform &raquo; </span> 
<span class='Directive'>#endif</span>   <span class='Comment_Single_Line'>/* SHA2_UNROLL_TRANSFORM */ 
</span> 
<span class='Keyword'>void 
</span><a name="LN464"></a><span class='Declare_Function'>pg_sha256_update</span><span class='Parentheses'>(</span><a href="../include/common/sha2.h.html#LN77"><span class='Ref_to_Struct'>pg_sha256_ctx</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>context</span><span class='Delimiter'>, </span><span class='Keyword'>const </span><a href="../include/c.h.html#LN265"><span class='Ref_to_Typedef'>uint8</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>data</span><span class='Delimiter'>, </span>size_t <span class='Declare_Parameter'>len</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN466"></a>    size_t      <span class='Declare_Local'>freespace</span><span class='Delimiter'>, 
</span><a name="LN467"></a>                <span class='Declare_Local'>usedspace</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Calling with no data is valid (we do nothing) */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="sha2.c.html#LN464"><span class='Ref_to_Parameter'>len</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>        <span class='Control'>return</span><span class='Delimiter'>; 
</span> 
    <a href="sha2.c.html#LN467"><span class='Ref_To_Local'>usedspace</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="sha2.c.html#LN464"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN80"><span class='Ref_to_Member'>bitcount</span></a> <span class='Operator'>&GT;&GT; </span><span class='Number'>3</span><span class='Parentheses'>) </span><span class='Operator'>% </span><a href="../include/common/sha2.h.html#LN60"><span class='Ref_to_Const'>PG_SHA256_BLOCK_LENGTH</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="sha2.c.html#LN467"><span class='Ref_To_Local'>usedspace</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* Calculate how much free space is available in the buffer */ 
</span>        <a href="sha2.c.html#LN466"><span class='Ref_To_Local'>freespace</span></a> <span class='Operator'>= </span><a href="../include/common/sha2.h.html#LN60"><span class='Ref_to_Const'>PG_SHA256_BLOCK_LENGTH</span></a> <span class='Operator'>- </span><a href="sha2.c.html#LN467"><span class='Ref_To_Local'>usedspace</span></a><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="sha2.c.html#LN464"><span class='Ref_to_Parameter'>len</span></a> <span class='Operator'>&GT;= </span><a href="sha2.c.html#LN466"><span class='Ref_To_Local'>freespace</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* Fill the buffer completely and process it */ 
</span>            memcpy<span class='Parentheses'>(</span><span class='Operator'>&</span><a href="sha2.c.html#LN464"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN81"><span class='Ref_to_Member'>buffer</span></a><span class='Delimiter'>[</span><a href="sha2.c.html#LN467"><span class='Ref_To_Local'>usedspace</span></a><span class='Delimiter'>], </span><a href="sha2.c.html#LN464"><span class='Ref_to_Parameter'>data</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN466"><span class='Ref_To_Local'>freespace</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="sha2.c.html#LN464"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN80"><span class='Ref_to_Member'>bitcount</span></a> <span class='Operator'>+= </span><a href="sha2.c.html#LN466"><span class='Ref_To_Local'>freespace</span></a> <span class='Operator'>&LT;&LT; </span><span class='Number'>3</span><span class='Delimiter'>; 
</span>            <a href="sha2.c.html#LN464"><span class='Ref_to_Parameter'>len</span></a> <span class='Operator'>-= </span><a href="sha2.c.html#LN466"><span class='Ref_To_Local'>freespace</span></a><span class='Delimiter'>; 
</span>            <a href="sha2.c.html#LN464"><span class='Ref_to_Parameter'>data</span></a> <span class='Operator'>+= </span><a href="sha2.c.html#LN466"><span class='Ref_To_Local'>freespace</span></a><span class='Delimiter'>; 
</span>            <a href="sha2.c.html#LN148"><span class='Ref_to_Proto'>SHA256_Transform</span></a><span class='Parentheses'>(</span><a href="sha2.c.html#LN464"><span class='Ref_to_Parameter'>context</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN464"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN81"><span class='Ref_to_Member'>buffer</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* The buffer is not yet full */ 
</span>            memcpy<span class='Parentheses'>(</span><span class='Operator'>&</span><a href="sha2.c.html#LN464"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN81"><span class='Ref_to_Member'>buffer</span></a><span class='Delimiter'>[</span><a href="sha2.c.html#LN467"><span class='Ref_To_Local'>usedspace</span></a><span class='Delimiter'>], </span><a href="sha2.c.html#LN464"><span class='Ref_to_Parameter'>data</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN464"><span class='Ref_to_Parameter'>len</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="sha2.c.html#LN464"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN80"><span class='Ref_to_Member'>bitcount</span></a> <span class='Operator'>+= </span><a href="sha2.c.html#LN464"><span class='Ref_to_Parameter'>len</span></a> <span class='Operator'>&LT;&LT; </span><span class='Number'>3</span><span class='Delimiter'>; 
</span>            <span class='Comment_Multi_Line'>/* Clean up: */ 
</span>            <a href="sha2.c.html#LN467"><span class='Ref_To_Local'>usedspace</span></a> <span class='Operator'>= </span><a href="sha2.c.html#LN466"><span class='Ref_To_Local'>freespace</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>            <span class='Control'>return</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if usedspace&GT;0 &raquo; </span> 
    <span class='Control'>while</span> <span class='Parentheses'>(</span><a href="sha2.c.html#LN464"><span class='Ref_to_Parameter'>len</span></a> <span class='Operator'>&GT;= </span><a href="../include/common/sha2.h.html#LN60"><span class='Ref_to_Const'>PG_SHA256_BLOCK_LENGTH</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* Process as many complete blocks as we can */ 
</span>        <a href="sha2.c.html#LN148"><span class='Ref_to_Proto'>SHA256_Transform</span></a><span class='Parentheses'>(</span><a href="sha2.c.html#LN464"><span class='Ref_to_Parameter'>context</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN464"><span class='Ref_to_Parameter'>data</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="sha2.c.html#LN464"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN80"><span class='Ref_to_Member'>bitcount</span></a> <span class='Operator'>+= </span><a href="../include/common/sha2.h.html#LN60"><span class='Ref_to_Const'>PG_SHA256_BLOCK_LENGTH</span></a> <span class='Operator'>&LT;&LT; </span><span class='Number'>3</span><span class='Delimiter'>; 
</span>        <a href="sha2.c.html#LN464"><span class='Ref_to_Parameter'>len</span></a> <span class='Operator'>-= </span><a href="../include/common/sha2.h.html#LN60"><span class='Ref_to_Const'>PG_SHA256_BLOCK_LENGTH</span></a><span class='Delimiter'>; 
</span>        <a href="sha2.c.html#LN464"><span class='Ref_to_Parameter'>data</span></a> <span class='Operator'>+= </span><a href="../include/common/sha2.h.html#LN60"><span class='Ref_to_Const'>PG_SHA256_BLOCK_LENGTH</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="sha2.c.html#LN464"><span class='Ref_to_Parameter'>len</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* There's left-overs, so save 'em */ 
</span>        memcpy<span class='Parentheses'>(</span><a href="sha2.c.html#LN464"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN81"><span class='Ref_to_Member'>buffer</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN464"><span class='Ref_to_Parameter'>data</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN464"><span class='Ref_to_Parameter'>len</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="sha2.c.html#LN464"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN80"><span class='Ref_to_Member'>bitcount</span></a> <span class='Operator'>+= </span><a href="sha2.c.html#LN464"><span class='Ref_to_Parameter'>len</span></a> <span class='Operator'>&LT;&LT; </span><span class='Number'>3</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Comment_Multi_Line'>/* Clean up: */ 
</span>    <a href="sha2.c.html#LN467"><span class='Ref_To_Local'>usedspace</span></a> <span class='Operator'>= </span><a href="sha2.c.html#LN466"><span class='Ref_To_Local'>freespace</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end pg_sha256_update &raquo; </span> 
 
<span class='Keyword'>static void 
</span><a name="LN517"></a><span class='Declare_Function'>SHA256_Last</span><span class='Parentheses'>(</span><a href="../include/common/sha2.h.html#LN77"><span class='Ref_to_Struct'>pg_sha256_ctx</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>context</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN519"></a>    <span class='Keyword'>unsigned int </span><span class='Declare_Local'>usedspace</span><span class='Delimiter'>; 
</span> 
    <a href="sha2.c.html#LN519"><span class='Ref_To_Local'>usedspace</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="sha2.c.html#LN517"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN80"><span class='Ref_to_Member'>bitcount</span></a> <span class='Operator'>&GT;&GT; </span><span class='Number'>3</span><span class='Parentheses'>) </span><span class='Operator'>% </span><a href="../include/common/sha2.h.html#LN60"><span class='Ref_to_Const'>PG_SHA256_BLOCK_LENGTH</span></a><span class='Delimiter'>; 
</span><span class='Directive'>#ifndef</span> WORDS_BIGENDIAN 
    <span class='Comment_Multi_Line'>/* Convert FROM host byte order */ 
</span>    <a href="sha2.c.html#LN88"><span class='Ref_to_Macro'>REVERSE64</span></a><span class='Parentheses'>(</span><a href="sha2.c.html#LN517"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN80"><span class='Ref_to_Member'>bitcount</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN517"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN80"><span class='Ref_to_Member'>bitcount</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><span class='Directive'>#endif</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="sha2.c.html#LN519"><span class='Ref_To_Local'>usedspace</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* Begin padding with a 1 bit: */ 
</span>        <a href="sha2.c.html#LN517"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN81"><span class='Ref_to_Member'>buffer</span></a><span class='Delimiter'>[</span><a href="sha2.c.html#LN519"><span class='Ref_To_Local'>usedspace</span></a><span class='Operator'>++</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Number'>0x80</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="sha2.c.html#LN519"><span class='Ref_To_Local'>usedspace</span></a> <span class='Operator'>&LT;= </span><a href="sha2.c.html#LN77"><span class='Ref_to_Const'>PG_SHA256_SHORT_BLOCK_LENGTH</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* Set-up for the last transform: */ 
</span>            memset<span class='Parentheses'>(</span><span class='Operator'>&</span><a href="sha2.c.html#LN517"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN81"><span class='Ref_to_Member'>buffer</span></a><span class='Delimiter'>[</span><a href="sha2.c.html#LN519"><span class='Ref_To_Local'>usedspace</span></a><span class='Delimiter'>], </span><span class='Number'>0</span><span class='Delimiter'>, </span><a href="sha2.c.html#LN77"><span class='Ref_to_Const'>PG_SHA256_SHORT_BLOCK_LENGTH</span></a> <span class='Operator'>- </span><a href="sha2.c.html#LN519"><span class='Ref_To_Local'>usedspace</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="sha2.c.html#LN519"><span class='Ref_To_Local'>usedspace</span></a> <span class='Operator'>&LT; </span><a href="../include/common/sha2.h.html#LN60"><span class='Ref_to_Const'>PG_SHA256_BLOCK_LENGTH</span></a><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                memset<span class='Parentheses'>(</span><span class='Operator'>&</span><a href="sha2.c.html#LN517"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN81"><span class='Ref_to_Member'>buffer</span></a><span class='Delimiter'>[</span><a href="sha2.c.html#LN519"><span class='Ref_To_Local'>usedspace</span></a><span class='Delimiter'>], </span><span class='Number'>0</span><span class='Delimiter'>, </span><a href="../include/common/sha2.h.html#LN60"><span class='Ref_to_Const'>PG_SHA256_BLOCK_LENGTH</span></a> <span class='Operator'>- </span><a href="sha2.c.html#LN519"><span class='Ref_To_Local'>usedspace</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>            <span class='Comment_Multi_Line'>/* Do second-to-last transform: */ 
</span>            <a href="sha2.c.html#LN148"><span class='Ref_to_Proto'>SHA256_Transform</span></a><span class='Parentheses'>(</span><a href="sha2.c.html#LN517"><span class='Ref_to_Parameter'>context</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN517"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN81"><span class='Ref_to_Member'>buffer</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <span class='Comment_Multi_Line'>/* And set-up for the last transform: */ 
</span>            memset<span class='Parentheses'>(</span><a href="sha2.c.html#LN517"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN81"><span class='Ref_to_Member'>buffer</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Delimiter'>, </span><a href="sha2.c.html#LN77"><span class='Ref_to_Const'>PG_SHA256_SHORT_BLOCK_LENGTH</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if usedspace&GT;0 &raquo; </span> 
    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* Set-up for the last transform: */ 
</span>        memset<span class='Parentheses'>(</span><a href="sha2.c.html#LN517"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN81"><span class='Ref_to_Member'>buffer</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Delimiter'>, </span><a href="sha2.c.html#LN77"><span class='Ref_to_Const'>PG_SHA256_SHORT_BLOCK_LENGTH</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* Begin padding with a 1 bit: */ 
</span>        <span class='Operator'>*</span><a href="sha2.c.html#LN517"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN81"><span class='Ref_to_Member'>buffer</span></a> <span class='Operator'>= </span><span class='Number'>0x80</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Comment_Multi_Line'>/* Set the bit count: */ 
</span>    <span class='Operator'>*</span><span class='Parentheses'>(</span><a href="../include/c.h.html#LN297"><span class='Ref_to_Typedef'>uint64</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><span class='Operator'>&</span><a href="sha2.c.html#LN517"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN81"><span class='Ref_to_Member'>buffer</span></a><span class='Delimiter'>[</span><a href="sha2.c.html#LN77"><span class='Ref_to_Const'>PG_SHA256_SHORT_BLOCK_LENGTH</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="sha2.c.html#LN517"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN80"><span class='Ref_to_Member'>bitcount</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Final transform: */ 
</span>    <a href="sha2.c.html#LN148"><span class='Ref_to_Proto'>SHA256_Transform</span></a><span class='Parentheses'>(</span><a href="sha2.c.html#LN517"><span class='Ref_to_Parameter'>context</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN517"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN81"><span class='Ref_to_Member'>buffer</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end SHA256_Last &raquo; </span> 
 
<span class='Keyword'>void 
</span><a name="LN565"></a><span class='Declare_Function'>pg_sha256_final</span><span class='Parentheses'>(</span><a href="../include/common/sha2.h.html#LN77"><span class='Ref_to_Struct'>pg_sha256_ctx</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>context</span><span class='Delimiter'>, </span><a href="../include/c.h.html#LN265"><span class='Ref_to_Typedef'>uint8</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>digest</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Comment_Multi_Line'>/* If no digest buffer is passed, we don't bother doing this: */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="sha2.c.html#LN565"><span class='Ref_to_Parameter'>digest</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="sha2.c.html#LN516"><span class='Ref_to_Func'>SHA256_Last</span></a><span class='Parentheses'>(</span><a href="sha2.c.html#LN565"><span class='Ref_to_Parameter'>context</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
<span class='Directive'>#ifndef</span> WORDS_BIGENDIAN 
        <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* Convert TO host byte order */ 
</span><a name="LN575"></a>            <span class='Keyword'>int</span>         <span class='Declare_Local'>j</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="sha2.c.html#LN575"><span class='Ref_To_Local'>j</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="sha2.c.html#LN575"><span class='Ref_To_Local'>j</span></a> <span class='Operator'>&LT; </span><span class='Number'>8</span><span class='Delimiter'>; </span><a href="sha2.c.html#LN575"><span class='Ref_To_Local'>j</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <a href="sha2.c.html#LN83"><span class='Ref_to_Macro'>REVERSE32</span></a><span class='Parentheses'>(</span><a href="sha2.c.html#LN565"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN79"><span class='Ref_to_Member'>state</span></a><span class='Delimiter'>[</span><a href="sha2.c.html#LN575"><span class='Ref_To_Local'>j</span></a><span class='Delimiter'>], </span><a href="sha2.c.html#LN565"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN79"><span class='Ref_to_Member'>state</span></a><span class='Delimiter'>[</span><a href="sha2.c.html#LN575"><span class='Ref_To_Local'>j</span></a><span class='Delimiter'>]</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>        <span class='Delimiter'>} 
</span><span class='Directive'>#endif</span> 
        memcpy<span class='Parentheses'>(</span><a href="sha2.c.html#LN565"><span class='Ref_to_Parameter'>digest</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN565"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN79"><span class='Ref_to_Member'>state</span></a><span class='Delimiter'>, </span><a href="../include/common/sha2.h.html#LN61"><span class='Ref_to_Const'>PG_SHA256_DIGEST_LENGTH</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* Clean up state data: */ 
</span>    memset<span class='Parentheses'>(</span><a href="sha2.c.html#LN565"><span class='Ref_to_Parameter'>context</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Delimiter'>, </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../include/common/sha2.h.html#LN77"><span class='Ref_to_Struct'>pg_sha256_ctx</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end pg_sha256_final &raquo; </span> 
 
 
<span class='Comment_Multi_Line'>/*** SHA-512: *********************************************************/ 
</span><span class='Keyword'>void 
</span><a name="LN593"></a><span class='Declare_Function'>pg_sha512_init</span><span class='Parentheses'>(</span><a href="../include/common/sha2.h.html#LN83"><span class='Ref_to_Struct'>pg_sha512_ctx</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>context</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="sha2.c.html#LN593"><span class='Ref_to_Parameter'>context</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>        <span class='Control'>return</span><span class='Delimiter'>; 
</span>    memcpy<span class='Parentheses'>(</span><a href="sha2.c.html#LN593"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN85"><span class='Ref_to_Member'>state</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN253"><span class='Ref_to_Global_Var'>sha512_initial_hash_value</span></a><span class='Delimiter'>, </span><a href="../include/common/sha2.h.html#LN67"><span class='Ref_to_Const'>PG_SHA512_DIGEST_LENGTH</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    memset<span class='Parentheses'>(</span><a href="sha2.c.html#LN593"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN87"><span class='Ref_to_Member'>buffer</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Delimiter'>, </span><a href="../include/common/sha2.h.html#LN66"><span class='Ref_to_Const'>PG_SHA512_BLOCK_LENGTH</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="sha2.c.html#LN593"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN86"><span class='Ref_to_Member'>bitcount</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="sha2.c.html#LN593"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN86"><span class='Ref_to_Member'>bitcount</span></a><span class='Delimiter'>[</span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
} 
</span> 
<span class='Directive'>#ifdef</span> SHA2_UNROLL_TRANSFORM 
 
<span class='Comment_Multi_Line'>/* Unrolled SHA-512 round macros: */ 
</span> 
<a name="LN606"></a><span class='Keyword'>#define </span><span class='Declare_Macro'>ROUND512_0_TO_15</span><span class='Parentheses'>(</span><span class='Declare_Parameter'>a</span><span class='Delimiter'>,</span><span class='Declare_Parameter'>b</span><span class='Delimiter'>,</span><span class='Declare_Parameter'>c</span><span class='Delimiter'>,</span><span class='Declare_Parameter'>d</span><span class='Delimiter'>,</span><span class='Declare_Parameter'>e</span><span class='Delimiter'>,</span><span class='Declare_Parameter'>f</span><span class='Delimiter'>,</span><span class='Declare_Parameter'>g</span><span class='Delimiter'>,</span><span class='Declare_Parameter'>h</span><span class='Parentheses'>) </span><span class='Control'>do</span> <span class='Delimiter'>{</span>                  <span class='Operator'>\ 
</span>    W512<span class='Delimiter'>[</span>j<span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../include/c.h.html#LN297"><span class='Ref_to_Typedef'>uint64</span></a><span class='Parentheses'>)</span>data<span class='Delimiter'>[</span><span class='Number'>7</span><span class='Delimiter'>] </span><span class='Operator'>| </span><span class='Parentheses'>((</span><a href="../include/c.h.html#LN297"><span class='Ref_to_Typedef'>uint64</span></a><span class='Parentheses'>)</span>data<span class='Delimiter'>[</span><span class='Number'>6</span><span class='Delimiter'>] </span><span class='Operator'>&LT;&LT; </span><span class='Number'>8</span><span class='Parentheses'>)</span> <span class='Operator'>|</span>        <span class='Operator'>\ 
</span>        <span class='Parentheses'>((</span><a href="../include/c.h.html#LN297"><span class='Ref_to_Typedef'>uint64</span></a><span class='Parentheses'>)</span>data<span class='Delimiter'>[</span><span class='Number'>5</span><span class='Delimiter'>] </span><span class='Operator'>&LT;&LT; </span><span class='Number'>16</span><span class='Parentheses'>)</span> <span class='Operator'>| </span><span class='Parentheses'>((</span><a href="../include/c.h.html#LN297"><span class='Ref_to_Typedef'>uint64</span></a><span class='Parentheses'>)</span>data<span class='Delimiter'>[</span><span class='Number'>4</span><span class='Delimiter'>] </span><span class='Operator'>&LT;&LT; </span><span class='Number'>24</span><span class='Parentheses'>)</span> <span class='Operator'>|</span>     <span class='Operator'>\ 
</span>        <span class='Parentheses'>((</span><a href="../include/c.h.html#LN297"><span class='Ref_to_Typedef'>uint64</span></a><span class='Parentheses'>)</span>data<span class='Delimiter'>[</span><span class='Number'>3</span><span class='Delimiter'>] </span><span class='Operator'>&LT;&LT; </span><span class='Number'>32</span><span class='Parentheses'>)</span> <span class='Operator'>| </span><span class='Parentheses'>((</span><a href="../include/c.h.html#LN297"><span class='Ref_to_Typedef'>uint64</span></a><span class='Parentheses'>)</span>data<span class='Delimiter'>[</span><span class='Number'>2</span><span class='Delimiter'>] </span><span class='Operator'>&LT;&LT; </span><span class='Number'>40</span><span class='Parentheses'>)</span> <span class='Operator'>|</span>     <span class='Operator'>\ 
</span>        <span class='Parentheses'>((</span><a href="../include/c.h.html#LN297"><span class='Ref_to_Typedef'>uint64</span></a><span class='Parentheses'>)</span>data<span class='Delimiter'>[</span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>&LT;&LT; </span><span class='Number'>48</span><span class='Parentheses'>)</span> <span class='Operator'>| </span><span class='Parentheses'>((</span><a href="../include/c.h.html#LN297"><span class='Ref_to_Typedef'>uint64</span></a><span class='Parentheses'>)</span>data<span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>] </span><span class='Operator'>&LT;&LT; </span><span class='Number'>56</span><span class='Parentheses'>)</span><span class='Delimiter'>;</span>      <span class='Operator'>\ 
</span>    data <span class='Operator'>+= </span><span class='Number'>8</span><span class='Delimiter'>;</span>                              <span class='Operator'>\ 
</span>    T1 <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="sha2.c.html#LN606"><span class='Ref_to_Parameter'>h</span></a><span class='Parentheses'>) </span><span class='Operator'>+ </span><a href="sha2.c.html#LN138"><span class='Ref_to_Macro'>Sigma1_512</span></a><span class='Parentheses'>((</span><a href="sha2.c.html#LN606"><span class='Ref_to_Parameter'>e</span></a><span class='Parentheses'>))</span> <span class='Operator'>+ </span><a href="sha2.c.html#LN127"><span class='Ref_to_Macro'>Ch</span></a><span class='Parentheses'>((</span><a href="sha2.c.html#LN606"><span class='Ref_to_Parameter'>e</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="sha2.c.html#LN606"><span class='Ref_to_Parameter'>f</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="sha2.c.html#LN606"><span class='Ref_to_Parameter'>g</span></a><span class='Parentheses'>))</span> <span class='Operator'>+ </span><a href="sha2.c.html#LN197"><span class='Ref_to_Global_Var'>K512</span></a><span class='Delimiter'>[</span>j<span class='Delimiter'>] </span><span class='Operator'>+ </span>W512<span class='Delimiter'>[</span>j<span class='Delimiter'>]; </span><span class='Operator'>\ 
</span>    <span class='Parentheses'>(</span><a href="sha2.c.html#LN606"><span class='Ref_to_Parameter'>d</span></a><span class='Parentheses'>) </span><span class='Operator'>+= </span>T1<span class='Delimiter'>;</span>                              <span class='Operator'>\ 
</span>    <span class='Parentheses'>(</span><a href="sha2.c.html#LN606"><span class='Ref_to_Parameter'>h</span></a><span class='Parentheses'>) </span><span class='Operator'>= </span>T1 <span class='Operator'>+ </span><a href="sha2.c.html#LN137"><span class='Ref_to_Macro'>Sigma0_512</span></a><span class='Parentheses'>((</span><a href="sha2.c.html#LN606"><span class='Ref_to_Parameter'>a</span></a><span class='Parentheses'>))</span> <span class='Operator'>+ </span><a href="sha2.c.html#LN128"><span class='Ref_to_Macro'>Maj</span></a><span class='Parentheses'>((</span><a href="sha2.c.html#LN606"><span class='Ref_to_Parameter'>a</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="sha2.c.html#LN606"><span class='Ref_to_Parameter'>b</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="sha2.c.html#LN606"><span class='Ref_to_Parameter'>c</span></a><span class='Parentheses'>))</span><span class='Delimiter'>;</span>            <span class='Operator'>\ 
</span>    j<span class='Operator'>++</span><span class='Delimiter'>;</span>                                    <span class='Operator'>\ 
</span><span class='Delimiter'>} </span><span class='Control'>while</span><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>) 
</span> 
 
<a name="LN619"></a><span class='Keyword'>#define </span><span class='Declare_Macro'>ROUND512</span><span class='Parentheses'>(</span><span class='Declare_Parameter'>a</span><span class='Delimiter'>,</span><span class='Declare_Parameter'>b</span><span class='Delimiter'>,</span><span class='Declare_Parameter'>c</span><span class='Delimiter'>,</span><span class='Declare_Parameter'>d</span><span class='Delimiter'>,</span><span class='Declare_Parameter'>e</span><span class='Delimiter'>,</span><span class='Declare_Parameter'>f</span><span class='Delimiter'>,</span><span class='Declare_Parameter'>g</span><span class='Delimiter'>,</span><span class='Declare_Parameter'>h</span><span class='Parentheses'>) </span><span class='Control'>do</span> <span class='Delimiter'>{</span>                      <span class='Operator'>\ 
</span>    s0 <span class='Operator'>= </span>W512<span class='Delimiter'>[</span><span class='Parentheses'>(</span>j<span class='Operator'>+</span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Operator'>&</span><span class='Number'>0x0f</span><span class='Delimiter'>];</span>                          <span class='Operator'>\ 
</span>    s0 <span class='Operator'>= </span><a href="sha2.c.html#LN139"><span class='Ref_to_Macro'>sigma0_512</span></a><span class='Parentheses'>(</span>s0<span class='Parentheses'>)</span><span class='Delimiter'>;</span>                            <span class='Operator'>\ 
</span>    <a href="../interfaces/ecpg/test/preproc/strings.h.html#LN0"><span class='Ref_to_Global_Var'>s1</span></a> <span class='Operator'>= </span>W512<span class='Delimiter'>[</span><span class='Parentheses'>(</span>j<span class='Operator'>+</span><span class='Number'>14</span><span class='Parentheses'>)</span><span class='Operator'>&</span><span class='Number'>0x0f</span><span class='Delimiter'>];</span>                         <span class='Operator'>\ 
</span>    <a href="../interfaces/ecpg/test/preproc/strings.h.html#LN0"><span class='Ref_to_Global_Var'>s1</span></a> <span class='Operator'>= </span><a href="sha2.c.html#LN140"><span class='Ref_to_Macro'>sigma1_512</span></a><span class='Parentheses'>(</span><a href="../interfaces/ecpg/test/preproc/strings.h.html#LN0"><span class='Ref_to_Global_Var'>s1</span></a><span class='Parentheses'>)</span><span class='Delimiter'>;</span>                            <span class='Operator'>\ 
</span>    T1 <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="sha2.c.html#LN619"><span class='Ref_to_Parameter'>h</span></a><span class='Parentheses'>) </span><span class='Operator'>+ </span><a href="sha2.c.html#LN138"><span class='Ref_to_Macro'>Sigma1_512</span></a><span class='Parentheses'>((</span><a href="sha2.c.html#LN619"><span class='Ref_to_Parameter'>e</span></a><span class='Parentheses'>))</span> <span class='Operator'>+ </span><a href="sha2.c.html#LN127"><span class='Ref_to_Macro'>Ch</span></a><span class='Parentheses'>((</span><a href="sha2.c.html#LN619"><span class='Ref_to_Parameter'>e</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="sha2.c.html#LN619"><span class='Ref_to_Parameter'>f</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="sha2.c.html#LN619"><span class='Ref_to_Parameter'>g</span></a><span class='Parentheses'>))</span> <span class='Operator'>+ </span><a href="sha2.c.html#LN197"><span class='Ref_to_Global_Var'>K512</span></a><span class='Delimiter'>[</span>j<span class='Delimiter'>] </span><span class='Operator'>+</span>      <span class='Operator'>\ 
</span>             <span class='Parentheses'>(</span>W512<span class='Delimiter'>[</span>j<span class='Operator'>&</span><span class='Number'>0x0f</span><span class='Delimiter'>] </span><span class='Operator'>+= </span><a href="../interfaces/ecpg/test/preproc/strings.h.html#LN0"><span class='Ref_to_Global_Var'>s1</span></a> <span class='Operator'>+ </span>W512<span class='Delimiter'>[</span><span class='Parentheses'>(</span>j<span class='Operator'>+</span><span class='Number'>9</span><span class='Parentheses'>)</span><span class='Operator'>&</span><span class='Number'>0x0f</span><span class='Delimiter'>] </span><span class='Operator'>+ </span>s0<span class='Parentheses'>)</span><span class='Delimiter'>;</span>          <span class='Operator'>\ 
</span>    <span class='Parentheses'>(</span><a href="sha2.c.html#LN619"><span class='Ref_to_Parameter'>d</span></a><span class='Parentheses'>) </span><span class='Operator'>+= </span>T1<span class='Delimiter'>;</span>                              <span class='Operator'>\ 
</span>    <span class='Parentheses'>(</span><a href="sha2.c.html#LN619"><span class='Ref_to_Parameter'>h</span></a><span class='Parentheses'>) </span><span class='Operator'>= </span>T1 <span class='Operator'>+ </span><a href="sha2.c.html#LN137"><span class='Ref_to_Macro'>Sigma0_512</span></a><span class='Parentheses'>((</span><a href="sha2.c.html#LN619"><span class='Ref_to_Parameter'>a</span></a><span class='Parentheses'>))</span> <span class='Operator'>+ </span><a href="sha2.c.html#LN128"><span class='Ref_to_Macro'>Maj</span></a><span class='Parentheses'>((</span><a href="sha2.c.html#LN619"><span class='Ref_to_Parameter'>a</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="sha2.c.html#LN619"><span class='Ref_to_Parameter'>b</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="sha2.c.html#LN619"><span class='Ref_to_Parameter'>c</span></a><span class='Parentheses'>))</span><span class='Delimiter'>;</span>            <span class='Operator'>\ 
</span>    j<span class='Operator'>++</span><span class='Delimiter'>;</span>                                    <span class='Operator'>\ 
</span><span class='Delimiter'>} </span><span class='Control'>while</span><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>) 
</span> 
<span class='Keyword'>static void 
</span><a name="LN632"></a><span class='Declare_Function'>SHA512_Transform</span><span class='Parentheses'>(</span><a href="../include/common/sha2.h.html#LN83"><span class='Ref_to_Struct'>pg_sha512_ctx</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>context</span><span class='Delimiter'>, </span><span class='Keyword'>const </span><a href="../include/c.h.html#LN265"><span class='Ref_to_Typedef'>uint8</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>data</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN634"></a>    <a href="../include/c.h.html#LN297"><span class='Ref_to_Typedef'>uint64</span></a>      <span class='Declare_Local'>a</span><span class='Delimiter'>, 
</span><a name="LN635"></a>                <span class='Declare_Local'>b</span><span class='Delimiter'>, 
</span><a name="LN636"></a>                <span class='Declare_Local'>c</span><span class='Delimiter'>, 
</span><a name="LN637"></a>                <span class='Declare_Local'>d</span><span class='Delimiter'>, 
</span><a name="LN638"></a>                <span class='Declare_Local'>e</span><span class='Delimiter'>, 
</span><a name="LN639"></a>                <span class='Declare_Local'>f</span><span class='Delimiter'>, 
</span><a name="LN640"></a>                <span class='Declare_Local'>g</span><span class='Delimiter'>, 
</span><a name="LN641"></a>                <span class='Declare_Local'>h</span><span class='Delimiter'>, 
</span><a name="LN642"></a>                <span class='Declare_Local'>s0</span><span class='Delimiter'>, 
</span><a name="LN643"></a>                <span class='Declare_Local'>s1</span><span class='Delimiter'>; 
</span><a name="LN644"></a>    <a href="../include/c.h.html#LN297"><span class='Ref_to_Typedef'>uint64</span></a>      <span class='Declare_Local'>T1</span><span class='Delimiter'>, 
</span><a name="LN645"></a>               <span class='Operator'>*</span><span class='Declare_Local'>W512</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../include/c.h.html#LN297"><span class='Ref_to_Typedef'>uint64</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="sha2.c.html#LN632"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN87"><span class='Ref_to_Member'>buffer</span></a><span class='Delimiter'>; 
</span><a name="LN646"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>j</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Initialize registers with the prev. intermediate value */ 
</span>    <a href="sha2.c.html#LN634"><span class='Ref_To_Local'>a</span></a> <span class='Operator'>= </span><a href="sha2.c.html#LN632"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN85"><span class='Ref_to_Member'>state</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>]; 
</span>    <a href="sha2.c.html#LN635"><span class='Ref_To_Local'>b</span></a> <span class='Operator'>= </span><a href="sha2.c.html#LN632"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN85"><span class='Ref_to_Member'>state</span></a><span class='Delimiter'>[</span><span class='Number'>1</span><span class='Delimiter'>]; 
</span>    <a href="sha2.c.html#LN636"><span class='Ref_To_Local'>c</span></a> <span class='Operator'>= </span><a href="sha2.c.html#LN632"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN85"><span class='Ref_to_Member'>state</span></a><span class='Delimiter'>[</span><span class='Number'>2</span><span class='Delimiter'>]; 
</span>    <a href="sha2.c.html#LN637"><span class='Ref_To_Local'>d</span></a> <span class='Operator'>= </span><a href="sha2.c.html#LN632"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN85"><span class='Ref_to_Member'>state</span></a><span class='Delimiter'>[</span><span class='Number'>3</span><span class='Delimiter'>]; 
</span>    <a href="sha2.c.html#LN638"><span class='Ref_To_Local'>e</span></a> <span class='Operator'>= </span><a href="sha2.c.html#LN632"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN85"><span class='Ref_to_Member'>state</span></a><span class='Delimiter'>[</span><span class='Number'>4</span><span class='Delimiter'>]; 
</span>    <a href="sha2.c.html#LN639"><span class='Ref_To_Local'>f</span></a> <span class='Operator'>= </span><a href="sha2.c.html#LN632"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN85"><span class='Ref_to_Member'>state</span></a><span class='Delimiter'>[</span><span class='Number'>5</span><span class='Delimiter'>]; 
</span>    <a href="sha2.c.html#LN640"><span class='Ref_To_Local'>g</span></a> <span class='Operator'>= </span><a href="sha2.c.html#LN632"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN85"><span class='Ref_to_Member'>state</span></a><span class='Delimiter'>[</span><span class='Number'>6</span><span class='Delimiter'>]; 
</span>    <a href="sha2.c.html#LN641"><span class='Ref_To_Local'>h</span></a> <span class='Operator'>= </span><a href="sha2.c.html#LN632"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN85"><span class='Ref_to_Member'>state</span></a><span class='Delimiter'>[</span><span class='Number'>7</span><span class='Delimiter'>]; 
</span> 
    <a href="sha2.c.html#LN646"><span class='Ref_To_Local'>j</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <span class='Control'>do</span> 
    <span class='Delimiter'>{ 
</span>        <a href="sha2.c.html#LN606"><span class='Ref_to_Macro'>ROUND512_0_TO_15</span></a><span class='Parentheses'>(</span><a href="sha2.c.html#LN634"><span class='Ref_To_Local'>a</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN635"><span class='Ref_To_Local'>b</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN636"><span class='Ref_To_Local'>c</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN637"><span class='Ref_To_Local'>d</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN638"><span class='Ref_To_Local'>e</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN639"><span class='Ref_To_Local'>f</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN640"><span class='Ref_To_Local'>g</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN641"><span class='Ref_To_Local'>h</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="sha2.c.html#LN606"><span class='Ref_to_Macro'>ROUND512_0_TO_15</span></a><span class='Parentheses'>(</span><a href="sha2.c.html#LN641"><span class='Ref_To_Local'>h</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN634"><span class='Ref_To_Local'>a</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN635"><span class='Ref_To_Local'>b</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN636"><span class='Ref_To_Local'>c</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN637"><span class='Ref_To_Local'>d</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN638"><span class='Ref_To_Local'>e</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN639"><span class='Ref_To_Local'>f</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN640"><span class='Ref_To_Local'>g</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="sha2.c.html#LN606"><span class='Ref_to_Macro'>ROUND512_0_TO_15</span></a><span class='Parentheses'>(</span><a href="sha2.c.html#LN640"><span class='Ref_To_Local'>g</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN641"><span class='Ref_To_Local'>h</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN634"><span class='Ref_To_Local'>a</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN635"><span class='Ref_To_Local'>b</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN636"><span class='Ref_To_Local'>c</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN637"><span class='Ref_To_Local'>d</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN638"><span class='Ref_To_Local'>e</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN639"><span class='Ref_To_Local'>f</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="sha2.c.html#LN606"><span class='Ref_to_Macro'>ROUND512_0_TO_15</span></a><span class='Parentheses'>(</span><a href="sha2.c.html#LN639"><span class='Ref_To_Local'>f</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN640"><span class='Ref_To_Local'>g</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN641"><span class='Ref_To_Local'>h</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN634"><span class='Ref_To_Local'>a</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN635"><span class='Ref_To_Local'>b</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN636"><span class='Ref_To_Local'>c</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN637"><span class='Ref_To_Local'>d</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN638"><span class='Ref_To_Local'>e</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="sha2.c.html#LN606"><span class='Ref_to_Macro'>ROUND512_0_TO_15</span></a><span class='Parentheses'>(</span><a href="sha2.c.html#LN638"><span class='Ref_To_Local'>e</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN639"><span class='Ref_To_Local'>f</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN640"><span class='Ref_To_Local'>g</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN641"><span class='Ref_To_Local'>h</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN634"><span class='Ref_To_Local'>a</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN635"><span class='Ref_To_Local'>b</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN636"><span class='Ref_To_Local'>c</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN637"><span class='Ref_To_Local'>d</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="sha2.c.html#LN606"><span class='Ref_to_Macro'>ROUND512_0_TO_15</span></a><span class='Parentheses'>(</span><a href="sha2.c.html#LN637"><span class='Ref_To_Local'>d</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN638"><span class='Ref_To_Local'>e</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN639"><span class='Ref_To_Local'>f</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN640"><span class='Ref_To_Local'>g</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN641"><span class='Ref_To_Local'>h</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN634"><span class='Ref_To_Local'>a</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN635"><span class='Ref_To_Local'>b</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN636"><span class='Ref_To_Local'>c</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="sha2.c.html#LN606"><span class='Ref_to_Macro'>ROUND512_0_TO_15</span></a><span class='Parentheses'>(</span><a href="sha2.c.html#LN636"><span class='Ref_To_Local'>c</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN637"><span class='Ref_To_Local'>d</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN638"><span class='Ref_To_Local'>e</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN639"><span class='Ref_To_Local'>f</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN640"><span class='Ref_To_Local'>g</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN641"><span class='Ref_To_Local'>h</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN634"><span class='Ref_To_Local'>a</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN635"><span class='Ref_To_Local'>b</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="sha2.c.html#LN606"><span class='Ref_to_Macro'>ROUND512_0_TO_15</span></a><span class='Parentheses'>(</span><a href="sha2.c.html#LN635"><span class='Ref_To_Local'>b</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN636"><span class='Ref_To_Local'>c</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN637"><span class='Ref_To_Local'>d</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN638"><span class='Ref_To_Local'>e</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN639"><span class='Ref_To_Local'>f</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN640"><span class='Ref_To_Local'>g</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN641"><span class='Ref_To_Local'>h</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN634"><span class='Ref_To_Local'>a</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} </span><span class='Control'>while</span> <span class='Parentheses'>(</span><a href="sha2.c.html#LN646"><span class='Ref_To_Local'>j</span></a> <span class='Operator'>&LT; </span><span class='Number'>16</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Now for the remaining rounds up to 79: */ 
</span>    <span class='Control'>do</span> 
    <span class='Delimiter'>{ 
</span>        <a href="sha2.c.html#LN619"><span class='Ref_to_Macro'>ROUND512</span></a><span class='Parentheses'>(</span><a href="sha2.c.html#LN634"><span class='Ref_To_Local'>a</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN635"><span class='Ref_To_Local'>b</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN636"><span class='Ref_To_Local'>c</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN637"><span class='Ref_To_Local'>d</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN638"><span class='Ref_To_Local'>e</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN639"><span class='Ref_To_Local'>f</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN640"><span class='Ref_To_Local'>g</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN641"><span class='Ref_To_Local'>h</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="sha2.c.html#LN619"><span class='Ref_to_Macro'>ROUND512</span></a><span class='Parentheses'>(</span><a href="sha2.c.html#LN641"><span class='Ref_To_Local'>h</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN634"><span class='Ref_To_Local'>a</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN635"><span class='Ref_To_Local'>b</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN636"><span class='Ref_To_Local'>c</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN637"><span class='Ref_To_Local'>d</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN638"><span class='Ref_To_Local'>e</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN639"><span class='Ref_To_Local'>f</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN640"><span class='Ref_To_Local'>g</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="sha2.c.html#LN619"><span class='Ref_to_Macro'>ROUND512</span></a><span class='Parentheses'>(</span><a href="sha2.c.html#LN640"><span class='Ref_To_Local'>g</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN641"><span class='Ref_To_Local'>h</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN634"><span class='Ref_To_Local'>a</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN635"><span class='Ref_To_Local'>b</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN636"><span class='Ref_To_Local'>c</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN637"><span class='Ref_To_Local'>d</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN638"><span class='Ref_To_Local'>e</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN639"><span class='Ref_To_Local'>f</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="sha2.c.html#LN619"><span class='Ref_to_Macro'>ROUND512</span></a><span class='Parentheses'>(</span><a href="sha2.c.html#LN639"><span class='Ref_To_Local'>f</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN640"><span class='Ref_To_Local'>g</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN641"><span class='Ref_To_Local'>h</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN634"><span class='Ref_To_Local'>a</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN635"><span class='Ref_To_Local'>b</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN636"><span class='Ref_To_Local'>c</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN637"><span class='Ref_To_Local'>d</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN638"><span class='Ref_To_Local'>e</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="sha2.c.html#LN619"><span class='Ref_to_Macro'>ROUND512</span></a><span class='Parentheses'>(</span><a href="sha2.c.html#LN638"><span class='Ref_To_Local'>e</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN639"><span class='Ref_To_Local'>f</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN640"><span class='Ref_To_Local'>g</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN641"><span class='Ref_To_Local'>h</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN634"><span class='Ref_To_Local'>a</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN635"><span class='Ref_To_Local'>b</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN636"><span class='Ref_To_Local'>c</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN637"><span class='Ref_To_Local'>d</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="sha2.c.html#LN619"><span class='Ref_to_Macro'>ROUND512</span></a><span class='Parentheses'>(</span><a href="sha2.c.html#LN637"><span class='Ref_To_Local'>d</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN638"><span class='Ref_To_Local'>e</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN639"><span class='Ref_To_Local'>f</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN640"><span class='Ref_To_Local'>g</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN641"><span class='Ref_To_Local'>h</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN634"><span class='Ref_To_Local'>a</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN635"><span class='Ref_To_Local'>b</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN636"><span class='Ref_To_Local'>c</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="sha2.c.html#LN619"><span class='Ref_to_Macro'>ROUND512</span></a><span class='Parentheses'>(</span><a href="sha2.c.html#LN636"><span class='Ref_To_Local'>c</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN637"><span class='Ref_To_Local'>d</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN638"><span class='Ref_To_Local'>e</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN639"><span class='Ref_To_Local'>f</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN640"><span class='Ref_To_Local'>g</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN641"><span class='Ref_To_Local'>h</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN634"><span class='Ref_To_Local'>a</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN635"><span class='Ref_To_Local'>b</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="sha2.c.html#LN619"><span class='Ref_to_Macro'>ROUND512</span></a><span class='Parentheses'>(</span><a href="sha2.c.html#LN635"><span class='Ref_To_Local'>b</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN636"><span class='Ref_To_Local'>c</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN637"><span class='Ref_To_Local'>d</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN638"><span class='Ref_To_Local'>e</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN639"><span class='Ref_To_Local'>f</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN640"><span class='Ref_To_Local'>g</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN641"><span class='Ref_To_Local'>h</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN634"><span class='Ref_To_Local'>a</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} </span><span class='Control'>while</span> <span class='Parentheses'>(</span><a href="sha2.c.html#LN646"><span class='Ref_To_Local'>j</span></a> <span class='Operator'>&LT; </span><span class='Number'>80</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Compute the current intermediate hash value */ 
</span>    <a href="sha2.c.html#LN632"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN85"><span class='Ref_to_Member'>state</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>] </span><span class='Operator'>+= </span><a href="sha2.c.html#LN634"><span class='Ref_To_Local'>a</span></a><span class='Delimiter'>; 
</span>    <a href="sha2.c.html#LN632"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN85"><span class='Ref_to_Member'>state</span></a><span class='Delimiter'>[</span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>+= </span><a href="sha2.c.html#LN635"><span class='Ref_To_Local'>b</span></a><span class='Delimiter'>; 
</span>    <a href="sha2.c.html#LN632"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN85"><span class='Ref_to_Member'>state</span></a><span class='Delimiter'>[</span><span class='Number'>2</span><span class='Delimiter'>] </span><span class='Operator'>+= </span><a href="sha2.c.html#LN636"><span class='Ref_To_Local'>c</span></a><span class='Delimiter'>; 
</span>    <a href="sha2.c.html#LN632"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN85"><span class='Ref_to_Member'>state</span></a><span class='Delimiter'>[</span><span class='Number'>3</span><span class='Delimiter'>] </span><span class='Operator'>+= </span><a href="sha2.c.html#LN637"><span class='Ref_To_Local'>d</span></a><span class='Delimiter'>; 
</span>    <a href="sha2.c.html#LN632"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN85"><span class='Ref_to_Member'>state</span></a><span class='Delimiter'>[</span><span class='Number'>4</span><span class='Delimiter'>] </span><span class='Operator'>+= </span><a href="sha2.c.html#LN638"><span class='Ref_To_Local'>e</span></a><span class='Delimiter'>; 
</span>    <a href="sha2.c.html#LN632"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN85"><span class='Ref_to_Member'>state</span></a><span class='Delimiter'>[</span><span class='Number'>5</span><span class='Delimiter'>] </span><span class='Operator'>+= </span><a href="sha2.c.html#LN639"><span class='Ref_To_Local'>f</span></a><span class='Delimiter'>; 
</span>    <a href="sha2.c.html#LN632"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN85"><span class='Ref_to_Member'>state</span></a><span class='Delimiter'>[</span><span class='Number'>6</span><span class='Delimiter'>] </span><span class='Operator'>+= </span><a href="sha2.c.html#LN640"><span class='Ref_To_Local'>g</span></a><span class='Delimiter'>; 
</span>    <a href="sha2.c.html#LN632"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN85"><span class='Ref_to_Member'>state</span></a><span class='Delimiter'>[</span><span class='Number'>7</span><span class='Delimiter'>] </span><span class='Operator'>+= </span><a href="sha2.c.html#LN641"><span class='Ref_To_Local'>h</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Clean up */ 
</span>    <a href="sha2.c.html#LN634"><span class='Ref_To_Local'>a</span></a> <span class='Operator'>= </span><a href="sha2.c.html#LN635"><span class='Ref_To_Local'>b</span></a> <span class='Operator'>= </span><a href="sha2.c.html#LN636"><span class='Ref_To_Local'>c</span></a> <span class='Operator'>= </span><a href="sha2.c.html#LN637"><span class='Ref_To_Local'>d</span></a> <span class='Operator'>= </span><a href="sha2.c.html#LN638"><span class='Ref_To_Local'>e</span></a> <span class='Operator'>= </span><a href="sha2.c.html#LN639"><span class='Ref_To_Local'>f</span></a> <span class='Operator'>= </span><a href="sha2.c.html#LN640"><span class='Ref_To_Local'>g</span></a> <span class='Operator'>= </span><a href="sha2.c.html#LN641"><span class='Ref_To_Local'>h</span></a> <span class='Operator'>= </span><a href="sha2.c.html#LN644"><span class='Ref_To_Local'>T1</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end SHA512_Transform &raquo; </span> 
<span class='Directive'>#else</span>                           <span class='Comment_Single_Line'>/* SHA2_UNROLL_TRANSFORM */ 
</span> 
<span class='Keyword'>static void 
</span><a name="LN700"></a><span class='Declare_Function'>SHA512_Transform</span><span class='Parentheses'>(</span><a href="../include/common/sha2.h.html#LN83"><span class='Ref_to_Struct'>pg_sha512_ctx</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>context</span><span class='Delimiter'>, </span><span class='Keyword'>const </span><a href="../include/c.h.html#LN265"><span class='Ref_to_Typedef'>uint8</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>data</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN702"></a>    <a href="../include/c.h.html#LN297"><span class='Ref_to_Typedef'>uint64</span></a>      <span class='Declare_Local'>a</span><span class='Delimiter'>, 
</span><a name="LN703"></a>                <span class='Declare_Local'>b</span><span class='Delimiter'>, 
</span><a name="LN704"></a>                <span class='Declare_Local'>c</span><span class='Delimiter'>, 
</span><a name="LN705"></a>                <span class='Declare_Local'>d</span><span class='Delimiter'>, 
</span><a name="LN706"></a>                <span class='Declare_Local'>e</span><span class='Delimiter'>, 
</span><a name="LN707"></a>                <span class='Declare_Local'>f</span><span class='Delimiter'>, 
</span><a name="LN708"></a>                <span class='Declare_Local'>g</span><span class='Delimiter'>, 
</span><a name="LN709"></a>                <span class='Declare_Local'>h</span><span class='Delimiter'>, 
</span><a name="LN710"></a>                <span class='Declare_Local'>s0</span><span class='Delimiter'>, 
</span><a name="LN711"></a>                <span class='Declare_Local'>s1</span><span class='Delimiter'>; 
</span><a name="LN712"></a>    <a href="../include/c.h.html#LN297"><span class='Ref_to_Typedef'>uint64</span></a>      <span class='Declare_Local'>T1</span><span class='Delimiter'>, 
</span><a name="LN713"></a>                <span class='Declare_Local'>T2</span><span class='Delimiter'>, 
</span><a name="LN714"></a>               <span class='Operator'>*</span><span class='Declare_Local'>W512</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../include/c.h.html#LN297"><span class='Ref_to_Typedef'>uint64</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="sha2.c.html#LN700"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN87"><span class='Ref_to_Member'>buffer</span></a><span class='Delimiter'>; 
</span><a name="LN715"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>j</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Initialize registers with the prev. intermediate value */ 
</span>    <a href="sha2.c.html#LN702"><span class='Ref_To_Local'>a</span></a> <span class='Operator'>= </span><a href="sha2.c.html#LN700"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN85"><span class='Ref_to_Member'>state</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>]; 
</span>    <a href="sha2.c.html#LN703"><span class='Ref_To_Local'>b</span></a> <span class='Operator'>= </span><a href="sha2.c.html#LN700"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN85"><span class='Ref_to_Member'>state</span></a><span class='Delimiter'>[</span><span class='Number'>1</span><span class='Delimiter'>]; 
</span>    <a href="sha2.c.html#LN704"><span class='Ref_To_Local'>c</span></a> <span class='Operator'>= </span><a href="sha2.c.html#LN700"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN85"><span class='Ref_to_Member'>state</span></a><span class='Delimiter'>[</span><span class='Number'>2</span><span class='Delimiter'>]; 
</span>    <a href="sha2.c.html#LN705"><span class='Ref_To_Local'>d</span></a> <span class='Operator'>= </span><a href="sha2.c.html#LN700"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN85"><span class='Ref_to_Member'>state</span></a><span class='Delimiter'>[</span><span class='Number'>3</span><span class='Delimiter'>]; 
</span>    <a href="sha2.c.html#LN706"><span class='Ref_To_Local'>e</span></a> <span class='Operator'>= </span><a href="sha2.c.html#LN700"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN85"><span class='Ref_to_Member'>state</span></a><span class='Delimiter'>[</span><span class='Number'>4</span><span class='Delimiter'>]; 
</span>    <a href="sha2.c.html#LN707"><span class='Ref_To_Local'>f</span></a> <span class='Operator'>= </span><a href="sha2.c.html#LN700"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN85"><span class='Ref_to_Member'>state</span></a><span class='Delimiter'>[</span><span class='Number'>5</span><span class='Delimiter'>]; 
</span>    <a href="sha2.c.html#LN708"><span class='Ref_To_Local'>g</span></a> <span class='Operator'>= </span><a href="sha2.c.html#LN700"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN85"><span class='Ref_to_Member'>state</span></a><span class='Delimiter'>[</span><span class='Number'>6</span><span class='Delimiter'>]; 
</span>    <a href="sha2.c.html#LN709"><span class='Ref_To_Local'>h</span></a> <span class='Operator'>= </span><a href="sha2.c.html#LN700"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN85"><span class='Ref_to_Member'>state</span></a><span class='Delimiter'>[</span><span class='Number'>7</span><span class='Delimiter'>]; 
</span> 
    <a href="sha2.c.html#LN715"><span class='Ref_To_Local'>j</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <span class='Control'>do</span> 
    <span class='Delimiter'>{ 
</span>        <a href="sha2.c.html#LN714"><span class='Ref_To_Local'>W512</span></a><span class='Delimiter'>[</span><a href="sha2.c.html#LN715"><span class='Ref_To_Local'>j</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../include/c.h.html#LN297"><span class='Ref_to_Typedef'>uint64</span></a><span class='Parentheses'>) </span><a href="sha2.c.html#LN700"><span class='Ref_to_Parameter'>data</span></a><span class='Delimiter'>[</span><span class='Number'>7</span><span class='Delimiter'>] </span><span class='Operator'>| </span><span class='Parentheses'>((</span><a href="../include/c.h.html#LN297"><span class='Ref_to_Typedef'>uint64</span></a><span class='Parentheses'>) </span><a href="sha2.c.html#LN700"><span class='Ref_to_Parameter'>data</span></a><span class='Delimiter'>[</span><span class='Number'>6</span><span class='Delimiter'>] </span><span class='Operator'>&LT;&LT; </span><span class='Number'>8</span><span class='Parentheses'>)</span> <span class='Operator'>| 
</span>            <span class='Parentheses'>((</span><a href="../include/c.h.html#LN297"><span class='Ref_to_Typedef'>uint64</span></a><span class='Parentheses'>) </span><a href="sha2.c.html#LN700"><span class='Ref_to_Parameter'>data</span></a><span class='Delimiter'>[</span><span class='Number'>5</span><span class='Delimiter'>] </span><span class='Operator'>&LT;&LT; </span><span class='Number'>16</span><span class='Parentheses'>)</span> <span class='Operator'>| </span><span class='Parentheses'>((</span><a href="../include/c.h.html#LN297"><span class='Ref_to_Typedef'>uint64</span></a><span class='Parentheses'>) </span><a href="sha2.c.html#LN700"><span class='Ref_to_Parameter'>data</span></a><span class='Delimiter'>[</span><span class='Number'>4</span><span class='Delimiter'>] </span><span class='Operator'>&LT;&LT; </span><span class='Number'>24</span><span class='Parentheses'>)</span> <span class='Operator'>| 
</span>            <span class='Parentheses'>((</span><a href="../include/c.h.html#LN297"><span class='Ref_to_Typedef'>uint64</span></a><span class='Parentheses'>) </span><a href="sha2.c.html#LN700"><span class='Ref_to_Parameter'>data</span></a><span class='Delimiter'>[</span><span class='Number'>3</span><span class='Delimiter'>] </span><span class='Operator'>&LT;&LT; </span><span class='Number'>32</span><span class='Parentheses'>)</span> <span class='Operator'>| </span><span class='Parentheses'>((</span><a href="../include/c.h.html#LN297"><span class='Ref_to_Typedef'>uint64</span></a><span class='Parentheses'>) </span><a href="sha2.c.html#LN700"><span class='Ref_to_Parameter'>data</span></a><span class='Delimiter'>[</span><span class='Number'>2</span><span class='Delimiter'>] </span><span class='Operator'>&LT;&LT; </span><span class='Number'>40</span><span class='Parentheses'>)</span> <span class='Operator'>| 
</span>            <span class='Parentheses'>((</span><a href="../include/c.h.html#LN297"><span class='Ref_to_Typedef'>uint64</span></a><span class='Parentheses'>) </span><a href="sha2.c.html#LN700"><span class='Ref_to_Parameter'>data</span></a><span class='Delimiter'>[</span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>&LT;&LT; </span><span class='Number'>48</span><span class='Parentheses'>)</span> <span class='Operator'>| </span><span class='Parentheses'>((</span><a href="../include/c.h.html#LN297"><span class='Ref_to_Typedef'>uint64</span></a><span class='Parentheses'>) </span><a href="sha2.c.html#LN700"><span class='Ref_to_Parameter'>data</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>] </span><span class='Operator'>&LT;&LT; </span><span class='Number'>56</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="sha2.c.html#LN700"><span class='Ref_to_Parameter'>data</span></a> <span class='Operator'>+= </span><span class='Number'>8</span><span class='Delimiter'>; 
</span>        <span class='Comment_Multi_Line'>/* Apply the SHA-512 compression function to update a..h */ 
</span>        <a href="sha2.c.html#LN712"><span class='Ref_To_Local'>T1</span></a> <span class='Operator'>= </span><a href="sha2.c.html#LN709"><span class='Ref_To_Local'>h</span></a> <span class='Operator'>+ </span><a href="sha2.c.html#LN138"><span class='Ref_to_Macro'>Sigma1_512</span></a><span class='Parentheses'>(</span><a href="sha2.c.html#LN706"><span class='Ref_To_Local'>e</span></a><span class='Parentheses'>) </span><span class='Operator'>+ </span><a href="sha2.c.html#LN127"><span class='Ref_to_Macro'>Ch</span></a><span class='Parentheses'>(</span><a href="sha2.c.html#LN706"><span class='Ref_To_Local'>e</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN707"><span class='Ref_To_Local'>f</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN708"><span class='Ref_To_Local'>g</span></a><span class='Parentheses'>) </span><span class='Operator'>+ </span><a href="sha2.c.html#LN197"><span class='Ref_to_Global_Var'>K512</span></a><span class='Delimiter'>[</span><a href="sha2.c.html#LN715"><span class='Ref_To_Local'>j</span></a><span class='Delimiter'>] </span><span class='Operator'>+ </span><a href="sha2.c.html#LN714"><span class='Ref_To_Local'>W512</span></a><span class='Delimiter'>[</span><a href="sha2.c.html#LN715"><span class='Ref_To_Local'>j</span></a><span class='Delimiter'>]; 
</span>        <a href="sha2.c.html#LN713"><span class='Ref_To_Local'>T2</span></a> <span class='Operator'>= </span><a href="sha2.c.html#LN137"><span class='Ref_to_Macro'>Sigma0_512</span></a><span class='Parentheses'>(</span><a href="sha2.c.html#LN702"><span class='Ref_To_Local'>a</span></a><span class='Parentheses'>) </span><span class='Operator'>+ </span><a href="sha2.c.html#LN128"><span class='Ref_to_Macro'>Maj</span></a><span class='Parentheses'>(</span><a href="sha2.c.html#LN702"><span class='Ref_To_Local'>a</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN703"><span class='Ref_To_Local'>b</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN704"><span class='Ref_To_Local'>c</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="sha2.c.html#LN709"><span class='Ref_To_Local'>h</span></a> <span class='Operator'>= </span><a href="sha2.c.html#LN708"><span class='Ref_To_Local'>g</span></a><span class='Delimiter'>; 
</span>        <a href="sha2.c.html#LN708"><span class='Ref_To_Local'>g</span></a> <span class='Operator'>= </span><a href="sha2.c.html#LN707"><span class='Ref_To_Local'>f</span></a><span class='Delimiter'>; 
</span>        <a href="sha2.c.html#LN707"><span class='Ref_To_Local'>f</span></a> <span class='Operator'>= </span><a href="sha2.c.html#LN706"><span class='Ref_To_Local'>e</span></a><span class='Delimiter'>; 
</span>        <a href="sha2.c.html#LN706"><span class='Ref_To_Local'>e</span></a> <span class='Operator'>= </span><a href="sha2.c.html#LN705"><span class='Ref_To_Local'>d</span></a> <span class='Operator'>+ </span><a href="sha2.c.html#LN712"><span class='Ref_To_Local'>T1</span></a><span class='Delimiter'>; 
</span>        <a href="sha2.c.html#LN705"><span class='Ref_To_Local'>d</span></a> <span class='Operator'>= </span><a href="sha2.c.html#LN704"><span class='Ref_To_Local'>c</span></a><span class='Delimiter'>; 
</span>        <a href="sha2.c.html#LN704"><span class='Ref_To_Local'>c</span></a> <span class='Operator'>= </span><a href="sha2.c.html#LN703"><span class='Ref_To_Local'>b</span></a><span class='Delimiter'>; 
</span>        <a href="sha2.c.html#LN703"><span class='Ref_To_Local'>b</span></a> <span class='Operator'>= </span><a href="sha2.c.html#LN702"><span class='Ref_To_Local'>a</span></a><span class='Delimiter'>; 
</span>        <a href="sha2.c.html#LN702"><span class='Ref_To_Local'>a</span></a> <span class='Operator'>= </span><a href="sha2.c.html#LN712"><span class='Ref_To_Local'>T1</span></a> <span class='Operator'>+ </span><a href="sha2.c.html#LN713"><span class='Ref_To_Local'>T2</span></a><span class='Delimiter'>; 
</span> 
        <a href="sha2.c.html#LN715"><span class='Ref_To_Local'>j</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end do &raquo; </span> <span class='Control'>while</span> <span class='Parentheses'>(</span><a href="sha2.c.html#LN715"><span class='Ref_To_Local'>j</span></a> <span class='Operator'>&LT; </span><span class='Number'>16</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>do</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* Part of the message block expansion: */ 
</span>        <a href="sha2.c.html#LN710"><span class='Ref_To_Local'>s0</span></a> <span class='Operator'>= </span><a href="sha2.c.html#LN714"><span class='Ref_To_Local'>W512</span></a><span class='Delimiter'>[</span><span class='Parentheses'>(</span><a href="sha2.c.html#LN715"><span class='Ref_To_Local'>j</span></a> <span class='Operator'>+ </span><span class='Number'>1</span><span class='Parentheses'>) </span><span class='Operator'>& </span><span class='Number'>0x0f</span><span class='Delimiter'>]; 
</span>        <a href="sha2.c.html#LN710"><span class='Ref_To_Local'>s0</span></a> <span class='Operator'>= </span><a href="sha2.c.html#LN139"><span class='Ref_to_Macro'>sigma0_512</span></a><span class='Parentheses'>(</span><a href="sha2.c.html#LN710"><span class='Ref_To_Local'>s0</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="sha2.c.html#LN711"><span class='Ref_To_Local'>s1</span></a> <span class='Operator'>= </span><a href="sha2.c.html#LN714"><span class='Ref_To_Local'>W512</span></a><span class='Delimiter'>[</span><span class='Parentheses'>(</span><a href="sha2.c.html#LN715"><span class='Ref_To_Local'>j</span></a> <span class='Operator'>+ </span><span class='Number'>14</span><span class='Parentheses'>) </span><span class='Operator'>& </span><span class='Number'>0x0f</span><span class='Delimiter'>]; 
</span>        <a href="sha2.c.html#LN711"><span class='Ref_To_Local'>s1</span></a> <span class='Operator'>= </span><a href="sha2.c.html#LN140"><span class='Ref_to_Macro'>sigma1_512</span></a><span class='Parentheses'>(</span><a href="sha2.c.html#LN711"><span class='Ref_To_Local'>s1</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* Apply the SHA-512 compression function to update a..h */ 
</span>        <a href="sha2.c.html#LN712"><span class='Ref_To_Local'>T1</span></a> <span class='Operator'>= </span><a href="sha2.c.html#LN709"><span class='Ref_To_Local'>h</span></a> <span class='Operator'>+ </span><a href="sha2.c.html#LN138"><span class='Ref_to_Macro'>Sigma1_512</span></a><span class='Parentheses'>(</span><a href="sha2.c.html#LN706"><span class='Ref_To_Local'>e</span></a><span class='Parentheses'>) </span><span class='Operator'>+ </span><a href="sha2.c.html#LN127"><span class='Ref_to_Macro'>Ch</span></a><span class='Parentheses'>(</span><a href="sha2.c.html#LN706"><span class='Ref_To_Local'>e</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN707"><span class='Ref_To_Local'>f</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN708"><span class='Ref_To_Local'>g</span></a><span class='Parentheses'>) </span><span class='Operator'>+ </span><a href="sha2.c.html#LN197"><span class='Ref_to_Global_Var'>K512</span></a><span class='Delimiter'>[</span><a href="sha2.c.html#LN715"><span class='Ref_To_Local'>j</span></a><span class='Delimiter'>] </span><span class='Operator'>+ 
</span>            <span class='Parentheses'>(</span><a href="sha2.c.html#LN714"><span class='Ref_To_Local'>W512</span></a><span class='Delimiter'>[</span><a href="sha2.c.html#LN715"><span class='Ref_To_Local'>j</span></a> <span class='Operator'>& </span><span class='Number'>0x0f</span><span class='Delimiter'>] </span><span class='Operator'>+= </span><a href="sha2.c.html#LN711"><span class='Ref_To_Local'>s1</span></a> <span class='Operator'>+ </span><a href="sha2.c.html#LN714"><span class='Ref_To_Local'>W512</span></a><span class='Delimiter'>[</span><span class='Parentheses'>(</span><a href="sha2.c.html#LN715"><span class='Ref_To_Local'>j</span></a> <span class='Operator'>+ </span><span class='Number'>9</span><span class='Parentheses'>) </span><span class='Operator'>& </span><span class='Number'>0x0f</span><span class='Delimiter'>] </span><span class='Operator'>+ </span><a href="sha2.c.html#LN710"><span class='Ref_To_Local'>s0</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="sha2.c.html#LN713"><span class='Ref_To_Local'>T2</span></a> <span class='Operator'>= </span><a href="sha2.c.html#LN137"><span class='Ref_to_Macro'>Sigma0_512</span></a><span class='Parentheses'>(</span><a href="sha2.c.html#LN702"><span class='Ref_To_Local'>a</span></a><span class='Parentheses'>) </span><span class='Operator'>+ </span><a href="sha2.c.html#LN128"><span class='Ref_to_Macro'>Maj</span></a><span class='Parentheses'>(</span><a href="sha2.c.html#LN702"><span class='Ref_To_Local'>a</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN703"><span class='Ref_To_Local'>b</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN704"><span class='Ref_To_Local'>c</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="sha2.c.html#LN709"><span class='Ref_To_Local'>h</span></a> <span class='Operator'>= </span><a href="sha2.c.html#LN708"><span class='Ref_To_Local'>g</span></a><span class='Delimiter'>; 
</span>        <a href="sha2.c.html#LN708"><span class='Ref_To_Local'>g</span></a> <span class='Operator'>= </span><a href="sha2.c.html#LN707"><span class='Ref_To_Local'>f</span></a><span class='Delimiter'>; 
</span>        <a href="sha2.c.html#LN707"><span class='Ref_To_Local'>f</span></a> <span class='Operator'>= </span><a href="sha2.c.html#LN706"><span class='Ref_To_Local'>e</span></a><span class='Delimiter'>; 
</span>        <a href="sha2.c.html#LN706"><span class='Ref_To_Local'>e</span></a> <span class='Operator'>= </span><a href="sha2.c.html#LN705"><span class='Ref_To_Local'>d</span></a> <span class='Operator'>+ </span><a href="sha2.c.html#LN712"><span class='Ref_To_Local'>T1</span></a><span class='Delimiter'>; 
</span>        <a href="sha2.c.html#LN705"><span class='Ref_To_Local'>d</span></a> <span class='Operator'>= </span><a href="sha2.c.html#LN704"><span class='Ref_To_Local'>c</span></a><span class='Delimiter'>; 
</span>        <a href="sha2.c.html#LN704"><span class='Ref_To_Local'>c</span></a> <span class='Operator'>= </span><a href="sha2.c.html#LN703"><span class='Ref_To_Local'>b</span></a><span class='Delimiter'>; 
</span>        <a href="sha2.c.html#LN703"><span class='Ref_To_Local'>b</span></a> <span class='Operator'>= </span><a href="sha2.c.html#LN702"><span class='Ref_To_Local'>a</span></a><span class='Delimiter'>; 
</span>        <a href="sha2.c.html#LN702"><span class='Ref_To_Local'>a</span></a> <span class='Operator'>= </span><a href="sha2.c.html#LN712"><span class='Ref_To_Local'>T1</span></a> <span class='Operator'>+ </span><a href="sha2.c.html#LN713"><span class='Ref_To_Local'>T2</span></a><span class='Delimiter'>; 
</span> 
        <a href="sha2.c.html#LN715"><span class='Ref_To_Local'>j</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end do &raquo; </span> <span class='Control'>while</span> <span class='Parentheses'>(</span><a href="sha2.c.html#LN715"><span class='Ref_To_Local'>j</span></a> <span class='Operator'>&LT; </span><span class='Number'>80</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Compute the current intermediate hash value */ 
</span>    <a href="sha2.c.html#LN700"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN85"><span class='Ref_to_Member'>state</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>] </span><span class='Operator'>+= </span><a href="sha2.c.html#LN702"><span class='Ref_To_Local'>a</span></a><span class='Delimiter'>; 
</span>    <a href="sha2.c.html#LN700"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN85"><span class='Ref_to_Member'>state</span></a><span class='Delimiter'>[</span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>+= </span><a href="sha2.c.html#LN703"><span class='Ref_To_Local'>b</span></a><span class='Delimiter'>; 
</span>    <a href="sha2.c.html#LN700"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN85"><span class='Ref_to_Member'>state</span></a><span class='Delimiter'>[</span><span class='Number'>2</span><span class='Delimiter'>] </span><span class='Operator'>+= </span><a href="sha2.c.html#LN704"><span class='Ref_To_Local'>c</span></a><span class='Delimiter'>; 
</span>    <a href="sha2.c.html#LN700"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN85"><span class='Ref_to_Member'>state</span></a><span class='Delimiter'>[</span><span class='Number'>3</span><span class='Delimiter'>] </span><span class='Operator'>+= </span><a href="sha2.c.html#LN705"><span class='Ref_To_Local'>d</span></a><span class='Delimiter'>; 
</span>    <a href="sha2.c.html#LN700"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN85"><span class='Ref_to_Member'>state</span></a><span class='Delimiter'>[</span><span class='Number'>4</span><span class='Delimiter'>] </span><span class='Operator'>+= </span><a href="sha2.c.html#LN706"><span class='Ref_To_Local'>e</span></a><span class='Delimiter'>; 
</span>    <a href="sha2.c.html#LN700"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN85"><span class='Ref_to_Member'>state</span></a><span class='Delimiter'>[</span><span class='Number'>5</span><span class='Delimiter'>] </span><span class='Operator'>+= </span><a href="sha2.c.html#LN707"><span class='Ref_To_Local'>f</span></a><span class='Delimiter'>; 
</span>    <a href="sha2.c.html#LN700"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN85"><span class='Ref_to_Member'>state</span></a><span class='Delimiter'>[</span><span class='Number'>6</span><span class='Delimiter'>] </span><span class='Operator'>+= </span><a href="sha2.c.html#LN708"><span class='Ref_To_Local'>g</span></a><span class='Delimiter'>; 
</span>    <a href="sha2.c.html#LN700"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN85"><span class='Ref_to_Member'>state</span></a><span class='Delimiter'>[</span><span class='Number'>7</span><span class='Delimiter'>] </span><span class='Operator'>+= </span><a href="sha2.c.html#LN709"><span class='Ref_To_Local'>h</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Clean up */ 
</span>    <a href="sha2.c.html#LN702"><span class='Ref_To_Local'>a</span></a> <span class='Operator'>= </span><a href="sha2.c.html#LN703"><span class='Ref_To_Local'>b</span></a> <span class='Operator'>= </span><a href="sha2.c.html#LN704"><span class='Ref_To_Local'>c</span></a> <span class='Operator'>= </span><a href="sha2.c.html#LN705"><span class='Ref_To_Local'>d</span></a> <span class='Operator'>= </span><a href="sha2.c.html#LN706"><span class='Ref_To_Local'>e</span></a> <span class='Operator'>= </span><a href="sha2.c.html#LN707"><span class='Ref_To_Local'>f</span></a> <span class='Operator'>= </span><a href="sha2.c.html#LN708"><span class='Ref_To_Local'>g</span></a> <span class='Operator'>= </span><a href="sha2.c.html#LN709"><span class='Ref_To_Local'>h</span></a> <span class='Operator'>= </span><a href="sha2.c.html#LN712"><span class='Ref_To_Local'>T1</span></a> <span class='Operator'>= </span><a href="sha2.c.html#LN713"><span class='Ref_To_Local'>T2</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end SHA512_Transform &raquo; </span> 
<span class='Directive'>#endif</span>   <span class='Comment_Single_Line'>/* SHA2_UNROLL_TRANSFORM */ 
</span> 
<span class='Keyword'>void 
</span><a name="LN790"></a><span class='Declare_Function'>pg_sha512_update</span><span class='Parentheses'>(</span><a href="../include/common/sha2.h.html#LN83"><span class='Ref_to_Struct'>pg_sha512_ctx</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>context</span><span class='Delimiter'>, </span><span class='Keyword'>const </span><a href="../include/c.h.html#LN265"><span class='Ref_to_Typedef'>uint8</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>data</span><span class='Delimiter'>, </span>size_t <span class='Declare_Parameter'>len</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN792"></a>    size_t      <span class='Declare_Local'>freespace</span><span class='Delimiter'>, 
</span><a name="LN793"></a>                <span class='Declare_Local'>usedspace</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Calling with no data is valid (we do nothing) */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="sha2.c.html#LN790"><span class='Ref_to_Parameter'>len</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>        <span class='Control'>return</span><span class='Delimiter'>; 
</span> 
    <a href="sha2.c.html#LN793"><span class='Ref_To_Local'>usedspace</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="sha2.c.html#LN790"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN86"><span class='Ref_to_Member'>bitcount</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>] </span><span class='Operator'>&GT;&GT; </span><span class='Number'>3</span><span class='Parentheses'>) </span><span class='Operator'>% </span><a href="../include/common/sha2.h.html#LN66"><span class='Ref_to_Const'>PG_SHA512_BLOCK_LENGTH</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="sha2.c.html#LN793"><span class='Ref_To_Local'>usedspace</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* Calculate how much free space is available in the buffer */ 
</span>        <a href="sha2.c.html#LN792"><span class='Ref_To_Local'>freespace</span></a> <span class='Operator'>= </span><a href="../include/common/sha2.h.html#LN66"><span class='Ref_to_Const'>PG_SHA512_BLOCK_LENGTH</span></a> <span class='Operator'>- </span><a href="sha2.c.html#LN793"><span class='Ref_To_Local'>usedspace</span></a><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="sha2.c.html#LN790"><span class='Ref_to_Parameter'>len</span></a> <span class='Operator'>&GT;= </span><a href="sha2.c.html#LN792"><span class='Ref_To_Local'>freespace</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* Fill the buffer completely and process it */ 
</span>            memcpy<span class='Parentheses'>(</span><span class='Operator'>&</span><a href="sha2.c.html#LN790"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN87"><span class='Ref_to_Member'>buffer</span></a><span class='Delimiter'>[</span><a href="sha2.c.html#LN793"><span class='Ref_To_Local'>usedspace</span></a><span class='Delimiter'>], </span><a href="sha2.c.html#LN790"><span class='Ref_to_Parameter'>data</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN792"><span class='Ref_To_Local'>freespace</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="sha2.c.html#LN103"><span class='Ref_to_Macro'>ADDINC128</span></a><span class='Parentheses'>(</span><a href="sha2.c.html#LN790"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN86"><span class='Ref_to_Member'>bitcount</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN792"><span class='Ref_To_Local'>freespace</span></a> <span class='Operator'>&LT;&LT; </span><span class='Number'>3</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="sha2.c.html#LN790"><span class='Ref_to_Parameter'>len</span></a> <span class='Operator'>-= </span><a href="sha2.c.html#LN792"><span class='Ref_To_Local'>freespace</span></a><span class='Delimiter'>; 
</span>            <a href="sha2.c.html#LN790"><span class='Ref_to_Parameter'>data</span></a> <span class='Operator'>+= </span><a href="sha2.c.html#LN792"><span class='Ref_To_Local'>freespace</span></a><span class='Delimiter'>; 
</span>            <a href="sha2.c.html#LN149"><span class='Ref_to_Proto'>SHA512_Transform</span></a><span class='Parentheses'>(</span><a href="sha2.c.html#LN790"><span class='Ref_to_Parameter'>context</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN790"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN87"><span class='Ref_to_Member'>buffer</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* The buffer is not yet full */ 
</span>            memcpy<span class='Parentheses'>(</span><span class='Operator'>&</span><a href="sha2.c.html#LN790"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN87"><span class='Ref_to_Member'>buffer</span></a><span class='Delimiter'>[</span><a href="sha2.c.html#LN793"><span class='Ref_To_Local'>usedspace</span></a><span class='Delimiter'>], </span><a href="sha2.c.html#LN790"><span class='Ref_to_Parameter'>data</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN790"><span class='Ref_to_Parameter'>len</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="sha2.c.html#LN103"><span class='Ref_to_Macro'>ADDINC128</span></a><span class='Parentheses'>(</span><a href="sha2.c.html#LN790"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN86"><span class='Ref_to_Member'>bitcount</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN790"><span class='Ref_to_Parameter'>len</span></a> <span class='Operator'>&LT;&LT; </span><span class='Number'>3</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Comment_Multi_Line'>/* Clean up: */ 
</span>            <a href="sha2.c.html#LN793"><span class='Ref_To_Local'>usedspace</span></a> <span class='Operator'>= </span><a href="sha2.c.html#LN792"><span class='Ref_To_Local'>freespace</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>            <span class='Control'>return</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if usedspace&GT;0 &raquo; </span> 
    <span class='Control'>while</span> <span class='Parentheses'>(</span><a href="sha2.c.html#LN790"><span class='Ref_to_Parameter'>len</span></a> <span class='Operator'>&GT;= </span><a href="../include/common/sha2.h.html#LN66"><span class='Ref_to_Const'>PG_SHA512_BLOCK_LENGTH</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* Process as many complete blocks as we can */ 
</span>        <a href="sha2.c.html#LN149"><span class='Ref_to_Proto'>SHA512_Transform</span></a><span class='Parentheses'>(</span><a href="sha2.c.html#LN790"><span class='Ref_to_Parameter'>context</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN790"><span class='Ref_to_Parameter'>data</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="sha2.c.html#LN103"><span class='Ref_to_Macro'>ADDINC128</span></a><span class='Parentheses'>(</span><a href="sha2.c.html#LN790"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN86"><span class='Ref_to_Member'>bitcount</span></a><span class='Delimiter'>, </span><a href="../include/common/sha2.h.html#LN66"><span class='Ref_to_Const'>PG_SHA512_BLOCK_LENGTH</span></a> <span class='Operator'>&LT;&LT; </span><span class='Number'>3</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="sha2.c.html#LN790"><span class='Ref_to_Parameter'>len</span></a> <span class='Operator'>-= </span><a href="../include/common/sha2.h.html#LN66"><span class='Ref_to_Const'>PG_SHA512_BLOCK_LENGTH</span></a><span class='Delimiter'>; 
</span>        <a href="sha2.c.html#LN790"><span class='Ref_to_Parameter'>data</span></a> <span class='Operator'>+= </span><a href="../include/common/sha2.h.html#LN66"><span class='Ref_to_Const'>PG_SHA512_BLOCK_LENGTH</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="sha2.c.html#LN790"><span class='Ref_to_Parameter'>len</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* There's left-overs, so save 'em */ 
</span>        memcpy<span class='Parentheses'>(</span><a href="sha2.c.html#LN790"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN87"><span class='Ref_to_Member'>buffer</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN790"><span class='Ref_to_Parameter'>data</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN790"><span class='Ref_to_Parameter'>len</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="sha2.c.html#LN103"><span class='Ref_to_Macro'>ADDINC128</span></a><span class='Parentheses'>(</span><a href="sha2.c.html#LN790"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN86"><span class='Ref_to_Member'>bitcount</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN790"><span class='Ref_to_Parameter'>len</span></a> <span class='Operator'>&LT;&LT; </span><span class='Number'>3</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Comment_Multi_Line'>/* Clean up: */ 
</span>    <a href="sha2.c.html#LN793"><span class='Ref_To_Local'>usedspace</span></a> <span class='Operator'>= </span><a href="sha2.c.html#LN792"><span class='Ref_To_Local'>freespace</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end pg_sha512_update &raquo; </span> 
 
<span class='Keyword'>static void 
</span><a name="LN843"></a><span class='Declare_Function'>SHA512_Last</span><span class='Parentheses'>(</span><a href="../include/common/sha2.h.html#LN83"><span class='Ref_to_Struct'>pg_sha512_ctx</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>context</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN845"></a>    <span class='Keyword'>unsigned int </span><span class='Declare_Local'>usedspace</span><span class='Delimiter'>; 
</span> 
    <a href="sha2.c.html#LN845"><span class='Ref_To_Local'>usedspace</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="sha2.c.html#LN843"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN86"><span class='Ref_to_Member'>bitcount</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>] </span><span class='Operator'>&GT;&GT; </span><span class='Number'>3</span><span class='Parentheses'>) </span><span class='Operator'>% </span><a href="../include/common/sha2.h.html#LN66"><span class='Ref_to_Const'>PG_SHA512_BLOCK_LENGTH</span></a><span class='Delimiter'>; 
</span><span class='Directive'>#ifndef</span> WORDS_BIGENDIAN 
    <span class='Comment_Multi_Line'>/* Convert FROM host byte order */ 
</span>    <a href="sha2.c.html#LN88"><span class='Ref_to_Macro'>REVERSE64</span></a><span class='Parentheses'>(</span><a href="sha2.c.html#LN843"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN86"><span class='Ref_to_Member'>bitcount</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>], </span><a href="sha2.c.html#LN843"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN86"><span class='Ref_to_Member'>bitcount</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>]</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="sha2.c.html#LN88"><span class='Ref_to_Macro'>REVERSE64</span></a><span class='Parentheses'>(</span><a href="sha2.c.html#LN843"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN86"><span class='Ref_to_Member'>bitcount</span></a><span class='Delimiter'>[</span><span class='Number'>1</span><span class='Delimiter'>], </span><a href="sha2.c.html#LN843"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN86"><span class='Ref_to_Member'>bitcount</span></a><span class='Delimiter'>[</span><span class='Number'>1</span><span class='Delimiter'>]</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><span class='Directive'>#endif</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="sha2.c.html#LN845"><span class='Ref_To_Local'>usedspace</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* Begin padding with a 1 bit: */ 
</span>        <a href="sha2.c.html#LN843"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN87"><span class='Ref_to_Member'>buffer</span></a><span class='Delimiter'>[</span><a href="sha2.c.html#LN845"><span class='Ref_To_Local'>usedspace</span></a><span class='Operator'>++</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Number'>0x80</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="sha2.c.html#LN845"><span class='Ref_To_Local'>usedspace</span></a> <span class='Operator'>&LT;= </span><a href="sha2.c.html#LN79"><span class='Ref_to_Const'>PG_SHA512_SHORT_BLOCK_LENGTH</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* Set-up for the last transform: */ 
</span>            memset<span class='Parentheses'>(</span><span class='Operator'>&</span><a href="sha2.c.html#LN843"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN87"><span class='Ref_to_Member'>buffer</span></a><span class='Delimiter'>[</span><a href="sha2.c.html#LN845"><span class='Ref_To_Local'>usedspace</span></a><span class='Delimiter'>], </span><span class='Number'>0</span><span class='Delimiter'>, </span><a href="sha2.c.html#LN79"><span class='Ref_to_Const'>PG_SHA512_SHORT_BLOCK_LENGTH</span></a> <span class='Operator'>- </span><a href="sha2.c.html#LN845"><span class='Ref_To_Local'>usedspace</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="sha2.c.html#LN845"><span class='Ref_To_Local'>usedspace</span></a> <span class='Operator'>&LT; </span><a href="../include/common/sha2.h.html#LN66"><span class='Ref_to_Const'>PG_SHA512_BLOCK_LENGTH</span></a><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                memset<span class='Parentheses'>(</span><span class='Operator'>&</span><a href="sha2.c.html#LN843"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN87"><span class='Ref_to_Member'>buffer</span></a><span class='Delimiter'>[</span><a href="sha2.c.html#LN845"><span class='Ref_To_Local'>usedspace</span></a><span class='Delimiter'>], </span><span class='Number'>0</span><span class='Delimiter'>, </span><a href="../include/common/sha2.h.html#LN66"><span class='Ref_to_Const'>PG_SHA512_BLOCK_LENGTH</span></a> <span class='Operator'>- </span><a href="sha2.c.html#LN845"><span class='Ref_To_Local'>usedspace</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>            <span class='Comment_Multi_Line'>/* Do second-to-last transform: */ 
</span>            <a href="sha2.c.html#LN149"><span class='Ref_to_Proto'>SHA512_Transform</span></a><span class='Parentheses'>(</span><a href="sha2.c.html#LN843"><span class='Ref_to_Parameter'>context</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN843"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN87"><span class='Ref_to_Member'>buffer</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <span class='Comment_Multi_Line'>/* And set-up for the last transform: */ 
</span>            memset<span class='Parentheses'>(</span><a href="sha2.c.html#LN843"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN87"><span class='Ref_to_Member'>buffer</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Delimiter'>, </span><a href="../include/common/sha2.h.html#LN66"><span class='Ref_to_Const'>PG_SHA512_BLOCK_LENGTH</span></a> <span class='Operator'>- </span><span class='Number'>2</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if usedspace&GT;0 &raquo; </span> 
    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* Prepare for final transform: */ 
</span>        memset<span class='Parentheses'>(</span><a href="sha2.c.html#LN843"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN87"><span class='Ref_to_Member'>buffer</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Delimiter'>, </span><a href="sha2.c.html#LN79"><span class='Ref_to_Const'>PG_SHA512_SHORT_BLOCK_LENGTH</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* Begin padding with a 1 bit: */ 
</span>        <span class='Operator'>*</span><a href="sha2.c.html#LN843"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN87"><span class='Ref_to_Member'>buffer</span></a> <span class='Operator'>= </span><span class='Number'>0x80</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Comment_Multi_Line'>/* Store the length of input data (in bits): */ 
</span>    <span class='Operator'>*</span><span class='Parentheses'>(</span><a href="../include/c.h.html#LN297"><span class='Ref_to_Typedef'>uint64</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><span class='Operator'>&</span><a href="sha2.c.html#LN843"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN87"><span class='Ref_to_Member'>buffer</span></a><span class='Delimiter'>[</span><a href="sha2.c.html#LN79"><span class='Ref_to_Const'>PG_SHA512_SHORT_BLOCK_LENGTH</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="sha2.c.html#LN843"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN86"><span class='Ref_to_Member'>bitcount</span></a><span class='Delimiter'>[</span><span class='Number'>1</span><span class='Delimiter'>]; 
</span>    <span class='Operator'>*</span><span class='Parentheses'>(</span><a href="../include/c.h.html#LN297"><span class='Ref_to_Typedef'>uint64</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><span class='Operator'>&</span><a href="sha2.c.html#LN843"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN87"><span class='Ref_to_Member'>buffer</span></a><span class='Delimiter'>[</span><a href="sha2.c.html#LN79"><span class='Ref_to_Const'>PG_SHA512_SHORT_BLOCK_LENGTH</span></a> <span class='Operator'>+ </span><span class='Number'>8</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="sha2.c.html#LN843"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN86"><span class='Ref_to_Member'>bitcount</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>]; 
</span> 
    <span class='Comment_Multi_Line'>/* Final transform: */ 
</span>    <a href="sha2.c.html#LN149"><span class='Ref_to_Proto'>SHA512_Transform</span></a><span class='Parentheses'>(</span><a href="sha2.c.html#LN843"><span class='Ref_to_Parameter'>context</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN843"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN87"><span class='Ref_to_Member'>buffer</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end SHA512_Last &raquo; </span> 
 
<span class='Keyword'>void 
</span><a name="LN893"></a><span class='Declare_Function'>pg_sha512_final</span><span class='Parentheses'>(</span><a href="../include/common/sha2.h.html#LN83"><span class='Ref_to_Struct'>pg_sha512_ctx</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>context</span><span class='Delimiter'>, </span><a href="../include/c.h.html#LN265"><span class='Ref_to_Typedef'>uint8</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>digest</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Comment_Multi_Line'>/* If no digest buffer is passed, we don't bother doing this: */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="sha2.c.html#LN893"><span class='Ref_to_Parameter'>digest</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="sha2.c.html#LN147"><span class='Ref_to_Proto'>SHA512_Last</span></a><span class='Parentheses'>(</span><a href="sha2.c.html#LN893"><span class='Ref_to_Parameter'>context</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* Save the hash data for output: */ 
</span><span class='Directive'>#ifndef</span> WORDS_BIGENDIAN 
        <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* Convert TO host byte order */ 
</span><a name="LN904"></a>            <span class='Keyword'>int</span>         <span class='Declare_Local'>j</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="sha2.c.html#LN904"><span class='Ref_To_Local'>j</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="sha2.c.html#LN904"><span class='Ref_To_Local'>j</span></a> <span class='Operator'>&LT; </span><span class='Number'>8</span><span class='Delimiter'>; </span><a href="sha2.c.html#LN904"><span class='Ref_To_Local'>j</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <a href="sha2.c.html#LN88"><span class='Ref_to_Macro'>REVERSE64</span></a><span class='Parentheses'>(</span><a href="sha2.c.html#LN893"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN85"><span class='Ref_to_Member'>state</span></a><span class='Delimiter'>[</span><a href="sha2.c.html#LN904"><span class='Ref_To_Local'>j</span></a><span class='Delimiter'>], </span><a href="sha2.c.html#LN893"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN85"><span class='Ref_to_Member'>state</span></a><span class='Delimiter'>[</span><a href="sha2.c.html#LN904"><span class='Ref_To_Local'>j</span></a><span class='Delimiter'>]</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>        <span class='Delimiter'>} 
</span><span class='Directive'>#endif</span> 
        memcpy<span class='Parentheses'>(</span><a href="sha2.c.html#LN893"><span class='Ref_to_Parameter'>digest</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN893"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN85"><span class='Ref_to_Member'>state</span></a><span class='Delimiter'>, </span><a href="../include/common/sha2.h.html#LN67"><span class='Ref_to_Const'>PG_SHA512_DIGEST_LENGTH</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* Zero out state data */ 
</span>    memset<span class='Parentheses'>(</span><a href="sha2.c.html#LN893"><span class='Ref_to_Parameter'>context</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Delimiter'>, </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../include/common/sha2.h.html#LN83"><span class='Ref_to_Struct'>pg_sha512_ctx</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end pg_sha512_final &raquo; </span> 
 
 
<span class='Comment_Multi_Line'>/*** SHA-384: *********************************************************/ 
</span><span class='Keyword'>void 
</span><a name="LN922"></a><span class='Declare_Function'>pg_sha384_init</span><span class='Parentheses'>(</span><a href="../include/common/sha2.h.html#LN90"><span class='Ref_to_Typedef'>pg_sha384_ctx</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>context</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="sha2.c.html#LN922"><span class='Ref_to_Parameter'>context</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>        <span class='Control'>return</span><span class='Delimiter'>; 
</span>    memcpy<span class='Parentheses'>(</span><a href="sha2.c.html#LN922"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN85"><span class='Ref_to_Member'>state</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN241"><span class='Ref_to_Global_Var'>sha384_initial_hash_value</span></a><span class='Delimiter'>, </span><a href="../include/common/sha2.h.html#LN67"><span class='Ref_to_Const'>PG_SHA512_DIGEST_LENGTH</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    memset<span class='Parentheses'>(</span><a href="sha2.c.html#LN922"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN87"><span class='Ref_to_Member'>buffer</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Delimiter'>, </span><a href="../include/common/sha2.h.html#LN63"><span class='Ref_to_Const'>PG_SHA384_BLOCK_LENGTH</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="sha2.c.html#LN922"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN86"><span class='Ref_to_Member'>bitcount</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="sha2.c.html#LN922"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN86"><span class='Ref_to_Member'>bitcount</span></a><span class='Delimiter'>[</span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
} 
</span> 
<span class='Keyword'>void 
</span><a name="LN932"></a><span class='Declare_Function'>pg_sha384_update</span><span class='Parentheses'>(</span><a href="../include/common/sha2.h.html#LN90"><span class='Ref_to_Typedef'>pg_sha384_ctx</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>context</span><span class='Delimiter'>, </span><span class='Keyword'>const </span><a href="../include/c.h.html#LN265"><span class='Ref_to_Typedef'>uint8</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>data</span><span class='Delimiter'>, </span>size_t <span class='Declare_Parameter'>len</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <a href="sha2_openssl.c.html#LN53"><span class='Ref_to_Func'>pg_sha512_update</span></a><span class='Parentheses'>((</span><a href="../include/common/sha2.h.html#LN83"><span class='Ref_to_Struct'>pg_sha512_ctx</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="sha2.c.html#LN932"><span class='Ref_to_Parameter'>context</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN932"><span class='Ref_to_Parameter'>data</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN932"><span class='Ref_to_Parameter'>len</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Keyword'>void 
</span><a name="LN938"></a><span class='Declare_Function'>pg_sha384_final</span><span class='Parentheses'>(</span><a href="../include/common/sha2.h.html#LN90"><span class='Ref_to_Typedef'>pg_sha384_ctx</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>context</span><span class='Delimiter'>, </span><a href="../include/c.h.html#LN265"><span class='Ref_to_Typedef'>uint8</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>digest</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Comment_Multi_Line'>/* If no digest buffer is passed, we don't bother doing this: */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="sha2.c.html#LN938"><span class='Ref_to_Parameter'>digest</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="sha2.c.html#LN147"><span class='Ref_to_Proto'>SHA512_Last</span></a><span class='Parentheses'>((</span><a href="../include/common/sha2.h.html#LN83"><span class='Ref_to_Struct'>pg_sha512_ctx</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="sha2.c.html#LN938"><span class='Ref_to_Parameter'>context</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* Save the hash data for output: */ 
</span><span class='Directive'>#ifndef</span> WORDS_BIGENDIAN 
        <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* Convert TO host byte order */ 
</span><a name="LN949"></a>            <span class='Keyword'>int</span>         <span class='Declare_Local'>j</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="sha2.c.html#LN949"><span class='Ref_To_Local'>j</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="sha2.c.html#LN949"><span class='Ref_To_Local'>j</span></a> <span class='Operator'>&LT; </span><span class='Number'>6</span><span class='Delimiter'>; </span><a href="sha2.c.html#LN949"><span class='Ref_To_Local'>j</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <a href="sha2.c.html#LN88"><span class='Ref_to_Macro'>REVERSE64</span></a><span class='Parentheses'>(</span><a href="sha2.c.html#LN938"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN85"><span class='Ref_to_Member'>state</span></a><span class='Delimiter'>[</span><a href="sha2.c.html#LN949"><span class='Ref_To_Local'>j</span></a><span class='Delimiter'>], </span><a href="sha2.c.html#LN938"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN85"><span class='Ref_to_Member'>state</span></a><span class='Delimiter'>[</span><a href="sha2.c.html#LN949"><span class='Ref_To_Local'>j</span></a><span class='Delimiter'>]</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>        <span class='Delimiter'>} 
</span><span class='Directive'>#endif</span> 
        memcpy<span class='Parentheses'>(</span><a href="sha2.c.html#LN938"><span class='Ref_to_Parameter'>digest</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN938"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN85"><span class='Ref_to_Member'>state</span></a><span class='Delimiter'>, </span><a href="../include/common/sha2.h.html#LN64"><span class='Ref_to_Const'>PG_SHA384_DIGEST_LENGTH</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* Zero out state data */ 
</span>    memset<span class='Parentheses'>(</span><a href="sha2.c.html#LN938"><span class='Ref_to_Parameter'>context</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Delimiter'>, </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../include/common/sha2.h.html#LN90"><span class='Ref_to_Typedef'>pg_sha384_ctx</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end pg_sha384_final &raquo; </span> 
 
<span class='Comment_Multi_Line'>/*** SHA-224: *********************************************************/ 
</span><span class='Keyword'>void 
</span><a name="LN966"></a><span class='Declare_Function'>pg_sha224_init</span><span class='Parentheses'>(</span><a href="../include/common/sha2.h.html#LN89"><span class='Ref_to_Typedef'>pg_sha224_ctx</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>context</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="sha2.c.html#LN966"><span class='Ref_to_Parameter'>context</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>        <span class='Control'>return</span><span class='Delimiter'>; 
</span>    memcpy<span class='Parentheses'>(</span><a href="sha2.c.html#LN966"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN79"><span class='Ref_to_Member'>state</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN173"><span class='Ref_to_Global_Var'>sha224_initial_hash_value</span></a><span class='Delimiter'>, </span><a href="../include/common/sha2.h.html#LN61"><span class='Ref_to_Const'>PG_SHA256_DIGEST_LENGTH</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    memset<span class='Parentheses'>(</span><a href="sha2.c.html#LN966"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN81"><span class='Ref_to_Member'>buffer</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Delimiter'>, </span><a href="../include/common/sha2.h.html#LN60"><span class='Ref_to_Const'>PG_SHA256_BLOCK_LENGTH</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="sha2.c.html#LN966"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN80"><span class='Ref_to_Member'>bitcount</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
} 
</span> 
<span class='Keyword'>void 
</span><a name="LN976"></a><span class='Declare_Function'>pg_sha224_update</span><span class='Parentheses'>(</span><a href="../include/common/sha2.h.html#LN89"><span class='Ref_to_Typedef'>pg_sha224_ctx</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>context</span><span class='Delimiter'>, </span><span class='Keyword'>const </span><a href="../include/c.h.html#LN265"><span class='Ref_to_Typedef'>uint8</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>data</span><span class='Delimiter'>, </span>size_t <span class='Declare_Parameter'>len</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <a href="sha2_openssl.c.html#LN34"><span class='Ref_to_Func'>pg_sha256_update</span></a><span class='Parentheses'>((</span><a href="../include/common/sha2.h.html#LN77"><span class='Ref_to_Struct'>pg_sha256_ctx</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="sha2.c.html#LN976"><span class='Ref_to_Parameter'>context</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN976"><span class='Ref_to_Parameter'>data</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN976"><span class='Ref_to_Parameter'>len</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Keyword'>void 
</span><a name="LN982"></a><span class='Declare_Function'>pg_sha224_final</span><span class='Parentheses'>(</span><a href="../include/common/sha2.h.html#LN89"><span class='Ref_to_Typedef'>pg_sha224_ctx</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>context</span><span class='Delimiter'>, </span><a href="../include/c.h.html#LN265"><span class='Ref_to_Typedef'>uint8</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>digest</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Comment_Multi_Line'>/* If no digest buffer is passed, we don't bother doing this: */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="sha2.c.html#LN982"><span class='Ref_to_Parameter'>digest</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="sha2.c.html#LN516"><span class='Ref_to_Func'>SHA256_Last</span></a><span class='Parentheses'>(</span><a href="sha2.c.html#LN982"><span class='Ref_to_Parameter'>context</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
<span class='Directive'>#ifndef</span> WORDS_BIGENDIAN 
        <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* Convert TO host byte order */ 
</span><a name="LN992"></a>            <span class='Keyword'>int</span>         <span class='Declare_Local'>j</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="sha2.c.html#LN992"><span class='Ref_To_Local'>j</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="sha2.c.html#LN992"><span class='Ref_To_Local'>j</span></a> <span class='Operator'>&LT; </span><span class='Number'>8</span><span class='Delimiter'>; </span><a href="sha2.c.html#LN992"><span class='Ref_To_Local'>j</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <a href="sha2.c.html#LN83"><span class='Ref_to_Macro'>REVERSE32</span></a><span class='Parentheses'>(</span><a href="sha2.c.html#LN982"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN79"><span class='Ref_to_Member'>state</span></a><span class='Delimiter'>[</span><a href="sha2.c.html#LN992"><span class='Ref_To_Local'>j</span></a><span class='Delimiter'>], </span><a href="sha2.c.html#LN982"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN79"><span class='Ref_to_Member'>state</span></a><span class='Delimiter'>[</span><a href="sha2.c.html#LN992"><span class='Ref_To_Local'>j</span></a><span class='Delimiter'>]</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>        <span class='Delimiter'>} 
</span><span class='Directive'>#endif</span> 
        memcpy<span class='Parentheses'>(</span><a href="sha2.c.html#LN982"><span class='Ref_to_Parameter'>digest</span></a><span class='Delimiter'>, </span><a href="sha2.c.html#LN982"><span class='Ref_to_Parameter'>context</span></a><span class='Operator'>-&GT;</span><a href="../include/common/sha2.h.html#LN79"><span class='Ref_to_Member'>state</span></a><span class='Delimiter'>, </span><a href="../include/common/sha2.h.html#LN58"><span class='Ref_to_Const'>PG_SHA224_DIGEST_LENGTH</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* Clean up state data: */ 
</span>    memset<span class='Parentheses'>(</span><a href="sha2.c.html#LN982"><span class='Ref_to_Parameter'>context</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Delimiter'>, </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../include/common/sha2.h.html#LN89"><span class='Ref_to_Typedef'>pg_sha224_ctx</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end pg_sha224_final &raquo; </span> 
</pre>
<table bgcolor='#c0c0c0' width='100%'><tr><td><a href='../../Contents.html'>Contents</a></td></tr>
</table><hr><p class='blurb' align='center'><a href='http://www.sourceinsight.com'>HTML Created by Source Insight Version 4.00.0084 Built on 2017-02-26</a></p>
</body></html>