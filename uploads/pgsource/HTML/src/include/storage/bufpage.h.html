<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta name="generator" content="Source Insight Version 4.00.0084 Built on 2017-02-26">
<meta charset='UTF-8' />
<style type='text/css'><!--
TD {background-color: #C0C0C0; font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 70%; }
.blurb {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 70%; }
.filename {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 120%; font-weight: bold; }
.dirname {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 100%; font-weight: bold; margin-top: 2.5em;}
--></style>
<title>src\include\storage\bufpage.h</title>
<LINK REL=StyleSheet HREF="../../../C_Cpp_Source_File.css" TYPE='text/css' MEDIA=screen>
</head>
<body bgcolor=#ffffff>
<table bgcolor='#c0c0c0' width='100%'>
<tr><td><p class='filename'><b>src\include\storage\bufpage.h</b></p></td>
<td align='right'>
Wed Jun 14 08:26:08 2017
</td></tr>
<tr><td><a href='../../../Contents.html'>Contents</a></td></tr>
</table>
<pre>
</span><span class='Comment_Multi_Line'>/*------------------------------------------------------------------------- 
 * 
 * bufpage.h 
 *    Standard POSTGRES buffer page definitions. 
 * 
 * 
 * Portions Copyright (c) 1996-2017, PostgreSQL Global Development Group 
 * Portions Copyright (c) 1994, Regents of the University of California 
 * 
 * src/include/storage/bufpage.h 
 * 
 *------------------------------------------------------------------------- 
 */ 
</span><span class='Directive'>#ifndef</span> <a href="bufpage.h.html#LN14"><span class='Ref_to_Const'>BUFPAGE_H</span></a> 
<a name="LN14"></a><span class='Keyword'>#define </span><span class='Declare_Constant'>BUFPAGE_H</span> 
 
<span class='Keyword'>#include </span><span class='String'>"access/xlogdefs.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"storage/block.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"storage/item.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"storage/off.h"</span> 
 
<span class='Comment_Multi_Line'>/* 
 * A postgres disk page is an abstraction layered on top of a postgres 
 * disk block (which is simply a unit of i/o, see block.h). 
 * 
 * specifically, while a disk block can be unformatted, a postgres 
 * disk page is always a slotted page of the form: 
 * 
 * +----------------+---------------------------------+ 
 * | PageHeaderData | linp1 linp2 linp3 ...           | 
 * +-----------+----+---------------------------------+ 
 * | ... linpN |                                      | 
 * +-----------+--------------------------------------+ 
 * |           ^ pd_lower                             | 
 * |                                                  | 
 * |             v pd_upper                           | 
 * +-------------+------------------------------------+ 
 * |             | tupleN ...                         | 
 * +-------------+------------------+-----------------+ 
 * |       ... tuple3 tuple2 tuple1 | "special space" | 
 * +--------------------------------+-----------------+ 
 *                                  ^ pd_special 
 * 
 * a page is full when nothing can be added between pd_lower and 
 * pd_upper. 
 * 
 * all blocks written out by an access method must be disk pages. 
 * 
 * EXCEPTIONS: 
 * 
 * obviously, a page is not formatted before it is initialized by 
 * a call to PageInit. 
 * 
 * NOTES: 
 * 
 * linp1..N form an ItemId array.  ItemPointers point into this array 
 * rather than pointing directly to a tuple.  Note that OffsetNumbers 
 * conventionally start at 1, not 0. 
 * 
 * tuple1..N are added "backwards" on the page.  because a tuple's 
 * ItemPointer points to its ItemId entry rather than its actual 
 * byte-offset position, tuples can be physically shuffled on a page 
 * whenever the need arises. 
 * 
 * AM-generic per-page information is kept in PageHeaderData. 
 * 
 * AM-specific per-page data (if any) is kept in the area marked "special 
 * space"; each AM has an "opaque" structure defined somewhere that is 
 * stored as the page trailer.  an access method should always 
 * initialize its pages with PageInit and then set its own opaque 
 * fields. 
 */ 
</span> 
<a name="LN73"></a><span class='Control'>typedef</span> <a href="../c.h.html#LN244"><span class='Ref_to_Typedef'>Pointer</span></a> <span class='Declare_Typedef'>Page</span><span class='Delimiter'>; 
</span> 
 
<span class='Comment_Multi_Line'>/* 
 * location (byte offset) within a page. 
 * 
 * note that this is actually limited to 2^15 because we have limited 
 * ItemIdData.lp_off and ItemIdData.lp_len to 15 bits (see itemid.h). 
 */ 
</span><a name="LN82"></a><span class='Control'>typedef</span> <a href="../c.h.html#LN266"><span class='Ref_to_Typedef'>uint16</span></a> <span class='Declare_Typedef'>LocationIndex</span><span class='Delimiter'>; 
</span> 
 
<span class='Comment_Multi_Line'>/* 
 * For historical reasons, the 64-bit LSN value is stored as two 32-bit 
 * values. 
 */ 
</span><span class='Control'>typedef</span> <span class='Control'>struct</span> 
<span class='Delimiter'>{ 
</span><a name="LN91"></a>    <a href="../c.h.html#LN267"><span class='Ref_to_Typedef'>uint32</span></a>      <span class='Declare_Member'>xlogid</span><span class='Delimiter'>;</span>         <span class='Comment_Single_Line'>/* high bits */ 
</span><a name="LN92"></a>    <a href="../c.h.html#LN267"><span class='Ref_to_Typedef'>uint32</span></a>      <span class='Declare_Member'>xrecoff</span><span class='Delimiter'>;</span>        <span class='Comment_Single_Line'>/* low bits */ 
</span><a name="LN93"></a><span class='Delimiter'>} </span><span class='Declare_Typedef'>PageXLogRecPtr</span><span class='Delimiter'>; 
</span> 
<a name="LN95"></a><span class='Keyword'>#define </span><span class='Declare_Macro'>PageXLogRecPtrGet</span><span class='Parentheses'>(</span><span class='Declare_Parameter'>val</span><span class='Parentheses'>) </span><span class='Operator'>\ 
</span>    <span class='Parentheses'>((</span><a href="../c.h.html#LN297"><span class='Ref_to_Typedef'>uint64</span></a><span class='Parentheses'>) (</span><a href="bufpage.h.html#LN95"><span class='Ref_to_Parameter'>val</span></a><span class='Parentheses'>)</span><span class='Operator'>.</span>xlogid <span class='Operator'>&LT;&LT; </span><span class='Number'>32</span> <span class='Operator'>| </span><span class='Parentheses'>(</span><a href="bufpage.h.html#LN95"><span class='Ref_to_Parameter'>val</span></a><span class='Parentheses'>)</span><span class='Operator'>.</span>xrecoff<span class='Parentheses'>)</span> 
<a name="LN97"></a><span class='Keyword'>#define </span><span class='Declare_Macro'>PageXLogRecPtrSet</span><span class='Parentheses'>(</span><span class='Declare_Parameter'>ptr</span><span class='Delimiter'>, </span><span class='Declare_Parameter'>lsn</span><span class='Parentheses'>) </span><span class='Operator'>\ 
</span>    <span class='Parentheses'>((</span><a href="bufpage.h.html#LN97"><span class='Ref_to_Parameter'>ptr</span></a><span class='Parentheses'>)</span><span class='Operator'>.</span>xlogid <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../c.h.html#LN267"><span class='Ref_to_Typedef'>uint32</span></a><span class='Parentheses'>)</span> <span class='Parentheses'>((</span><a href="bufpage.h.html#LN97"><span class='Ref_to_Parameter'>lsn</span></a><span class='Parentheses'>) </span><span class='Operator'>&GT;&GT; </span><span class='Number'>32</span><span class='Parentheses'>)</span><span class='Delimiter'>, </span><span class='Parentheses'>(</span><a href="bufpage.h.html#LN97"><span class='Ref_to_Parameter'>ptr</span></a><span class='Parentheses'>)</span><span class='Operator'>.</span>xrecoff <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../c.h.html#LN267"><span class='Ref_to_Typedef'>uint32</span></a><span class='Parentheses'>)</span> <span class='Parentheses'>(</span><a href="bufpage.h.html#LN97"><span class='Ref_to_Parameter'>lsn</span></a><span class='Parentheses'>))</span> 
 
<span class='Comment_Multi_Line'>/* 
 * disk page organization 
 * 
 * space management information generic to any page 
 * 
 *      pd_lsn      - identifies xlog record for last change to this page. 
 *      pd_checksum - page checksum, if set. 
 *      pd_flags    - flag bits. 
 *      pd_lower    - offset to start of free space. 
 *      pd_upper    - offset to end of free space. 
 *      pd_special  - offset to start of special space. 
 *      pd_pagesize_version - size in bytes and page layout version number. 
 *      pd_prune_xid - oldest XID among potentially prunable tuples on page. 
 * 
 * The LSN is used by the buffer manager to enforce the basic rule of WAL: 
 * "thou shalt write xlog before data".  A dirty buffer cannot be dumped 
 * to disk until xlog has been flushed at least as far as the page's LSN. 
 * 
 * pd_checksum stores the page checksum, if it has been set for this page; 
 * zero is a valid value for a checksum. If a checksum is not in use then 
 * we leave the field unset. This will typically mean the field is zero 
 * though non-zero values may also be present if databases have been 
 * pg_upgraded from releases prior to 9.3, when the same byte offset was 
 * used to store the current timelineid when the page was last updated. 
 * Note that there is no indication on a page as to whether the checksum 
 * is valid or not, a deliberate design choice which avoids the problem 
 * of relying on the page contents to decide whether to verify it. Hence 
 * there are no flag bits relating to checksums. 
 * 
 * pd_prune_xid is a hint field that helps determine whether pruning will be 
 * useful.  It is currently unused in index pages. 
 * 
 * The page version number and page size are packed together into a single 
 * uint16 field.  This is for historical reasons: before PostgreSQL 7.3, 
 * there was no concept of a page version number, and doing it this way 
 * lets us pretend that pre-7.3 databases have page version number zero. 
 * We constrain page sizes to be multiples of 256, leaving the low eight 
 * bits available for a version number. 
 * 
 * Minimum possible page size is perhaps 64B to fit page header, opaque space 
 * and a minimal tuple; of course, in reality you want it much bigger, so 
 * the constraint on pagesize mod 256 is not an important restriction. 
 * On the high end, we can only support pages up to 32KB because lp_off/lp_len 
 * are 15 bits. 
 */ 
</span> 
<a name="LN146"></a><span class='Control'>typedef</span> <span class='Control'>struct</span> <span class='Declare_Struct'>PageHeaderData</span> 
<span class='Delimiter'>{ 
</span>    <span class='Comment_Multi_Line'>/* XXX LSN is member of *any* block, not only page-organized ones */ 
</span><a name="LN149"></a>    <a href="bufpage.h.html#LN89"><span class='Ref_to_Typedef'>PageXLogRecPtr</span></a> <span class='Declare_Member'>pd_lsn</span><span class='Delimiter'>;</span>      <span class='Comment_Multi_Line'>/* LSN: next byte after last byte of xlog 
                                 * record for last change to this page */ 
</span><a name="LN151"></a>    <a href="../c.h.html#LN266"><span class='Ref_to_Typedef'>uint16</span></a>      <span class='Declare_Member'>pd_checksum</span><span class='Delimiter'>;</span>    <span class='Comment_Single_Line'>/* checksum */ 
</span><a name="LN152"></a>    <a href="../c.h.html#LN266"><span class='Ref_to_Typedef'>uint16</span></a>      <span class='Declare_Member'>pd_flags</span><span class='Delimiter'>;</span>       <span class='Comment_Single_Line'>/* flag bits, see below */ 
</span><a name="LN153"></a>    <a href="bufpage.h.html#LN82"><span class='Ref_to_Typedef'>LocationIndex</span></a> <span class='Declare_Member'>pd_lower</span><span class='Delimiter'>;</span>     <span class='Comment_Single_Line'>/* offset to start of free space */ 
</span><a name="LN154"></a>    <a href="bufpage.h.html#LN82"><span class='Ref_to_Typedef'>LocationIndex</span></a> <span class='Declare_Member'>pd_upper</span><span class='Delimiter'>;</span>     <span class='Comment_Single_Line'>/* offset to end of free space */ 
</span><a name="LN155"></a>    <a href="bufpage.h.html#LN82"><span class='Ref_to_Typedef'>LocationIndex</span></a> <span class='Declare_Member'>pd_special</span><span class='Delimiter'>;</span>   <span class='Comment_Single_Line'>/* offset to start of special space */ 
</span><a name="LN156"></a>    <a href="../c.h.html#LN266"><span class='Ref_to_Typedef'>uint16</span></a>      <span class='Declare_Member'>pd_pagesize_version</span><span class='Delimiter'>; 
</span><a name="LN157"></a>    <a href="../c.h.html#LN396"><span class='Ref_to_Typedef'>TransactionId</span></a> <span class='Declare_Member'>pd_prune_xid</span><span class='Delimiter'>; </span><span class='Comment_Single_Line'>/* oldest prunable XID, or zero if none */ 
</span><a name="LN158"></a>    <a href="itemid.h.html#LN23"><span class='Ref_to_Struct'>ItemIdData</span></a>  <span class='Declare_Member'>pd_linp</span><span class='Delimiter'>[</span>FLEXIBLE_ARRAY_MEMBER<span class='Delimiter'>]; </span><span class='Comment_Single_Line'>/* line pointer array */ 
</span><a name="LN159"></a><span class='Delimiter'>} </span><span class='Declare_Typedef'>PageHeaderData</span><span class='Delimiter'>; 
</span> 
<a name="LN161"></a><span class='Control'>typedef</span> <a href="bufpage.h.html#LN146"><span class='Ref_to_Struct'>PageHeaderData</span></a> <span class='Operator'>*</span><span class='Declare_Typedef'>PageHeader</span><span class='Delimiter'>; 
</span> 
<span class='Comment_Multi_Line'>/* 
 * pd_flags contains the following flag bits.  Undefined bits are initialized 
 * to zero and may be used in the future. 
 * 
 * PD_HAS_FREE_LINES is set if there are any LP_UNUSED line pointers before 
 * pd_lower.  This should be considered a hint rather than the truth, since 
 * changes to it are not WAL-logged. 
 * 
 * PD_PAGE_FULL is set if an UPDATE doesn't find enough free space in the 
 * page for its new tuple version; this suggests that a prune is needed. 
 * Again, this is just a hint. 
 */ 
</span><a name="LN175"></a><span class='Keyword'>#define </span><span class='Declare_Constant'>PD_HAS_FREE_LINES</span>   <span class='Number'>0x0001</span>      <span class='Comment_Single_Line'>/* are there any unused line pointers? */ 
</span><a name="LN176"></a><span class='Keyword'>#define </span><span class='Declare_Constant'>PD_PAGE_FULL</span>        <span class='Number'>0x0002</span>      <span class='Comment_Multi_Line'>/* not enough free space for new 
                                         * tuple? */ 
</span><a name="LN178"></a><span class='Keyword'>#define </span><span class='Declare_Constant'>PD_ALL_VISIBLE</span>      <span class='Number'>0x0004</span>      <span class='Comment_Multi_Line'>/* all tuples on page are visible to 
                                         * everyone */ 
</span> 
<a name="LN181"></a><span class='Keyword'>#define </span><span class='Declare_Constant'>PD_VALID_FLAG_BITS</span>  <span class='Number'>0x0007</span>      <span class='Comment_Single_Line'>/* OR of all valid pd_flags bits */ 
</span> 
<span class='Comment_Multi_Line'>/* 
 * Page layout version number 0 is for pre-7.3 Postgres releases. 
 * Releases 7.3 and 7.4 use 1, denoting a new HeapTupleHeader layout. 
 * Release 8.0 uses 2; it changed the HeapTupleHeader layout again. 
 * Release 8.1 uses 3; it redefined HeapTupleHeader infomask bits. 
 * Release 8.3 uses 4; it changed the HeapTupleHeader layout again, and 
 *      added the pd_flags field (by stealing some bits from pd_tli), 
 *      as well as adding the pd_prune_xid field (which enlarges the header). 
 * 
 * As of Release 9.3, the checksum version must also be considered when 
 * handling pages. 
 */ 
</span><a name="LN195"></a><span class='Keyword'>#define </span><span class='Declare_Constant'>PG_PAGE_LAYOUT_VERSION</span>      <span class='Number'>4</span> 
<a name="LN196"></a><span class='Keyword'>#define </span><span class='Declare_Constant'>PG_DATA_CHECKSUM_VERSION</span>    <span class='Number'>1</span> 
 
<span class='Comment_Multi_Line'>/* ---------------------------------------------------------------- 
 *                      page support macros 
 * ---------------------------------------------------------------- 
 */ 
</span> 
<span class='Comment_Multi_Line'>/* 
 * PageIsValid 
 *      True iff page is valid. 
 */ 
</span><a name="LN207"></a><span class='Keyword'>#define </span><span class='Declare_Macro'>PageIsValid</span><span class='Parentheses'>(</span><span class='Declare_Parameter'>page</span><span class='Parentheses'>) </span><a href="../c.h.html#LN525"><span class='Ref_to_Macro'>PointerIsValid</span></a><span class='Parentheses'>(</span><a href="bufpage.h.html#LN207"><span class='Ref_to_Parameter'>page</span></a><span class='Parentheses'>) 
</span> 
<span class='Comment_Multi_Line'>/* 
 * line pointer(s) do not count as part of header 
 */ 
</span><a name="LN212"></a><span class='Keyword'>#define </span><span class='Declare_Constant'>SizeOfPageHeaderData</span> <span class='Parentheses'>(</span><a href="../c.h.html#LN554"><span class='Ref_to_Macro'>offsetof</span></a><span class='Parentheses'>(</span><a href="bufpage.h.html#LN146"><span class='Ref_to_Struct'>PageHeaderData</span></a><span class='Delimiter'>, </span>pd_linp<span class='Parentheses'>))</span> 
 
<span class='Comment_Multi_Line'>/* 
 * PageIsEmpty 
 *      returns true iff no itemid has been allocated on the page 
 */ 
</span><a name="LN218"></a><span class='Keyword'>#define </span><span class='Declare_Macro'>PageIsEmpty</span><span class='Parentheses'>(</span><span class='Declare_Parameter'>page</span><span class='Parentheses'>) </span><span class='Operator'>\ 
</span>    <span class='Parentheses'>(((</span><a href="bufpage.h.html#LN161"><span class='Ref_to_Typedef'>PageHeader</span></a><span class='Parentheses'>) (</span><a href="bufpage.h.html#LN218"><span class='Ref_to_Parameter'>page</span></a><span class='Parentheses'>))</span><span class='Operator'>-&GT;</span>pd_lower <span class='Operator'>&LT;= </span><a href="bufpage.h.html#LN212"><span class='Ref_to_Const'>SizeOfPageHeaderData</span></a><span class='Parentheses'>)</span> 
 
<span class='Comment_Multi_Line'>/* 
 * PageIsNew 
 *      returns true iff page has not been initialized (by PageInit) 
 */ 
</span><a name="LN225"></a><span class='Keyword'>#define </span><span class='Declare_Macro'>PageIsNew</span><span class='Parentheses'>(</span><span class='Declare_Parameter'>page</span><span class='Parentheses'>) (((</span><a href="bufpage.h.html#LN161"><span class='Ref_to_Typedef'>PageHeader</span></a><span class='Parentheses'>) (</span><a href="bufpage.h.html#LN225"><span class='Ref_to_Parameter'>page</span></a><span class='Parentheses'>))</span><span class='Operator'>-&GT;</span>pd_upper <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
 
<span class='Comment_Multi_Line'>/* 
 * PageGetItemId 
 *      Returns an item identifier of a page. 
 */ 
</span><a name="LN231"></a><span class='Keyword'>#define </span><span class='Declare_Macro'>PageGetItemId</span><span class='Parentheses'>(</span><span class='Declare_Parameter'>page</span><span class='Delimiter'>, </span><span class='Declare_Parameter'>offsetNumber</span><span class='Parentheses'>) </span><span class='Operator'>\ 
</span>    <span class='Parentheses'>((</span><a href="itemid.h.html#LN30"><span class='Ref_to_Typedef'>ItemId</span></a><span class='Parentheses'>)</span> <span class='Parentheses'>(</span><span class='Operator'>&</span><span class='Parentheses'>((</span><a href="bufpage.h.html#LN161"><span class='Ref_to_Typedef'>PageHeader</span></a><span class='Parentheses'>) (</span><a href="bufpage.h.html#LN231"><span class='Ref_to_Parameter'>page</span></a><span class='Parentheses'>))</span><span class='Operator'>-&GT;</span>pd_linp<span class='Delimiter'>[</span><span class='Parentheses'>(</span><a href="bufpage.h.html#LN231"><span class='Ref_to_Parameter'>offsetNumber</span></a><span class='Parentheses'>)</span> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>]</span><span class='Parentheses'>))</span> 
 
<span class='Comment_Multi_Line'>/* 
 * PageGetContents 
 *      To be used in case the page does not contain item pointers. 
 * 
 * Note: prior to 8.3 this was not guaranteed to yield a MAXALIGN'd result. 
 * Now it is.  Beware of old code that might think the offset to the contents 
 * is just SizeOfPageHeaderData rather than MAXALIGN(SizeOfPageHeaderData). 
 */ 
</span><a name="LN242"></a><span class='Keyword'>#define </span><span class='Declare_Macro'>PageGetContents</span><span class='Parentheses'>(</span><span class='Declare_Parameter'>page</span><span class='Parentheses'>) </span><span class='Operator'>\ 
</span>    <span class='Parentheses'>((</span><span class='Keyword'>char </span><span class='Operator'>*</span><span class='Parentheses'>) (</span><a href="bufpage.h.html#LN242"><span class='Ref_to_Parameter'>page</span></a><span class='Parentheses'>) </span><span class='Operator'>+ </span><a href="../c.h.html#LN587"><span class='Ref_to_Macro'>MAXALIGN</span></a><span class='Parentheses'>(</span><a href="bufpage.h.html#LN212"><span class='Ref_to_Const'>SizeOfPageHeaderData</span></a><span class='Parentheses'>))</span> 
 
<span class='Comment_Multi_Line'>/* ---------------- 
 *      macros to access page size info 
 * ---------------- 
 */ 
</span> 
<span class='Comment_Multi_Line'>/* 
 * PageSizeIsValid 
 *      True iff the page size is valid. 
 */ 
</span><a name="LN254"></a><span class='Keyword'>#define </span><span class='Declare_Macro'>PageSizeIsValid</span><span class='Parentheses'>(</span><span class='Declare_Parameter'>pageSize</span><span class='Parentheses'>) ((</span><a href="bufpage.h.html#LN254"><span class='Ref_to_Parameter'>pageSize</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span>BLCKSZ<span class='Parentheses'>)</span> 
 
<span class='Comment_Multi_Line'>/* 
 * PageGetPageSize 
 *      Returns the page size of a page. 
 * 
 * this can only be called on a formatted page (unlike 
 * BufferGetPageSize, which can be called on an unformatted page). 
 * however, it can be called on a page that is not stored in a buffer. 
 */ 
</span><a name="LN264"></a><span class='Keyword'>#define </span><span class='Declare_Macro'>PageGetPageSize</span><span class='Parentheses'>(</span><span class='Declare_Parameter'>page</span><span class='Parentheses'>) </span><span class='Operator'>\ 
</span>    <span class='Parentheses'>((</span><a href="../c.h.html#LN355"><span class='Ref_to_Typedef'>Size</span></a><span class='Parentheses'>)</span> <span class='Parentheses'>(((</span><a href="bufpage.h.html#LN161"><span class='Ref_to_Typedef'>PageHeader</span></a><span class='Parentheses'>) (</span><a href="bufpage.h.html#LN264"><span class='Ref_to_Parameter'>page</span></a><span class='Parentheses'>))</span><span class='Operator'>-&GT;</span>pd_pagesize_version <span class='Operator'>& </span><span class='Parentheses'>(</span><a href="../c.h.html#LN266"><span class='Ref_to_Typedef'>uint16</span></a><span class='Parentheses'>)</span> <span class='Number'>0xFF00</span><span class='Parentheses'>))</span> 
 
<span class='Comment_Multi_Line'>/* 
 * PageGetPageLayoutVersion 
 *      Returns the page layout version of a page. 
 */ 
</span><a name="LN271"></a><span class='Keyword'>#define </span><span class='Declare_Macro'>PageGetPageLayoutVersion</span><span class='Parentheses'>(</span><span class='Declare_Parameter'>page</span><span class='Parentheses'>) </span><span class='Operator'>\ 
</span>    <span class='Parentheses'>(((</span><a href="bufpage.h.html#LN161"><span class='Ref_to_Typedef'>PageHeader</span></a><span class='Parentheses'>) (</span><a href="bufpage.h.html#LN271"><span class='Ref_to_Parameter'>page</span></a><span class='Parentheses'>))</span><span class='Operator'>-&GT;</span>pd_pagesize_version <span class='Operator'>& </span><span class='Number'>0x00FF</span><span class='Parentheses'>)</span> 
 
<span class='Comment_Multi_Line'>/* 
 * PageSetPageSizeAndVersion 
 *      Sets the page size and page layout version number of a page. 
 * 
 * We could support setting these two values separately, but there's 
 * no real need for it at the moment. 
 */ 
</span><a name="LN281"></a><span class='Keyword'>#define </span><span class='Declare_Macro'>PageSetPageSizeAndVersion</span><span class='Parentheses'>(</span><span class='Declare_Parameter'>page</span><span class='Delimiter'>, </span><span class='Declare_Parameter'>size</span><span class='Delimiter'>, </span><span class='Declare_Parameter'>version</span><span class='Parentheses'>) </span><span class='Operator'>\ 
</span><span class='Parentheses'>(</span> <span class='Operator'>\ 
</span>    <a href="../c.h.html#LN675"><span class='Ref_to_Macro'>AssertMacro</span></a><span class='Parentheses'>(((</span><a href="bufpage.h.html#LN281"><span class='Ref_to_Parameter'>size</span></a><span class='Parentheses'>) </span><span class='Operator'>& </span><span class='Number'>0xFF00</span><span class='Parentheses'>)</span> <span class='Operator'>== </span><span class='Parentheses'>(</span><a href="bufpage.h.html#LN281"><span class='Ref_to_Parameter'>size</span></a><span class='Parentheses'>))</span><span class='Delimiter'>, </span><span class='Operator'>\ 
</span>    <a href="../c.h.html#LN675"><span class='Ref_to_Macro'>AssertMacro</span></a><span class='Parentheses'>(((</span><a href="bufpage.h.html#LN281"><span class='Ref_to_Parameter'>version</span></a><span class='Parentheses'>) </span><span class='Operator'>& </span><span class='Number'>0x00FF</span><span class='Parentheses'>)</span> <span class='Operator'>== </span><span class='Parentheses'>(</span><a href="bufpage.h.html#LN281"><span class='Ref_to_Parameter'>version</span></a><span class='Parentheses'>))</span><span class='Delimiter'>, </span><span class='Operator'>\ 
</span>    <span class='Parentheses'>((</span><a href="bufpage.h.html#LN161"><span class='Ref_to_Typedef'>PageHeader</span></a><span class='Parentheses'>)</span> <span class='Parentheses'>(</span><a href="bufpage.h.html#LN281"><span class='Ref_to_Parameter'>page</span></a><span class='Parentheses'>))</span><span class='Operator'>-&GT;</span>pd_pagesize_version <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="bufpage.h.html#LN281"><span class='Ref_to_Parameter'>size</span></a><span class='Parentheses'>)</span> <span class='Operator'>| </span><span class='Parentheses'>(</span><a href="bufpage.h.html#LN281"><span class='Ref_to_Parameter'>version</span></a><span class='Parentheses'>)</span> <span class='Operator'>\ 
</span><span class='Parentheses'>)</span> 
 
<span class='Comment_Multi_Line'>/* ---------------- 
 *      page special data macros 
 * ---------------- 
 */ 
/* 
 * PageGetSpecialSize 
 *      Returns size of special space on a page. 
 */ 
</span><a name="LN296"></a><span class='Keyword'>#define </span><span class='Declare_Macro'>PageGetSpecialSize</span><span class='Parentheses'>(</span><span class='Declare_Parameter'>page</span><span class='Parentheses'>) </span><span class='Operator'>\ 
</span>    <span class='Parentheses'>((</span><a href="../c.h.html#LN266"><span class='Ref_to_Typedef'>uint16</span></a><span class='Parentheses'>)</span> <span class='Parentheses'>(</span><a href="bufpage.h.html#LN264"><span class='Ref_to_Macro'>PageGetPageSize</span></a><span class='Parentheses'>(</span><a href="bufpage.h.html#LN296"><span class='Ref_to_Parameter'>page</span></a><span class='Parentheses'>)</span> <span class='Operator'>- </span><span class='Parentheses'>((</span><a href="bufpage.h.html#LN161"><span class='Ref_to_Typedef'>PageHeader</span></a><span class='Parentheses'>)(</span><a href="bufpage.h.html#LN296"><span class='Ref_to_Parameter'>page</span></a><span class='Parentheses'>))</span><span class='Operator'>-&GT;</span>pd_special<span class='Parentheses'>))</span> 
 
<span class='Comment_Multi_Line'>/* 
 * Using assertions, validate that the page special pointer is OK. 
 * 
 * This is intended to catch use of the pointer before page initialization. 
 * It is implemented as a function due to the limitations of the MSVC 
 * compiler, which choked on doing all these tests within another macro.  We 
 * return true so that MacroAssert() can be used while still getting the 
 * specifics from the macro failure within this function. 
 */ 
</span><span class='Keyword'>static inline bool 
</span><a name="LN309"></a><span class='Declare_Function'>PageValidateSpecialPointer</span><span class='Parentheses'>(</span><a href="bufpage.h.html#LN73"><span class='Ref_to_Typedef'>Page</span></a> <span class='Declare_Parameter'>page</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="bufpage.h.html#LN207"><span class='Ref_to_Macro'>PageIsValid</span></a><span class='Parentheses'>(</span><a href="bufpage.h.html#LN309"><span class='Ref_to_Parameter'>page</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Debug'>Assert</span><span class='Parentheses'>(((</span><a href="bufpage.h.html#LN161"><span class='Ref_to_Typedef'>PageHeader</span></a><span class='Parentheses'>) (</span><a href="bufpage.h.html#LN309"><span class='Ref_to_Parameter'>page</span></a><span class='Parentheses'>))</span><span class='Operator'>-&GT;</span>pd_special <span class='Operator'>&LT;= </span>BLCKSZ<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Debug'>Assert</span><span class='Parentheses'>(((</span><a href="bufpage.h.html#LN161"><span class='Ref_to_Typedef'>PageHeader</span></a><span class='Parentheses'>) (</span><a href="bufpage.h.html#LN309"><span class='Ref_to_Parameter'>page</span></a><span class='Parentheses'>))</span><span class='Operator'>-&GT;</span>pd_special <span class='Operator'>&GT;= </span><a href="bufpage.h.html#LN212"><span class='Ref_to_Const'>SizeOfPageHeaderData</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <span class='Boolean'>true</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * PageGetSpecialPointer 
 *      Returns pointer to special space on a page. 
 */ 
</span><a name="LN322"></a><span class='Keyword'>#define </span><span class='Declare_Macro'>PageGetSpecialPointer</span><span class='Parentheses'>(</span><span class='Declare_Parameter'>page</span><span class='Parentheses'>) </span><span class='Operator'>\ 
</span><span class='Parentheses'>(</span> <span class='Operator'>\ 
</span>    <a href="../c.h.html#LN675"><span class='Ref_to_Macro'>AssertMacro</span></a><span class='Parentheses'>(</span><a href="bufpage.h.html#LN308"><span class='Ref_to_Func'>PageValidateSpecialPointer</span></a><span class='Parentheses'>(</span><a href="bufpage.h.html#LN322"><span class='Ref_to_Parameter'>page</span></a><span class='Parentheses'>))</span><span class='Delimiter'>, </span><span class='Operator'>\ 
</span>    <span class='Parentheses'>(</span><span class='Keyword'>char </span><span class='Operator'>*</span><span class='Parentheses'>)</span> <span class='Parentheses'>((</span><span class='Keyword'>char </span><span class='Operator'>*</span><span class='Parentheses'>)</span> <span class='Parentheses'>(</span><a href="bufpage.h.html#LN322"><span class='Ref_to_Parameter'>page</span></a><span class='Parentheses'>)</span> <span class='Operator'>+ </span><span class='Parentheses'>((</span><a href="bufpage.h.html#LN161"><span class='Ref_to_Typedef'>PageHeader</span></a><span class='Parentheses'>) (</span><a href="bufpage.h.html#LN322"><span class='Ref_to_Parameter'>page</span></a><span class='Parentheses'>))</span><span class='Operator'>-&GT;</span>pd_special<span class='Parentheses'>)</span> <span class='Operator'>\ 
</span><span class='Parentheses'>)</span> 
 
<span class='Comment_Multi_Line'>/* 
 * PageGetItem 
 *      Retrieves an item on the given page. 
 * 
 * Note: 
 *      This does not change the status of any of the resources passed. 
 *      The semantics may change in the future. 
 */ 
</span><a name="LN336"></a><span class='Keyword'>#define </span><span class='Declare_Macro'>PageGetItem</span><span class='Parentheses'>(</span><span class='Declare_Parameter'>page</span><span class='Delimiter'>, </span><span class='Declare_Parameter'>itemId</span><span class='Parentheses'>) </span><span class='Operator'>\ 
</span><span class='Parentheses'>(</span> <span class='Operator'>\ 
</span>    <a href="../c.h.html#LN675"><span class='Ref_to_Macro'>AssertMacro</span></a><span class='Parentheses'>(</span><a href="bufpage.h.html#LN207"><span class='Ref_to_Macro'>PageIsValid</span></a><span class='Parentheses'>(</span><a href="bufpage.h.html#LN336"><span class='Ref_to_Parameter'>page</span></a><span class='Parentheses'>))</span><span class='Delimiter'>, </span><span class='Operator'>\ 
</span>    <a href="../c.h.html#LN675"><span class='Ref_to_Macro'>AssertMacro</span></a><span class='Parentheses'>(</span><a href="itemid.h.html#LN118"><span class='Ref_to_Macro'>ItemIdHasStorage</span></a><span class='Parentheses'>(</span><a href="bufpage.h.html#LN336"><span class='Ref_to_Parameter'>itemId</span></a><span class='Parentheses'>))</span><span class='Delimiter'>, </span><span class='Operator'>\ 
</span>    <span class='Parentheses'>(</span><a href="item.h.html#LN16"><span class='Ref_to_Typedef'>Item</span></a><span class='Parentheses'>)(((</span><span class='Keyword'>char </span><span class='Operator'>*</span><span class='Parentheses'>)(</span><a href="bufpage.h.html#LN336"><span class='Ref_to_Parameter'>page</span></a><span class='Parentheses'>))</span> <span class='Operator'>+ </span><a href="itemid.h.html#LN63"><span class='Ref_to_Macro'>ItemIdGetOffset</span></a><span class='Parentheses'>(</span><a href="bufpage.h.html#LN336"><span class='Ref_to_Parameter'>itemId</span></a><span class='Parentheses'>))</span> <span class='Operator'>\ 
</span><span class='Parentheses'>)</span> 
 
<span class='Comment_Multi_Line'>/* 
 * PageGetMaxOffsetNumber 
 *      Returns the maximum offset number used by the given page. 
 *      Since offset numbers are 1-based, this is also the number 
 *      of items on the page. 
 * 
 *      NOTE: if the page is not initialized (pd_lower == 0), we must 
 *      return zero to ensure sane behavior.  Accept double evaluation 
 *      of the argument so that we can ensure this. 
 */ 
</span><a name="LN353"></a><span class='Keyword'>#define </span><span class='Declare_Macro'>PageGetMaxOffsetNumber</span><span class='Parentheses'>(</span><span class='Declare_Parameter'>page</span><span class='Parentheses'>) </span><span class='Operator'>\ 
</span>    <span class='Parentheses'>(((</span><a href="bufpage.h.html#LN161"><span class='Ref_to_Typedef'>PageHeader</span></a><span class='Parentheses'>)</span> <span class='Parentheses'>(</span><a href="bufpage.h.html#LN353"><span class='Ref_to_Parameter'>page</span></a><span class='Parentheses'>))</span><span class='Operator'>-&GT;</span>pd_lower <span class='Operator'>&LT;= </span><a href="bufpage.h.html#LN212"><span class='Ref_to_Const'>SizeOfPageHeaderData</span></a> <span class='Operator'>? </span><span class='Number'>0</span> <span class='Operator'>: \ 
</span>     <span class='Parentheses'>((((</span><a href="bufpage.h.html#LN161"><span class='Ref_to_Typedef'>PageHeader</span></a><span class='Parentheses'>) (</span><a href="bufpage.h.html#LN353"><span class='Ref_to_Parameter'>page</span></a><span class='Parentheses'>))</span><span class='Operator'>-&GT;</span>pd_lower <span class='Operator'>- </span><a href="bufpage.h.html#LN212"><span class='Ref_to_Const'>SizeOfPageHeaderData</span></a><span class='Parentheses'>)</span> <span class='Operator'>\ 
</span>      <span class='Operator'>/ </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="itemid.h.html#LN23"><span class='Ref_to_Struct'>ItemIdData</span></a><span class='Parentheses'>)))</span> 
 
<span class='Comment_Multi_Line'>/* 
 * Additional macros for access to page headers. (Beware multiple evaluation 
 * of the arguments!) 
 */ 
</span><a name="LN362"></a><span class='Keyword'>#define </span><span class='Declare_Macro'>PageGetLSN</span><span class='Parentheses'>(</span><span class='Declare_Parameter'>page</span><span class='Parentheses'>) </span><span class='Operator'>\ 
</span>    <a href="bufpage.h.html#LN95"><span class='Ref_to_Macro'>PageXLogRecPtrGet</span></a><span class='Parentheses'>(((</span><a href="bufpage.h.html#LN161"><span class='Ref_to_Typedef'>PageHeader</span></a><span class='Parentheses'>) (</span><a href="bufpage.h.html#LN362"><span class='Ref_to_Parameter'>page</span></a><span class='Parentheses'>))</span><span class='Operator'>-&GT;</span>pd_lsn<span class='Parentheses'>)</span> 
<a name="LN364"></a><span class='Keyword'>#define </span><span class='Declare_Macro'>PageSetLSN</span><span class='Parentheses'>(</span><span class='Declare_Parameter'>page</span><span class='Delimiter'>, </span><span class='Declare_Parameter'>lsn</span><span class='Parentheses'>) </span><span class='Operator'>\ 
</span>    <a href="bufpage.h.html#LN97"><span class='Ref_to_Macro'>PageXLogRecPtrSet</span></a><span class='Parentheses'>(((</span><a href="bufpage.h.html#LN161"><span class='Ref_to_Typedef'>PageHeader</span></a><span class='Parentheses'>) (</span><a href="bufpage.h.html#LN364"><span class='Ref_to_Parameter'>page</span></a><span class='Parentheses'>))</span><span class='Operator'>-&GT;</span>pd_lsn<span class='Delimiter'>, </span><a href="bufpage.h.html#LN364"><span class='Ref_to_Parameter'>lsn</span></a><span class='Parentheses'>)</span> 
 
<a name="LN367"></a><span class='Keyword'>#define </span><span class='Declare_Macro'>PageHasFreeLinePointers</span><span class='Parentheses'>(</span><span class='Declare_Parameter'>page</span><span class='Parentheses'>) </span><span class='Operator'>\ 
</span>    <span class='Parentheses'>(((</span><a href="bufpage.h.html#LN161"><span class='Ref_to_Typedef'>PageHeader</span></a><span class='Parentheses'>) (</span><a href="bufpage.h.html#LN367"><span class='Ref_to_Parameter'>page</span></a><span class='Parentheses'>))</span><span class='Operator'>-&GT;</span>pd_flags <span class='Operator'>& </span><a href="bufpage.h.html#LN175"><span class='Ref_to_Const'>PD_HAS_FREE_LINES</span></a><span class='Parentheses'>)</span> 
<a name="LN369"></a><span class='Keyword'>#define </span><span class='Declare_Macro'>PageSetHasFreeLinePointers</span><span class='Parentheses'>(</span><span class='Declare_Parameter'>page</span><span class='Parentheses'>) </span><span class='Operator'>\ 
</span>    <span class='Parentheses'>(((</span><a href="bufpage.h.html#LN161"><span class='Ref_to_Typedef'>PageHeader</span></a><span class='Parentheses'>) (</span><a href="bufpage.h.html#LN369"><span class='Ref_to_Parameter'>page</span></a><span class='Parentheses'>))</span><span class='Operator'>-&GT;</span>pd_flags <span class='Operator'>|= </span><a href="bufpage.h.html#LN175"><span class='Ref_to_Const'>PD_HAS_FREE_LINES</span></a><span class='Parentheses'>)</span> 
<a name="LN371"></a><span class='Keyword'>#define </span><span class='Declare_Macro'>PageClearHasFreeLinePointers</span><span class='Parentheses'>(</span><span class='Declare_Parameter'>page</span><span class='Parentheses'>) </span><span class='Operator'>\ 
</span>    <span class='Parentheses'>(((</span><a href="bufpage.h.html#LN161"><span class='Ref_to_Typedef'>PageHeader</span></a><span class='Parentheses'>) (</span><a href="bufpage.h.html#LN371"><span class='Ref_to_Parameter'>page</span></a><span class='Parentheses'>))</span><span class='Operator'>-&GT;</span>pd_flags <span class='Operator'>&= ~</span><a href="bufpage.h.html#LN175"><span class='Ref_to_Const'>PD_HAS_FREE_LINES</span></a><span class='Parentheses'>)</span> 
 
<a name="LN374"></a><span class='Keyword'>#define </span><span class='Declare_Macro'>PageIsFull</span><span class='Parentheses'>(</span><span class='Declare_Parameter'>page</span><span class='Parentheses'>) </span><span class='Operator'>\ 
</span>    <span class='Parentheses'>(((</span><a href="bufpage.h.html#LN161"><span class='Ref_to_Typedef'>PageHeader</span></a><span class='Parentheses'>) (</span><a href="bufpage.h.html#LN374"><span class='Ref_to_Parameter'>page</span></a><span class='Parentheses'>))</span><span class='Operator'>-&GT;</span>pd_flags <span class='Operator'>& </span><a href="bufpage.h.html#LN176"><span class='Ref_to_Const'>PD_PAGE_FULL</span></a><span class='Parentheses'>)</span> 
<a name="LN376"></a><span class='Keyword'>#define </span><span class='Declare_Macro'>PageSetFull</span><span class='Parentheses'>(</span><span class='Declare_Parameter'>page</span><span class='Parentheses'>) </span><span class='Operator'>\ 
</span>    <span class='Parentheses'>(((</span><a href="bufpage.h.html#LN161"><span class='Ref_to_Typedef'>PageHeader</span></a><span class='Parentheses'>) (</span><a href="bufpage.h.html#LN376"><span class='Ref_to_Parameter'>page</span></a><span class='Parentheses'>))</span><span class='Operator'>-&GT;</span>pd_flags <span class='Operator'>|= </span><a href="bufpage.h.html#LN176"><span class='Ref_to_Const'>PD_PAGE_FULL</span></a><span class='Parentheses'>)</span> 
<a name="LN378"></a><span class='Keyword'>#define </span><span class='Declare_Macro'>PageClearFull</span><span class='Parentheses'>(</span><span class='Declare_Parameter'>page</span><span class='Parentheses'>) </span><span class='Operator'>\ 
</span>    <span class='Parentheses'>(((</span><a href="bufpage.h.html#LN161"><span class='Ref_to_Typedef'>PageHeader</span></a><span class='Parentheses'>) (</span><a href="bufpage.h.html#LN378"><span class='Ref_to_Parameter'>page</span></a><span class='Parentheses'>))</span><span class='Operator'>-&GT;</span>pd_flags <span class='Operator'>&= ~</span><a href="bufpage.h.html#LN176"><span class='Ref_to_Const'>PD_PAGE_FULL</span></a><span class='Parentheses'>)</span> 
 
<a name="LN381"></a><span class='Keyword'>#define </span><span class='Declare_Macro'>PageIsAllVisible</span><span class='Parentheses'>(</span><span class='Declare_Parameter'>page</span><span class='Parentheses'>) </span><span class='Operator'>\ 
</span>    <span class='Parentheses'>(((</span><a href="bufpage.h.html#LN161"><span class='Ref_to_Typedef'>PageHeader</span></a><span class='Parentheses'>) (</span><a href="bufpage.h.html#LN381"><span class='Ref_to_Parameter'>page</span></a><span class='Parentheses'>))</span><span class='Operator'>-&GT;</span>pd_flags <span class='Operator'>& </span><a href="bufpage.h.html#LN178"><span class='Ref_to_Const'>PD_ALL_VISIBLE</span></a><span class='Parentheses'>)</span> 
<a name="LN383"></a><span class='Keyword'>#define </span><span class='Declare_Macro'>PageSetAllVisible</span><span class='Parentheses'>(</span><span class='Declare_Parameter'>page</span><span class='Parentheses'>) </span><span class='Operator'>\ 
</span>    <span class='Parentheses'>(((</span><a href="bufpage.h.html#LN161"><span class='Ref_to_Typedef'>PageHeader</span></a><span class='Parentheses'>) (</span><a href="bufpage.h.html#LN383"><span class='Ref_to_Parameter'>page</span></a><span class='Parentheses'>))</span><span class='Operator'>-&GT;</span>pd_flags <span class='Operator'>|= </span><a href="bufpage.h.html#LN178"><span class='Ref_to_Const'>PD_ALL_VISIBLE</span></a><span class='Parentheses'>)</span> 
<a name="LN385"></a><span class='Keyword'>#define </span><span class='Declare_Macro'>PageClearAllVisible</span><span class='Parentheses'>(</span><span class='Declare_Parameter'>page</span><span class='Parentheses'>) </span><span class='Operator'>\ 
</span>    <span class='Parentheses'>(((</span><a href="bufpage.h.html#LN161"><span class='Ref_to_Typedef'>PageHeader</span></a><span class='Parentheses'>) (</span><a href="bufpage.h.html#LN385"><span class='Ref_to_Parameter'>page</span></a><span class='Parentheses'>))</span><span class='Operator'>-&GT;</span>pd_flags <span class='Operator'>&= ~</span><a href="bufpage.h.html#LN178"><span class='Ref_to_Const'>PD_ALL_VISIBLE</span></a><span class='Parentheses'>)</span> 
 
<a name="LN388"></a><span class='Keyword'>#define </span><span class='Declare_Macro'>PageIsPrunable</span><span class='Parentheses'>(</span><span class='Declare_Parameter'>page</span><span class='Delimiter'>, </span><span class='Declare_Parameter'>oldestxmin</span><span class='Parentheses'>) </span><span class='Operator'>\ 
</span><span class='Parentheses'>(</span> <span class='Operator'>\ 
</span>    <a href="../c.h.html#LN675"><span class='Ref_to_Macro'>AssertMacro</span></a><span class='Parentheses'>(</span><a href="../access/transam.h.html#LN41"><span class='Ref_to_Macro'>TransactionIdIsNormal</span></a><span class='Parentheses'>(</span><a href="bufpage.h.html#LN388"><span class='Ref_to_Parameter'>oldestxmin</span></a><span class='Parentheses'>))</span><span class='Delimiter'>, </span><span class='Operator'>\ 
</span>    <a href="../access/transam.h.html#LN40"><span class='Ref_to_Macro'>TransactionIdIsValid</span></a><span class='Parentheses'>(((</span><a href="bufpage.h.html#LN161"><span class='Ref_to_Typedef'>PageHeader</span></a><span class='Parentheses'>) (</span><a href="bufpage.h.html#LN388"><span class='Ref_to_Parameter'>page</span></a><span class='Parentheses'>))</span><span class='Operator'>-&GT;</span>pd_prune_xid<span class='Parentheses'>)</span> <span class='Operator'>&& \ 
</span>    <a href="../access/transam.h.html#LN168"><span class='Ref_to_Proto'>TransactionIdPrecedes</span></a><span class='Parentheses'>(((</span><a href="bufpage.h.html#LN161"><span class='Ref_to_Typedef'>PageHeader</span></a><span class='Parentheses'>) (</span><a href="bufpage.h.html#LN388"><span class='Ref_to_Parameter'>page</span></a><span class='Parentheses'>))</span><span class='Operator'>-&GT;</span>pd_prune_xid<span class='Delimiter'>, </span><a href="bufpage.h.html#LN388"><span class='Ref_to_Parameter'>oldestxmin</span></a><span class='Parentheses'>)</span> <span class='Operator'>\ 
</span><span class='Parentheses'>)</span> 
<a name="LN394"></a><span class='Keyword'>#define </span><span class='Declare_Macro'>PageSetPrunable</span><span class='Parentheses'>(</span><span class='Declare_Parameter'>page</span><span class='Delimiter'>, </span><span class='Declare_Parameter'>xid</span><span class='Parentheses'>) </span><span class='Operator'>\ 
</span><span class='Control'>do</span> <span class='Delimiter'>{ </span><span class='Operator'>\ 
</span>    <span class='Debug'>Assert</span><span class='Parentheses'>(</span><a href="../access/transam.h.html#LN41"><span class='Ref_to_Macro'>TransactionIdIsNormal</span></a><span class='Parentheses'>(</span><a href="bufpage.h.html#LN394"><span class='Ref_to_Parameter'>xid</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; </span><span class='Operator'>\ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../access/transam.h.html#LN40"><span class='Ref_to_Macro'>TransactionIdIsValid</span></a><span class='Parentheses'>(((</span><a href="bufpage.h.html#LN161"><span class='Ref_to_Typedef'>PageHeader</span></a><span class='Parentheses'>) (</span><a href="bufpage.h.html#LN394"><span class='Ref_to_Parameter'>page</span></a><span class='Parentheses'>))</span><span class='Operator'>-&GT;</span>pd_prune_xid<span class='Parentheses'>)</span> <span class='Operator'>|| \ 
</span>        <a href="../access/transam.h.html#LN168"><span class='Ref_to_Proto'>TransactionIdPrecedes</span></a><span class='Parentheses'>(</span><a href="bufpage.h.html#LN394"><span class='Ref_to_Parameter'>xid</span></a><span class='Delimiter'>, </span><span class='Parentheses'>((</span><a href="bufpage.h.html#LN161"><span class='Ref_to_Typedef'>PageHeader</span></a><span class='Parentheses'>) (</span><a href="bufpage.h.html#LN394"><span class='Ref_to_Parameter'>page</span></a><span class='Parentheses'>))</span><span class='Operator'>-&GT;</span>pd_prune_xid<span class='Parentheses'>))</span> <span class='Operator'>\ 
</span>        <span class='Parentheses'>((</span><a href="bufpage.h.html#LN161"><span class='Ref_to_Typedef'>PageHeader</span></a><span class='Parentheses'>) (</span><a href="bufpage.h.html#LN394"><span class='Ref_to_Parameter'>page</span></a><span class='Parentheses'>))</span><span class='Operator'>-&GT;</span>pd_prune_xid <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="bufpage.h.html#LN394"><span class='Ref_to_Parameter'>xid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; </span><span class='Operator'>\ 
</span><span class='Delimiter'>} </span><span class='Control'>while</span> <span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>) 
</span><a name="LN401"></a><span class='Keyword'>#define </span><span class='Declare_Macro'>PageClearPrunable</span><span class='Parentheses'>(</span><span class='Declare_Parameter'>page</span><span class='Parentheses'>) </span><span class='Operator'>\ 
</span>    <span class='Parentheses'>(((</span><a href="bufpage.h.html#LN161"><span class='Ref_to_Typedef'>PageHeader</span></a><span class='Parentheses'>) (</span><a href="bufpage.h.html#LN401"><span class='Ref_to_Parameter'>page</span></a><span class='Parentheses'>))</span><span class='Operator'>-&GT;</span>pd_prune_xid <span class='Operator'>= </span><a href="../access/transam.h.html#LN30"><span class='Ref_to_Const'>InvalidTransactionId</span></a><span class='Parentheses'>)</span> 
 
 
<span class='Comment_Multi_Line'>/* ---------------------------------------------------------------- 
 *      extern declarations 
 * ---------------------------------------------------------------- 
 */ 
</span><a name="LN409"></a><span class='Keyword'>#define </span><span class='Declare_Constant'>PAI_OVERWRITE</span>           <span class='Parentheses'>(</span><span class='Number'>1</span> <span class='Operator'>&LT;&LT; </span><span class='Number'>0</span><span class='Parentheses'>) 
</span><a name="LN410"></a><span class='Keyword'>#define </span><span class='Declare_Constant'>PAI_IS_HEAP</span>             <span class='Parentheses'>(</span><span class='Number'>1</span> <span class='Operator'>&LT;&LT; </span><span class='Number'>1</span><span class='Parentheses'>) 
</span> 
<a name="LN412"></a><span class='Keyword'>#define </span><span class='Declare_Macro'>PageAddItem</span><span class='Parentheses'>(</span><span class='Declare_Parameter'>page</span><span class='Delimiter'>, </span><span class='Declare_Parameter'>item</span><span class='Delimiter'>, </span><span class='Declare_Parameter'>size</span><span class='Delimiter'>, </span><span class='Declare_Parameter'>offsetNumber</span><span class='Delimiter'>, </span><span class='Declare_Parameter'>overwrite</span><span class='Delimiter'>, </span><span class='Declare_Parameter'>is_heap</span><span class='Parentheses'>) </span><span class='Operator'>\ 
</span>    <a href="../../backend/storage/page/bufpage.c.html#LN188"><span class='Ref_to_Func'>PageAddItemExtended</span></a><span class='Parentheses'>(</span><a href="bufpage.h.html#LN412"><span class='Ref_to_Parameter'>page</span></a><span class='Delimiter'>, </span><a href="bufpage.h.html#LN412"><span class='Ref_to_Parameter'>item</span></a><span class='Delimiter'>, </span><a href="bufpage.h.html#LN412"><span class='Ref_to_Parameter'>size</span></a><span class='Delimiter'>, </span><a href="bufpage.h.html#LN412"><span class='Ref_to_Parameter'>offsetNumber</span></a><span class='Delimiter'>, </span><span class='Operator'>\ 
</span>                        <span class='Parentheses'>((</span><a href="bufpage.h.html#LN412"><span class='Ref_to_Parameter'>overwrite</span></a><span class='Parentheses'>) </span><span class='Operator'>? </span><a href="bufpage.h.html#LN409"><span class='Ref_to_Const'>PAI_OVERWRITE</span></a> <span class='Operator'>: </span><span class='Number'>0</span><span class='Parentheses'>)</span> <span class='Operator'>| \ 
</span>                        <span class='Parentheses'>((</span><a href="bufpage.h.html#LN412"><span class='Ref_to_Parameter'>is_heap</span></a><span class='Parentheses'>) </span><span class='Operator'>? </span><a href="bufpage.h.html#LN410"><span class='Ref_to_Const'>PAI_IS_HEAP</span></a> <span class='Operator'>: </span><span class='Number'>0</span><span class='Parentheses'>))</span> 
 
<a name="LN417"></a><span class='Keyword'>extern void </span><span class='Declare_Prototype'>PageInit</span><span class='Parentheses'>(</span><a href="bufpage.h.html#LN73"><span class='Ref_to_Typedef'>Page</span></a> <span class='Declare_Parameter'>page</span><span class='Delimiter'>, </span><a href="../c.h.html#LN355"><span class='Ref_to_Typedef'>Size</span></a> <span class='Declare_Parameter'>pageSize</span><span class='Delimiter'>, </span><a href="../c.h.html#LN355"><span class='Ref_to_Typedef'>Size</span></a> <span class='Declare_Parameter'>specialSize</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN418"></a><span class='Keyword'>extern bool </span><span class='Declare_Prototype'>PageIsVerified</span><span class='Parentheses'>(</span><a href="bufpage.h.html#LN73"><span class='Ref_to_Typedef'>Page</span></a> <span class='Declare_Parameter'>page</span><span class='Delimiter'>, </span><a href="block.h.html#LN30"><span class='Ref_to_Typedef'>BlockNumber</span></a> <span class='Declare_Parameter'>blkno</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN419"></a><span class='Keyword'>extern </span><a href="off.h.html#LN23"><span class='Ref_to_Typedef'>OffsetNumber</span></a> <span class='Declare_Prototype'>PageAddItemExtended</span><span class='Parentheses'>(</span><a href="bufpage.h.html#LN73"><span class='Ref_to_Typedef'>Page</span></a> <span class='Declare_Parameter'>page</span><span class='Delimiter'>, </span><a href="item.h.html#LN16"><span class='Ref_to_Typedef'>Item</span></a> <span class='Declare_Parameter'>item</span><span class='Delimiter'>, </span><a href="../c.h.html#LN355"><span class='Ref_to_Typedef'>Size</span></a> <span class='Declare_Parameter'>size</span><span class='Delimiter'>, 
</span><a name="LN420"></a>                    <a href="off.h.html#LN23"><span class='Ref_to_Typedef'>OffsetNumber</span></a> <span class='Declare_Parameter'>offsetNumber</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>flags</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN421"></a><span class='Keyword'>extern </span><a href="bufpage.h.html#LN73"><span class='Ref_to_Typedef'>Page</span></a> <span class='Declare_Prototype'>PageGetTempPage</span><span class='Parentheses'>(</span><a href="bufpage.h.html#LN73"><span class='Ref_to_Typedef'>Page</span></a> <span class='Declare_Parameter'>page</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN422"></a><span class='Keyword'>extern </span><a href="bufpage.h.html#LN73"><span class='Ref_to_Typedef'>Page</span></a> <span class='Declare_Prototype'>PageGetTempPageCopy</span><span class='Parentheses'>(</span><a href="bufpage.h.html#LN73"><span class='Ref_to_Typedef'>Page</span></a> <span class='Declare_Parameter'>page</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN423"></a><span class='Keyword'>extern </span><a href="bufpage.h.html#LN73"><span class='Ref_to_Typedef'>Page</span></a> <span class='Declare_Prototype'>PageGetTempPageCopySpecial</span><span class='Parentheses'>(</span><a href="bufpage.h.html#LN73"><span class='Ref_to_Typedef'>Page</span></a> <span class='Declare_Parameter'>page</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN424"></a><span class='Keyword'>extern void </span><span class='Declare_Prototype'>PageRestoreTempPage</span><span class='Parentheses'>(</span><a href="bufpage.h.html#LN73"><span class='Ref_to_Typedef'>Page</span></a> <span class='Declare_Parameter'>tempPage</span><span class='Delimiter'>, </span><a href="bufpage.h.html#LN73"><span class='Ref_to_Typedef'>Page</span></a> <span class='Declare_Parameter'>oldPage</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN425"></a><span class='Keyword'>extern void </span><span class='Declare_Prototype'>PageRepairFragmentation</span><span class='Parentheses'>(</span><a href="bufpage.h.html#LN73"><span class='Ref_to_Typedef'>Page</span></a> <span class='Declare_Parameter'>page</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN426"></a><span class='Keyword'>extern </span><a href="../c.h.html#LN355"><span class='Ref_to_Typedef'>Size</span></a> <span class='Declare_Prototype'>PageGetFreeSpace</span><span class='Parentheses'>(</span><a href="bufpage.h.html#LN73"><span class='Ref_to_Typedef'>Page</span></a> <span class='Declare_Parameter'>page</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN427"></a><span class='Keyword'>extern </span><a href="../c.h.html#LN355"><span class='Ref_to_Typedef'>Size</span></a> <span class='Declare_Prototype'>PageGetFreeSpaceForMultipleTuples</span><span class='Parentheses'>(</span><a href="bufpage.h.html#LN73"><span class='Ref_to_Typedef'>Page</span></a> <span class='Declare_Parameter'>page</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>ntups</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN428"></a><span class='Keyword'>extern </span><a href="../c.h.html#LN355"><span class='Ref_to_Typedef'>Size</span></a> <span class='Declare_Prototype'>PageGetExactFreeSpace</span><span class='Parentheses'>(</span><a href="bufpage.h.html#LN73"><span class='Ref_to_Typedef'>Page</span></a> <span class='Declare_Parameter'>page</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN429"></a><span class='Keyword'>extern </span><a href="../c.h.html#LN355"><span class='Ref_to_Typedef'>Size</span></a> <span class='Declare_Prototype'>PageGetHeapFreeSpace</span><span class='Parentheses'>(</span><a href="bufpage.h.html#LN73"><span class='Ref_to_Typedef'>Page</span></a> <span class='Declare_Parameter'>page</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN430"></a><span class='Keyword'>extern void </span><span class='Declare_Prototype'>PageIndexTupleDelete</span><span class='Parentheses'>(</span><a href="bufpage.h.html#LN73"><span class='Ref_to_Typedef'>Page</span></a> <span class='Declare_Parameter'>page</span><span class='Delimiter'>, </span><a href="off.h.html#LN23"><span class='Ref_to_Typedef'>OffsetNumber</span></a> <span class='Declare_Parameter'>offset</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN431"></a><span class='Keyword'>extern void </span><span class='Declare_Prototype'>PageIndexMultiDelete</span><span class='Parentheses'>(</span><a href="bufpage.h.html#LN73"><span class='Ref_to_Typedef'>Page</span></a> <span class='Declare_Parameter'>page</span><span class='Delimiter'>, </span><a href="off.h.html#LN23"><span class='Ref_to_Typedef'>OffsetNumber</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>itemnos</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>nitems</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN432"></a><span class='Keyword'>extern void </span><span class='Declare_Prototype'>PageIndexTupleDeleteNoCompact</span><span class='Parentheses'>(</span><a href="bufpage.h.html#LN73"><span class='Ref_to_Typedef'>Page</span></a> <span class='Declare_Parameter'>page</span><span class='Delimiter'>, </span><a href="off.h.html#LN23"><span class='Ref_to_Typedef'>OffsetNumber</span></a> <span class='Declare_Parameter'>offset</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN433"></a><span class='Keyword'>extern bool </span><span class='Declare_Prototype'>PageIndexTupleOverwrite</span><span class='Parentheses'>(</span><a href="bufpage.h.html#LN73"><span class='Ref_to_Typedef'>Page</span></a> <span class='Declare_Parameter'>page</span><span class='Delimiter'>, </span><a href="off.h.html#LN23"><span class='Ref_to_Typedef'>OffsetNumber</span></a> <span class='Declare_Parameter'>offnum</span><span class='Delimiter'>, 
</span><a name="LN434"></a>                        <a href="item.h.html#LN16"><span class='Ref_to_Typedef'>Item</span></a> <span class='Declare_Parameter'>newtup</span><span class='Delimiter'>, </span><a href="../c.h.html#LN355"><span class='Ref_to_Typedef'>Size</span></a> <span class='Declare_Parameter'>newsize</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN435"></a><span class='Keyword'>extern char </span><span class='Operator'>*</span><span class='Declare_Prototype'>PageSetChecksumCopy</span><span class='Parentheses'>(</span><a href="bufpage.h.html#LN73"><span class='Ref_to_Typedef'>Page</span></a> <span class='Declare_Parameter'>page</span><span class='Delimiter'>, </span><a href="block.h.html#LN30"><span class='Ref_to_Typedef'>BlockNumber</span></a> <span class='Declare_Parameter'>blkno</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN436"></a><span class='Keyword'>extern void </span><span class='Declare_Prototype'>PageSetChecksumInplace</span><span class='Parentheses'>(</span><a href="bufpage.h.html#LN73"><span class='Ref_to_Typedef'>Page</span></a> <span class='Declare_Parameter'>page</span><span class='Delimiter'>, </span><a href="block.h.html#LN30"><span class='Ref_to_Typedef'>BlockNumber</span></a> <span class='Declare_Parameter'>blkno</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
<span class='Directive'>#endif</span>   <span class='Comment_Single_Line'>/* BUFPAGE_H */ 
</span></pre>
<table bgcolor='#c0c0c0' width='100%'><tr><td><a href='../../../Contents.html'>Contents</a></td></tr>
</table><hr><p class='blurb' align='center'><a href='http://www.sourceinsight.com'>HTML Created by Source Insight Version 4.00.0084 Built on 2017-02-26</a></p>
</body></html>