<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta name="generator" content="Source Insight Version 4.00.0084 Built on 2017-02-26">
<meta charset='UTF-8' />
<style type='text/css'><!--
TD {background-color: #C0C0C0; font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 70%; }
.blurb {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 70%; }
.filename {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 120%; font-weight: bold; }
.dirname {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 100%; font-weight: bold; margin-top: 2.5em;}
--></style>
<title>src\include\utils\jsonb.h</title>
<LINK REL=StyleSheet HREF="../../../C_Cpp_Source_File.css" TYPE='text/css' MEDIA=screen>
</head>
<body bgcolor=#ffffff>
<table bgcolor='#c0c0c0' width='100%'>
<tr><td><p class='filename'><b>src\include\utils\jsonb.h</b></p></td>
<td align='right'>
Wed Jun 14 08:26:08 2017
</td></tr>
<tr><td><a href='../../../Contents.html'>Contents</a></td></tr>
</table>
<pre>
</span><span class='Comment_Multi_Line'>/*------------------------------------------------------------------------- 
 * 
 * jsonb.h 
 *    Declarations for jsonb data type support. 
 * 
 * Copyright (c) 1996-2017, PostgreSQL Global Development Group 
 * 
 * src/include/utils/jsonb.h 
 * 
 *------------------------------------------------------------------------- 
 */ 
</span><span class='Directive'>#ifndef</span> <a href="jsonb.h.html#LN12"><span class='Ref_to_Const'>__JSONB_H__</span></a> 
<a name="LN12"></a><span class='Keyword'>#define </span><span class='Declare_Constant'>__JSONB_H__</span> 
 
<span class='Keyword'>#include </span><span class='String'>"lib/stringinfo.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"utils/array.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"utils/numeric.h"</span> 
 
<span class='Comment_Multi_Line'>/* Tokens used when sequentially processing a jsonb value */ 
</span><span class='Control'>typedef</span> <span class='Control'>enum</span> 
<span class='Delimiter'>{ 
</span><a name="LN21"></a>    <span class='Declare_Enum_Const'>WJB_DONE</span><span class='Delimiter'>, 
</span><a name="LN22"></a>    <span class='Declare_Enum_Const'>WJB_KEY</span><span class='Delimiter'>, 
</span><a name="LN23"></a>    <span class='Declare_Enum_Const'>WJB_VALUE</span><span class='Delimiter'>, 
</span><a name="LN24"></a>    <span class='Declare_Enum_Const'>WJB_ELEM</span><span class='Delimiter'>, 
</span><a name="LN25"></a>    <span class='Declare_Enum_Const'>WJB_BEGIN_ARRAY</span><span class='Delimiter'>, 
</span><a name="LN26"></a>    <span class='Declare_Enum_Const'>WJB_END_ARRAY</span><span class='Delimiter'>, 
</span><a name="LN27"></a>    <span class='Declare_Enum_Const'>WJB_BEGIN_OBJECT</span><span class='Delimiter'>, 
</span><a name="LN28"></a>    <span class='Declare_Enum_Const'>WJB_END_OBJECT</span> 
<a name="LN29"></a><span class='Delimiter'>} </span><span class='Declare_Typedef'>JsonbIteratorToken</span><span class='Delimiter'>; 
</span> 
<span class='Comment_Multi_Line'>/* Strategy numbers for GIN index opclasses */ 
</span><a name="LN32"></a><span class='Keyword'>#define </span><span class='Declare_Constant'>JsonbContainsStrategyNumber</span>     <span class='Number'>7</span> 
<a name="LN33"></a><span class='Keyword'>#define </span><span class='Declare_Constant'>JsonbExistsStrategyNumber</span>       <span class='Number'>9</span> 
<a name="LN34"></a><span class='Keyword'>#define </span><span class='Declare_Constant'>JsonbExistsAnyStrategyNumber</span>    <span class='Number'>10</span> 
<a name="LN35"></a><span class='Keyword'>#define </span><span class='Declare_Constant'>JsonbExistsAllStrategyNumber</span>    <span class='Number'>11</span> 
 
<span class='Comment_Multi_Line'>/* 
 * In the standard jsonb_ops GIN opclass for jsonb, we choose to index both 
 * keys and values.  The storage format is text.  The first byte of the text 
 * string distinguishes whether this is a key (always a string), null value, 
 * boolean value, numeric value, or string value.  However, array elements 
 * that are strings are marked as though they were keys; this imprecision 
 * supports the definition of the "exists" operator, which treats array 
 * elements like keys.  The remainder of the text string is empty for a null 
 * value, "t" or "f" for a boolean value, a normalized print representation of 
 * a numeric value, or the text of a string value.  However, if the length of 
 * this text representation would exceed JGIN_MAXLENGTH bytes, we instead hash 
 * the text representation and store an 8-hex-digit representation of the 
 * uint32 hash value, marking the prefix byte with an additional bit to 
 * distinguish that this has happened.  Hashing long strings saves space and 
 * ensures that we won't overrun the maximum entry length for a GIN index. 
 * (But JGIN_MAXLENGTH is quite a bit shorter than GIN's limit.  It's chosen 
 * to ensure that the on-disk text datum will have a short varlena header.) 
 * Note that when any hashed item appears in a query, we must recheck index 
 * matches against the heap tuple; currently, this costs nothing because we 
 * must always recheck for other reasons. 
 */ 
</span><a name="LN58"></a><span class='Keyword'>#define </span><span class='Declare_Constant'>JGINFLAG_KEY</span>    <span class='Number'>0x01</span>    <span class='Comment_Single_Line'>/* key (or string array element) */ 
</span><a name="LN59"></a><span class='Keyword'>#define </span><span class='Declare_Constant'>JGINFLAG_NULL</span>   <span class='Number'>0x02</span>    <span class='Comment_Single_Line'>/* null value */ 
</span><a name="LN60"></a><span class='Keyword'>#define </span><span class='Declare_Constant'>JGINFLAG_BOOL</span>   <span class='Number'>0x03</span>    <span class='Comment_Single_Line'>/* boolean value */ 
</span><a name="LN61"></a><span class='Keyword'>#define </span><span class='Declare_Constant'>JGINFLAG_NUM</span>    <span class='Number'>0x04</span>    <span class='Comment_Single_Line'>/* numeric value */ 
</span><a name="LN62"></a><span class='Keyword'>#define </span><span class='Declare_Constant'>JGINFLAG_STR</span>    <span class='Number'>0x05</span>    <span class='Comment_Single_Line'>/* string value (if not an array element) */ 
</span><a name="LN63"></a><span class='Keyword'>#define </span><span class='Declare_Constant'>JGINFLAG_HASHED</span> <span class='Number'>0x10</span>    <span class='Comment_Single_Line'>/* OR'd into flag if value was hashed */ 
</span><a name="LN64"></a><span class='Keyword'>#define </span><span class='Declare_Constant'>JGIN_MAXLENGTH</span>  <span class='Number'>125</span>     <span class='Comment_Single_Line'>/* max length of text part before hashing */ 
</span> 
<span class='Comment_Multi_Line'>/* Convenience macros */ 
</span><a name="LN67"></a><span class='Keyword'>#define </span><span class='Declare_Macro'>DatumGetJsonb</span><span class='Parentheses'>(</span><span class='Declare_Parameter'>d</span><span class='Parentheses'>)</span>    <span class='Parentheses'>((</span><a href="jsonb.h.html#LN214"><span class='Ref_to_Typedef'>Jsonb</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../fmgr.h.html#LN204"><span class='Ref_to_Macro'>PG_DETOAST_DATUM</span></a><span class='Parentheses'>(</span><a href="jsonb.h.html#LN67"><span class='Ref_to_Parameter'>d</span></a><span class='Parentheses'>))</span> 
<a name="LN68"></a><span class='Keyword'>#define </span><span class='Declare_Macro'>JsonbGetDatum</span><span class='Parentheses'>(</span><span class='Declare_Parameter'>p</span><span class='Parentheses'>)</span>    <a href="../postgres.h.html#LN561"><span class='Ref_to_Macro'>PointerGetDatum</span></a><span class='Parentheses'>(</span><a href="jsonb.h.html#LN68"><span class='Ref_to_Parameter'>p</span></a><span class='Parentheses'>) 
</span><a name="LN69"></a><span class='Keyword'>#define </span><span class='Declare_Macro'>PG_GETARG_JSONB</span><span class='Parentheses'>(</span><span class='Declare_Parameter'>x</span><span class='Parentheses'>)</span>  <a href="jsonb.h.html#LN67"><span class='Ref_to_Macro'>DatumGetJsonb</span></a><span class='Parentheses'>(</span><a href="../fmgr.h.html#LN232"><span class='Ref_to_Macro'>PG_GETARG_DATUM</span></a><span class='Parentheses'>(</span><a href="jsonb.h.html#LN69"><span class='Ref_to_Parameter'>x</span></a><span class='Parentheses'>))</span> 
<a name="LN70"></a><span class='Keyword'>#define </span><span class='Declare_Macro'>PG_RETURN_JSONB</span><span class='Parentheses'>(</span><span class='Declare_Parameter'>x</span><span class='Parentheses'>)</span>  <a href="../fmgr.h.html#LN320"><span class='Ref_to_Macro'>PG_RETURN_POINTER</span></a><span class='Parentheses'>(</span><a href="jsonb.h.html#LN70"><span class='Ref_to_Parameter'>x</span></a><span class='Parentheses'>) 
</span> 
<a name="LN72"></a><span class='Control'>typedef</span> <span class='Control'>struct</span> <a href="jsonb.h.html#LN295"><span class='Ref_to_Struct'>JsonbPair</span></a> <span class='Declare_Typedef'>JsonbPair</span><span class='Delimiter'>; 
</span><a name="LN73"></a><span class='Control'>typedef</span> <span class='Control'>struct</span> <a href="jsonb.h.html#LN247"><span class='Ref_to_Struct'>JsonbValue</span></a> <span class='Declare_Typedef'>JsonbValue</span><span class='Delimiter'>; 
</span> 
<span class='Comment_Multi_Line'>/* 
 * Jsonbs are varlena objects, so must meet the varlena convention that the 
 * first int32 of the object contains the total object size in bytes.  Be sure 
 * to use VARSIZE() and SET_VARSIZE() to access it, though! 
 * 
 * Jsonb is the on-disk representation, in contrast to the in-memory JsonbValue 
 * representation.  Often, JsonbValues are just shims through which a Jsonb 
 * buffer is accessed, but they can also be deep copied and passed around. 
 * 
 * Jsonb is a tree structure. Each node in the tree consists of a JEntry 
 * header and a variable-length content (possibly of zero size).  The JEntry 
 * header indicates what kind of a node it is, e.g. a string or an array, 
 * and provides the length of its variable-length portion. 
 * 
 * The JEntry and the content of a node are not stored physically together. 
 * Instead, the container array or object has an array that holds the JEntrys 
 * of all the child nodes, followed by their variable-length portions. 
 * 
 * The root node is an exception; it has no parent array or object that could 
 * hold its JEntry. Hence, no JEntry header is stored for the root node.  It 
 * is implicitly known that the root node must be an array or an object, 
 * so we can get away without the type indicator as long as we can distinguish 
 * the two.  For that purpose, both an array and an object begin with a uint32 
 * header field, which contains an JB_FOBJECT or JB_FARRAY flag.  When a naked 
 * scalar value needs to be stored as a Jsonb value, what we actually store is 
 * an array with one element, with the flags in the array's header field set 
 * to JB_FSCALAR | JB_FARRAY. 
 * 
 * Overall, the Jsonb struct requires 4-bytes alignment. Within the struct, 
 * the variable-length portion of some node types is aligned to a 4-byte 
 * boundary, while others are not. When alignment is needed, the padding is 
 * in the beginning of the node that requires it. For example, if a numeric 
 * node is stored after a string node, so that the numeric node begins at 
 * offset 3, the variable-length portion of the numeric node will begin with 
 * one padding byte so that the actual numeric data is 4-byte aligned. 
 */ 
</span> 
<span class='Comment_Multi_Line'>/* 
 * JEntry format. 
 * 
 * The least significant 28 bits store either the data length of the entry, 
 * or its end+1 offset from the start of the variable-length portion of the 
 * containing object.  The next three bits store the type of the entry, and 
 * the high-order bit tells whether the least significant bits store a length 
 * or an offset. 
 * 
 * The reason for the offset-or-length complication is to compromise between 
 * access speed and data compressibility.  In the initial design each JEntry 
 * always stored an offset, but this resulted in JEntry arrays with horrible 
 * compressibility properties, so that TOAST compression of a JSONB did not 
 * work well.  Storing only lengths would greatly improve compressibility, 
 * but it makes random access into large arrays expensive (O(N) not O(1)). 
 * So what we do is store an offset in every JB_OFFSET_STRIDE'th JEntry and 
 * a length in the rest.  This results in reasonably compressible data (as 
 * long as the stride isn't too small).  We may have to examine as many as 
 * JB_OFFSET_STRIDE JEntrys in order to find out the offset or length of any 
 * given item, but that's still O(1) no matter how large the container is. 
 * 
 * We could avoid eating a flag bit for this purpose if we were to store 
 * the stride in the container header, or if we were willing to treat the 
 * stride as an unchangeable constant.  Neither of those options is very 
 * attractive though. 
 */ 
</span><a name="LN138"></a><span class='Control'>typedef</span> <a href="../c.h.html#LN267"><span class='Ref_to_Typedef'>uint32</span></a> <span class='Declare_Typedef'>JEntry</span><span class='Delimiter'>; 
</span> 
<a name="LN140"></a><span class='Keyword'>#define </span><span class='Declare_Constant'>JENTRY_OFFLENMASK</span>       <span class='Number'>0x0FFFFFFF</span> 
<a name="LN141"></a><span class='Keyword'>#define </span><span class='Declare_Constant'>JENTRY_TYPEMASK</span>         <span class='Number'>0x70000000</span> 
<a name="LN142"></a><span class='Keyword'>#define </span><span class='Declare_Constant'>JENTRY_HAS_OFF</span>          <span class='Number'>0x80000000</span> 
 
<span class='Comment_Multi_Line'>/* values stored in the type bits */ 
</span><a name="LN145"></a><span class='Keyword'>#define </span><span class='Declare_Constant'>JENTRY_ISSTRING</span>         <span class='Number'>0x00000000</span> 
<a name="LN146"></a><span class='Keyword'>#define </span><span class='Declare_Constant'>JENTRY_ISNUMERIC</span>        <span class='Number'>0x10000000</span> 
<a name="LN147"></a><span class='Keyword'>#define </span><span class='Declare_Constant'>JENTRY_ISBOOL_FALSE</span>     <span class='Number'>0x20000000</span> 
<a name="LN148"></a><span class='Keyword'>#define </span><span class='Declare_Constant'>JENTRY_ISBOOL_TRUE</span>      <span class='Number'>0x30000000</span> 
<a name="LN149"></a><span class='Keyword'>#define </span><span class='Declare_Constant'>JENTRY_ISNULL</span>           <span class='Number'>0x40000000</span> 
<a name="LN150"></a><span class='Keyword'>#define </span><span class='Declare_Constant'>JENTRY_ISCONTAINER</span>      <span class='Number'>0x50000000</span>      <span class='Comment_Single_Line'>/* array or object */ 
</span> 
<span class='Comment_Multi_Line'>/* Access macros.  Note possible multiple evaluations */ 
</span><a name="LN153"></a><span class='Keyword'>#define </span><span class='Declare_Macro'>JBE_OFFLENFLD</span><span class='Parentheses'>(</span><span class='Declare_Parameter'>je_</span><span class='Parentheses'>)</span>      <span class='Parentheses'>((</span><a href="jsonb.h.html#LN153"><span class='Ref_to_Parameter'>je_</span></a><span class='Parentheses'>) </span><span class='Operator'>& </span><a href="jsonb.h.html#LN140"><span class='Ref_to_Const'>JENTRY_OFFLENMASK</span></a><span class='Parentheses'>)</span> 
<a name="LN154"></a><span class='Keyword'>#define </span><span class='Declare_Macro'>JBE_HAS_OFF</span><span class='Parentheses'>(</span><span class='Declare_Parameter'>je_</span><span class='Parentheses'>)</span>        <span class='Parentheses'>(((</span><a href="jsonb.h.html#LN154"><span class='Ref_to_Parameter'>je_</span></a><span class='Parentheses'>) </span><span class='Operator'>& </span><a href="jsonb.h.html#LN142"><span class='Ref_to_Const'>JENTRY_HAS_OFF</span></a><span class='Parentheses'>)</span> <span class='Operator'>!= </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
<a name="LN155"></a><span class='Keyword'>#define </span><span class='Declare_Macro'>JBE_ISSTRING</span><span class='Parentheses'>(</span><span class='Declare_Parameter'>je_</span><span class='Parentheses'>)</span>       <span class='Parentheses'>(((</span><a href="jsonb.h.html#LN155"><span class='Ref_to_Parameter'>je_</span></a><span class='Parentheses'>) </span><span class='Operator'>& </span><a href="jsonb.h.html#LN141"><span class='Ref_to_Const'>JENTRY_TYPEMASK</span></a><span class='Parentheses'>)</span> <span class='Operator'>== </span><a href="jsonb.h.html#LN145"><span class='Ref_to_Const'>JENTRY_ISSTRING</span></a><span class='Parentheses'>)</span> 
<a name="LN156"></a><span class='Keyword'>#define </span><span class='Declare_Macro'>JBE_ISNUMERIC</span><span class='Parentheses'>(</span><span class='Declare_Parameter'>je_</span><span class='Parentheses'>)</span>      <span class='Parentheses'>(((</span><a href="jsonb.h.html#LN156"><span class='Ref_to_Parameter'>je_</span></a><span class='Parentheses'>) </span><span class='Operator'>& </span><a href="jsonb.h.html#LN141"><span class='Ref_to_Const'>JENTRY_TYPEMASK</span></a><span class='Parentheses'>)</span> <span class='Operator'>== </span><a href="jsonb.h.html#LN146"><span class='Ref_to_Const'>JENTRY_ISNUMERIC</span></a><span class='Parentheses'>)</span> 
<a name="LN157"></a><span class='Keyword'>#define </span><span class='Declare_Macro'>JBE_ISCONTAINER</span><span class='Parentheses'>(</span><span class='Declare_Parameter'>je_</span><span class='Parentheses'>)</span>    <span class='Parentheses'>(((</span><a href="jsonb.h.html#LN157"><span class='Ref_to_Parameter'>je_</span></a><span class='Parentheses'>) </span><span class='Operator'>& </span><a href="jsonb.h.html#LN141"><span class='Ref_to_Const'>JENTRY_TYPEMASK</span></a><span class='Parentheses'>)</span> <span class='Operator'>== </span><a href="jsonb.h.html#LN150"><span class='Ref_to_Const'>JENTRY_ISCONTAINER</span></a><span class='Parentheses'>)</span> 
<a name="LN158"></a><span class='Keyword'>#define </span><span class='Declare_Macro'>JBE_ISNULL</span><span class='Parentheses'>(</span><span class='Declare_Parameter'>je_</span><span class='Parentheses'>)</span>         <span class='Parentheses'>(((</span><a href="jsonb.h.html#LN158"><span class='Ref_to_Parameter'>je_</span></a><span class='Parentheses'>) </span><span class='Operator'>& </span><a href="jsonb.h.html#LN141"><span class='Ref_to_Const'>JENTRY_TYPEMASK</span></a><span class='Parentheses'>)</span> <span class='Operator'>== </span><a href="jsonb.h.html#LN149"><span class='Ref_to_Const'>JENTRY_ISNULL</span></a><span class='Parentheses'>)</span> 
<a name="LN159"></a><span class='Keyword'>#define </span><span class='Declare_Macro'>JBE_ISBOOL_TRUE</span><span class='Parentheses'>(</span><span class='Declare_Parameter'>je_</span><span class='Parentheses'>)</span>    <span class='Parentheses'>(((</span><a href="jsonb.h.html#LN159"><span class='Ref_to_Parameter'>je_</span></a><span class='Parentheses'>) </span><span class='Operator'>& </span><a href="jsonb.h.html#LN141"><span class='Ref_to_Const'>JENTRY_TYPEMASK</span></a><span class='Parentheses'>)</span> <span class='Operator'>== </span><a href="jsonb.h.html#LN148"><span class='Ref_to_Const'>JENTRY_ISBOOL_TRUE</span></a><span class='Parentheses'>)</span> 
<a name="LN160"></a><span class='Keyword'>#define </span><span class='Declare_Macro'>JBE_ISBOOL_FALSE</span><span class='Parentheses'>(</span><span class='Declare_Parameter'>je_</span><span class='Parentheses'>)</span>   <span class='Parentheses'>(((</span><a href="jsonb.h.html#LN160"><span class='Ref_to_Parameter'>je_</span></a><span class='Parentheses'>) </span><span class='Operator'>& </span><a href="jsonb.h.html#LN141"><span class='Ref_to_Const'>JENTRY_TYPEMASK</span></a><span class='Parentheses'>)</span> <span class='Operator'>== </span><a href="jsonb.h.html#LN147"><span class='Ref_to_Const'>JENTRY_ISBOOL_FALSE</span></a><span class='Parentheses'>)</span> 
<a name="LN161"></a><span class='Keyword'>#define </span><span class='Declare_Macro'>JBE_ISBOOL</span><span class='Parentheses'>(</span><span class='Declare_Parameter'>je_</span><span class='Parentheses'>)</span>         <span class='Parentheses'>(</span><a href="jsonb.h.html#LN159"><span class='Ref_to_Macro'>JBE_ISBOOL_TRUE</span></a><span class='Parentheses'>(</span><a href="jsonb.h.html#LN161"><span class='Ref_to_Parameter'>je_</span></a><span class='Parentheses'>) </span><span class='Operator'>|| </span><a href="jsonb.h.html#LN160"><span class='Ref_to_Macro'>JBE_ISBOOL_FALSE</span></a><span class='Parentheses'>(</span><a href="jsonb.h.html#LN161"><span class='Ref_to_Parameter'>je_</span></a><span class='Parentheses'>))</span> 
 
<span class='Comment_Multi_Line'>/* Macro for advancing an offset variable to the next JEntry */ 
</span><a name="LN164"></a><span class='Keyword'>#define </span><span class='Declare_Macro'>JBE_ADVANCE_OFFSET</span><span class='Parentheses'>(</span><span class='Declare_Parameter'>offset</span><span class='Delimiter'>, </span><span class='Declare_Parameter'>je</span><span class='Parentheses'>) </span><span class='Operator'>\ 
</span>    <span class='Control'>do</span> <span class='Delimiter'>{ </span><span class='Operator'>\ 
</span>        <a href="jsonb.h.html#LN138"><span class='Ref_to_Typedef'>JEntry</span></a>  je_ <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="jsonb.h.html#LN164"><span class='Ref_to_Parameter'>je</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; </span><span class='Operator'>\ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="jsonb.h.html#LN154"><span class='Ref_to_Macro'>JBE_HAS_OFF</span></a><span class='Parentheses'>(</span>je_<span class='Parentheses'>))</span> <span class='Operator'>\ 
</span>            <span class='Parentheses'>(</span><a href="jsonb.h.html#LN164"><span class='Ref_to_Parameter'>offset</span></a><span class='Parentheses'>) </span><span class='Operator'>= </span><a href="jsonb.h.html#LN153"><span class='Ref_to_Macro'>JBE_OFFLENFLD</span></a><span class='Parentheses'>(</span>je_<span class='Parentheses'>)</span><span class='Delimiter'>; </span><span class='Operator'>\ 
</span>        <span class='Control'>else</span> <span class='Operator'>\ 
</span>            <span class='Parentheses'>(</span><a href="jsonb.h.html#LN164"><span class='Ref_to_Parameter'>offset</span></a><span class='Parentheses'>) </span><span class='Operator'>+= </span><a href="jsonb.h.html#LN153"><span class='Ref_to_Macro'>JBE_OFFLENFLD</span></a><span class='Parentheses'>(</span>je_<span class='Parentheses'>)</span><span class='Delimiter'>; </span><span class='Operator'>\ 
</span>    <span class='Delimiter'>} </span><span class='Control'>while</span><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>) 
</span> 
<span class='Comment_Multi_Line'>/* 
 * We store an offset, not a length, every JB_OFFSET_STRIDE children. 
 * Caution: this macro should only be referenced when creating a JSONB 
 * value.  When examining an existing value, pay attention to the HAS_OFF 
 * bits instead.  This allows changes in the offset-placement heuristic 
 * without breaking on-disk compatibility. 
 */ 
</span><a name="LN180"></a><span class='Keyword'>#define </span><span class='Declare_Constant'>JB_OFFSET_STRIDE</span>        <span class='Number'>32</span> 
 
<span class='Comment_Multi_Line'>/* 
 * A jsonb array or object node, within a Jsonb Datum. 
 * 
 * An array has one child for each element, stored in array order. 
 * 
 * An object has two children for each key/value pair.  The keys all appear 
 * first, in key sort order; then the values appear, in an order matching the 
 * key order.  This arrangement keeps the keys compact in memory, making a 
 * search for a particular key more cache-friendly. 
 */ 
</span><a name="LN192"></a><span class='Control'>typedef</span> <span class='Control'>struct</span> <span class='Declare_Struct'>JsonbContainer</span> 
<span class='Delimiter'>{ 
</span><a name="LN194"></a>    <a href="../c.h.html#LN267"><span class='Ref_to_Typedef'>uint32</span></a>      <span class='Declare_Member'>header</span><span class='Delimiter'>;</span>         <span class='Comment_Multi_Line'>/* number of elements or key/value pairs, and 
                                 * flags */ 
</span><a name="LN196"></a>    <a href="jsonb.h.html#LN138"><span class='Ref_to_Typedef'>JEntry</span></a>      <span class='Declare_Member'>children</span><span class='Delimiter'>[</span>FLEXIBLE_ARRAY_MEMBER<span class='Delimiter'>]; 
</span> 
    <span class='Comment_Multi_Line'>/* the data for each child node follows. */ 
</span><a name="LN199"></a><span class='Delimiter'>} </span><span class='Declare_Typedef'>JsonbContainer</span><span class='Delimiter'>; 
</span> 
<span class='Comment_Multi_Line'>/* flags for the header-field in JsonbContainer */ 
</span><a name="LN202"></a><span class='Keyword'>#define </span><span class='Declare_Constant'>JB_CMASK</span>                <span class='Number'>0x0FFFFFFF</span>      <span class='Comment_Single_Line'>/* mask for count field */ 
</span><a name="LN203"></a><span class='Keyword'>#define </span><span class='Declare_Constant'>JB_FSCALAR</span>              <span class='Number'>0x10000000</span>      <span class='Comment_Single_Line'>/* flag bits */ 
</span><a name="LN204"></a><span class='Keyword'>#define </span><span class='Declare_Constant'>JB_FOBJECT</span>              <span class='Number'>0x20000000</span> 
<a name="LN205"></a><span class='Keyword'>#define </span><span class='Declare_Constant'>JB_FARRAY</span>               <span class='Number'>0x40000000</span> 
 
<span class='Comment_Multi_Line'>/* convenience macros for accessing a JsonbContainer struct */ 
</span><a name="LN208"></a><span class='Keyword'>#define </span><span class='Declare_Macro'>JsonContainerSize</span><span class='Parentheses'>(</span><span class='Declare_Parameter'>jc</span><span class='Parentheses'>)</span>       <span class='Parentheses'>((</span><a href="jsonb.h.html#LN208"><span class='Ref_to_Parameter'>jc</span></a><span class='Parentheses'>)</span><span class='Operator'>-&GT;</span>header <span class='Operator'>& </span><a href="jsonb.h.html#LN202"><span class='Ref_to_Const'>JB_CMASK</span></a><span class='Parentheses'>)</span> 
<a name="LN209"></a><span class='Keyword'>#define </span><span class='Declare_Macro'>JsonContainerIsScalar</span><span class='Parentheses'>(</span><span class='Declare_Parameter'>jc</span><span class='Parentheses'>)</span>   <span class='Parentheses'>(((</span><a href="jsonb.h.html#LN209"><span class='Ref_to_Parameter'>jc</span></a><span class='Parentheses'>)</span><span class='Operator'>-&GT;</span>header <span class='Operator'>& </span><a href="jsonb.h.html#LN203"><span class='Ref_to_Const'>JB_FSCALAR</span></a><span class='Parentheses'>)</span> <span class='Operator'>!= </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
<a name="LN210"></a><span class='Keyword'>#define </span><span class='Declare_Macro'>JsonContainerIsObject</span><span class='Parentheses'>(</span><span class='Declare_Parameter'>jc</span><span class='Parentheses'>)</span>   <span class='Parentheses'>(((</span><a href="jsonb.h.html#LN210"><span class='Ref_to_Parameter'>jc</span></a><span class='Parentheses'>)</span><span class='Operator'>-&GT;</span>header <span class='Operator'>& </span><a href="jsonb.h.html#LN204"><span class='Ref_to_Const'>JB_FOBJECT</span></a><span class='Parentheses'>)</span> <span class='Operator'>!= </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
<a name="LN211"></a><span class='Keyword'>#define </span><span class='Declare_Macro'>JsonContainerIsArray</span><span class='Parentheses'>(</span><span class='Declare_Parameter'>jc</span><span class='Parentheses'>)</span>    <span class='Parentheses'>(((</span><a href="jsonb.h.html#LN211"><span class='Ref_to_Parameter'>jc</span></a><span class='Parentheses'>)</span><span class='Operator'>-&GT;</span>header <span class='Operator'>& </span><a href="jsonb.h.html#LN205"><span class='Ref_to_Const'>JB_FARRAY</span></a><span class='Parentheses'>)</span> <span class='Operator'>!= </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
 
<span class='Comment_Multi_Line'>/* The top-level on-disk format for a jsonb datum. */ 
</span><span class='Control'>typedef</span> <span class='Control'>struct</span> 
<span class='Delimiter'>{ 
</span><a name="LN216"></a>    <a href="../c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>       <span class='Declare_Member'>vl_len_</span><span class='Delimiter'>;</span>        <span class='Comment_Single_Line'>/* varlena header (do not touch directly!) */ 
</span><a name="LN217"></a>    <a href="jsonb.h.html#LN192"><span class='Ref_to_Struct'>JsonbContainer</span></a> <span class='Declare_Member'>root</span><span class='Delimiter'>; 
</span><a name="LN218"></a>} <span class='Declare_Typedef'>Jsonb</span><span class='Delimiter'>; 
</span> 
<span class='Comment_Multi_Line'>/* convenience macros for accessing the root container in a Jsonb datum */ 
</span><a name="LN221"></a><span class='Keyword'>#define </span><span class='Declare_Macro'>JB_ROOT_COUNT</span><span class='Parentheses'>(</span><span class='Declare_Parameter'>jbp_</span><span class='Parentheses'>)</span>     <span class='Parentheses'>(</span><span class='Operator'>*</span><span class='Parentheses'>(</span><a href="../c.h.html#LN267"><span class='Ref_to_Typedef'>uint32</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../postgres.h.html#LN302"><span class='Ref_to_Macro'>VARDATA</span></a><span class='Parentheses'>(</span><a href="jsonb.h.html#LN221"><span class='Ref_to_Parameter'>jbp_</span></a><span class='Parentheses'>) </span><span class='Operator'>& </span><a href="jsonb.h.html#LN202"><span class='Ref_to_Const'>JB_CMASK</span></a><span class='Parentheses'>)</span> 
<a name="LN222"></a><span class='Keyword'>#define </span><span class='Declare_Macro'>JB_ROOT_IS_SCALAR</span><span class='Parentheses'>(</span><span class='Declare_Parameter'>jbp_</span><span class='Parentheses'>) ((</span><span class='Operator'>*</span><span class='Parentheses'>(</span><a href="../c.h.html#LN267"><span class='Ref_to_Typedef'>uint32</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../postgres.h.html#LN302"><span class='Ref_to_Macro'>VARDATA</span></a><span class='Parentheses'>(</span><a href="jsonb.h.html#LN222"><span class='Ref_to_Parameter'>jbp_</span></a><span class='Parentheses'>) </span><span class='Operator'>& </span><a href="jsonb.h.html#LN203"><span class='Ref_to_Const'>JB_FSCALAR</span></a><span class='Parentheses'>)</span> <span class='Operator'>!= </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
<a name="LN223"></a><span class='Keyword'>#define </span><span class='Declare_Macro'>JB_ROOT_IS_OBJECT</span><span class='Parentheses'>(</span><span class='Declare_Parameter'>jbp_</span><span class='Parentheses'>) ((</span><span class='Operator'>*</span><span class='Parentheses'>(</span><a href="../c.h.html#LN267"><span class='Ref_to_Typedef'>uint32</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../postgres.h.html#LN302"><span class='Ref_to_Macro'>VARDATA</span></a><span class='Parentheses'>(</span><a href="jsonb.h.html#LN223"><span class='Ref_to_Parameter'>jbp_</span></a><span class='Parentheses'>) </span><span class='Operator'>& </span><a href="jsonb.h.html#LN204"><span class='Ref_to_Const'>JB_FOBJECT</span></a><span class='Parentheses'>)</span> <span class='Operator'>!= </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
<a name="LN224"></a><span class='Keyword'>#define </span><span class='Declare_Macro'>JB_ROOT_IS_ARRAY</span><span class='Parentheses'>(</span><span class='Declare_Parameter'>jbp_</span><span class='Parentheses'>)</span>  <span class='Parentheses'>((</span><span class='Operator'>*</span><span class='Parentheses'>(</span><a href="../c.h.html#LN267"><span class='Ref_to_Typedef'>uint32</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../postgres.h.html#LN302"><span class='Ref_to_Macro'>VARDATA</span></a><span class='Parentheses'>(</span><a href="jsonb.h.html#LN224"><span class='Ref_to_Parameter'>jbp_</span></a><span class='Parentheses'>) </span><span class='Operator'>& </span><a href="jsonb.h.html#LN205"><span class='Ref_to_Const'>JB_FARRAY</span></a><span class='Parentheses'>)</span> <span class='Operator'>!= </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
 
 
<a name="LN227"></a><span class='Control'>enum</span> <span class='Declare_Enum'>jbvType</span> 
<span class='Delimiter'>{ 
</span>    <span class='Comment_Multi_Line'>/* Scalar types */ 
</span><a name="LN230"></a>    <span class='Declare_Enum_Const'>jbvNull</span> <span class='Operator'>= </span><span class='Number'>0x0</span><span class='Delimiter'>, 
</span><a name="LN231"></a>    <span class='Declare_Enum_Const'>jbvString</span><span class='Delimiter'>, 
</span><a name="LN232"></a>    <span class='Declare_Enum_Const'>jbvNumeric</span><span class='Delimiter'>, 
</span><a name="LN233"></a>    <span class='Declare_Enum_Const'>jbvBool</span><span class='Delimiter'>, 
</span>    <span class='Comment_Multi_Line'>/* Composite types */ 
</span><a name="LN235"></a>    <span class='Declare_Enum_Const'>jbvArray</span> <span class='Operator'>= </span><span class='Number'>0x10</span><span class='Delimiter'>, 
</span><a name="LN236"></a>    <span class='Declare_Enum_Const'>jbvObject</span><span class='Delimiter'>, 
</span>    <span class='Comment_Multi_Line'>/* Binary (i.e. struct Jsonb) jbvArray/jbvObject */ 
</span><a name="LN238"></a>    <span class='Declare_Enum_Const'>jbvBinary</span> 
<span class='Delimiter'>}; 
</span> 
<span class='Comment_Multi_Line'>/* 
 * JsonbValue:  In-memory representation of Jsonb.  This is a convenient 
 * deserialized representation, that can easily support using the "val" 
 * union across underlying types during manipulation.  The Jsonb on-disk 
 * representation has various alignment considerations. 
 */ 
</span><a name="LN247"></a><span class='Control'>struct</span> <span class='Declare_Struct'>JsonbValue</span> 
<span class='Delimiter'>{ 
</span><a name="LN249"></a>    <span class='Control'>enum</span> <a href="jsonb.h.html#LN227"><span class='Ref_to_Enum'>jbvType</span></a> <span class='Declare_Member'>type</span><span class='Delimiter'>;</span>          <span class='Comment_Single_Line'>/* Influences sort order */ 
</span> 
    <span class='Control'>union</span> 
    <span class='Delimiter'>{ 
</span><a name="LN253"></a>        <a href="numeric.h.html#LN42"><span class='Ref_to_Typedef'>Numeric</span></a> <span class='Declare_Member'>numeric</span><span class='Delimiter'>; 
</span><a name="LN254"></a>        <span class='Keyword'>bool</span>        <span class='Declare_Member'>boolean</span><span class='Delimiter'>; 
</span>        <span class='Control'>struct</span> 
        <span class='Delimiter'>{ 
</span><a name="LN257"></a>            <span class='Keyword'>int</span>         <span class='Declare_Member'>len</span><span class='Delimiter'>; 
</span><a name="LN258"></a>            <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Member'>val</span><span class='Delimiter'>;</span>    <span class='Comment_Single_Line'>/* Not necessarily null-terminated */ 
</span><a name="LN259"></a>        <span class='Delimiter'>}</span>           <span class='Declare_Member'>string</span><span class='Delimiter'>;</span>     <span class='Comment_Single_Line'>/* String primitive type */ 
</span> 
        <span class='Control'>struct</span> 
        <span class='Delimiter'>{ 
</span><a name="LN263"></a>            <span class='Keyword'>int</span>         <span class='Declare_Member'>nElems</span><span class='Delimiter'>; 
</span><a name="LN264"></a>            <a href="jsonb.h.html#LN247"><span class='Ref_to_Struct'>JsonbValue</span></a> <span class='Operator'>*</span><span class='Declare_Member'>elems</span><span class='Delimiter'>; 
</span><a name="LN265"></a>            <span class='Keyword'>bool</span>        <span class='Declare_Member'>rawScalar</span><span class='Delimiter'>;</span>      <span class='Comment_Single_Line'>/* Top-level "raw scalar" array? */ 
</span><a name="LN266"></a>        <span class='Delimiter'>}</span>           <span class='Declare_Member'>array</span><span class='Delimiter'>;</span>      <span class='Comment_Single_Line'>/* Array container type */ 
</span> 
        <span class='Control'>struct</span> 
        <span class='Delimiter'>{ 
</span><a name="LN270"></a>            <span class='Keyword'>int</span>         <span class='Declare_Member'>nPairs</span><span class='Delimiter'>; </span><span class='Comment_Single_Line'>/* 1 pair, 2 elements */ 
</span><a name="LN271"></a>            <a href="jsonb.h.html#LN295"><span class='Ref_to_Struct'>JsonbPair</span></a>  <span class='Operator'>*</span><span class='Declare_Member'>pairs</span><span class='Delimiter'>; 
</span><a name="LN272"></a>        <span class='Delimiter'>}</span>           <span class='Declare_Member'>object</span><span class='Delimiter'>;</span>     <span class='Comment_Single_Line'>/* Associative container type */ 
</span> 
        <span class='Control'>struct</span> 
        <span class='Delimiter'>{ 
</span><a name="LN276"></a>            <span class='Keyword'>int</span>         <span class='Declare_Member'>len</span><span class='Delimiter'>; 
</span><a name="LN277"></a>            <a href="jsonb.h.html#LN192"><span class='Ref_to_Struct'>JsonbContainer</span></a> <span class='Operator'>*</span><span class='Declare_Member'>data</span><span class='Delimiter'>; 
</span><a name="LN278"></a>        <span class='Delimiter'>}</span>           <span class='Declare_Member'>binary</span><span class='Delimiter'>;</span>     <span class='Comment_Single_Line'>/* Array or object, in on-disk format */ 
</span><a name="LN279"></a>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end {anonval} &raquo; </span>           <span class='Declare_Member'>val</span><span class='Delimiter'>; 
}; 
</span> 
<a name="LN282"></a><span class='Keyword'>#define </span><span class='Declare_Macro'>IsAJsonbScalar</span><span class='Parentheses'>(</span><span class='Declare_Parameter'>jsonbval</span><span class='Parentheses'>)</span>    <span class='Parentheses'>((</span><a href="jsonb.h.html#LN282"><span class='Ref_to_Parameter'>jsonbval</span></a><span class='Parentheses'>)</span><span class='Operator'>-&GT;</span>type <span class='Operator'>&GT;= </span><a href="jsonb.h.html#LN230"><span class='Ref_to_EnumConst'>jbvNull</span></a> <span class='Operator'>&& \ 
</span>                                     <span class='Parentheses'>(</span><a href="jsonb.h.html#LN282"><span class='Ref_to_Parameter'>jsonbval</span></a><span class='Parentheses'>)</span><span class='Operator'>-&GT;</span>type <span class='Operator'>&LT;= </span><a href="jsonb.h.html#LN233"><span class='Ref_to_EnumConst'>jbvBool</span></a><span class='Parentheses'>)</span> 
 
<span class='Comment_Multi_Line'>/* 
 * Key/value pair within an Object. 
 * 
 * This struct type is only used briefly while constructing a Jsonb; it is 
 * *not* the on-disk representation. 
 * 
 * Pairs with duplicate keys are de-duplicated.  We store the originally 
 * observed pair ordering for the purpose of removing duplicates in a 
 * well-defined way (which is "last observed wins"). 
 */ 
</span><a name="LN295"></a><span class='Control'>struct</span> <span class='Declare_Struct'>JsonbPair</span> 
<span class='Delimiter'>{ 
</span><a name="LN297"></a>    <a href="jsonb.h.html#LN247"><span class='Ref_to_Struct'>JsonbValue</span></a>  <span class='Declare_Member'>key</span><span class='Delimiter'>;</span>            <span class='Comment_Single_Line'>/* Must be a jbvString */ 
</span><a name="LN298"></a>    <a href="jsonb.h.html#LN247"><span class='Ref_to_Struct'>JsonbValue</span></a>  <span class='Declare_Member'>value</span><span class='Delimiter'>;</span>          <span class='Comment_Single_Line'>/* May be of any type */ 
</span><a name="LN299"></a>    <a href="../c.h.html#LN267"><span class='Ref_to_Typedef'>uint32</span></a>      <span class='Declare_Member'>order</span><span class='Delimiter'>;</span>          <span class='Comment_Single_Line'>/* Pair's index in original sequence */ 
</span><span class='Delimiter'>}; 
</span> 
<span class='Comment_Multi_Line'>/* Conversion state used when parsing Jsonb from text, or for type coercion */ 
</span><a name="LN303"></a><span class='Control'>typedef</span> <span class='Control'>struct</span> <span class='Declare_Struct'>JsonbParseState</span> 
<span class='Delimiter'>{ 
</span><a name="LN305"></a>    <a href="jsonb.h.html#LN247"><span class='Ref_to_Struct'>JsonbValue</span></a>  <span class='Declare_Member'>contVal</span><span class='Delimiter'>; 
</span><a name="LN306"></a>    <a href="../c.h.html#LN355"><span class='Ref_to_Typedef'>Size</span></a>        <span class='Declare_Member'>size</span><span class='Delimiter'>; 
</span><a name="LN307"></a>    <span class='Control'>struct</span> <a href="jsonb.h.html#LN303"><span class='Ref_to_Struct'>JsonbParseState</span></a> <span class='Operator'>*</span><span class='Declare_Member'>next</span><span class='Delimiter'>; 
</span><a name="LN308"></a>} <span class='Declare_Typedef'>JsonbParseState</span><span class='Delimiter'>; 
</span> 
<span class='Comment_Multi_Line'>/* 
 * JsonbIterator holds details of the type for each iteration. It also stores a 
 * Jsonb varlena buffer, which can be directly accessed in some contexts. 
 */ 
</span><span class='Control'>typedef</span> <span class='Control'>enum</span> 
<span class='Delimiter'>{ 
</span><a name="LN316"></a>    <span class='Declare_Enum_Const'>JBI_ARRAY_START</span><span class='Delimiter'>, 
</span><a name="LN317"></a>    <span class='Declare_Enum_Const'>JBI_ARRAY_ELEM</span><span class='Delimiter'>, 
</span><a name="LN318"></a>    <span class='Declare_Enum_Const'>JBI_OBJECT_START</span><span class='Delimiter'>, 
</span><a name="LN319"></a>    <span class='Declare_Enum_Const'>JBI_OBJECT_KEY</span><span class='Delimiter'>, 
</span><a name="LN320"></a>    <span class='Declare_Enum_Const'>JBI_OBJECT_VALUE</span> 
<a name="LN321"></a><span class='Delimiter'>} </span><span class='Declare_Typedef'>JsonbIterState</span><span class='Delimiter'>; 
</span> 
<a name="LN323"></a><span class='Control'>typedef</span> <span class='Control'>struct</span> <span class='Declare_Struct'>JsonbIterator</span> 
<span class='Delimiter'>{ 
</span>    <span class='Comment_Multi_Line'>/* Container being iterated */ 
</span><a name="LN326"></a>    <a href="jsonb.h.html#LN192"><span class='Ref_to_Struct'>JsonbContainer</span></a> <span class='Operator'>*</span><span class='Declare_Member'>container</span><span class='Delimiter'>; 
</span><a name="LN327"></a>    <a href="../c.h.html#LN267"><span class='Ref_to_Typedef'>uint32</span></a>      <span class='Declare_Member'>nElems</span><span class='Delimiter'>;</span>         <span class='Comment_Multi_Line'>/* Number of elements in children array (will 
                                 * be nPairs for objects) */ 
</span><a name="LN329"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Member'>isScalar</span><span class='Delimiter'>;</span>       <span class='Comment_Single_Line'>/* Pseudo-array scalar value? */ 
</span><a name="LN330"></a>    <a href="jsonb.h.html#LN138"><span class='Ref_to_Typedef'>JEntry</span></a>     <span class='Operator'>*</span><span class='Declare_Member'>children</span><span class='Delimiter'>;</span>       <span class='Comment_Single_Line'>/* JEntrys for child nodes */ 
</span>    <span class='Comment_Multi_Line'>/* Data proper.  This points to the beginning of the variable-length data */ 
</span><a name="LN332"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Member'>dataProper</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Current item in buffer (up to nElems) */ 
</span><a name="LN335"></a>    <span class='Keyword'>int</span>         <span class='Declare_Member'>curIndex</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Data offset corresponding to current item */ 
</span><a name="LN338"></a>    <a href="../c.h.html#LN267"><span class='Ref_to_Typedef'>uint32</span></a>      <span class='Declare_Member'>curDataOffset</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * If the container is an object, we want to return keys and values 
     * alternately; so curDataOffset points to the current key, and 
     * curValueOffset points to the current value. 
     */ 
</span><a name="LN345"></a>    <a href="../c.h.html#LN267"><span class='Ref_to_Typedef'>uint32</span></a>      <span class='Declare_Member'>curValueOffset</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Private state */ 
</span><a name="LN348"></a>    <a href="jsonb.h.html#LN314"><span class='Ref_to_Typedef'>JsonbIterState</span></a> <span class='Declare_Member'>state</span><span class='Delimiter'>; 
</span> 
<a name="LN350"></a>    <span class='Control'>struct</span> <a href="jsonb.h.html#LN323"><span class='Ref_to_Struct'>JsonbIterator</span></a> <span class='Operator'>*</span><span class='Declare_Member'>parent</span><span class='Delimiter'>; 
</span><a name="LN351"></a>}<span class='Auto_Annotations'> &laquo; end JsonbIterator &raquo; </span> <span class='Declare_Typedef'>JsonbIterator</span><span class='Delimiter'>; 
</span> 
 
<span class='Comment_Multi_Line'>/* Support functions */ 
</span><a name="LN355"></a><span class='Keyword'>extern </span><a href="../c.h.html#LN267"><span class='Ref_to_Typedef'>uint32</span></a> <span class='Declare_Prototype'>getJsonbOffset</span><span class='Parentheses'>(</span><span class='Keyword'>const </span><a href="jsonb.h.html#LN192"><span class='Ref_to_Struct'>JsonbContainer</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>jc</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>index</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN356"></a><span class='Keyword'>extern </span><a href="../c.h.html#LN267"><span class='Ref_to_Typedef'>uint32</span></a> <span class='Declare_Prototype'>getJsonbLength</span><span class='Parentheses'>(</span><span class='Keyword'>const </span><a href="jsonb.h.html#LN192"><span class='Ref_to_Struct'>JsonbContainer</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>jc</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>index</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN357"></a><span class='Keyword'>extern int</span>  <span class='Declare_Prototype'>compareJsonbContainers</span><span class='Parentheses'>(</span><a href="jsonb.h.html#LN192"><span class='Ref_to_Struct'>JsonbContainer</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>a</span><span class='Delimiter'>, </span><a href="jsonb.h.html#LN192"><span class='Ref_to_Struct'>JsonbContainer</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>b</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN358"></a><span class='Keyword'>extern </span><a href="jsonb.h.html#LN247"><span class='Ref_to_Struct'>JsonbValue</span></a> <span class='Operator'>*</span><span class='Declare_Prototype'>findJsonbValueFromContainer</span><span class='Parentheses'>(</span><a href="jsonb.h.html#LN192"><span class='Ref_to_Struct'>JsonbContainer</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>sheader</span><span class='Delimiter'>, 
</span><a name="LN359"></a>                            <a href="../c.h.html#LN267"><span class='Ref_to_Typedef'>uint32</span></a> <span class='Declare_Parameter'>flags</span><span class='Delimiter'>, 
</span><a name="LN360"></a>                            <a href="jsonb.h.html#LN247"><span class='Ref_to_Struct'>JsonbValue</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>key</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN361"></a><span class='Keyword'>extern </span><a href="jsonb.h.html#LN247"><span class='Ref_to_Struct'>JsonbValue</span></a> <span class='Operator'>*</span><span class='Declare_Prototype'>getIthJsonbValueFromContainer</span><span class='Parentheses'>(</span><a href="jsonb.h.html#LN192"><span class='Ref_to_Struct'>JsonbContainer</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>sheader</span><span class='Delimiter'>, 
</span><a name="LN362"></a>                              <a href="../c.h.html#LN267"><span class='Ref_to_Typedef'>uint32</span></a> <span class='Declare_Parameter'>i</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN363"></a><span class='Keyword'>extern </span><a href="jsonb.h.html#LN247"><span class='Ref_to_Struct'>JsonbValue</span></a> <span class='Operator'>*</span><span class='Declare_Prototype'>pushJsonbValue</span><span class='Parentheses'>(</span><a href="jsonb.h.html#LN303"><span class='Ref_to_Struct'>JsonbParseState</span></a> <span class='Operator'>**</span><span class='Declare_Parameter'>pstate</span><span class='Delimiter'>, 
</span><a name="LN364"></a>               <a href="jsonb.h.html#LN19"><span class='Ref_to_Typedef'>JsonbIteratorToken</span></a> <span class='Declare_Parameter'>seq</span><span class='Delimiter'>, </span><a href="jsonb.h.html#LN247"><span class='Ref_to_Struct'>JsonbValue</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>jbVal</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN365"></a><span class='Keyword'>extern </span><a href="jsonb.h.html#LN323"><span class='Ref_to_Struct'>JsonbIterator</span></a> <span class='Operator'>*</span><span class='Declare_Prototype'>JsonbIteratorInit</span><span class='Parentheses'>(</span><a href="jsonb.h.html#LN192"><span class='Ref_to_Struct'>JsonbContainer</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>container</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN366"></a><span class='Keyword'>extern </span><a href="jsonb.h.html#LN19"><span class='Ref_to_Typedef'>JsonbIteratorToken</span></a> <span class='Declare_Prototype'>JsonbIteratorNext</span><span class='Parentheses'>(</span><a href="jsonb.h.html#LN323"><span class='Ref_to_Struct'>JsonbIterator</span></a> <span class='Operator'>**</span><span class='Declare_Parameter'>it</span><span class='Delimiter'>, </span><a href="jsonb.h.html#LN247"><span class='Ref_to_Struct'>JsonbValue</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>val</span><span class='Delimiter'>, 
</span><a name="LN367"></a>                  <span class='Keyword'>bool </span><span class='Declare_Parameter'>skipNested</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN368"></a><span class='Keyword'>extern </span><a href="jsonb.h.html#LN214"><span class='Ref_to_Typedef'>Jsonb</span></a> <span class='Operator'>*</span><span class='Declare_Prototype'>JsonbValueToJsonb</span><span class='Parentheses'>(</span><a href="jsonb.h.html#LN247"><span class='Ref_to_Struct'>JsonbValue</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>val</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN369"></a><span class='Keyword'>extern bool </span><span class='Declare_Prototype'>JsonbDeepContains</span><span class='Parentheses'>(</span><a href="jsonb.h.html#LN323"><span class='Ref_to_Struct'>JsonbIterator</span></a> <span class='Operator'>**</span><span class='Declare_Parameter'>val</span><span class='Delimiter'>, 
</span><a name="LN370"></a>                  <a href="jsonb.h.html#LN323"><span class='Ref_to_Struct'>JsonbIterator</span></a> <span class='Operator'>**</span><span class='Declare_Parameter'>mContained</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN371"></a><span class='Keyword'>extern void </span><span class='Declare_Prototype'>JsonbHashScalarValue</span><span class='Parentheses'>(</span><span class='Keyword'>const </span><a href="jsonb.h.html#LN247"><span class='Ref_to_Struct'>JsonbValue</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>scalarVal</span><span class='Delimiter'>, </span><a href="../c.h.html#LN267"><span class='Ref_to_Typedef'>uint32</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>hash</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
<span class='Comment_Multi_Line'>/* jsonb.c support functions */ 
</span><a name="LN374"></a><span class='Keyword'>extern char </span><span class='Operator'>*</span><span class='Declare_Prototype'>JsonbToCString</span><span class='Parentheses'>(</span><a href="../lib/stringinfo.h.html#LN42"><span class='Ref_to_Typedef'>StringInfo</span></a> <span class='Declare_Parameter'>out</span><span class='Delimiter'>, </span><a href="jsonb.h.html#LN192"><span class='Ref_to_Struct'>JsonbContainer</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>in</span><span class='Delimiter'>, 
</span><a name="LN375"></a>               <span class='Keyword'>int </span><span class='Declare_Parameter'>estimated_len</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN376"></a><span class='Keyword'>extern char </span><span class='Operator'>*</span><span class='Declare_Prototype'>JsonbToCStringIndent</span><span class='Parentheses'>(</span><a href="../lib/stringinfo.h.html#LN42"><span class='Ref_to_Typedef'>StringInfo</span></a> <span class='Declare_Parameter'>out</span><span class='Delimiter'>, </span><a href="jsonb.h.html#LN192"><span class='Ref_to_Struct'>JsonbContainer</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>in</span><span class='Delimiter'>, 
</span><a name="LN377"></a>                     <span class='Keyword'>int </span><span class='Declare_Parameter'>estimated_len</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
 
<span class='Directive'>#endif</span>   <span class='Comment_Single_Line'>/* __JSONB_H__ */ 
</span></pre>
<table bgcolor='#c0c0c0' width='100%'><tr><td><a href='../../../Contents.html'>Contents</a></td></tr>
</table><hr><p class='blurb' align='center'><a href='http://www.sourceinsight.com'>HTML Created by Source Insight Version 4.00.0084 Built on 2017-02-26</a></p>
</body></html>