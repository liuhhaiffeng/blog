<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta name="generator" content="Source Insight Version 4.00.0084 Built on 2017-02-26">
<meta charset='UTF-8' />
<style type='text/css'><!--
TD {background-color: #C0C0C0; font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 70%; }
.blurb {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 70%; }
.filename {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 120%; font-weight: bold; }
.dirname {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 100%; font-weight: bold; margin-top: 2.5em;}
--></style>
<title>src\interfaces\ecpg\pgtypeslib\timestamp.c</title>
<LINK REL=StyleSheet HREF="../../../../C_Cpp_Source_File.css" TYPE='text/css' MEDIA=screen>
</head>
<body bgcolor=#ffffff>
<table bgcolor='#c0c0c0' width='100%'>
<tr><td><p class='filename'><b>src\interfaces\ecpg\pgtypeslib\timestamp.c</b></p></td>
<td align='right'>
Wed Jun 14 08:26:09 2017
</td></tr>
<tr><td><a href='../../../../Contents.html'>Contents</a></td></tr>
</table>
<pre>
<span class='Comment_Multi_Line'>/* 
 * src/interfaces/ecpg/pgtypeslib/timestamp.c 
 */ 
</span><span class='Keyword'>#include </span><span class='String'>"postgres_fe.h"</span> 
 
<span class='Keyword'>#include </span><span class='String'>&LT;time.h&GT;</span> 
<span class='Keyword'>#include </span><span class='String'>&LT;float.h&GT;</span> 
<span class='Keyword'>#include </span><span class='String'>&LT;limits.h&GT;</span> 
<span class='Keyword'>#include </span><span class='String'>&LT;math.h&GT;</span> 
 
<span class='Directive'>#ifdef</span> __FAST_MATH__ 
#error <span class='Operator'>-</span>ffast<span class='Operator'>-</span>math is known to <span class='Control'>break</span> <span class='Keyword'>this </span>code 
<span class='Directive'>#endif</span> 
 
<span class='Keyword'>#include </span><span class='String'>"extern.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"dt.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"pgtypes_timestamp.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"pgtypes_date.h"</span> 
 
 
<span class='Keyword'>static </span><a href="../../../include/c.h.html#LN294"><span class='Ref_to_Typedef'>int64</span></a> 
<a name="LN21"></a><span class='Declare_Function'>time2t</span><span class='Parentheses'>(</span><span class='Keyword'>const int </span><span class='Declare_Parameter'>hour</span><span class='Delimiter'>, </span><span class='Keyword'>const int </span><span class='Declare_Parameter'>min</span><span class='Delimiter'>, </span><span class='Keyword'>const int </span><span class='Declare_Parameter'>sec</span><span class='Delimiter'>, </span><span class='Keyword'>const </span><a href="dt.h.html#LN9"><span class='Ref_to_Typedef'>fsec_t</span></a> <span class='Declare_Parameter'>fsec</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>return</span> <span class='Parentheses'>(((((</span><a href="timestamp.c.html#LN21"><span class='Ref_to_Parameter'>hour</span></a> <span class='Operator'>* </span><a href="../../../include/datatype/timestamp.h.html#LN88"><span class='Ref_to_Const'>MINS_PER_HOUR</span></a><span class='Parentheses'>) </span><span class='Operator'>+ </span><a href="timestamp.c.html#LN21"><span class='Ref_to_Parameter'>min</span></a><span class='Parentheses'>)</span> <span class='Operator'>* </span><a href="../../../include/datatype/timestamp.h.html#LN87"><span class='Ref_to_Const'>SECS_PER_MINUTE</span></a><span class='Parentheses'>)</span> <span class='Operator'>+ </span><a href="timestamp.c.html#LN21"><span class='Ref_to_Parameter'>sec</span></a><span class='Parentheses'>)</span> <span class='Operator'>* </span><a href="../../../include/datatype/timestamp.h.html#LN93"><span class='Ref_to_Const'>USECS_PER_SEC</span></a><span class='Parentheses'>)</span> <span class='Operator'>+ </span><a href="timestamp.c.html#LN21"><span class='Ref_to_Parameter'>fsec</span></a><span class='Delimiter'>; 
}</span>   <span class='Comment_Single_Line'>/* time2t() */ 
</span> 
<span class='Keyword'>static </span><a href="../include/pgtypes_timestamp.h.html#LN8"><span class='Ref_to_Typedef'>timestamp</span></a> 
<a name="LN27"></a><span class='Declare_Function'>dt2local</span><span class='Parentheses'>(</span><a href="../include/pgtypes_timestamp.h.html#LN8"><span class='Ref_to_Typedef'>timestamp</span></a> <span class='Declare_Parameter'>dt</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>tz</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <a href="timestamp.c.html#LN27"><span class='Ref_to_Parameter'>dt</span></a> <span class='Operator'>-= </span><span class='Parentheses'>(</span><a href="timestamp.c.html#LN27"><span class='Ref_to_Parameter'>tz</span></a> <span class='Operator'>* </span><a href="../../../include/datatype/timestamp.h.html#LN93"><span class='Ref_to_Const'>USECS_PER_SEC</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <a href="timestamp.c.html#LN27"><span class='Ref_to_Parameter'>dt</span></a><span class='Delimiter'>; 
}</span>   <span class='Comment_Single_Line'>/* dt2local() */ 
</span> 
<span class='Comment_Multi_Line'>/* tm2timestamp() 
 * Convert a tm structure to a timestamp data type. 
 * Note that year is _not_ 1900-based, but is an explicit full value. 
 * Also, month is one-based, _not_ zero-based. 
 * 
 * Returns -1 on failure (overflow). 
 */ 
</span><span class='Keyword'>int 
</span><a name="LN41"></a><span class='Declare_Function'>tm2timestamp</span><span class='Parentheses'>(</span><span class='Control'>struct</span> <a href="timestamp.c.html#LN41"><span class='Ref_to_Parameter'>tm</span></a> <span class='Operator'>* </span><span class='Declare_Parameter'>tm</span><span class='Delimiter'>, </span><a href="dt.h.html#LN9"><span class='Ref_to_Typedef'>fsec_t</span></a> <span class='Declare_Parameter'>fsec</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Operator'>*</span><span class='Declare_Parameter'>tzp</span><span class='Delimiter'>, </span><a href="../include/pgtypes_timestamp.h.html#LN8"><span class='Ref_to_Typedef'>timestamp</span></a> <span class='Operator'>* </span><span class='Declare_Parameter'>result</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN43"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>dDate</span><span class='Delimiter'>; 
</span><a name="LN44"></a>    <a href="../../../include/c.h.html#LN294"><span class='Ref_to_Typedef'>int64</span></a>       <span class='Declare_Local'>time</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Prevent overflow in Julian-day routines */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../../include/datatype/timestamp.h.html#LN154"><span class='Ref_to_Macro'>IS_VALID_JULIAN</span></a><span class='Parentheses'>(</span><a href="timestamp.c.html#LN41"><span class='Ref_to_Parameter'>tm</span></a><span class='Operator'>-&GT;</span>tm_year<span class='Delimiter'>, </span><a href="timestamp.c.html#LN41"><span class='Ref_to_Parameter'>tm</span></a><span class='Operator'>-&GT;</span>tm_mon<span class='Delimiter'>, </span><a href="timestamp.c.html#LN41"><span class='Ref_to_Parameter'>tm</span></a><span class='Operator'>-&GT;</span>tm_mday<span class='Parentheses'>))</span> 
        <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span> 
    <a href="timestamp.c.html#LN43"><span class='Ref_To_Local'>dDate</span></a> <span class='Operator'>= </span><a href="../../../backend/utils/adt/datetime.c.html#LN290"><span class='Ref_to_Func'>date2j</span></a><span class='Parentheses'>(</span><a href="timestamp.c.html#LN41"><span class='Ref_to_Parameter'>tm</span></a><span class='Operator'>-&GT;</span>tm_year<span class='Delimiter'>, </span><a href="timestamp.c.html#LN41"><span class='Ref_to_Parameter'>tm</span></a><span class='Operator'>-&GT;</span>tm_mon<span class='Delimiter'>, </span><a href="timestamp.c.html#LN41"><span class='Ref_to_Parameter'>tm</span></a><span class='Operator'>-&GT;</span>tm_mday<span class='Parentheses'>) </span><span class='Operator'>- </span><a href="../../../backend/utils/adt/datetime.c.html#LN290"><span class='Ref_to_Func'>date2j</span></a><span class='Parentheses'>(</span><span class='Number'>2000</span><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="timestamp.c.html#LN44"><span class='Ref_To_Local'>time</span></a> <span class='Operator'>= </span><a href="timestamp.c.html#LN20"><span class='Ref_to_Func'>time2t</span></a><span class='Parentheses'>(</span><a href="timestamp.c.html#LN41"><span class='Ref_to_Parameter'>tm</span></a><span class='Operator'>-&GT;</span>tm_hour<span class='Delimiter'>, </span><a href="timestamp.c.html#LN41"><span class='Ref_to_Parameter'>tm</span></a><span class='Operator'>-&GT;</span>tm_min<span class='Delimiter'>, </span><a href="timestamp.c.html#LN41"><span class='Ref_to_Parameter'>tm</span></a><span class='Operator'>-&GT;</span>tm_sec<span class='Delimiter'>, </span><a href="timestamp.c.html#LN41"><span class='Ref_to_Parameter'>fsec</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Operator'>*</span><a href="timestamp.c.html#LN41"><span class='Ref_to_Parameter'>result</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="timestamp.c.html#LN43"><span class='Ref_To_Local'>dDate</span></a> <span class='Operator'>* </span><a href="../../../include/datatype/timestamp.h.html#LN90"><span class='Ref_to_Const'>USECS_PER_DAY</span></a><span class='Parentheses'>) </span><span class='Operator'>+ </span><a href="timestamp.c.html#LN44"><span class='Ref_To_Local'>time</span></a><span class='Delimiter'>; 
</span>    <span class='Comment_Multi_Line'>/* check for major overflow */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>((</span><span class='Operator'>*</span><a href="timestamp.c.html#LN41"><span class='Ref_to_Parameter'>result</span></a> <span class='Operator'>- </span><a href="timestamp.c.html#LN44"><span class='Ref_To_Local'>time</span></a><span class='Parentheses'>) </span><span class='Operator'>/ </span><a href="../../../include/datatype/timestamp.h.html#LN90"><span class='Ref_to_Const'>USECS_PER_DAY</span></a> <span class='Operator'>!= </span><a href="timestamp.c.html#LN43"><span class='Ref_To_Local'>dDate</span></a><span class='Parentheses'>)</span> 
        <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <span class='Comment_Multi_Line'>/* check for just-barely overflow (okay except time-of-day wraps) */ 
</span>    <span class='Comment_Multi_Line'>/* caution: we want to allow 1999-12-31 24:00:00 */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>((</span><span class='Operator'>*</span><a href="timestamp.c.html#LN41"><span class='Ref_to_Parameter'>result</span></a> <span class='Operator'>&LT; </span><span class='Number'>0</span> <span class='Operator'>&& </span><a href="timestamp.c.html#LN43"><span class='Ref_To_Local'>dDate</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>) </span><span class='Operator'>|| 
</span>        <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="timestamp.c.html#LN41"><span class='Ref_to_Parameter'>result</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span> <span class='Operator'>&& </span><a href="timestamp.c.html#LN43"><span class='Ref_To_Local'>dDate</span></a> <span class='Operator'>&LT; -</span><span class='Number'>1</span><span class='Parentheses'>))</span> 
        <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="timestamp.c.html#LN41"><span class='Ref_to_Parameter'>tzp</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>        <span class='Operator'>*</span><a href="timestamp.c.html#LN41"><span class='Ref_to_Parameter'>result</span></a> <span class='Operator'>= </span><a href="timestamp.c.html#LN26"><span class='Ref_to_Func'>dt2local</span></a><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="timestamp.c.html#LN41"><span class='Ref_to_Parameter'>result</span></a><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="timestamp.c.html#LN41"><span class='Ref_to_Parameter'>tzp</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* final range check catches just-out-of-range timestamps */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../../include/datatype/timestamp.h.html#LN194"><span class='Ref_to_Macro'>IS_VALID_TIMESTAMP</span></a><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="timestamp.c.html#LN41"><span class='Ref_to_Parameter'>result</span></a><span class='Parentheses'>))</span> 
        <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <span class='Number'>0</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end tm2timestamp &raquo; </span>   <span class='Comment_Single_Line'>/* tm2timestamp() */ 
</span> 
<span class='Keyword'>static </span><a href="../include/pgtypes_timestamp.h.html#LN8"><span class='Ref_to_Typedef'>timestamp</span></a> 
<a name="LN72"></a><span class='Declare_Function'>SetEpochTimestamp</span><span class='Parentheses'>(</span><span class='Keyword'>void</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN74"></a>    <a href="../../../include/c.h.html#LN294"><span class='Ref_to_Typedef'>int64</span></a>       <span class='Declare_Local'>noresult</span> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span><a name="LN75"></a>    <a href="../include/pgtypes_timestamp.h.html#LN8"><span class='Ref_to_Typedef'>timestamp</span></a>   <span class='Declare_Local'>dt</span><span class='Delimiter'>; 
</span><a name="LN76"></a>    <span class='Control'>struct</span> <a href="timestamp.c.html#LN77"><span class='Ref_To_Local'>tm</span></a>   <span class='Declare_Local'>tt</span><span class='Delimiter'>, 
</span><a name="LN77"></a>               <span class='Operator'>*</span><span class='Declare_Local'>tm</span> <span class='Operator'>= &</span><a href="timestamp.c.html#LN76"><span class='Ref_To_Local'>tt</span></a><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/utils/timestamp.h.html#LN92"><span class='Ref_to_Proto'>GetEpochTime</span></a><span class='Parentheses'>(</span><a href="timestamp.c.html#LN77"><span class='Ref_To_Local'>tm</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <span class='Control'>return</span> <a href="timestamp.c.html#LN74"><span class='Ref_To_Local'>noresult</span></a><span class='Delimiter'>; 
</span> 
    <a href="timestamp.c.html#LN40"><span class='Ref_to_Func'>tm2timestamp</span></a><span class='Parentheses'>(</span><a href="timestamp.c.html#LN77"><span class='Ref_To_Local'>tm</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Delimiter'>, </span><span class='Null_Value'>NULL</span><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="timestamp.c.html#LN75"><span class='Ref_To_Local'>dt</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <a href="timestamp.c.html#LN75"><span class='Ref_To_Local'>dt</span></a><span class='Delimiter'>; 
}</span>   <span class='Comment_Single_Line'>/* SetEpochTimestamp() */ 
</span> 
<span class='Comment_Multi_Line'>/* timestamp2tm() 
 * Convert timestamp data type to POSIX time structure. 
 * Note that year is _not_ 1900-based, but is an explicit full value. 
 * Also, month is one-based, _not_ zero-based. 
 * Returns: 
 *   0 on success 
 *  -1 on out of range 
 * 
 * For dates within the system-supported time_t range, convert to the 
 *  local time zone. If out of this range, leave as GMT. - tgl 97/05/27 
 */ 
</span><span class='Keyword'>static int 
</span><a name="LN98"></a><span class='Declare_Function'>timestamp2tm</span><span class='Parentheses'>(</span><a href="../include/pgtypes_timestamp.h.html#LN8"><span class='Ref_to_Typedef'>timestamp</span></a> <span class='Declare_Parameter'>dt</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Operator'>*</span><span class='Declare_Parameter'>tzp</span><span class='Delimiter'>, </span><span class='Control'>struct</span> <a href="timestamp.c.html#LN98"><span class='Ref_to_Parameter'>tm</span></a> <span class='Operator'>* </span><span class='Declare_Parameter'>tm</span><span class='Delimiter'>, </span><a href="dt.h.html#LN9"><span class='Ref_to_Typedef'>fsec_t</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>fsec</span><span class='Delimiter'>, </span><span class='Keyword'>const char </span><span class='Operator'>**</span><span class='Declare_Parameter'>tzn</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN100"></a>    <a href="../../../include/c.h.html#LN294"><span class='Ref_to_Typedef'>int64</span></a>       <span class='Declare_Local'>dDate</span><span class='Delimiter'>, 
</span><a name="LN101"></a>                <span class='Declare_Local'>date0</span><span class='Delimiter'>; 
</span><a name="LN102"></a>    <a href="../../../include/c.h.html#LN294"><span class='Ref_to_Typedef'>int64</span></a>       <span class='Declare_Local'>time</span><span class='Delimiter'>; 
</span><span class='Directive'>#if</span> defined<span class='Parentheses'>(</span>HAVE_TM_ZONE<span class='Parentheses'>) </span><span class='Operator'>|| </span>defined<span class='Parentheses'>(</span>HAVE_INT_TIMEZONE<span class='Parentheses'>) 
</span><a name="LN104"></a>    time_t      <span class='Declare_Local'>utime</span><span class='Delimiter'>; 
</span><a name="LN105"></a>    <span class='Control'>struct</span> <a href="timestamp.c.html#LN98"><span class='Ref_to_Parameter'>tm</span></a>  <span class='Operator'>*</span><span class='Declare_Local'>tx</span><span class='Delimiter'>; 
</span><span class='Directive'>#endif</span> 
 
    <a href="timestamp.c.html#LN101"><span class='Ref_To_Local'>date0</span></a> <span class='Operator'>= </span><a href="../../../backend/utils/adt/datetime.c.html#LN290"><span class='Ref_to_Func'>date2j</span></a><span class='Parentheses'>(</span><span class='Number'>2000</span><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="timestamp.c.html#LN102"><span class='Ref_To_Local'>time</span></a> <span class='Operator'>= </span><a href="timestamp.c.html#LN98"><span class='Ref_to_Parameter'>dt</span></a><span class='Delimiter'>; 
</span>    <a href="dt.h.html#LN227"><span class='Ref_to_Macro'>TMODULO</span></a><span class='Parentheses'>(</span><a href="timestamp.c.html#LN102"><span class='Ref_To_Local'>time</span></a><span class='Delimiter'>, </span><a href="timestamp.c.html#LN100"><span class='Ref_To_Local'>dDate</span></a><span class='Delimiter'>, </span><a href="../../../include/datatype/timestamp.h.html#LN90"><span class='Ref_to_Const'>USECS_PER_DAY</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="timestamp.c.html#LN102"><span class='Ref_To_Local'>time</span></a> <span class='Operator'>&LT; </span><a href="../../../include/c.h.html#LN306"><span class='Ref_to_Macro'>INT64CONST</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span>        <a href="timestamp.c.html#LN102"><span class='Ref_To_Local'>time</span></a> <span class='Operator'>+= </span><a href="../../../include/datatype/timestamp.h.html#LN90"><span class='Ref_to_Const'>USECS_PER_DAY</span></a><span class='Delimiter'>; 
</span>        <a href="timestamp.c.html#LN100"><span class='Ref_To_Local'>dDate</span></a> <span class='Operator'>-= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* add offset to go from J2000 back to standard Julian date */ 
</span>    <a href="timestamp.c.html#LN100"><span class='Ref_To_Local'>dDate</span></a> <span class='Operator'>+= </span><a href="timestamp.c.html#LN101"><span class='Ref_To_Local'>date0</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Julian day routine does not work for negative Julian days */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="timestamp.c.html#LN100"><span class='Ref_To_Local'>dDate</span></a> <span class='Operator'>&LT; </span><span class='Number'>0</span> <span class='Operator'>|| </span><a href="timestamp.c.html#LN100"><span class='Ref_To_Local'>dDate</span></a> <span class='Operator'>&GT; </span><span class='Parentheses'>(</span><a href="../include/pgtypes_timestamp.h.html#LN8"><span class='Ref_to_Typedef'>timestamp</span></a><span class='Parentheses'>) </span>INT_MAX<span class='Parentheses'>)</span> 
        <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/utils/datetime.h.html#LN290"><span class='Ref_to_Proto'>j2date</span></a><span class='Parentheses'>((</span><span class='Keyword'>int</span><span class='Parentheses'>) </span><a href="timestamp.c.html#LN100"><span class='Ref_To_Local'>dDate</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="timestamp.c.html#LN98"><span class='Ref_to_Parameter'>tm</span></a><span class='Operator'>-&GT;</span>tm_year<span class='Delimiter'>, </span><span class='Operator'>&</span><a href="timestamp.c.html#LN98"><span class='Ref_to_Parameter'>tm</span></a><span class='Operator'>-&GT;</span>tm_mon<span class='Delimiter'>, </span><span class='Operator'>&</span><a href="timestamp.c.html#LN98"><span class='Ref_to_Parameter'>tm</span></a><span class='Operator'>-&GT;</span>tm_mday<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../../include/utils/timestamp.h.html#LN86"><span class='Ref_to_Proto'>dt2time</span></a><span class='Parentheses'>(</span><a href="timestamp.c.html#LN102"><span class='Ref_To_Local'>time</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="timestamp.c.html#LN98"><span class='Ref_to_Parameter'>tm</span></a><span class='Operator'>-&GT;</span>tm_hour<span class='Delimiter'>, </span><span class='Operator'>&</span><a href="timestamp.c.html#LN98"><span class='Ref_to_Parameter'>tm</span></a><span class='Operator'>-&GT;</span>tm_min<span class='Delimiter'>, </span><span class='Operator'>&</span><a href="timestamp.c.html#LN98"><span class='Ref_to_Parameter'>tm</span></a><span class='Operator'>-&GT;</span>tm_sec<span class='Delimiter'>, </span><a href="timestamp.c.html#LN98"><span class='Ref_to_Parameter'>fsec</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="timestamp.c.html#LN98"><span class='Ref_to_Parameter'>tzp</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* 
         * Does this fall within the capabilities of the localtime() 
         * interface? Then use this to rotate to the local time zone. 
         */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="dt.h.html#LN297"><span class='Ref_to_Macro'>IS_VALID_UTIME</span></a><span class='Parentheses'>(</span><a href="timestamp.c.html#LN98"><span class='Ref_to_Parameter'>tm</span></a><span class='Operator'>-&GT;</span>tm_year<span class='Delimiter'>, </span><a href="timestamp.c.html#LN98"><span class='Ref_to_Parameter'>tm</span></a><span class='Operator'>-&GT;</span>tm_mon<span class='Delimiter'>, </span><a href="timestamp.c.html#LN98"><span class='Ref_to_Parameter'>tm</span></a><span class='Operator'>-&GT;</span>tm_mday<span class='Parentheses'>))</span> 
        <span class='Delimiter'>{ 
</span><span class='Directive'>#if</span> defined<span class='Parentheses'>(</span>HAVE_TM_ZONE<span class='Parentheses'>) </span><span class='Operator'>|| </span>defined<span class='Parentheses'>(</span>HAVE_INT_TIMEZONE<span class='Parentheses'>) 
</span> 
            <a href="timestamp.c.html#LN104"><span class='Ref_To_Local'>utime</span></a> <span class='Operator'>= </span><a href="timestamp.c.html#LN98"><span class='Ref_to_Parameter'>dt</span></a> <span class='Operator'>/ </span><a href="../../../include/datatype/timestamp.h.html#LN93"><span class='Ref_to_Const'>USECS_PER_SEC</span></a> <span class='Operator'>+ 
</span>                <span class='Parentheses'>((</span><a href="timestamp.c.html#LN101"><span class='Ref_To_Local'>date0</span></a> <span class='Operator'>- </span><a href="../../../backend/utils/adt/datetime.c.html#LN290"><span class='Ref_to_Func'>date2j</span></a><span class='Parentheses'>(</span><span class='Number'>1970</span><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Parentheses'>))</span> <span class='Operator'>* </span><a href="../../../include/c.h.html#LN306"><span class='Ref_to_Macro'>INT64CONST</span></a><span class='Parentheses'>(</span><span class='Number'>86400</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
            <a href="timestamp.c.html#LN105"><span class='Ref_To_Local'>tx</span></a> <span class='Operator'>= </span>localtime<span class='Parentheses'>(</span><span class='Operator'>&</span><a href="timestamp.c.html#LN104"><span class='Ref_To_Local'>utime</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="timestamp.c.html#LN98"><span class='Ref_to_Parameter'>tm</span></a><span class='Operator'>-&GT;</span>tm_year <span class='Operator'>= </span><a href="timestamp.c.html#LN105"><span class='Ref_To_Local'>tx</span></a><span class='Operator'>-&GT;</span>tm_year <span class='Operator'>+ </span><span class='Number'>1900</span><span class='Delimiter'>; 
</span>            <a href="timestamp.c.html#LN98"><span class='Ref_to_Parameter'>tm</span></a><span class='Operator'>-&GT;</span>tm_mon <span class='Operator'>= </span><a href="timestamp.c.html#LN105"><span class='Ref_To_Local'>tx</span></a><span class='Operator'>-&GT;</span>tm_mon <span class='Operator'>+ </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>            <a href="timestamp.c.html#LN98"><span class='Ref_to_Parameter'>tm</span></a><span class='Operator'>-&GT;</span>tm_mday <span class='Operator'>= </span><a href="timestamp.c.html#LN105"><span class='Ref_To_Local'>tx</span></a><span class='Operator'>-&GT;</span>tm_mday<span class='Delimiter'>; 
</span>            <a href="timestamp.c.html#LN98"><span class='Ref_to_Parameter'>tm</span></a><span class='Operator'>-&GT;</span>tm_hour <span class='Operator'>= </span><a href="timestamp.c.html#LN105"><span class='Ref_To_Local'>tx</span></a><span class='Operator'>-&GT;</span>tm_hour<span class='Delimiter'>; 
</span>            <a href="timestamp.c.html#LN98"><span class='Ref_to_Parameter'>tm</span></a><span class='Operator'>-&GT;</span>tm_min <span class='Operator'>= </span><a href="timestamp.c.html#LN105"><span class='Ref_To_Local'>tx</span></a><span class='Operator'>-&GT;</span>tm_min<span class='Delimiter'>; 
</span>            <a href="timestamp.c.html#LN98"><span class='Ref_to_Parameter'>tm</span></a><span class='Operator'>-&GT;</span>tm_isdst <span class='Operator'>= </span><a href="timestamp.c.html#LN105"><span class='Ref_To_Local'>tx</span></a><span class='Operator'>-&GT;</span>tm_isdst<span class='Delimiter'>; 
</span> 
<span class='Directive'>#if</span> defined<span class='Parentheses'>(</span>HAVE_TM_ZONE<span class='Parentheses'>) 
</span>            <a href="timestamp.c.html#LN98"><span class='Ref_to_Parameter'>tm</span></a><span class='Operator'>-&GT;</span>tm_gmtoff <span class='Operator'>= </span><a href="timestamp.c.html#LN105"><span class='Ref_To_Local'>tx</span></a><span class='Operator'>-&GT;</span>tm_gmtoff<span class='Delimiter'>; 
</span>            <a href="timestamp.c.html#LN98"><span class='Ref_to_Parameter'>tm</span></a><span class='Operator'>-&GT;</span>tm_zone <span class='Operator'>= </span><a href="timestamp.c.html#LN105"><span class='Ref_To_Local'>tx</span></a><span class='Operator'>-&GT;</span>tm_zone<span class='Delimiter'>; 
</span> 
            <span class='Operator'>*</span><a href="timestamp.c.html#LN98"><span class='Ref_to_Parameter'>tzp</span></a> <span class='Operator'>= -</span><a href="timestamp.c.html#LN98"><span class='Ref_to_Parameter'>tm</span></a><span class='Operator'>-&GT;</span>tm_gmtoff<span class='Delimiter'>;</span>      <span class='Comment_Single_Line'>/* tm_gmtoff is Sun/DEC-ism */ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="timestamp.c.html#LN98"><span class='Ref_to_Parameter'>tzn</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>                <span class='Operator'>*</span><a href="timestamp.c.html#LN98"><span class='Ref_to_Parameter'>tzn</span></a> <span class='Operator'>= </span><a href="timestamp.c.html#LN98"><span class='Ref_to_Parameter'>tm</span></a><span class='Operator'>-&GT;</span>tm_zone<span class='Delimiter'>; 
</span><span class='Directive'>#elif</span> defined<span class='Parentheses'>(</span>HAVE_INT_TIMEZONE<span class='Parentheses'>) 
</span>            <span class='Operator'>*</span><a href="timestamp.c.html#LN98"><span class='Ref_to_Parameter'>tzp</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="timestamp.c.html#LN98"><span class='Ref_to_Parameter'>tm</span></a><span class='Operator'>-&GT;</span>tm_isdst <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>) </span><span class='Operator'>? </span><a href="../../../include/port.h.html#LN218"><span class='Ref_to_Const'>TIMEZONE_GLOBAL</span></a> <span class='Operator'>- </span><a href="../../../include/datatype/timestamp.h.html#LN86"><span class='Ref_to_Const'>SECS_PER_HOUR</span></a> <span class='Operator'>: </span><a href="../../../include/port.h.html#LN218"><span class='Ref_to_Const'>TIMEZONE_GLOBAL</span></a><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="timestamp.c.html#LN98"><span class='Ref_to_Parameter'>tzn</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>                <span class='Operator'>*</span><a href="timestamp.c.html#LN98"><span class='Ref_to_Parameter'>tzn</span></a> <span class='Operator'>= </span><a href="../../../include/port.h.html#LN219"><span class='Ref_to_Const'>TZNAME_GLOBAL</span></a><span class='Delimiter'>[</span><span class='Parentheses'>(</span><a href="timestamp.c.html#LN98"><span class='Ref_to_Parameter'>tm</span></a><span class='Operator'>-&GT;</span>tm_isdst <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>]; 
</span><span class='Directive'>#endif</span> 
<span class='Directive'>#else</span>                           <span class='Comment_Single_Line'>/* not (HAVE_TM_ZONE || HAVE_INT_TIMEZONE) */ 
</span>            <span class='Operator'>*</span><a href="timestamp.c.html#LN98"><span class='Ref_to_Parameter'>tzp</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>            <span class='Comment_Multi_Line'>/* Mark this as *no* time zone available */ 
</span>            <a href="timestamp.c.html#LN98"><span class='Ref_to_Parameter'>tm</span></a><span class='Operator'>-&GT;</span>tm_isdst <span class='Operator'>= -</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="timestamp.c.html#LN98"><span class='Ref_to_Parameter'>tzn</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>                <span class='Operator'>*</span><a href="timestamp.c.html#LN98"><span class='Ref_to_Parameter'>tzn</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span><span class='Directive'>#endif</span> 
        <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if IS_VALID_UTIME(tm-&GT;tm... &raquo; </span> 
        <span class='Control'>else</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Operator'>*</span><a href="timestamp.c.html#LN98"><span class='Ref_to_Parameter'>tzp</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>            <span class='Comment_Multi_Line'>/* Mark this as *no* time zone available */ 
</span>            <a href="timestamp.c.html#LN98"><span class='Ref_to_Parameter'>tm</span></a><span class='Operator'>-&GT;</span>tm_isdst <span class='Operator'>= -</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="timestamp.c.html#LN98"><span class='Ref_to_Parameter'>tzn</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>                <span class='Operator'>*</span><a href="timestamp.c.html#LN98"><span class='Ref_to_Parameter'>tzn</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if tzp!=NULL &raquo; </span> 
    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <a href="timestamp.c.html#LN98"><span class='Ref_to_Parameter'>tm</span></a><span class='Operator'>-&GT;</span>tm_isdst <span class='Operator'>= -</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="timestamp.c.html#LN98"><span class='Ref_to_Parameter'>tzn</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>            <span class='Operator'>*</span><a href="timestamp.c.html#LN98"><span class='Ref_to_Parameter'>tzn</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="timestamp.c.html#LN98"><span class='Ref_to_Parameter'>tm</span></a><span class='Operator'>-&GT;</span>tm_yday <span class='Operator'>= </span><a href="timestamp.c.html#LN100"><span class='Ref_To_Local'>dDate</span></a> <span class='Operator'>- </span><a href="../../../backend/utils/adt/datetime.c.html#LN290"><span class='Ref_to_Func'>date2j</span></a><span class='Parentheses'>(</span><a href="timestamp.c.html#LN98"><span class='Ref_to_Parameter'>tm</span></a><span class='Operator'>-&GT;</span>tm_year<span class='Delimiter'>, </span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Parentheses'>) </span><span class='Operator'>+ </span><span class='Number'>1</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <span class='Number'>0</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end timestamp2tm &raquo; </span>   <span class='Comment_Single_Line'>/* timestamp2tm() */ 
</span> 
<span class='Comment_Multi_Line'>/* EncodeSpecialTimestamp() 
 *  * Convert reserved timestamp data type to string. 
 *   */ 
</span><span class='Keyword'>static int 
</span><a name="LN195"></a><span class='Declare_Function'>EncodeSpecialTimestamp</span><span class='Parentheses'>(</span><a href="../include/pgtypes_timestamp.h.html#LN8"><span class='Ref_to_Typedef'>timestamp</span></a> <span class='Declare_Parameter'>dt</span><span class='Delimiter'>, </span><span class='Keyword'>char </span><span class='Operator'>*</span><span class='Declare_Parameter'>str</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/datatype/timestamp.h.html#LN114"><span class='Ref_to_Macro'>TIMESTAMP_IS_NOBEGIN</span></a><span class='Parentheses'>(</span><a href="timestamp.c.html#LN195"><span class='Ref_to_Parameter'>dt</span></a><span class='Parentheses'>))</span> 
        <a href="../../../../contrib/cube/cubeparse.y.html#LN150"><span class='Ref_to_Proto'>strcpy</span></a><span class='Parentheses'>(</span><a href="timestamp.c.html#LN195"><span class='Ref_to_Parameter'>str</span></a><span class='Delimiter'>, </span><a href="dt.h.html#LN36"><span class='Ref_to_Const'>EARLY</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/datatype/timestamp.h.html#LN119"><span class='Ref_to_Macro'>TIMESTAMP_IS_NOEND</span></a><span class='Parentheses'>(</span><a href="timestamp.c.html#LN195"><span class='Ref_to_Parameter'>dt</span></a><span class='Parentheses'>))</span> 
        <a href="../../../../contrib/cube/cubeparse.y.html#LN150"><span class='Ref_to_Proto'>strcpy</span></a><span class='Parentheses'>(</span><a href="timestamp.c.html#LN195"><span class='Ref_to_Parameter'>str</span></a><span class='Delimiter'>, </span><a href="dt.h.html#LN37"><span class='Ref_to_Const'>LATE</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
        <span class='Control'>return</span> <span class='Boolean'>FALSE</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <span class='Boolean'>TRUE</span><span class='Delimiter'>; 
}</span>   <span class='Comment_Single_Line'>/* EncodeSpecialTimestamp() */ 
</span> 
<a href="../include/pgtypes_timestamp.h.html#LN8"><span class='Ref_to_Typedef'>timestamp</span></a> 
<a name="LN208"></a><span class='Declare_Function'>PGTYPEStimestamp_from_asc</span><span class='Parentheses'>(</span><span class='Keyword'>char </span><span class='Operator'>*</span><span class='Declare_Parameter'>str</span><span class='Delimiter'>, </span><span class='Keyword'>char </span><span class='Operator'>**</span><span class='Declare_Parameter'>endptr</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN210"></a>    <a href="../include/pgtypes_timestamp.h.html#LN8"><span class='Ref_to_Typedef'>timestamp</span></a>   <span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span><a name="LN211"></a>    <a href="../../../include/c.h.html#LN294"><span class='Ref_to_Typedef'>int64</span></a>       <span class='Declare_Local'>noresult</span> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span><a name="LN212"></a>    <a href="dt.h.html#LN9"><span class='Ref_to_Typedef'>fsec_t</span></a>      <span class='Declare_Local'>fsec</span><span class='Delimiter'>; 
</span><a name="LN213"></a>    <span class='Control'>struct</span> <a href="timestamp.c.html#LN214"><span class='Ref_To_Local'>tm</span></a>   <span class='Declare_Local'>tt</span><span class='Delimiter'>, 
</span><a name="LN214"></a>               <span class='Operator'>*</span><span class='Declare_Local'>tm</span> <span class='Operator'>= &</span><a href="timestamp.c.html#LN213"><span class='Ref_To_Local'>tt</span></a><span class='Delimiter'>; 
</span><a name="LN215"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>dtype</span><span class='Delimiter'>; 
</span><a name="LN216"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>nf</span><span class='Delimiter'>; 
</span><a name="LN217"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>field</span><span class='Delimiter'>[</span><a href="dt.h.html#LN197"><span class='Ref_to_Const'>MAXDATEFIELDS</span></a><span class='Delimiter'>]; 
</span><a name="LN218"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>ftype</span><span class='Delimiter'>[</span><a href="dt.h.html#LN197"><span class='Ref_to_Const'>MAXDATEFIELDS</span></a><span class='Delimiter'>]; 
</span><a name="LN219"></a>    <span class='Keyword'>char</span>        <span class='Declare_Local'>lowstr</span><span class='Delimiter'>[</span><a href="dt.h.html#LN195"><span class='Ref_to_Const'>MAXDATELEN</span></a> <span class='Operator'>+ </span><a href="dt.h.html#LN197"><span class='Ref_to_Const'>MAXDATEFIELDS</span></a><span class='Delimiter'>]; 
</span><a name="LN220"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>realptr</span><span class='Delimiter'>; 
</span><a name="LN221"></a>    <span class='Keyword'>char</span>      <span class='Operator'>**</span><span class='Declare_Local'>ptr</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="timestamp.c.html#LN208"><span class='Ref_to_Parameter'>endptr</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) </span><span class='Operator'>? </span><a href="timestamp.c.html#LN208"><span class='Ref_to_Parameter'>endptr</span></a> <span class='Operator'>: &</span><a href="timestamp.c.html#LN220"><span class='Ref_To_Local'>realptr</span></a><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span>strlen<span class='Parentheses'>(</span><a href="timestamp.c.html#LN208"><span class='Ref_to_Parameter'>str</span></a><span class='Parentheses'>) </span><span class='Operator'>&GT; </span><a href="dt.h.html#LN195"><span class='Ref_to_Const'>MAXDATELEN</span></a><span class='Parentheses'>)</span> 
    <span class='Delimiter'>{ 
</span>        errno <span class='Operator'>= </span><a href="../include/pgtypes_error.h.html#LN14"><span class='Ref_to_Const'>PGTYPES_TS_BAD_TIMESTAMP</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <span class='Parentheses'>(</span><a href="timestamp.c.html#LN211"><span class='Ref_To_Local'>noresult</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/utils/datetime.h.html#LN293"><span class='Ref_to_Proto'>ParseDateTime</span></a><span class='Parentheses'>(</span><a href="timestamp.c.html#LN208"><span class='Ref_to_Parameter'>str</span></a><span class='Delimiter'>, </span><a href="timestamp.c.html#LN219"><span class='Ref_To_Local'>lowstr</span></a><span class='Delimiter'>, </span><a href="timestamp.c.html#LN217"><span class='Ref_To_Local'>field</span></a><span class='Delimiter'>, </span><a href="timestamp.c.html#LN218"><span class='Ref_To_Local'>ftype</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="timestamp.c.html#LN216"><span class='Ref_To_Local'>nf</span></a><span class='Delimiter'>, </span><a href="timestamp.c.html#LN221"><span class='Ref_To_Local'>ptr</span></a><span class='Parentheses'>) </span><span class='Operator'>!= </span><span class='Number'>0</span> <span class='Operator'>|| 
</span>        <a href="../../../include/utils/datetime.h.html#LN296"><span class='Ref_to_Proto'>DecodeDateTime</span></a><span class='Parentheses'>(</span><a href="timestamp.c.html#LN217"><span class='Ref_To_Local'>field</span></a><span class='Delimiter'>, </span><a href="timestamp.c.html#LN218"><span class='Ref_To_Local'>ftype</span></a><span class='Delimiter'>, </span><a href="timestamp.c.html#LN216"><span class='Ref_To_Local'>nf</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="timestamp.c.html#LN215"><span class='Ref_To_Local'>dtype</span></a><span class='Delimiter'>, </span><a href="timestamp.c.html#LN214"><span class='Ref_To_Local'>tm</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="timestamp.c.html#LN212"><span class='Ref_To_Local'>fsec</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Parentheses'>) </span><span class='Operator'>!= </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
    <span class='Delimiter'>{ 
</span>        errno <span class='Operator'>= </span><a href="../include/pgtypes_error.h.html#LN14"><span class='Ref_to_Const'>PGTYPES_TS_BAD_TIMESTAMP</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <span class='Parentheses'>(</span><a href="timestamp.c.html#LN211"><span class='Ref_To_Local'>noresult</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>switch</span> <span class='Parentheses'>(</span><a href="timestamp.c.html#LN215"><span class='Ref_To_Local'>dtype</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>case</span> <a href="dt.h.html#LN139"><span class='Ref_to_Const'>DTK_DATE</span></a><span class='Operator'>: 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="timestamp.c.html#LN40"><span class='Ref_to_Func'>tm2timestamp</span></a><span class='Parentheses'>(</span><a href="timestamp.c.html#LN214"><span class='Ref_To_Local'>tm</span></a><span class='Delimiter'>, </span><a href="timestamp.c.html#LN212"><span class='Ref_To_Local'>fsec</span></a><span class='Delimiter'>, </span><span class='Null_Value'>NULL</span><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="timestamp.c.html#LN210"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>) </span><span class='Operator'>!= </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
            <span class='Delimiter'>{ 
</span>                errno <span class='Operator'>= </span><a href="../include/pgtypes_error.h.html#LN14"><span class='Ref_to_Const'>PGTYPES_TS_BAD_TIMESTAMP</span></a><span class='Delimiter'>; 
</span>                <span class='Control'>return</span> <span class='Parentheses'>(</span><a href="timestamp.c.html#LN211"><span class='Ref_To_Local'>noresult</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>case</span> <a href="dt.h.html#LN149"><span class='Ref_to_Const'>DTK_EPOCH</span></a><span class='Operator'>: 
</span>            <a href="timestamp.c.html#LN210"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="timestamp.c.html#LN71"><span class='Ref_to_Func'>SetEpochTimestamp</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>case</span> <a href="dt.h.html#LN148"><span class='Ref_to_Const'>DTK_LATE</span></a><span class='Operator'>: 
</span>            <a href="../../../include/datatype/timestamp.h.html#LN116"><span class='Ref_to_Macro'>TIMESTAMP_NOEND</span></a><span class='Parentheses'>(</span><a href="timestamp.c.html#LN210"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>case</span> <a href="dt.h.html#LN147"><span class='Ref_to_Const'>DTK_EARLY</span></a><span class='Operator'>: 
</span>            <a href="../../../include/datatype/timestamp.h.html#LN111"><span class='Ref_to_Macro'>TIMESTAMP_NOBEGIN</span></a><span class='Parentheses'>(</span><a href="timestamp.c.html#LN210"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>case</span> <a href="dt.h.html#LN145"><span class='Ref_to_Const'>DTK_INVALID</span></a><span class='Operator'>: 
</span>            errno <span class='Operator'>= </span><a href="../include/pgtypes_error.h.html#LN14"><span class='Ref_to_Const'>PGTYPES_TS_BAD_TIMESTAMP</span></a><span class='Delimiter'>; 
</span>            <span class='Control'>return</span> <span class='Parentheses'>(</span><a href="timestamp.c.html#LN211"><span class='Ref_To_Local'>noresult</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>default</span><span class='Operator'>: 
</span>            errno <span class='Operator'>= </span><a href="../include/pgtypes_error.h.html#LN14"><span class='Ref_to_Const'>PGTYPES_TS_BAD_TIMESTAMP</span></a><span class='Delimiter'>; 
</span>            <span class='Control'>return</span> <span class='Parentheses'>(</span><a href="timestamp.c.html#LN211"><span class='Ref_To_Local'>noresult</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end switch dtype &raquo; </span> 
 
    <span class='Comment_Multi_Line'>/* AdjustTimestampForTypmod(&result, typmod); */ 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Since it's difficult to test for noresult, make sure errno is 0 if no 
     * error occurred. 
     */ 
</span>    errno <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <a href="timestamp.c.html#LN210"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end PGTYPEStimestamp_from_asc &raquo; </span> 
 
<span class='Keyword'>char </span><span class='Operator'>* 
</span><a name="LN278"></a><span class='Declare_Function'>PGTYPEStimestamp_to_asc</span><span class='Parentheses'>(</span><a href="../include/pgtypes_timestamp.h.html#LN8"><span class='Ref_to_Typedef'>timestamp</span></a> <span class='Declare_Parameter'>tstamp</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN280"></a>    <span class='Control'>struct</span> <a href="timestamp.c.html#LN281"><span class='Ref_To_Local'>tm</span></a>   <span class='Declare_Local'>tt</span><span class='Delimiter'>, 
</span><a name="LN281"></a>               <span class='Operator'>*</span><span class='Declare_Local'>tm</span> <span class='Operator'>= &</span><a href="timestamp.c.html#LN280"><span class='Ref_To_Local'>tt</span></a><span class='Delimiter'>; 
</span><a name="LN282"></a>    <span class='Keyword'>char</span>        <span class='Declare_Local'>buf</span><span class='Delimiter'>[</span><a href="dt.h.html#LN195"><span class='Ref_to_Const'>MAXDATELEN</span></a> <span class='Operator'>+ </span><span class='Number'>1</span><span class='Delimiter'>]; 
</span><a name="LN283"></a>    <a href="dt.h.html#LN9"><span class='Ref_to_Typedef'>fsec_t</span></a>      <span class='Declare_Local'>fsec</span><span class='Delimiter'>; 
</span><a name="LN284"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>DateStyle</span> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>;</span>  <span class='Comment_Multi_Line'>/* this defaults to ISO_DATES, shall we make 
                                 * it an option? */ 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/datatype/timestamp.h.html#LN121"><span class='Ref_to_Macro'>TIMESTAMP_NOT_FINITE</span></a><span class='Parentheses'>(</span><a href="timestamp.c.html#LN278"><span class='Ref_to_Parameter'>tstamp</span></a><span class='Parentheses'>))</span> 
        <a href="timestamp.c.html#LN194"><span class='Ref_to_Func'>EncodeSpecialTimestamp</span></a><span class='Parentheses'>(</span><a href="timestamp.c.html#LN278"><span class='Ref_to_Parameter'>tstamp</span></a><span class='Delimiter'>, </span><a href="timestamp.c.html#LN282"><span class='Ref_To_Local'>buf</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/utils/timestamp.h.html#LN84"><span class='Ref_to_Proto'>timestamp2tm</span></a><span class='Parentheses'>(</span><a href="timestamp.c.html#LN278"><span class='Ref_to_Parameter'>tstamp</span></a><span class='Delimiter'>, </span><span class='Null_Value'>NULL</span><span class='Delimiter'>, </span><a href="timestamp.c.html#LN281"><span class='Ref_To_Local'>tm</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="timestamp.c.html#LN283"><span class='Ref_To_Local'>fsec</span></a><span class='Delimiter'>, </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <a href="dt.h.html#LN315"><span class='Ref_to_Proto'>EncodeDateTime</span></a><span class='Parentheses'>(</span><a href="timestamp.c.html#LN281"><span class='Ref_To_Local'>tm</span></a><span class='Delimiter'>, </span><a href="timestamp.c.html#LN283"><span class='Ref_To_Local'>fsec</span></a><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Delimiter'>, </span><span class='Null_Value'>NULL</span><span class='Delimiter'>, </span><a href="timestamp.c.html#LN284"><span class='Ref_To_Local'>DateStyle</span></a><span class='Delimiter'>, </span><a href="timestamp.c.html#LN282"><span class='Ref_To_Local'>buf</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        errno <span class='Operator'>= </span><a href="../include/pgtypes_error.h.html#LN14"><span class='Ref_to_Const'>PGTYPES_TS_BAD_TIMESTAMP</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>return</span> <a href="common.c.html#LN17"><span class='Ref_to_Func'>pgtypes_strdup</span></a><span class='Parentheses'>(</span><a href="timestamp.c.html#LN282"><span class='Ref_To_Local'>buf</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end PGTYPEStimestamp_to_asc &raquo; </span> 
 
<span class='Keyword'>void 
</span><a name="LN300"></a><span class='Declare_Function'>PGTYPEStimestamp_current</span><span class='Parentheses'>(</span><a href="../include/pgtypes_timestamp.h.html#LN8"><span class='Ref_to_Typedef'>timestamp</span></a> <span class='Operator'>* </span><span class='Declare_Parameter'>ts</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN302"></a>    <span class='Control'>struct</span> <a href="timestamp.c.html#LN302"><span class='Ref_To_Local'>tm</span></a>   <span class='Declare_Local'>tm</span><span class='Delimiter'>; 
</span> 
    <a href="../../../include/utils/datetime.h.html#LN288"><span class='Ref_to_Proto'>GetCurrentDateTime</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="timestamp.c.html#LN302"><span class='Ref_To_Local'>tm</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span>errno <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>        <a href="timestamp.c.html#LN40"><span class='Ref_to_Func'>tm2timestamp</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="timestamp.c.html#LN302"><span class='Ref_To_Local'>tm</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Delimiter'>, </span><span class='Null_Value'>NULL</span><span class='Delimiter'>, </span><a href="timestamp.c.html#LN300"><span class='Ref_to_Parameter'>ts</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>return</span><span class='Delimiter'>; 
} 
</span> 
<span class='Keyword'>static int 
</span><a name="LN311"></a><span class='Declare_Function'>dttofmtasc_replace</span><span class='Parentheses'>(</span><a href="../include/pgtypes_timestamp.h.html#LN8"><span class='Ref_to_Typedef'>timestamp</span></a> <span class='Operator'>* </span><span class='Declare_Parameter'>ts</span><span class='Delimiter'>, </span><a href="../include/pgtypes_date.h.html#LN7"><span class='Ref_to_Typedef'>date</span></a> <span class='Declare_Parameter'>dDate</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>dow</span><span class='Delimiter'>, </span><span class='Control'>struct</span> <a href="timestamp.c.html#LN311"><span class='Ref_to_Parameter'>tm</span></a> <span class='Operator'>* </span><span class='Declare_Parameter'>tm</span><span class='Delimiter'>, 
</span><a name="LN312"></a>                   <span class='Keyword'>char </span><span class='Operator'>*</span><span class='Declare_Parameter'>output</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Operator'>*</span><span class='Declare_Parameter'>pstr_len</span><span class='Delimiter'>, </span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>fmtstr</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN314"></a>    <span class='Control'>union</span> <a href="extern.h.html#LN26"><span class='Ref_to_Union'>un_fmt_comb</span></a> <span class='Declare_Local'>replace_val</span><span class='Delimiter'>; 
</span><a name="LN315"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>replace_type</span><span class='Delimiter'>; 
</span><a name="LN316"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>i</span><span class='Delimiter'>; 
</span><a name="LN317"></a>    <span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Local'>p</span> <span class='Operator'>= </span><a href="timestamp.c.html#LN312"><span class='Ref_to_Parameter'>fmtstr</span></a><span class='Delimiter'>; 
</span><a name="LN318"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>q</span> <span class='Operator'>= </span><a href="timestamp.c.html#LN312"><span class='Ref_to_Parameter'>output</span></a><span class='Delimiter'>; 
</span> 
    <span class='Control'>while</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="timestamp.c.html#LN317"><span class='Ref_To_Local'>p</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="timestamp.c.html#LN317"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>== </span><span class='String'>'%'</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <a href="timestamp.c.html#LN317"><span class='Ref_To_Local'>p</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>            <span class='Comment_Multi_Line'>/* fix compiler warning */ 
</span>            <a href="timestamp.c.html#LN315"><span class='Ref_To_Local'>replace_type</span></a> <span class='Operator'>= </span><a href="extern.h.html#LN9"><span class='Ref_to_Const'>PGTYPES_TYPE_NOTHING</span></a><span class='Delimiter'>; 
</span>            <span class='Control'>switch</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="timestamp.c.html#LN317"><span class='Ref_To_Local'>p</span></a><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                    <span class='Comment_Multi_Line'>/* the abbreviated name of the day in the week */ 
</span>                    <span class='Comment_Multi_Line'>/* XXX should be locale aware */ 
</span>                <span class='Control'>case</span> <span class='String'>'a'</span><span class='Operator'>: 
</span>                    <a href="timestamp.c.html#LN314"><span class='Ref_To_Local'>replace_val</span></a><span class='Operator'>.</span><a href="extern.h.html#LN28"><span class='Ref_to_Member'>str_val</span></a> <span class='Operator'>= </span><a href="dt_common.c.html#LN500"><span class='Ref_to_Global_Var'>pgtypes_date_weekdays_short</span></a><span class='Delimiter'>[</span><a href="timestamp.c.html#LN311"><span class='Ref_to_Parameter'>dow</span></a><span class='Delimiter'>]; 
</span>                    <a href="timestamp.c.html#LN315"><span class='Ref_To_Local'>replace_type</span></a> <span class='Operator'>= </span><a href="extern.h.html#LN11"><span class='Ref_to_Const'>PGTYPES_TYPE_STRING_CONSTANT</span></a><span class='Delimiter'>; 
</span>                    <span class='Control'>break</span><span class='Delimiter'>; 
</span>                    <span class='Comment_Multi_Line'>/* the full name of the day in the week */ 
</span>                    <span class='Comment_Multi_Line'>/* XXX should be locale aware */ 
</span>                <span class='Control'>case</span> <span class='String'>'A'</span><span class='Operator'>: 
</span>                    <a href="timestamp.c.html#LN314"><span class='Ref_To_Local'>replace_val</span></a><span class='Operator'>.</span><a href="extern.h.html#LN28"><span class='Ref_to_Member'>str_val</span></a> <span class='Operator'>= </span><a href="../../../backend/utils/adt/datetime.c.html#LN68"><span class='Ref_to_Global_Var'>days</span></a><span class='Delimiter'>[</span><a href="timestamp.c.html#LN311"><span class='Ref_to_Parameter'>dow</span></a><span class='Delimiter'>]; 
</span>                    <a href="timestamp.c.html#LN315"><span class='Ref_To_Local'>replace_type</span></a> <span class='Operator'>= </span><a href="extern.h.html#LN11"><span class='Ref_to_Const'>PGTYPES_TYPE_STRING_CONSTANT</span></a><span class='Delimiter'>; 
</span>                    <span class='Control'>break</span><span class='Delimiter'>; 
</span>                    <span class='Comment_Multi_Line'>/* the abbreviated name of the month */ 
</span>                    <span class='Comment_Multi_Line'>/* XXX should be locale aware */ 
</span>                <span class='Control'>case</span> <span class='String'>'b'</span><span class='Operator'>: 
</span>                <span class='Control'>case</span> <span class='String'>'h'</span><span class='Operator'>: 
</span>                    <a href="timestamp.c.html#LN314"><span class='Ref_To_Local'>replace_val</span></a><span class='Operator'>.</span><a href="extern.h.html#LN28"><span class='Ref_to_Member'>str_val</span></a> <span class='Operator'>= </span><a href="../../../backend/utils/adt/datetime.c.html#LN65"><span class='Ref_to_Global_Var'>months</span></a><span class='Delimiter'>[</span><a href="timestamp.c.html#LN311"><span class='Ref_to_Parameter'>tm</span></a><span class='Operator'>-&GT;</span>tm_mon<span class='Delimiter'>]; 
</span>                    <a href="timestamp.c.html#LN315"><span class='Ref_To_Local'>replace_type</span></a> <span class='Operator'>= </span><a href="extern.h.html#LN11"><span class='Ref_to_Const'>PGTYPES_TYPE_STRING_CONSTANT</span></a><span class='Delimiter'>; 
</span>                    <span class='Control'>break</span><span class='Delimiter'>; 
</span>                    <span class='Comment_Multi_Line'>/* the full name of the month */ 
</span>                    <span class='Comment_Multi_Line'>/* XXX should be locale aware */ 
</span>                <span class='Control'>case</span> <span class='String'>'B'</span><span class='Operator'>: 
</span>                    <a href="timestamp.c.html#LN314"><span class='Ref_To_Local'>replace_val</span></a><span class='Operator'>.</span><a href="extern.h.html#LN28"><span class='Ref_to_Member'>str_val</span></a> <span class='Operator'>= </span><a href="dt_common.c.html#LN502"><span class='Ref_to_Global_Var'>pgtypes_date_months</span></a><span class='Delimiter'>[</span><a href="timestamp.c.html#LN311"><span class='Ref_to_Parameter'>tm</span></a><span class='Operator'>-&GT;</span>tm_mon<span class='Delimiter'>]; 
</span>                    <a href="timestamp.c.html#LN315"><span class='Ref_To_Local'>replace_type</span></a> <span class='Operator'>= </span><a href="extern.h.html#LN11"><span class='Ref_to_Const'>PGTYPES_TYPE_STRING_CONSTANT</span></a><span class='Delimiter'>; 
</span>                    <span class='Control'>break</span><span class='Delimiter'>; 
</span> 
                    <span class='Comment_Multi_Line'>/* 
                     * The  preferred  date  and  time  representation  for 
                     * the current locale. 
                     */ 
</span>                <span class='Control'>case</span> <span class='String'>'c'</span><span class='Operator'>: 
</span>                    <span class='Comment_Multi_Line'>/* XXX */ 
</span>                    <span class='Control'>break</span><span class='Delimiter'>; 
</span>                    <span class='Comment_Multi_Line'>/* the century number with leading zeroes */ 
</span>                <span class='Control'>case</span> <span class='String'>'C'</span><span class='Operator'>: 
</span>                    <a href="timestamp.c.html#LN314"><span class='Ref_To_Local'>replace_val</span></a><span class='Operator'>.</span><a href="extern.h.html#LN29"><span class='Ref_to_Member'>uint_val</span></a> <span class='Operator'>= </span><a href="timestamp.c.html#LN311"><span class='Ref_to_Parameter'>tm</span></a><span class='Operator'>-&GT;</span>tm_year <span class='Operator'>/ </span><span class='Number'>100</span><span class='Delimiter'>; 
</span>                    <a href="timestamp.c.html#LN315"><span class='Ref_To_Local'>replace_type</span></a> <span class='Operator'>= </span><a href="extern.h.html#LN16"><span class='Ref_to_Const'>PGTYPES_TYPE_UINT_2_LZ</span></a><span class='Delimiter'>; 
</span>                    <span class='Control'>break</span><span class='Delimiter'>; 
</span>                    <span class='Comment_Multi_Line'>/* day with leading zeroes (01 - 31) */ 
</span>                <span class='Control'>case</span> <span class='String'>'d'</span><span class='Operator'>: 
</span>                    <a href="timestamp.c.html#LN314"><span class='Ref_To_Local'>replace_val</span></a><span class='Operator'>.</span><a href="extern.h.html#LN29"><span class='Ref_to_Member'>uint_val</span></a> <span class='Operator'>= </span><a href="timestamp.c.html#LN311"><span class='Ref_to_Parameter'>tm</span></a><span class='Operator'>-&GT;</span>tm_mday<span class='Delimiter'>; 
</span>                    <a href="timestamp.c.html#LN315"><span class='Ref_To_Local'>replace_type</span></a> <span class='Operator'>= </span><a href="extern.h.html#LN16"><span class='Ref_to_Const'>PGTYPES_TYPE_UINT_2_LZ</span></a><span class='Delimiter'>; 
</span>                    <span class='Control'>break</span><span class='Delimiter'>; 
</span>                    <span class='Comment_Multi_Line'>/* the date in the format mm/dd/yy */ 
</span>                <span class='Control'>case</span> <span class='String'>'D'</span><span class='Operator'>: 
</span> 
                    <span class='Comment_Multi_Line'>/* 
                     * ts, dDate, dow, tm is information about the timestamp 
                     * 
                     * q is the start of the current output buffer 
                     * 
                     * pstr_len is a pointer to the remaining size of output, 
                     * i.e. the size of q 
                     */ 
</span>                    <a href="timestamp.c.html#LN316"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><a href="timestamp.c.html#LN310"><span class='Ref_to_Func'>dttofmtasc_replace</span></a><span class='Parentheses'>(</span><a href="timestamp.c.html#LN311"><span class='Ref_to_Parameter'>ts</span></a><span class='Delimiter'>, </span><a href="timestamp.c.html#LN311"><span class='Ref_to_Parameter'>dDate</span></a><span class='Delimiter'>, </span><a href="timestamp.c.html#LN311"><span class='Ref_to_Parameter'>dow</span></a><span class='Delimiter'>, </span><a href="timestamp.c.html#LN311"><span class='Ref_to_Parameter'>tm</span></a><span class='Delimiter'>, 
</span>                                           <a href="timestamp.c.html#LN318"><span class='Ref_To_Local'>q</span></a><span class='Delimiter'>, </span><a href="timestamp.c.html#LN312"><span class='Ref_to_Parameter'>pstr_len</span></a><span class='Delimiter'>, 
</span>                                           <span class='String'>"%m/%d/%y"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="timestamp.c.html#LN316"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>) 
</span>                        <span class='Control'>return</span> <a href="timestamp.c.html#LN316"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>; 
</span>                    <span class='Control'>break</span><span class='Delimiter'>; 
</span>                    <span class='Comment_Multi_Line'>/* day with leading spaces (01 - 31) */ 
</span>                <span class='Control'>case</span> <span class='String'>'e'</span><span class='Operator'>: 
</span>                    <a href="timestamp.c.html#LN314"><span class='Ref_To_Local'>replace_val</span></a><span class='Operator'>.</span><a href="extern.h.html#LN29"><span class='Ref_to_Member'>uint_val</span></a> <span class='Operator'>= </span><a href="timestamp.c.html#LN311"><span class='Ref_to_Parameter'>tm</span></a><span class='Operator'>-&GT;</span>tm_mday<span class='Delimiter'>; 
</span>                    <a href="timestamp.c.html#LN315"><span class='Ref_To_Local'>replace_type</span></a> <span class='Operator'>= </span><a href="extern.h.html#LN18"><span class='Ref_to_Const'>PGTYPES_TYPE_UINT_2_LS</span></a><span class='Delimiter'>; 
</span>                    <span class='Control'>break</span><span class='Delimiter'>; 
</span> 
                    <span class='Comment_Multi_Line'>/* 
                     * alternative format modifier 
                     */ 
</span>                <span class='Control'>case</span> <span class='String'>'E'</span><span class='Operator'>: 
</span>                    <span class='Delimiter'>{ 
</span><a name="LN400"></a>                        <span class='Keyword'>char</span>        <span class='Declare_Local'>tmp</span><span class='Delimiter'>[</span><span class='Number'>4</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='String'>"%Ex"</span><span class='Delimiter'>; 
</span> 
                        <a href="timestamp.c.html#LN317"><span class='Ref_To_Local'>p</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>                        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="timestamp.c.html#LN317"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>== </span><span class='String'>'\0'</span><span class='Parentheses'>) 
</span>                            <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>                        <a href="timestamp.c.html#LN400"><span class='Ref_To_Local'>tmp</span></a><span class='Delimiter'>[</span><span class='Number'>2</span><span class='Delimiter'>] </span><span class='Operator'>= *</span><a href="timestamp.c.html#LN317"><span class='Ref_To_Local'>p</span></a><span class='Delimiter'>; 
</span> 
                        <span class='Comment_Multi_Line'>/* 
                         * strftime's month is 0 based, ours is 1 based 
                         */ 
</span>                        <a href="timestamp.c.html#LN311"><span class='Ref_to_Parameter'>tm</span></a><span class='Operator'>-&GT;</span>tm_mon <span class='Operator'>-= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>                        <a href="timestamp.c.html#LN316"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><a href="../../../backend/utils/adt/pg_locale.c.html#LN753"><span class='Ref_to_Macro'>strftime</span></a><span class='Parentheses'>(</span><a href="timestamp.c.html#LN318"><span class='Ref_To_Local'>q</span></a><span class='Delimiter'>, </span><span class='Operator'>*</span><a href="timestamp.c.html#LN312"><span class='Ref_to_Parameter'>pstr_len</span></a><span class='Delimiter'>, </span><a href="timestamp.c.html#LN400"><span class='Ref_To_Local'>tmp</span></a><span class='Delimiter'>, </span><a href="timestamp.c.html#LN311"><span class='Ref_to_Parameter'>tm</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="timestamp.c.html#LN316"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>                            <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>                        <span class='Control'>while</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="timestamp.c.html#LN318"><span class='Ref_To_Local'>q</span></a><span class='Parentheses'>) 
</span>                        <span class='Delimiter'>{ 
</span>                            <a href="timestamp.c.html#LN318"><span class='Ref_To_Local'>q</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>                            <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="timestamp.c.html#LN312"><span class='Ref_to_Parameter'>pstr_len</span></a><span class='Parentheses'>)</span><span class='Operator'>--</span><span class='Delimiter'>; 
</span>                        <span class='Delimiter'>} 
</span>                        <a href="timestamp.c.html#LN311"><span class='Ref_to_Parameter'>tm</span></a><span class='Operator'>-&GT;</span>tm_mon <span class='Operator'>+= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>                        <a href="timestamp.c.html#LN315"><span class='Ref_To_Local'>replace_type</span></a> <span class='Operator'>= </span><a href="extern.h.html#LN9"><span class='Ref_to_Const'>PGTYPES_TYPE_NOTHING</span></a><span class='Delimiter'>; 
</span>                        <span class='Control'>break</span><span class='Delimiter'>; 
</span>                    <span class='Delimiter'>} 
</span> 
                    <span class='Comment_Multi_Line'>/* 
                     * The ISO 8601 year with century as a decimal number. The 
                     * 4-digit year corresponding to the ISO week number. 
                     */ 
</span>                <span class='Control'>case</span> <span class='String'>'G'</span><span class='Operator'>: 
</span>                    <span class='Delimiter'>{ 
</span>                        <span class='Comment_Multi_Line'>/* Keep compiler quiet - Don't use a literal format */ 
</span><a name="LN431"></a>                        <span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Local'>fmt</span> <span class='Operator'>= </span><span class='String'>"%G"</span><span class='Delimiter'>; 
</span> 
                        <a href="timestamp.c.html#LN311"><span class='Ref_to_Parameter'>tm</span></a><span class='Operator'>-&GT;</span>tm_mon <span class='Operator'>-= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>                        <a href="timestamp.c.html#LN316"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><a href="../../../backend/utils/adt/pg_locale.c.html#LN753"><span class='Ref_to_Macro'>strftime</span></a><span class='Parentheses'>(</span><a href="timestamp.c.html#LN318"><span class='Ref_To_Local'>q</span></a><span class='Delimiter'>, </span><span class='Operator'>*</span><a href="timestamp.c.html#LN312"><span class='Ref_to_Parameter'>pstr_len</span></a><span class='Delimiter'>, </span><a href="timestamp.c.html#LN431"><span class='Ref_To_Local'>fmt</span></a><span class='Delimiter'>, </span><a href="timestamp.c.html#LN311"><span class='Ref_to_Parameter'>tm</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="timestamp.c.html#LN316"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>                            <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>                        <span class='Control'>while</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="timestamp.c.html#LN318"><span class='Ref_To_Local'>q</span></a><span class='Parentheses'>) 
</span>                        <span class='Delimiter'>{ 
</span>                            <a href="timestamp.c.html#LN318"><span class='Ref_To_Local'>q</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>                            <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="timestamp.c.html#LN312"><span class='Ref_to_Parameter'>pstr_len</span></a><span class='Parentheses'>)</span><span class='Operator'>--</span><span class='Delimiter'>; 
</span>                        <span class='Delimiter'>} 
</span>                        <a href="timestamp.c.html#LN311"><span class='Ref_to_Parameter'>tm</span></a><span class='Operator'>-&GT;</span>tm_mon <span class='Operator'>+= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>                        <a href="timestamp.c.html#LN315"><span class='Ref_To_Local'>replace_type</span></a> <span class='Operator'>= </span><a href="extern.h.html#LN9"><span class='Ref_to_Const'>PGTYPES_TYPE_NOTHING</span></a><span class='Delimiter'>; 
</span>                    <span class='Delimiter'>} 
</span>                    <span class='Control'>break</span><span class='Delimiter'>; 
</span> 
                    <span class='Comment_Multi_Line'>/* 
                     * Like %G, but without century, i.e., with a 2-digit year 
                     * (00-99). 
                     */ 
</span>                <span class='Control'>case</span> <span class='String'>'g'</span><span class='Operator'>: 
</span>                    <span class='Delimiter'>{ 
</span><a name="LN453"></a>                        <span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Local'>fmt</span> <span class='Operator'>= </span><span class='String'>"%g"</span><span class='Delimiter'>; </span><span class='Comment_Multi_Line'>/* Keep compiler quiet about 
                                                 * 2-digit year */ 
</span> 
                        <a href="timestamp.c.html#LN311"><span class='Ref_to_Parameter'>tm</span></a><span class='Operator'>-&GT;</span>tm_mon <span class='Operator'>-= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>                        <a href="timestamp.c.html#LN316"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><a href="../../../backend/utils/adt/pg_locale.c.html#LN753"><span class='Ref_to_Macro'>strftime</span></a><span class='Parentheses'>(</span><a href="timestamp.c.html#LN318"><span class='Ref_To_Local'>q</span></a><span class='Delimiter'>, </span><span class='Operator'>*</span><a href="timestamp.c.html#LN312"><span class='Ref_to_Parameter'>pstr_len</span></a><span class='Delimiter'>, </span><a href="timestamp.c.html#LN453"><span class='Ref_To_Local'>fmt</span></a><span class='Delimiter'>, </span><a href="timestamp.c.html#LN311"><span class='Ref_to_Parameter'>tm</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="timestamp.c.html#LN316"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>                            <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>                        <span class='Control'>while</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="timestamp.c.html#LN318"><span class='Ref_To_Local'>q</span></a><span class='Parentheses'>) 
</span>                        <span class='Delimiter'>{ 
</span>                            <a href="timestamp.c.html#LN318"><span class='Ref_To_Local'>q</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>                            <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="timestamp.c.html#LN312"><span class='Ref_to_Parameter'>pstr_len</span></a><span class='Parentheses'>)</span><span class='Operator'>--</span><span class='Delimiter'>; 
</span>                        <span class='Delimiter'>} 
</span>                        <a href="timestamp.c.html#LN311"><span class='Ref_to_Parameter'>tm</span></a><span class='Operator'>-&GT;</span>tm_mon <span class='Operator'>+= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>                        <a href="timestamp.c.html#LN315"><span class='Ref_To_Local'>replace_type</span></a> <span class='Operator'>= </span><a href="extern.h.html#LN9"><span class='Ref_to_Const'>PGTYPES_TYPE_NOTHING</span></a><span class='Delimiter'>; 
</span>                    <span class='Delimiter'>} 
</span>                    <span class='Control'>break</span><span class='Delimiter'>; 
</span>                    <span class='Comment_Multi_Line'>/* hour (24 hour clock) with leading zeroes */ 
</span>                <span class='Control'>case</span> <span class='String'>'H'</span><span class='Operator'>: 
</span>                    <a href="timestamp.c.html#LN314"><span class='Ref_To_Local'>replace_val</span></a><span class='Operator'>.</span><a href="extern.h.html#LN29"><span class='Ref_to_Member'>uint_val</span></a> <span class='Operator'>= </span><a href="timestamp.c.html#LN311"><span class='Ref_to_Parameter'>tm</span></a><span class='Operator'>-&GT;</span>tm_hour<span class='Delimiter'>; 
</span>                    <a href="timestamp.c.html#LN315"><span class='Ref_To_Local'>replace_type</span></a> <span class='Operator'>= </span><a href="extern.h.html#LN16"><span class='Ref_to_Const'>PGTYPES_TYPE_UINT_2_LZ</span></a><span class='Delimiter'>; 
</span>                    <span class='Control'>break</span><span class='Delimiter'>; 
</span>                    <span class='Comment_Multi_Line'>/* hour (12 hour clock) with leading zeroes */ 
</span>                <span class='Control'>case</span> <span class='String'>'I'</span><span class='Operator'>: 
</span>                    <a href="timestamp.c.html#LN314"><span class='Ref_To_Local'>replace_val</span></a><span class='Operator'>.</span><a href="extern.h.html#LN29"><span class='Ref_to_Member'>uint_val</span></a> <span class='Operator'>= </span><a href="timestamp.c.html#LN311"><span class='Ref_to_Parameter'>tm</span></a><span class='Operator'>-&GT;</span>tm_hour <span class='Operator'>% </span><span class='Number'>12</span><span class='Delimiter'>; 
</span>                    <a href="timestamp.c.html#LN315"><span class='Ref_To_Local'>replace_type</span></a> <span class='Operator'>= </span><a href="extern.h.html#LN16"><span class='Ref_to_Const'>PGTYPES_TYPE_UINT_2_LZ</span></a><span class='Delimiter'>; 
</span>                    <span class='Control'>break</span><span class='Delimiter'>; 
</span> 
                    <span class='Comment_Multi_Line'>/* 
                     * The day of the year as a decimal number with leading 
                     * zeroes. It ranges from 001 to 366. 
                     */ 
</span>                <span class='Control'>case</span> <span class='String'>'j'</span><span class='Operator'>: 
</span>                    <a href="timestamp.c.html#LN314"><span class='Ref_To_Local'>replace_val</span></a><span class='Operator'>.</span><a href="extern.h.html#LN29"><span class='Ref_to_Member'>uint_val</span></a> <span class='Operator'>= </span><a href="timestamp.c.html#LN311"><span class='Ref_to_Parameter'>tm</span></a><span class='Operator'>-&GT;</span>tm_yday<span class='Delimiter'>; 
</span>                    <a href="timestamp.c.html#LN315"><span class='Ref_To_Local'>replace_type</span></a> <span class='Operator'>= </span><a href="extern.h.html#LN20"><span class='Ref_to_Const'>PGTYPES_TYPE_UINT_3_LZ</span></a><span class='Delimiter'>; 
</span>                    <span class='Control'>break</span><span class='Delimiter'>; 
</span> 
                    <span class='Comment_Multi_Line'>/* 
                     * The hour (24 hour clock). Leading zeroes will be turned 
                     * into spaces. 
                     */ 
</span>                <span class='Control'>case</span> <span class='String'>'k'</span><span class='Operator'>: 
</span>                    <a href="timestamp.c.html#LN314"><span class='Ref_To_Local'>replace_val</span></a><span class='Operator'>.</span><a href="extern.h.html#LN29"><span class='Ref_to_Member'>uint_val</span></a> <span class='Operator'>= </span><a href="timestamp.c.html#LN311"><span class='Ref_to_Parameter'>tm</span></a><span class='Operator'>-&GT;</span>tm_hour<span class='Delimiter'>; 
</span>                    <a href="timestamp.c.html#LN315"><span class='Ref_To_Local'>replace_type</span></a> <span class='Operator'>= </span><a href="extern.h.html#LN18"><span class='Ref_to_Const'>PGTYPES_TYPE_UINT_2_LS</span></a><span class='Delimiter'>; 
</span>                    <span class='Control'>break</span><span class='Delimiter'>; 
</span> 
                    <span class='Comment_Multi_Line'>/* 
                     * The hour (12 hour clock). Leading zeroes will be turned 
                     * into spaces. 
                     */ 
</span>                <span class='Control'>case</span> <span class='String'>'l'</span><span class='Operator'>: 
</span>                    <a href="timestamp.c.html#LN314"><span class='Ref_To_Local'>replace_val</span></a><span class='Operator'>.</span><a href="extern.h.html#LN29"><span class='Ref_to_Member'>uint_val</span></a> <span class='Operator'>= </span><a href="timestamp.c.html#LN311"><span class='Ref_to_Parameter'>tm</span></a><span class='Operator'>-&GT;</span>tm_hour <span class='Operator'>% </span><span class='Number'>12</span><span class='Delimiter'>; 
</span>                    <a href="timestamp.c.html#LN315"><span class='Ref_To_Local'>replace_type</span></a> <span class='Operator'>= </span><a href="extern.h.html#LN18"><span class='Ref_to_Const'>PGTYPES_TYPE_UINT_2_LS</span></a><span class='Delimiter'>; 
</span>                    <span class='Control'>break</span><span class='Delimiter'>; 
</span>                    <span class='Comment_Multi_Line'>/* The month as a decimal number with a leading zero */ 
</span>                <span class='Control'>case</span> <span class='String'>'m'</span><span class='Operator'>: 
</span>                    <a href="timestamp.c.html#LN314"><span class='Ref_To_Local'>replace_val</span></a><span class='Operator'>.</span><a href="extern.h.html#LN29"><span class='Ref_to_Member'>uint_val</span></a> <span class='Operator'>= </span><a href="timestamp.c.html#LN311"><span class='Ref_to_Parameter'>tm</span></a><span class='Operator'>-&GT;</span>tm_mon<span class='Delimiter'>; 
</span>                    <a href="timestamp.c.html#LN315"><span class='Ref_To_Local'>replace_type</span></a> <span class='Operator'>= </span><a href="extern.h.html#LN16"><span class='Ref_to_Const'>PGTYPES_TYPE_UINT_2_LZ</span></a><span class='Delimiter'>; 
</span>                    <span class='Control'>break</span><span class='Delimiter'>; 
</span>                    <span class='Comment_Multi_Line'>/* The minute as a decimal number with a leading zero */ 
</span>                <span class='Control'>case</span> <span class='String'>'M'</span><span class='Operator'>: 
</span>                    <a href="timestamp.c.html#LN314"><span class='Ref_To_Local'>replace_val</span></a><span class='Operator'>.</span><a href="extern.h.html#LN29"><span class='Ref_to_Member'>uint_val</span></a> <span class='Operator'>= </span><a href="timestamp.c.html#LN311"><span class='Ref_to_Parameter'>tm</span></a><span class='Operator'>-&GT;</span>tm_min<span class='Delimiter'>; 
</span>                    <a href="timestamp.c.html#LN315"><span class='Ref_To_Local'>replace_type</span></a> <span class='Operator'>= </span><a href="extern.h.html#LN16"><span class='Ref_to_Const'>PGTYPES_TYPE_UINT_2_LZ</span></a><span class='Delimiter'>; 
</span>                    <span class='Control'>break</span><span class='Delimiter'>; 
</span>                    <span class='Comment_Multi_Line'>/* A newline character */ 
</span>                <span class='Control'>case</span> <span class='String'>'n'</span><span class='Operator'>: 
</span>                    <a href="timestamp.c.html#LN314"><span class='Ref_To_Local'>replace_val</span></a><span class='Operator'>.</span><a href="extern.h.html#LN30"><span class='Ref_to_Member'>char_val</span></a> <span class='Operator'>= </span><span class='String'>'\n'</span><span class='Delimiter'>; 
</span>                    <a href="timestamp.c.html#LN315"><span class='Ref_To_Local'>replace_type</span></a> <span class='Operator'>= </span><a href="extern.h.html#LN12"><span class='Ref_to_Const'>PGTYPES_TYPE_CHAR</span></a><span class='Delimiter'>; 
</span>                    <span class='Control'>break</span><span class='Delimiter'>; 
</span>                    <span class='Comment_Multi_Line'>/* the AM/PM specifier (uppercase) */ 
</span>                    <span class='Comment_Multi_Line'>/* XXX should be locale aware */ 
</span>                <span class='Control'>case</span> <span class='String'>'p'</span><span class='Operator'>: 
</span>                    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="timestamp.c.html#LN311"><span class='Ref_to_Parameter'>tm</span></a><span class='Operator'>-&GT;</span>tm_hour <span class='Operator'>&LT; </span><span class='Number'>12</span><span class='Parentheses'>) 
</span>                        <a href="timestamp.c.html#LN314"><span class='Ref_To_Local'>replace_val</span></a><span class='Operator'>.</span><a href="extern.h.html#LN28"><span class='Ref_to_Member'>str_val</span></a> <span class='Operator'>= </span><span class='String'>"AM"</span><span class='Delimiter'>; 
</span>                    <span class='Control'>else</span> 
                        <a href="timestamp.c.html#LN314"><span class='Ref_To_Local'>replace_val</span></a><span class='Operator'>.</span><a href="extern.h.html#LN28"><span class='Ref_to_Member'>str_val</span></a> <span class='Operator'>= </span><span class='String'>"PM"</span><span class='Delimiter'>; 
</span>                    <a href="timestamp.c.html#LN315"><span class='Ref_To_Local'>replace_type</span></a> <span class='Operator'>= </span><a href="extern.h.html#LN11"><span class='Ref_to_Const'>PGTYPES_TYPE_STRING_CONSTANT</span></a><span class='Delimiter'>; 
</span>                    <span class='Control'>break</span><span class='Delimiter'>; 
</span>                    <span class='Comment_Multi_Line'>/* the AM/PM specifier (lowercase) */ 
</span>                    <span class='Comment_Multi_Line'>/* XXX should be locale aware */ 
</span>                <span class='Control'>case</span> <span class='String'>'P'</span><span class='Operator'>: 
</span>                    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="timestamp.c.html#LN311"><span class='Ref_to_Parameter'>tm</span></a><span class='Operator'>-&GT;</span>tm_hour <span class='Operator'>&LT; </span><span class='Number'>12</span><span class='Parentheses'>) 
</span>                        <a href="timestamp.c.html#LN314"><span class='Ref_To_Local'>replace_val</span></a><span class='Operator'>.</span><a href="extern.h.html#LN28"><span class='Ref_to_Member'>str_val</span></a> <span class='Operator'>= </span><span class='String'>"am"</span><span class='Delimiter'>; 
</span>                    <span class='Control'>else</span> 
                        <a href="timestamp.c.html#LN314"><span class='Ref_To_Local'>replace_val</span></a><span class='Operator'>.</span><a href="extern.h.html#LN28"><span class='Ref_to_Member'>str_val</span></a> <span class='Operator'>= </span><span class='String'>"pm"</span><span class='Delimiter'>; 
</span>                    <a href="timestamp.c.html#LN315"><span class='Ref_To_Local'>replace_type</span></a> <span class='Operator'>= </span><a href="extern.h.html#LN11"><span class='Ref_to_Const'>PGTYPES_TYPE_STRING_CONSTANT</span></a><span class='Delimiter'>; 
</span>                    <span class='Control'>break</span><span class='Delimiter'>; 
</span>                    <span class='Comment_Multi_Line'>/* the time in the format %I:%M:%S %p */ 
</span>                    <span class='Comment_Multi_Line'>/* XXX should be locale aware */ 
</span>                <span class='Control'>case</span> <span class='String'>'r'</span><span class='Operator'>: 
</span>                    <a href="timestamp.c.html#LN316"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><a href="timestamp.c.html#LN310"><span class='Ref_to_Func'>dttofmtasc_replace</span></a><span class='Parentheses'>(</span><a href="timestamp.c.html#LN311"><span class='Ref_to_Parameter'>ts</span></a><span class='Delimiter'>, </span><a href="timestamp.c.html#LN311"><span class='Ref_to_Parameter'>dDate</span></a><span class='Delimiter'>, </span><a href="timestamp.c.html#LN311"><span class='Ref_to_Parameter'>dow</span></a><span class='Delimiter'>, </span><a href="timestamp.c.html#LN311"><span class='Ref_to_Parameter'>tm</span></a><span class='Delimiter'>, 
</span>                                           <a href="timestamp.c.html#LN318"><span class='Ref_To_Local'>q</span></a><span class='Delimiter'>, </span><a href="timestamp.c.html#LN312"><span class='Ref_to_Parameter'>pstr_len</span></a><span class='Delimiter'>, 
</span>                                           <span class='String'>"%I:%M:%S %p"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="timestamp.c.html#LN316"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>) 
</span>                        <span class='Control'>return</span> <a href="timestamp.c.html#LN316"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>; 
</span>                    <span class='Control'>break</span><span class='Delimiter'>; 
</span>                    <span class='Comment_Multi_Line'>/* The time in 24 hour notation (%H:%M) */ 
</span>                <span class='Control'>case</span> <span class='String'>'R'</span><span class='Operator'>: 
</span>                    <a href="timestamp.c.html#LN316"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><a href="timestamp.c.html#LN310"><span class='Ref_to_Func'>dttofmtasc_replace</span></a><span class='Parentheses'>(</span><a href="timestamp.c.html#LN311"><span class='Ref_to_Parameter'>ts</span></a><span class='Delimiter'>, </span><a href="timestamp.c.html#LN311"><span class='Ref_to_Parameter'>dDate</span></a><span class='Delimiter'>, </span><a href="timestamp.c.html#LN311"><span class='Ref_to_Parameter'>dow</span></a><span class='Delimiter'>, </span><a href="timestamp.c.html#LN311"><span class='Ref_to_Parameter'>tm</span></a><span class='Delimiter'>, 
</span>                                           <a href="timestamp.c.html#LN318"><span class='Ref_To_Local'>q</span></a><span class='Delimiter'>, </span><a href="timestamp.c.html#LN312"><span class='Ref_to_Parameter'>pstr_len</span></a><span class='Delimiter'>, 
</span>                                           <span class='String'>"%H:%M"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="timestamp.c.html#LN316"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>) 
</span>                        <span class='Control'>return</span> <a href="timestamp.c.html#LN316"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>; 
</span>                    <span class='Control'>break</span><span class='Delimiter'>; 
</span>                    <span class='Comment_Multi_Line'>/* The number of seconds since the Epoch (1970-01-01) */ 
</span>                <span class='Control'>case</span> <span class='String'>'s'</span><span class='Operator'>: 
</span>                    <a href="timestamp.c.html#LN314"><span class='Ref_To_Local'>replace_val</span></a><span class='Operator'>.</span><a href="extern.h.html#LN33"><span class='Ref_to_Member'>int64_val</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="timestamp.c.html#LN311"><span class='Ref_to_Parameter'>ts</span></a> <span class='Operator'>- </span><a href="timestamp.c.html#LN71"><span class='Ref_to_Func'>SetEpochTimestamp</span></a><span class='Parentheses'>())</span> <span class='Operator'>/ </span><span class='Number'>1000000</span><span class='Operator'>.</span><span class='Number'>0</span><span class='Delimiter'>; 
</span>                    <a href="timestamp.c.html#LN315"><span class='Ref_To_Local'>replace_type</span></a> <span class='Operator'>= </span><a href="extern.h.html#LN14"><span class='Ref_to_Const'>PGTYPES_TYPE_INT64</span></a><span class='Delimiter'>; 
</span>                    <span class='Control'>break</span><span class='Delimiter'>; 
</span>                    <span class='Comment_Multi_Line'>/* seconds as a decimal number with leading zeroes */ 
</span>                <span class='Control'>case</span> <span class='String'>'S'</span><span class='Operator'>: 
</span>                    <a href="timestamp.c.html#LN314"><span class='Ref_To_Local'>replace_val</span></a><span class='Operator'>.</span><a href="extern.h.html#LN29"><span class='Ref_to_Member'>uint_val</span></a> <span class='Operator'>= </span><a href="timestamp.c.html#LN311"><span class='Ref_to_Parameter'>tm</span></a><span class='Operator'>-&GT;</span>tm_sec<span class='Delimiter'>; 
</span>                    <a href="timestamp.c.html#LN315"><span class='Ref_To_Local'>replace_type</span></a> <span class='Operator'>= </span><a href="extern.h.html#LN16"><span class='Ref_to_Const'>PGTYPES_TYPE_UINT_2_LZ</span></a><span class='Delimiter'>; 
</span>                    <span class='Control'>break</span><span class='Delimiter'>; 
</span>                    <span class='Comment_Multi_Line'>/* A tabulator */ 
</span>                <span class='Control'>case</span> <span class='String'>'t'</span><span class='Operator'>: 
</span>                    <a href="timestamp.c.html#LN314"><span class='Ref_To_Local'>replace_val</span></a><span class='Operator'>.</span><a href="extern.h.html#LN30"><span class='Ref_to_Member'>char_val</span></a> <span class='Operator'>= </span><span class='String'>'\t'</span><span class='Delimiter'>; 
</span>                    <a href="timestamp.c.html#LN315"><span class='Ref_To_Local'>replace_type</span></a> <span class='Operator'>= </span><a href="extern.h.html#LN12"><span class='Ref_to_Const'>PGTYPES_TYPE_CHAR</span></a><span class='Delimiter'>; 
</span>                    <span class='Control'>break</span><span class='Delimiter'>; 
</span>                    <span class='Comment_Multi_Line'>/* The time in 24 hour notation (%H:%M:%S) */ 
</span>                <span class='Control'>case</span> <span class='String'>'T'</span><span class='Operator'>: 
</span>                    <a href="timestamp.c.html#LN316"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><a href="timestamp.c.html#LN310"><span class='Ref_to_Func'>dttofmtasc_replace</span></a><span class='Parentheses'>(</span><a href="timestamp.c.html#LN311"><span class='Ref_to_Parameter'>ts</span></a><span class='Delimiter'>, </span><a href="timestamp.c.html#LN311"><span class='Ref_to_Parameter'>dDate</span></a><span class='Delimiter'>, </span><a href="timestamp.c.html#LN311"><span class='Ref_to_Parameter'>dow</span></a><span class='Delimiter'>, </span><a href="timestamp.c.html#LN311"><span class='Ref_to_Parameter'>tm</span></a><span class='Delimiter'>, 
</span>                                           <a href="timestamp.c.html#LN318"><span class='Ref_To_Local'>q</span></a><span class='Delimiter'>, </span><a href="timestamp.c.html#LN312"><span class='Ref_to_Parameter'>pstr_len</span></a><span class='Delimiter'>, 
</span>                                           <span class='String'>"%H:%M:%S"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="timestamp.c.html#LN316"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>) 
</span>                        <span class='Control'>return</span> <a href="timestamp.c.html#LN316"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>; 
</span>                    <span class='Control'>break</span><span class='Delimiter'>; 
</span> 
                    <span class='Comment_Multi_Line'>/* 
                     * The day of the week as a decimal, Monday = 1, Sunday = 
                     * 7 
                     */ 
</span>                <span class='Control'>case</span> <span class='String'>'u'</span><span class='Operator'>: 
</span>                    <a href="timestamp.c.html#LN314"><span class='Ref_To_Local'>replace_val</span></a><span class='Operator'>.</span><a href="extern.h.html#LN29"><span class='Ref_to_Member'>uint_val</span></a> <span class='Operator'>= </span><a href="timestamp.c.html#LN311"><span class='Ref_to_Parameter'>dow</span></a><span class='Delimiter'>; 
</span>                    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="timestamp.c.html#LN314"><span class='Ref_To_Local'>replace_val</span></a><span class='Operator'>.</span><a href="extern.h.html#LN29"><span class='Ref_to_Member'>uint_val</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>                        <a href="timestamp.c.html#LN314"><span class='Ref_To_Local'>replace_val</span></a><span class='Operator'>.</span><a href="extern.h.html#LN29"><span class='Ref_to_Member'>uint_val</span></a> <span class='Operator'>= </span><span class='Number'>7</span><span class='Delimiter'>; 
</span>                    <a href="timestamp.c.html#LN315"><span class='Ref_To_Local'>replace_type</span></a> <span class='Operator'>= </span><a href="extern.h.html#LN15"><span class='Ref_to_Const'>PGTYPES_TYPE_UINT</span></a><span class='Delimiter'>; 
</span>                    <span class='Control'>break</span><span class='Delimiter'>; 
</span>                    <span class='Comment_Multi_Line'>/* The week number of the year as a decimal number */ 
</span>                <span class='Control'>case</span> <span class='String'>'U'</span><span class='Operator'>: 
</span>                    <a href="timestamp.c.html#LN311"><span class='Ref_to_Parameter'>tm</span></a><span class='Operator'>-&GT;</span>tm_mon <span class='Operator'>-= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>                    <a href="timestamp.c.html#LN316"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><a href="../../../backend/utils/adt/pg_locale.c.html#LN753"><span class='Ref_to_Macro'>strftime</span></a><span class='Parentheses'>(</span><a href="timestamp.c.html#LN318"><span class='Ref_To_Local'>q</span></a><span class='Delimiter'>, </span><span class='Operator'>*</span><a href="timestamp.c.html#LN312"><span class='Ref_to_Parameter'>pstr_len</span></a><span class='Delimiter'>, </span><span class='String'>"%U"</span><span class='Delimiter'>, </span><a href="timestamp.c.html#LN311"><span class='Ref_to_Parameter'>tm</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="timestamp.c.html#LN316"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>                        <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>                    <span class='Control'>while</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="timestamp.c.html#LN318"><span class='Ref_To_Local'>q</span></a><span class='Parentheses'>) 
</span>                    <span class='Delimiter'>{ 
</span>                        <a href="timestamp.c.html#LN318"><span class='Ref_To_Local'>q</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>                        <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="timestamp.c.html#LN312"><span class='Ref_to_Parameter'>pstr_len</span></a><span class='Parentheses'>)</span><span class='Operator'>--</span><span class='Delimiter'>; 
</span>                    <span class='Delimiter'>} 
</span>                    <a href="timestamp.c.html#LN311"><span class='Ref_to_Parameter'>tm</span></a><span class='Operator'>-&GT;</span>tm_mon <span class='Operator'>+= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>                    <a href="timestamp.c.html#LN315"><span class='Ref_To_Local'>replace_type</span></a> <span class='Operator'>= </span><a href="extern.h.html#LN9"><span class='Ref_to_Const'>PGTYPES_TYPE_NOTHING</span></a><span class='Delimiter'>; 
</span>                    <span class='Control'>break</span><span class='Delimiter'>; 
</span> 
                    <span class='Comment_Multi_Line'>/* 
                     * The ISO 8601:1988 week number of the current year as a 
                     * decimal number. 
                     */ 
</span>                <span class='Control'>case</span> <span class='String'>'V'</span><span class='Operator'>: 
</span>                    <span class='Delimiter'>{ 
</span>                        <span class='Comment_Multi_Line'>/* Keep compiler quiet - Don't use a literal format */ 
</span><a name="LN612"></a>                        <span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Local'>fmt</span> <span class='Operator'>= </span><span class='String'>"%V"</span><span class='Delimiter'>; 
</span> 
                        <a href="timestamp.c.html#LN316"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><a href="../../../backend/utils/adt/pg_locale.c.html#LN753"><span class='Ref_to_Macro'>strftime</span></a><span class='Parentheses'>(</span><a href="timestamp.c.html#LN318"><span class='Ref_To_Local'>q</span></a><span class='Delimiter'>, </span><span class='Operator'>*</span><a href="timestamp.c.html#LN312"><span class='Ref_to_Parameter'>pstr_len</span></a><span class='Delimiter'>, </span><a href="timestamp.c.html#LN612"><span class='Ref_To_Local'>fmt</span></a><span class='Delimiter'>, </span><a href="timestamp.c.html#LN311"><span class='Ref_to_Parameter'>tm</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="timestamp.c.html#LN316"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>                            <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>                        <span class='Control'>while</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="timestamp.c.html#LN318"><span class='Ref_To_Local'>q</span></a><span class='Parentheses'>) 
</span>                        <span class='Delimiter'>{ 
</span>                            <a href="timestamp.c.html#LN318"><span class='Ref_To_Local'>q</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>                            <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="timestamp.c.html#LN312"><span class='Ref_to_Parameter'>pstr_len</span></a><span class='Parentheses'>)</span><span class='Operator'>--</span><span class='Delimiter'>; 
</span>                        <span class='Delimiter'>} 
</span>                        <a href="timestamp.c.html#LN315"><span class='Ref_To_Local'>replace_type</span></a> <span class='Operator'>= </span><a href="extern.h.html#LN9"><span class='Ref_to_Const'>PGTYPES_TYPE_NOTHING</span></a><span class='Delimiter'>; 
</span>                    <span class='Delimiter'>} 
</span>                    <span class='Control'>break</span><span class='Delimiter'>; 
</span> 
                    <span class='Comment_Multi_Line'>/* 
                     * The day of the week as a decimal, Sunday being 0 and 
                     * Monday 1. 
                     */ 
</span>                <span class='Control'>case</span> <span class='String'>'w'</span><span class='Operator'>: 
</span>                    <a href="timestamp.c.html#LN314"><span class='Ref_To_Local'>replace_val</span></a><span class='Operator'>.</span><a href="extern.h.html#LN29"><span class='Ref_to_Member'>uint_val</span></a> <span class='Operator'>= </span><a href="timestamp.c.html#LN311"><span class='Ref_to_Parameter'>dow</span></a><span class='Delimiter'>; 
</span>                    <a href="timestamp.c.html#LN315"><span class='Ref_To_Local'>replace_type</span></a> <span class='Operator'>= </span><a href="extern.h.html#LN15"><span class='Ref_to_Const'>PGTYPES_TYPE_UINT</span></a><span class='Delimiter'>; 
</span>                    <span class='Control'>break</span><span class='Delimiter'>; 
</span>                    <span class='Comment_Multi_Line'>/* The week number of the year (another definition) */ 
</span>                <span class='Control'>case</span> <span class='String'>'W'</span><span class='Operator'>: 
</span>                    <a href="timestamp.c.html#LN311"><span class='Ref_to_Parameter'>tm</span></a><span class='Operator'>-&GT;</span>tm_mon <span class='Operator'>-= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>                    <a href="timestamp.c.html#LN316"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><a href="../../../backend/utils/adt/pg_locale.c.html#LN753"><span class='Ref_to_Macro'>strftime</span></a><span class='Parentheses'>(</span><a href="timestamp.c.html#LN318"><span class='Ref_To_Local'>q</span></a><span class='Delimiter'>, </span><span class='Operator'>*</span><a href="timestamp.c.html#LN312"><span class='Ref_to_Parameter'>pstr_len</span></a><span class='Delimiter'>, </span><span class='String'>"%U"</span><span class='Delimiter'>, </span><a href="timestamp.c.html#LN311"><span class='Ref_to_Parameter'>tm</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="timestamp.c.html#LN316"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>                        <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>                    <span class='Control'>while</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="timestamp.c.html#LN318"><span class='Ref_To_Local'>q</span></a><span class='Parentheses'>) 
</span>                    <span class='Delimiter'>{ 
</span>                        <a href="timestamp.c.html#LN318"><span class='Ref_To_Local'>q</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>                        <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="timestamp.c.html#LN312"><span class='Ref_to_Parameter'>pstr_len</span></a><span class='Parentheses'>)</span><span class='Operator'>--</span><span class='Delimiter'>; 
</span>                    <span class='Delimiter'>} 
</span>                    <a href="timestamp.c.html#LN311"><span class='Ref_to_Parameter'>tm</span></a><span class='Operator'>-&GT;</span>tm_mon <span class='Operator'>+= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>                    <a href="timestamp.c.html#LN315"><span class='Ref_To_Local'>replace_type</span></a> <span class='Operator'>= </span><a href="extern.h.html#LN9"><span class='Ref_to_Const'>PGTYPES_TYPE_NOTHING</span></a><span class='Delimiter'>; 
</span>                    <span class='Control'>break</span><span class='Delimiter'>; 
</span> 
                    <span class='Comment_Multi_Line'>/* 
                     * The preferred date representation for the current 
                     * locale without the time. 
                     */ 
</span>                <span class='Control'>case</span> <span class='String'>'x'</span><span class='Operator'>: 
</span>                    <span class='Delimiter'>{ 
</span><a name="LN655"></a>                        <span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Local'>fmt</span> <span class='Operator'>= </span><span class='String'>"%x"</span><span class='Delimiter'>; </span><span class='Comment_Multi_Line'>/* Keep compiler quiet about 
                                                 * 2-digit year */ 
</span> 
                        <a href="timestamp.c.html#LN311"><span class='Ref_to_Parameter'>tm</span></a><span class='Operator'>-&GT;</span>tm_mon <span class='Operator'>-= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>                        <a href="timestamp.c.html#LN316"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><a href="../../../backend/utils/adt/pg_locale.c.html#LN753"><span class='Ref_to_Macro'>strftime</span></a><span class='Parentheses'>(</span><a href="timestamp.c.html#LN318"><span class='Ref_To_Local'>q</span></a><span class='Delimiter'>, </span><span class='Operator'>*</span><a href="timestamp.c.html#LN312"><span class='Ref_to_Parameter'>pstr_len</span></a><span class='Delimiter'>, </span><a href="timestamp.c.html#LN655"><span class='Ref_To_Local'>fmt</span></a><span class='Delimiter'>, </span><a href="timestamp.c.html#LN311"><span class='Ref_to_Parameter'>tm</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="timestamp.c.html#LN316"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>                            <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>                        <span class='Control'>while</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="timestamp.c.html#LN318"><span class='Ref_To_Local'>q</span></a><span class='Parentheses'>) 
</span>                        <span class='Delimiter'>{ 
</span>                            <a href="timestamp.c.html#LN318"><span class='Ref_To_Local'>q</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>                            <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="timestamp.c.html#LN312"><span class='Ref_to_Parameter'>pstr_len</span></a><span class='Parentheses'>)</span><span class='Operator'>--</span><span class='Delimiter'>; 
</span>                        <span class='Delimiter'>} 
</span>                        <a href="timestamp.c.html#LN311"><span class='Ref_to_Parameter'>tm</span></a><span class='Operator'>-&GT;</span>tm_mon <span class='Operator'>+= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>                        <a href="timestamp.c.html#LN315"><span class='Ref_To_Local'>replace_type</span></a> <span class='Operator'>= </span><a href="extern.h.html#LN9"><span class='Ref_to_Const'>PGTYPES_TYPE_NOTHING</span></a><span class='Delimiter'>; 
</span>                    <span class='Delimiter'>} 
</span>                    <span class='Control'>break</span><span class='Delimiter'>; 
</span> 
                    <span class='Comment_Multi_Line'>/* 
                     * The preferred time representation for the current 
                     * locale without the date. 
                     */ 
</span>                <span class='Control'>case</span> <span class='String'>'X'</span><span class='Operator'>: 
</span>                    <a href="timestamp.c.html#LN311"><span class='Ref_to_Parameter'>tm</span></a><span class='Operator'>-&GT;</span>tm_mon <span class='Operator'>-= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>                    <a href="timestamp.c.html#LN316"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><a href="../../../backend/utils/adt/pg_locale.c.html#LN753"><span class='Ref_to_Macro'>strftime</span></a><span class='Parentheses'>(</span><a href="timestamp.c.html#LN318"><span class='Ref_To_Local'>q</span></a><span class='Delimiter'>, </span><span class='Operator'>*</span><a href="timestamp.c.html#LN312"><span class='Ref_to_Parameter'>pstr_len</span></a><span class='Delimiter'>, </span><span class='String'>"%X"</span><span class='Delimiter'>, </span><a href="timestamp.c.html#LN311"><span class='Ref_to_Parameter'>tm</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="timestamp.c.html#LN316"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>                        <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>                    <span class='Control'>while</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="timestamp.c.html#LN318"><span class='Ref_To_Local'>q</span></a><span class='Parentheses'>) 
</span>                    <span class='Delimiter'>{ 
</span>                        <a href="timestamp.c.html#LN318"><span class='Ref_To_Local'>q</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>                        <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="timestamp.c.html#LN312"><span class='Ref_to_Parameter'>pstr_len</span></a><span class='Parentheses'>)</span><span class='Operator'>--</span><span class='Delimiter'>; 
</span>                    <span class='Delimiter'>} 
</span>                    <a href="timestamp.c.html#LN311"><span class='Ref_to_Parameter'>tm</span></a><span class='Operator'>-&GT;</span>tm_mon <span class='Operator'>+= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>                    <a href="timestamp.c.html#LN315"><span class='Ref_To_Local'>replace_type</span></a> <span class='Operator'>= </span><a href="extern.h.html#LN9"><span class='Ref_to_Const'>PGTYPES_TYPE_NOTHING</span></a><span class='Delimiter'>; 
</span>                    <span class='Control'>break</span><span class='Delimiter'>; 
</span>                    <span class='Comment_Multi_Line'>/* The year without the century (2 digits, leading zeroes) */ 
</span>                <span class='Control'>case</span> <span class='String'>'y'</span><span class='Operator'>: 
</span>                    <a href="timestamp.c.html#LN314"><span class='Ref_To_Local'>replace_val</span></a><span class='Operator'>.</span><a href="extern.h.html#LN29"><span class='Ref_to_Member'>uint_val</span></a> <span class='Operator'>= </span><a href="timestamp.c.html#LN311"><span class='Ref_to_Parameter'>tm</span></a><span class='Operator'>-&GT;</span>tm_year <span class='Operator'>% </span><span class='Number'>100</span><span class='Delimiter'>; 
</span>                    <a href="timestamp.c.html#LN315"><span class='Ref_To_Local'>replace_type</span></a> <span class='Operator'>= </span><a href="extern.h.html#LN16"><span class='Ref_to_Const'>PGTYPES_TYPE_UINT_2_LZ</span></a><span class='Delimiter'>; 
</span>                    <span class='Control'>break</span><span class='Delimiter'>; 
</span>                    <span class='Comment_Multi_Line'>/* The year with the century (4 digits) */ 
</span>                <span class='Control'>case</span> <span class='String'>'Y'</span><span class='Operator'>: 
</span>                    <a href="timestamp.c.html#LN314"><span class='Ref_To_Local'>replace_val</span></a><span class='Operator'>.</span><a href="extern.h.html#LN29"><span class='Ref_to_Member'>uint_val</span></a> <span class='Operator'>= </span><a href="timestamp.c.html#LN311"><span class='Ref_to_Parameter'>tm</span></a><span class='Operator'>-&GT;</span>tm_year<span class='Delimiter'>; 
</span>                    <a href="timestamp.c.html#LN315"><span class='Ref_To_Local'>replace_type</span></a> <span class='Operator'>= </span><a href="extern.h.html#LN15"><span class='Ref_to_Const'>PGTYPES_TYPE_UINT</span></a><span class='Delimiter'>; 
</span>                    <span class='Control'>break</span><span class='Delimiter'>; 
</span>                    <span class='Comment_Multi_Line'>/* The time zone offset from GMT */ 
</span>                <span class='Control'>case</span> <span class='String'>'z'</span><span class='Operator'>: 
</span>                    <a href="timestamp.c.html#LN311"><span class='Ref_to_Parameter'>tm</span></a><span class='Operator'>-&GT;</span>tm_mon <span class='Operator'>-= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>                    <a href="timestamp.c.html#LN316"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><a href="../../../backend/utils/adt/pg_locale.c.html#LN753"><span class='Ref_to_Macro'>strftime</span></a><span class='Parentheses'>(</span><a href="timestamp.c.html#LN318"><span class='Ref_To_Local'>q</span></a><span class='Delimiter'>, </span><span class='Operator'>*</span><a href="timestamp.c.html#LN312"><span class='Ref_to_Parameter'>pstr_len</span></a><span class='Delimiter'>, </span><span class='String'>"%z"</span><span class='Delimiter'>, </span><a href="timestamp.c.html#LN311"><span class='Ref_to_Parameter'>tm</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="timestamp.c.html#LN316"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>                        <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>                    <span class='Control'>while</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="timestamp.c.html#LN318"><span class='Ref_To_Local'>q</span></a><span class='Parentheses'>) 
</span>                    <span class='Delimiter'>{ 
</span>                        <a href="timestamp.c.html#LN318"><span class='Ref_To_Local'>q</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>                        <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="timestamp.c.html#LN312"><span class='Ref_to_Parameter'>pstr_len</span></a><span class='Parentheses'>)</span><span class='Operator'>--</span><span class='Delimiter'>; 
</span>                    <span class='Delimiter'>} 
</span>                    <a href="timestamp.c.html#LN311"><span class='Ref_to_Parameter'>tm</span></a><span class='Operator'>-&GT;</span>tm_mon <span class='Operator'>+= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>                    <a href="timestamp.c.html#LN315"><span class='Ref_To_Local'>replace_type</span></a> <span class='Operator'>= </span><a href="extern.h.html#LN9"><span class='Ref_to_Const'>PGTYPES_TYPE_NOTHING</span></a><span class='Delimiter'>; 
</span>                    <span class='Control'>break</span><span class='Delimiter'>; 
</span>                    <span class='Comment_Multi_Line'>/* The name or abbreviation of the time zone */ 
</span>                <span class='Control'>case</span> <span class='String'>'Z'</span><span class='Operator'>: 
</span>                    <a href="timestamp.c.html#LN311"><span class='Ref_to_Parameter'>tm</span></a><span class='Operator'>-&GT;</span>tm_mon <span class='Operator'>-= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>                    <a href="timestamp.c.html#LN316"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><a href="../../../backend/utils/adt/pg_locale.c.html#LN753"><span class='Ref_to_Macro'>strftime</span></a><span class='Parentheses'>(</span><a href="timestamp.c.html#LN318"><span class='Ref_To_Local'>q</span></a><span class='Delimiter'>, </span><span class='Operator'>*</span><a href="timestamp.c.html#LN312"><span class='Ref_to_Parameter'>pstr_len</span></a><span class='Delimiter'>, </span><span class='String'>"%Z"</span><span class='Delimiter'>, </span><a href="timestamp.c.html#LN311"><span class='Ref_to_Parameter'>tm</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="timestamp.c.html#LN316"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>                        <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>                    <span class='Control'>while</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="timestamp.c.html#LN318"><span class='Ref_To_Local'>q</span></a><span class='Parentheses'>) 
</span>                    <span class='Delimiter'>{ 
</span>                        <a href="timestamp.c.html#LN318"><span class='Ref_To_Local'>q</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>                        <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="timestamp.c.html#LN312"><span class='Ref_to_Parameter'>pstr_len</span></a><span class='Parentheses'>)</span><span class='Operator'>--</span><span class='Delimiter'>; 
</span>                    <span class='Delimiter'>} 
</span>                    <a href="timestamp.c.html#LN311"><span class='Ref_to_Parameter'>tm</span></a><span class='Operator'>-&GT;</span>tm_mon <span class='Operator'>+= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>                    <a href="timestamp.c.html#LN315"><span class='Ref_To_Local'>replace_type</span></a> <span class='Operator'>= </span><a href="extern.h.html#LN9"><span class='Ref_to_Const'>PGTYPES_TYPE_NOTHING</span></a><span class='Delimiter'>; 
</span>                    <span class='Control'>break</span><span class='Delimiter'>; 
</span>                    <span class='Comment_Multi_Line'>/* A % sign */ 
</span>                <span class='Control'>case</span> <span class='String'>'%'</span><span class='Operator'>: 
</span>                    <a href="timestamp.c.html#LN314"><span class='Ref_To_Local'>replace_val</span></a><span class='Operator'>.</span><a href="extern.h.html#LN30"><span class='Ref_to_Member'>char_val</span></a> <span class='Operator'>= </span><span class='String'>'%'</span><span class='Delimiter'>; 
</span>                    <a href="timestamp.c.html#LN315"><span class='Ref_To_Local'>replace_type</span></a> <span class='Operator'>= </span><a href="extern.h.html#LN12"><span class='Ref_to_Const'>PGTYPES_TYPE_CHAR</span></a><span class='Delimiter'>; 
</span>                    <span class='Control'>break</span><span class='Delimiter'>; 
</span>                <span class='Control'>case</span> <span class='String'>'\0'</span><span class='Operator'>: 
</span>                    <span class='Comment_Multi_Line'>/* fmtstr: foo%' - The string ends with a % sign */ 
</span> 
                    <span class='Comment_Multi_Line'>/* 
                     * this is not compliant to the specification 
                     */ 
</span>                    <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>                <span class='Control'>default</span><span class='Operator'>: 
</span> 
                    <span class='Comment_Multi_Line'>/* 
                     * if we don't know the pattern, we just copy it 
                     */ 
</span>                    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="timestamp.c.html#LN312"><span class='Ref_to_Parameter'>pstr_len</span></a> <span class='Operator'>&GT; </span><span class='Number'>1</span><span class='Parentheses'>) 
</span>                    <span class='Delimiter'>{ 
</span>                        <span class='Operator'>*</span><a href="timestamp.c.html#LN318"><span class='Ref_To_Local'>q</span></a> <span class='Operator'>= </span><span class='String'>'%'</span><span class='Delimiter'>; 
</span>                        <a href="timestamp.c.html#LN318"><span class='Ref_To_Local'>q</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>                        <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="timestamp.c.html#LN312"><span class='Ref_to_Parameter'>pstr_len</span></a><span class='Parentheses'>)</span><span class='Operator'>--</span><span class='Delimiter'>; 
</span>                        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="timestamp.c.html#LN312"><span class='Ref_to_Parameter'>pstr_len</span></a> <span class='Operator'>&GT; </span><span class='Number'>1</span><span class='Parentheses'>) 
</span>                        <span class='Delimiter'>{ 
</span>                            <span class='Operator'>*</span><a href="timestamp.c.html#LN318"><span class='Ref_To_Local'>q</span></a> <span class='Operator'>= *</span><a href="timestamp.c.html#LN317"><span class='Ref_To_Local'>p</span></a><span class='Delimiter'>; 
</span>                            <a href="timestamp.c.html#LN318"><span class='Ref_To_Local'>q</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>                            <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="timestamp.c.html#LN312"><span class='Ref_to_Parameter'>pstr_len</span></a><span class='Parentheses'>)</span><span class='Operator'>--</span><span class='Delimiter'>; 
</span>                        <span class='Delimiter'>} 
</span>                        <span class='Control'>else</span> 
                        <span class='Delimiter'>{ 
</span>                            <span class='Operator'>*</span><a href="timestamp.c.html#LN318"><span class='Ref_To_Local'>q</span></a> <span class='Operator'>= </span><span class='String'>'\0'</span><span class='Delimiter'>; 
</span>                            <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>                        <span class='Delimiter'>} 
</span>                        <span class='Operator'>*</span><a href="timestamp.c.html#LN318"><span class='Ref_To_Local'>q</span></a> <span class='Operator'>= </span><span class='String'>'\0'</span><span class='Delimiter'>; 
</span>                    <span class='Delimiter'>} 
</span>                    <span class='Control'>else</span> 
                        <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>                    <span class='Control'>break</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end switch *p &raquo; </span> 
            <a href="timestamp.c.html#LN316"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><a href="common.c.html#LN27"><span class='Ref_to_Func'>pgtypes_fmt_replace</span></a><span class='Parentheses'>(</span><a href="timestamp.c.html#LN314"><span class='Ref_To_Local'>replace_val</span></a><span class='Delimiter'>, </span><a href="timestamp.c.html#LN315"><span class='Ref_To_Local'>replace_type</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="timestamp.c.html#LN318"><span class='Ref_To_Local'>q</span></a><span class='Delimiter'>, </span><a href="timestamp.c.html#LN312"><span class='Ref_to_Parameter'>pstr_len</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="timestamp.c.html#LN316"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>) 
</span>                <span class='Control'>return</span> <a href="timestamp.c.html#LN316"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if *p=='%' &raquo; </span> 
        <span class='Control'>else</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="timestamp.c.html#LN312"><span class='Ref_to_Parameter'>pstr_len</span></a> <span class='Operator'>&GT; </span><span class='Number'>1</span><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <span class='Operator'>*</span><a href="timestamp.c.html#LN318"><span class='Ref_To_Local'>q</span></a> <span class='Operator'>= *</span><a href="timestamp.c.html#LN317"><span class='Ref_To_Local'>p</span></a><span class='Delimiter'>; 
</span>                <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="timestamp.c.html#LN312"><span class='Ref_to_Parameter'>pstr_len</span></a><span class='Parentheses'>)</span><span class='Operator'>--</span><span class='Delimiter'>; 
</span>                <a href="timestamp.c.html#LN318"><span class='Ref_To_Local'>q</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>                <span class='Operator'>*</span><a href="timestamp.c.html#LN318"><span class='Ref_To_Local'>q</span></a> <span class='Operator'>= </span><span class='String'>'\0'</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>            <span class='Control'>else</span> 
                <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <a href="timestamp.c.html#LN317"><span class='Ref_To_Local'>p</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end while *p &raquo; </span> 
    <span class='Control'>return</span> <span class='Number'>0</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end dttofmtasc_replace &raquo; </span> 
 
 
<span class='Keyword'>int 
</span><a name="LN789"></a><span class='Declare_Function'>PGTYPEStimestamp_fmt_asc</span><span class='Parentheses'>(</span><a href="../include/pgtypes_timestamp.h.html#LN8"><span class='Ref_to_Typedef'>timestamp</span></a> <span class='Operator'>* </span><span class='Declare_Parameter'>ts</span><span class='Delimiter'>, </span><span class='Keyword'>char </span><span class='Operator'>*</span><span class='Declare_Parameter'>output</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>str_len</span><span class='Delimiter'>, </span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>fmtstr</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN791"></a>    <span class='Control'>struct</span> <a href="timestamp.c.html#LN791"><span class='Ref_To_Local'>tm</span></a>   <span class='Declare_Local'>tm</span><span class='Delimiter'>; 
</span><a name="LN792"></a>    <a href="dt.h.html#LN9"><span class='Ref_to_Typedef'>fsec_t</span></a>      <span class='Declare_Local'>fsec</span><span class='Delimiter'>; 
</span><a name="LN793"></a>    <a href="../include/pgtypes_date.h.html#LN7"><span class='Ref_to_Typedef'>date</span></a>        <span class='Declare_Local'>dDate</span><span class='Delimiter'>; 
</span><a name="LN794"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>dow</span><span class='Delimiter'>; 
</span> 
    <a href="timestamp.c.html#LN793"><span class='Ref_To_Local'>dDate</span></a> <span class='Operator'>= </span><a href="../include/pgtypes_date.h.html#LN18"><span class='Ref_to_Proto'>PGTYPESdate_from_timestamp</span></a><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="timestamp.c.html#LN789"><span class='Ref_to_Parameter'>ts</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="timestamp.c.html#LN794"><span class='Ref_To_Local'>dow</span></a> <span class='Operator'>= </span><a href="../include/pgtypes_date.h.html#LN21"><span class='Ref_to_Proto'>PGTYPESdate_dayofweek</span></a><span class='Parentheses'>(</span><a href="timestamp.c.html#LN793"><span class='Ref_To_Local'>dDate</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../../include/utils/timestamp.h.html#LN84"><span class='Ref_to_Proto'>timestamp2tm</span></a><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="timestamp.c.html#LN789"><span class='Ref_to_Parameter'>ts</span></a><span class='Delimiter'>, </span><span class='Null_Value'>NULL</span><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="timestamp.c.html#LN791"><span class='Ref_To_Local'>tm</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="timestamp.c.html#LN792"><span class='Ref_To_Local'>fsec</span></a><span class='Delimiter'>, </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="timestamp.c.html#LN310"><span class='Ref_to_Func'>dttofmtasc_replace</span></a><span class='Parentheses'>(</span><a href="timestamp.c.html#LN789"><span class='Ref_to_Parameter'>ts</span></a><span class='Delimiter'>, </span><a href="timestamp.c.html#LN793"><span class='Ref_To_Local'>dDate</span></a><span class='Delimiter'>, </span><a href="timestamp.c.html#LN794"><span class='Ref_To_Local'>dow</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="timestamp.c.html#LN791"><span class='Ref_To_Local'>tm</span></a><span class='Delimiter'>, </span><a href="timestamp.c.html#LN789"><span class='Ref_to_Parameter'>output</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="timestamp.c.html#LN789"><span class='Ref_to_Parameter'>str_len</span></a><span class='Delimiter'>, </span><a href="timestamp.c.html#LN789"><span class='Ref_to_Parameter'>fmtstr</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Keyword'>int 
</span><a name="LN804"></a><span class='Declare_Function'>PGTYPEStimestamp_sub</span><span class='Parentheses'>(</span><a href="../include/pgtypes_timestamp.h.html#LN8"><span class='Ref_to_Typedef'>timestamp</span></a> <span class='Operator'>* </span><span class='Declare_Parameter'>ts1</span><span class='Delimiter'>, </span><a href="../include/pgtypes_timestamp.h.html#LN8"><span class='Ref_to_Typedef'>timestamp</span></a> <span class='Operator'>* </span><span class='Declare_Parameter'>ts2</span><span class='Delimiter'>, </span><a href="../include/pgtypes_interval.h.html#LN25"><span class='Ref_to_Typedef'>interval</span></a> <span class='Operator'>* </span><span class='Declare_Parameter'>iv</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/datatype/timestamp.h.html#LN121"><span class='Ref_to_Macro'>TIMESTAMP_NOT_FINITE</span></a><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="timestamp.c.html#LN804"><span class='Ref_to_Parameter'>ts1</span></a><span class='Parentheses'>) </span><span class='Operator'>|| </span><a href="../../../include/datatype/timestamp.h.html#LN121"><span class='Ref_to_Macro'>TIMESTAMP_NOT_FINITE</span></a><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="timestamp.c.html#LN804"><span class='Ref_to_Parameter'>ts2</span></a><span class='Parentheses'>))</span> 
        <span class='Control'>return</span> <a href="../include/pgtypes_error.h.html#LN15"><span class='Ref_to_Const'>PGTYPES_TS_ERR_EINFTIME</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
        <a href="timestamp.c.html#LN804"><span class='Ref_to_Parameter'>iv</span></a><span class='Operator'>-&GT;</span><a href="../include/pgtypes_interval.h.html#LN27"><span class='Ref_to_Member'>time</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="timestamp.c.html#LN804"><span class='Ref_to_Parameter'>ts1</span></a> <span class='Operator'>- *</span><a href="timestamp.c.html#LN804"><span class='Ref_to_Parameter'>ts2</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="timestamp.c.html#LN804"><span class='Ref_to_Parameter'>iv</span></a><span class='Operator'>-&GT;</span><a href="../include/pgtypes_interval.h.html#LN28"><span class='Ref_to_Member'>month</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <span class='Number'>0</span><span class='Delimiter'>; 
} 
</span> 
<span class='Keyword'>int 
</span><a name="LN817"></a><span class='Declare_Function'>PGTYPEStimestamp_defmt_asc</span><span class='Parentheses'>(</span><span class='Keyword'>char </span><span class='Operator'>*</span><span class='Declare_Parameter'>str</span><span class='Delimiter'>, </span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>fmt</span><span class='Delimiter'>, </span><a href="../include/pgtypes_timestamp.h.html#LN8"><span class='Ref_to_Typedef'>timestamp</span></a> <span class='Operator'>* </span><span class='Declare_Parameter'>d</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN819"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>year</span><span class='Delimiter'>, 
</span><a name="LN820"></a>                <span class='Declare_Local'>month</span><span class='Delimiter'>, 
</span><a name="LN821"></a>                <span class='Declare_Local'>day</span><span class='Delimiter'>; 
</span><a name="LN822"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>hour</span><span class='Delimiter'>, 
</span><a name="LN823"></a>                <span class='Declare_Local'>minute</span><span class='Delimiter'>, 
</span><a name="LN824"></a>                <span class='Declare_Local'>second</span><span class='Delimiter'>; 
</span><a name="LN825"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>tz</span><span class='Delimiter'>; 
</span> 
<a name="LN827"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>i</span><span class='Delimiter'>; 
</span><a name="LN828"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>mstr</span><span class='Delimiter'>; 
</span><a name="LN829"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>mfmt</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="timestamp.c.html#LN817"><span class='Ref_to_Parameter'>fmt</span></a><span class='Parentheses'>) 
</span>        <a href="timestamp.c.html#LN817"><span class='Ref_to_Parameter'>fmt</span></a> <span class='Operator'>= </span><span class='String'>"%Y-%m-%d %H:%M:%S"</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="timestamp.c.html#LN817"><span class='Ref_to_Parameter'>fmt</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>]</span><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <span class='Number'>1</span><span class='Delimiter'>; 
</span> 
    <a href="timestamp.c.html#LN828"><span class='Ref_To_Local'>mstr</span></a> <span class='Operator'>= </span><a href="common.c.html#LN17"><span class='Ref_to_Func'>pgtypes_strdup</span></a><span class='Parentheses'>(</span><a href="timestamp.c.html#LN817"><span class='Ref_to_Parameter'>str</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="timestamp.c.html#LN829"><span class='Ref_To_Local'>mfmt</span></a> <span class='Operator'>= </span><a href="common.c.html#LN17"><span class='Ref_to_Func'>pgtypes_strdup</span></a><span class='Parentheses'>(</span><a href="timestamp.c.html#LN817"><span class='Ref_to_Parameter'>fmt</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * initialize with impossible values so that we can see if the fields 
     * where specified at all 
     */ 
</span>    <span class='Comment_Multi_Line'>/* XXX ambiguity with 1 BC for year? */ 
</span>    <a href="timestamp.c.html#LN819"><span class='Ref_To_Local'>year</span></a> <span class='Operator'>= -</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <a href="timestamp.c.html#LN820"><span class='Ref_To_Local'>month</span></a> <span class='Operator'>= -</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <a href="timestamp.c.html#LN821"><span class='Ref_To_Local'>day</span></a> <span class='Operator'>= -</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <a href="timestamp.c.html#LN822"><span class='Ref_To_Local'>hour</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <a href="timestamp.c.html#LN823"><span class='Ref_To_Local'>minute</span></a> <span class='Operator'>= -</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <a href="timestamp.c.html#LN824"><span class='Ref_To_Local'>second</span></a> <span class='Operator'>= -</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <a href="timestamp.c.html#LN825"><span class='Ref_To_Local'>tz</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span> 
    <a href="timestamp.c.html#LN827"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><a href="dt.h.html#LN329"><span class='Ref_to_Proto'>PGTYPEStimestamp_defmt_scan</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="timestamp.c.html#LN828"><span class='Ref_To_Local'>mstr</span></a><span class='Delimiter'>, </span><a href="timestamp.c.html#LN829"><span class='Ref_To_Local'>mfmt</span></a><span class='Delimiter'>, </span><a href="timestamp.c.html#LN817"><span class='Ref_to_Parameter'>d</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="timestamp.c.html#LN819"><span class='Ref_To_Local'>year</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="timestamp.c.html#LN820"><span class='Ref_To_Local'>month</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="timestamp.c.html#LN821"><span class='Ref_To_Local'>day</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="timestamp.c.html#LN822"><span class='Ref_To_Local'>hour</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="timestamp.c.html#LN823"><span class='Ref_To_Local'>minute</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="timestamp.c.html#LN824"><span class='Ref_To_Local'>second</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="timestamp.c.html#LN825"><span class='Ref_To_Local'>tz</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../../include/snowball/header.h.html#LN64"><span class='Ref_to_Macro'>free</span></a><span class='Parentheses'>(</span><a href="timestamp.c.html#LN828"><span class='Ref_To_Local'>mstr</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../../include/snowball/header.h.html#LN64"><span class='Ref_to_Macro'>free</span></a><span class='Parentheses'>(</span><a href="timestamp.c.html#LN829"><span class='Ref_To_Local'>mfmt</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <a href="timestamp.c.html#LN827"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end PGTYPEStimestamp_defmt_asc &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
* add an interval to a time stamp 
* 
*   *tout = tin + span 
* 
*    returns 0 if successful 
*    returns -1 if it fails 
* 
*/ 
</span> 
<span class='Keyword'>int 
</span><a name="LN869"></a><span class='Declare_Function'>PGTYPEStimestamp_add_interval</span><span class='Parentheses'>(</span><a href="../include/pgtypes_timestamp.h.html#LN8"><span class='Ref_to_Typedef'>timestamp</span></a> <span class='Operator'>* </span><span class='Declare_Parameter'>tin</span><span class='Delimiter'>, </span><a href="../include/pgtypes_interval.h.html#LN25"><span class='Ref_to_Typedef'>interval</span></a> <span class='Operator'>* </span><span class='Declare_Parameter'>span</span><span class='Delimiter'>, </span><a href="../include/pgtypes_timestamp.h.html#LN8"><span class='Ref_to_Typedef'>timestamp</span></a> <span class='Operator'>* </span><span class='Declare_Parameter'>tout</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/datatype/timestamp.h.html#LN121"><span class='Ref_to_Macro'>TIMESTAMP_NOT_FINITE</span></a><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="timestamp.c.html#LN869"><span class='Ref_to_Parameter'>tin</span></a><span class='Parentheses'>))</span> 
        <span class='Operator'>*</span><a href="timestamp.c.html#LN869"><span class='Ref_to_Parameter'>tout</span></a> <span class='Operator'>= *</span><a href="timestamp.c.html#LN869"><span class='Ref_to_Parameter'>tin</span></a><span class='Delimiter'>; 
</span> 
 
    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="timestamp.c.html#LN869"><span class='Ref_to_Parameter'>span</span></a><span class='Operator'>-&GT;</span><a href="../include/pgtypes_interval.h.html#LN28"><span class='Ref_to_Member'>month</span></a> <span class='Operator'>!= </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span><a name="LN879"></a>            <span class='Control'>struct</span> <a href="timestamp.c.html#LN880"><span class='Ref_To_Local'>tm</span></a>   <span class='Declare_Local'>tt</span><span class='Delimiter'>, 
</span><a name="LN880"></a>                       <span class='Operator'>*</span><span class='Declare_Local'>tm</span> <span class='Operator'>= &</span><a href="timestamp.c.html#LN879"><span class='Ref_To_Local'>tt</span></a><span class='Delimiter'>; 
</span><a name="LN881"></a>            <a href="dt.h.html#LN9"><span class='Ref_to_Typedef'>fsec_t</span></a>      <span class='Declare_Local'>fsec</span><span class='Delimiter'>; 
</span> 
 
            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../../include/utils/timestamp.h.html#LN84"><span class='Ref_to_Proto'>timestamp2tm</span></a><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="timestamp.c.html#LN869"><span class='Ref_to_Parameter'>tin</span></a><span class='Delimiter'>, </span><span class='Null_Value'>NULL</span><span class='Delimiter'>, </span><a href="timestamp.c.html#LN880"><span class='Ref_To_Local'>tm</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="timestamp.c.html#LN881"><span class='Ref_To_Local'>fsec</span></a><span class='Delimiter'>, </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) </span><span class='Operator'>!= </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
                <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>            <a href="timestamp.c.html#LN880"><span class='Ref_To_Local'>tm</span></a><span class='Operator'>-&GT;</span>tm_mon <span class='Operator'>+= </span><a href="timestamp.c.html#LN869"><span class='Ref_to_Parameter'>span</span></a><span class='Operator'>-&GT;</span><a href="../include/pgtypes_interval.h.html#LN28"><span class='Ref_to_Member'>month</span></a><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="timestamp.c.html#LN880"><span class='Ref_To_Local'>tm</span></a><span class='Operator'>-&GT;</span>tm_mon <span class='Operator'>&GT; </span><a href="../../../include/datatype/timestamp.h.html#LN68"><span class='Ref_to_Const'>MONTHS_PER_YEAR</span></a><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <a href="timestamp.c.html#LN880"><span class='Ref_To_Local'>tm</span></a><span class='Operator'>-&GT;</span>tm_year <span class='Operator'>+= </span><span class='Parentheses'>(</span><a href="timestamp.c.html#LN880"><span class='Ref_To_Local'>tm</span></a><span class='Operator'>-&GT;</span>tm_mon <span class='Operator'>- </span><span class='Number'>1</span><span class='Parentheses'>) </span><span class='Operator'>/ </span><a href="../../../include/datatype/timestamp.h.html#LN68"><span class='Ref_to_Const'>MONTHS_PER_YEAR</span></a><span class='Delimiter'>; 
</span>                <a href="timestamp.c.html#LN880"><span class='Ref_To_Local'>tm</span></a><span class='Operator'>-&GT;</span>tm_mon <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="timestamp.c.html#LN880"><span class='Ref_To_Local'>tm</span></a><span class='Operator'>-&GT;</span>tm_mon <span class='Operator'>- </span><span class='Number'>1</span><span class='Parentheses'>) </span><span class='Operator'>% </span><a href="../../../include/datatype/timestamp.h.html#LN68"><span class='Ref_to_Const'>MONTHS_PER_YEAR</span></a> <span class='Operator'>+ </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>            <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="timestamp.c.html#LN880"><span class='Ref_To_Local'>tm</span></a><span class='Operator'>-&GT;</span>tm_mon <span class='Operator'>&LT; </span><span class='Number'>1</span><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <a href="timestamp.c.html#LN880"><span class='Ref_To_Local'>tm</span></a><span class='Operator'>-&GT;</span>tm_year <span class='Operator'>+= </span><a href="timestamp.c.html#LN880"><span class='Ref_To_Local'>tm</span></a><span class='Operator'>-&GT;</span>tm_mon <span class='Operator'>/ </span><a href="../../../include/datatype/timestamp.h.html#LN68"><span class='Ref_to_Const'>MONTHS_PER_YEAR</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>                <a href="timestamp.c.html#LN880"><span class='Ref_To_Local'>tm</span></a><span class='Operator'>-&GT;</span>tm_mon <span class='Operator'>= </span><a href="timestamp.c.html#LN880"><span class='Ref_To_Local'>tm</span></a><span class='Operator'>-&GT;</span>tm_mon <span class='Operator'>% </span><a href="../../../include/datatype/timestamp.h.html#LN68"><span class='Ref_to_Const'>MONTHS_PER_YEAR</span></a> <span class='Operator'>+ </span><a href="../../../include/datatype/timestamp.h.html#LN68"><span class='Ref_to_Const'>MONTHS_PER_YEAR</span></a><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span> 
 
            <span class='Comment_Multi_Line'>/* adjust for end of month boundary problems... */ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="timestamp.c.html#LN880"><span class='Ref_To_Local'>tm</span></a><span class='Operator'>-&GT;</span>tm_mday <span class='Operator'>&GT; </span><a href="dt_common.c.html#LN12"><span class='Ref_to_Global_Var'>day_tab</span></a><span class='Delimiter'>[</span><a href="../../../timezone/private.h.html#LN142"><span class='Ref_to_Macro'>isleap</span></a><span class='Parentheses'>(</span><a href="timestamp.c.html#LN880"><span class='Ref_To_Local'>tm</span></a><span class='Operator'>-&GT;</span>tm_year<span class='Parentheses'>)</span><span class='Delimiter'>][</span><a href="timestamp.c.html#LN880"><span class='Ref_To_Local'>tm</span></a><span class='Operator'>-&GT;</span>tm_mon <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>]</span><span class='Parentheses'>)</span> 
                <a href="timestamp.c.html#LN880"><span class='Ref_To_Local'>tm</span></a><span class='Operator'>-&GT;</span>tm_mday <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="dt_common.c.html#LN12"><span class='Ref_to_Global_Var'>day_tab</span></a><span class='Delimiter'>[</span><a href="../../../timezone/private.h.html#LN142"><span class='Ref_to_Macro'>isleap</span></a><span class='Parentheses'>(</span><a href="timestamp.c.html#LN880"><span class='Ref_To_Local'>tm</span></a><span class='Operator'>-&GT;</span>tm_year<span class='Parentheses'>)</span><span class='Delimiter'>][</span><a href="timestamp.c.html#LN880"><span class='Ref_To_Local'>tm</span></a><span class='Operator'>-&GT;</span>tm_mon <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>]</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
 
            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="timestamp.c.html#LN40"><span class='Ref_to_Func'>tm2timestamp</span></a><span class='Parentheses'>(</span><a href="timestamp.c.html#LN880"><span class='Ref_To_Local'>tm</span></a><span class='Delimiter'>, </span><a href="timestamp.c.html#LN881"><span class='Ref_To_Local'>fsec</span></a><span class='Delimiter'>, </span><span class='Null_Value'>NULL</span><span class='Delimiter'>, </span><a href="timestamp.c.html#LN869"><span class='Ref_to_Parameter'>tin</span></a><span class='Parentheses'>) </span><span class='Operator'>!= </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
                <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if span-&GT;month!=0 &raquo; </span> 
 
 
        <span class='Operator'>*</span><a href="timestamp.c.html#LN869"><span class='Ref_to_Parameter'>tin</span></a> <span class='Operator'>+= </span><a href="timestamp.c.html#LN869"><span class='Ref_to_Parameter'>span</span></a><span class='Operator'>-&GT;</span><a href="../include/pgtypes_interval.h.html#LN27"><span class='Ref_to_Member'>time</span></a><span class='Delimiter'>; 
</span>        <span class='Operator'>*</span><a href="timestamp.c.html#LN869"><span class='Ref_to_Parameter'>tout</span></a> <span class='Operator'>= *</span><a href="timestamp.c.html#LN869"><span class='Ref_to_Parameter'>tin</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end else &raquo; </span> 
    <span class='Control'>return</span> <span class='Number'>0</span><span class='Delimiter'>; 
</span> 
<span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end PGTYPEStimestamp_add_interval &raquo; </span> 
 
 
<span class='Comment_Multi_Line'>/* 
* subtract an interval from a time stamp 
* 
*   *tout = tin - span 
* 
*    returns 0 if successful 
*    returns -1 if it fails 
* 
*/ 
</span> 
<span class='Keyword'>int 
</span><a name="LN928"></a><span class='Declare_Function'>PGTYPEStimestamp_sub_interval</span><span class='Parentheses'>(</span><a href="../include/pgtypes_timestamp.h.html#LN8"><span class='Ref_to_Typedef'>timestamp</span></a> <span class='Operator'>* </span><span class='Declare_Parameter'>tin</span><span class='Delimiter'>, </span><a href="../include/pgtypes_interval.h.html#LN25"><span class='Ref_to_Typedef'>interval</span></a> <span class='Operator'>* </span><span class='Declare_Parameter'>span</span><span class='Delimiter'>, </span><a href="../include/pgtypes_timestamp.h.html#LN8"><span class='Ref_to_Typedef'>timestamp</span></a> <span class='Operator'>* </span><span class='Declare_Parameter'>tout</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN930"></a>    <a href="../include/pgtypes_interval.h.html#LN25"><span class='Ref_to_Typedef'>interval</span></a>    <span class='Declare_Local'>tspan</span><span class='Delimiter'>; 
</span> 
    <a href="timestamp.c.html#LN930"><span class='Ref_To_Local'>tspan</span></a><span class='Operator'>.</span><a href="../include/pgtypes_interval.h.html#LN28"><span class='Ref_to_Member'>month</span></a> <span class='Operator'>= -</span><a href="timestamp.c.html#LN928"><span class='Ref_to_Parameter'>span</span></a><span class='Operator'>-&GT;</span><a href="../include/pgtypes_interval.h.html#LN28"><span class='Ref_to_Member'>month</span></a><span class='Delimiter'>; 
</span>    <a href="timestamp.c.html#LN930"><span class='Ref_To_Local'>tspan</span></a><span class='Operator'>.</span><a href="../include/pgtypes_interval.h.html#LN27"><span class='Ref_to_Member'>time</span></a> <span class='Operator'>= -</span><a href="timestamp.c.html#LN928"><span class='Ref_to_Parameter'>span</span></a><span class='Operator'>-&GT;</span><a href="../include/pgtypes_interval.h.html#LN27"><span class='Ref_to_Member'>time</span></a><span class='Delimiter'>; 
</span> 
 
    <span class='Control'>return</span> <a href="../include/pgtypes_timestamp.h.html#LN22"><span class='Ref_to_Proto'>PGTYPEStimestamp_add_interval</span></a><span class='Parentheses'>(</span><a href="timestamp.c.html#LN928"><span class='Ref_to_Parameter'>tin</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="timestamp.c.html#LN930"><span class='Ref_To_Local'>tspan</span></a><span class='Delimiter'>, </span><a href="timestamp.c.html#LN928"><span class='Ref_to_Parameter'>tout</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span></pre>
<table bgcolor='#c0c0c0' width='100%'><tr><td><a href='../../../../Contents.html'>Contents</a></td></tr>
</table><hr><p class='blurb' align='center'><a href='http://www.sourceinsight.com'>HTML Created by Source Insight Version 4.00.0084 Built on 2017-02-26</a></p>
</body></html>