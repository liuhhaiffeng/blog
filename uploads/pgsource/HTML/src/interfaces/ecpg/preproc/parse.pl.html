<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta name="generator" content="Source Insight Version 4.00.0084 Built on 2017-02-26">
<meta charset='UTF-8' />
<style type='text/css'><!--
TD {background-color: #C0C0C0; font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 70%; }
.blurb {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 70%; }
.filename {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 120%; font-weight: bold; }
.dirname {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 100%; font-weight: bold; margin-top: 2.5em;}
--></style>
<title>src\interfaces\ecpg\preproc\parse.pl</title>
<LINK REL=StyleSheet HREF="../../../../Perl_Source_File.css" TYPE='text/css' MEDIA=screen>
</head>
<body bgcolor=#ffffff>
<table bgcolor='#c0c0c0' width='100%'>
<tr><td><p class='filename'><b>src\interfaces\ecpg\preproc\parse.pl</b></p></td>
<td align='right'>
Wed Jun 14 08:26:09 2017
</td></tr>
<tr><td><a href='../../../../Contents.html'>Contents</a></td></tr>
</table>
<pre>
<span class='Operator'>#!/usr/</span>bin<span class='Operator'>/</span>perl 
<span class='Comment_Single_Line'># src/interfaces/ecpg/preproc/parse.pl 
# parser generater for ecpg version 2 
# call with backend parser as stdin 
# 
# Copyright (c) 2007-2017, PostgreSQL Global Development Group 
# 
# Written by Mike Aubury &LT;mike.aubury@aubit.com&GT; 
#            Michael Meskes &LT;meskes@postgresql.org&GT; 
#            Andy Colson &LT;andy@squeakycode.net&GT; 
# 
# Placed under the same license as PostgreSQL. 
# 
</span> 
<span class='Control'>use</span> strict<span class='Delimiter'>; 
</span><span class='Control'>use</span> warnings<span class='Delimiter'>; 
</span><span class='Keyword'>no </span>warnings <span class='String'>'uninitialized'</span><span class='Delimiter'>; 
</span> 
<span class='Keyword'>my </span>$path <span class='Operator'>= </span><span class='Keyword'>shift </span>@ARGV<span class='Delimiter'>; 
</span>$path <span class='Operator'>= </span><span class='String'>"."</span> <span class='Control'>unless</span> $path<span class='Delimiter'>; 
</span> 
<span class='Keyword'>my </span>$copymode              <span class='Operator'>= </span>0<span class='Delimiter'>; 
</span><span class='Keyword'>my </span>$brace_indent          <span class='Operator'>= </span>0<span class='Delimiter'>; 
</span><span class='Keyword'>my </span>$yaccmode              <span class='Operator'>= </span>0<span class='Delimiter'>; 
</span><span class='Keyword'>my </span>$header_included       <span class='Operator'>= </span>0<span class='Delimiter'>; 
</span><span class='Keyword'>my </span>$feature_not_supported <span class='Operator'>= </span>0<span class='Delimiter'>; 
</span><span class='Keyword'>my </span>$tokenmode             <span class='Operator'>= </span>0<span class='Delimiter'>; 
</span> 
<span class='Keyword'>my </span><span class='Parentheses'>(</span>%buff<span class='Delimiter'>, </span>$infield<span class='Delimiter'>, </span>$comment<span class='Delimiter'>, </span>%tokens<span class='Delimiter'>, </span>%addons<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><span class='Keyword'>my </span><span class='Parentheses'>(</span>$stmt_mode<span class='Delimiter'>, </span>@fields<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><span class='Keyword'>my </span><span class='Parentheses'>(</span>$line<span class='Delimiter'>,</span>      $non_term_id<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
 
<span class='Comment_Single_Line'># some token have to be replaced by other symbols 
# either in the rule 
</span><span class='Keyword'>my </span>%replace_token <span class='Operator'>= </span><span class='Parentheses'>( 
</span>    <span class='String'>'BCONST'</span> <span class='Operator'>=&GT; </span><span class='String'>'ecpg_bconst'</span><span class='Delimiter'>, 
</span>    <span class='String'>'FCONST'</span> <span class='Operator'>=&GT; </span><span class='String'>'ecpg_fconst'</span><span class='Delimiter'>, 
</span>    <span class='String'>'Sconst'</span> <span class='Operator'>=&GT; </span><span class='String'>'ecpg_sconst'</span><span class='Delimiter'>, 
</span>    <span class='String'>'IDENT'</span>  <span class='Operator'>=&GT; </span><span class='String'>'ecpg_ident'</span><span class='Delimiter'>, 
</span>    <span class='String'>'PARAM'</span>  <span class='Operator'>=&GT; </span><span class='String'>'ecpg_param'</span><span class='Delimiter'>,</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
<span class='Comment_Single_Line'># or in the block 
</span><span class='Keyword'>my </span>%replace_string <span class='Operator'>= </span><span class='Parentheses'>( 
</span>    <span class='String'>'NOT_LA'</span>         <span class='Operator'>=&GT; </span><span class='String'>'not'</span><span class='Delimiter'>, 
</span>    <span class='String'>'NULLS_LA'</span>       <span class='Operator'>=&GT; </span><span class='String'>'nulls'</span><span class='Delimiter'>, 
</span>    <span class='String'>'WITH_LA'</span>        <span class='Operator'>=&GT; </span><span class='String'>'with'</span><span class='Delimiter'>, 
</span>    <span class='String'>'TYPECAST'</span>       <span class='Operator'>=&GT; </span><span class='String'>'::'</span><span class='Delimiter'>, 
</span>    <span class='String'>'DOT_DOT'</span>        <span class='Operator'>=&GT; </span><span class='String'>'..'</span><span class='Delimiter'>, 
</span>    <span class='String'>'COLON_EQUALS'</span>   <span class='Operator'>=&GT; </span><span class='String'>':='</span><span class='Delimiter'>, 
</span>    <span class='String'>'EQUALS_GREATER'</span> <span class='Operator'>=&GT; </span><span class='String'>'=&GT;'</span><span class='Delimiter'>, 
</span>    <span class='String'>'LESS_EQUALS'</span>    <span class='Operator'>=&GT; </span><span class='String'>'&LT;='</span><span class='Delimiter'>, 
</span>    <span class='String'>'GREATER_EQUALS'</span> <span class='Operator'>=&GT; </span><span class='String'>'&GT;='</span><span class='Delimiter'>, 
</span>    <span class='String'>'NOT_EQUALS'</span>     <span class='Operator'>=&GT; </span><span class='String'>'&LT;&GT;'</span><span class='Delimiter'>,</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
<span class='Comment_Single_Line'># specific replace_types for specific non-terminals - never include the ':' 
# ECPG-only replace_types are defined in ecpg-replace_types 
</span><span class='Keyword'>my </span>%replace_types <span class='Operator'>= </span><span class='Parentheses'>( 
</span>    <span class='String'>'PrepareStmt'</span>      <span class='Operator'>=&GT; </span><span class='String'>'&LT;prep&GT;'</span><span class='Delimiter'>, 
</span>    <span class='String'>'opt_array_bounds'</span> <span class='Operator'>=&GT; </span><span class='String'>'&LT;index&GT;'</span><span class='Delimiter'>, 
</span> 
    <span class='Comment_Single_Line'># "ignore" means: do not create type and rules for this non-term-id 
</span>    <span class='String'>'stmtblock'</span>          <span class='Operator'>=&GT; </span><span class='String'>'ignore'</span><span class='Delimiter'>, 
</span>    <span class='String'>'stmtmulti'</span>          <span class='Operator'>=&GT; </span><span class='String'>'ignore'</span><span class='Delimiter'>, 
</span>    <span class='String'>'CreateAsStmt'</span>       <span class='Operator'>=&GT; </span><span class='String'>'ignore'</span><span class='Delimiter'>, 
</span>    <span class='String'>'DeallocateStmt'</span>     <span class='Operator'>=&GT; </span><span class='String'>'ignore'</span><span class='Delimiter'>, 
</span>    <span class='String'>'ColId'</span>              <span class='Operator'>=&GT; </span><span class='String'>'ignore'</span><span class='Delimiter'>, 
</span>    <span class='String'>'type_function_name'</span> <span class='Operator'>=&GT; </span><span class='String'>'ignore'</span><span class='Delimiter'>, 
</span>    <span class='String'>'ColLabel'</span>           <span class='Operator'>=&GT; </span><span class='String'>'ignore'</span><span class='Delimiter'>, 
</span>    <span class='String'>'Sconst'</span>             <span class='Operator'>=&GT; </span><span class='String'>'ignore'</span><span class='Delimiter'>,</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
<span class='Comment_Single_Line'># these replace_line commands excise certain keywords from the core keyword 
# lists.  Be sure to account for these in ColLabel and related productions. 
</span><span class='Keyword'>my </span>%replace_line <span class='Operator'>= </span><span class='Parentheses'>( 
</span>    <span class='String'>'unreserved_keywordCONNECTION'</span> <span class='Operator'>=&GT; </span><span class='String'>'ignore'</span><span class='Delimiter'>, 
</span>    <span class='String'>'unreserved_keywordCURRENT_P'</span>  <span class='Operator'>=&GT; </span><span class='String'>'ignore'</span><span class='Delimiter'>, 
</span>    <span class='String'>'unreserved_keywordDAY_P'</span>      <span class='Operator'>=&GT; </span><span class='String'>'ignore'</span><span class='Delimiter'>, 
</span>    <span class='String'>'unreserved_keywordHOUR_P'</span>     <span class='Operator'>=&GT; </span><span class='String'>'ignore'</span><span class='Delimiter'>, 
</span>    <span class='String'>'unreserved_keywordINPUT_P'</span>    <span class='Operator'>=&GT; </span><span class='String'>'ignore'</span><span class='Delimiter'>, 
</span>    <span class='String'>'unreserved_keywordMINUTE_P'</span>   <span class='Operator'>=&GT; </span><span class='String'>'ignore'</span><span class='Delimiter'>, 
</span>    <span class='String'>'unreserved_keywordMONTH_P'</span>    <span class='Operator'>=&GT; </span><span class='String'>'ignore'</span><span class='Delimiter'>, 
</span>    <span class='String'>'unreserved_keywordSECOND_P'</span>   <span class='Operator'>=&GT; </span><span class='String'>'ignore'</span><span class='Delimiter'>, 
</span>    <span class='String'>'unreserved_keywordYEAR_P'</span>     <span class='Operator'>=&GT; </span><span class='String'>'ignore'</span><span class='Delimiter'>, 
</span>    <span class='String'>'col_name_keywordCHAR_P'</span>       <span class='Operator'>=&GT; </span><span class='String'>'ignore'</span><span class='Delimiter'>, 
</span>    <span class='String'>'col_name_keywordINT_P'</span>        <span class='Operator'>=&GT; </span><span class='String'>'ignore'</span><span class='Delimiter'>, 
</span>    <span class='String'>'col_name_keywordVALUES'</span>       <span class='Operator'>=&GT; </span><span class='String'>'ignore'</span><span class='Delimiter'>, 
</span>    <span class='String'>'reserved_keywordTO'</span>           <span class='Operator'>=&GT; </span><span class='String'>'ignore'</span><span class='Delimiter'>, 
</span>    <span class='String'>'reserved_keywordUNION'</span>        <span class='Operator'>=&GT; </span><span class='String'>'ignore'</span><span class='Delimiter'>, 
</span> 
    <span class='Comment_Single_Line'># some other production rules have to be ignored or replaced 
</span>    <span class='String'>'fetch_argsFORWARDopt_from_incursor_name'</span>      <span class='Operator'>=&GT; </span><span class='String'>'ignore'</span><span class='Delimiter'>, 
</span>    <span class='String'>'fetch_argsBACKWARDopt_from_incursor_name'</span>     <span class='Operator'>=&GT; </span><span class='String'>'ignore'</span><span class='Delimiter'>, 
</span>    <span class='String'>"opt_array_boundsopt_array_bounds'['Iconst']'"</span> <span class='Operator'>=&GT; </span><span class='String'>'ignore'</span><span class='Delimiter'>, 
</span>    <span class='String'>'VariableShowStmtSHOWvar_name'</span> <span class='Operator'>=&GT; </span><span class='String'>'SHOW var_name ecpg_into'</span><span class='Delimiter'>, 
</span>    <span class='String'>'VariableShowStmtSHOWTIMEZONE'</span> <span class='Operator'>=&GT; </span><span class='String'>'SHOW TIME ZONE ecpg_into'</span><span class='Delimiter'>, 
</span>    <span class='String'>'VariableShowStmtSHOWTRANSACTIONISOLATIONLEVEL'</span> <span class='Operator'>=&GT; 
</span>      <span class='String'>'SHOW TRANSACTION ISOLATION LEVEL ecpg_into'</span><span class='Delimiter'>, 
</span>    <span class='String'>'VariableShowStmtSHOWSESSIONAUTHORIZATION'</span> <span class='Operator'>=&GT; 
</span>      <span class='String'>'SHOW SESSION AUTHORIZATION ecpg_into'</span><span class='Delimiter'>, 
</span>    <span class='String'>'returning_clauseRETURNINGtarget_list'</span> <span class='Operator'>=&GT; 
</span>      <span class='String'>'RETURNING target_list ecpg_into'</span><span class='Delimiter'>, 
</span>    <span class='String'>'ExecuteStmtEXECUTEnameexecute_param_clause'</span> <span class='Operator'>=&GT; 
</span>      <span class='String'>'EXECUTE prepared_name execute_param_clause execute_rest'</span><span class='Delimiter'>, 
</span><span class='String'>'ExecuteStmtCREATEOptTempTABLEcreate_as_targetASEXECUTEnameexecute_param_clause'</span> 
      <span class='Operator'>=&GT; </span><span class='String'>'CREATE OptTemp TABLE create_as_target AS EXECUTE prepared_name execute_param_clause'</span><span class='Delimiter'>, 
</span>    <span class='String'>'PrepareStmtPREPAREnameprep_type_clauseASPreparableStmt'</span> <span class='Operator'>=&GT; 
</span>      <span class='String'>'PREPARE prepared_name prep_type_clause AS PreparableStmt'</span><span class='Delimiter'>, 
</span>    <span class='String'>'var_nameColId'</span> <span class='Operator'>=&GT; </span><span class='String'>'ECPGColId'</span><span class='Delimiter'>,</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
<a href="parse.pl.html#LN629"><span class='Ref_to_Func'>preload_addons</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span> 
<a href="parse.pl.html#LN124"><span class='Ref_to_Func'>main</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span> 
<a href="parse.pl.html#LN476"><span class='Ref_to_Func'>dump_buffer</span></a><span class='Parentheses'>(</span><span class='String'>'header'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a href="parse.pl.html#LN476"><span class='Ref_to_Func'>dump_buffer</span></a><span class='Parentheses'>(</span><span class='String'>'tokens'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a href="parse.pl.html#LN476"><span class='Ref_to_Func'>dump_buffer</span></a><span class='Parentheses'>(</span><span class='String'>'types'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a href="parse.pl.html#LN476"><span class='Ref_to_Func'>dump_buffer</span></a><span class='Parentheses'>(</span><span class='String'>'ecpgtype'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a href="parse.pl.html#LN476"><span class='Ref_to_Func'>dump_buffer</span></a><span class='Parentheses'>(</span><span class='String'>'orig_tokens'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><span class='Keyword'>print </span><span class='String'>'%%'</span><span class='Delimiter'>,</span>                <span class='String'>"\n"</span><span class='Delimiter'>; 
</span><span class='Keyword'>print </span><span class='String'>'prog: statements;'</span><span class='Delimiter'>, </span><span class='String'>"\n"</span><span class='Delimiter'>; 
</span><a href="parse.pl.html#LN476"><span class='Ref_to_Func'>dump_buffer</span></a><span class='Parentheses'>(</span><span class='String'>'rules'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a href="parse.pl.html#LN422"><span class='Ref_to_Func'>include_file</span></a><span class='Parentheses'>(</span><span class='String'>'trailer'</span><span class='Delimiter'>, </span><span class='String'>'ecpg.trailer'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a href="parse.pl.html#LN476"><span class='Ref_to_Func'>dump_buffer</span></a><span class='Parentheses'>(</span><span class='String'>'trailer'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
<a name="LN124"></a><span class='Control'>sub</span> <span class='Declare_Function'>main</span> 
<span class='Delimiter'>{ 
</span>  line<span class='Operator'>: </span><span class='Control'>while</span> <span class='Parentheses'>(</span><span class='Operator'>&LT;&GT;</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>/ERRCODE_FEATURE_NOT_SUPPORTED/</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            $feature_not_supported <span class='Operator'>= </span>1<span class='Delimiter'>; 
</span>            <span class='Control'>next</span> line<span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span> 
        <span class='Keyword'>chomp</span><span class='Delimiter'>; 
</span> 
  <span class='Comment_Single_Line'># comment out the line below to make the result file match (blank line wise) 
</span>  <span class='Comment_Single_Line'># the prior version. 
</span>  <span class='Comment_Single_Line'>#next if ($_ eq ''); 
</span> 
   <span class='Comment_Single_Line'># Dump the action for a rule - 
</span>   <span class='Comment_Single_Line'># stmt_mode indicates if we are processing the 'stmt:' 
</span>   <span class='Comment_Single_Line'># rule (mode==0 means normal,  mode==1 means stmt:) 
</span>   <span class='Comment_Single_Line'># flds are the fields to use. These may start with a '$' - in 
</span>   <span class='Comment_Single_Line'># which case they are the result of a previous non-terminal 
</span>   <span class='Comment_Single_Line'># 
</span>   <span class='Comment_Single_Line'># if they dont start with a '$' then they are token name 
</span>   <span class='Comment_Single_Line'># 
</span>   <span class='Comment_Single_Line'># len is the number of fields in flds... 
</span>   <span class='Comment_Single_Line'># leadin is the padding to apply at the beginning (just use for formatting) 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>/^%%/</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            $tokenmode <span class='Operator'>= </span>2<span class='Delimiter'>; 
</span>            $copymode  <span class='Operator'>= </span>1<span class='Delimiter'>; 
</span>            $yaccmode<span class='Operator'>++</span><span class='Delimiter'>; 
</span>            $infield <span class='Operator'>= </span>0<span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span> 
        <span class='Keyword'>my </span>$prec <span class='Operator'>= </span>0<span class='Delimiter'>; 
</span> 
        <span class='Comment_Single_Line'># Make sure any braces are split 
</span>        <span class='Operator'>s</span><span class='String'>/{/ { /</span>g<span class='Delimiter'>; 
</span>        <span class='Operator'>s</span><span class='String'>/}/ } /</span>g<span class='Delimiter'>; 
</span> 
        <span class='Comment_Single_Line'># Any comments are split 
</span>        <span class='Operator'>s</span><span class='String'>|\/\*| /* |</span>g<span class='Delimiter'>; 
</span>        <span class='Operator'>s</span><span class='String'>|\*\/| */ |</span>g<span class='Delimiter'>; 
</span> 
        <span class='Comment_Single_Line'># Now split the line into individual fields 
</span>        <span class='Keyword'>my </span>@arr <span class='Operator'>= </span><span class='Keyword'>split</span><span class='Parentheses'>(</span><span class='String'>' '</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span>$arr<span class='Delimiter'>[</span>0<span class='Delimiter'>] </span><span class='Operator'>eq </span><span class='String'>'%token'</span> <span class='Operator'>&& </span>$tokenmode <span class='Operator'>== </span>0<span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            $tokenmode <span class='Operator'>= </span>1<span class='Delimiter'>; 
</span>            <a href="parse.pl.html#LN422"><span class='Ref_to_Func'>include_file</span></a><span class='Parentheses'>(</span><span class='String'>'tokens'</span><span class='Delimiter'>, </span><span class='String'>'ecpg.tokens'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>elsif</span> <span class='Parentheses'>(</span>$arr<span class='Delimiter'>[</span>0<span class='Delimiter'>] </span><span class='Operator'>eq </span><span class='String'>'%type'</span> <span class='Operator'>&& </span>$header_included <span class='Operator'>== </span>0<span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <a href="parse.pl.html#LN422"><span class='Ref_to_Func'>include_file</span></a><span class='Parentheses'>(</span><span class='String'>'header'</span><span class='Delimiter'>,</span>   <span class='String'>'ecpg.header'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="parse.pl.html#LN422"><span class='Ref_to_Func'>include_file</span></a><span class='Parentheses'>(</span><span class='String'>'ecpgtype'</span><span class='Delimiter'>, </span><span class='String'>'ecpg.type'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            $header_included <span class='Operator'>= </span>1<span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span>$tokenmode <span class='Operator'>== </span>1<span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Keyword'>my </span>$str   <span class='Operator'>= </span><span class='String'>''</span><span class='Delimiter'>; 
</span>            <span class='Keyword'>my </span>$prior <span class='Operator'>= </span><span class='String'>''</span><span class='Delimiter'>; 
</span>            <span class='Control'>for</span> <span class='Keyword'>my </span>$a <span class='Parentheses'>(</span>@arr<span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span>$a <span class='Operator'>eq </span><span class='String'>'/*'</span><span class='Parentheses'>) 
</span>                <span class='Delimiter'>{ 
</span>                    $comment<span class='Operator'>++</span><span class='Delimiter'>; 
</span>                    <span class='Control'>next</span><span class='Delimiter'>; 
</span>                <span class='Delimiter'>} 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span>$a <span class='Operator'>eq </span><span class='String'>'*/'</span><span class='Parentheses'>) 
</span>                <span class='Delimiter'>{ 
</span>                    $comment<span class='Operator'>--</span><span class='Delimiter'>; 
</span>                    <span class='Control'>next</span><span class='Delimiter'>; 
</span>                <span class='Delimiter'>} 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span>$comment<span class='Parentheses'>) 
</span>                <span class='Delimiter'>{ 
</span>                    <span class='Control'>next</span><span class='Delimiter'>; 
</span>                <span class='Delimiter'>} 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Keyword'>substr</span><span class='Parentheses'>(</span>$a<span class='Delimiter'>, </span>0<span class='Delimiter'>, </span>1<span class='Parentheses'>) </span><span class='Operator'>eq </span><span class='String'>'&LT;'</span><span class='Parentheses'>)</span> 
                <span class='Delimiter'>{ 
</span>                    <span class='Control'>next</span><span class='Delimiter'>; 
</span> 
                    <span class='Comment_Single_Line'># its a type 
</span>                <span class='Delimiter'>} 
</span>                $tokens<span class='Delimiter'>{</span>$a<span class='Delimiter'>} </span><span class='Operator'>= </span>1<span class='Delimiter'>; 
</span> 
                $str <span class='Operator'>= </span>$str <span class='Operator'>. </span><span class='String'>' '</span> <span class='Operator'>. </span>$a<span class='Delimiter'>; 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span>$a <span class='Operator'>eq </span><span class='String'>'IDENT'</span> <span class='Operator'>&& </span>$prior <span class='Operator'>eq </span><span class='String'>'%nonassoc'</span><span class='Parentheses'>) 
</span>                <span class='Delimiter'>{ 
</span> 
                    <span class='Comment_Single_Line'># add two more tokens to the list 
</span>                    $str <span class='Operator'>= </span>$str <span class='Operator'>. </span><span class='String'>"\n%nonassoc CSTRING\n%nonassoc UIDENT"</span><span class='Delimiter'>; 
</span>                <span class='Delimiter'>} 
</span>                $prior <span class='Operator'>= </span>$a<span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>            <a href="parse.pl.html#LN471"><span class='Ref_to_Func'>add_to_buffer</span></a><span class='Parentheses'>(</span><span class='String'>'orig_tokens'</span><span class='Delimiter'>, </span>$str<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>next</span> line<span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span> 
       <span class='Comment_Single_Line'># Dont worry about anything if we're not in the right section of gram.y 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span>$yaccmode <span class='Operator'>!= </span>1<span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Control'>next</span> line<span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span> 
 
        <span class='Comment_Single_Line'># Go through each field in turn 
</span>        <span class='Control'>for</span> <span class='Parentheses'>(</span> 
            <span class='Keyword'>my </span>$fieldIndexer <span class='Operator'>= </span>0<span class='Delimiter'>; 
</span>            $fieldIndexer <span class='Operator'>&LT; </span><span class='Keyword'>scalar</span><span class='Parentheses'>(</span>@arr<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            $fieldIndexer<span class='Operator'>++</span><span class='Parentheses'>)</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span>$arr<span class='Delimiter'>[</span>$fieldIndexer<span class='Delimiter'>] </span><span class='Operator'>eq </span><span class='String'>'*/'</span> <span class='Operator'>&& </span>$comment<span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                $comment <span class='Operator'>= </span>0<span class='Delimiter'>; 
</span>                <span class='Control'>next</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>            <span class='Control'>elsif</span> <span class='Parentheses'>(</span>$comment<span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <span class='Control'>next</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>            <span class='Control'>elsif</span> <span class='Parentheses'>(</span>$arr<span class='Delimiter'>[</span>$fieldIndexer<span class='Delimiter'>] </span><span class='Operator'>eq </span><span class='String'>'/*'</span><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span> 
                <span class='Comment_Single_Line'># start of a multiline comment 
</span>                $comment <span class='Operator'>= </span>1<span class='Delimiter'>; 
</span>                <span class='Control'>next</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>            <span class='Control'>elsif</span> <span class='Parentheses'>(</span>$arr<span class='Delimiter'>[</span>$fieldIndexer<span class='Delimiter'>] </span><span class='Operator'>eq </span><span class='String'>'//'</span><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <span class='Control'>next</span> line<span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>            <span class='Control'>elsif</span> <span class='Parentheses'>(</span>$arr<span class='Delimiter'>[</span>$fieldIndexer<span class='Delimiter'>] </span><span class='Operator'>eq </span><span class='String'>'}'</span><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                $brace_indent<span class='Operator'>--</span><span class='Delimiter'>; 
</span>                <span class='Control'>next</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>            <span class='Control'>elsif</span> <span class='Parentheses'>(</span>$arr<span class='Delimiter'>[</span>$fieldIndexer<span class='Delimiter'>] </span><span class='Operator'>eq </span><span class='String'>'{'</span><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                $brace_indent<span class='Operator'>++</span><span class='Delimiter'>; 
</span>                <span class='Control'>next</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span> 
            <span class='Control'>if</span> <span class='Parentheses'>(</span>$brace_indent <span class='Operator'>&GT; </span>0<span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <span class='Control'>next</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span>$arr<span class='Delimiter'>[</span>$fieldIndexer<span class='Delimiter'>] </span><span class='Operator'>eq </span><span class='String'>';'</span><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span>$copymode<span class='Parentheses'>) 
</span>                <span class='Delimiter'>{ 
</span>                    <span class='Control'>if</span> <span class='Parentheses'>(</span>$infield<span class='Parentheses'>) 
</span>                    <span class='Delimiter'>{ 
</span>                        <a href="parse.pl.html#LN587"><span class='Ref_to_Func'>dump_line</span></a><span class='Parentheses'>(</span>$stmt_mode<span class='Delimiter'>, </span><span class='Operator'>\</span>@fields<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                    <span class='Delimiter'>} 
</span>                    <a href="parse.pl.html#LN471"><span class='Ref_to_Func'>add_to_buffer</span></a><span class='Parentheses'>(</span><span class='String'>'rules'</span><span class='Delimiter'>, </span><span class='String'>";\n\n"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <span class='Delimiter'>} 
</span>                <span class='Control'>else</span> 
                <span class='Delimiter'>{ 
</span>                    $copymode <span class='Operator'>= </span>1<span class='Delimiter'>; 
</span>                <span class='Delimiter'>} 
</span>                @fields  <span class='Operator'>= </span><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span>                $infield <span class='Operator'>= </span>0<span class='Delimiter'>; 
</span>                $line    <span class='Operator'>= </span><span class='String'>''</span><span class='Delimiter'>; 
</span>                <span class='Control'>next</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span> 
            <span class='Control'>if</span> <span class='Parentheses'>(</span>$arr<span class='Delimiter'>[</span>$fieldIndexer<span class='Delimiter'>] </span><span class='Operator'>eq </span><span class='String'>'|'</span><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span>$copymode<span class='Parentheses'>) 
</span>                <span class='Delimiter'>{ 
</span>                    <span class='Control'>if</span> <span class='Parentheses'>(</span>$infield<span class='Parentheses'>) 
</span>                    <span class='Delimiter'>{ 
</span>                        $infield <span class='Operator'>= </span>$infield <span class='Operator'>+ </span><a href="parse.pl.html#LN587"><span class='Ref_to_Func'>dump_line</span></a><span class='Parentheses'>(</span>$stmt_mode<span class='Delimiter'>, </span><span class='Operator'>\</span>@fields<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                    <span class='Delimiter'>} 
</span>                    <span class='Control'>if</span> <span class='Parentheses'>(</span>$infield <span class='Operator'>&GT; </span>1<span class='Parentheses'>) 
</span>                    <span class='Delimiter'>{ 
</span>                        $line <span class='Operator'>= </span><span class='String'>'| '</span><span class='Delimiter'>; 
</span>                    <span class='Delimiter'>} 
</span>                <span class='Delimiter'>} 
</span>                @fields <span class='Operator'>= </span><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span>                <span class='Control'>next</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span> 
            <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Keyword'>exists </span>$replace_token<span class='Delimiter'>{ </span>$arr<span class='Delimiter'>[</span>$fieldIndexer<span class='Delimiter'>] }</span><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                $arr<span class='Delimiter'>[</span>$fieldIndexer<span class='Delimiter'>] </span><span class='Operator'>= </span>$replace_token<span class='Delimiter'>{ </span>$arr<span class='Delimiter'>[</span>$fieldIndexer<span class='Delimiter'>] }; 
</span>            <span class='Delimiter'>} 
</span> 
            <span class='Comment_Single_Line'># Are we looking at a declaration of a non-terminal ? 
</span>            <span class='Control'>if</span> <span class='Parentheses'>((</span>$arr<span class='Delimiter'>[</span>$fieldIndexer<span class='Delimiter'>] </span><span class='Operator'>=~ /[A-Za-z0-9]+:/</span><span class='Parentheses'>) 
</span>                <span class='Operator'>|| </span>$arr<span class='Delimiter'>[ </span>$fieldIndexer <span class='Operator'>+ </span>1 <span class='Delimiter'>] </span><span class='Operator'>eq </span><span class='String'>':'</span><span class='Parentheses'>)</span> 
            <span class='Delimiter'>{ 
</span>                $non_term_id <span class='Operator'>= </span>$arr<span class='Delimiter'>[</span>$fieldIndexer<span class='Delimiter'>]; 
</span>                $non_term_id <span class='Operator'>=~ </span><span class='Keyword'>tr</span><span class='String'>/://</span>d<span class='Delimiter'>; 
</span> 
                <span class='Control'>if</span> <span class='Parentheses'>(</span>not <span class='Keyword'>defined </span>$replace_types<span class='Delimiter'>{</span>$non_term_id<span class='Delimiter'>}</span><span class='Parentheses'>) 
</span>                <span class='Delimiter'>{ 
</span>                    $replace_types<span class='Delimiter'>{</span>$non_term_id<span class='Delimiter'>} </span><span class='Operator'>= </span><span class='String'>'&LT;str&GT;'</span><span class='Delimiter'>; 
</span>                    $copymode <span class='Operator'>= </span>1<span class='Delimiter'>; 
</span>                <span class='Delimiter'>} 
</span>                <span class='Control'>elsif</span> <span class='Parentheses'>(</span>$replace_types<span class='Delimiter'>{</span>$non_term_id<span class='Delimiter'>} </span><span class='Operator'>eq </span><span class='String'>'ignore'</span><span class='Parentheses'>) 
</span>                <span class='Delimiter'>{ 
</span>                    $copymode <span class='Operator'>= </span>0<span class='Delimiter'>; 
</span>                    $line     <span class='Operator'>= </span><span class='String'>''</span><span class='Delimiter'>; 
</span>                    <span class='Control'>next</span> line<span class='Delimiter'>; 
</span>                <span class='Delimiter'>} 
</span>                $line <span class='Operator'>= </span>$line <span class='Operator'>. </span><span class='String'>' '</span> <span class='Operator'>. </span>$arr<span class='Delimiter'>[</span>$fieldIndexer<span class='Delimiter'>]; 
</span> 
                <span class='Comment_Single_Line'># Do we have the : attached already ? 
</span>                <span class='Comment_Single_Line'># If yes, we'll have already printed the ':' 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><span class='Parentheses'>(</span>$arr<span class='Delimiter'>[</span>$fieldIndexer<span class='Delimiter'>] </span><span class='Operator'>=~ </span><span class='String'>'[A-Za-z0-9]+:'</span><span class='Parentheses'>))</span> 
                <span class='Delimiter'>{ 
</span> 
                    <span class='Comment_Single_Line'># Consume the ':' which is next... 
</span>                    $line <span class='Operator'>= </span>$line <span class='Operator'>. </span><span class='String'>':'</span><span class='Delimiter'>; 
</span>                    $fieldIndexer<span class='Operator'>++</span><span class='Delimiter'>; 
</span>                <span class='Delimiter'>} 
</span> 
                <span class='Comment_Single_Line'># Special mode? 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span>$non_term_id <span class='Operator'>eq </span><span class='String'>'stmt'</span><span class='Parentheses'>) 
</span>                <span class='Delimiter'>{ 
</span>                    $stmt_mode <span class='Operator'>= </span>1<span class='Delimiter'>; 
</span>                <span class='Delimiter'>} 
</span>                <span class='Control'>else</span> 
                <span class='Delimiter'>{ 
</span>                    $stmt_mode <span class='Operator'>= </span>0<span class='Delimiter'>; 
</span>                <span class='Delimiter'>} 
</span>                <span class='Keyword'>my </span>$tstr <span class='Operator'>= 
</span>                    <span class='String'>'%type '</span> 
                  <span class='Operator'>. </span>$replace_types<span class='Delimiter'>{</span>$non_term_id<span class='Delimiter'>} </span><span class='Operator'>. </span><span class='String'>' '</span> 
                  <span class='Operator'>. </span>$non_term_id<span class='Delimiter'>; 
</span>                <a href="parse.pl.html#LN471"><span class='Ref_to_Func'>add_to_buffer</span></a><span class='Parentheses'>(</span><span class='String'>'types'</span><span class='Delimiter'>, </span>$tstr<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
                <span class='Control'>if</span> <span class='Parentheses'>(</span>$copymode<span class='Parentheses'>) 
</span>                <span class='Delimiter'>{ 
</span>                    <a href="parse.pl.html#LN471"><span class='Ref_to_Func'>add_to_buffer</span></a><span class='Parentheses'>(</span><span class='String'>'rules'</span><span class='Delimiter'>, </span>$line<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <span class='Delimiter'>} 
</span>                $line    <span class='Operator'>= </span><span class='String'>''</span><span class='Delimiter'>; 
</span>                @fields  <span class='Operator'>= </span><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span>                $infield <span class='Operator'>= </span>1<span class='Delimiter'>; 
</span>                <span class='Control'>next</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>            <span class='Control'>elsif</span> <span class='Parentheses'>(</span>$copymode<span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                $line <span class='Operator'>= </span>$line <span class='Operator'>. </span><span class='String'>' '</span> <span class='Operator'>. </span>$arr<span class='Delimiter'>[</span>$fieldIndexer<span class='Delimiter'>]; 
</span>            <span class='Delimiter'>} 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span>$arr<span class='Delimiter'>[</span>$fieldIndexer<span class='Delimiter'>] </span><span class='Operator'>eq </span><span class='String'>'%prec'</span><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                $prec <span class='Operator'>= </span>1<span class='Delimiter'>; 
</span>                <span class='Control'>next</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span> 
            <span class='Control'>if</span> <span class='Parentheses'>(</span>   $copymode 
                <span class='Operator'>&& !</span>$prec 
                <span class='Operator'>&& !</span>$comment 
                <span class='Operator'>&& </span><span class='Keyword'>length</span><span class='Parentheses'>(</span>$arr<span class='Delimiter'>[</span>$fieldIndexer<span class='Delimiter'>]</span><span class='Parentheses'>) 
</span>                <span class='Operator'>&& </span>$infield<span class='Parentheses'>)</span> 
            <span class='Delimiter'>{ 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span>$arr<span class='Delimiter'>[</span>$fieldIndexer<span class='Delimiter'>] </span><span class='Operator'>ne </span><span class='String'>'Op'</span> 
                    <span class='Operator'>&& </span><span class='Parentheses'>(</span>   $tokens<span class='Delimiter'>{ </span>$arr<span class='Delimiter'>[</span>$fieldIndexer<span class='Delimiter'>] } </span><span class='Operator'>&GT; </span>0 
                        <span class='Operator'>|| </span>$arr<span class='Delimiter'>[</span>$fieldIndexer<span class='Delimiter'>] </span><span class='Operator'>=~ /'.+'/</span><span class='Parentheses'>) 
</span>                    <span class='Operator'>|| </span>$stmt_mode <span class='Operator'>== </span>1<span class='Parentheses'>)</span> 
                <span class='Delimiter'>{ 
</span>                    <span class='Keyword'>my </span>$S<span class='Delimiter'>; 
</span>                    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Keyword'>exists </span>$replace_string<span class='Delimiter'>{ </span>$arr<span class='Delimiter'>[</span>$fieldIndexer<span class='Delimiter'>] }</span><span class='Parentheses'>) 
</span>                    <span class='Delimiter'>{ 
</span>                        $S <span class='Operator'>= </span>$replace_string<span class='Delimiter'>{ </span>$arr<span class='Delimiter'>[</span>$fieldIndexer<span class='Delimiter'>] }; 
</span>                    <span class='Delimiter'>} 
</span>                    <span class='Control'>else</span> 
                    <span class='Delimiter'>{ 
</span>                        $S <span class='Operator'>= </span>$arr<span class='Delimiter'>[</span>$fieldIndexer<span class='Delimiter'>]; 
</span>                    <span class='Delimiter'>} 
</span>                    $S <span class='Operator'>=~ s</span><span class='String'>/_P//</span>g<span class='Delimiter'>; 
</span>                    $S <span class='Operator'>=~ </span><span class='Keyword'>tr</span><span class='String'>/'//</span>d<span class='Delimiter'>; 
</span>                    <span class='Control'>if</span> <span class='Parentheses'>(</span>$stmt_mode <span class='Operator'>== </span>1<span class='Parentheses'>) 
</span>                    <span class='Delimiter'>{ 
</span>                        <span class='Keyword'>push</span><span class='Parentheses'>(</span>@fields<span class='Delimiter'>, </span>$S<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                    <span class='Delimiter'>} 
</span>                    <span class='Control'>else</span> 
                    <span class='Delimiter'>{ 
</span>                        <span class='Keyword'>push</span><span class='Parentheses'>(</span>@fields<span class='Delimiter'>, </span><span class='Keyword'>lc</span><span class='Parentheses'>(</span>$S<span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>                    <span class='Delimiter'>} 
</span>                <span class='Delimiter'>} 
</span>                <span class='Control'>else</span> 
                <span class='Delimiter'>{ 
</span>                    <span class='Keyword'>push</span><span class='Parentheses'>(</span>@fields<span class='Delimiter'>, </span><span class='String'>'$'</span> <span class='Operator'>. </span><span class='Parentheses'>(</span><span class='Keyword'>scalar</span><span class='Parentheses'>(</span>@fields<span class='Parentheses'>) </span><span class='Operator'>+ </span>1<span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>                <span class='Delimiter'>} 
</span>            <span class='Delimiter'>} 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>} 
} 
</span> 
 
<span class='Comment_Single_Line'># append a file onto a buffer. 
# Arguments:  buffer_name, filename (without path) 
</span><a name="LN422"></a><span class='Control'>sub</span> <span class='Declare_Function'>include_file</span> 
<span class='Delimiter'>{ 
</span>    <span class='Keyword'>my </span><span class='Parentheses'>(</span>$buffer<span class='Delimiter'>, </span>$filename<span class='Parentheses'>) </span><span class='Operator'>= </span>@_<span class='Delimiter'>; 
</span>    <span class='Keyword'>my </span>$full <span class='Operator'>= </span><span class='String'>"$path/$filename"</span><span class='Delimiter'>; 
</span>    <span class='Keyword'>open</span><span class='Parentheses'>(</span><span class='Keyword'>my </span>$fh<span class='Delimiter'>, </span><span class='String'>'&LT;'</span><span class='Delimiter'>, </span>$full<span class='Parentheses'>) </span>or <span class='Control'>die</span><span class='Delimiter'>; 
</span>    <span class='Control'>while</span> <span class='Parentheses'>(</span><span class='Operator'>&LT;</span>$fh<span class='Operator'>&GT;</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Keyword'>chomp</span><span class='Delimiter'>; 
</span>        <a href="parse.pl.html#LN471"><span class='Ref_to_Func'>add_to_buffer</span></a><span class='Parentheses'>(</span>$buffer<span class='Delimiter'>, </span>$_<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Keyword'>close</span><span class='Parentheses'>(</span>$fh<span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<a name="LN435"></a><span class='Control'>sub</span> <span class='Declare_Function'>include_addon</span> 
<span class='Delimiter'>{ 
</span>    <span class='Keyword'>my </span><span class='Parentheses'>(</span>$buffer<span class='Delimiter'>, </span>$block<span class='Delimiter'>, </span>$fields<span class='Delimiter'>, </span>$stmt_mode<span class='Parentheses'>) </span><span class='Operator'>= </span>@_<span class='Delimiter'>; 
</span>    <span class='Keyword'>my </span>$rec <span class='Operator'>= </span>$addons<span class='Delimiter'>{</span>$block<span class='Delimiter'>}; 
</span>    <span class='Control'>return</span> 0 <span class='Control'>unless</span> $rec<span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span>$rec<span class='Operator'>-&GT;</span><span class='Delimiter'>{</span>type<span class='Delimiter'>} </span><span class='Operator'>eq </span><span class='String'>'rule'</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="parse.pl.html#LN484"><span class='Ref_to_Func'>dump_fields</span></a><span class='Parentheses'>(</span>$stmt_mode<span class='Delimiter'>, </span>$fields<span class='Delimiter'>, </span><span class='String'>' { '</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>elsif</span> <span class='Parentheses'>(</span>$rec<span class='Operator'>-&GT;</span><span class='Delimiter'>{</span>type<span class='Delimiter'>} </span><span class='Operator'>eq </span><span class='String'>'addon'</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="parse.pl.html#LN471"><span class='Ref_to_Func'>add_to_buffer</span></a><span class='Parentheses'>(</span><span class='String'>'rules'</span><span class='Delimiter'>, </span><span class='String'>' { '</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Single_Line'>#add_to_buffer( $stream, $_ ); 
</span>    <span class='Comment_Single_Line'>#We have an array to add to the buffer, we'll add it ourself instead of 
</span>    <span class='Comment_Single_Line'>#calling add_to_buffer, which does not know about arrays 
</span> 
    <span class='Keyword'>push</span><span class='Parentheses'>(</span>@<span class='Delimiter'>{ </span>$buff<span class='Delimiter'>{</span>$buffer<span class='Delimiter'>} }, </span>@<span class='Delimiter'>{ </span>$rec<span class='Operator'>-&GT;</span><span class='Delimiter'>{</span>lines<span class='Delimiter'>} }</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span>$rec<span class='Operator'>-&GT;</span><span class='Delimiter'>{</span>type<span class='Delimiter'>} </span><span class='Operator'>eq </span><span class='String'>'addon'</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="parse.pl.html#LN484"><span class='Ref_to_Func'>dump_fields</span></a><span class='Parentheses'>(</span>$stmt_mode<span class='Delimiter'>, </span>$fields<span class='Delimiter'>, </span><span class='String'>''</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
 
    <span class='Comment_Single_Line'># if we added something (ie there are lines in our array), return 1 
</span>    <span class='Control'>return</span> 1 <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Keyword'>scalar</span><span class='Parentheses'>(</span>@<span class='Delimiter'>{ </span>$rec<span class='Operator'>-&GT;</span><span class='Delimiter'>{</span>lines<span class='Delimiter'>} }</span><span class='Parentheses'>) </span><span class='Operator'>&GT; </span>0<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> 0<span class='Delimiter'>; 
} 
</span> 
 
<span class='Comment_Single_Line'># include_addon does this same thing, but does not call this 
# sub... so if you change this, you need to fix include_addon too 
#   Pass:  buffer_name, string_to_append 
</span><a name="LN471"></a><span class='Control'>sub</span> <span class='Declare_Function'>add_to_buffer</span> 
<span class='Delimiter'>{ 
</span>    <span class='Keyword'>push</span><span class='Parentheses'>(</span>@<span class='Delimiter'>{ </span>$buff<span class='Delimiter'>{ </span>$_<span class='Delimiter'>[</span>0<span class='Delimiter'>] } }, </span><span class='String'>"$_[1]\n"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<a name="LN476"></a><span class='Control'>sub</span> <span class='Declare_Function'>dump_buffer</span> 
<span class='Delimiter'>{ 
</span>    <span class='Keyword'>my </span><span class='Parentheses'>(</span>$buffer<span class='Parentheses'>) </span><span class='Operator'>= </span>@_<span class='Delimiter'>; 
</span>    <span class='Keyword'>print </span><span class='String'>'/* '</span><span class='Delimiter'>, </span>$buffer<span class='Delimiter'>, </span><span class='String'>' */'</span><span class='Delimiter'>, </span><span class='String'>"\n"</span><span class='Delimiter'>; 
</span>    <span class='Keyword'>my </span>$ref <span class='Operator'>= </span>$buff<span class='Delimiter'>{</span>$buffer<span class='Delimiter'>}; 
</span>    <span class='Keyword'>print </span>@$ref<span class='Delimiter'>; 
} 
</span> 
<a name="LN484"></a><span class='Control'>sub</span> <span class='Declare_Function'>dump_fields</span> 
<span class='Delimiter'>{ 
</span>    <span class='Keyword'>my </span><span class='Parentheses'>(</span>$mode<span class='Delimiter'>, </span>$flds<span class='Delimiter'>, </span>$ln<span class='Parentheses'>) </span><span class='Operator'>= </span>@_<span class='Delimiter'>; 
</span>    <span class='Keyword'>my </span>$len <span class='Operator'>= </span><span class='Keyword'>scalar</span><span class='Parentheses'>(</span>@$flds<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span>$mode <span class='Operator'>== </span>0<span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span> 
        <span class='Comment_Single_Line'>#Normal 
</span>        <a href="parse.pl.html#LN471"><span class='Ref_to_Func'>add_to_buffer</span></a><span class='Parentheses'>(</span><span class='String'>'rules'</span><span class='Delimiter'>, </span>$ln<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span>$feature_not_supported <span class='Operator'>== </span>1<span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span> 
            <span class='Comment_Single_Line'># we found an unsupported feature, but we have to 
</span>            <span class='Comment_Single_Line'># filter out ExecuteStmt: CREATE OptTemp TABLE ... 
</span>            <span class='Comment_Single_Line'># because the warning there is only valid in some situations 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span>$flds<span class='Operator'>-&GT;</span><span class='Delimiter'>[</span>0<span class='Delimiter'>] </span><span class='Operator'>ne </span><span class='String'>'create'</span> <span class='Operator'>|| </span>$flds<span class='Operator'>-&GT;</span><span class='Delimiter'>[</span>2<span class='Delimiter'>] </span><span class='Operator'>ne </span><span class='String'>'table'</span><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <a href="parse.pl.html#LN471"><span class='Ref_to_Func'>add_to_buffer</span></a><span class='Parentheses'>(</span><span class='String'>'rules'</span><span class='Delimiter'>, 
</span><span class='String'>'mmerror(PARSE_ERROR, ET_WARNING, "unsupported feature will be passed to server");'</span> 
                <span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>            $feature_not_supported <span class='Operator'>= </span>0<span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span>$len <span class='Operator'>== </span>0<span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span> 
            <span class='Comment_Single_Line'># We have no fields ? 
</span>            <a href="parse.pl.html#LN471"><span class='Ref_to_Func'>add_to_buffer</span></a><span class='Parentheses'>(</span><span class='String'>'rules'</span><span class='Delimiter'>, </span><span class='String'>' $$=EMPTY; }'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> 
        <span class='Delimiter'>{ 
</span> 
            <span class='Comment_Single_Line'># Go through each field and try to 'aggregate' the tokens 
</span>            <span class='Comment_Single_Line'># into a single 'mm_strdup' where possible 
</span>            <span class='Keyword'>my </span>@flds_new<span class='Delimiter'>; 
</span>            <span class='Keyword'>my </span>$str<span class='Delimiter'>; 
</span>            <span class='Control'>for</span> <span class='Parentheses'>(</span><span class='Keyword'>my </span>$z <span class='Operator'>= </span>0<span class='Delimiter'>; </span>$z <span class='Operator'>&LT; </span>$len<span class='Delimiter'>; </span>$z<span class='Operator'>++</span><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Keyword'>substr</span><span class='Parentheses'>(</span>$flds<span class='Operator'>-&GT;</span><span class='Delimiter'>[</span>$z<span class='Delimiter'>], </span>0<span class='Delimiter'>, </span>1<span class='Parentheses'>) </span><span class='Operator'>eq </span><span class='String'>'$'</span><span class='Parentheses'>)</span> 
                <span class='Delimiter'>{ 
</span>                    <span class='Keyword'>push</span><span class='Parentheses'>(</span>@flds_new<span class='Delimiter'>, </span>$flds<span class='Operator'>-&GT;</span><span class='Delimiter'>[</span>$z<span class='Delimiter'>]</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                    <span class='Control'>next</span><span class='Delimiter'>; 
</span>                <span class='Delimiter'>} 
</span> 
                $str <span class='Operator'>= </span>$flds<span class='Operator'>-&GT;</span><span class='Delimiter'>[</span>$z<span class='Delimiter'>]; 
</span> 
                <span class='Control'>while</span> <span class='Parentheses'>(</span>1<span class='Parentheses'>) 
</span>                <span class='Delimiter'>{ 
</span>                    <span class='Control'>if</span> <span class='Parentheses'>(</span>$z <span class='Operator'>&GT;= </span>$len <span class='Operator'>- </span>1 
                        <span class='Operator'>|| </span><span class='Keyword'>substr</span><span class='Parentheses'>(</span>$flds<span class='Operator'>-&GT;</span><span class='Delimiter'>[ </span>$z <span class='Operator'>+ </span>1 <span class='Delimiter'>], </span>0<span class='Delimiter'>, </span>1<span class='Parentheses'>) </span><span class='Operator'>eq </span><span class='String'>'$'</span><span class='Parentheses'>)</span> 
                    <span class='Delimiter'>{ 
</span> 
                        <span class='Comment_Single_Line'># We're at the end... 
</span>                        <span class='Keyword'>push</span><span class='Parentheses'>(</span>@flds_new<span class='Delimiter'>, </span><span class='String'>"mm_strdup(\"$str\")"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                        <span class='Control'>last</span><span class='Delimiter'>; 
</span>                    <span class='Delimiter'>} 
</span>                    $z<span class='Operator'>++</span><span class='Delimiter'>; 
</span>                    $str <span class='Operator'>= </span>$str <span class='Operator'>. </span><span class='String'>' '</span> <span class='Operator'>. </span>$flds<span class='Operator'>-&GT;</span><span class='Delimiter'>[</span>$z<span class='Delimiter'>]; 
</span>                <span class='Delimiter'>} 
</span>            <span class='Delimiter'>} 
</span> 
            <span class='Comment_Single_Line'># So - how many fields did we end up with ? 
</span>            $len <span class='Operator'>= </span><span class='Keyword'>scalar</span><span class='Parentheses'>(</span>@flds_new<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span>$len <span class='Operator'>== </span>1<span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span> 
                <span class='Comment_Single_Line'># Straight assignment 
</span>                $str <span class='Operator'>= </span><span class='String'>' $$ = '</span> <span class='Operator'>. </span>$flds_new<span class='Delimiter'>[</span>0<span class='Delimiter'>] </span><span class='Operator'>. </span><span class='String'>';'</span><span class='Delimiter'>; 
</span>                <a href="parse.pl.html#LN471"><span class='Ref_to_Func'>add_to_buffer</span></a><span class='Parentheses'>(</span><span class='String'>'rules'</span><span class='Delimiter'>, </span>$str<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>            <span class='Control'>else</span> 
            <span class='Delimiter'>{ 
</span> 
                <span class='Comment_Single_Line'># Need to concatenate the results to form 
</span>                <span class='Comment_Single_Line'># our final string 
</span>                $str <span class='Operator'>= 
</span>                  <span class='String'>' $$ = cat_str('</span> <span class='Operator'>. </span>$len <span class='Operator'>. </span><span class='String'>','</span> <span class='Operator'>. </span><span class='Keyword'>join</span><span class='Parentheses'>(</span><span class='String'>','</span><span class='Delimiter'>, </span>@flds_new<span class='Parentheses'>) </span><span class='Operator'>. </span><span class='String'>');'</span><span class='Delimiter'>; 
</span>                <a href="parse.pl.html#LN471"><span class='Ref_to_Func'>add_to_buffer</span></a><span class='Parentheses'>(</span><span class='String'>'rules'</span><span class='Delimiter'>, </span>$str<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>            <a href="parse.pl.html#LN471"><span class='Ref_to_Func'>add_to_buffer</span></a><span class='Parentheses'>(</span><span class='String'>'rules'</span><span class='Delimiter'>, </span><span class='String'>'}'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span> 
        <span class='Comment_Single_Line'># we're in the stmt: rule 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span>$len<span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span> 
            <span class='Comment_Single_Line'># or just the statement ... 
</span>            <a href="parse.pl.html#LN471"><span class='Ref_to_Func'>add_to_buffer</span></a><span class='Parentheses'>(</span><span class='String'>'rules'</span><span class='Delimiter'>, 
</span>                <span class='String'>' { output_statement($1, 0, ECPGst_normal); }'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> 
        <span class='Delimiter'>{ 
</span>            <a href="parse.pl.html#LN471"><span class='Ref_to_Func'>add_to_buffer</span></a><span class='Parentheses'>(</span><span class='String'>'rules'</span><span class='Delimiter'>, </span><span class='String'>' { $$ = NULL; }'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>} 
} 
</span> 
 
<a name="LN587"></a><span class='Control'>sub</span> <span class='Declare_Function'>dump_line</span> 
<span class='Delimiter'>{ 
</span>    <span class='Keyword'>my </span><span class='Parentheses'>(</span>$stmt_mode<span class='Delimiter'>, </span>$fields<span class='Parentheses'>) </span><span class='Operator'>= </span>@_<span class='Delimiter'>; 
</span>    <span class='Keyword'>my </span>$block <span class='Operator'>= </span>$non_term_id <span class='Operator'>. </span>$line<span class='Delimiter'>; 
</span>    $block <span class='Operator'>=~ </span><span class='Keyword'>tr</span><span class='String'>/ |//</span>d<span class='Delimiter'>; 
</span>    <span class='Keyword'>my </span>$rep <span class='Operator'>= </span>$replace_line<span class='Delimiter'>{</span>$block<span class='Delimiter'>}; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span>$rep<span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span>$rep <span class='Operator'>eq </span><span class='String'>'ignore'</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Control'>return</span> 0<span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span>index<span class='Parentheses'>(</span>$line<span class='Delimiter'>, </span><span class='String'>'|'</span><span class='Parentheses'>) </span><span class='Operator'>!= -</span>1<span class='Parentheses'>)</span> 
        <span class='Delimiter'>{ 
</span>            $line <span class='Operator'>= </span><span class='String'>'| '</span> <span class='Operator'>. </span>$rep<span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> 
        <span class='Delimiter'>{ 
</span>            $line <span class='Operator'>= </span>$rep<span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        $block <span class='Operator'>= </span>$non_term_id <span class='Operator'>. </span>$line<span class='Delimiter'>; 
</span>        $block <span class='Operator'>=~ </span><span class='Keyword'>tr</span><span class='String'>/ |//</span>d<span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <a href="parse.pl.html#LN471"><span class='Ref_to_Func'>add_to_buffer</span></a><span class='Parentheses'>(</span><span class='String'>'rules'</span><span class='Delimiter'>, </span>$line<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Keyword'>my </span>$i <span class='Operator'>= </span><a href="parse.pl.html#LN435"><span class='Ref_to_Func'>include_addon</span></a><span class='Parentheses'>(</span><span class='String'>'rules'</span><span class='Delimiter'>, </span>$block<span class='Delimiter'>, </span>$fields<span class='Delimiter'>, </span>$stmt_mode<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span>$i <span class='Operator'>== </span>0<span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="parse.pl.html#LN484"><span class='Ref_to_Func'>dump_fields</span></a><span class='Parentheses'>(</span>$stmt_mode<span class='Delimiter'>, </span>$fields<span class='Delimiter'>, </span><span class='String'>' { '</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>return</span> 1<span class='Delimiter'>; 
} 
</span> 
<span class='Perl_POD'>=top 
    load addons into cache 
    %addons = { 
        stmtClosePortalStmt =&GT; { 'type' =&GT; 'block', 'lines' =&GT; [ "{", "if (INFORMIX_MODE)" ..., "}" ] }, 
        stmtViewStmt =&GT; { 'type' =&GT; 'rule', 'lines' =&GT; [ "| ECPGAllocateDescr", ... ] } 
    } 
 
=cut 
</span> 
<a name="LN629"></a><span class='Control'>sub</span> <span class='Declare_Function'>preload_addons</span> 
<span class='Delimiter'>{ 
</span>    <span class='Keyword'>my </span>$filename <span class='Operator'>= </span>$path <span class='Operator'>. </span><span class='String'>"/ecpg.addons"</span><span class='Delimiter'>; 
</span>    <span class='Keyword'>open</span><span class='Parentheses'>(</span><span class='Keyword'>my </span>$fh<span class='Delimiter'>, </span><span class='String'>'&LT;'</span><span class='Delimiter'>, </span>$filename<span class='Parentheses'>) </span>or <span class='Control'>die</span><span class='Delimiter'>; 
</span> 
 <span class='Comment_Single_Line'># there may be multiple lines starting ECPG: and then multiple lines of code. 
</span> <span class='Comment_Single_Line'># the code need to be add to all prior ECPG records. 
</span>    <span class='Keyword'>my </span><span class='Parentheses'>(</span>@needsRules<span class='Delimiter'>, </span>@code<span class='Delimiter'>, </span>$record<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Single_Line'># there may be comments before the first ECPG line, skip them 
</span>    <span class='Keyword'>my </span>$skip <span class='Operator'>= </span>1<span class='Delimiter'>; 
</span>    <span class='Control'>while</span> <span class='Parentheses'>(</span><span class='Operator'>&LT;</span>$fh<span class='Operator'>&GT;</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>/^ECPG:\s(\S+)\s?(\w+)?/</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            $skip <span class='Operator'>= </span>0<span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span>@code<span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <span class='Control'>for</span> <span class='Keyword'>my </span>$x <span class='Parentheses'>(</span>@needsRules<span class='Parentheses'>) 
</span>                <span class='Delimiter'>{ 
</span>                    <span class='Keyword'>push</span><span class='Parentheses'>(</span>@<span class='Delimiter'>{ </span>$x<span class='Operator'>-&GT;</span><span class='Delimiter'>{</span>lines<span class='Delimiter'>} }, </span>@code<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <span class='Delimiter'>} 
</span>                @code       <span class='Operator'>= </span><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span>                @needsRules <span class='Operator'>= </span><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>            $record          <span class='Operator'>= </span><span class='Delimiter'>{}; 
</span>            $record<span class='Operator'>-&GT;</span><span class='Delimiter'>{</span>type<span class='Delimiter'>}</span>  <span class='Operator'>= </span>$2<span class='Delimiter'>; 
</span>            $record<span class='Operator'>-&GT;</span><span class='Delimiter'>{</span>lines<span class='Delimiter'>} </span><span class='Operator'>= </span><span class='Delimiter'>[]; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Keyword'>exists </span>$addons<span class='Delimiter'>{</span>$1<span class='Delimiter'>}</span><span class='Parentheses'>) </span><span class='Delimiter'>{ </span><span class='Control'>die</span> <span class='String'>"Ga! there are dups!\n"</span><span class='Delimiter'>; } 
</span>            $addons<span class='Delimiter'>{</span>$1<span class='Delimiter'>} </span><span class='Operator'>= </span>$record<span class='Delimiter'>; 
</span>            <span class='Keyword'>push</span><span class='Parentheses'>(</span>@needsRules<span class='Delimiter'>, </span>$record<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Control'>next</span> <span class='Control'>if</span> $skip<span class='Delimiter'>; 
</span>            <span class='Keyword'>push</span><span class='Parentheses'>(</span>@code<span class='Delimiter'>, </span>$_<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>} 
</span>    <span class='Keyword'>close</span><span class='Parentheses'>(</span>$fh<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span>@code<span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>for</span> <span class='Keyword'>my </span>$x <span class='Parentheses'>(</span>@needsRules<span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Keyword'>push</span><span class='Parentheses'>(</span>@<span class='Delimiter'>{ </span>$x<span class='Operator'>-&GT;</span><span class='Delimiter'>{</span>lines<span class='Delimiter'>} }, </span>@code<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>} 
} 
</span></pre>
<table bgcolor='#c0c0c0' width='100%'><tr><td><a href='../../../../Contents.html'>Contents</a></td></tr>
</table><hr><p class='blurb' align='center'><a href='http://www.sourceinsight.com'>HTML Created by Source Insight Version 4.00.0084 Built on 2017-02-26</a></p>
</body></html>