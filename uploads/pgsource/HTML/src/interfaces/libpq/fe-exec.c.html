<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta name="generator" content="Source Insight Version 4.00.0084 Built on 2017-02-26">
<meta charset='UTF-8' />
<style type='text/css'><!--
TD {background-color: #C0C0C0; font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 70%; }
.blurb {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 70%; }
.filename {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 120%; font-weight: bold; }
.dirname {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 100%; font-weight: bold; margin-top: 2.5em;}
--></style>
<title>src\interfaces\libpq\fe-exec.c</title>
<LINK REL=StyleSheet HREF="../../../C_Cpp_Source_File.css" TYPE='text/css' MEDIA=screen>
</head>
<body bgcolor=#ffffff>
<table bgcolor='#c0c0c0' width='100%'>
<tr><td><p class='filename'><b>src\interfaces\libpq\fe-exec.c</b></p></td>
<td align='right'>
Wed Jun 14 08:26:11 2017
</td></tr>
<tr><td><a href='../../../Contents.html'>Contents</a></td></tr>
</table>
<pre>
</span><span class='Comment_Multi_Line'>/*------------------------------------------------------------------------- 
 * 
 * fe-exec.c 
 *    functions related to sending a query down to the backend 
 * 
 * Portions Copyright (c) 1996-2017, PostgreSQL Global Development Group 
 * Portions Copyright (c) 1994, Regents of the University of California 
 * 
 * 
 * IDENTIFICATION 
 *    src/interfaces/libpq/fe-exec.c 
 * 
 *------------------------------------------------------------------------- 
 */ 
</span><span class='Keyword'>#include </span><span class='String'>"postgres_fe.h"</span> 
 
<span class='Keyword'>#include </span><span class='String'>&LT;ctype.h&GT;</span> 
<span class='Keyword'>#include </span><span class='String'>&LT;fcntl.h&GT;</span> 
 
<span class='Keyword'>#include </span><span class='String'>"libpq-fe.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"libpq-int.h"</span> 
 
<span class='Keyword'>#include </span><span class='String'>"mb/pg_wchar.h"</span> 
 
<span class='Directive'>#ifdef</span> <a href="../../include/c.h.html#LN61"><span class='Ref_to_Const'>WIN32</span></a> 
<span class='Keyword'>#include </span><span class='String'>"win32.h"</span> 
<span class='Directive'>#else</span> 
<span class='Keyword'>#include </span><span class='String'>&LT;unistd.h&GT;</span> 
<span class='Directive'>#endif</span> 
 
<span class='Comment_Multi_Line'>/* keep this in same order as ExecStatusType in libpq-fe.h */ 
</span><a name="LN31"></a><span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Keyword'>const </span><span class='Declare_Var'>pgresStatus</span><span class='Delimiter'>[] </span><span class='Operator'>= </span><span class='Delimiter'>{ 
</span>    <span class='String'>"PGRES_EMPTY_QUERY"</span><span class='Delimiter'>, 
</span>    <span class='String'>"PGRES_COMMAND_OK"</span><span class='Delimiter'>, 
</span>    <span class='String'>"PGRES_TUPLES_OK"</span><span class='Delimiter'>, 
</span>    <span class='String'>"PGRES_COPY_OUT"</span><span class='Delimiter'>, 
</span>    <span class='String'>"PGRES_COPY_IN"</span><span class='Delimiter'>, 
</span>    <span class='String'>"PGRES_BAD_RESPONSE"</span><span class='Delimiter'>, 
</span>    <span class='String'>"PGRES_NONFATAL_ERROR"</span><span class='Delimiter'>, 
</span>    <span class='String'>"PGRES_FATAL_ERROR"</span><span class='Delimiter'>, 
</span>    <span class='String'>"PGRES_COPY_BOTH"</span><span class='Delimiter'>, 
</span>    <span class='String'>"PGRES_SINGLE_TUPLE"</span> 
<span class='Delimiter'>}; 
</span> 
<span class='Comment_Multi_Line'>/* 
 * static state needed by PQescapeString and PQescapeBytea; initialize to 
 * values that result in backward-compatible behavior 
 */ 
</span><a name="LN48"></a><span class='Keyword'>static int</span>  <span class='Declare_Var'>static_client_encoding</span> <span class='Operator'>= </span><a href="../../include/mb/pg_wchar.h.html#LN237"><span class='Ref_to_EnumConst'>PG_SQL_ASCII</span></a><span class='Delimiter'>; 
</span><a name="LN49"></a><span class='Keyword'>static bool </span><span class='Declare_Var'>static_std_strings</span> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span> 
 
<a name="LN52"></a><span class='Keyword'>static </span><a href="libpq-int.h.html#LN157"><span class='Ref_to_Struct'>PGEvent</span></a> <span class='Operator'>*</span><span class='Declare_Prototype'>dupEvents</span><span class='Parentheses'>(</span><a href="libpq-int.h.html#LN157"><span class='Ref_to_Struct'>PGEvent</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>events</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>count</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN53"></a><span class='Keyword'>static bool </span><span class='Declare_Prototype'>pqAddTuple</span><span class='Parentheses'>(</span><a href="libpq-fe.h.html#LN146"><span class='Ref_to_Typedef'>PGresult</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>res</span><span class='Delimiter'>, </span><a href="libpq-int.h.html#LN134"><span class='Ref_to_Typedef'>PGresAttValue</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>tup</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN54"></a><span class='Keyword'>static bool </span><span class='Declare_Prototype'>PQsendQueryStart</span><span class='Parentheses'>(</span><a href="libpq-fe.h.html#LN139"><span class='Ref_to_Typedef'>PGconn</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>conn</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN55"></a><span class='Keyword'>static int </span><span class='Declare_Prototype'>PQsendQueryGuts</span><span class='Parentheses'>(</span><a href="libpq-fe.h.html#LN139"><span class='Ref_to_Typedef'>PGconn</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>conn</span><span class='Delimiter'>, 
</span><a name="LN56"></a>                <span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>command</span><span class='Delimiter'>, 
</span><a name="LN57"></a>                <span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>stmtName</span><span class='Delimiter'>, 
</span><a name="LN58"></a>                <span class='Keyword'>int </span><span class='Declare_Parameter'>nParams</span><span class='Delimiter'>, 
</span><a name="LN59"></a>                <span class='Keyword'>const </span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>paramTypes</span><span class='Delimiter'>, 
</span><a name="LN60"></a>                <span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Keyword'>const </span><span class='Operator'>* </span><span class='Declare_Parameter'>paramValues</span><span class='Delimiter'>, 
</span><a name="LN61"></a>                <span class='Keyword'>const int </span><span class='Operator'>*</span><span class='Declare_Parameter'>paramLengths</span><span class='Delimiter'>, 
</span><a name="LN62"></a>                <span class='Keyword'>const int </span><span class='Operator'>*</span><span class='Declare_Parameter'>paramFormats</span><span class='Delimiter'>, 
</span><a name="LN63"></a>                <span class='Keyword'>int </span><span class='Declare_Parameter'>resultFormat</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN64"></a><span class='Keyword'>static void </span><span class='Declare_Prototype'>parseInput</span><span class='Parentheses'>(</span><a href="libpq-fe.h.html#LN139"><span class='Ref_to_Typedef'>PGconn</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>conn</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN65"></a><span class='Keyword'>static </span><a href="libpq-fe.h.html#LN146"><span class='Ref_to_Typedef'>PGresult</span></a> <span class='Operator'>*</span><span class='Declare_Prototype'>getCopyResult</span><span class='Parentheses'>(</span><a href="libpq-fe.h.html#LN139"><span class='Ref_to_Typedef'>PGconn</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>conn</span><span class='Delimiter'>, </span><a href="libpq-fe.h.html#LN81"><span class='Ref_to_Typedef'>ExecStatusType</span></a> <span class='Declare_Parameter'>copytype</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN66"></a><span class='Keyword'>static bool </span><span class='Declare_Prototype'>PQexecStart</span><span class='Parentheses'>(</span><a href="libpq-fe.h.html#LN139"><span class='Ref_to_Typedef'>PGconn</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>conn</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN67"></a><span class='Keyword'>static </span><a href="libpq-fe.h.html#LN146"><span class='Ref_to_Typedef'>PGresult</span></a> <span class='Operator'>*</span><span class='Declare_Prototype'>PQexecFinish</span><span class='Parentheses'>(</span><a href="libpq-fe.h.html#LN139"><span class='Ref_to_Typedef'>PGconn</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>conn</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN68"></a><span class='Keyword'>static int </span><span class='Declare_Prototype'>PQsendDescribe</span><span class='Parentheses'>(</span><a href="libpq-fe.h.html#LN139"><span class='Ref_to_Typedef'>PGconn</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>conn</span><span class='Delimiter'>, </span><span class='Keyword'>char </span><span class='Declare_Parameter'>desc_type</span><span class='Delimiter'>, 
</span><a name="LN69"></a>               <span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>desc_target</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN70"></a><span class='Keyword'>static int</span>  <span class='Declare_Prototype'>check_field_number</span><span class='Parentheses'>(</span><span class='Keyword'>const </span><a href="libpq-fe.h.html#LN146"><span class='Ref_to_Typedef'>PGresult</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>res</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>field_num</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
 
<span class='Comment_Multi_Line'>/* ---------------- 
 * Space management for PGresult. 
 * 
 * Formerly, libpq did a separate malloc() for each field of each tuple 
 * returned by a query.  This was remarkably expensive --- malloc/free 
 * consumed a sizable part of the application's runtime.  And there is 
 * no real need to keep track of the fields separately, since they will 
 * all be freed together when the PGresult is released.  So now, we grab 
 * large blocks of storage from malloc and allocate space for query data 
 * within these blocks, using a trivially simple allocator.  This reduces 
 * the number of malloc/free calls dramatically, and it also avoids 
 * fragmentation of the malloc storage arena. 
 * The PGresult structure itself is still malloc'd separately.  We could 
 * combine it with the first allocation block, but that would waste space 
 * for the common case that no extra storage is actually needed (that is, 
 * the SQL command did not return tuples). 
 * 
 * We also malloc the top-level array of tuple pointers separately, because 
 * we need to be able to enlarge it via realloc, and our trivial space 
 * allocator doesn't handle that effectively.  (Too bad the FE/BE protocol 
 * doesn't tell us up front how many tuples will be returned.) 
 * All other subsidiary storage for a PGresult is kept in PGresult_data blocks 
 * of size PGRESULT_DATA_BLOCKSIZE.  The overhead at the start of each block 
 * is just a link to the next one, if any.  Free-space management info is 
 * kept in the owning PGresult. 
 * A query returning a small amount of data will thus require three malloc 
 * calls: one for the PGresult, one for the tuples pointer array, and one 
 * PGresult_data block. 
 * 
 * Only the most recently allocated PGresult_data block is a candidate to 
 * have more stuff added to it --- any extra space left over in older blocks 
 * is wasted.  We could be smarter and search the whole chain, but the point 
 * here is to be simple and fast.  Typical applications do not keep a PGresult 
 * around very long anyway, so some wasted space within one is not a problem. 
 * 
 * Tuning constants for the space allocator are: 
 * PGRESULT_DATA_BLOCKSIZE: size of a standard allocation block, in bytes 
 * PGRESULT_ALIGN_BOUNDARY: assumed alignment requirement for binary data 
 * PGRESULT_SEP_ALLOC_THRESHOLD: objects bigger than this are given separate 
 *   blocks, instead of being crammed into a regular allocation block. 
 * Requirements for correct function are: 
 * PGRESULT_ALIGN_BOUNDARY must be a multiple of the alignment requirements 
 *      of all machine data types.  (Currently this is set from configure 
 *      tests, so it should be OK automatically.) 
 * PGRESULT_SEP_ALLOC_THRESHOLD + PGRESULT_BLOCK_OVERHEAD &LT;= 
 *          PGRESULT_DATA_BLOCKSIZE 
 *      pqResultAlloc assumes an object smaller than the threshold will fit 
 *      in a new block. 
 * The amount of space wasted at the end of a block could be as much as 
 * PGRESULT_SEP_ALLOC_THRESHOLD, so it doesn't pay to make that too large. 
 * ---------------- 
 */ 
</span> 
<a name="LN126"></a><span class='Keyword'>#define </span><span class='Declare_Constant'>PGRESULT_DATA_BLOCKSIZE</span>     <span class='Number'>2048</span> 
<a name="LN127"></a><span class='Keyword'>#define </span><span class='Declare_Constant'>PGRESULT_ALIGN_BOUNDARY</span>     MAXIMUM_ALIGNOF     <span class='Comment_Single_Line'>/* from configure */ 
</span><a name="LN128"></a><span class='Keyword'>#define </span><span class='Declare_Constant'>PGRESULT_BLOCK_OVERHEAD</span>     <a href="../ecpg/pgtypeslib/numeric.c.html#LN10"><span class='Ref_to_Macro'>Max</span></a><span class='Parentheses'>(</span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="libpq-int.h.html#LN100"><span class='Ref_to_Typedef'>PGresult_data</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN127"><span class='Ref_to_Const'>PGRESULT_ALIGN_BOUNDARY</span></a><span class='Parentheses'>)</span> 
<a name="LN129"></a><span class='Keyword'>#define </span><span class='Declare_Constant'>PGRESULT_SEP_ALLOC_THRESHOLD</span>    <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN126"><span class='Ref_to_Const'>PGRESULT_DATA_BLOCKSIZE</span></a> <span class='Operator'>/ </span><span class='Number'>2</span><span class='Parentheses'>) 
</span> 
 
<span class='Comment_Multi_Line'>/* 
 * PQmakeEmptyPGresult 
 *   returns a newly allocated, initialized PGresult with given status. 
 *   If conn is not NULL and status indicates an error, the conn's 
 *   errorMessage is copied.  Also, any PGEvents are copied from the conn. 
 */ 
</span><a href="libpq-fe.h.html#LN146"><span class='Ref_to_Typedef'>PGresult</span></a> <span class='Operator'>* 
</span><a name="LN139"></a><span class='Declare_Function'>PQmakeEmptyPGresult</span><span class='Parentheses'>(</span><a href="libpq-fe.h.html#LN139"><span class='Ref_to_Typedef'>PGconn</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>conn</span><span class='Delimiter'>, </span><a href="libpq-fe.h.html#LN81"><span class='Ref_to_Typedef'>ExecStatusType</span></a> <span class='Declare_Parameter'>status</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN141"></a>    <a href="libpq-fe.h.html#LN146"><span class='Ref_to_Typedef'>PGresult</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span> 
    <a href="fe-exec.c.html#LN141"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="libpq-fe.h.html#LN146"><span class='Ref_to_Typedef'>PGresult</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/snowball/header.h.html#LN49"><span class='Ref_to_Macro'>malloc</span></a><span class='Parentheses'>(</span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="libpq-fe.h.html#LN146"><span class='Ref_to_Typedef'>PGresult</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="fe-exec.c.html#LN141"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span> 
    <a href="fe-exec.c.html#LN141"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN168"><span class='Ref_to_Member'>ntups</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <a href="fe-exec.c.html#LN141"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN169"><span class='Ref_to_Member'>numAttributes</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <a href="fe-exec.c.html#LN141"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN170"><span class='Ref_to_Member'>attDescs</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="fe-exec.c.html#LN141"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN171"><span class='Ref_to_Member'>tuples</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="fe-exec.c.html#LN141"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN173"><span class='Ref_to_Member'>tupArrSize</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <a href="fe-exec.c.html#LN141"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN174"><span class='Ref_to_Member'>numParameters</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <a href="fe-exec.c.html#LN141"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN175"><span class='Ref_to_Member'>paramDescs</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="fe-exec.c.html#LN141"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN176"><span class='Ref_to_Member'>resultStatus</span></a> <span class='Operator'>= </span><a href="fe-exec.c.html#LN139"><span class='Ref_to_Parameter'>status</span></a><span class='Delimiter'>; 
</span>    <a href="fe-exec.c.html#LN141"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN177"><span class='Ref_to_Member'>cmdStatus</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='String'>'\0'</span><span class='Delimiter'>; 
</span>    <a href="fe-exec.c.html#LN141"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN178"><span class='Ref_to_Member'>binary</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <a href="fe-exec.c.html#LN141"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN186"><span class='Ref_to_Member'>events</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="fe-exec.c.html#LN141"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN187"><span class='Ref_to_Member'>nEvents</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <a href="fe-exec.c.html#LN141"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN195"><span class='Ref_to_Member'>errMsg</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="fe-exec.c.html#LN141"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN196"><span class='Ref_to_Member'>errFields</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="fe-exec.c.html#LN141"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN197"><span class='Ref_to_Member'>errQuery</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="fe-exec.c.html#LN141"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN200"><span class='Ref_to_Member'>null_field</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='String'>'\0'</span><span class='Delimiter'>; 
</span>    <a href="fe-exec.c.html#LN141"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN207"><span class='Ref_to_Member'>curBlock</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="fe-exec.c.html#LN141"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN208"><span class='Ref_to_Member'>curOffset</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <a href="fe-exec.c.html#LN141"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN209"><span class='Ref_to_Member'>spaceLeft</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN139"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* copy connection data we might need for operations on PGresult */ 
</span>        <a href="fe-exec.c.html#LN141"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN185"><span class='Ref_to_Member'>noticeHooks</span></a> <span class='Operator'>= </span><a href="fe-exec.c.html#LN139"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN369"><span class='Ref_to_Member'>noticeHooks</span></a><span class='Delimiter'>; 
</span>        <a href="fe-exec.c.html#LN141"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN188"><span class='Ref_to_Member'>client_encoding</span></a> <span class='Operator'>= </span><a href="fe-exec.c.html#LN139"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN422"><span class='Ref_to_Member'>client_encoding</span></a><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* consider copying conn's errorMessage */ 
</span>        <span class='Control'>switch</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN139"><span class='Ref_to_Parameter'>status</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Control'>case</span> <a href="libpq-fe.h.html#LN83"><span class='Ref_to_EnumConst'>PGRES_EMPTY_QUERY</span></a><span class='Operator'>: 
</span>            <span class='Control'>case</span> <a href="libpq-fe.h.html#LN84"><span class='Ref_to_EnumConst'>PGRES_COMMAND_OK</span></a><span class='Operator'>: 
</span>            <span class='Control'>case</span> <a href="libpq-fe.h.html#LN87"><span class='Ref_to_EnumConst'>PGRES_TUPLES_OK</span></a><span class='Operator'>: 
</span>            <span class='Control'>case</span> <a href="libpq-fe.h.html#LN90"><span class='Ref_to_EnumConst'>PGRES_COPY_OUT</span></a><span class='Operator'>: 
</span>            <span class='Control'>case</span> <a href="libpq-fe.h.html#LN91"><span class='Ref_to_EnumConst'>PGRES_COPY_IN</span></a><span class='Operator'>: 
</span>            <span class='Control'>case</span> <a href="libpq-fe.h.html#LN96"><span class='Ref_to_EnumConst'>PGRES_COPY_BOTH</span></a><span class='Operator'>: 
</span>            <span class='Control'>case</span> <a href="libpq-fe.h.html#LN97"><span class='Ref_to_EnumConst'>PGRES_SINGLE_TUPLE</span></a><span class='Operator'>: 
</span>                <span class='Comment_Multi_Line'>/* non-error cases */ 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span>            <span class='Control'>default</span><span class='Operator'>: 
</span>                <a href="libpq-int.h.html#LN567"><span class='Ref_to_Proto'>pqSetResultError</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN141"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN139"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN491"><span class='Ref_to_Member'>errorMessage</span></a><span class='Operator'>.</span><a href="pqexpbuffer.h.html#LN45"><span class='Ref_to_Member'>data</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span> 
        <span class='Comment_Multi_Line'>/* copy events last; result must be valid if we need to PQclear */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN139"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN373"><span class='Ref_to_Member'>nEvents</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <a href="fe-exec.c.html#LN141"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN186"><span class='Ref_to_Member'>events</span></a> <span class='Operator'>= </span><a href="fe-exec.c.html#LN52"><span class='Ref_to_Proto'>dupEvents</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN139"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN372"><span class='Ref_to_Member'>events</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN139"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN373"><span class='Ref_to_Member'>nEvents</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="fe-exec.c.html#LN141"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN186"><span class='Ref_to_Member'>events</span></a><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <a href="libpq-fe.h.html#LN501"><span class='Ref_to_Proto'>PQclear</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN141"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <span class='Control'>return</span> <span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>            <a href="fe-exec.c.html#LN141"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN187"><span class='Ref_to_Member'>nEvents</span></a> <span class='Operator'>= </span><a href="fe-exec.c.html#LN139"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN373"><span class='Ref_to_Member'>nEvents</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if conn &raquo; </span> 
    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* defaults... */ 
</span>        <a href="fe-exec.c.html#LN141"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN185"><span class='Ref_to_Member'>noticeHooks</span></a><span class='Operator'>.</span><a href="libpq-int.h.html#LN151"><span class='Ref_to_Member'>noticeRec</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>        <a href="fe-exec.c.html#LN141"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN185"><span class='Ref_to_Member'>noticeHooks</span></a><span class='Operator'>.</span><a href="libpq-int.h.html#LN152"><span class='Ref_to_Member'>noticeRecArg</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>        <a href="fe-exec.c.html#LN141"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN185"><span class='Ref_to_Member'>noticeHooks</span></a><span class='Operator'>.</span><a href="libpq-int.h.html#LN153"><span class='Ref_to_Member'>noticeProc</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>        <a href="fe-exec.c.html#LN141"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN185"><span class='Ref_to_Member'>noticeHooks</span></a><span class='Operator'>.</span><a href="libpq-int.h.html#LN154"><span class='Ref_to_Member'>noticeProcArg</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>        <a href="fe-exec.c.html#LN141"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN188"><span class='Ref_to_Member'>client_encoding</span></a> <span class='Operator'>= </span><a href="../../include/mb/pg_wchar.h.html#LN237"><span class='Ref_to_EnumConst'>PG_SQL_ASCII</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>return</span> <a href="fe-exec.c.html#LN141"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end PQmakeEmptyPGresult &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * PQsetResultAttrs 
 * 
 * Set the attributes for a given result.  This function fails if there are 
 * already attributes contained in the provided result.  The call is 
 * ignored if numAttributes is zero or attDescs is NULL.  If the 
 * function fails, it returns zero.  If the function succeeds, it 
 * returns a non-zero value. 
 */ 
</span><span class='Keyword'>int 
</span><a name="LN225"></a><span class='Declare_Function'>PQsetResultAttrs</span><span class='Parentheses'>(</span><a href="libpq-fe.h.html#LN146"><span class='Ref_to_Typedef'>PGresult</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>res</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>numAttributes</span><span class='Delimiter'>, </span><a href="libpq-fe.h.html#LN234"><span class='Ref_to_Typedef'>PGresAttDesc</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>attDescs</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN227"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>i</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* If attrs already exist, they cannot be overwritten. */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="fe-exec.c.html#LN225"><span class='Ref_to_Parameter'>res</span></a> <span class='Operator'>|| </span><a href="fe-exec.c.html#LN225"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN169"><span class='Ref_to_Member'>numAttributes</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <span class='Boolean'>FALSE</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* ignore no-op request */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN225"><span class='Ref_to_Parameter'>numAttributes</span></a> <span class='Operator'>&LT;= </span><span class='Number'>0</span> <span class='Operator'>|| !</span><a href="fe-exec.c.html#LN225"><span class='Ref_to_Parameter'>attDescs</span></a><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <span class='Boolean'>TRUE</span><span class='Delimiter'>; 
</span> 
    <a href="fe-exec.c.html#LN225"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN170"><span class='Ref_to_Member'>attDescs</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="libpq-fe.h.html#LN234"><span class='Ref_to_Typedef'>PGresAttDesc</span></a> <span class='Operator'>*</span><span class='Parentheses'>) 
</span>        <a href="fe-exec.c.html#LN488"><span class='Ref_to_Func'>PQresultAlloc</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN225"><span class='Ref_to_Parameter'>res</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN225"><span class='Ref_to_Parameter'>numAttributes</span></a> <span class='Operator'>* </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="libpq-fe.h.html#LN234"><span class='Ref_to_Typedef'>PGresAttDesc</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="fe-exec.c.html#LN225"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN170"><span class='Ref_to_Member'>attDescs</span></a><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <span class='Boolean'>FALSE</span><span class='Delimiter'>; 
</span> 
    <a href="fe-exec.c.html#LN225"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN169"><span class='Ref_to_Member'>numAttributes</span></a> <span class='Operator'>= </span><a href="fe-exec.c.html#LN225"><span class='Ref_to_Parameter'>numAttributes</span></a><span class='Delimiter'>; 
</span>    memcpy<span class='Parentheses'>(</span><a href="fe-exec.c.html#LN225"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN170"><span class='Ref_to_Member'>attDescs</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN225"><span class='Ref_to_Parameter'>attDescs</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN225"><span class='Ref_to_Parameter'>numAttributes</span></a> <span class='Operator'>* </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="libpq-fe.h.html#LN234"><span class='Ref_to_Typedef'>PGresAttDesc</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* deep-copy the attribute names, and determine format */ 
</span>    <a href="fe-exec.c.html#LN225"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN178"><span class='Ref_to_Member'>binary</span></a> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN227"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="fe-exec.c.html#LN227"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="fe-exec.c.html#LN225"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN169"><span class='Ref_to_Member'>numAttributes</span></a><span class='Delimiter'>; </span><a href="fe-exec.c.html#LN227"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN225"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN170"><span class='Ref_to_Member'>attDescs</span></a><span class='Delimiter'>[</span><a href="fe-exec.c.html#LN227"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="libpq-fe.h.html#LN236"><span class='Ref_to_Member'>name</span></a><span class='Parentheses'>) 
</span>            <a href="fe-exec.c.html#LN225"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN170"><span class='Ref_to_Member'>attDescs</span></a><span class='Delimiter'>[</span><a href="fe-exec.c.html#LN227"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="libpq-fe.h.html#LN236"><span class='Ref_to_Member'>name</span></a> <span class='Operator'>= </span><a href="libpq-int.h.html#LN570"><span class='Ref_to_Proto'>pqResultStrdup</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN225"><span class='Ref_to_Parameter'>res</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN225"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN170"><span class='Ref_to_Member'>attDescs</span></a><span class='Delimiter'>[</span><a href="fe-exec.c.html#LN227"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="libpq-fe.h.html#LN236"><span class='Ref_to_Member'>name</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> 
            <a href="fe-exec.c.html#LN225"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN170"><span class='Ref_to_Member'>attDescs</span></a><span class='Delimiter'>[</span><a href="fe-exec.c.html#LN227"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="libpq-fe.h.html#LN236"><span class='Ref_to_Member'>name</span></a> <span class='Operator'>= </span><a href="fe-exec.c.html#LN225"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN200"><span class='Ref_to_Member'>null_field</span></a><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="fe-exec.c.html#LN225"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN170"><span class='Ref_to_Member'>attDescs</span></a><span class='Delimiter'>[</span><a href="fe-exec.c.html#LN227"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="libpq-fe.h.html#LN236"><span class='Ref_to_Member'>name</span></a><span class='Parentheses'>) 
</span>            <span class='Control'>return</span> <span class='Boolean'>FALSE</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN225"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN170"><span class='Ref_to_Member'>attDescs</span></a><span class='Delimiter'>[</span><a href="fe-exec.c.html#LN227"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="libpq-fe.h.html#LN239"><span class='Ref_to_Member'>format</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>            <a href="fe-exec.c.html#LN225"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN178"><span class='Ref_to_Member'>binary</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>return</span> <span class='Boolean'>TRUE</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end PQsetResultAttrs &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * PQcopyResult 
 * 
 * Returns a deep copy of the provided 'src' PGresult, which cannot be NULL. 
 * The 'flags' argument controls which portions of the result will or will 
 * NOT be copied.  The created result is always put into the 
 * PGRES_TUPLES_OK status.  The source result error message is not copied, 
 * although cmdStatus is. 
 * 
 * To set custom attributes, use PQsetResultAttrs.  That function requires 
 * that there are no attrs contained in the result, so to use that 
 * function you cannot use the PG_COPYRES_ATTRS or PG_COPYRES_TUPLES 
 * options with this function. 
 * 
 * Options: 
 *   PG_COPYRES_ATTRS - Copy the source result's attributes 
 * 
 *   PG_COPYRES_TUPLES - Copy the source result's tuples.  This implies 
 *   copying the attrs, seeing how the attrs are needed by the tuples. 
 * 
 *   PG_COPYRES_EVENTS - Copy the source result's events. 
 * 
 *   PG_COPYRES_NOTICEHOOKS - Copy the source result's notice hooks. 
 */ 
</span><a href="libpq-fe.h.html#LN146"><span class='Ref_to_Typedef'>PGresult</span></a> <span class='Operator'>* 
</span><a name="LN290"></a><span class='Declare_Function'>PQcopyResult</span><span class='Parentheses'>(</span><span class='Keyword'>const </span><a href="libpq-fe.h.html#LN146"><span class='Ref_to_Typedef'>PGresult</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>src</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>flags</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN292"></a>    <a href="libpq-fe.h.html#LN146"><span class='Ref_to_Typedef'>PGresult</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>dest</span><span class='Delimiter'>; 
</span><a name="LN293"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>i</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="fe-exec.c.html#LN290"><span class='Ref_to_Parameter'>src</span></a><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span> 
    <a href="fe-exec.c.html#LN292"><span class='Ref_To_Local'>dest</span></a> <span class='Operator'>= </span><a href="fe-exec.c.html#LN138"><span class='Ref_to_Func'>PQmakeEmptyPGresult</span></a><span class='Parentheses'>(</span><span class='Null_Value'>NULL</span><span class='Delimiter'>, </span><a href="libpq-fe.h.html#LN87"><span class='Ref_to_EnumConst'>PGRES_TUPLES_OK</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="fe-exec.c.html#LN292"><span class='Ref_To_Local'>dest</span></a><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Always copy these over.  Is cmdStatus really useful here? */ 
</span>    <a href="fe-exec.c.html#LN292"><span class='Ref_To_Local'>dest</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN188"><span class='Ref_to_Member'>client_encoding</span></a> <span class='Operator'>= </span><a href="fe-exec.c.html#LN290"><span class='Ref_to_Parameter'>src</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN188"><span class='Ref_to_Member'>client_encoding</span></a><span class='Delimiter'>; 
</span>    <a href="../../../contrib/cube/cubeparse.y.html#LN150"><span class='Ref_to_Proto'>strcpy</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN292"><span class='Ref_To_Local'>dest</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN177"><span class='Ref_to_Member'>cmdStatus</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN290"><span class='Ref_to_Parameter'>src</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN177"><span class='Ref_to_Member'>cmdStatus</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Wants attrs? */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN290"><span class='Ref_to_Parameter'>flags</span></a> <span class='Operator'>& </span><span class='Parentheses'>(</span><a href="libpq-fe.h.html#LN33"><span class='Ref_to_Const'>PG_COPYRES_ATTRS</span></a> <span class='Operator'>| </span><a href="libpq-fe.h.html#LN34"><span class='Ref_to_Const'>PG_COPYRES_TUPLES</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="fe-exec.c.html#LN224"><span class='Ref_to_Func'>PQsetResultAttrs</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN292"><span class='Ref_To_Local'>dest</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN290"><span class='Ref_to_Parameter'>src</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN169"><span class='Ref_to_Member'>numAttributes</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN290"><span class='Ref_to_Parameter'>src</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN170"><span class='Ref_to_Member'>attDescs</span></a><span class='Parentheses'>))</span> 
        <span class='Delimiter'>{ 
</span>            <a href="libpq-fe.h.html#LN501"><span class='Ref_to_Proto'>PQclear</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN292"><span class='Ref_To_Local'>dest</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>return</span> <span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* Wants to copy tuples? */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN290"><span class='Ref_to_Parameter'>flags</span></a> <span class='Operator'>& </span><a href="libpq-fe.h.html#LN34"><span class='Ref_to_Const'>PG_COPYRES_TUPLES</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN319"></a>        <span class='Keyword'>int</span>         <span class='Declare_Local'>tup</span><span class='Delimiter'>, 
</span><a name="LN320"></a>                    <span class='Declare_Local'>field</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN319"><span class='Ref_To_Local'>tup</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="fe-exec.c.html#LN319"><span class='Ref_To_Local'>tup</span></a> <span class='Operator'>&LT; </span><a href="fe-exec.c.html#LN290"><span class='Ref_to_Parameter'>src</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN168"><span class='Ref_to_Member'>ntups</span></a><span class='Delimiter'>; </span><a href="fe-exec.c.html#LN319"><span class='Ref_To_Local'>tup</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN320"><span class='Ref_To_Local'>field</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="fe-exec.c.html#LN320"><span class='Ref_To_Local'>field</span></a> <span class='Operator'>&LT; </span><a href="fe-exec.c.html#LN290"><span class='Ref_to_Parameter'>src</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN169"><span class='Ref_to_Member'>numAttributes</span></a><span class='Delimiter'>; </span><a href="fe-exec.c.html#LN320"><span class='Ref_To_Local'>field</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="fe-exec.c.html#LN419"><span class='Ref_to_Func'>PQsetvalue</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN292"><span class='Ref_To_Local'>dest</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN319"><span class='Ref_To_Local'>tup</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN320"><span class='Ref_To_Local'>field</span></a><span class='Delimiter'>, 
</span>                                <a href="fe-exec.c.html#LN290"><span class='Ref_to_Parameter'>src</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN171"><span class='Ref_to_Member'>tuples</span></a><span class='Delimiter'>[</span><a href="fe-exec.c.html#LN319"><span class='Ref_To_Local'>tup</span></a><span class='Delimiter'>][</span><a href="fe-exec.c.html#LN320"><span class='Ref_To_Local'>field</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><span class='Keyword'>value</span><span class='Delimiter'>, 
</span>                                <a href="fe-exec.c.html#LN290"><span class='Ref_to_Parameter'>src</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN171"><span class='Ref_to_Member'>tuples</span></a><span class='Delimiter'>[</span><a href="fe-exec.c.html#LN319"><span class='Ref_To_Local'>tup</span></a><span class='Delimiter'>][</span><a href="fe-exec.c.html#LN320"><span class='Ref_To_Local'>field</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="libpq-int.h.html#LN136"><span class='Ref_to_Member'>len</span></a><span class='Parentheses'>))</span> 
                <span class='Delimiter'>{ 
</span>                    <a href="libpq-fe.h.html#LN501"><span class='Ref_to_Proto'>PQclear</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN292"><span class='Ref_To_Local'>dest</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                    <span class='Control'>return</span> <span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>                <span class='Delimiter'>} 
</span>            <span class='Delimiter'>} 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* Wants to copy notice hooks? */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN290"><span class='Ref_to_Parameter'>flags</span></a> <span class='Operator'>& </span><a href="libpq-fe.h.html#LN36"><span class='Ref_to_Const'>PG_COPYRES_NOTICEHOOKS</span></a><span class='Parentheses'>) 
</span>        <a href="fe-exec.c.html#LN292"><span class='Ref_To_Local'>dest</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN185"><span class='Ref_to_Member'>noticeHooks</span></a> <span class='Operator'>= </span><a href="fe-exec.c.html#LN290"><span class='Ref_to_Parameter'>src</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN185"><span class='Ref_to_Member'>noticeHooks</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Wants to copy PGEvents? */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="fe-exec.c.html#LN290"><span class='Ref_to_Parameter'>flags</span></a> <span class='Operator'>& </span><a href="libpq-fe.h.html#LN35"><span class='Ref_to_Const'>PG_COPYRES_EVENTS</span></a><span class='Parentheses'>) </span><span class='Operator'>&& </span><a href="fe-exec.c.html#LN290"><span class='Ref_to_Parameter'>src</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN187"><span class='Ref_to_Member'>nEvents</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
    <span class='Delimiter'>{ 
</span>        <a href="fe-exec.c.html#LN292"><span class='Ref_To_Local'>dest</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN186"><span class='Ref_to_Member'>events</span></a> <span class='Operator'>= </span><a href="fe-exec.c.html#LN52"><span class='Ref_to_Proto'>dupEvents</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN290"><span class='Ref_to_Parameter'>src</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN186"><span class='Ref_to_Member'>events</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN290"><span class='Ref_to_Parameter'>src</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN187"><span class='Ref_to_Member'>nEvents</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="fe-exec.c.html#LN292"><span class='Ref_To_Local'>dest</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN186"><span class='Ref_to_Member'>events</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <a href="libpq-fe.h.html#LN501"><span class='Ref_to_Proto'>PQclear</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN292"><span class='Ref_To_Local'>dest</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>return</span> <span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <a href="fe-exec.c.html#LN292"><span class='Ref_To_Local'>dest</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN187"><span class='Ref_to_Member'>nEvents</span></a> <span class='Operator'>= </span><a href="fe-exec.c.html#LN290"><span class='Ref_to_Parameter'>src</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN187"><span class='Ref_to_Member'>nEvents</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* Okay, trigger PGEVT_RESULTCOPY event */ 
</span>    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN293"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="fe-exec.c.html#LN293"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="fe-exec.c.html#LN292"><span class='Ref_To_Local'>dest</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN187"><span class='Ref_to_Member'>nEvents</span></a><span class='Delimiter'>; </span><a href="fe-exec.c.html#LN293"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN290"><span class='Ref_to_Parameter'>src</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN186"><span class='Ref_to_Member'>events</span></a><span class='Delimiter'>[</span><a href="fe-exec.c.html#LN293"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="libpq-int.h.html#LN163"><span class='Ref_to_Member'>resultInitialized</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span><a name="LN358"></a>            <a href="libpq-events.h.html#LN57"><span class='Ref_to_Typedef'>PGEventResultCopy</span></a> <span class='Declare_Local'>evt</span><span class='Delimiter'>; 
</span> 
            <a href="fe-exec.c.html#LN358"><span class='Ref_To_Local'>evt</span></a><span class='Operator'>.</span><a href="libpq-events.h.html#LN59"><span class='Ref_to_Member'>src</span></a> <span class='Operator'>= </span><a href="fe-exec.c.html#LN290"><span class='Ref_to_Parameter'>src</span></a><span class='Delimiter'>; 
</span>            <a href="fe-exec.c.html#LN358"><span class='Ref_To_Local'>evt</span></a><span class='Operator'>.</span><a href="libpq-events.h.html#LN60"><span class='Ref_to_Member'>dest</span></a> <span class='Operator'>= </span><a href="fe-exec.c.html#LN292"><span class='Ref_To_Local'>dest</span></a><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="fe-exec.c.html#LN292"><span class='Ref_To_Local'>dest</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN186"><span class='Ref_to_Member'>events</span></a><span class='Delimiter'>[</span><a href="fe-exec.c.html#LN293"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="libpq-int.h.html#LN159"><span class='Ref_to_Member'>proc</span></a><span class='Parentheses'>(</span><a href="libpq-events.h.html#LN32"><span class='Ref_to_EnumConst'>PGEVT_RESULTCOPY</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="fe-exec.c.html#LN358"><span class='Ref_To_Local'>evt</span></a><span class='Delimiter'>, 
</span>                                      <a href="fe-exec.c.html#LN292"><span class='Ref_To_Local'>dest</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN186"><span class='Ref_to_Member'>events</span></a><span class='Delimiter'>[</span><a href="fe-exec.c.html#LN293"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="libpq-int.h.html#LN161"><span class='Ref_to_Member'>passThrough</span></a><span class='Parentheses'>))</span> 
            <span class='Delimiter'>{ 
</span>                <a href="libpq-fe.h.html#LN501"><span class='Ref_to_Proto'>PQclear</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN292"><span class='Ref_To_Local'>dest</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <span class='Control'>return</span> <span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>            <a href="fe-exec.c.html#LN292"><span class='Ref_To_Local'>dest</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN186"><span class='Ref_to_Member'>events</span></a><span class='Delimiter'>[</span><a href="fe-exec.c.html#LN293"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="libpq-int.h.html#LN163"><span class='Ref_to_Member'>resultInitialized</span></a> <span class='Operator'>= </span><span class='Boolean'>TRUE</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>return</span> <a href="fe-exec.c.html#LN292"><span class='Ref_To_Local'>dest</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end PQcopyResult &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * Copy an array of PGEvents (with no extra space for more). 
 * Does not duplicate the event instance data, sets this to NULL. 
 * Also, the resultInitialized flags are all cleared. 
 */ 
</span><span class='Keyword'>static </span><a href="libpq-int.h.html#LN157"><span class='Ref_to_Struct'>PGEvent</span></a> <span class='Operator'>* 
</span><a name="LN381"></a><span class='Declare_Function'>dupEvents</span><span class='Parentheses'>(</span><a href="libpq-int.h.html#LN157"><span class='Ref_to_Struct'>PGEvent</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>events</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>count</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN383"></a>    <a href="libpq-int.h.html#LN157"><span class='Ref_to_Struct'>PGEvent</span></a>    <span class='Operator'>*</span><span class='Declare_Local'>newEvents</span><span class='Delimiter'>; 
</span><a name="LN384"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>i</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="fe-exec.c.html#LN381"><span class='Ref_to_Parameter'>events</span></a> <span class='Operator'>|| </span><a href="fe-exec.c.html#LN381"><span class='Ref_to_Parameter'>count</span></a> <span class='Operator'>&LT;= </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span> 
    <a href="fe-exec.c.html#LN383"><span class='Ref_To_Local'>newEvents</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="libpq-int.h.html#LN157"><span class='Ref_to_Struct'>PGEvent</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/snowball/header.h.html#LN49"><span class='Ref_to_Macro'>malloc</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN381"><span class='Ref_to_Parameter'>count</span></a> <span class='Operator'>* </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="libpq-int.h.html#LN157"><span class='Ref_to_Struct'>PGEvent</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="fe-exec.c.html#LN383"><span class='Ref_To_Local'>newEvents</span></a><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN384"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="fe-exec.c.html#LN384"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="fe-exec.c.html#LN381"><span class='Ref_to_Parameter'>count</span></a><span class='Delimiter'>; </span><a href="fe-exec.c.html#LN384"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="fe-exec.c.html#LN383"><span class='Ref_To_Local'>newEvents</span></a><span class='Delimiter'>[</span><a href="fe-exec.c.html#LN384"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="libpq-int.h.html#LN159"><span class='Ref_to_Member'>proc</span></a> <span class='Operator'>= </span><a href="fe-exec.c.html#LN381"><span class='Ref_to_Parameter'>events</span></a><span class='Delimiter'>[</span><a href="fe-exec.c.html#LN384"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="libpq-int.h.html#LN159"><span class='Ref_to_Member'>proc</span></a><span class='Delimiter'>; 
</span>        <a href="fe-exec.c.html#LN383"><span class='Ref_To_Local'>newEvents</span></a><span class='Delimiter'>[</span><a href="fe-exec.c.html#LN384"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="libpq-int.h.html#LN161"><span class='Ref_to_Member'>passThrough</span></a> <span class='Operator'>= </span><a href="fe-exec.c.html#LN381"><span class='Ref_to_Parameter'>events</span></a><span class='Delimiter'>[</span><a href="fe-exec.c.html#LN384"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="libpq-int.h.html#LN161"><span class='Ref_to_Member'>passThrough</span></a><span class='Delimiter'>; 
</span>        <a href="fe-exec.c.html#LN383"><span class='Ref_To_Local'>newEvents</span></a><span class='Delimiter'>[</span><a href="fe-exec.c.html#LN384"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="libpq-int.h.html#LN162"><span class='Ref_to_Member'>data</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>        <a href="fe-exec.c.html#LN383"><span class='Ref_To_Local'>newEvents</span></a><span class='Delimiter'>[</span><a href="fe-exec.c.html#LN384"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="libpq-int.h.html#LN163"><span class='Ref_to_Member'>resultInitialized</span></a> <span class='Operator'>= </span><span class='Boolean'>FALSE</span><span class='Delimiter'>; 
</span>        <a href="fe-exec.c.html#LN383"><span class='Ref_To_Local'>newEvents</span></a><span class='Delimiter'>[</span><a href="fe-exec.c.html#LN384"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="libpq-int.h.html#LN160"><span class='Ref_to_Member'>name</span></a> <span class='Operator'>= </span>strdup<span class='Parentheses'>(</span><a href="fe-exec.c.html#LN381"><span class='Ref_to_Parameter'>events</span></a><span class='Delimiter'>[</span><a href="fe-exec.c.html#LN384"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="libpq-int.h.html#LN160"><span class='Ref_to_Member'>name</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="fe-exec.c.html#LN383"><span class='Ref_To_Local'>newEvents</span></a><span class='Delimiter'>[</span><a href="fe-exec.c.html#LN384"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="libpq-int.h.html#LN160"><span class='Ref_to_Member'>name</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Control'>while</span> <span class='Parentheses'>(</span><span class='Operator'>--</span><a href="fe-exec.c.html#LN384"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&GT;= </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>                <a href="../../include/snowball/header.h.html#LN64"><span class='Ref_to_Macro'>free</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN383"><span class='Ref_To_Local'>newEvents</span></a><span class='Delimiter'>[</span><a href="fe-exec.c.html#LN384"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="libpq-int.h.html#LN160"><span class='Ref_to_Member'>name</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="../../include/snowball/header.h.html#LN64"><span class='Ref_to_Macro'>free</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN383"><span class='Ref_To_Local'>newEvents</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>return</span> <span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>return</span> <a href="fe-exec.c.html#LN383"><span class='Ref_To_Local'>newEvents</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end dupEvents &raquo; </span> 
 
 
<span class='Comment_Multi_Line'>/* 
 * Sets the value for a tuple field.  The tup_num must be less than or 
 * equal to PQntuples(res).  If it is equal, a new tuple is created and 
 * added to the result. 
 * Returns a non-zero value for success and zero for failure. 
 */ 
</span><span class='Keyword'>int 
</span><a name="LN420"></a><span class='Declare_Function'>PQsetvalue</span><span class='Parentheses'>(</span><a href="libpq-fe.h.html#LN146"><span class='Ref_to_Typedef'>PGresult</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>res</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>tup_num</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>field_num</span><span class='Delimiter'>, </span><span class='Keyword'>char </span><span class='Operator'>*</span><span class='Declare_Parameter'>value</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>len</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN422"></a>    <a href="libpq-int.h.html#LN134"><span class='Ref_to_Typedef'>PGresAttValue</span></a> <span class='Operator'>*</span><span class='Declare_Local'>attval</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="fe-exec.c.html#LN70"><span class='Ref_to_Proto'>check_field_number</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN420"><span class='Ref_to_Parameter'>res</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN420"><span class='Ref_to_Parameter'>field_num</span></a><span class='Parentheses'>))</span> 
        <span class='Control'>return</span> <span class='Boolean'>FALSE</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Invalid tup_num, must be &LT;= ntups */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN420"><span class='Ref_to_Parameter'>tup_num</span></a> <span class='Operator'>&LT; </span><span class='Number'>0</span> <span class='Operator'>|| </span><a href="fe-exec.c.html#LN420"><span class='Ref_to_Parameter'>tup_num</span></a> <span class='Operator'>&GT; </span><a href="fe-exec.c.html#LN420"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN168"><span class='Ref_to_Member'>ntups</span></a><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <span class='Boolean'>FALSE</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* need to allocate a new tuple? */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN420"><span class='Ref_to_Parameter'>tup_num</span></a> <span class='Operator'>== </span><a href="fe-exec.c.html#LN420"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN168"><span class='Ref_to_Member'>ntups</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN434"></a>        <a href="libpq-int.h.html#LN134"><span class='Ref_to_Typedef'>PGresAttValue</span></a> <span class='Operator'>*</span><span class='Declare_Local'>tup</span><span class='Delimiter'>; 
</span><a name="LN435"></a>        <span class='Keyword'>int</span>         <span class='Declare_Local'>i</span><span class='Delimiter'>; 
</span> 
        <a href="fe-exec.c.html#LN434"><span class='Ref_To_Local'>tup</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="libpq-int.h.html#LN134"><span class='Ref_to_Typedef'>PGresAttValue</span></a> <span class='Operator'>*</span><span class='Parentheses'>) 
</span>            <a href="fe-exec.c.html#LN504"><span class='Ref_to_Func'>pqResultAlloc</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN420"><span class='Ref_to_Parameter'>res</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN420"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN169"><span class='Ref_to_Member'>numAttributes</span></a> <span class='Operator'>* </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="libpq-int.h.html#LN134"><span class='Ref_to_Typedef'>PGresAttValue</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                          <span class='Boolean'>TRUE</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="fe-exec.c.html#LN434"><span class='Ref_To_Local'>tup</span></a><span class='Parentheses'>) 
</span>            <span class='Control'>return</span> <span class='Boolean'>FALSE</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* initialize each column to NULL */ 
</span>        <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN435"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="fe-exec.c.html#LN435"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="fe-exec.c.html#LN420"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN169"><span class='Ref_to_Member'>numAttributes</span></a><span class='Delimiter'>; </span><a href="fe-exec.c.html#LN435"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <a href="fe-exec.c.html#LN434"><span class='Ref_To_Local'>tup</span></a><span class='Delimiter'>[</span><a href="fe-exec.c.html#LN435"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="libpq-int.h.html#LN136"><span class='Ref_to_Member'>len</span></a> <span class='Operator'>= </span><a href="libpq-int.h.html#LN132"><span class='Ref_to_Const'>NULL_LEN</span></a><span class='Delimiter'>; 
</span>            <a href="fe-exec.c.html#LN434"><span class='Ref_To_Local'>tup</span></a><span class='Delimiter'>[</span><a href="fe-exec.c.html#LN435"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><span class='Keyword'>value </span><span class='Operator'>= </span><a href="fe-exec.c.html#LN420"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN200"><span class='Ref_to_Member'>null_field</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span> 
        <span class='Comment_Multi_Line'>/* add it to the array */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="fe-exec.c.html#LN53"><span class='Ref_to_Proto'>pqAddTuple</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN420"><span class='Ref_to_Parameter'>res</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN434"><span class='Ref_To_Local'>tup</span></a><span class='Parentheses'>))</span> 
            <span class='Control'>return</span> <span class='Boolean'>FALSE</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if tup_num==res-&GT;ntups &raquo; </span> 
 
    <a href="fe-exec.c.html#LN422"><span class='Ref_To_Local'>attval</span></a> <span class='Operator'>= &</span><a href="fe-exec.c.html#LN420"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN171"><span class='Ref_to_Member'>tuples</span></a><span class='Delimiter'>[</span><a href="fe-exec.c.html#LN420"><span class='Ref_to_Parameter'>tup_num</span></a><span class='Delimiter'>][</span><a href="fe-exec.c.html#LN420"><span class='Ref_to_Parameter'>field_num</span></a><span class='Delimiter'>]; 
</span> 
    <span class='Comment_Multi_Line'>/* treat either NULL_LEN or NULL value pointer as a NULL field */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN420"><span class='Ref_to_Parameter'>len</span></a> <span class='Operator'>== </span><a href="libpq-int.h.html#LN132"><span class='Ref_to_Const'>NULL_LEN</span></a> <span class='Operator'>|| </span><span class='Keyword'>value </span><span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="fe-exec.c.html#LN422"><span class='Ref_To_Local'>attval</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN136"><span class='Ref_to_Member'>len</span></a> <span class='Operator'>= </span><a href="libpq-int.h.html#LN132"><span class='Ref_to_Const'>NULL_LEN</span></a><span class='Delimiter'>; 
</span>        <a href="fe-exec.c.html#LN422"><span class='Ref_To_Local'>attval</span></a><span class='Operator'>-&GT;</span><span class='Keyword'>value </span><span class='Operator'>= </span><a href="fe-exec.c.html#LN420"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN200"><span class='Ref_to_Member'>null_field</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN420"><span class='Ref_to_Parameter'>len</span></a> <span class='Operator'>&LT;= </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="fe-exec.c.html#LN422"><span class='Ref_To_Local'>attval</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN136"><span class='Ref_to_Member'>len</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>        <a href="fe-exec.c.html#LN422"><span class='Ref_To_Local'>attval</span></a><span class='Operator'>-&GT;</span><span class='Keyword'>value </span><span class='Operator'>= </span><a href="fe-exec.c.html#LN420"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN200"><span class='Ref_to_Member'>null_field</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <a href="fe-exec.c.html#LN422"><span class='Ref_To_Local'>attval</span></a><span class='Operator'>-&GT;</span><span class='Keyword'>value </span><span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Keyword'>char </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="fe-exec.c.html#LN504"><span class='Ref_to_Func'>pqResultAlloc</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN420"><span class='Ref_to_Parameter'>res</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN420"><span class='Ref_to_Parameter'>len</span></a> <span class='Operator'>+ </span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Boolean'>TRUE</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="fe-exec.c.html#LN422"><span class='Ref_To_Local'>attval</span></a><span class='Operator'>-&GT;</span><span class='Keyword'>value</span><span class='Parentheses'>) 
</span>            <span class='Control'>return</span> <span class='Boolean'>FALSE</span><span class='Delimiter'>; 
</span>        <a href="fe-exec.c.html#LN422"><span class='Ref_To_Local'>attval</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN136"><span class='Ref_to_Member'>len</span></a> <span class='Operator'>= </span><a href="fe-exec.c.html#LN420"><span class='Ref_to_Parameter'>len</span></a><span class='Delimiter'>; 
</span>        memcpy<span class='Parentheses'>(</span><a href="fe-exec.c.html#LN422"><span class='Ref_To_Local'>attval</span></a><span class='Operator'>-&GT;</span><span class='Keyword'>value</span><span class='Delimiter'>, </span><span class='Keyword'>value</span><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN420"><span class='Ref_to_Parameter'>len</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="fe-exec.c.html#LN422"><span class='Ref_To_Local'>attval</span></a><span class='Operator'>-&GT;</span><span class='Keyword'>value</span><span class='Delimiter'>[</span><a href="fe-exec.c.html#LN420"><span class='Ref_to_Parameter'>len</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='String'>'\0'</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>return</span> <span class='Boolean'>TRUE</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end PQsetvalue &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * pqResultAlloc - exported routine to allocate local storage in a PGresult. 
 * 
 * We force all such allocations to be maxaligned, since we don't know 
 * whether the value might be binary. 
 */ 
</span><span class='Keyword'>void </span><span class='Operator'>* 
</span><a name="LN489"></a><span class='Declare_Function'>PQresultAlloc</span><span class='Parentheses'>(</span><a href="libpq-fe.h.html#LN146"><span class='Ref_to_Typedef'>PGresult</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>res</span><span class='Delimiter'>, </span>size_t <span class='Declare_Parameter'>nBytes</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>return</span> <a href="fe-exec.c.html#LN504"><span class='Ref_to_Func'>pqResultAlloc</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN489"><span class='Ref_to_Parameter'>res</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN489"><span class='Ref_to_Parameter'>nBytes</span></a><span class='Delimiter'>, </span><span class='Boolean'>TRUE</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * pqResultAlloc - 
 *      Allocate subsidiary storage for a PGresult. 
 * 
 * nBytes is the amount of space needed for the object. 
 * If isBinary is true, we assume that we need to align the object on 
 * a machine allocation boundary. 
 * If isBinary is false, we assume the object is a char string and can 
 * be allocated on any byte boundary. 
 */ 
</span><span class='Keyword'>void </span><span class='Operator'>* 
</span><a name="LN505"></a><span class='Declare_Function'>pqResultAlloc</span><span class='Parentheses'>(</span><a href="libpq-fe.h.html#LN146"><span class='Ref_to_Typedef'>PGresult</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>res</span><span class='Delimiter'>, </span>size_t <span class='Declare_Parameter'>nBytes</span><span class='Delimiter'>, </span><span class='Keyword'>bool </span><span class='Declare_Parameter'>isBinary</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN507"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>space</span><span class='Delimiter'>; 
</span><a name="LN508"></a>    <a href="libpq-int.h.html#LN100"><span class='Ref_to_Typedef'>PGresult_data</span></a> <span class='Operator'>*</span><span class='Declare_Local'>block</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="fe-exec.c.html#LN505"><span class='Ref_to_Parameter'>res</span></a><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN505"><span class='Ref_to_Parameter'>nBytes</span></a> <span class='Operator'>&LT;= </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <a href="fe-exec.c.html#LN505"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN200"><span class='Ref_to_Member'>null_field</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * If alignment is needed, round up the current position to an alignment 
     * boundary. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN505"><span class='Ref_to_Parameter'>isBinary</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN522"></a>        <span class='Keyword'>int</span>         <span class='Declare_Local'>offset</span> <span class='Operator'>= </span><a href="fe-exec.c.html#LN505"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN208"><span class='Ref_to_Member'>curOffset</span></a> <span class='Operator'>% </span><a href="fe-exec.c.html#LN127"><span class='Ref_to_Const'>PGRESULT_ALIGN_BOUNDARY</span></a><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN522"><span class='Ref_To_Local'>offset</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <a href="fe-exec.c.html#LN505"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN208"><span class='Ref_to_Member'>curOffset</span></a> <span class='Operator'>+= </span><a href="fe-exec.c.html#LN127"><span class='Ref_to_Const'>PGRESULT_ALIGN_BOUNDARY</span></a> <span class='Operator'>- </span><a href="fe-exec.c.html#LN522"><span class='Ref_To_Local'>offset</span></a><span class='Delimiter'>; 
</span>            <a href="fe-exec.c.html#LN505"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN209"><span class='Ref_to_Member'>spaceLeft</span></a> <span class='Operator'>-= </span><a href="fe-exec.c.html#LN127"><span class='Ref_to_Const'>PGRESULT_ALIGN_BOUNDARY</span></a> <span class='Operator'>- </span><a href="fe-exec.c.html#LN522"><span class='Ref_To_Local'>offset</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* If there's enough space in the current block, no problem. */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN505"><span class='Ref_to_Parameter'>nBytes</span></a> <span class='Operator'>&LT;= </span><span class='Parentheses'>(</span>size_t<span class='Parentheses'>) </span><a href="fe-exec.c.html#LN505"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN209"><span class='Ref_to_Member'>spaceLeft</span></a><span class='Parentheses'>)</span> 
    <span class='Delimiter'>{ 
</span>        <a href="fe-exec.c.html#LN507"><span class='Ref_To_Local'>space</span></a> <span class='Operator'>= </span><a href="fe-exec.c.html#LN505"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN207"><span class='Ref_to_Member'>curBlock</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN105"><span class='Ref_to_Member'>space</span></a> <span class='Operator'>+ </span><a href="fe-exec.c.html#LN505"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN208"><span class='Ref_to_Member'>curOffset</span></a><span class='Delimiter'>; 
</span>        <a href="fe-exec.c.html#LN505"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN208"><span class='Ref_to_Member'>curOffset</span></a> <span class='Operator'>+= </span><a href="fe-exec.c.html#LN505"><span class='Ref_to_Parameter'>nBytes</span></a><span class='Delimiter'>; 
</span>        <a href="fe-exec.c.html#LN505"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN209"><span class='Ref_to_Member'>spaceLeft</span></a> <span class='Operator'>-= </span><a href="fe-exec.c.html#LN505"><span class='Ref_to_Parameter'>nBytes</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <a href="fe-exec.c.html#LN507"><span class='Ref_To_Local'>space</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * If the requested object is very large, give it its own block; this 
     * avoids wasting what might be most of the current block to start a new 
     * block.  (We'd have to special-case requests bigger than the block size 
     * anyway.)  The object is always given binary alignment in this case. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN505"><span class='Ref_to_Parameter'>nBytes</span></a> <span class='Operator'>&GT;= </span><a href="fe-exec.c.html#LN129"><span class='Ref_to_Const'>PGRESULT_SEP_ALLOC_THRESHOLD</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="fe-exec.c.html#LN508"><span class='Ref_To_Local'>block</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="libpq-int.h.html#LN100"><span class='Ref_to_Typedef'>PGresult_data</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/snowball/header.h.html#LN49"><span class='Ref_to_Macro'>malloc</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN505"><span class='Ref_to_Parameter'>nBytes</span></a> <span class='Operator'>+ </span><a href="fe-exec.c.html#LN128"><span class='Ref_to_Const'>PGRESULT_BLOCK_OVERHEAD</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="fe-exec.c.html#LN508"><span class='Ref_To_Local'>block</span></a><span class='Parentheses'>) 
</span>            <span class='Control'>return</span> <span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>        <a href="fe-exec.c.html#LN507"><span class='Ref_To_Local'>space</span></a> <span class='Operator'>= </span><a href="fe-exec.c.html#LN508"><span class='Ref_To_Local'>block</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN105"><span class='Ref_to_Member'>space</span></a> <span class='Operator'>+ </span><a href="fe-exec.c.html#LN128"><span class='Ref_to_Const'>PGRESULT_BLOCK_OVERHEAD</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN505"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN207"><span class='Ref_to_Member'>curBlock</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* 
             * Tuck special block below the active block, so that we don't 
             * have to waste the free space in the active block. 
             */ 
</span>            <a href="fe-exec.c.html#LN508"><span class='Ref_To_Local'>block</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN104"><span class='Ref_to_Member'>next</span></a> <span class='Operator'>= </span><a href="fe-exec.c.html#LN505"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN207"><span class='Ref_to_Member'>curBlock</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN104"><span class='Ref_to_Member'>next</span></a><span class='Delimiter'>; 
</span>            <a href="fe-exec.c.html#LN505"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN207"><span class='Ref_to_Member'>curBlock</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN104"><span class='Ref_to_Member'>next</span></a> <span class='Operator'>= </span><a href="fe-exec.c.html#LN508"><span class='Ref_To_Local'>block</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* Must set up the new block as the first active block. */ 
</span>            <a href="fe-exec.c.html#LN508"><span class='Ref_To_Local'>block</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN104"><span class='Ref_to_Member'>next</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>            <a href="fe-exec.c.html#LN505"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN207"><span class='Ref_to_Member'>curBlock</span></a> <span class='Operator'>= </span><a href="fe-exec.c.html#LN508"><span class='Ref_To_Local'>block</span></a><span class='Delimiter'>; 
</span>            <a href="fe-exec.c.html#LN505"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN209"><span class='Ref_to_Member'>spaceLeft</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><span class='Comment_Single_Line'>/* be sure it's marked full */ 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>return</span> <a href="fe-exec.c.html#LN507"><span class='Ref_To_Local'>space</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if nBytes&GT;=PGRESULT_SEP_... &raquo; </span> 
 
    <span class='Comment_Multi_Line'>/* Otherwise, start a new block. */ 
</span>    <a href="fe-exec.c.html#LN508"><span class='Ref_To_Local'>block</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="libpq-int.h.html#LN100"><span class='Ref_to_Typedef'>PGresult_data</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/snowball/header.h.html#LN49"><span class='Ref_to_Macro'>malloc</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN126"><span class='Ref_to_Const'>PGRESULT_DATA_BLOCKSIZE</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="fe-exec.c.html#LN508"><span class='Ref_To_Local'>block</span></a><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="fe-exec.c.html#LN508"><span class='Ref_To_Local'>block</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN104"><span class='Ref_to_Member'>next</span></a> <span class='Operator'>= </span><a href="fe-exec.c.html#LN505"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN207"><span class='Ref_to_Member'>curBlock</span></a><span class='Delimiter'>; 
</span>    <a href="fe-exec.c.html#LN505"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN207"><span class='Ref_to_Member'>curBlock</span></a> <span class='Operator'>= </span><a href="fe-exec.c.html#LN508"><span class='Ref_To_Local'>block</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN505"><span class='Ref_to_Parameter'>isBinary</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* object needs full alignment */ 
</span>        <a href="fe-exec.c.html#LN505"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN208"><span class='Ref_to_Member'>curOffset</span></a> <span class='Operator'>= </span><a href="fe-exec.c.html#LN128"><span class='Ref_to_Const'>PGRESULT_BLOCK_OVERHEAD</span></a><span class='Delimiter'>; 
</span>        <a href="fe-exec.c.html#LN505"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN209"><span class='Ref_to_Member'>spaceLeft</span></a> <span class='Operator'>= </span><a href="fe-exec.c.html#LN126"><span class='Ref_to_Const'>PGRESULT_DATA_BLOCKSIZE</span></a> <span class='Operator'>- </span><a href="fe-exec.c.html#LN128"><span class='Ref_to_Const'>PGRESULT_BLOCK_OVERHEAD</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* we can cram it right after the overhead pointer */ 
</span>        <a href="fe-exec.c.html#LN505"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN208"><span class='Ref_to_Member'>curOffset</span></a> <span class='Operator'>= </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="libpq-int.h.html#LN100"><span class='Ref_to_Typedef'>PGresult_data</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="fe-exec.c.html#LN505"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN209"><span class='Ref_to_Member'>spaceLeft</span></a> <span class='Operator'>= </span><a href="fe-exec.c.html#LN126"><span class='Ref_to_Const'>PGRESULT_DATA_BLOCKSIZE</span></a> <span class='Operator'>- </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="libpq-int.h.html#LN100"><span class='Ref_to_Typedef'>PGresult_data</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="fe-exec.c.html#LN507"><span class='Ref_To_Local'>space</span></a> <span class='Operator'>= </span><a href="fe-exec.c.html#LN508"><span class='Ref_To_Local'>block</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN105"><span class='Ref_to_Member'>space</span></a> <span class='Operator'>+ </span><a href="fe-exec.c.html#LN505"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN208"><span class='Ref_to_Member'>curOffset</span></a><span class='Delimiter'>; 
</span>    <a href="fe-exec.c.html#LN505"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN208"><span class='Ref_to_Member'>curOffset</span></a> <span class='Operator'>+= </span><a href="fe-exec.c.html#LN505"><span class='Ref_to_Parameter'>nBytes</span></a><span class='Delimiter'>; 
</span>    <a href="fe-exec.c.html#LN505"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN209"><span class='Ref_to_Member'>spaceLeft</span></a> <span class='Operator'>-= </span><a href="fe-exec.c.html#LN505"><span class='Ref_to_Parameter'>nBytes</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <a href="fe-exec.c.html#LN507"><span class='Ref_To_Local'>space</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end pqResultAlloc &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * pqResultStrdup - 
 *      Like strdup, but the space is subsidiary PGresult space. 
 */ 
</span><span class='Keyword'>char </span><span class='Operator'>* 
</span><a name="LN601"></a><span class='Declare_Function'>pqResultStrdup</span><span class='Parentheses'>(</span><a href="libpq-fe.h.html#LN146"><span class='Ref_to_Typedef'>PGresult</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>res</span><span class='Delimiter'>, </span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>str</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN603"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>space</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Keyword'>char </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="fe-exec.c.html#LN504"><span class='Ref_to_Func'>pqResultAlloc</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN601"><span class='Ref_to_Parameter'>res</span></a><span class='Delimiter'>, </span>strlen<span class='Parentheses'>(</span><a href="fe-exec.c.html#LN601"><span class='Ref_to_Parameter'>str</span></a><span class='Parentheses'>) </span><span class='Operator'>+ </span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Boolean'>FALSE</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN603"><span class='Ref_To_Local'>space</span></a><span class='Parentheses'>) 
</span>        <a href="../../../contrib/cube/cubeparse.y.html#LN150"><span class='Ref_to_Proto'>strcpy</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN603"><span class='Ref_To_Local'>space</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN601"><span class='Ref_to_Parameter'>str</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <a href="fe-exec.c.html#LN603"><span class='Ref_To_Local'>space</span></a><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * pqSetResultError - 
 *      assign a new error message to a PGresult 
 */ 
</span><span class='Keyword'>void 
</span><a name="LN615"></a><span class='Declare_Function'>pqSetResultError</span><span class='Parentheses'>(</span><a href="libpq-fe.h.html#LN146"><span class='Ref_to_Typedef'>PGresult</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>res</span><span class='Delimiter'>, </span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>msg</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="fe-exec.c.html#LN615"><span class='Ref_to_Parameter'>res</span></a><span class='Parentheses'>) 
</span>        <span class='Control'>return</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN615"><span class='Ref_to_Parameter'>msg</span></a> <span class='Operator'>&& *</span><a href="fe-exec.c.html#LN615"><span class='Ref_to_Parameter'>msg</span></a><span class='Parentheses'>) 
</span>        <a href="fe-exec.c.html#LN615"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN195"><span class='Ref_to_Member'>errMsg</span></a> <span class='Operator'>= </span><a href="libpq-int.h.html#LN570"><span class='Ref_to_Proto'>pqResultStrdup</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN615"><span class='Ref_to_Parameter'>res</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN615"><span class='Ref_to_Parameter'>msg</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
        <a href="fe-exec.c.html#LN615"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN195"><span class='Ref_to_Member'>errMsg</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * pqCatenateResultError - 
 *      concatenate a new error message to the one already in a PGresult 
 */ 
</span><span class='Keyword'>void 
</span><a name="LN630"></a><span class='Declare_Function'>pqCatenateResultError</span><span class='Parentheses'>(</span><a href="libpq-fe.h.html#LN146"><span class='Ref_to_Typedef'>PGresult</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>res</span><span class='Delimiter'>, </span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>msg</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN632"></a>    <a href="pqexpbuffer.h.html#LN43"><span class='Ref_to_Struct'>PQExpBufferData</span></a> <span class='Declare_Local'>errorBuf</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="fe-exec.c.html#LN630"><span class='Ref_to_Parameter'>res</span></a> <span class='Operator'>|| !</span><a href="fe-exec.c.html#LN630"><span class='Ref_to_Parameter'>msg</span></a><span class='Parentheses'>) 
</span>        <span class='Control'>return</span><span class='Delimiter'>; 
</span>    <a href="pqexpbuffer.c.html#LN87"><span class='Ref_to_Func'>initPQExpBuffer</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="fe-exec.c.html#LN632"><span class='Ref_To_Local'>errorBuf</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN630"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN195"><span class='Ref_to_Member'>errMsg</span></a><span class='Parentheses'>) 
</span>        <a href="pqexpbuffer.h.html#LN164"><span class='Ref_to_Proto'>appendPQExpBufferStr</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="fe-exec.c.html#LN632"><span class='Ref_To_Local'>errorBuf</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN630"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN195"><span class='Ref_to_Member'>errMsg</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="pqexpbuffer.h.html#LN164"><span class='Ref_to_Proto'>appendPQExpBufferStr</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="fe-exec.c.html#LN632"><span class='Ref_To_Local'>errorBuf</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN630"><span class='Ref_to_Parameter'>msg</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="libpq-int.h.html#LN567"><span class='Ref_to_Proto'>pqSetResultError</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN630"><span class='Ref_to_Parameter'>res</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN632"><span class='Ref_To_Local'>errorBuf</span></a><span class='Operator'>.</span><a href="pqexpbuffer.h.html#LN45"><span class='Ref_to_Member'>data</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="pqexpbuffer.h.html#LN121"><span class='Ref_to_Proto'>termPQExpBuffer</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="fe-exec.c.html#LN632"><span class='Ref_To_Local'>errorBuf</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * PQclear - 
 *    free's the memory associated with a PGresult 
 */ 
</span><span class='Keyword'>void 
</span><a name="LN649"></a><span class='Declare_Function'>PQclear</span><span class='Parentheses'>(</span><a href="libpq-fe.h.html#LN146"><span class='Ref_to_Typedef'>PGresult</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>res</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN651"></a>    <a href="libpq-int.h.html#LN100"><span class='Ref_to_Typedef'>PGresult_data</span></a> <span class='Operator'>*</span><span class='Declare_Local'>block</span><span class='Delimiter'>; 
</span><a name="LN652"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>i</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="fe-exec.c.html#LN649"><span class='Ref_to_Parameter'>res</span></a><span class='Parentheses'>) 
</span>        <span class='Control'>return</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN652"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="fe-exec.c.html#LN652"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="fe-exec.c.html#LN649"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN187"><span class='Ref_to_Member'>nEvents</span></a><span class='Delimiter'>; </span><a href="fe-exec.c.html#LN652"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* only send DESTROY to successfully-initialized event procs */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN649"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN186"><span class='Ref_to_Member'>events</span></a><span class='Delimiter'>[</span><a href="fe-exec.c.html#LN652"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="libpq-int.h.html#LN163"><span class='Ref_to_Member'>resultInitialized</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span><a name="LN662"></a>            <a href="libpq-events.h.html#LN63"><span class='Ref_to_Typedef'>PGEventResultDestroy</span></a> <span class='Declare_Local'>evt</span><span class='Delimiter'>; 
</span> 
            <a href="fe-exec.c.html#LN662"><span class='Ref_To_Local'>evt</span></a><span class='Operator'>.</span><a href="libpq-events.h.html#LN65"><span class='Ref_to_Member'>result</span></a> <span class='Operator'>= </span><a href="fe-exec.c.html#LN649"><span class='Ref_to_Parameter'>res</span></a><span class='Delimiter'>; 
</span>            <span class='Parentheses'>(</span><span class='Keyword'>void</span><span class='Parentheses'>) </span><a href="fe-exec.c.html#LN649"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN186"><span class='Ref_to_Member'>events</span></a><span class='Delimiter'>[</span><a href="fe-exec.c.html#LN652"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="libpq-int.h.html#LN159"><span class='Ref_to_Member'>proc</span></a><span class='Parentheses'>(</span><a href="libpq-events.h.html#LN33"><span class='Ref_to_EnumConst'>PGEVT_RESULTDESTROY</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="fe-exec.c.html#LN662"><span class='Ref_To_Local'>evt</span></a><span class='Delimiter'>, 
</span>                                       <a href="fe-exec.c.html#LN649"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN186"><span class='Ref_to_Member'>events</span></a><span class='Delimiter'>[</span><a href="fe-exec.c.html#LN652"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="libpq-int.h.html#LN161"><span class='Ref_to_Member'>passThrough</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <a href="../../include/snowball/header.h.html#LN64"><span class='Ref_to_Macro'>free</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN649"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN186"><span class='Ref_to_Member'>events</span></a><span class='Delimiter'>[</span><a href="fe-exec.c.html#LN652"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="libpq-int.h.html#LN160"><span class='Ref_to_Member'>name</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN649"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN186"><span class='Ref_to_Member'>events</span></a><span class='Parentheses'>) 
</span>        <a href="../../include/snowball/header.h.html#LN64"><span class='Ref_to_Macro'>free</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN649"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN186"><span class='Ref_to_Member'>events</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Free all the subsidiary blocks */ 
</span>    <span class='Control'>while</span> <span class='Parentheses'>((</span><a href="fe-exec.c.html#LN651"><span class='Ref_To_Local'>block</span></a> <span class='Operator'>= </span><a href="fe-exec.c.html#LN649"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN207"><span class='Ref_to_Member'>curBlock</span></a><span class='Parentheses'>) </span><span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span> 
    <span class='Delimiter'>{ 
</span>        <a href="fe-exec.c.html#LN649"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN207"><span class='Ref_to_Member'>curBlock</span></a> <span class='Operator'>= </span><a href="fe-exec.c.html#LN651"><span class='Ref_To_Local'>block</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN104"><span class='Ref_to_Member'>next</span></a><span class='Delimiter'>; 
</span>        <a href="../../include/snowball/header.h.html#LN64"><span class='Ref_to_Macro'>free</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN651"><span class='Ref_To_Local'>block</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* Free the top-level tuple pointer array */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN649"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN171"><span class='Ref_to_Member'>tuples</span></a><span class='Parentheses'>) 
</span>        <a href="../../include/snowball/header.h.html#LN64"><span class='Ref_to_Macro'>free</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN649"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN171"><span class='Ref_to_Member'>tuples</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* zero out the pointer fields to catch programming errors */ 
</span>    <a href="fe-exec.c.html#LN649"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN170"><span class='Ref_to_Member'>attDescs</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="fe-exec.c.html#LN649"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN171"><span class='Ref_to_Member'>tuples</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="fe-exec.c.html#LN649"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN175"><span class='Ref_to_Member'>paramDescs</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="fe-exec.c.html#LN649"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN196"><span class='Ref_to_Member'>errFields</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="fe-exec.c.html#LN649"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN186"><span class='Ref_to_Member'>events</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="fe-exec.c.html#LN649"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN187"><span class='Ref_to_Member'>nEvents</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <span class='Comment_Multi_Line'>/* res-&GT;curBlock was zeroed out earlier */ 
</span> 
    <span class='Comment_Multi_Line'>/* Free the PGresult structure itself */ 
</span>    <a href="../../include/snowball/header.h.html#LN64"><span class='Ref_to_Macro'>free</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN649"><span class='Ref_to_Parameter'>res</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end PQclear &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * Handy subroutine to deallocate any partially constructed async result. 
 * 
 * Any "next" result gets cleared too. 
 */ 
</span><span class='Keyword'>void 
</span><a name="LN704"></a><span class='Declare_Function'>pqClearAsyncResult</span><span class='Parentheses'>(</span><a href="libpq-fe.h.html#LN139"><span class='Ref_to_Typedef'>PGconn</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>conn</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN704"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN450"><span class='Ref_to_Member'>result</span></a><span class='Parentheses'>) 
</span>        <a href="libpq-fe.h.html#LN501"><span class='Ref_to_Proto'>PQclear</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN704"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN450"><span class='Ref_to_Member'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="fe-exec.c.html#LN704"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN450"><span class='Ref_to_Member'>result</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN704"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN451"><span class='Ref_to_Member'>next_result</span></a><span class='Parentheses'>) 
</span>        <a href="libpq-fe.h.html#LN501"><span class='Ref_to_Proto'>PQclear</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN704"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN451"><span class='Ref_to_Member'>next_result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="fe-exec.c.html#LN704"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN451"><span class='Ref_to_Member'>next_result</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * This subroutine deletes any existing async result, sets conn-&GT;result 
 * to a PGresult with status PGRES_FATAL_ERROR, and stores the current 
 * contents of conn-&GT;errorMessage into that result.  It differs from a 
 * plain call on PQmakeEmptyPGresult() in that if there is already an 
 * async result with status PGRES_FATAL_ERROR, the current error message 
 * is APPENDED to the old error message instead of replacing it.  This 
 * behavior lets us report multiple error conditions properly, if necessary. 
 * (An example where this is needed is when the backend sends an 'E' message 
 * and immediately closes the connection --- we want to report both the 
 * backend error and the connection closure error.) 
 */ 
</span><span class='Keyword'>void 
</span><a name="LN727"></a><span class='Declare_Function'>pqSaveErrorResult</span><span class='Parentheses'>(</span><a href="libpq-fe.h.html#LN139"><span class='Ref_to_Typedef'>PGconn</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>conn</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Comment_Multi_Line'>/* 
     * If no old async result, just let PQmakeEmptyPGresult make one. Likewise 
     * if old result is not an error message. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN727"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN450"><span class='Ref_to_Member'>result</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL </span><span class='Operator'>|| 
</span>        <a href="fe-exec.c.html#LN727"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN450"><span class='Ref_to_Member'>result</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN176"><span class='Ref_to_Member'>resultStatus</span></a> <span class='Operator'>!= </span><a href="libpq-fe.h.html#LN95"><span class='Ref_to_EnumConst'>PGRES_FATAL_ERROR</span></a> <span class='Operator'>|| 
</span>        <a href="fe-exec.c.html#LN727"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN450"><span class='Ref_to_Member'>result</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN195"><span class='Ref_to_Member'>errMsg</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="libpq-int.h.html#LN571"><span class='Ref_to_Proto'>pqClearAsyncResult</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN727"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="fe-exec.c.html#LN727"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN450"><span class='Ref_to_Member'>result</span></a> <span class='Operator'>= </span><a href="fe-exec.c.html#LN138"><span class='Ref_to_Func'>PQmakeEmptyPGresult</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN727"><span class='Ref_to_Parameter'>conn</span></a><span class='Delimiter'>, </span><a href="libpq-fe.h.html#LN95"><span class='Ref_to_EnumConst'>PGRES_FATAL_ERROR</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* Else, concatenate error message to existing async result. */ 
</span>        <a href="libpq-int.h.html#LN568"><span class='Ref_to_Proto'>pqCatenateResultError</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN727"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN450"><span class='Ref_to_Member'>result</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN727"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN491"><span class='Ref_to_Member'>errorMessage</span></a><span class='Operator'>.</span><a href="pqexpbuffer.h.html#LN45"><span class='Ref_to_Member'>data</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
}</span><span class='Auto_Annotations'> &laquo; end pqSaveErrorResult &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * This subroutine prepares an async result object for return to the caller. 
 * If there is not already an async result object, build an error object 
 * using whatever is in conn-&GT;errorMessage.  In any case, clear the async 
 * result storage and make sure PQerrorMessage will agree with the result's 
 * error string. 
 */ 
</span><a href="libpq-fe.h.html#LN146"><span class='Ref_to_Typedef'>PGresult</span></a> <span class='Operator'>* 
</span><a name="LN755"></a><span class='Declare_Function'>pqPrepareAsyncResult</span><span class='Parentheses'>(</span><a href="libpq-fe.h.html#LN139"><span class='Ref_to_Typedef'>PGconn</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>conn</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN757"></a>    <a href="libpq-fe.h.html#LN146"><span class='Ref_to_Typedef'>PGresult</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>res</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * conn-&GT;result is the PGresult to return.  If it is NULL (which probably 
     * shouldn't happen) we assume there is an appropriate error message in 
     * conn-&GT;errorMessage. 
     */ 
</span>    <a href="fe-exec.c.html#LN757"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="fe-exec.c.html#LN755"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN450"><span class='Ref_to_Member'>result</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="fe-exec.c.html#LN757"><span class='Ref_To_Local'>res</span></a><span class='Parentheses'>) 
</span>        <a href="fe-exec.c.html#LN757"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="fe-exec.c.html#LN138"><span class='Ref_to_Func'>PQmakeEmptyPGresult</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN755"><span class='Ref_to_Parameter'>conn</span></a><span class='Delimiter'>, </span><a href="libpq-fe.h.html#LN95"><span class='Ref_to_EnumConst'>PGRES_FATAL_ERROR</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* 
         * Make sure PQerrorMessage agrees with result; it could be different 
         * if we have concatenated messages. 
         */ 
</span>        <a href="pqexpbuffer.h.html#LN129"><span class='Ref_to_Proto'>resetPQExpBuffer</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="fe-exec.c.html#LN755"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN491"><span class='Ref_to_Member'>errorMessage</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="pqexpbuffer.h.html#LN164"><span class='Ref_to_Proto'>appendPQExpBufferStr</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="fe-exec.c.html#LN755"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN491"><span class='Ref_to_Member'>errorMessage</span></a><span class='Delimiter'>, 
</span>                             <a href="libpq-fe.h.html#LN468"><span class='Ref_to_Proto'>PQresultErrorMessage</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN757"><span class='Ref_To_Local'>res</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Replace conn-&GT;result with next_result, if any.  In the normal case 
     * there isn't a next result and we're just dropping ownership of the 
     * current result.  In single-row mode this restores the situation to what 
     * it was before we created the current single-row result. 
     */ 
</span>    <a href="fe-exec.c.html#LN755"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN450"><span class='Ref_to_Member'>result</span></a> <span class='Operator'>= </span><a href="fe-exec.c.html#LN755"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN451"><span class='Ref_to_Member'>next_result</span></a><span class='Delimiter'>; 
</span>    <a href="fe-exec.c.html#LN755"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN451"><span class='Ref_to_Member'>next_result</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="fe-exec.c.html#LN757"><span class='Ref_To_Local'>res</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end pqPrepareAsyncResult &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * pqInternalNotice - produce an internally-generated notice message 
 * 
 * A format string and optional arguments can be passed.  Note that we do 
 * libpq_gettext() here, so callers need not. 
 * 
 * The supplied text is taken as primary message (ie., it should not include 
 * a trailing newline, and should not be more than one line). 
 */ 
</span><span class='Keyword'>void 
</span><a name="LN800"></a><span class='Declare_Function'>pqInternalNotice</span><span class='Parentheses'>(</span><span class='Keyword'>const </span><a href="libpq-int.h.html#LN149"><span class='Ref_to_Typedef'>PGNoticeHooks</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>hooks</span><span class='Delimiter'>, </span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>fmt</span><span class='Delimiter'>,</span><span class='Operator'>...</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN802"></a>    <span class='Keyword'>char</span>        <span class='Declare_Local'>msgBuf</span><span class='Delimiter'>[</span><span class='Number'>1024</span><span class='Delimiter'>]; 
</span><a name="LN803"></a>    va_list     <span class='Declare_Local'>args</span><span class='Delimiter'>; 
</span><a name="LN804"></a>    <a href="libpq-fe.h.html#LN146"><span class='Ref_to_Typedef'>PGresult</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>res</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN800"><span class='Ref_to_Parameter'>hooks</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN151"><span class='Ref_to_Member'>noticeRec</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>        <span class='Control'>return</span><span class='Delimiter'>;</span>                 <span class='Comment_Single_Line'>/* nobody home to receive notice? */ 
</span> 
    <span class='Comment_Multi_Line'>/* Format the message */ 
</span>    <a href="../../pl/plperl/ppport.h.html#LN5587"><span class='Ref_to_Proto'>va_start</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN803"><span class='Ref_To_Local'>args</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN800"><span class='Ref_to_Parameter'>fmt</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../pl/plperl/plperl.h.html#LN59"><span class='Ref_to_Macro'>vsnprintf</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN802"><span class='Ref_To_Local'>msgBuf</span></a><span class='Delimiter'>, </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN802"><span class='Ref_To_Local'>msgBuf</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="win32.c.html#LN36"><span class='Ref_to_Func'>libpq_gettext</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN800"><span class='Ref_to_Parameter'>fmt</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN803"><span class='Ref_To_Local'>args</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../../pl/plperl/ppport.h.html#LN5589"><span class='Ref_to_Proto'>va_end</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN803"><span class='Ref_To_Local'>args</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="fe-exec.c.html#LN802"><span class='Ref_To_Local'>msgBuf</span></a><span class='Delimiter'>[</span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN802"><span class='Ref_To_Local'>msgBuf</span></a><span class='Parentheses'>) </span><span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='String'>'\0'</span><span class='Delimiter'>;</span>  <span class='Comment_Single_Line'>/* make real sure it's terminated */ 
</span> 
    <span class='Comment_Multi_Line'>/* Make a PGresult to pass to the notice receiver */ 
</span>    <a href="fe-exec.c.html#LN804"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="fe-exec.c.html#LN138"><span class='Ref_to_Func'>PQmakeEmptyPGresult</span></a><span class='Parentheses'>(</span><span class='Null_Value'>NULL</span><span class='Delimiter'>, </span><a href="libpq-fe.h.html#LN94"><span class='Ref_to_EnumConst'>PGRES_NONFATAL_ERROR</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="fe-exec.c.html#LN804"><span class='Ref_To_Local'>res</span></a><span class='Parentheses'>) 
</span>        <span class='Control'>return</span><span class='Delimiter'>; 
</span>    <a href="fe-exec.c.html#LN804"><span class='Ref_To_Local'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN185"><span class='Ref_to_Member'>noticeHooks</span></a> <span class='Operator'>= *</span><a href="fe-exec.c.html#LN800"><span class='Ref_to_Parameter'>hooks</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Set up fields of notice. 
     */ 
</span>    <a href="libpq-int.h.html#LN575"><span class='Ref_to_Proto'>pqSaveMessageField</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN804"><span class='Ref_To_Local'>res</span></a><span class='Delimiter'>, </span><a href="../../include/postgres_ext.h.html#LN57"><span class='Ref_to_Const'>PG_DIAG_MESSAGE_PRIMARY</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN802"><span class='Ref_To_Local'>msgBuf</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="libpq-int.h.html#LN575"><span class='Ref_to_Proto'>pqSaveMessageField</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN804"><span class='Ref_To_Local'>res</span></a><span class='Delimiter'>, </span><a href="../../include/postgres_ext.h.html#LN54"><span class='Ref_to_Const'>PG_DIAG_SEVERITY</span></a><span class='Delimiter'>, </span><a href="win32.c.html#LN36"><span class='Ref_to_Func'>libpq_gettext</span></a><span class='Parentheses'>(</span><span class='String'>"NOTICE"</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <a href="libpq-int.h.html#LN575"><span class='Ref_to_Proto'>pqSaveMessageField</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN804"><span class='Ref_To_Local'>res</span></a><span class='Delimiter'>, </span><a href="../../include/postgres_ext.h.html#LN55"><span class='Ref_to_Const'>PG_DIAG_SEVERITY_NONLOCALIZED</span></a><span class='Delimiter'>, </span><span class='String'>"NOTICE"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Comment_Multi_Line'>/* XXX should provide a SQLSTATE too? */ 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Result text is always just the primary message + newline. If we can't 
     * allocate it, don't bother invoking the receiver. 
     */ 
</span>    <a href="fe-exec.c.html#LN804"><span class='Ref_To_Local'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN195"><span class='Ref_to_Member'>errMsg</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Keyword'>char </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="fe-exec.c.html#LN504"><span class='Ref_to_Func'>pqResultAlloc</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN804"><span class='Ref_To_Local'>res</span></a><span class='Delimiter'>, </span>strlen<span class='Parentheses'>(</span><a href="fe-exec.c.html#LN802"><span class='Ref_To_Local'>msgBuf</span></a><span class='Parentheses'>) </span><span class='Operator'>+ </span><span class='Number'>2</span><span class='Delimiter'>, </span><span class='Boolean'>FALSE</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN804"><span class='Ref_To_Local'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN195"><span class='Ref_to_Member'>errMsg</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="../../include/port.h.html#LN170"><span class='Ref_to_Macro'>sprintf</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN804"><span class='Ref_To_Local'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN195"><span class='Ref_to_Member'>errMsg</span></a><span class='Delimiter'>, </span><span class='String'>"%s\n"</span><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN802"><span class='Ref_To_Local'>msgBuf</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * Pass to receiver, then free it. 
         */ 
</span>        <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="fe-exec.c.html#LN804"><span class='Ref_To_Local'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN185"><span class='Ref_to_Member'>noticeHooks</span></a><span class='Operator'>.</span><a href="libpq-int.h.html#LN151"><span class='Ref_to_Member'>noticeRec</span></a><span class='Parentheses'>) (</span><a href="fe-exec.c.html#LN804"><span class='Ref_To_Local'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN185"><span class='Ref_to_Member'>noticeHooks</span></a><span class='Operator'>.</span><a href="libpq-int.h.html#LN152"><span class='Ref_to_Member'>noticeRecArg</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN804"><span class='Ref_To_Local'>res</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <a href="libpq-fe.h.html#LN501"><span class='Ref_to_Proto'>PQclear</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN804"><span class='Ref_To_Local'>res</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end pqInternalNotice &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * pqAddTuple 
 *    add a row pointer to the PGresult structure, growing it if necessary 
 *    Returns TRUE if OK, FALSE if not enough memory to add the row 
 */ 
</span><span class='Keyword'>static bool 
</span><a name="LN852"></a><span class='Declare_Function'>pqAddTuple</span><span class='Parentheses'>(</span><a href="libpq-fe.h.html#LN146"><span class='Ref_to_Typedef'>PGresult</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>res</span><span class='Delimiter'>, </span><a href="libpq-int.h.html#LN134"><span class='Ref_to_Typedef'>PGresAttValue</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>tup</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN852"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN168"><span class='Ref_to_Member'>ntups</span></a> <span class='Operator'>&GT;= </span><a href="fe-exec.c.html#LN852"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN173"><span class='Ref_to_Member'>tupArrSize</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* 
         * Try to grow the array. 
         * 
         * We can use realloc because shallow copying of the structure is 
         * okay. Note that the first time through, res-&GT;tuples is NULL. While 
         * ANSI says that realloc() should act like malloc() in that case, 
         * some old C libraries (like SunOS 4.1.x) coredump instead. On 
         * failure realloc is supposed to return NULL without damaging the 
         * existing allocation. Note that the positions beyond res-&GT;ntups are 
         * garbage, not necessarily NULL. 
         */ 
</span><a name="LN867"></a>        <span class='Keyword'>int</span>         <span class='Declare_Local'>newSize</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN852"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN173"><span class='Ref_to_Member'>tupArrSize</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>) </span><span class='Operator'>? </span><a href="fe-exec.c.html#LN852"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN173"><span class='Ref_to_Member'>tupArrSize</span></a> <span class='Operator'>* </span><span class='Number'>2</span> <span class='Operator'>: </span><span class='Number'>128</span><span class='Delimiter'>; 
</span><a name="LN868"></a>        <a href="libpq-int.h.html#LN134"><span class='Ref_to_Typedef'>PGresAttValue</span></a> <span class='Operator'>**</span><span class='Declare_Local'>newTuples</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN852"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN171"><span class='Ref_to_Member'>tuples</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>            <a href="fe-exec.c.html#LN868"><span class='Ref_To_Local'>newTuples</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="libpq-int.h.html#LN134"><span class='Ref_to_Typedef'>PGresAttValue</span></a> <span class='Operator'>**</span><span class='Parentheses'>) 
</span>                <a href="../../include/snowball/header.h.html#LN49"><span class='Ref_to_Macro'>malloc</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN867"><span class='Ref_To_Local'>newSize</span></a> <span class='Operator'>* </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="libpq-int.h.html#LN134"><span class='Ref_to_Typedef'>PGresAttValue</span></a> <span class='Operator'>*</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> 
            <a href="fe-exec.c.html#LN868"><span class='Ref_To_Local'>newTuples</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="libpq-int.h.html#LN134"><span class='Ref_to_Typedef'>PGresAttValue</span></a> <span class='Operator'>**</span><span class='Parentheses'>) 
</span>                <a href="../../include/snowball/header.h.html#LN59"><span class='Ref_to_Macro'>realloc</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN852"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN171"><span class='Ref_to_Member'>tuples</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN867"><span class='Ref_To_Local'>newSize</span></a> <span class='Operator'>* </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="libpq-int.h.html#LN134"><span class='Ref_to_Typedef'>PGresAttValue</span></a> <span class='Operator'>*</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="fe-exec.c.html#LN868"><span class='Ref_To_Local'>newTuples</span></a><span class='Parentheses'>) 
</span>            <span class='Control'>return</span> <span class='Boolean'>FALSE</span><span class='Delimiter'>;</span>       <span class='Comment_Single_Line'>/* malloc or realloc failed */ 
</span>        <a href="fe-exec.c.html#LN852"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN173"><span class='Ref_to_Member'>tupArrSize</span></a> <span class='Operator'>= </span><a href="fe-exec.c.html#LN867"><span class='Ref_To_Local'>newSize</span></a><span class='Delimiter'>; 
</span>        <a href="fe-exec.c.html#LN852"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN171"><span class='Ref_to_Member'>tuples</span></a> <span class='Operator'>= </span><a href="fe-exec.c.html#LN868"><span class='Ref_To_Local'>newTuples</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if res-&GT;ntups&GT;=res-&GT;tupA... &raquo; </span> 
    <a href="fe-exec.c.html#LN852"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN171"><span class='Ref_to_Member'>tuples</span></a><span class='Delimiter'>[</span><a href="fe-exec.c.html#LN852"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN168"><span class='Ref_to_Member'>ntups</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="fe-exec.c.html#LN852"><span class='Ref_to_Parameter'>tup</span></a><span class='Delimiter'>; 
</span>    <a href="fe-exec.c.html#LN852"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN168"><span class='Ref_to_Member'>ntups</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <span class='Boolean'>TRUE</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end pqAddTuple &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * pqSaveMessageField - save one field of an error or notice message 
 */ 
</span><span class='Keyword'>void 
</span><a name="LN890"></a><span class='Declare_Function'>pqSaveMessageField</span><span class='Parentheses'>(</span><a href="libpq-fe.h.html#LN146"><span class='Ref_to_Typedef'>PGresult</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>res</span><span class='Delimiter'>, </span><span class='Keyword'>char </span><span class='Declare_Parameter'>code</span><span class='Delimiter'>, </span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>value</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN892"></a>    <a href="libpq-int.h.html#LN141"><span class='Ref_to_Typedef'>PGMessageField</span></a> <span class='Operator'>*</span><span class='Declare_Local'>pfield</span><span class='Delimiter'>; 
</span> 
    <a href="fe-exec.c.html#LN892"><span class='Ref_To_Local'>pfield</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="libpq-int.h.html#LN141"><span class='Ref_to_Typedef'>PGMessageField</span></a> <span class='Operator'>*</span><span class='Parentheses'>) 
</span>        <a href="fe-exec.c.html#LN504"><span class='Ref_to_Func'>pqResultAlloc</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN890"><span class='Ref_to_Parameter'>res</span></a><span class='Delimiter'>, 
</span>                      <a href="../../include/c.h.html#LN554"><span class='Ref_to_Macro'>offsetof</span></a><span class='Parentheses'>(</span><a href="libpq-int.h.html#LN141"><span class='Ref_to_Typedef'>PGMessageField</span></a><span class='Delimiter'>, </span>contents<span class='Parentheses'>) </span><span class='Operator'>+ 
</span>                      strlen<span class='Parentheses'>(</span><span class='Keyword'>value</span><span class='Parentheses'>) </span><span class='Operator'>+ </span><span class='Number'>1</span><span class='Delimiter'>, 
</span>                      <span class='Boolean'>TRUE</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="fe-exec.c.html#LN892"><span class='Ref_To_Local'>pfield</span></a><span class='Parentheses'>) 
</span>        <span class='Control'>return</span><span class='Delimiter'>;</span>                 <span class='Comment_Single_Line'>/* out of memory? */ 
</span>    <a href="fe-exec.c.html#LN892"><span class='Ref_To_Local'>pfield</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN144"><span class='Ref_to_Member'>code</span></a> <span class='Operator'>= </span><a href="fe-exec.c.html#LN890"><span class='Ref_to_Parameter'>code</span></a><span class='Delimiter'>; 
</span>    <a href="../../../contrib/cube/cubeparse.y.html#LN150"><span class='Ref_to_Proto'>strcpy</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN892"><span class='Ref_To_Local'>pfield</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN145"><span class='Ref_to_Member'>contents</span></a><span class='Delimiter'>, </span><span class='Keyword'>value</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="fe-exec.c.html#LN892"><span class='Ref_To_Local'>pfield</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN143"><span class='Ref_to_Member'>next</span></a> <span class='Operator'>= </span><a href="fe-exec.c.html#LN890"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN196"><span class='Ref_to_Member'>errFields</span></a><span class='Delimiter'>; 
</span>    <a href="fe-exec.c.html#LN890"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN196"><span class='Ref_to_Member'>errFields</span></a> <span class='Operator'>= </span><a href="fe-exec.c.html#LN892"><span class='Ref_To_Local'>pfield</span></a><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * pqSaveParameterStatus - remember parameter status sent by backend 
 */ 
</span><span class='Keyword'>void 
</span><a name="LN911"></a><span class='Declare_Function'>pqSaveParameterStatus</span><span class='Parentheses'>(</span><a href="libpq-fe.h.html#LN139"><span class='Ref_to_Typedef'>PGconn</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>conn</span><span class='Delimiter'>, </span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>name</span><span class='Delimiter'>, </span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>value</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN913"></a>    <a href="libpq-int.h.html#LN255"><span class='Ref_to_Struct'>pgParameterStatus</span></a> <span class='Operator'>*</span><span class='Declare_Local'>pstatus</span><span class='Delimiter'>; 
</span><a name="LN914"></a>    <a href="libpq-int.h.html#LN255"><span class='Ref_to_Struct'>pgParameterStatus</span></a> <span class='Operator'>*</span><span class='Declare_Local'>prev</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN911"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN366"><span class='Ref_to_Member'>Pfdebug</span></a><span class='Parentheses'>) 
</span>        <a href="../../../contrib/seg/segscan.l.html#LN10"><span class='Ref_to_Macro'>fprintf</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN911"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN366"><span class='Ref_to_Member'>Pfdebug</span></a><span class='Delimiter'>, </span><span class='String'>"pqSaveParameterStatus: '%s' = '%s'\n"</span><span class='Delimiter'>, 
</span>                <a href="fe-exec.c.html#LN911"><span class='Ref_to_Parameter'>name</span></a><span class='Delimiter'>, </span><span class='Keyword'>value</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Forget any old information about the parameter 
     */ 
</span>    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN913"><span class='Ref_To_Local'>pstatus</span></a> <span class='Operator'>= </span><a href="fe-exec.c.html#LN911"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN421"><span class='Ref_to_Member'>pstatus</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN914"><span class='Ref_To_Local'>prev</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>         <a href="fe-exec.c.html#LN913"><span class='Ref_To_Local'>pstatus</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>         <a href="fe-exec.c.html#LN914"><span class='Ref_To_Local'>prev</span></a> <span class='Operator'>= </span><a href="fe-exec.c.html#LN913"><span class='Ref_To_Local'>pstatus</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN913"><span class='Ref_To_Local'>pstatus</span></a> <span class='Operator'>= </span><a href="fe-exec.c.html#LN913"><span class='Ref_To_Local'>pstatus</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN257"><span class='Ref_to_Member'>next</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span>strcmp<span class='Parentheses'>(</span><a href="fe-exec.c.html#LN913"><span class='Ref_To_Local'>pstatus</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN258"><span class='Ref_to_Member'>name</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN911"><span class='Ref_to_Parameter'>name</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN914"><span class='Ref_To_Local'>prev</span></a><span class='Parentheses'>) 
</span>                <a href="fe-exec.c.html#LN914"><span class='Ref_To_Local'>prev</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN257"><span class='Ref_to_Member'>next</span></a> <span class='Operator'>= </span><a href="fe-exec.c.html#LN913"><span class='Ref_To_Local'>pstatus</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN257"><span class='Ref_to_Member'>next</span></a><span class='Delimiter'>; 
</span>            <span class='Control'>else</span> 
                <a href="fe-exec.c.html#LN911"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN421"><span class='Ref_to_Member'>pstatus</span></a> <span class='Operator'>= </span><a href="fe-exec.c.html#LN913"><span class='Ref_To_Local'>pstatus</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN257"><span class='Ref_to_Member'>next</span></a><span class='Delimiter'>; 
</span>            <a href="../../include/snowball/header.h.html#LN64"><span class='Ref_to_Macro'>free</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN913"><span class='Ref_To_Local'>pstatus</span></a><span class='Parentheses'>)</span><span class='Delimiter'>;</span>      <span class='Comment_Single_Line'>/* frees name and value strings too */ 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Store new info as a single malloc block 
     */ 
</span>    <a href="fe-exec.c.html#LN913"><span class='Ref_To_Local'>pstatus</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="libpq-int.h.html#LN255"><span class='Ref_to_Struct'>pgParameterStatus</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/snowball/header.h.html#LN49"><span class='Ref_to_Macro'>malloc</span></a><span class='Parentheses'>(</span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="libpq-int.h.html#LN255"><span class='Ref_to_Struct'>pgParameterStatus</span></a><span class='Parentheses'>) </span><span class='Operator'>+ 
</span>                                           strlen<span class='Parentheses'>(</span><a href="fe-exec.c.html#LN911"><span class='Ref_to_Parameter'>name</span></a><span class='Parentheses'>) </span><span class='Operator'>+</span>strlen<span class='Parentheses'>(</span><span class='Keyword'>value</span><span class='Parentheses'>) </span><span class='Operator'>+ </span><span class='Number'>2</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN913"><span class='Ref_To_Local'>pstatus</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN945"></a>        <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>ptr</span><span class='Delimiter'>; 
</span> 
        <a href="fe-exec.c.html#LN945"><span class='Ref_To_Local'>ptr</span></a> <span class='Operator'>= </span><span class='Parentheses'>((</span><span class='Keyword'>char </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="fe-exec.c.html#LN913"><span class='Ref_To_Local'>pstatus</span></a><span class='Parentheses'>)</span> <span class='Operator'>+ </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="libpq-int.h.html#LN255"><span class='Ref_to_Struct'>pgParameterStatus</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="fe-exec.c.html#LN913"><span class='Ref_To_Local'>pstatus</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN258"><span class='Ref_to_Member'>name</span></a> <span class='Operator'>= </span><a href="fe-exec.c.html#LN945"><span class='Ref_To_Local'>ptr</span></a><span class='Delimiter'>; 
</span>        <a href="../../../contrib/cube/cubeparse.y.html#LN150"><span class='Ref_to_Proto'>strcpy</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN945"><span class='Ref_To_Local'>ptr</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN911"><span class='Ref_to_Parameter'>name</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="fe-exec.c.html#LN945"><span class='Ref_To_Local'>ptr</span></a> <span class='Operator'>+= </span>strlen<span class='Parentheses'>(</span><a href="fe-exec.c.html#LN911"><span class='Ref_to_Parameter'>name</span></a><span class='Parentheses'>) </span><span class='Operator'>+ </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>        <a href="fe-exec.c.html#LN913"><span class='Ref_To_Local'>pstatus</span></a><span class='Operator'>-&GT;</span><span class='Keyword'>value </span><span class='Operator'>= </span><a href="fe-exec.c.html#LN945"><span class='Ref_To_Local'>ptr</span></a><span class='Delimiter'>; 
</span>        <a href="../../../contrib/cube/cubeparse.y.html#LN150"><span class='Ref_to_Proto'>strcpy</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN945"><span class='Ref_To_Local'>ptr</span></a><span class='Delimiter'>, </span><span class='Keyword'>value</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="fe-exec.c.html#LN913"><span class='Ref_To_Local'>pstatus</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN257"><span class='Ref_to_Member'>next</span></a> <span class='Operator'>= </span><a href="fe-exec.c.html#LN911"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN421"><span class='Ref_to_Member'>pstatus</span></a><span class='Delimiter'>; 
</span>        <a href="fe-exec.c.html#LN911"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN421"><span class='Ref_to_Member'>pstatus</span></a> <span class='Operator'>= </span><a href="fe-exec.c.html#LN913"><span class='Ref_To_Local'>pstatus</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Special hacks: remember client_encoding and 
     * standard_conforming_strings, and convert server version to a numeric 
     * form.  We keep the first two of these in static variables as well, so 
     * that PQescapeString and PQescapeBytea can behave somewhat sanely (at 
     * least in single-connection-using programs). 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span>strcmp<span class='Parentheses'>(</span><a href="fe-exec.c.html#LN911"><span class='Ref_to_Parameter'>name</span></a><span class='Delimiter'>, </span><span class='String'>"client_encoding"</span><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
    <span class='Delimiter'>{ 
</span>        <a href="fe-exec.c.html#LN911"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN422"><span class='Ref_to_Member'>client_encoding</span></a> <span class='Operator'>= </span><a href="../../include/mb/pg_wchar.h.html#LN501"><span class='Ref_to_Proto'>pg_char_to_encoding</span></a><span class='Parentheses'>(</span><span class='Keyword'>value</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Comment_Multi_Line'>/* if we don't recognize the encoding name, fall back to SQL_ASCII */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN911"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN422"><span class='Ref_to_Member'>client_encoding</span></a> <span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>            <a href="fe-exec.c.html#LN911"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN422"><span class='Ref_to_Member'>client_encoding</span></a> <span class='Operator'>= </span><a href="../../include/mb/pg_wchar.h.html#LN237"><span class='Ref_to_EnumConst'>PG_SQL_ASCII</span></a><span class='Delimiter'>; 
</span>        <a href="fe-exec.c.html#LN48"><span class='Ref_to_Global_Var'>static_client_encoding</span></a> <span class='Operator'>= </span><a href="fe-exec.c.html#LN911"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN422"><span class='Ref_to_Member'>client_encoding</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span>strcmp<span class='Parentheses'>(</span><a href="fe-exec.c.html#LN911"><span class='Ref_to_Parameter'>name</span></a><span class='Delimiter'>, </span><span class='String'>"standard_conforming_strings"</span><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
    <span class='Delimiter'>{ 
</span>        <a href="fe-exec.c.html#LN911"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN423"><span class='Ref_to_Member'>std_strings</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span>strcmp<span class='Parentheses'>(</span><span class='Keyword'>value</span><span class='Delimiter'>, </span><span class='String'>"on"</span><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="fe-exec.c.html#LN49"><span class='Ref_to_Global_Var'>static_std_strings</span></a> <span class='Operator'>= </span><a href="fe-exec.c.html#LN911"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN423"><span class='Ref_to_Member'>std_strings</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span>strcmp<span class='Parentheses'>(</span><a href="fe-exec.c.html#LN911"><span class='Ref_to_Parameter'>name</span></a><span class='Delimiter'>, </span><span class='String'>"server_version"</span><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
    <span class='Delimiter'>{ 
</span><a name="LN979"></a>        <span class='Keyword'>int</span>         <span class='Declare_Local'>cnt</span><span class='Delimiter'>; 
</span><a name="LN980"></a>        <span class='Keyword'>int</span>         <span class='Declare_Local'>vmaj</span><span class='Delimiter'>, 
</span><a name="LN981"></a>                    <span class='Declare_Local'>vmin</span><span class='Delimiter'>, 
</span><a name="LN982"></a>                    <span class='Declare_Local'>vrev</span><span class='Delimiter'>; 
</span> 
        <a href="fe-exec.c.html#LN979"><span class='Ref_To_Local'>cnt</span></a> <span class='Operator'>= </span>sscanf<span class='Parentheses'>(</span><span class='Keyword'>value</span><span class='Delimiter'>, </span><span class='String'>"%d.%d.%d"</span><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="fe-exec.c.html#LN980"><span class='Ref_To_Local'>vmaj</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="fe-exec.c.html#LN981"><span class='Ref_To_Local'>vmin</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="fe-exec.c.html#LN982"><span class='Ref_To_Local'>vrev</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN979"><span class='Ref_To_Local'>cnt</span></a> <span class='Operator'>== </span><span class='Number'>3</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* old style, e.g. 9.6.1 */ 
</span>            <a href="fe-exec.c.html#LN911"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN404"><span class='Ref_to_Member'>sversion</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Number'>100</span> <span class='Operator'>* </span><a href="fe-exec.c.html#LN980"><span class='Ref_To_Local'>vmaj</span></a> <span class='Operator'>+ </span><a href="fe-exec.c.html#LN981"><span class='Ref_To_Local'>vmin</span></a><span class='Parentheses'>) </span><span class='Operator'>* </span><span class='Number'>100</span> <span class='Operator'>+ </span><a href="fe-exec.c.html#LN982"><span class='Ref_To_Local'>vrev</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN979"><span class='Ref_To_Local'>cnt</span></a> <span class='Operator'>== </span><span class='Number'>2</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN980"><span class='Ref_To_Local'>vmaj</span></a> <span class='Operator'>&GT;= </span><span class='Number'>10</span><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <span class='Comment_Multi_Line'>/* new style, e.g. 10.1 */ 
</span>                <a href="fe-exec.c.html#LN911"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN404"><span class='Ref_to_Member'>sversion</span></a> <span class='Operator'>= </span><span class='Number'>100</span> <span class='Operator'>* </span><span class='Number'>100</span> <span class='Operator'>* </span><a href="fe-exec.c.html#LN980"><span class='Ref_To_Local'>vmaj</span></a> <span class='Operator'>+ </span><a href="fe-exec.c.html#LN981"><span class='Ref_To_Local'>vmin</span></a><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>            <span class='Control'>else</span> 
            <span class='Delimiter'>{ 
</span>                <span class='Comment_Multi_Line'>/* old style without minor version, e.g. 9.6devel */ 
</span>                <a href="fe-exec.c.html#LN911"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN404"><span class='Ref_to_Member'>sversion</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Number'>100</span> <span class='Operator'>* </span><a href="fe-exec.c.html#LN980"><span class='Ref_To_Local'>vmaj</span></a> <span class='Operator'>+ </span><a href="fe-exec.c.html#LN981"><span class='Ref_To_Local'>vmin</span></a><span class='Parentheses'>) </span><span class='Operator'>* </span><span class='Number'>100</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN979"><span class='Ref_To_Local'>cnt</span></a> <span class='Operator'>== </span><span class='Number'>1</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* new style without minor version, e.g. 10devel */ 
</span>            <a href="fe-exec.c.html#LN911"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN404"><span class='Ref_to_Member'>sversion</span></a> <span class='Operator'>= </span><span class='Number'>100</span> <span class='Operator'>* </span><span class='Number'>100</span> <span class='Operator'>* </span><a href="fe-exec.c.html#LN980"><span class='Ref_To_Local'>vmaj</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> 
            <a href="fe-exec.c.html#LN911"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN404"><span class='Ref_to_Member'>sversion</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><span class='Comment_Single_Line'>/* unknown */ 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if strcmp(name,"server_v... &raquo; </span> 
<span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end pqSaveParameterStatus &raquo; </span> 
 
 
<span class='Comment_Multi_Line'>/* 
 * pqRowProcessor 
 *    Add the received row to the current async result (conn-&GT;result). 
 *    Returns 1 if OK, 0 if error occurred. 
 * 
 * On error, *errmsgp can be set to an error string to be returned. 
 * If it is left NULL, the error is presumed to be "out of memory". 
 * 
 * In single-row mode, we create a new result holding just the current row, 
 * stashing the previous result in conn-&GT;next_result so that it becomes 
 * active again after pqPrepareAsyncResult().  This allows the result metadata 
 * (column descriptions) to be carried forward to each result row. 
 */ 
</span><span class='Keyword'>int 
</span><a name="LN1029"></a><span class='Declare_Function'>pqRowProcessor</span><span class='Parentheses'>(</span><a href="libpq-fe.h.html#LN139"><span class='Ref_to_Typedef'>PGconn</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>conn</span><span class='Delimiter'>, </span><span class='Keyword'>const char </span><span class='Operator'>**</span><span class='Declare_Parameter'>errmsgp</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1031"></a>    <a href="libpq-fe.h.html#LN146"><span class='Ref_to_Typedef'>PGresult</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>res</span> <span class='Operator'>= </span><a href="fe-exec.c.html#LN1029"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN450"><span class='Ref_to_Member'>result</span></a><span class='Delimiter'>; 
</span><a name="LN1032"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>nfields</span> <span class='Operator'>= </span><a href="fe-exec.c.html#LN1031"><span class='Ref_To_Local'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN169"><span class='Ref_to_Member'>numAttributes</span></a><span class='Delimiter'>; 
</span><a name="LN1033"></a>    <span class='Keyword'>const </span><a href="libpq-int.h.html#LN286"><span class='Ref_to_Typedef'>PGdataValue</span></a> <span class='Operator'>*</span><span class='Declare_Local'>columns</span> <span class='Operator'>= </span><a href="fe-exec.c.html#LN1029"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN446"><span class='Ref_to_Member'>rowBuf</span></a><span class='Delimiter'>; 
</span><a name="LN1034"></a>    <a href="libpq-int.h.html#LN134"><span class='Ref_to_Typedef'>PGresAttValue</span></a> <span class='Operator'>*</span><span class='Declare_Local'>tup</span><span class='Delimiter'>; 
</span><a name="LN1035"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>i</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * In single-row mode, make a new PGresult that will hold just this one 
     * row; the original conn-&GT;result is left unchanged so that it can be used 
     * again as the template for future rows. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1029"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN386"><span class='Ref_to_Member'>singleRowMode</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* Copy everything that should be in the result at this point */ 
</span>        <a href="fe-exec.c.html#LN1031"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="fe-exec.c.html#LN289"><span class='Ref_to_Func'>PQcopyResult</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1031"><span class='Ref_To_Local'>res</span></a><span class='Delimiter'>, 
</span>                           <a href="libpq-fe.h.html#LN33"><span class='Ref_to_Const'>PG_COPYRES_ATTRS</span></a> <span class='Operator'>| </span><a href="libpq-fe.h.html#LN35"><span class='Ref_to_Const'>PG_COPYRES_EVENTS</span></a> <span class='Operator'>| 
</span>                           <a href="libpq-fe.h.html#LN36"><span class='Ref_to_Const'>PG_COPYRES_NOTICEHOOKS</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="fe-exec.c.html#LN1031"><span class='Ref_To_Local'>res</span></a><span class='Parentheses'>) 
</span>            <span class='Control'>return</span> <span class='Number'>0</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Basically we just allocate space in the PGresult for each field and 
     * copy the data over. 
     * 
     * Note: on malloc failure, we return 0 leaving *errmsgp still NULL, which 
     * caller will take to mean "out of memory".  This is preferable to trying 
     * to set up such a message here, because evidently there's not enough 
     * memory for gettext() to do anything. 
     */ 
</span>    <a href="fe-exec.c.html#LN1034"><span class='Ref_To_Local'>tup</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="libpq-int.h.html#LN134"><span class='Ref_to_Typedef'>PGresAttValue</span></a> <span class='Operator'>*</span><span class='Parentheses'>) 
</span>        <a href="fe-exec.c.html#LN504"><span class='Ref_to_Func'>pqResultAlloc</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1031"><span class='Ref_To_Local'>res</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN1032"><span class='Ref_To_Local'>nfields</span></a> <span class='Operator'>* </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="libpq-int.h.html#LN134"><span class='Ref_to_Typedef'>PGresAttValue</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><span class='Boolean'>TRUE</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1034"><span class='Ref_To_Local'>tup</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>        <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="fe-exec.c.html#LN1115"><span class='Ref_to_Label'>fail</span></a><span class='Delimiter'>; 
</span> 
    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1035"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="fe-exec.c.html#LN1035"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="fe-exec.c.html#LN1032"><span class='Ref_To_Local'>nfields</span></a><span class='Delimiter'>; </span><a href="fe-exec.c.html#LN1035"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN1068"></a>        <span class='Keyword'>int</span>         <span class='Declare_Local'>clen</span> <span class='Operator'>= </span><a href="fe-exec.c.html#LN1033"><span class='Ref_To_Local'>columns</span></a><span class='Delimiter'>[</span><a href="fe-exec.c.html#LN1035"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="libpq-int.h.html#LN288"><span class='Ref_to_Member'>len</span></a><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1068"><span class='Ref_To_Local'>clen</span></a> <span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* null field */ 
</span>            <a href="fe-exec.c.html#LN1034"><span class='Ref_To_Local'>tup</span></a><span class='Delimiter'>[</span><a href="fe-exec.c.html#LN1035"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="libpq-int.h.html#LN136"><span class='Ref_to_Member'>len</span></a> <span class='Operator'>= </span><a href="libpq-int.h.html#LN132"><span class='Ref_to_Const'>NULL_LEN</span></a><span class='Delimiter'>; 
</span>            <a href="fe-exec.c.html#LN1034"><span class='Ref_To_Local'>tup</span></a><span class='Delimiter'>[</span><a href="fe-exec.c.html#LN1035"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><span class='Keyword'>value </span><span class='Operator'>= </span><a href="fe-exec.c.html#LN1031"><span class='Ref_To_Local'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN200"><span class='Ref_to_Member'>null_field</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> 
        <span class='Delimiter'>{ 
</span><a name="LN1078"></a>            <span class='Keyword'>bool</span>        <span class='Declare_Local'>isbinary</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1031"><span class='Ref_To_Local'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN170"><span class='Ref_to_Member'>attDescs</span></a><span class='Delimiter'>[</span><a href="fe-exec.c.html#LN1035"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="libpq-fe.h.html#LN239"><span class='Ref_to_Member'>format</span></a> <span class='Operator'>!= </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1079"></a>            <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>val</span><span class='Delimiter'>; 
</span> 
            <a href="fe-exec.c.html#LN1079"><span class='Ref_To_Local'>val</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Keyword'>char </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="fe-exec.c.html#LN504"><span class='Ref_to_Func'>pqResultAlloc</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1031"><span class='Ref_To_Local'>res</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN1068"><span class='Ref_To_Local'>clen</span></a> <span class='Operator'>+ </span><span class='Number'>1</span><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN1078"><span class='Ref_To_Local'>isbinary</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1079"><span class='Ref_To_Local'>val</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>                <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="fe-exec.c.html#LN1115"><span class='Ref_to_Label'>fail</span></a><span class='Delimiter'>; 
</span> 
            <span class='Comment_Multi_Line'>/* copy and zero-terminate the data (even if it's binary) */ 
</span>            memcpy<span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1079"><span class='Ref_To_Local'>val</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN1033"><span class='Ref_To_Local'>columns</span></a><span class='Delimiter'>[</span><a href="fe-exec.c.html#LN1035"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><span class='Keyword'>value</span><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN1068"><span class='Ref_To_Local'>clen</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="fe-exec.c.html#LN1079"><span class='Ref_To_Local'>val</span></a><span class='Delimiter'>[</span><a href="fe-exec.c.html#LN1068"><span class='Ref_To_Local'>clen</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='String'>'\0'</span><span class='Delimiter'>; 
</span> 
            <a href="fe-exec.c.html#LN1034"><span class='Ref_To_Local'>tup</span></a><span class='Delimiter'>[</span><a href="fe-exec.c.html#LN1035"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="libpq-int.h.html#LN136"><span class='Ref_to_Member'>len</span></a> <span class='Operator'>= </span><a href="fe-exec.c.html#LN1068"><span class='Ref_To_Local'>clen</span></a><span class='Delimiter'>; 
</span>            <a href="fe-exec.c.html#LN1034"><span class='Ref_To_Local'>tup</span></a><span class='Delimiter'>[</span><a href="fe-exec.c.html#LN1035"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><span class='Keyword'>value </span><span class='Operator'>= </span><a href="fe-exec.c.html#LN1079"><span class='Ref_To_Local'>val</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end for i=0;i&LT;nfields;i++ &raquo; </span> 
 
    <span class='Comment_Multi_Line'>/* And add the tuple to the PGresult's tuple array */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="fe-exec.c.html#LN53"><span class='Ref_to_Proto'>pqAddTuple</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1031"><span class='Ref_To_Local'>res</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN1034"><span class='Ref_To_Local'>tup</span></a><span class='Parentheses'>))</span> 
        <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="fe-exec.c.html#LN1115"><span class='Ref_to_Label'>fail</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Success.  In single-row mode, make the result available to the client 
     * immediately. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1029"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN386"><span class='Ref_to_Member'>singleRowMode</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* Change result status to special single-row value */ 
</span>        <a href="fe-exec.c.html#LN1031"><span class='Ref_To_Local'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN176"><span class='Ref_to_Member'>resultStatus</span></a> <span class='Operator'>= </span><a href="libpq-fe.h.html#LN97"><span class='Ref_to_EnumConst'>PGRES_SINGLE_TUPLE</span></a><span class='Delimiter'>; 
</span>        <span class='Comment_Multi_Line'>/* Stash old result for re-use later */ 
</span>        <a href="fe-exec.c.html#LN1029"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN451"><span class='Ref_to_Member'>next_result</span></a> <span class='Operator'>= </span><a href="fe-exec.c.html#LN1029"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN450"><span class='Ref_to_Member'>result</span></a><span class='Delimiter'>; 
</span>        <a href="fe-exec.c.html#LN1029"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN450"><span class='Ref_to_Member'>result</span></a> <span class='Operator'>= </span><a href="fe-exec.c.html#LN1031"><span class='Ref_To_Local'>res</span></a><span class='Delimiter'>; 
</span>        <span class='Comment_Multi_Line'>/* And mark the result ready to return */ 
</span>        <a href="fe-exec.c.html#LN1029"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN378"><span class='Ref_to_Member'>asyncStatus</span></a> <span class='Operator'>= </span><a href="libpq-int.h.html#LN217"><span class='Ref_to_EnumConst'>PGASYNC_READY</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>return</span> <span class='Number'>1</span><span class='Delimiter'>; 
</span> 
<a name="LN1115"></a><span class='Label'>fail</span><span class='Operator'>: 
</span>    <span class='Comment_Multi_Line'>/* release locally allocated PGresult, if we made one */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1031"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>!= </span><a href="fe-exec.c.html#LN1029"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN450"><span class='Ref_to_Member'>result</span></a><span class='Parentheses'>) 
</span>        <a href="libpq-fe.h.html#LN501"><span class='Ref_to_Proto'>PQclear</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1031"><span class='Ref_To_Local'>res</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <span class='Number'>0</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end pqRowProcessor &raquo; </span> 
 
 
<span class='Comment_Multi_Line'>/* 
 * PQsendQuery 
 *   Submit a query, but don't wait for it to finish 
 * 
 * Returns: 1 if successfully submitted 
 *          0 if error (conn-&GT;errorMessage is set) 
 */ 
</span><span class='Keyword'>int 
</span><a name="LN1131"></a><span class='Declare_Function'>PQsendQuery</span><span class='Parentheses'>(</span><a href="libpq-fe.h.html#LN139"><span class='Ref_to_Typedef'>PGconn</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>conn</span><span class='Delimiter'>, </span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>query</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="fe-exec.c.html#LN54"><span class='Ref_to_Proto'>PQsendQueryStart</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1131"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>))</span> 
        <span class='Control'>return</span> <span class='Number'>0</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* check the argument */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="fe-exec.c.html#LN1131"><span class='Ref_to_Parameter'>query</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="pqexpbuffer.c.html#LN232"><span class='Ref_to_Func'>printfPQExpBuffer</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="fe-exec.c.html#LN1131"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN491"><span class='Ref_to_Member'>errorMessage</span></a><span class='Delimiter'>, 
</span>                        <a href="win32.c.html#LN36"><span class='Ref_to_Func'>libpq_gettext</span></a><span class='Parentheses'>(</span><span class='String'>"command string is a null pointer\n"</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <span class='Number'>0</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* construct the outgoing Query message */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-misc.c.html#LN519"><span class='Ref_to_Func'>pqPutMsgStart</span></a><span class='Parentheses'>(</span><span class='String'>'Q'</span><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN1131"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT; </span><span class='Number'>0</span> <span class='Operator'>|| 
</span>        <a href="fe-misc.c.html#LN179"><span class='Ref_to_Func'>pqPuts</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1131"><span class='Ref_to_Parameter'>query</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN1131"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT; </span><span class='Number'>0</span> <span class='Operator'>|| 
</span>        <a href="fe-misc.c.html#LN587"><span class='Ref_to_Func'>pqPutMsgEnd</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1131"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
    <span class='Delimiter'>{ 
</span>        <a href="libpq-int.h.html#LN580"><span class='Ref_to_Proto'>pqHandleSendFailure</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1131"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <span class='Number'>0</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* remember we are using simple query protocol */ 
</span>    <a href="fe-exec.c.html#LN1131"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN380"><span class='Ref_to_Member'>queryclass</span></a> <span class='Operator'>= </span><a href="libpq-int.h.html#LN226"><span class='Ref_to_EnumConst'>PGQUERY_SIMPLE</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* and remember the query text too, if possible */ 
</span>    <span class='Comment_Multi_Line'>/* if insufficient memory, last_query just winds up NULL */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1131"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN381"><span class='Ref_to_Member'>last_query</span></a><span class='Parentheses'>) 
</span>        <a href="../../include/snowball/header.h.html#LN64"><span class='Ref_to_Macro'>free</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1131"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN381"><span class='Ref_to_Member'>last_query</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="fe-exec.c.html#LN1131"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN381"><span class='Ref_to_Member'>last_query</span></a> <span class='Operator'>= </span>strdup<span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1131"><span class='Ref_to_Parameter'>query</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Give the data a push.  In nonblock mode, don't complain if we're unable 
     * to send it all; PQgetResult() will do any additional flushing needed. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="libpq-int.h.html#LN637"><span class='Ref_to_Proto'>pqFlush</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1131"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
    <span class='Delimiter'>{ 
</span>        <a href="libpq-int.h.html#LN580"><span class='Ref_to_Proto'>pqHandleSendFailure</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1131"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <span class='Number'>0</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* OK, it's launched! */ 
</span>    <a href="fe-exec.c.html#LN1131"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN378"><span class='Ref_to_Member'>asyncStatus</span></a> <span class='Operator'>= </span><a href="libpq-int.h.html#LN216"><span class='Ref_to_EnumConst'>PGASYNC_BUSY</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <span class='Number'>1</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end PQsendQuery &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * PQsendQueryParams 
 *      Like PQsendQuery, but use protocol 3.0 so we can pass parameters 
 */ 
</span><span class='Keyword'>int 
</span><a name="LN1182"></a><span class='Declare_Function'>PQsendQueryParams</span><span class='Parentheses'>(</span><a href="libpq-fe.h.html#LN139"><span class='Ref_to_Typedef'>PGconn</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>conn</span><span class='Delimiter'>, 
</span><a name="LN1183"></a>                  <span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>command</span><span class='Delimiter'>, 
</span><a name="LN1184"></a>                  <span class='Keyword'>int </span><span class='Declare_Parameter'>nParams</span><span class='Delimiter'>, 
</span><a name="LN1185"></a>                  <span class='Keyword'>const </span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>paramTypes</span><span class='Delimiter'>, 
</span><a name="LN1186"></a>                  <span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Keyword'>const </span><span class='Operator'>* </span><span class='Declare_Parameter'>paramValues</span><span class='Delimiter'>, 
</span><a name="LN1187"></a>                  <span class='Keyword'>const int </span><span class='Operator'>*</span><span class='Declare_Parameter'>paramLengths</span><span class='Delimiter'>, 
</span><a name="LN1188"></a>                  <span class='Keyword'>const int </span><span class='Operator'>*</span><span class='Declare_Parameter'>paramFormats</span><span class='Delimiter'>, 
</span><a name="LN1189"></a>                  <span class='Keyword'>int </span><span class='Declare_Parameter'>resultFormat</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="fe-exec.c.html#LN54"><span class='Ref_to_Proto'>PQsendQueryStart</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1182"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>))</span> 
        <span class='Control'>return</span> <span class='Number'>0</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* check the arguments */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="fe-exec.c.html#LN1183"><span class='Ref_to_Parameter'>command</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="pqexpbuffer.c.html#LN232"><span class='Ref_to_Func'>printfPQExpBuffer</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="fe-exec.c.html#LN1182"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN491"><span class='Ref_to_Member'>errorMessage</span></a><span class='Delimiter'>, 
</span>                        <a href="win32.c.html#LN36"><span class='Ref_to_Func'>libpq_gettext</span></a><span class='Parentheses'>(</span><span class='String'>"command string is a null pointer\n"</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <span class='Number'>0</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1184"><span class='Ref_to_Parameter'>nParams</span></a> <span class='Operator'>&LT; </span><span class='Number'>0</span> <span class='Operator'>|| </span><a href="fe-exec.c.html#LN1184"><span class='Ref_to_Parameter'>nParams</span></a> <span class='Operator'>&GT; </span><span class='Number'>65535</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="pqexpbuffer.c.html#LN232"><span class='Ref_to_Func'>printfPQExpBuffer</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="fe-exec.c.html#LN1182"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN491"><span class='Ref_to_Member'>errorMessage</span></a><span class='Delimiter'>, 
</span>        <a href="win32.c.html#LN36"><span class='Ref_to_Func'>libpq_gettext</span></a><span class='Parentheses'>(</span><span class='String'>"number of parameters must be between 0 and 65535\n"</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <span class='Number'>0</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>return</span> <a href="fe-exec.c.html#LN55"><span class='Ref_to_Proto'>PQsendQueryGuts</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1182"><span class='Ref_to_Parameter'>conn</span></a><span class='Delimiter'>, 
</span>                           <a href="fe-exec.c.html#LN1183"><span class='Ref_to_Parameter'>command</span></a><span class='Delimiter'>, 
</span>                           <span class='String'>""</span><span class='Delimiter'>,</span>  <span class='Comment_Single_Line'>/* use unnamed statement */ 
</span>                           <a href="fe-exec.c.html#LN1184"><span class='Ref_to_Parameter'>nParams</span></a><span class='Delimiter'>, 
</span>                           <a href="fe-exec.c.html#LN1185"><span class='Ref_to_Parameter'>paramTypes</span></a><span class='Delimiter'>, 
</span>                           <a href="fe-exec.c.html#LN1186"><span class='Ref_to_Parameter'>paramValues</span></a><span class='Delimiter'>, 
</span>                           <a href="fe-exec.c.html#LN1187"><span class='Ref_to_Parameter'>paramLengths</span></a><span class='Delimiter'>, 
</span>                           <a href="fe-exec.c.html#LN1188"><span class='Ref_to_Parameter'>paramFormats</span></a><span class='Delimiter'>, 
</span>                           <a href="fe-exec.c.html#LN1189"><span class='Ref_to_Parameter'>resultFormat</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end PQsendQueryParams &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * PQsendPrepare 
 *   Submit a Parse message, but don't wait for it to finish 
 * 
 * Returns: 1 if successfully submitted 
 *          0 if error (conn-&GT;errorMessage is set) 
 */ 
</span><span class='Keyword'>int 
</span><a name="LN1227"></a><span class='Declare_Function'>PQsendPrepare</span><span class='Parentheses'>(</span><a href="libpq-fe.h.html#LN139"><span class='Ref_to_Typedef'>PGconn</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>conn</span><span class='Delimiter'>, 
</span><a name="LN1228"></a>              <span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>stmtName</span><span class='Delimiter'>, </span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>query</span><span class='Delimiter'>, 
</span><a name="LN1229"></a>              <span class='Keyword'>int </span><span class='Declare_Parameter'>nParams</span><span class='Delimiter'>, </span><span class='Keyword'>const </span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>paramTypes</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="fe-exec.c.html#LN54"><span class='Ref_to_Proto'>PQsendQueryStart</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1227"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>))</span> 
        <span class='Control'>return</span> <span class='Number'>0</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* check the arguments */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="fe-exec.c.html#LN1228"><span class='Ref_to_Parameter'>stmtName</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="pqexpbuffer.c.html#LN232"><span class='Ref_to_Func'>printfPQExpBuffer</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="fe-exec.c.html#LN1227"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN491"><span class='Ref_to_Member'>errorMessage</span></a><span class='Delimiter'>, 
</span>                        <a href="win32.c.html#LN36"><span class='Ref_to_Func'>libpq_gettext</span></a><span class='Parentheses'>(</span><span class='String'>"statement name is a null pointer\n"</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <span class='Number'>0</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="fe-exec.c.html#LN1228"><span class='Ref_to_Parameter'>query</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="pqexpbuffer.c.html#LN232"><span class='Ref_to_Func'>printfPQExpBuffer</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="fe-exec.c.html#LN1227"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN491"><span class='Ref_to_Member'>errorMessage</span></a><span class='Delimiter'>, 
</span>                        <a href="win32.c.html#LN36"><span class='Ref_to_Func'>libpq_gettext</span></a><span class='Parentheses'>(</span><span class='String'>"command string is a null pointer\n"</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <span class='Number'>0</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1229"><span class='Ref_to_Parameter'>nParams</span></a> <span class='Operator'>&LT; </span><span class='Number'>0</span> <span class='Operator'>|| </span><a href="fe-exec.c.html#LN1229"><span class='Ref_to_Parameter'>nParams</span></a> <span class='Operator'>&GT; </span><span class='Number'>65535</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="pqexpbuffer.c.html#LN232"><span class='Ref_to_Func'>printfPQExpBuffer</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="fe-exec.c.html#LN1227"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN491"><span class='Ref_to_Member'>errorMessage</span></a><span class='Delimiter'>, 
</span>        <a href="win32.c.html#LN36"><span class='Ref_to_Func'>libpq_gettext</span></a><span class='Parentheses'>(</span><span class='String'>"number of parameters must be between 0 and 65535\n"</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <span class='Number'>0</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* This isn't gonna work on a 2.0 server */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/libpq/pqcomm.h.html#LN103"><span class='Ref_to_Macro'>PG_PROTOCOL_MAJOR</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1227"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN403"><span class='Ref_to_Member'>pversion</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT; </span><span class='Number'>3</span><span class='Parentheses'>)</span> 
    <span class='Delimiter'>{ 
</span>        <a href="pqexpbuffer.c.html#LN232"><span class='Ref_to_Func'>printfPQExpBuffer</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="fe-exec.c.html#LN1227"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN491"><span class='Ref_to_Member'>errorMessage</span></a><span class='Delimiter'>, 
</span>         <a href="win32.c.html#LN36"><span class='Ref_to_Func'>libpq_gettext</span></a><span class='Parentheses'>(</span><span class='String'>"function requires at least protocol version 3.0\n"</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <span class='Number'>0</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* construct the Parse message */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-misc.c.html#LN519"><span class='Ref_to_Func'>pqPutMsgStart</span></a><span class='Parentheses'>(</span><span class='String'>'P'</span><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN1227"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT; </span><span class='Number'>0</span> <span class='Operator'>|| 
</span>        <a href="fe-misc.c.html#LN179"><span class='Ref_to_Func'>pqPuts</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1228"><span class='Ref_to_Parameter'>stmtName</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN1227"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT; </span><span class='Number'>0</span> <span class='Operator'>|| 
</span>        <a href="fe-misc.c.html#LN179"><span class='Ref_to_Func'>pqPuts</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1228"><span class='Ref_to_Parameter'>query</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN1227"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="fe-exec.c.html#LN1313"><span class='Ref_to_Label'>sendFailed</span></a><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1229"><span class='Ref_to_Parameter'>nParams</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span> <span class='Operator'>&& </span><a href="fe-exec.c.html#LN1229"><span class='Ref_to_Parameter'>paramTypes</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN1270"></a>        <span class='Keyword'>int</span>         <span class='Declare_Local'>i</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-misc.c.html#LN307"><span class='Ref_to_Func'>pqPutInt</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1229"><span class='Ref_to_Parameter'>nParams</span></a><span class='Delimiter'>, </span><span class='Number'>2</span><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN1227"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
            <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="fe-exec.c.html#LN1313"><span class='Ref_to_Label'>sendFailed</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1270"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="fe-exec.c.html#LN1270"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="fe-exec.c.html#LN1229"><span class='Ref_to_Parameter'>nParams</span></a><span class='Delimiter'>; </span><a href="fe-exec.c.html#LN1270"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-misc.c.html#LN307"><span class='Ref_to_Func'>pqPutInt</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1229"><span class='Ref_to_Parameter'>paramTypes</span></a><span class='Delimiter'>[</span><a href="fe-exec.c.html#LN1270"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>], </span><span class='Number'>4</span><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN1227"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
                <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="fe-exec.c.html#LN1313"><span class='Ref_to_Label'>sendFailed</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-misc.c.html#LN307"><span class='Ref_to_Func'>pqPutInt</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Delimiter'>, </span><span class='Number'>2</span><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN1227"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
            <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="fe-exec.c.html#LN1313"><span class='Ref_to_Label'>sendFailed</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-misc.c.html#LN587"><span class='Ref_to_Func'>pqPutMsgEnd</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1227"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="fe-exec.c.html#LN1313"><span class='Ref_to_Label'>sendFailed</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* construct the Sync message */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-misc.c.html#LN519"><span class='Ref_to_Func'>pqPutMsgStart</span></a><span class='Parentheses'>(</span><span class='String'>'S'</span><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN1227"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT; </span><span class='Number'>0</span> <span class='Operator'>|| 
</span>        <a href="fe-misc.c.html#LN587"><span class='Ref_to_Func'>pqPutMsgEnd</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1227"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="fe-exec.c.html#LN1313"><span class='Ref_to_Label'>sendFailed</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* remember we are doing just a Parse */ 
</span>    <a href="fe-exec.c.html#LN1227"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN380"><span class='Ref_to_Member'>queryclass</span></a> <span class='Operator'>= </span><a href="libpq-int.h.html#LN228"><span class='Ref_to_EnumConst'>PGQUERY_PREPARE</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* and remember the query text too, if possible */ 
</span>    <span class='Comment_Multi_Line'>/* if insufficient memory, last_query just winds up NULL */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1227"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN381"><span class='Ref_to_Member'>last_query</span></a><span class='Parentheses'>) 
</span>        <a href="../../include/snowball/header.h.html#LN64"><span class='Ref_to_Macro'>free</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1227"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN381"><span class='Ref_to_Member'>last_query</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="fe-exec.c.html#LN1227"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN381"><span class='Ref_to_Member'>last_query</span></a> <span class='Operator'>= </span>strdup<span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1228"><span class='Ref_to_Parameter'>query</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Give the data a push.  In nonblock mode, don't complain if we're unable 
     * to send it all; PQgetResult() will do any additional flushing needed. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="libpq-int.h.html#LN637"><span class='Ref_to_Proto'>pqFlush</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1227"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="fe-exec.c.html#LN1313"><span class='Ref_to_Label'>sendFailed</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* OK, it's launched! */ 
</span>    <a href="fe-exec.c.html#LN1227"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN378"><span class='Ref_to_Member'>asyncStatus</span></a> <span class='Operator'>= </span><a href="libpq-int.h.html#LN216"><span class='Ref_to_EnumConst'>PGASYNC_BUSY</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <span class='Number'>1</span><span class='Delimiter'>; 
</span> 
<a name="LN1313"></a><span class='Label'>sendFailed</span><span class='Operator'>: 
</span>    <a href="libpq-int.h.html#LN580"><span class='Ref_to_Proto'>pqHandleSendFailure</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1227"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <span class='Number'>0</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end PQsendPrepare &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * PQsendQueryPrepared 
 *      Like PQsendQuery, but execute a previously prepared statement, 
 *      using protocol 3.0 so we can pass parameters 
 */ 
</span><span class='Keyword'>int 
</span><a name="LN1324"></a><span class='Declare_Function'>PQsendQueryPrepared</span><span class='Parentheses'>(</span><a href="libpq-fe.h.html#LN139"><span class='Ref_to_Typedef'>PGconn</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>conn</span><span class='Delimiter'>, 
</span><a name="LN1325"></a>                    <span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>stmtName</span><span class='Delimiter'>, 
</span><a name="LN1326"></a>                    <span class='Keyword'>int </span><span class='Declare_Parameter'>nParams</span><span class='Delimiter'>, 
</span><a name="LN1327"></a>                    <span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Keyword'>const </span><span class='Operator'>* </span><span class='Declare_Parameter'>paramValues</span><span class='Delimiter'>, 
</span><a name="LN1328"></a>                    <span class='Keyword'>const int </span><span class='Operator'>*</span><span class='Declare_Parameter'>paramLengths</span><span class='Delimiter'>, 
</span><a name="LN1329"></a>                    <span class='Keyword'>const int </span><span class='Operator'>*</span><span class='Declare_Parameter'>paramFormats</span><span class='Delimiter'>, 
</span><a name="LN1330"></a>                    <span class='Keyword'>int </span><span class='Declare_Parameter'>resultFormat</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="fe-exec.c.html#LN54"><span class='Ref_to_Proto'>PQsendQueryStart</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1324"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>))</span> 
        <span class='Control'>return</span> <span class='Number'>0</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* check the arguments */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="fe-exec.c.html#LN1325"><span class='Ref_to_Parameter'>stmtName</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="pqexpbuffer.c.html#LN232"><span class='Ref_to_Func'>printfPQExpBuffer</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="fe-exec.c.html#LN1324"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN491"><span class='Ref_to_Member'>errorMessage</span></a><span class='Delimiter'>, 
</span>                        <a href="win32.c.html#LN36"><span class='Ref_to_Func'>libpq_gettext</span></a><span class='Parentheses'>(</span><span class='String'>"statement name is a null pointer\n"</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <span class='Number'>0</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1326"><span class='Ref_to_Parameter'>nParams</span></a> <span class='Operator'>&LT; </span><span class='Number'>0</span> <span class='Operator'>|| </span><a href="fe-exec.c.html#LN1326"><span class='Ref_to_Parameter'>nParams</span></a> <span class='Operator'>&GT; </span><span class='Number'>65535</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="pqexpbuffer.c.html#LN232"><span class='Ref_to_Func'>printfPQExpBuffer</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="fe-exec.c.html#LN1324"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN491"><span class='Ref_to_Member'>errorMessage</span></a><span class='Delimiter'>, 
</span>        <a href="win32.c.html#LN36"><span class='Ref_to_Func'>libpq_gettext</span></a><span class='Parentheses'>(</span><span class='String'>"number of parameters must be between 0 and 65535\n"</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <span class='Number'>0</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>return</span> <a href="fe-exec.c.html#LN55"><span class='Ref_to_Proto'>PQsendQueryGuts</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1324"><span class='Ref_to_Parameter'>conn</span></a><span class='Delimiter'>, 
</span>                           <span class='Null_Value'>NULL</span><span class='Delimiter'>,</span>    <span class='Comment_Single_Line'>/* no command to parse */ 
</span>                           <a href="fe-exec.c.html#LN1325"><span class='Ref_to_Parameter'>stmtName</span></a><span class='Delimiter'>, 
</span>                           <a href="fe-exec.c.html#LN1326"><span class='Ref_to_Parameter'>nParams</span></a><span class='Delimiter'>, 
</span>                           <span class='Null_Value'>NULL</span><span class='Delimiter'>,</span>    <span class='Comment_Single_Line'>/* no param types */ 
</span>                           <a href="fe-exec.c.html#LN1327"><span class='Ref_to_Parameter'>paramValues</span></a><span class='Delimiter'>, 
</span>                           <a href="fe-exec.c.html#LN1328"><span class='Ref_to_Parameter'>paramLengths</span></a><span class='Delimiter'>, 
</span>                           <a href="fe-exec.c.html#LN1329"><span class='Ref_to_Parameter'>paramFormats</span></a><span class='Delimiter'>, 
</span>                           <a href="fe-exec.c.html#LN1330"><span class='Ref_to_Parameter'>resultFormat</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end PQsendQueryPrepared &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * Common startup code for PQsendQuery and sibling routines 
 */ 
</span><span class='Keyword'>static bool 
</span><a name="LN1364"></a><span class='Declare_Function'>PQsendQueryStart</span><span class='Parentheses'>(</span><a href="libpq-fe.h.html#LN139"><span class='Ref_to_Typedef'>PGconn</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>conn</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="fe-exec.c.html#LN1364"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <span class='Boolean'>false</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* clear the error string */ 
</span>    <a href="pqexpbuffer.h.html#LN129"><span class='Ref_to_Proto'>resetPQExpBuffer</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="fe-exec.c.html#LN1364"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN491"><span class='Ref_to_Member'>errorMessage</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Don't try to send if we know there's no live connection. */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1364"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN377"><span class='Ref_to_Member'>status</span></a> <span class='Operator'>!= </span><a href="libpq-fe.h.html#LN48"><span class='Ref_to_EnumConst'>CONNECTION_OK</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="pqexpbuffer.c.html#LN232"><span class='Ref_to_Func'>printfPQExpBuffer</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="fe-exec.c.html#LN1364"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN491"><span class='Ref_to_Member'>errorMessage</span></a><span class='Delimiter'>, 
</span>                          <a href="win32.c.html#LN36"><span class='Ref_to_Func'>libpq_gettext</span></a><span class='Parentheses'>(</span><span class='String'>"no connection to the server\n"</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <span class='Boolean'>false</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Comment_Multi_Line'>/* Can't send while already busy, either. */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1364"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN378"><span class='Ref_to_Member'>asyncStatus</span></a> <span class='Operator'>!= </span><a href="libpq-int.h.html#LN215"><span class='Ref_to_EnumConst'>PGASYNC_IDLE</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="pqexpbuffer.c.html#LN232"><span class='Ref_to_Func'>printfPQExpBuffer</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="fe-exec.c.html#LN1364"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN491"><span class='Ref_to_Member'>errorMessage</span></a><span class='Delimiter'>, 
</span>                  <a href="win32.c.html#LN36"><span class='Ref_to_Func'>libpq_gettext</span></a><span class='Parentheses'>(</span><span class='String'>"another command is already in progress\n"</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <span class='Boolean'>false</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* initialize async result-accumulation state */ 
</span>    <a href="libpq-int.h.html#LN571"><span class='Ref_to_Proto'>pqClearAsyncResult</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1364"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* reset single-row processing mode */ 
</span>    <a href="fe-exec.c.html#LN1364"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN386"><span class='Ref_to_Member'>singleRowMode</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* ready to send command message */ 
</span>    <span class='Control'>return</span> <span class='Boolean'>true</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end PQsendQueryStart &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * PQsendQueryGuts 
 *      Common code for protocol-3.0 query sending 
 *      PQsendQueryStart should be done already 
 * 
 * command may be NULL to indicate we use an already-prepared statement 
 */ 
</span><span class='Keyword'>static int 
</span><a name="LN1405"></a><span class='Declare_Function'>PQsendQueryGuts</span><span class='Parentheses'>(</span><a href="libpq-fe.h.html#LN139"><span class='Ref_to_Typedef'>PGconn</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>conn</span><span class='Delimiter'>, 
</span><a name="LN1406"></a>                <span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>command</span><span class='Delimiter'>, 
</span><a name="LN1407"></a>                <span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>stmtName</span><span class='Delimiter'>, 
</span><a name="LN1408"></a>                <span class='Keyword'>int </span><span class='Declare_Parameter'>nParams</span><span class='Delimiter'>, 
</span><a name="LN1409"></a>                <span class='Keyword'>const </span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>paramTypes</span><span class='Delimiter'>, 
</span><a name="LN1410"></a>                <span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Keyword'>const </span><span class='Operator'>* </span><span class='Declare_Parameter'>paramValues</span><span class='Delimiter'>, 
</span><a name="LN1411"></a>                <span class='Keyword'>const int </span><span class='Operator'>*</span><span class='Declare_Parameter'>paramLengths</span><span class='Delimiter'>, 
</span><a name="LN1412"></a>                <span class='Keyword'>const int </span><span class='Operator'>*</span><span class='Declare_Parameter'>paramFormats</span><span class='Delimiter'>, 
</span><a name="LN1413"></a>                <span class='Keyword'>int </span><span class='Declare_Parameter'>resultFormat</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1415"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>i</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* This isn't gonna work on a 2.0 server */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/libpq/pqcomm.h.html#LN103"><span class='Ref_to_Macro'>PG_PROTOCOL_MAJOR</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1405"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN403"><span class='Ref_to_Member'>pversion</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT; </span><span class='Number'>3</span><span class='Parentheses'>)</span> 
    <span class='Delimiter'>{ 
</span>        <a href="pqexpbuffer.c.html#LN232"><span class='Ref_to_Func'>printfPQExpBuffer</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="fe-exec.c.html#LN1405"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN491"><span class='Ref_to_Member'>errorMessage</span></a><span class='Delimiter'>, 
</span>         <a href="win32.c.html#LN36"><span class='Ref_to_Func'>libpq_gettext</span></a><span class='Parentheses'>(</span><span class='String'>"function requires at least protocol version 3.0\n"</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <span class='Number'>0</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * We will send Parse (if needed), Bind, Describe Portal, Execute, Sync, 
     * using specified statement name and the unnamed portal. 
     */ 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1406"><span class='Ref_to_Parameter'>command</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* construct the Parse message */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-misc.c.html#LN519"><span class='Ref_to_Func'>pqPutMsgStart</span></a><span class='Parentheses'>(</span><span class='String'>'P'</span><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN1405"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT; </span><span class='Number'>0</span> <span class='Operator'>|| 
</span>            <a href="fe-misc.c.html#LN179"><span class='Ref_to_Func'>pqPuts</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1407"><span class='Ref_to_Parameter'>stmtName</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN1405"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT; </span><span class='Number'>0</span> <span class='Operator'>|| 
</span>            <a href="fe-misc.c.html#LN179"><span class='Ref_to_Func'>pqPuts</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1406"><span class='Ref_to_Parameter'>command</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN1405"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
            <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="fe-exec.c.html#LN1565"><span class='Ref_to_Label'>sendFailed</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1408"><span class='Ref_to_Parameter'>nParams</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span> <span class='Operator'>&& </span><a href="fe-exec.c.html#LN1409"><span class='Ref_to_Parameter'>paramTypes</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-misc.c.html#LN307"><span class='Ref_to_Func'>pqPutInt</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1408"><span class='Ref_to_Parameter'>nParams</span></a><span class='Delimiter'>, </span><span class='Number'>2</span><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN1405"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
                <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="fe-exec.c.html#LN1565"><span class='Ref_to_Label'>sendFailed</span></a><span class='Delimiter'>; 
</span>            <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1415"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="fe-exec.c.html#LN1415"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="fe-exec.c.html#LN1408"><span class='Ref_to_Parameter'>nParams</span></a><span class='Delimiter'>; </span><a href="fe-exec.c.html#LN1415"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-misc.c.html#LN307"><span class='Ref_to_Func'>pqPutInt</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1409"><span class='Ref_to_Parameter'>paramTypes</span></a><span class='Delimiter'>[</span><a href="fe-exec.c.html#LN1415"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>], </span><span class='Number'>4</span><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN1405"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
                    <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="fe-exec.c.html#LN1565"><span class='Ref_to_Label'>sendFailed</span></a><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-misc.c.html#LN307"><span class='Ref_to_Func'>pqPutInt</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Delimiter'>, </span><span class='Number'>2</span><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN1405"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
                <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="fe-exec.c.html#LN1565"><span class='Ref_to_Label'>sendFailed</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-misc.c.html#LN587"><span class='Ref_to_Func'>pqPutMsgEnd</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1405"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
            <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="fe-exec.c.html#LN1565"><span class='Ref_to_Label'>sendFailed</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if command &raquo; </span> 
 
    <span class='Comment_Multi_Line'>/* Construct the Bind message */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-misc.c.html#LN519"><span class='Ref_to_Func'>pqPutMsgStart</span></a><span class='Parentheses'>(</span><span class='String'>'B'</span><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN1405"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT; </span><span class='Number'>0</span> <span class='Operator'>|| 
</span>        <a href="fe-misc.c.html#LN179"><span class='Ref_to_Func'>pqPuts</span></a><span class='Parentheses'>(</span><span class='String'>""</span><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN1405"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT; </span><span class='Number'>0</span> <span class='Operator'>|| 
</span>        <a href="fe-misc.c.html#LN179"><span class='Ref_to_Func'>pqPuts</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1407"><span class='Ref_to_Parameter'>stmtName</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN1405"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="fe-exec.c.html#LN1565"><span class='Ref_to_Label'>sendFailed</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Send parameter formats */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1408"><span class='Ref_to_Parameter'>nParams</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span> <span class='Operator'>&& </span><a href="fe-exec.c.html#LN1412"><span class='Ref_to_Parameter'>paramFormats</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-misc.c.html#LN307"><span class='Ref_to_Func'>pqPutInt</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1408"><span class='Ref_to_Parameter'>nParams</span></a><span class='Delimiter'>, </span><span class='Number'>2</span><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN1405"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
            <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="fe-exec.c.html#LN1565"><span class='Ref_to_Label'>sendFailed</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1415"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="fe-exec.c.html#LN1415"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="fe-exec.c.html#LN1408"><span class='Ref_to_Parameter'>nParams</span></a><span class='Delimiter'>; </span><a href="fe-exec.c.html#LN1415"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-misc.c.html#LN307"><span class='Ref_to_Func'>pqPutInt</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1412"><span class='Ref_to_Parameter'>paramFormats</span></a><span class='Delimiter'>[</span><a href="fe-exec.c.html#LN1415"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>], </span><span class='Number'>2</span><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN1405"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
                <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="fe-exec.c.html#LN1565"><span class='Ref_to_Label'>sendFailed</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-misc.c.html#LN307"><span class='Ref_to_Func'>pqPutInt</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Delimiter'>, </span><span class='Number'>2</span><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN1405"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
            <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="fe-exec.c.html#LN1565"><span class='Ref_to_Label'>sendFailed</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-misc.c.html#LN307"><span class='Ref_to_Func'>pqPutInt</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1408"><span class='Ref_to_Parameter'>nParams</span></a><span class='Delimiter'>, </span><span class='Number'>2</span><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN1405"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="fe-exec.c.html#LN1565"><span class='Ref_to_Label'>sendFailed</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Send parameters */ 
</span>    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1415"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="fe-exec.c.html#LN1415"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="fe-exec.c.html#LN1408"><span class='Ref_to_Parameter'>nParams</span></a><span class='Delimiter'>; </span><a href="fe-exec.c.html#LN1415"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1410"><span class='Ref_to_Parameter'>paramValues</span></a> <span class='Operator'>&& </span><a href="fe-exec.c.html#LN1410"><span class='Ref_to_Parameter'>paramValues</span></a><span class='Delimiter'>[</span><a href="fe-exec.c.html#LN1415"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span><a name="LN1487"></a>            <span class='Keyword'>int</span>         <span class='Declare_Local'>nbytes</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1412"><span class='Ref_to_Parameter'>paramFormats</span></a> <span class='Operator'>&& </span><a href="fe-exec.c.html#LN1412"><span class='Ref_to_Parameter'>paramFormats</span></a><span class='Delimiter'>[</span><a href="fe-exec.c.html#LN1415"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>] </span><span class='Operator'>!= </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <span class='Comment_Multi_Line'>/* binary parameter */ 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1411"><span class='Ref_to_Parameter'>paramLengths</span></a><span class='Parentheses'>) 
</span>                    <a href="fe-exec.c.html#LN1487"><span class='Ref_To_Local'>nbytes</span></a> <span class='Operator'>= </span><a href="fe-exec.c.html#LN1411"><span class='Ref_to_Parameter'>paramLengths</span></a><span class='Delimiter'>[</span><a href="fe-exec.c.html#LN1415"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]; 
</span>                <span class='Control'>else</span> 
                <span class='Delimiter'>{ 
</span>                    <a href="pqexpbuffer.c.html#LN232"><span class='Ref_to_Func'>printfPQExpBuffer</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="fe-exec.c.html#LN1405"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN491"><span class='Ref_to_Member'>errorMessage</span></a><span class='Delimiter'>, 
</span>                                      <a href="win32.c.html#LN36"><span class='Ref_to_Func'>libpq_gettext</span></a><span class='Parentheses'>(</span><span class='String'>"length must be given for binary parameter\n"</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>                    <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="fe-exec.c.html#LN1565"><span class='Ref_to_Label'>sendFailed</span></a><span class='Delimiter'>; 
</span>                <span class='Delimiter'>} 
</span>            <span class='Delimiter'>} 
</span>            <span class='Control'>else</span> 
            <span class='Delimiter'>{ 
</span>                <span class='Comment_Multi_Line'>/* text parameter, do not use paramLengths */ 
</span>                <a href="fe-exec.c.html#LN1487"><span class='Ref_To_Local'>nbytes</span></a> <span class='Operator'>= </span>strlen<span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1410"><span class='Ref_to_Parameter'>paramValues</span></a><span class='Delimiter'>[</span><a href="fe-exec.c.html#LN1415"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-misc.c.html#LN307"><span class='Ref_to_Func'>pqPutInt</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1487"><span class='Ref_To_Local'>nbytes</span></a><span class='Delimiter'>, </span><span class='Number'>4</span><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN1405"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT; </span><span class='Number'>0</span> <span class='Operator'>|| 
</span>                <a href="fe-misc.c.html#LN246"><span class='Ref_to_Func'>pqPutnchar</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1410"><span class='Ref_to_Parameter'>paramValues</span></a><span class='Delimiter'>[</span><a href="fe-exec.c.html#LN1415"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>], </span><a href="fe-exec.c.html#LN1487"><span class='Ref_To_Local'>nbytes</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN1405"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
                <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="fe-exec.c.html#LN1565"><span class='Ref_to_Label'>sendFailed</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if paramValues&&paramVal... &raquo; </span> 
        <span class='Control'>else</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* take the param as NULL */ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-misc.c.html#LN307"><span class='Ref_to_Func'>pqPutInt</span></a><span class='Parentheses'>(</span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Number'>4</span><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN1405"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
                <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="fe-exec.c.html#LN1565"><span class='Ref_to_Label'>sendFailed</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end for i=0;i&LT;nParams;i++ &raquo; </span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-misc.c.html#LN307"><span class='Ref_to_Func'>pqPutInt</span></a><span class='Parentheses'>(</span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Number'>2</span><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN1405"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT; </span><span class='Number'>0</span> <span class='Operator'>|| 
</span>        <a href="fe-misc.c.html#LN307"><span class='Ref_to_Func'>pqPutInt</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1413"><span class='Ref_to_Parameter'>resultFormat</span></a><span class='Delimiter'>, </span><span class='Number'>2</span><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN1405"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>))</span> 
        <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="fe-exec.c.html#LN1565"><span class='Ref_to_Label'>sendFailed</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-misc.c.html#LN587"><span class='Ref_to_Func'>pqPutMsgEnd</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1405"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="fe-exec.c.html#LN1565"><span class='Ref_to_Label'>sendFailed</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* construct the Describe Portal message */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-misc.c.html#LN519"><span class='Ref_to_Func'>pqPutMsgStart</span></a><span class='Parentheses'>(</span><span class='String'>'D'</span><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN1405"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT; </span><span class='Number'>0</span> <span class='Operator'>|| 
</span>        <a href="fe-misc.c.html#LN112"><span class='Ref_to_Func'>pqPutc</span></a><span class='Parentheses'>(</span><span class='String'>'P'</span><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN1405"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT; </span><span class='Number'>0</span> <span class='Operator'>|| 
</span>        <a href="fe-misc.c.html#LN179"><span class='Ref_to_Func'>pqPuts</span></a><span class='Parentheses'>(</span><span class='String'>""</span><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN1405"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT; </span><span class='Number'>0</span> <span class='Operator'>|| 
</span>        <a href="fe-misc.c.html#LN587"><span class='Ref_to_Func'>pqPutMsgEnd</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1405"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="fe-exec.c.html#LN1565"><span class='Ref_to_Label'>sendFailed</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* construct the Execute message */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-misc.c.html#LN519"><span class='Ref_to_Func'>pqPutMsgStart</span></a><span class='Parentheses'>(</span><span class='String'>'E'</span><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN1405"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT; </span><span class='Number'>0</span> <span class='Operator'>|| 
</span>        <a href="fe-misc.c.html#LN179"><span class='Ref_to_Func'>pqPuts</span></a><span class='Parentheses'>(</span><span class='String'>""</span><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN1405"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT; </span><span class='Number'>0</span> <span class='Operator'>|| 
</span>        <a href="fe-misc.c.html#LN307"><span class='Ref_to_Func'>pqPutInt</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Delimiter'>, </span><span class='Number'>4</span><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN1405"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT; </span><span class='Number'>0</span> <span class='Operator'>|| 
</span>        <a href="fe-misc.c.html#LN587"><span class='Ref_to_Func'>pqPutMsgEnd</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1405"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="fe-exec.c.html#LN1565"><span class='Ref_to_Label'>sendFailed</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* construct the Sync message */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-misc.c.html#LN519"><span class='Ref_to_Func'>pqPutMsgStart</span></a><span class='Parentheses'>(</span><span class='String'>'S'</span><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN1405"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT; </span><span class='Number'>0</span> <span class='Operator'>|| 
</span>        <a href="fe-misc.c.html#LN587"><span class='Ref_to_Func'>pqPutMsgEnd</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1405"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="fe-exec.c.html#LN1565"><span class='Ref_to_Label'>sendFailed</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* remember we are using extended query protocol */ 
</span>    <a href="fe-exec.c.html#LN1405"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN380"><span class='Ref_to_Member'>queryclass</span></a> <span class='Operator'>= </span><a href="libpq-int.h.html#LN227"><span class='Ref_to_EnumConst'>PGQUERY_EXTENDED</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* and remember the query text too, if possible */ 
</span>    <span class='Comment_Multi_Line'>/* if insufficient memory, last_query just winds up NULL */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1405"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN381"><span class='Ref_to_Member'>last_query</span></a><span class='Parentheses'>) 
</span>        <a href="../../include/snowball/header.h.html#LN64"><span class='Ref_to_Macro'>free</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1405"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN381"><span class='Ref_to_Member'>last_query</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1406"><span class='Ref_to_Parameter'>command</span></a><span class='Parentheses'>) 
</span>        <a href="fe-exec.c.html#LN1405"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN381"><span class='Ref_to_Member'>last_query</span></a> <span class='Operator'>= </span>strdup<span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1406"><span class='Ref_to_Parameter'>command</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
        <a href="fe-exec.c.html#LN1405"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN381"><span class='Ref_to_Member'>last_query</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Give the data a push.  In nonblock mode, don't complain if we're unable 
     * to send it all; PQgetResult() will do any additional flushing needed. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="libpq-int.h.html#LN637"><span class='Ref_to_Proto'>pqFlush</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1405"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="fe-exec.c.html#LN1565"><span class='Ref_to_Label'>sendFailed</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* OK, it's launched! */ 
</span>    <a href="fe-exec.c.html#LN1405"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN378"><span class='Ref_to_Member'>asyncStatus</span></a> <span class='Operator'>= </span><a href="libpq-int.h.html#LN216"><span class='Ref_to_EnumConst'>PGASYNC_BUSY</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <span class='Number'>1</span><span class='Delimiter'>; 
</span> 
<a name="LN1565"></a><span class='Label'>sendFailed</span><span class='Operator'>: 
</span>    <a href="libpq-int.h.html#LN580"><span class='Ref_to_Proto'>pqHandleSendFailure</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1405"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <span class='Number'>0</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end PQsendQueryGuts &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * pqHandleSendFailure: try to clean up after failure to send command. 
 * 
 * Primarily, what we want to accomplish here is to process any ERROR or 
 * NOTICE messages that the backend might have sent just before it died. 
 * Since we're in IDLE state, all such messages will get sent to the notice 
 * processor. 
 * 
 * NOTE: this routine should only be called in PGASYNC_IDLE state. 
 */ 
</span><span class='Keyword'>void 
</span><a name="LN1581"></a><span class='Declare_Function'>pqHandleSendFailure</span><span class='Parentheses'>(</span><a href="libpq-fe.h.html#LN139"><span class='Ref_to_Typedef'>PGconn</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>conn</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Comment_Multi_Line'>/* 
     * Accept and parse any available input data, ignoring I/O errors.  Note 
     * that if pqReadData decides the backend has closed the channel, it will 
     * close our side of the socket --- that's just what we want here. 
     */ 
</span>    <span class='Control'>while</span> <span class='Parentheses'>(</span><a href="fe-misc.c.html#LN629"><span class='Ref_to_Func'>pqReadData</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1581"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>) </span><span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <a href="fe-exec.c.html#LN64"><span class='Ref_to_Proto'>parseInput</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1581"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Be sure to parse available input messages even if we read no data. 
     * (Note: calling parseInput within the above loop isn't really necessary, 
     * but it prevents buffer bloat if there's a lot of data available.) 
     */ 
</span>    <a href="fe-exec.c.html#LN64"><span class='Ref_to_Proto'>parseInput</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1581"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * Select row-by-row processing mode 
 */ 
</span><span class='Keyword'>int 
</span><a name="LN1603"></a><span class='Declare_Function'>PQsetSingleRowMode</span><span class='Parentheses'>(</span><a href="libpq-fe.h.html#LN139"><span class='Ref_to_Typedef'>PGconn</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>conn</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Comment_Multi_Line'>/* 
     * Only allow setting the flag when we have launched a query and not yet 
     * received any results. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="fe-exec.c.html#LN1603"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <span class='Number'>0</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1603"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN378"><span class='Ref_to_Member'>asyncStatus</span></a> <span class='Operator'>!= </span><a href="libpq-int.h.html#LN216"><span class='Ref_to_EnumConst'>PGASYNC_BUSY</span></a><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <span class='Number'>0</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1603"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN380"><span class='Ref_to_Member'>queryclass</span></a> <span class='Operator'>!= </span><a href="libpq-int.h.html#LN226"><span class='Ref_to_EnumConst'>PGQUERY_SIMPLE</span></a> <span class='Operator'>&& 
</span>        <a href="fe-exec.c.html#LN1603"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN380"><span class='Ref_to_Member'>queryclass</span></a> <span class='Operator'>!= </span><a href="libpq-int.h.html#LN227"><span class='Ref_to_EnumConst'>PGQUERY_EXTENDED</span></a><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <span class='Number'>0</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1603"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN450"><span class='Ref_to_Member'>result</span></a><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <span class='Number'>0</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* OK, set flag */ 
</span>    <a href="fe-exec.c.html#LN1603"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN386"><span class='Ref_to_Member'>singleRowMode</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <span class='Number'>1</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end PQsetSingleRowMode &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * Consume any available input from the backend 
 * 0 return: some kind of trouble 
 * 1 return: no problem 
 */ 
</span><span class='Keyword'>int 
</span><a name="LN1630"></a><span class='Declare_Function'>PQconsumeInput</span><span class='Parentheses'>(</span><a href="libpq-fe.h.html#LN139"><span class='Ref_to_Typedef'>PGconn</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>conn</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="fe-exec.c.html#LN1630"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <span class='Number'>0</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * for non-blocking connections try to flush the send-queue, otherwise we 
     * may never get a response for something that may not have already been 
     * sent because it's in our write buffer! 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="libpq-int.h.html#LN676"><span class='Ref_to_Macro'>pqIsnonblocking</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1630"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="libpq-int.h.html#LN637"><span class='Ref_to_Proto'>pqFlush</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1630"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
            <span class='Control'>return</span> <span class='Number'>0</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Load more data, if available. We do this no matter what state we are 
     * in, since we are probably getting called because the application wants 
     * to get rid of a read-select condition. Note that we will NOT block 
     * waiting for more input. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-misc.c.html#LN629"><span class='Ref_to_Func'>pqReadData</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1630"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <span class='Control'>return</span> <span class='Number'>0</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Parsing of the data waits till later. */ 
</span>    <span class='Control'>return</span> <span class='Number'>1</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end PQconsumeInput &raquo; </span> 
 
 
<span class='Comment_Multi_Line'>/* 
 * parseInput: if appropriate, parse input data from backend 
 * until input is exhausted or a stopping state is reached. 
 * Note that this function will NOT attempt to read more data from the backend. 
 */ 
</span><span class='Keyword'>static void 
</span><a name="LN1666"></a><span class='Declare_Function'>parseInput</span><span class='Parentheses'>(</span><a href="libpq-fe.h.html#LN139"><span class='Ref_to_Typedef'>PGconn</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>conn</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/libpq/pqcomm.h.html#LN103"><span class='Ref_to_Macro'>PG_PROTOCOL_MAJOR</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1666"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN403"><span class='Ref_to_Member'>pversion</span></a><span class='Parentheses'>) </span><span class='Operator'>&GT;= </span><span class='Number'>3</span><span class='Parentheses'>)</span> 
        <a href="fe-protocol3.c.html#LN64"><span class='Ref_to_Func'>pqParseInput3</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1666"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
        <a href="fe-protocol2.c.html#LN409"><span class='Ref_to_Func'>pqParseInput2</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1666"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * PQisBusy 
 *   Return TRUE if PQgetResult would block waiting for input. 
 */ 
</span> 
<span class='Keyword'>int 
</span><a name="LN1680"></a><span class='Declare_Function'>PQisBusy</span><span class='Parentheses'>(</span><a href="libpq-fe.h.html#LN139"><span class='Ref_to_Typedef'>PGconn</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>conn</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="fe-exec.c.html#LN1680"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <span class='Boolean'>FALSE</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Parse any available data, if our state permits. */ 
</span>    <a href="fe-exec.c.html#LN64"><span class='Ref_to_Proto'>parseInput</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1680"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* PQgetResult will return immediately in all states except BUSY. */ 
</span>    <span class='Control'>return</span> <a href="fe-exec.c.html#LN1680"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN378"><span class='Ref_to_Member'>asyncStatus</span></a> <span class='Operator'>== </span><a href="libpq-int.h.html#LN216"><span class='Ref_to_EnumConst'>PGASYNC_BUSY</span></a><span class='Delimiter'>; 
} 
</span> 
 
<span class='Comment_Multi_Line'>/* 
 * PQgetResult 
 *    Get the next PGresult produced by a query.  Returns NULL if no 
 *    query work remains or an error has occurred (e.g. out of 
 *    memory). 
 */ 
</span> 
<a href="libpq-fe.h.html#LN146"><span class='Ref_to_Typedef'>PGresult</span></a> <span class='Operator'>* 
</span><a name="LN1701"></a><span class='Declare_Function'>PQgetResult</span><span class='Parentheses'>(</span><a href="libpq-fe.h.html#LN139"><span class='Ref_to_Typedef'>PGconn</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>conn</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1703"></a>    <a href="libpq-fe.h.html#LN146"><span class='Ref_to_Typedef'>PGresult</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>res</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="fe-exec.c.html#LN1701"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Parse any available data, if our state permits. */ 
</span>    <a href="fe-exec.c.html#LN64"><span class='Ref_to_Proto'>parseInput</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1701"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* If not ready to return something, block until we are. */ 
</span>    <span class='Control'>while</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1701"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN378"><span class='Ref_to_Member'>asyncStatus</span></a> <span class='Operator'>== </span><a href="libpq-int.h.html#LN216"><span class='Ref_to_EnumConst'>PGASYNC_BUSY</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN1714"></a>        <span class='Keyword'>int</span>         <span class='Declare_Local'>flushResult</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * If data remains unsent, send it.  Else we might be waiting for the 
         * result of a command the backend hasn't even got yet. 
         */ 
</span>        <span class='Control'>while</span> <span class='Parentheses'>((</span><a href="fe-exec.c.html#LN1714"><span class='Ref_To_Local'>flushResult</span></a> <span class='Operator'>= </span><a href="libpq-int.h.html#LN637"><span class='Ref_to_Proto'>pqFlush</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1701"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>))</span> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="libpq-int.h.html#LN638"><span class='Ref_to_Proto'>pqWait</span></a><span class='Parentheses'>(</span><span class='Boolean'>FALSE</span><span class='Delimiter'>, </span><span class='Boolean'>TRUE</span><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN1701"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>))</span> 
            <span class='Delimiter'>{ 
</span>                <a href="fe-exec.c.html#LN1714"><span class='Ref_To_Local'>flushResult</span></a> <span class='Operator'>= -</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>        <span class='Delimiter'>} 
</span> 
        <span class='Comment_Multi_Line'>/* Wait for some more data, and load it. */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1714"><span class='Ref_To_Local'>flushResult</span></a> <span class='Operator'>|| 
</span>            <a href="libpq-int.h.html#LN638"><span class='Ref_to_Proto'>pqWait</span></a><span class='Parentheses'>(</span><span class='Boolean'>TRUE</span><span class='Delimiter'>, </span><span class='Boolean'>FALSE</span><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN1701"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>) </span><span class='Operator'>|| 
</span>            <a href="fe-misc.c.html#LN629"><span class='Ref_to_Func'>pqReadData</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1701"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* 
             * conn-&GT;errorMessage has been set by pqWait or pqReadData. We 
             * want to append it to any already-received error message. 
             */ 
</span>            <a href="libpq-int.h.html#LN572"><span class='Ref_to_Proto'>pqSaveErrorResult</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1701"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="fe-exec.c.html#LN1701"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN378"><span class='Ref_to_Member'>asyncStatus</span></a> <span class='Operator'>= </span><a href="libpq-int.h.html#LN215"><span class='Ref_to_EnumConst'>PGASYNC_IDLE</span></a><span class='Delimiter'>; 
</span>            <span class='Control'>return</span> <a href="libpq-int.h.html#LN573"><span class='Ref_to_Proto'>pqPrepareAsyncResult</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1701"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span> 
        <span class='Comment_Multi_Line'>/* Parse it. */ 
</span>        <a href="fe-exec.c.html#LN64"><span class='Ref_to_Proto'>parseInput</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1701"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end while conn-&GT;asyncStatus==PG... &raquo; </span> 
 
    <span class='Comment_Multi_Line'>/* Return the appropriate thing. */ 
</span>    <span class='Control'>switch</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1701"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN378"><span class='Ref_to_Member'>asyncStatus</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>case</span> <a href="libpq-int.h.html#LN215"><span class='Ref_to_EnumConst'>PGASYNC_IDLE</span></a><span class='Operator'>: 
</span>            <a href="fe-exec.c.html#LN1703"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>;</span>         <span class='Comment_Single_Line'>/* query is complete */ 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Control'>case</span> <a href="libpq-int.h.html#LN217"><span class='Ref_to_EnumConst'>PGASYNC_READY</span></a><span class='Operator'>: 
</span>            <a href="fe-exec.c.html#LN1703"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="libpq-int.h.html#LN573"><span class='Ref_to_Proto'>pqPrepareAsyncResult</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1701"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Comment_Multi_Line'>/* Set the state back to BUSY, allowing parsing to proceed. */ 
</span>            <a href="fe-exec.c.html#LN1701"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN378"><span class='Ref_to_Member'>asyncStatus</span></a> <span class='Operator'>= </span><a href="libpq-int.h.html#LN216"><span class='Ref_to_EnumConst'>PGASYNC_BUSY</span></a><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Control'>case</span> <a href="libpq-int.h.html#LN218"><span class='Ref_to_EnumConst'>PGASYNC_COPY_IN</span></a><span class='Operator'>: 
</span>            <a href="fe-exec.c.html#LN1703"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="fe-exec.c.html#LN65"><span class='Ref_to_Proto'>getCopyResult</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1701"><span class='Ref_to_Parameter'>conn</span></a><span class='Delimiter'>, </span><a href="libpq-fe.h.html#LN91"><span class='Ref_to_EnumConst'>PGRES_COPY_IN</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Control'>case</span> <a href="libpq-int.h.html#LN219"><span class='Ref_to_EnumConst'>PGASYNC_COPY_OUT</span></a><span class='Operator'>: 
</span>            <a href="fe-exec.c.html#LN1703"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="fe-exec.c.html#LN65"><span class='Ref_to_Proto'>getCopyResult</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1701"><span class='Ref_to_Parameter'>conn</span></a><span class='Delimiter'>, </span><a href="libpq-fe.h.html#LN90"><span class='Ref_to_EnumConst'>PGRES_COPY_OUT</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Control'>case</span> <a href="libpq-int.h.html#LN220"><span class='Ref_to_EnumConst'>PGASYNC_COPY_BOTH</span></a><span class='Operator'>: 
</span>            <a href="fe-exec.c.html#LN1703"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="fe-exec.c.html#LN65"><span class='Ref_to_Proto'>getCopyResult</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1701"><span class='Ref_to_Parameter'>conn</span></a><span class='Delimiter'>, </span><a href="libpq-fe.h.html#LN96"><span class='Ref_to_EnumConst'>PGRES_COPY_BOTH</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Control'>default</span><span class='Operator'>: 
</span>            <a href="pqexpbuffer.c.html#LN232"><span class='Ref_to_Func'>printfPQExpBuffer</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="fe-exec.c.html#LN1701"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN491"><span class='Ref_to_Member'>errorMessage</span></a><span class='Delimiter'>, 
</span>                              <a href="win32.c.html#LN36"><span class='Ref_to_Func'>libpq_gettext</span></a><span class='Parentheses'>(</span><span class='String'>"unexpected asyncStatus: %d\n"</span><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                              <span class='Parentheses'>(</span><span class='Keyword'>int</span><span class='Parentheses'>) </span><a href="fe-exec.c.html#LN1701"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN378"><span class='Ref_to_Member'>asyncStatus</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="fe-exec.c.html#LN1703"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="fe-exec.c.html#LN138"><span class='Ref_to_Func'>PQmakeEmptyPGresult</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1701"><span class='Ref_to_Parameter'>conn</span></a><span class='Delimiter'>, </span><a href="libpq-fe.h.html#LN95"><span class='Ref_to_EnumConst'>PGRES_FATAL_ERROR</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end switch conn-&GT;asyncStatus &raquo; </span> 
 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1703"><span class='Ref_To_Local'>res</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN1777"></a>        <span class='Keyword'>int</span>         <span class='Declare_Local'>i</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1777"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="fe-exec.c.html#LN1777"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="fe-exec.c.html#LN1703"><span class='Ref_To_Local'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN187"><span class='Ref_to_Member'>nEvents</span></a><span class='Delimiter'>; </span><a href="fe-exec.c.html#LN1777"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span><a name="LN1781"></a>            <a href="libpq-events.h.html#LN51"><span class='Ref_to_Typedef'>PGEventResultCreate</span></a> <span class='Declare_Local'>evt</span><span class='Delimiter'>; 
</span> 
            <a href="fe-exec.c.html#LN1781"><span class='Ref_To_Local'>evt</span></a><span class='Operator'>.</span><a href="libpq-events.h.html#LN53"><span class='Ref_to_Member'>conn</span></a> <span class='Operator'>= </span><a href="fe-exec.c.html#LN1701"><span class='Ref_to_Parameter'>conn</span></a><span class='Delimiter'>; 
</span>            <a href="fe-exec.c.html#LN1781"><span class='Ref_To_Local'>evt</span></a><span class='Operator'>.</span><a href="libpq-events.h.html#LN54"><span class='Ref_to_Member'>result</span></a> <span class='Operator'>= </span><a href="fe-exec.c.html#LN1703"><span class='Ref_To_Local'>res</span></a><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="fe-exec.c.html#LN1703"><span class='Ref_To_Local'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN186"><span class='Ref_to_Member'>events</span></a><span class='Delimiter'>[</span><a href="fe-exec.c.html#LN1777"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="libpq-int.h.html#LN159"><span class='Ref_to_Member'>proc</span></a><span class='Parentheses'>(</span><a href="libpq-events.h.html#LN31"><span class='Ref_to_EnumConst'>PGEVT_RESULTCREATE</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="fe-exec.c.html#LN1781"><span class='Ref_To_Local'>evt</span></a><span class='Delimiter'>, 
</span>                                     <a href="fe-exec.c.html#LN1703"><span class='Ref_To_Local'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN186"><span class='Ref_to_Member'>events</span></a><span class='Delimiter'>[</span><a href="fe-exec.c.html#LN1777"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="libpq-int.h.html#LN161"><span class='Ref_to_Member'>passThrough</span></a><span class='Parentheses'>))</span> 
            <span class='Delimiter'>{ 
</span>                <a href="pqexpbuffer.c.html#LN232"><span class='Ref_to_Func'>printfPQExpBuffer</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="fe-exec.c.html#LN1701"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN491"><span class='Ref_to_Member'>errorMessage</span></a><span class='Delimiter'>, 
</span>                                  <a href="win32.c.html#LN36"><span class='Ref_to_Func'>libpq_gettext</span></a><span class='Parentheses'>(</span><span class='String'>"PGEventProc \"%s\" failed during PGEVT_RESULTCREATE event\n"</span><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                                  <a href="fe-exec.c.html#LN1703"><span class='Ref_To_Local'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN186"><span class='Ref_to_Member'>events</span></a><span class='Delimiter'>[</span><a href="fe-exec.c.html#LN1777"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="libpq-int.h.html#LN160"><span class='Ref_to_Member'>name</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <a href="libpq-int.h.html#LN567"><span class='Ref_to_Proto'>pqSetResultError</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1703"><span class='Ref_To_Local'>res</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN1701"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN491"><span class='Ref_to_Member'>errorMessage</span></a><span class='Operator'>.</span><a href="pqexpbuffer.h.html#LN45"><span class='Ref_to_Member'>data</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <a href="fe-exec.c.html#LN1703"><span class='Ref_To_Local'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN176"><span class='Ref_to_Member'>resultStatus</span></a> <span class='Operator'>= </span><a href="libpq-fe.h.html#LN95"><span class='Ref_to_EnumConst'>PGRES_FATAL_ERROR</span></a><span class='Delimiter'>; 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>            <a href="fe-exec.c.html#LN1703"><span class='Ref_To_Local'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN186"><span class='Ref_to_Member'>events</span></a><span class='Delimiter'>[</span><a href="fe-exec.c.html#LN1777"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="libpq-int.h.html#LN163"><span class='Ref_to_Member'>resultInitialized</span></a> <span class='Operator'>= </span><span class='Boolean'>TRUE</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if res &raquo; </span> 
 
    <span class='Control'>return</span> <a href="fe-exec.c.html#LN1703"><span class='Ref_To_Local'>res</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end PQgetResult &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * getCopyResult 
 *    Helper for PQgetResult: generate result for COPY-in-progress cases 
 */ 
</span><span class='Keyword'>static </span><a href="libpq-fe.h.html#LN146"><span class='Ref_to_Typedef'>PGresult</span></a> <span class='Operator'>* 
</span><a name="LN1807"></a><span class='Declare_Function'>getCopyResult</span><span class='Parentheses'>(</span><a href="libpq-fe.h.html#LN139"><span class='Ref_to_Typedef'>PGconn</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>conn</span><span class='Delimiter'>, </span><a href="libpq-fe.h.html#LN81"><span class='Ref_to_Typedef'>ExecStatusType</span></a> <span class='Declare_Parameter'>copytype</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Comment_Multi_Line'>/* 
     * If the server connection has been lost, don't pretend everything is 
     * hunky-dory; instead return a PGRES_FATAL_ERROR result, and reset the 
     * asyncStatus to idle (corresponding to what we'd do if we'd detected I/O 
     * error in the earlier steps in PQgetResult).  The text returned in the 
     * result is whatever is in conn-&GT;errorMessage; we hope that was filled 
     * with something relevant when the lost connection was detected. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1807"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN377"><span class='Ref_to_Member'>status</span></a> <span class='Operator'>!= </span><a href="libpq-fe.h.html#LN48"><span class='Ref_to_EnumConst'>CONNECTION_OK</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="libpq-int.h.html#LN572"><span class='Ref_to_Proto'>pqSaveErrorResult</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1807"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="fe-exec.c.html#LN1807"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN378"><span class='Ref_to_Member'>asyncStatus</span></a> <span class='Operator'>= </span><a href="libpq-int.h.html#LN215"><span class='Ref_to_EnumConst'>PGASYNC_IDLE</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <a href="libpq-int.h.html#LN573"><span class='Ref_to_Proto'>pqPrepareAsyncResult</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1807"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* If we have an async result for the COPY, return that */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1807"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN450"><span class='Ref_to_Member'>result</span></a> <span class='Operator'>&& </span><a href="fe-exec.c.html#LN1807"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN450"><span class='Ref_to_Member'>result</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN176"><span class='Ref_to_Member'>resultStatus</span></a> <span class='Operator'>== </span><a href="fe-exec.c.html#LN1807"><span class='Ref_to_Parameter'>copytype</span></a><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <a href="libpq-int.h.html#LN573"><span class='Ref_to_Proto'>pqPrepareAsyncResult</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1807"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Otherwise, invent a suitable PGresult */ 
</span>    <span class='Control'>return</span> <a href="fe-exec.c.html#LN138"><span class='Ref_to_Func'>PQmakeEmptyPGresult</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1807"><span class='Ref_to_Parameter'>conn</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN1807"><span class='Ref_to_Parameter'>copytype</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end getCopyResult &raquo; </span> 
 
 
<span class='Comment_Multi_Line'>/* 
 * PQexec 
 *    send a query to the backend and package up the result in a PGresult 
 * 
 * If the query was not even sent, return NULL; conn-&GT;errorMessage is set to 
 * a relevant message. 
 * If the query was sent, a new PGresult is returned (which could indicate 
 * either success or failure). 
 * The user is responsible for freeing the PGresult via PQclear() 
 * when done with it. 
 */ 
</span><a href="libpq-fe.h.html#LN146"><span class='Ref_to_Typedef'>PGresult</span></a> <span class='Operator'>* 
</span><a name="LN1845"></a><span class='Declare_Function'>PQexec</span><span class='Parentheses'>(</span><a href="libpq-fe.h.html#LN139"><span class='Ref_to_Typedef'>PGconn</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>conn</span><span class='Delimiter'>, </span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>query</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="fe-exec.c.html#LN66"><span class='Ref_to_Proto'>PQexecStart</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1845"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>))</span> 
        <span class='Control'>return</span> <span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="libpq-fe.h.html#LN401"><span class='Ref_to_Proto'>PQsendQuery</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1845"><span class='Ref_to_Parameter'>conn</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN1845"><span class='Ref_to_Parameter'>query</span></a><span class='Parentheses'>))</span> 
        <span class='Control'>return</span> <span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <a href="fe-exec.c.html#LN67"><span class='Ref_to_Proto'>PQexecFinish</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1845"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * PQexecParams 
 *      Like PQexec, but use protocol 3.0 so we can pass parameters 
 */ 
</span><a href="libpq-fe.h.html#LN146"><span class='Ref_to_Typedef'>PGresult</span></a> <span class='Operator'>* 
</span><a name="LN1859"></a><span class='Declare_Function'>PQexecParams</span><span class='Parentheses'>(</span><a href="libpq-fe.h.html#LN139"><span class='Ref_to_Typedef'>PGconn</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>conn</span><span class='Delimiter'>, 
</span><a name="LN1860"></a>             <span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>command</span><span class='Delimiter'>, 
</span><a name="LN1861"></a>             <span class='Keyword'>int </span><span class='Declare_Parameter'>nParams</span><span class='Delimiter'>, 
</span><a name="LN1862"></a>             <span class='Keyword'>const </span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>paramTypes</span><span class='Delimiter'>, 
</span><a name="LN1863"></a>             <span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Keyword'>const </span><span class='Operator'>* </span><span class='Declare_Parameter'>paramValues</span><span class='Delimiter'>, 
</span><a name="LN1864"></a>             <span class='Keyword'>const int </span><span class='Operator'>*</span><span class='Declare_Parameter'>paramLengths</span><span class='Delimiter'>, 
</span><a name="LN1865"></a>             <span class='Keyword'>const int </span><span class='Operator'>*</span><span class='Declare_Parameter'>paramFormats</span><span class='Delimiter'>, 
</span><a name="LN1866"></a>             <span class='Keyword'>int </span><span class='Declare_Parameter'>resultFormat</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="fe-exec.c.html#LN66"><span class='Ref_to_Proto'>PQexecStart</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1859"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>))</span> 
        <span class='Control'>return</span> <span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="libpq-fe.h.html#LN402"><span class='Ref_to_Proto'>PQsendQueryParams</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1859"><span class='Ref_to_Parameter'>conn</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN1860"><span class='Ref_to_Parameter'>command</span></a><span class='Delimiter'>, 
</span>                           <a href="fe-exec.c.html#LN1861"><span class='Ref_to_Parameter'>nParams</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN1862"><span class='Ref_to_Parameter'>paramTypes</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN1863"><span class='Ref_to_Parameter'>paramValues</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN1864"><span class='Ref_to_Parameter'>paramLengths</span></a><span class='Delimiter'>, 
</span>                           <a href="fe-exec.c.html#LN1865"><span class='Ref_to_Parameter'>paramFormats</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN1866"><span class='Ref_to_Parameter'>resultFormat</span></a><span class='Parentheses'>))</span> 
        <span class='Control'>return</span> <span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <a href="fe-exec.c.html#LN67"><span class='Ref_to_Proto'>PQexecFinish</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1859"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * PQprepare 
 *    Creates a prepared statement by issuing a v3.0 parse message. 
 * 
 * If the query was not even sent, return NULL; conn-&GT;errorMessage is set to 
 * a relevant message. 
 * If the query was sent, a new PGresult is returned (which could indicate 
 * either success or failure). 
 * The user is responsible for freeing the PGresult via PQclear() 
 * when done with it. 
 */ 
</span><a href="libpq-fe.h.html#LN146"><span class='Ref_to_Typedef'>PGresult</span></a> <span class='Operator'>* 
</span><a name="LN1889"></a><span class='Declare_Function'>PQprepare</span><span class='Parentheses'>(</span><a href="libpq-fe.h.html#LN139"><span class='Ref_to_Typedef'>PGconn</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>conn</span><span class='Delimiter'>, 
</span><a name="LN1890"></a>          <span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>stmtName</span><span class='Delimiter'>, </span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>query</span><span class='Delimiter'>, 
</span><a name="LN1891"></a>          <span class='Keyword'>int </span><span class='Declare_Parameter'>nParams</span><span class='Delimiter'>, </span><span class='Keyword'>const </span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>paramTypes</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="fe-exec.c.html#LN66"><span class='Ref_to_Proto'>PQexecStart</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1889"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>))</span> 
        <span class='Control'>return</span> <span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="libpq-fe.h.html#LN410"><span class='Ref_to_Proto'>PQsendPrepare</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1889"><span class='Ref_to_Parameter'>conn</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN1890"><span class='Ref_to_Parameter'>stmtName</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN1890"><span class='Ref_to_Parameter'>query</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN1891"><span class='Ref_to_Parameter'>nParams</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN1891"><span class='Ref_to_Parameter'>paramTypes</span></a><span class='Parentheses'>))</span> 
        <span class='Control'>return</span> <span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <a href="fe-exec.c.html#LN67"><span class='Ref_to_Proto'>PQexecFinish</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1889"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * PQexecPrepared 
 *      Like PQexec, but execute a previously prepared statement, 
 *      using protocol 3.0 so we can pass parameters 
 */ 
</span><a href="libpq-fe.h.html#LN146"><span class='Ref_to_Typedef'>PGresult</span></a> <span class='Operator'>* 
</span><a name="LN1906"></a><span class='Declare_Function'>PQexecPrepared</span><span class='Parentheses'>(</span><a href="libpq-fe.h.html#LN139"><span class='Ref_to_Typedef'>PGconn</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>conn</span><span class='Delimiter'>, 
</span><a name="LN1907"></a>               <span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>stmtName</span><span class='Delimiter'>, 
</span><a name="LN1908"></a>               <span class='Keyword'>int </span><span class='Declare_Parameter'>nParams</span><span class='Delimiter'>, 
</span><a name="LN1909"></a>               <span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Keyword'>const </span><span class='Operator'>* </span><span class='Declare_Parameter'>paramValues</span><span class='Delimiter'>, 
</span><a name="LN1910"></a>               <span class='Keyword'>const int </span><span class='Operator'>*</span><span class='Declare_Parameter'>paramLengths</span><span class='Delimiter'>, 
</span><a name="LN1911"></a>               <span class='Keyword'>const int </span><span class='Operator'>*</span><span class='Declare_Parameter'>paramFormats</span><span class='Delimiter'>, 
</span><a name="LN1912"></a>               <span class='Keyword'>int </span><span class='Declare_Parameter'>resultFormat</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="fe-exec.c.html#LN66"><span class='Ref_to_Proto'>PQexecStart</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1906"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>))</span> 
        <span class='Control'>return</span> <span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="libpq-fe.h.html#LN413"><span class='Ref_to_Proto'>PQsendQueryPrepared</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1906"><span class='Ref_to_Parameter'>conn</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN1907"><span class='Ref_to_Parameter'>stmtName</span></a><span class='Delimiter'>, 
</span>                             <a href="fe-exec.c.html#LN1908"><span class='Ref_to_Parameter'>nParams</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN1909"><span class='Ref_to_Parameter'>paramValues</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN1910"><span class='Ref_to_Parameter'>paramLengths</span></a><span class='Delimiter'>, 
</span>                             <a href="fe-exec.c.html#LN1911"><span class='Ref_to_Parameter'>paramFormats</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN1912"><span class='Ref_to_Parameter'>resultFormat</span></a><span class='Parentheses'>))</span> 
        <span class='Control'>return</span> <span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <a href="fe-exec.c.html#LN67"><span class='Ref_to_Proto'>PQexecFinish</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1906"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * Common code for PQexec and sibling routines: prepare to send command 
 */ 
</span><span class='Keyword'>static bool 
</span><a name="LN1927"></a><span class='Declare_Function'>PQexecStart</span><span class='Parentheses'>(</span><a href="libpq-fe.h.html#LN139"><span class='Ref_to_Typedef'>PGconn</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>conn</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1929"></a>    <a href="libpq-fe.h.html#LN146"><span class='Ref_to_Typedef'>PGresult</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="fe-exec.c.html#LN1927"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <span class='Boolean'>false</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Silently discard any prior query result that application didn't eat. 
     * This is probably poor design, but it's here for backward compatibility. 
     */ 
</span>    <span class='Control'>while</span> <span class='Parentheses'>((</span><a href="fe-exec.c.html#LN1929"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="libpq-fe.h.html#LN421"><span class='Ref_to_Proto'>PQgetResult</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1927"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>))</span> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span> 
    <span class='Delimiter'>{ 
</span><a name="LN1940"></a>        <a href="libpq-fe.h.html#LN81"><span class='Ref_to_Typedef'>ExecStatusType</span></a> <span class='Declare_Local'>resultStatus</span> <span class='Operator'>= </span><a href="fe-exec.c.html#LN1929"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN176"><span class='Ref_to_Member'>resultStatus</span></a><span class='Delimiter'>; 
</span> 
        <a href="libpq-fe.h.html#LN501"><span class='Ref_to_Proto'>PQclear</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1929"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>;</span>        <span class='Comment_Single_Line'>/* only need its status */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1940"><span class='Ref_To_Local'>resultStatus</span></a> <span class='Operator'>== </span><a href="libpq-fe.h.html#LN91"><span class='Ref_to_EnumConst'>PGRES_COPY_IN</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/libpq/pqcomm.h.html#LN103"><span class='Ref_to_Macro'>PG_PROTOCOL_MAJOR</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1927"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN403"><span class='Ref_to_Member'>pversion</span></a><span class='Parentheses'>) </span><span class='Operator'>&GT;= </span><span class='Number'>3</span><span class='Parentheses'>)</span> 
            <span class='Delimiter'>{ 
</span>                <span class='Comment_Multi_Line'>/* In protocol 3, we can get out of a COPY IN state */ 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="libpq-fe.h.html#LN432"><span class='Ref_to_Proto'>PQputCopyEnd</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1927"><span class='Ref_to_Parameter'>conn</span></a><span class='Delimiter'>, 
</span>                         <a href="win32.c.html#LN36"><span class='Ref_to_Func'>libpq_gettext</span></a><span class='Parentheses'>(</span><span class='String'>"COPY terminated by new PQexec"</span><span class='Parentheses'>))</span> <span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
                    <span class='Control'>return</span> <span class='Boolean'>false</span><span class='Delimiter'>; 
</span>                <span class='Comment_Multi_Line'>/* keep waiting to swallow the copy's failure message */ 
</span>            <span class='Delimiter'>} 
</span>            <span class='Control'>else</span> 
            <span class='Delimiter'>{ 
</span>                <span class='Comment_Multi_Line'>/* In older protocols we have to punt */ 
</span>                <a href="pqexpbuffer.c.html#LN232"><span class='Ref_to_Func'>printfPQExpBuffer</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="fe-exec.c.html#LN1927"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN491"><span class='Ref_to_Member'>errorMessage</span></a><span class='Delimiter'>, 
</span>                  <a href="win32.c.html#LN36"><span class='Ref_to_Func'>libpq_gettext</span></a><span class='Parentheses'>(</span><span class='String'>"COPY IN state must be terminated first\n"</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>                <span class='Control'>return</span> <span class='Boolean'>false</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1940"><span class='Ref_To_Local'>resultStatus</span></a> <span class='Operator'>== </span><a href="libpq-fe.h.html#LN90"><span class='Ref_to_EnumConst'>PGRES_COPY_OUT</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/libpq/pqcomm.h.html#LN103"><span class='Ref_to_Macro'>PG_PROTOCOL_MAJOR</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1927"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN403"><span class='Ref_to_Member'>pversion</span></a><span class='Parentheses'>) </span><span class='Operator'>&GT;= </span><span class='Number'>3</span><span class='Parentheses'>)</span> 
            <span class='Delimiter'>{ 
</span>                <span class='Comment_Multi_Line'>/* 
                 * In protocol 3, we can get out of a COPY OUT state: we just 
                 * switch back to BUSY and allow the remaining COPY data to be 
                 * dropped on the floor. 
                 */ 
</span>                <a href="fe-exec.c.html#LN1927"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN378"><span class='Ref_to_Member'>asyncStatus</span></a> <span class='Operator'>= </span><a href="libpq-int.h.html#LN216"><span class='Ref_to_EnumConst'>PGASYNC_BUSY</span></a><span class='Delimiter'>; 
</span>                <span class='Comment_Multi_Line'>/* keep waiting to swallow the copy's completion message */ 
</span>            <span class='Delimiter'>} 
</span>            <span class='Control'>else</span> 
            <span class='Delimiter'>{ 
</span>                <span class='Comment_Multi_Line'>/* In older protocols we have to punt */ 
</span>                <a href="pqexpbuffer.c.html#LN232"><span class='Ref_to_Func'>printfPQExpBuffer</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="fe-exec.c.html#LN1927"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN491"><span class='Ref_to_Member'>errorMessage</span></a><span class='Delimiter'>, 
</span>                 <a href="win32.c.html#LN36"><span class='Ref_to_Func'>libpq_gettext</span></a><span class='Parentheses'>(</span><span class='String'>"COPY OUT state must be terminated first\n"</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>                <span class='Control'>return</span> <span class='Boolean'>false</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>        <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if resultStatus==PGRES_C... &raquo; </span> 
        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1940"><span class='Ref_To_Local'>resultStatus</span></a> <span class='Operator'>== </span><a href="libpq-fe.h.html#LN96"><span class='Ref_to_EnumConst'>PGRES_COPY_BOTH</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* We don't allow PQexec during COPY BOTH */ 
</span>            <a href="pqexpbuffer.c.html#LN232"><span class='Ref_to_Func'>printfPQExpBuffer</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="fe-exec.c.html#LN1927"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN491"><span class='Ref_to_Member'>errorMessage</span></a><span class='Delimiter'>, 
</span>                     <a href="win32.c.html#LN36"><span class='Ref_to_Func'>libpq_gettext</span></a><span class='Parentheses'>(</span><span class='String'>"PQexec not allowed during COPY BOTH\n"</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>            <span class='Control'>return</span> <span class='Boolean'>false</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Comment_Multi_Line'>/* check for loss of connection, too */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN1927"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN377"><span class='Ref_to_Member'>status</span></a> <span class='Operator'>== </span><a href="libpq-fe.h.html#LN49"><span class='Ref_to_EnumConst'>CONNECTION_BAD</span></a><span class='Parentheses'>) 
</span>            <span class='Control'>return</span> <span class='Boolean'>false</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end while (result=PQgetResult(c... &raquo; </span> 
 
    <span class='Comment_Multi_Line'>/* OK to send a command */ 
</span>    <span class='Control'>return</span> <span class='Boolean'>true</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end PQexecStart &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * Common code for PQexec and sibling routines: wait for command result 
 */ 
</span><span class='Keyword'>static </span><a href="libpq-fe.h.html#LN146"><span class='Ref_to_Typedef'>PGresult</span></a> <span class='Operator'>* 
</span><a name="LN2001"></a><span class='Declare_Function'>PQexecFinish</span><span class='Parentheses'>(</span><a href="libpq-fe.h.html#LN139"><span class='Ref_to_Typedef'>PGconn</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>conn</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN2003"></a>    <a href="libpq-fe.h.html#LN146"><span class='Ref_to_Typedef'>PGresult</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span><a name="LN2004"></a>    <a href="libpq-fe.h.html#LN146"><span class='Ref_to_Typedef'>PGresult</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>lastResult</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * For backwards compatibility, return the last result if there are more 
     * than one --- but merge error messages if we get more than one error 
     * result. 
     * 
     * We have to stop if we see copy in/out/both, however. We will resume 
     * parsing after application performs the data transfer. 
     * 
     * Also stop if the connection is lost (else we'll loop infinitely). 
     */ 
</span>    <a href="fe-exec.c.html#LN2004"><span class='Ref_To_Local'>lastResult</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <span class='Control'>while</span> <span class='Parentheses'>((</span><a href="fe-exec.c.html#LN2003"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="libpq-fe.h.html#LN421"><span class='Ref_to_Proto'>PQgetResult</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN2001"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>))</span> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN2004"><span class='Ref_To_Local'>lastResult</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN2004"><span class='Ref_To_Local'>lastResult</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN176"><span class='Ref_to_Member'>resultStatus</span></a> <span class='Operator'>== </span><a href="libpq-fe.h.html#LN95"><span class='Ref_to_EnumConst'>PGRES_FATAL_ERROR</span></a> <span class='Operator'>&& 
</span>                <a href="fe-exec.c.html#LN2003"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN176"><span class='Ref_to_Member'>resultStatus</span></a> <span class='Operator'>== </span><a href="libpq-fe.h.html#LN95"><span class='Ref_to_EnumConst'>PGRES_FATAL_ERROR</span></a><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <a href="libpq-int.h.html#LN568"><span class='Ref_to_Proto'>pqCatenateResultError</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN2004"><span class='Ref_To_Local'>lastResult</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN2003"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN195"><span class='Ref_to_Member'>errMsg</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <a href="libpq-fe.h.html#LN501"><span class='Ref_to_Proto'>PQclear</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN2003"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <a href="fe-exec.c.html#LN2003"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="fe-exec.c.html#LN2004"><span class='Ref_To_Local'>lastResult</span></a><span class='Delimiter'>; 
</span> 
                <span class='Comment_Multi_Line'>/* 
                 * Make sure PQerrorMessage agrees with concatenated result 
                 */ 
</span>                <a href="pqexpbuffer.h.html#LN129"><span class='Ref_to_Proto'>resetPQExpBuffer</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="fe-exec.c.html#LN2001"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN491"><span class='Ref_to_Member'>errorMessage</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <a href="pqexpbuffer.h.html#LN164"><span class='Ref_to_Proto'>appendPQExpBufferStr</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="fe-exec.c.html#LN2001"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN491"><span class='Ref_to_Member'>errorMessage</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN2003"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN195"><span class='Ref_to_Member'>errMsg</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>            <span class='Control'>else</span> 
                <a href="libpq-fe.h.html#LN501"><span class='Ref_to_Proto'>PQclear</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN2004"><span class='Ref_To_Local'>lastResult</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <a href="fe-exec.c.html#LN2004"><span class='Ref_To_Local'>lastResult</span></a> <span class='Operator'>= </span><a href="fe-exec.c.html#LN2003"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN2003"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN176"><span class='Ref_to_Member'>resultStatus</span></a> <span class='Operator'>== </span><a href="libpq-fe.h.html#LN91"><span class='Ref_to_EnumConst'>PGRES_COPY_IN</span></a> <span class='Operator'>|| 
</span>            <a href="fe-exec.c.html#LN2003"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN176"><span class='Ref_to_Member'>resultStatus</span></a> <span class='Operator'>== </span><a href="libpq-fe.h.html#LN90"><span class='Ref_to_EnumConst'>PGRES_COPY_OUT</span></a> <span class='Operator'>|| 
</span>            <a href="fe-exec.c.html#LN2003"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN176"><span class='Ref_to_Member'>resultStatus</span></a> <span class='Operator'>== </span><a href="libpq-fe.h.html#LN96"><span class='Ref_to_EnumConst'>PGRES_COPY_BOTH</span></a> <span class='Operator'>|| 
</span>            <a href="fe-exec.c.html#LN2001"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN377"><span class='Ref_to_Member'>status</span></a> <span class='Operator'>== </span><a href="libpq-fe.h.html#LN49"><span class='Ref_to_EnumConst'>CONNECTION_BAD</span></a><span class='Parentheses'>) 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end while (result=PQgetResult(c... &raquo; </span> 
 
    <span class='Control'>return</span> <a href="fe-exec.c.html#LN2004"><span class='Ref_To_Local'>lastResult</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end PQexecFinish &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * PQdescribePrepared 
 *    Obtain information about a previously prepared statement 
 * 
 * If the query was not even sent, return NULL; conn-&GT;errorMessage is set to 
 * a relevant message. 
 * If the query was sent, a new PGresult is returned (which could indicate 
 * either success or failure).  On success, the PGresult contains status 
 * PGRES_COMMAND_OK, and its parameter and column-heading fields describe 
 * the statement's inputs and outputs respectively. 
 * The user is responsible for freeing the PGresult via PQclear() 
 * when done with it. 
 */ 
</span><a href="libpq-fe.h.html#LN146"><span class='Ref_to_Typedef'>PGresult</span></a> <span class='Operator'>* 
</span><a name="LN2062"></a><span class='Declare_Function'>PQdescribePrepared</span><span class='Parentheses'>(</span><a href="libpq-fe.h.html#LN139"><span class='Ref_to_Typedef'>PGconn</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>conn</span><span class='Delimiter'>, </span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>stmt</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="fe-exec.c.html#LN66"><span class='Ref_to_Proto'>PQexecStart</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN2062"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>))</span> 
        <span class='Control'>return</span> <span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="fe-exec.c.html#LN68"><span class='Ref_to_Proto'>PQsendDescribe</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN2062"><span class='Ref_to_Parameter'>conn</span></a><span class='Delimiter'>, </span><span class='String'>'S'</span><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN2062"><span class='Ref_to_Parameter'>stmt</span></a><span class='Parentheses'>))</span> 
        <span class='Control'>return</span> <span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <a href="fe-exec.c.html#LN67"><span class='Ref_to_Proto'>PQexecFinish</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN2062"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * PQdescribePortal 
 *    Obtain information about a previously created portal 
 * 
 * This is much like PQdescribePrepared, except that no parameter info is 
 * returned.  Note that at the moment, libpq doesn't really expose portals 
 * to the client; but this can be used with a portal created by a SQL 
 * DECLARE CURSOR command. 
 */ 
</span><a href="libpq-fe.h.html#LN146"><span class='Ref_to_Typedef'>PGresult</span></a> <span class='Operator'>* 
</span><a name="LN2081"></a><span class='Declare_Function'>PQdescribePortal</span><span class='Parentheses'>(</span><a href="libpq-fe.h.html#LN139"><span class='Ref_to_Typedef'>PGconn</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>conn</span><span class='Delimiter'>, </span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>portal</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="fe-exec.c.html#LN66"><span class='Ref_to_Proto'>PQexecStart</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN2081"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>))</span> 
        <span class='Control'>return</span> <span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="fe-exec.c.html#LN68"><span class='Ref_to_Proto'>PQsendDescribe</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN2081"><span class='Ref_to_Parameter'>conn</span></a><span class='Delimiter'>, </span><span class='String'>'P'</span><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN2081"><span class='Ref_to_Parameter'>portal</span></a><span class='Parentheses'>))</span> 
        <span class='Control'>return</span> <span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <a href="fe-exec.c.html#LN67"><span class='Ref_to_Proto'>PQexecFinish</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN2081"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * PQsendDescribePrepared 
 *   Submit a Describe Statement command, but don't wait for it to finish 
 * 
 * Returns: 1 if successfully submitted 
 *          0 if error (conn-&GT;errorMessage is set) 
 */ 
</span><span class='Keyword'>int 
</span><a name="LN2098"></a><span class='Declare_Function'>PQsendDescribePrepared</span><span class='Parentheses'>(</span><a href="libpq-fe.h.html#LN139"><span class='Ref_to_Typedef'>PGconn</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>conn</span><span class='Delimiter'>, </span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>stmt</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>return</span> <a href="fe-exec.c.html#LN68"><span class='Ref_to_Proto'>PQsendDescribe</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN2098"><span class='Ref_to_Parameter'>conn</span></a><span class='Delimiter'>, </span><span class='String'>'S'</span><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN2098"><span class='Ref_to_Parameter'>stmt</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * PQsendDescribePortal 
 *   Submit a Describe Portal command, but don't wait for it to finish 
 * 
 * Returns: 1 if successfully submitted 
 *          0 if error (conn-&GT;errorMessage is set) 
 */ 
</span><span class='Keyword'>int 
</span><a name="LN2111"></a><span class='Declare_Function'>PQsendDescribePortal</span><span class='Parentheses'>(</span><a href="libpq-fe.h.html#LN139"><span class='Ref_to_Typedef'>PGconn</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>conn</span><span class='Delimiter'>, </span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>portal</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>return</span> <a href="fe-exec.c.html#LN68"><span class='Ref_to_Proto'>PQsendDescribe</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN2111"><span class='Ref_to_Parameter'>conn</span></a><span class='Delimiter'>, </span><span class='String'>'P'</span><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN2111"><span class='Ref_to_Parameter'>portal</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * PQsendDescribe 
 *   Common code to send a Describe command 
 * 
 * Available options for desc_type are 
 *   'S' to describe a prepared statement; or 
 *   'P' to describe a portal. 
 * Returns 1 on success and 0 on failure. 
 */ 
</span><span class='Keyword'>static int 
</span><a name="LN2126"></a><span class='Declare_Function'>PQsendDescribe</span><span class='Parentheses'>(</span><a href="libpq-fe.h.html#LN139"><span class='Ref_to_Typedef'>PGconn</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>conn</span><span class='Delimiter'>, </span><span class='Keyword'>char </span><span class='Declare_Parameter'>desc_type</span><span class='Delimiter'>, </span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>desc_target</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Comment_Multi_Line'>/* Treat null desc_target as empty string */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="fe-exec.c.html#LN2126"><span class='Ref_to_Parameter'>desc_target</span></a><span class='Parentheses'>) 
</span>        <a href="fe-exec.c.html#LN2126"><span class='Ref_to_Parameter'>desc_target</span></a> <span class='Operator'>= </span><span class='String'>""</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="fe-exec.c.html#LN54"><span class='Ref_to_Proto'>PQsendQueryStart</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN2126"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>))</span> 
        <span class='Control'>return</span> <span class='Number'>0</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* This isn't gonna work on a 2.0 server */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/libpq/pqcomm.h.html#LN103"><span class='Ref_to_Macro'>PG_PROTOCOL_MAJOR</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN2126"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN403"><span class='Ref_to_Member'>pversion</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT; </span><span class='Number'>3</span><span class='Parentheses'>)</span> 
    <span class='Delimiter'>{ 
</span>        <a href="pqexpbuffer.c.html#LN232"><span class='Ref_to_Func'>printfPQExpBuffer</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="fe-exec.c.html#LN2126"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN491"><span class='Ref_to_Member'>errorMessage</span></a><span class='Delimiter'>, 
</span>         <a href="win32.c.html#LN36"><span class='Ref_to_Func'>libpq_gettext</span></a><span class='Parentheses'>(</span><span class='String'>"function requires at least protocol version 3.0\n"</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <span class='Number'>0</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* construct the Describe message */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-misc.c.html#LN519"><span class='Ref_to_Func'>pqPutMsgStart</span></a><span class='Parentheses'>(</span><span class='String'>'D'</span><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN2126"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT; </span><span class='Number'>0</span> <span class='Operator'>|| 
</span>        <a href="fe-misc.c.html#LN112"><span class='Ref_to_Func'>pqPutc</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN2126"><span class='Ref_to_Parameter'>desc_type</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN2126"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT; </span><span class='Number'>0</span> <span class='Operator'>|| 
</span>        <a href="fe-misc.c.html#LN179"><span class='Ref_to_Func'>pqPuts</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN2126"><span class='Ref_to_Parameter'>desc_target</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN2126"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT; </span><span class='Number'>0</span> <span class='Operator'>|| 
</span>        <a href="fe-misc.c.html#LN587"><span class='Ref_to_Func'>pqPutMsgEnd</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN2126"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="fe-exec.c.html#LN2176"><span class='Ref_to_Label'>sendFailed</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* construct the Sync message */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-misc.c.html#LN519"><span class='Ref_to_Func'>pqPutMsgStart</span></a><span class='Parentheses'>(</span><span class='String'>'S'</span><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN2126"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT; </span><span class='Number'>0</span> <span class='Operator'>|| 
</span>        <a href="fe-misc.c.html#LN587"><span class='Ref_to_Func'>pqPutMsgEnd</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN2126"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="fe-exec.c.html#LN2176"><span class='Ref_to_Label'>sendFailed</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* remember we are doing a Describe */ 
</span>    <a href="fe-exec.c.html#LN2126"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN380"><span class='Ref_to_Member'>queryclass</span></a> <span class='Operator'>= </span><a href="libpq-int.h.html#LN229"><span class='Ref_to_EnumConst'>PGQUERY_DESCRIBE</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* reset last-query string (not relevant now) */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN2126"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN381"><span class='Ref_to_Member'>last_query</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="../../include/snowball/header.h.html#LN64"><span class='Ref_to_Macro'>free</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN2126"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN381"><span class='Ref_to_Member'>last_query</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="fe-exec.c.html#LN2126"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN381"><span class='Ref_to_Member'>last_query</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Give the data a push.  In nonblock mode, don't complain if we're unable 
     * to send it all; PQgetResult() will do any additional flushing needed. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="libpq-int.h.html#LN637"><span class='Ref_to_Proto'>pqFlush</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN2126"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="fe-exec.c.html#LN2176"><span class='Ref_to_Label'>sendFailed</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* OK, it's launched! */ 
</span>    <a href="fe-exec.c.html#LN2126"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN378"><span class='Ref_to_Member'>asyncStatus</span></a> <span class='Operator'>= </span><a href="libpq-int.h.html#LN216"><span class='Ref_to_EnumConst'>PGASYNC_BUSY</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <span class='Number'>1</span><span class='Delimiter'>; 
</span> 
<a name="LN2176"></a><span class='Label'>sendFailed</span><span class='Operator'>: 
</span>    <a href="libpq-int.h.html#LN580"><span class='Ref_to_Proto'>pqHandleSendFailure</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN2126"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <span class='Number'>0</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end PQsendDescribe &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * PQnotifies 
 *    returns a PGnotify* structure of the latest async notification 
 * that has not yet been handled 
 * 
 * returns NULL, if there is currently 
 * no unhandled async notification from the backend 
 * 
 * the CALLER is responsible for FREE'ing the structure returned 
 */ 
</span><a href="libpq-fe.h.html#LN160"><span class='Ref_to_Typedef'>PGnotify</span></a> <span class='Operator'>* 
</span><a name="LN2192"></a><span class='Declare_Function'>PQnotifies</span><span class='Parentheses'>(</span><a href="libpq-fe.h.html#LN139"><span class='Ref_to_Typedef'>PGconn</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>conn</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN2194"></a>    <a href="libpq-fe.h.html#LN160"><span class='Ref_to_Typedef'>PGnotify</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>event</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="fe-exec.c.html#LN2192"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Parse any available data to see if we can extract NOTIFY messages. */ 
</span>    <a href="fe-exec.c.html#LN64"><span class='Ref_to_Proto'>parseInput</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN2192"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="fe-exec.c.html#LN2194"><span class='Ref_To_Local'>event</span></a> <span class='Operator'>= </span><a href="fe-exec.c.html#LN2192"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN390"><span class='Ref_to_Member'>notifyHead</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN2194"><span class='Ref_To_Local'>event</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="fe-exec.c.html#LN2192"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN390"><span class='Ref_to_Member'>notifyHead</span></a> <span class='Operator'>= </span><a href="fe-exec.c.html#LN2194"><span class='Ref_To_Local'>event</span></a><span class='Operator'>-&GT;</span><a href="libpq-fe.h.html#LN166"><span class='Ref_to_Member'>next</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="fe-exec.c.html#LN2192"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN390"><span class='Ref_to_Member'>notifyHead</span></a><span class='Parentheses'>) 
</span>            <a href="fe-exec.c.html#LN2192"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN391"><span class='Ref_to_Member'>notifyTail</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>        <a href="fe-exec.c.html#LN2194"><span class='Ref_To_Local'>event</span></a><span class='Operator'>-&GT;</span><a href="libpq-fe.h.html#LN166"><span class='Ref_to_Member'>next</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>;</span>     <span class='Comment_Single_Line'>/* don't let app see the internal state */ 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>return</span> <a href="fe-exec.c.html#LN2194"><span class='Ref_To_Local'>event</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end PQnotifies &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * PQputCopyData - send some data to the backend during COPY IN or COPY BOTH 
 * 
 * Returns 1 if successful, 0 if data could not be sent (only possible 
 * in nonblock mode), or -1 if an error occurs. 
 */ 
</span><span class='Keyword'>int 
</span><a name="LN2220"></a><span class='Declare_Function'>PQputCopyData</span><span class='Parentheses'>(</span><a href="libpq-fe.h.html#LN139"><span class='Ref_to_Typedef'>PGconn</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>conn</span><span class='Delimiter'>, </span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>buffer</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>nbytes</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="fe-exec.c.html#LN2220"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN2220"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN378"><span class='Ref_to_Member'>asyncStatus</span></a> <span class='Operator'>!= </span><a href="libpq-int.h.html#LN218"><span class='Ref_to_EnumConst'>PGASYNC_COPY_IN</span></a> <span class='Operator'>&& 
</span>        <a href="fe-exec.c.html#LN2220"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN378"><span class='Ref_to_Member'>asyncStatus</span></a> <span class='Operator'>!= </span><a href="libpq-int.h.html#LN220"><span class='Ref_to_EnumConst'>PGASYNC_COPY_BOTH</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="pqexpbuffer.c.html#LN232"><span class='Ref_to_Func'>printfPQExpBuffer</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="fe-exec.c.html#LN2220"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN491"><span class='Ref_to_Member'>errorMessage</span></a><span class='Delimiter'>, 
</span>                          <a href="win32.c.html#LN36"><span class='Ref_to_Func'>libpq_gettext</span></a><span class='Parentheses'>(</span><span class='String'>"no COPY in progress\n"</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Process any NOTICE or NOTIFY messages that might be pending in the 
     * input buffer.  Since the server might generate many notices during the 
     * COPY, we want to clean those out reasonably promptly to prevent 
     * indefinite expansion of the input buffer.  (Note: the actual read of 
     * input data into the input buffer happens down inside pqSendSome, but 
     * it's not authorized to get rid of the data again.) 
     */ 
</span>    <a href="fe-exec.c.html#LN64"><span class='Ref_to_Proto'>parseInput</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN2220"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN2220"><span class='Ref_to_Parameter'>nbytes</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* 
         * Try to flush any previously sent data in preference to growing the 
         * output buffer.  If we can't enlarge the buffer enough to hold the 
         * data, return 0 in the nonblock case, else hard error. (For 
         * simplicity, always assume 5 bytes of overhead even in protocol 2.0 
         * case.) 
         */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="fe-exec.c.html#LN2220"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN437"><span class='Ref_to_Member'>outBufSize</span></a> <span class='Operator'>- </span><a href="fe-exec.c.html#LN2220"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN438"><span class='Ref_to_Member'>outCount</span></a> <span class='Operator'>- </span><span class='Number'>5</span><span class='Parentheses'>) </span><span class='Operator'>&LT; </span><a href="fe-exec.c.html#LN2220"><span class='Ref_to_Parameter'>nbytes</span></a><span class='Parentheses'>)</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="libpq-int.h.html#LN637"><span class='Ref_to_Proto'>pqFlush</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN2220"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
                <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-misc.c.html#LN344"><span class='Ref_to_Func'>pqCheckOutBufferSpace</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN2220"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN438"><span class='Ref_to_Member'>outCount</span></a> <span class='Operator'>+ </span><span class='Number'>5</span> <span class='Operator'>+ </span><span class='Parentheses'>(</span>size_t<span class='Parentheses'>) </span><a href="fe-exec.c.html#LN2220"><span class='Ref_to_Parameter'>nbytes</span></a><span class='Delimiter'>, 
</span>                                      <a href="fe-exec.c.html#LN2220"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>))</span> 
                <span class='Control'>return</span> <a href="libpq-int.h.html#LN676"><span class='Ref_to_Macro'>pqIsnonblocking</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN2220"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>) </span><span class='Operator'>? </span><span class='Number'>0</span> <span class='Operator'>: -</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Comment_Multi_Line'>/* Send the data (too simple to delegate to fe-protocol files) */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/libpq/pqcomm.h.html#LN103"><span class='Ref_to_Macro'>PG_PROTOCOL_MAJOR</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN2220"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN403"><span class='Ref_to_Member'>pversion</span></a><span class='Parentheses'>) </span><span class='Operator'>&GT;= </span><span class='Number'>3</span><span class='Parentheses'>)</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-misc.c.html#LN519"><span class='Ref_to_Func'>pqPutMsgStart</span></a><span class='Parentheses'>(</span><span class='String'>'d'</span><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN2220"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT; </span><span class='Number'>0</span> <span class='Operator'>|| 
</span>                <a href="fe-misc.c.html#LN246"><span class='Ref_to_Func'>pqPutnchar</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN2220"><span class='Ref_to_Parameter'>buffer</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN2220"><span class='Ref_to_Parameter'>nbytes</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN2220"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT; </span><span class='Number'>0</span> <span class='Operator'>|| 
</span>                <a href="fe-misc.c.html#LN587"><span class='Ref_to_Func'>pqPutMsgEnd</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN2220"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
                <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-misc.c.html#LN519"><span class='Ref_to_Func'>pqPutMsgStart</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN2220"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT; </span><span class='Number'>0</span> <span class='Operator'>|| 
</span>                <a href="fe-misc.c.html#LN246"><span class='Ref_to_Func'>pqPutnchar</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN2220"><span class='Ref_to_Parameter'>buffer</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN2220"><span class='Ref_to_Parameter'>nbytes</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN2220"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT; </span><span class='Number'>0</span> <span class='Operator'>|| 
</span>                <a href="fe-misc.c.html#LN587"><span class='Ref_to_Func'>pqPutMsgEnd</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN2220"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
                <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if nbytes&GT;0 &raquo; </span> 
    <span class='Control'>return</span> <span class='Number'>1</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end PQputCopyData &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * PQputCopyEnd - send EOF indication to the backend during COPY IN 
 * 
 * After calling this, use PQgetResult() to check command completion status. 
 * 
 * Returns 1 if successful, 0 if data could not be sent (only possible 
 * in nonblock mode), or -1 if an error occurs. 
 */ 
</span><span class='Keyword'>int 
</span><a name="LN2287"></a><span class='Declare_Function'>PQputCopyEnd</span><span class='Parentheses'>(</span><a href="libpq-fe.h.html#LN139"><span class='Ref_to_Typedef'>PGconn</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>conn</span><span class='Delimiter'>, </span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>errormsg</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="fe-exec.c.html#LN2287"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN2287"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN378"><span class='Ref_to_Member'>asyncStatus</span></a> <span class='Operator'>!= </span><a href="libpq-int.h.html#LN218"><span class='Ref_to_EnumConst'>PGASYNC_COPY_IN</span></a> <span class='Operator'>&& 
</span>        <a href="fe-exec.c.html#LN2287"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN378"><span class='Ref_to_Member'>asyncStatus</span></a> <span class='Operator'>!= </span><a href="libpq-int.h.html#LN220"><span class='Ref_to_EnumConst'>PGASYNC_COPY_BOTH</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="pqexpbuffer.c.html#LN232"><span class='Ref_to_Func'>printfPQExpBuffer</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="fe-exec.c.html#LN2287"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN491"><span class='Ref_to_Member'>errorMessage</span></a><span class='Delimiter'>, 
</span>                          <a href="win32.c.html#LN36"><span class='Ref_to_Func'>libpq_gettext</span></a><span class='Parentheses'>(</span><span class='String'>"no COPY in progress\n"</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Send the COPY END indicator.  This is simple enough that we don't 
     * bother delegating it to the fe-protocol files. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/libpq/pqcomm.h.html#LN103"><span class='Ref_to_Macro'>PG_PROTOCOL_MAJOR</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN2287"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN403"><span class='Ref_to_Member'>pversion</span></a><span class='Parentheses'>) </span><span class='Operator'>&GT;= </span><span class='Number'>3</span><span class='Parentheses'>)</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN2287"><span class='Ref_to_Parameter'>errormsg</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* Send COPY FAIL */ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-misc.c.html#LN519"><span class='Ref_to_Func'>pqPutMsgStart</span></a><span class='Parentheses'>(</span><span class='String'>'f'</span><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN2287"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT; </span><span class='Number'>0</span> <span class='Operator'>|| 
</span>                <a href="fe-misc.c.html#LN179"><span class='Ref_to_Func'>pqPuts</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN2287"><span class='Ref_to_Parameter'>errormsg</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN2287"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT; </span><span class='Number'>0</span> <span class='Operator'>|| 
</span>                <a href="fe-misc.c.html#LN587"><span class='Ref_to_Func'>pqPutMsgEnd</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN2287"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
                <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* Send COPY DONE */ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-misc.c.html#LN519"><span class='Ref_to_Func'>pqPutMsgStart</span></a><span class='Parentheses'>(</span><span class='String'>'c'</span><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN2287"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT; </span><span class='Number'>0</span> <span class='Operator'>|| 
</span>                <a href="fe-misc.c.html#LN587"><span class='Ref_to_Func'>pqPutMsgEnd</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN2287"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
                <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * If we sent the COPY command in extended-query mode, we must issue a 
         * Sync as well. 
         */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN2287"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN380"><span class='Ref_to_Member'>queryclass</span></a> <span class='Operator'>!= </span><a href="libpq-int.h.html#LN226"><span class='Ref_to_EnumConst'>PGQUERY_SIMPLE</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-misc.c.html#LN519"><span class='Ref_to_Func'>pqPutMsgStart</span></a><span class='Parentheses'>(</span><span class='String'>'S'</span><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN2287"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT; </span><span class='Number'>0</span> <span class='Operator'>|| 
</span>                <a href="fe-misc.c.html#LN587"><span class='Ref_to_Func'>pqPutMsgEnd</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN2287"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
                <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if PG_PROTOCOL_MAJOR(con... &raquo; </span> 
    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN2287"><span class='Ref_to_Parameter'>errormsg</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* Oops, no way to do this in 2.0 */ 
</span>            <a href="pqexpbuffer.c.html#LN232"><span class='Ref_to_Func'>printfPQExpBuffer</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="fe-exec.c.html#LN2287"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN491"><span class='Ref_to_Member'>errorMessage</span></a><span class='Delimiter'>, 
</span>                              <a href="win32.c.html#LN36"><span class='Ref_to_Func'>libpq_gettext</span></a><span class='Parentheses'>(</span><span class='String'>"function requires at least protocol version 3.0\n"</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>            <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* Send old-style end-of-data marker */ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-misc.c.html#LN519"><span class='Ref_to_Func'>pqPutMsgStart</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN2287"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT; </span><span class='Number'>0</span> <span class='Operator'>|| 
</span>                <a href="fe-misc.c.html#LN246"><span class='Ref_to_Func'>pqPutnchar</span></a><span class='Parentheses'>(</span><span class='String'>"\\.\n"</span><span class='Delimiter'>, </span><span class='Number'>3</span><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN2287"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT; </span><span class='Number'>0</span> <span class='Operator'>|| 
</span>                <a href="fe-misc.c.html#LN587"><span class='Ref_to_Func'>pqPutMsgEnd</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN2287"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
                <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* Return to active duty */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN2287"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN378"><span class='Ref_to_Member'>asyncStatus</span></a> <span class='Operator'>== </span><a href="libpq-int.h.html#LN220"><span class='Ref_to_EnumConst'>PGASYNC_COPY_BOTH</span></a><span class='Parentheses'>) 
</span>        <a href="fe-exec.c.html#LN2287"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN378"><span class='Ref_to_Member'>asyncStatus</span></a> <span class='Operator'>= </span><a href="libpq-int.h.html#LN219"><span class='Ref_to_EnumConst'>PGASYNC_COPY_OUT</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
        <a href="fe-exec.c.html#LN2287"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN378"><span class='Ref_to_Member'>asyncStatus</span></a> <span class='Operator'>= </span><a href="libpq-int.h.html#LN216"><span class='Ref_to_EnumConst'>PGASYNC_BUSY</span></a><span class='Delimiter'>; 
</span>    <a href="pqexpbuffer.h.html#LN129"><span class='Ref_to_Proto'>resetPQExpBuffer</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="fe-exec.c.html#LN2287"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN491"><span class='Ref_to_Member'>errorMessage</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Try to flush data */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="libpq-int.h.html#LN637"><span class='Ref_to_Proto'>pqFlush</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN2287"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <span class='Number'>1</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end PQputCopyEnd &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * PQgetCopyData - read a row of data from the backend during COPY OUT 
 * or COPY BOTH 
 * 
 * If successful, sets *buffer to point to a malloc'd row of data, and 
 * returns row length (always &GT; 0) as result. 
 * Returns 0 if no row available yet (only possible if async is true), 
 * -1 if end of copy (consult PQgetResult), or -2 if error (consult 
 * PQerrorMessage). 
 */ 
</span><span class='Keyword'>int 
</span><a name="LN2376"></a><span class='Declare_Function'>PQgetCopyData</span><span class='Parentheses'>(</span><a href="libpq-fe.h.html#LN139"><span class='Ref_to_Typedef'>PGconn</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>conn</span><span class='Delimiter'>, </span><span class='Keyword'>char </span><span class='Operator'>**</span><span class='Declare_Parameter'>buffer</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>async</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Operator'>*</span><a href="fe-exec.c.html#LN2376"><span class='Ref_to_Parameter'>buffer</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>;</span>             <span class='Comment_Single_Line'>/* for all failure cases */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="fe-exec.c.html#LN2376"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>2</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN2376"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN378"><span class='Ref_to_Member'>asyncStatus</span></a> <span class='Operator'>!= </span><a href="libpq-int.h.html#LN219"><span class='Ref_to_EnumConst'>PGASYNC_COPY_OUT</span></a> <span class='Operator'>&& 
</span>        <a href="fe-exec.c.html#LN2376"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN378"><span class='Ref_to_Member'>asyncStatus</span></a> <span class='Operator'>!= </span><a href="libpq-int.h.html#LN220"><span class='Ref_to_EnumConst'>PGASYNC_COPY_BOTH</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="pqexpbuffer.c.html#LN232"><span class='Ref_to_Func'>printfPQExpBuffer</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="fe-exec.c.html#LN2376"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN491"><span class='Ref_to_Member'>errorMessage</span></a><span class='Delimiter'>, 
</span>                          <a href="win32.c.html#LN36"><span class='Ref_to_Func'>libpq_gettext</span></a><span class='Parentheses'>(</span><span class='String'>"no COPY in progress\n"</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>2</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/libpq/pqcomm.h.html#LN103"><span class='Ref_to_Macro'>PG_PROTOCOL_MAJOR</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN2376"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN403"><span class='Ref_to_Member'>pversion</span></a><span class='Parentheses'>) </span><span class='Operator'>&GT;= </span><span class='Number'>3</span><span class='Parentheses'>)</span> 
        <span class='Control'>return</span> <a href="libpq-int.h.html#LN606"><span class='Ref_to_Proto'>pqGetCopyData3</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN2376"><span class='Ref_to_Parameter'>conn</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN2376"><span class='Ref_to_Parameter'>buffer</span></a><span class='Delimiter'>, </span><span class='Keyword'>async</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
        <span class='Control'>return</span> <a href="libpq-int.h.html#LN589"><span class='Ref_to_Proto'>pqGetCopyData2</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN2376"><span class='Ref_to_Parameter'>conn</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN2376"><span class='Ref_to_Parameter'>buffer</span></a><span class='Delimiter'>, </span><span class='Keyword'>async</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * PQgetline - gets a newline-terminated string from the backend. 
 * 
 * Chiefly here so that applications can use "COPY &LT;rel&GT; to stdout" 
 * and read the output string.  Returns a null-terminated string in s. 
 * 
 * XXX this routine is now deprecated, because it can't handle binary data. 
 * If called during a COPY BINARY we return EOF. 
 * 
 * PQgetline reads up to maxlen-1 characters (like fgets(3)) but strips 
 * the terminating \n (like gets(3)). 
 * 
 * CAUTION: the caller is responsible for detecting the end-of-copy signal 
 * (a line containing just "\.") when using this routine. 
 * 
 * RETURNS: 
 *      EOF if error (eg, invalid arguments are given) 
 *      0 if EOL is reached (i.e., \n has been read) 
 *              (this is required for backward-compatibility -- this 
 *               routine used to always return EOF or 0, assuming that 
 *               the line ended within maxlen bytes.) 
 *      1 in other cases (i.e., the buffer was filled before \n is reached) 
 */ 
</span><span class='Keyword'>int 
</span><a name="LN2418"></a><span class='Declare_Function'>PQgetline</span><span class='Parentheses'>(</span><a href="libpq-fe.h.html#LN139"><span class='Ref_to_Typedef'>PGconn</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>conn</span><span class='Delimiter'>, </span><span class='Keyword'>char </span><span class='Operator'>*</span><span class='Declare_Parameter'>s</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>maxlen</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="fe-exec.c.html#LN2418"><span class='Ref_to_Parameter'>s</span></a> <span class='Operator'>|| </span><a href="fe-exec.c.html#LN2418"><span class='Ref_to_Parameter'>maxlen</span></a> <span class='Operator'>&LT;= </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> EOF<span class='Delimiter'>; 
</span>    <span class='Operator'>*</span><a href="fe-exec.c.html#LN2418"><span class='Ref_to_Parameter'>s</span></a> <span class='Operator'>= </span><span class='String'>'\0'</span><span class='Delimiter'>; 
</span>    <span class='Comment_Multi_Line'>/* maxlen must be at least 3 to hold the \. terminator! */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN2418"><span class='Ref_to_Parameter'>maxlen</span></a> <span class='Operator'>&LT; </span><span class='Number'>3</span><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> EOF<span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="fe-exec.c.html#LN2418"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> EOF<span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/libpq/pqcomm.h.html#LN103"><span class='Ref_to_Macro'>PG_PROTOCOL_MAJOR</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN2418"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN403"><span class='Ref_to_Member'>pversion</span></a><span class='Parentheses'>) </span><span class='Operator'>&GT;= </span><span class='Number'>3</span><span class='Parentheses'>)</span> 
        <span class='Control'>return</span> <a href="libpq-int.h.html#LN607"><span class='Ref_to_Proto'>pqGetline3</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN2418"><span class='Ref_to_Parameter'>conn</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN2418"><span class='Ref_to_Parameter'>s</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN2418"><span class='Ref_to_Parameter'>maxlen</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
        <span class='Control'>return</span> <a href="libpq-int.h.html#LN590"><span class='Ref_to_Proto'>pqGetline2</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN2418"><span class='Ref_to_Parameter'>conn</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN2418"><span class='Ref_to_Parameter'>s</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN2418"><span class='Ref_to_Parameter'>maxlen</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * PQgetlineAsync - gets a COPY data row without blocking. 
 * 
 * This routine is for applications that want to do "COPY &LT;rel&GT; to stdout" 
 * asynchronously, that is without blocking.  Having issued the COPY command 
 * and gotten a PGRES_COPY_OUT response, the app should call PQconsumeInput 
 * and this routine until the end-of-data signal is detected.  Unlike 
 * PQgetline, this routine takes responsibility for detecting end-of-data. 
 * 
 * On each call, PQgetlineAsync will return data if a complete data row 
 * is available in libpq's input buffer.  Otherwise, no data is returned 
 * until the rest of the row arrives. 
 * 
 * If -1 is returned, the end-of-data signal has been recognized (and removed 
 * from libpq's input buffer).  The caller *must* next call PQendcopy and 
 * then return to normal processing. 
 * 
 * RETURNS: 
 *   -1    if the end-of-copy-data marker has been recognized 
 *   0     if no data is available 
 *   &GT;0    the number of bytes returned. 
 * 
 * The data returned will not extend beyond a data-row boundary.  If possible 
 * a whole row will be returned at one time.  But if the buffer offered by 
 * the caller is too small to hold a row sent by the backend, then a partial 
 * data row will be returned.  In text mode this can be detected by testing 
 * whether the last returned byte is '\n' or not. 
 * 
 * The returned data is *not* null-terminated. 
 */ 
</span> 
<span class='Keyword'>int 
</span><a name="LN2468"></a><span class='Declare_Function'>PQgetlineAsync</span><span class='Parentheses'>(</span><a href="libpq-fe.h.html#LN139"><span class='Ref_to_Typedef'>PGconn</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>conn</span><span class='Delimiter'>, </span><span class='Keyword'>char </span><span class='Operator'>*</span><span class='Declare_Parameter'>buffer</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>bufsize</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="fe-exec.c.html#LN2468"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/libpq/pqcomm.h.html#LN103"><span class='Ref_to_Macro'>PG_PROTOCOL_MAJOR</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN2468"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN403"><span class='Ref_to_Member'>pversion</span></a><span class='Parentheses'>) </span><span class='Operator'>&GT;= </span><span class='Number'>3</span><span class='Parentheses'>)</span> 
        <span class='Control'>return</span> <a href="libpq-int.h.html#LN608"><span class='Ref_to_Proto'>pqGetlineAsync3</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN2468"><span class='Ref_to_Parameter'>conn</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN2468"><span class='Ref_to_Parameter'>buffer</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN2468"><span class='Ref_to_Parameter'>bufsize</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
        <span class='Control'>return</span> <a href="libpq-int.h.html#LN591"><span class='Ref_to_Proto'>pqGetlineAsync2</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN2468"><span class='Ref_to_Parameter'>conn</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN2468"><span class='Ref_to_Parameter'>buffer</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN2468"><span class='Ref_to_Parameter'>bufsize</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * PQputline -- sends a string to the backend during COPY IN. 
 * Returns 0 if OK, EOF if not. 
 * 
 * This is deprecated primarily because the return convention doesn't allow 
 * caller to tell the difference between a hard error and a nonblock-mode 
 * send failure. 
 */ 
</span><span class='Keyword'>int 
</span><a name="LN2488"></a><span class='Declare_Function'>PQputline</span><span class='Parentheses'>(</span><a href="libpq-fe.h.html#LN139"><span class='Ref_to_Typedef'>PGconn</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>conn</span><span class='Delimiter'>, </span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>s</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>return</span> <a href="libpq-fe.h.html#LN439"><span class='Ref_to_Proto'>PQputnbytes</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN2488"><span class='Ref_to_Parameter'>conn</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN2488"><span class='Ref_to_Parameter'>s</span></a><span class='Delimiter'>, </span>strlen<span class='Parentheses'>(</span><a href="fe-exec.c.html#LN2488"><span class='Ref_to_Parameter'>s</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * PQputnbytes -- like PQputline, but buffer need not be null-terminated. 
 * Returns 0 if OK, EOF if not. 
 */ 
</span><span class='Keyword'>int 
</span><a name="LN2498"></a><span class='Declare_Function'>PQputnbytes</span><span class='Parentheses'>(</span><a href="libpq-fe.h.html#LN139"><span class='Ref_to_Typedef'>PGconn</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>conn</span><span class='Delimiter'>, </span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>buffer</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>nbytes</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="libpq-fe.h.html#LN431"><span class='Ref_to_Proto'>PQputCopyData</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN2498"><span class='Ref_to_Parameter'>conn</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN2498"><span class='Ref_to_Parameter'>buffer</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN2498"><span class='Ref_to_Parameter'>nbytes</span></a><span class='Parentheses'>) </span><span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <span class='Control'>return</span> <span class='Number'>0</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
        <span class='Control'>return</span> EOF<span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * PQendcopy 
 *      After completing the data transfer portion of a copy in/out, 
 *      the application must call this routine to finish the command protocol. 
 * 
 * When using protocol 3.0 this is deprecated; it's cleaner to use PQgetResult 
 * to get the transfer status.  Note however that when using 2.0 protocol, 
 * recovering from a copy failure often requires a PQreset.  PQendcopy will 
 * take care of that, PQgetResult won't. 
 * 
 * RETURNS: 
 *      0 on success 
 *      1 on failure 
 */ 
</span><span class='Keyword'>int 
</span><a name="LN2521"></a><span class='Declare_Function'>PQendcopy</span><span class='Parentheses'>(</span><a href="libpq-fe.h.html#LN139"><span class='Ref_to_Typedef'>PGconn</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>conn</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="fe-exec.c.html#LN2521"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <span class='Number'>0</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/libpq/pqcomm.h.html#LN103"><span class='Ref_to_Macro'>PG_PROTOCOL_MAJOR</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN2521"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN403"><span class='Ref_to_Member'>pversion</span></a><span class='Parentheses'>) </span><span class='Operator'>&GT;= </span><span class='Number'>3</span><span class='Parentheses'>)</span> 
        <span class='Control'>return</span> <a href="libpq-int.h.html#LN609"><span class='Ref_to_Proto'>pqEndcopy3</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN2521"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
        <span class='Control'>return</span> <a href="libpq-int.h.html#LN592"><span class='Ref_to_Proto'>pqEndcopy2</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN2521"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
 
<span class='Comment_Multi_Line'>/* ---------------- 
 *      PQfn -  Send a function call to the POSTGRES backend. 
 * 
 *      conn            : backend connection 
 *      fnid            : OID of function to be called 
 *      result_buf      : pointer to result buffer 
 *      result_len      : actual length of result is returned here 
 *      result_is_int   : If the result is an integer, this must be 1, 
 *                        otherwise this should be 0 
 *      args            : pointer to an array of function arguments 
 *                        (each has length, if integer, and value/pointer) 
 *      nargs           : # of arguments in args array. 
 * 
 * RETURNS 
 *      PGresult with status = PGRES_COMMAND_OK if successful. 
 *          *result_len is &GT; 0 if there is a return value, 0 if not. 
 *      PGresult with status = PGRES_FATAL_ERROR if backend returns an error. 
 *      NULL on communications failure.  conn-&GT;errorMessage will be set. 
 * ---------------- 
 */ 
</span> 
<a href="libpq-fe.h.html#LN146"><span class='Ref_to_Typedef'>PGresult</span></a> <span class='Operator'>* 
</span><a name="LN2555"></a><span class='Declare_Function'>PQfn</span><span class='Parentheses'>(</span><a href="libpq-fe.h.html#LN139"><span class='Ref_to_Typedef'>PGconn</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>conn</span><span class='Delimiter'>, 
</span><a name="LN2556"></a>     <span class='Keyword'>int </span><span class='Declare_Parameter'>fnid</span><span class='Delimiter'>, 
</span><a name="LN2557"></a>     <span class='Keyword'>int </span><span class='Operator'>*</span><span class='Declare_Parameter'>result_buf</span><span class='Delimiter'>, 
</span><a name="LN2558"></a>     <span class='Keyword'>int </span><span class='Operator'>*</span><span class='Declare_Parameter'>result_len</span><span class='Delimiter'>, 
</span><a name="LN2559"></a>     <span class='Keyword'>int </span><span class='Declare_Parameter'>result_is_int</span><span class='Delimiter'>, 
</span><a name="LN2560"></a>     <span class='Keyword'>const </span><a href="libpq-fe.h.html#LN219"><span class='Ref_to_Typedef'>PQArgBlock</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>args</span><span class='Delimiter'>, 
</span><a name="LN2561"></a>     <span class='Keyword'>int </span><span class='Declare_Parameter'>nargs</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Operator'>*</span><a href="fe-exec.c.html#LN2558"><span class='Ref_to_Parameter'>result_len</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="fe-exec.c.html#LN2555"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* clear the error string */ 
</span>    <a href="pqexpbuffer.h.html#LN129"><span class='Ref_to_Proto'>resetPQExpBuffer</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="fe-exec.c.html#LN2555"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN491"><span class='Ref_to_Member'>errorMessage</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN2555"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN399"><span class='Ref_to_Member'>sock</span></a> <span class='Operator'>== </span><a href="../../include/port.h.html#LN23"><span class='Ref_to_Const'>PGINVALID_SOCKET</span></a> <span class='Operator'>|| </span><a href="fe-exec.c.html#LN2555"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN378"><span class='Ref_to_Member'>asyncStatus</span></a> <span class='Operator'>!= </span><a href="libpq-int.h.html#LN215"><span class='Ref_to_EnumConst'>PGASYNC_IDLE</span></a> <span class='Operator'>|| 
</span>        <a href="fe-exec.c.html#LN2555"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN450"><span class='Ref_to_Member'>result</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="pqexpbuffer.c.html#LN232"><span class='Ref_to_Func'>printfPQExpBuffer</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="fe-exec.c.html#LN2555"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN491"><span class='Ref_to_Member'>errorMessage</span></a><span class='Delimiter'>, 
</span>                          <a href="win32.c.html#LN36"><span class='Ref_to_Func'>libpq_gettext</span></a><span class='Parentheses'>(</span><span class='String'>"connection in wrong state\n"</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/libpq/pqcomm.h.html#LN103"><span class='Ref_to_Macro'>PG_PROTOCOL_MAJOR</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN2555"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN403"><span class='Ref_to_Member'>pversion</span></a><span class='Parentheses'>) </span><span class='Operator'>&GT;= </span><span class='Number'>3</span><span class='Parentheses'>)</span> 
        <span class='Control'>return</span> <a href="libpq-int.h.html#LN610"><span class='Ref_to_Proto'>pqFunctionCall3</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN2555"><span class='Ref_to_Parameter'>conn</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN2556"><span class='Ref_to_Parameter'>fnid</span></a><span class='Delimiter'>, 
</span>                               <a href="fe-exec.c.html#LN2557"><span class='Ref_to_Parameter'>result_buf</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN2558"><span class='Ref_to_Parameter'>result_len</span></a><span class='Delimiter'>, 
</span>                               <a href="fe-exec.c.html#LN2559"><span class='Ref_to_Parameter'>result_is_int</span></a><span class='Delimiter'>, 
</span>                               <a href="fe-exec.c.html#LN2560"><span class='Ref_to_Parameter'>args</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN2561"><span class='Ref_to_Parameter'>nargs</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
        <span class='Control'>return</span> <a href="libpq-int.h.html#LN593"><span class='Ref_to_Proto'>pqFunctionCall2</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN2555"><span class='Ref_to_Parameter'>conn</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN2556"><span class='Ref_to_Parameter'>fnid</span></a><span class='Delimiter'>, 
</span>                               <a href="fe-exec.c.html#LN2557"><span class='Ref_to_Parameter'>result_buf</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN2558"><span class='Ref_to_Parameter'>result_len</span></a><span class='Delimiter'>, 
</span>                               <a href="fe-exec.c.html#LN2559"><span class='Ref_to_Parameter'>result_is_int</span></a><span class='Delimiter'>, 
</span>                               <a href="fe-exec.c.html#LN2560"><span class='Ref_to_Parameter'>args</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN2561"><span class='Ref_to_Parameter'>nargs</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end PQfn &raquo; </span> 
 
 
<span class='Comment_Multi_Line'>/* ====== accessor funcs for PGresult ======== */ 
</span> 
<a href="libpq-fe.h.html#LN81"><span class='Ref_to_Typedef'>ExecStatusType</span></a> 
<a name="LN2595"></a><span class='Declare_Function'>PQresultStatus</span><span class='Parentheses'>(</span><span class='Keyword'>const </span><a href="libpq-fe.h.html#LN146"><span class='Ref_to_Typedef'>PGresult</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>res</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="fe-exec.c.html#LN2595"><span class='Ref_to_Parameter'>res</span></a><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <a href="libpq-fe.h.html#LN95"><span class='Ref_to_EnumConst'>PGRES_FATAL_ERROR</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <a href="fe-exec.c.html#LN2595"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN176"><span class='Ref_to_Member'>resultStatus</span></a><span class='Delimiter'>; 
} 
</span> 
<span class='Keyword'>char </span><span class='Operator'>* 
</span><a name="LN2603"></a><span class='Declare_Function'>PQresStatus</span><span class='Parentheses'>(</span><a href="libpq-fe.h.html#LN81"><span class='Ref_to_Typedef'>ExecStatusType</span></a> <span class='Declare_Parameter'>status</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>((</span><span class='Keyword'>unsigned int</span><span class='Parentheses'>) </span><a href="fe-exec.c.html#LN2603"><span class='Ref_to_Parameter'>status</span></a> <span class='Operator'>&GT;= </span><span class='Keyword'>sizeof </span><a href="fe-exec.c.html#LN31"><span class='Ref_to_Global_Var'>pgresStatus</span></a> <span class='Operator'>/ </span><span class='Keyword'>sizeof </span><a href="fe-exec.c.html#LN31"><span class='Ref_to_Global_Var'>pgresStatus</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>]</span><span class='Parentheses'>)</span> 
        <span class='Control'>return</span> <a href="win32.c.html#LN36"><span class='Ref_to_Func'>libpq_gettext</span></a><span class='Parentheses'>(</span><span class='String'>"invalid ExecStatusType code"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <a href="fe-exec.c.html#LN31"><span class='Ref_to_Global_Var'>pgresStatus</span></a><span class='Delimiter'>[</span><a href="fe-exec.c.html#LN2603"><span class='Ref_to_Parameter'>status</span></a><span class='Delimiter'>]; 
} 
</span> 
<span class='Keyword'>char </span><span class='Operator'>* 
</span><a name="LN2611"></a><span class='Declare_Function'>PQresultErrorMessage</span><span class='Parentheses'>(</span><span class='Keyword'>const </span><a href="libpq-fe.h.html#LN146"><span class='Ref_to_Typedef'>PGresult</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>res</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="fe-exec.c.html#LN2611"><span class='Ref_to_Parameter'>res</span></a> <span class='Operator'>|| !</span><a href="fe-exec.c.html#LN2611"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN195"><span class='Ref_to_Member'>errMsg</span></a><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <span class='String'>""</span><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <a href="fe-exec.c.html#LN2611"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN195"><span class='Ref_to_Member'>errMsg</span></a><span class='Delimiter'>; 
} 
</span> 
<span class='Keyword'>char </span><span class='Operator'>* 
</span><a name="LN2619"></a><span class='Declare_Function'>PQresultVerboseErrorMessage</span><span class='Parentheses'>(</span><span class='Keyword'>const </span><a href="libpq-fe.h.html#LN146"><span class='Ref_to_Typedef'>PGresult</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>res</span><span class='Delimiter'>, 
</span><a name="LN2620"></a>                            <a href="libpq-fe.h.html#LN109"><span class='Ref_to_Typedef'>PGVerbosity</span></a> <span class='Declare_Parameter'>verbosity</span><span class='Delimiter'>, 
</span><a name="LN2621"></a>                            <a href="libpq-fe.h.html#LN116"><span class='Ref_to_Typedef'>PGContextVisibility</span></a> <span class='Declare_Parameter'>show_context</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN2623"></a>    <a href="pqexpbuffer.h.html#LN43"><span class='Ref_to_Struct'>PQExpBufferData</span></a> <span class='Declare_Local'>workBuf</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Because the caller is expected to free the result string, we must 
     * strdup any constant result.  We use plain strdup and document that 
     * callers should expect NULL if out-of-memory. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="fe-exec.c.html#LN2619"><span class='Ref_to_Parameter'>res</span></a> <span class='Operator'>|| 
</span>        <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN2619"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN176"><span class='Ref_to_Member'>resultStatus</span></a> <span class='Operator'>!= </span><a href="libpq-fe.h.html#LN95"><span class='Ref_to_EnumConst'>PGRES_FATAL_ERROR</span></a> <span class='Operator'>&& 
</span>         <a href="fe-exec.c.html#LN2619"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN176"><span class='Ref_to_Member'>resultStatus</span></a> <span class='Operator'>!= </span><a href="libpq-fe.h.html#LN94"><span class='Ref_to_EnumConst'>PGRES_NONFATAL_ERROR</span></a><span class='Parentheses'>))</span> 
        <span class='Control'>return</span> strdup<span class='Parentheses'>(</span><a href="win32.c.html#LN36"><span class='Ref_to_Func'>libpq_gettext</span></a><span class='Parentheses'>(</span><span class='String'>"PGresult is not an error result\n"</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <a href="pqexpbuffer.c.html#LN87"><span class='Ref_to_Func'>initPQExpBuffer</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="fe-exec.c.html#LN2623"><span class='Ref_To_Local'>workBuf</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Currently, we pass this off to fe-protocol3.c in all cases; it will 
     * behave reasonably sanely with an error reported by fe-protocol2.c as 
     * well.  If necessary, we could record the protocol version in PGresults 
     * so as to be able to invoke a version-specific message formatter, but 
     * for now there's no need. 
     */ 
</span>    <a href="libpq-int.h.html#LN604"><span class='Ref_to_Proto'>pqBuildErrorMessage3</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="fe-exec.c.html#LN2623"><span class='Ref_To_Local'>workBuf</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN2619"><span class='Ref_to_Parameter'>res</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN2620"><span class='Ref_to_Parameter'>verbosity</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN2621"><span class='Ref_to_Parameter'>show_context</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* If insufficient memory to format the message, fail cleanly */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="pqexpbuffer.h.html#LN66"><span class='Ref_to_Macro'>PQExpBufferDataBroken</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN2623"><span class='Ref_To_Local'>workBuf</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span>        <a href="pqexpbuffer.h.html#LN121"><span class='Ref_to_Proto'>termPQExpBuffer</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="fe-exec.c.html#LN2623"><span class='Ref_To_Local'>workBuf</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> strdup<span class='Parentheses'>(</span><a href="win32.c.html#LN36"><span class='Ref_to_Func'>libpq_gettext</span></a><span class='Parentheses'>(</span><span class='String'>"out of memory\n"</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>return</span> <a href="fe-exec.c.html#LN2623"><span class='Ref_To_Local'>workBuf</span></a><span class='Operator'>.</span><a href="pqexpbuffer.h.html#LN45"><span class='Ref_to_Member'>data</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end PQresultVerboseErrorMessage &raquo; </span> 
 
<span class='Keyword'>char </span><span class='Operator'>* 
</span><a name="LN2657"></a><span class='Declare_Function'>PQresultErrorField</span><span class='Parentheses'>(</span><span class='Keyword'>const </span><a href="libpq-fe.h.html#LN146"><span class='Ref_to_Typedef'>PGresult</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>res</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>fieldcode</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN2659"></a>    <a href="libpq-int.h.html#LN141"><span class='Ref_to_Typedef'>PGMessageField</span></a> <span class='Operator'>*</span><span class='Declare_Local'>pfield</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="fe-exec.c.html#LN2657"><span class='Ref_to_Parameter'>res</span></a><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN2659"><span class='Ref_To_Local'>pfield</span></a> <span class='Operator'>= </span><a href="fe-exec.c.html#LN2657"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN196"><span class='Ref_to_Member'>errFields</span></a><span class='Delimiter'>; </span><a href="fe-exec.c.html#LN2659"><span class='Ref_To_Local'>pfield</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; </span><a href="fe-exec.c.html#LN2659"><span class='Ref_To_Local'>pfield</span></a> <span class='Operator'>= </span><a href="fe-exec.c.html#LN2659"><span class='Ref_To_Local'>pfield</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN143"><span class='Ref_to_Member'>next</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN2659"><span class='Ref_To_Local'>pfield</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN144"><span class='Ref_to_Member'>code</span></a> <span class='Operator'>== </span><a href="fe-exec.c.html#LN2657"><span class='Ref_to_Parameter'>fieldcode</span></a><span class='Parentheses'>) 
</span>            <span class='Control'>return</span> <a href="fe-exec.c.html#LN2659"><span class='Ref_To_Local'>pfield</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN145"><span class='Ref_to_Member'>contents</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>return</span> <span class='Null_Value'>NULL</span><span class='Delimiter'>; 
} 
</span> 
<span class='Keyword'>int 
</span><a name="LN2672"></a><span class='Declare_Function'>PQntuples</span><span class='Parentheses'>(</span><span class='Keyword'>const </span><a href="libpq-fe.h.html#LN146"><span class='Ref_to_Typedef'>PGresult</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>res</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="fe-exec.c.html#LN2672"><span class='Ref_to_Parameter'>res</span></a><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <span class='Number'>0</span><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <a href="fe-exec.c.html#LN2672"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN168"><span class='Ref_to_Member'>ntups</span></a><span class='Delimiter'>; 
} 
</span> 
<span class='Keyword'>int 
</span><a name="LN2680"></a><span class='Declare_Function'>PQnfields</span><span class='Parentheses'>(</span><span class='Keyword'>const </span><a href="libpq-fe.h.html#LN146"><span class='Ref_to_Typedef'>PGresult</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>res</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="fe-exec.c.html#LN2680"><span class='Ref_to_Parameter'>res</span></a><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <span class='Number'>0</span><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <a href="fe-exec.c.html#LN2680"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN169"><span class='Ref_to_Member'>numAttributes</span></a><span class='Delimiter'>; 
} 
</span> 
<span class='Keyword'>int 
</span><a name="LN2688"></a><span class='Declare_Function'>PQbinaryTuples</span><span class='Parentheses'>(</span><span class='Keyword'>const </span><a href="libpq-fe.h.html#LN146"><span class='Ref_to_Typedef'>PGresult</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>res</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="fe-exec.c.html#LN2688"><span class='Ref_to_Parameter'>res</span></a><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <span class='Number'>0</span><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <a href="fe-exec.c.html#LN2688"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN178"><span class='Ref_to_Member'>binary</span></a><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * Helper routines to range-check field numbers and tuple numbers. 
 * Return TRUE if OK, FALSE if not 
 */ 
</span> 
<span class='Keyword'>static int 
</span><a name="LN2701"></a><span class='Declare_Function'>check_field_number</span><span class='Parentheses'>(</span><span class='Keyword'>const </span><a href="libpq-fe.h.html#LN146"><span class='Ref_to_Typedef'>PGresult</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>res</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>field_num</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="fe-exec.c.html#LN2701"><span class='Ref_to_Parameter'>res</span></a><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <span class='Boolean'>FALSE</span><span class='Delimiter'>;</span>           <span class='Comment_Single_Line'>/* no way to display error message... */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN2701"><span class='Ref_to_Parameter'>field_num</span></a> <span class='Operator'>&LT; </span><span class='Number'>0</span> <span class='Operator'>|| </span><a href="fe-exec.c.html#LN2701"><span class='Ref_to_Parameter'>field_num</span></a> <span class='Operator'>&GT;= </span><a href="fe-exec.c.html#LN2701"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN169"><span class='Ref_to_Member'>numAttributes</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="fe-exec.c.html#LN799"><span class='Ref_to_Func'>pqInternalNotice</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="fe-exec.c.html#LN2701"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN185"><span class='Ref_to_Member'>noticeHooks</span></a><span class='Delimiter'>, 
</span>                         <span class='String'>"column number %d is out of range 0..%d"</span><span class='Delimiter'>, 
</span>                         <a href="fe-exec.c.html#LN2701"><span class='Ref_to_Parameter'>field_num</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN2701"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN169"><span class='Ref_to_Member'>numAttributes</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <span class='Boolean'>FALSE</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>return</span> <span class='Boolean'>TRUE</span><span class='Delimiter'>; 
} 
</span> 
<span class='Keyword'>static int 
</span><a name="LN2716"></a><span class='Declare_Function'>check_tuple_field_number</span><span class='Parentheses'>(</span><span class='Keyword'>const </span><a href="libpq-fe.h.html#LN146"><span class='Ref_to_Typedef'>PGresult</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>res</span><span class='Delimiter'>, 
</span><a name="LN2717"></a>                         <span class='Keyword'>int </span><span class='Declare_Parameter'>tup_num</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>field_num</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="fe-exec.c.html#LN2716"><span class='Ref_to_Parameter'>res</span></a><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <span class='Boolean'>FALSE</span><span class='Delimiter'>;</span>           <span class='Comment_Single_Line'>/* no way to display error message... */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN2717"><span class='Ref_to_Parameter'>tup_num</span></a> <span class='Operator'>&LT; </span><span class='Number'>0</span> <span class='Operator'>|| </span><a href="fe-exec.c.html#LN2717"><span class='Ref_to_Parameter'>tup_num</span></a> <span class='Operator'>&GT;= </span><a href="fe-exec.c.html#LN2716"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN168"><span class='Ref_to_Member'>ntups</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="fe-exec.c.html#LN799"><span class='Ref_to_Func'>pqInternalNotice</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="fe-exec.c.html#LN2716"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN185"><span class='Ref_to_Member'>noticeHooks</span></a><span class='Delimiter'>, 
</span>                         <span class='String'>"row number %d is out of range 0..%d"</span><span class='Delimiter'>, 
</span>                         <a href="fe-exec.c.html#LN2717"><span class='Ref_to_Parameter'>tup_num</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN2716"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN168"><span class='Ref_to_Member'>ntups</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <span class='Boolean'>FALSE</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN2717"><span class='Ref_to_Parameter'>field_num</span></a> <span class='Operator'>&LT; </span><span class='Number'>0</span> <span class='Operator'>|| </span><a href="fe-exec.c.html#LN2717"><span class='Ref_to_Parameter'>field_num</span></a> <span class='Operator'>&GT;= </span><a href="fe-exec.c.html#LN2716"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN169"><span class='Ref_to_Member'>numAttributes</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="fe-exec.c.html#LN799"><span class='Ref_to_Func'>pqInternalNotice</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="fe-exec.c.html#LN2716"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN185"><span class='Ref_to_Member'>noticeHooks</span></a><span class='Delimiter'>, 
</span>                         <span class='String'>"column number %d is out of range 0..%d"</span><span class='Delimiter'>, 
</span>                         <a href="fe-exec.c.html#LN2717"><span class='Ref_to_Parameter'>field_num</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN2716"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN169"><span class='Ref_to_Member'>numAttributes</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <span class='Boolean'>FALSE</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>return</span> <span class='Boolean'>TRUE</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end check_tuple_field_number &raquo; </span> 
 
<span class='Keyword'>static int 
</span><a name="LN2739"></a><span class='Declare_Function'>check_param_number</span><span class='Parentheses'>(</span><span class='Keyword'>const </span><a href="libpq-fe.h.html#LN146"><span class='Ref_to_Typedef'>PGresult</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>res</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>param_num</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="fe-exec.c.html#LN2739"><span class='Ref_to_Parameter'>res</span></a><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <span class='Boolean'>FALSE</span><span class='Delimiter'>;</span>           <span class='Comment_Single_Line'>/* no way to display error message... */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN2739"><span class='Ref_to_Parameter'>param_num</span></a> <span class='Operator'>&LT; </span><span class='Number'>0</span> <span class='Operator'>|| </span><a href="fe-exec.c.html#LN2739"><span class='Ref_to_Parameter'>param_num</span></a> <span class='Operator'>&GT;= </span><a href="fe-exec.c.html#LN2739"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN174"><span class='Ref_to_Member'>numParameters</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="fe-exec.c.html#LN799"><span class='Ref_to_Func'>pqInternalNotice</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="fe-exec.c.html#LN2739"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN185"><span class='Ref_to_Member'>noticeHooks</span></a><span class='Delimiter'>, 
</span>                         <span class='String'>"parameter number %d is out of range 0..%d"</span><span class='Delimiter'>, 
</span>                         <a href="fe-exec.c.html#LN2739"><span class='Ref_to_Parameter'>param_num</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN2739"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN174"><span class='Ref_to_Member'>numParameters</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <span class='Boolean'>FALSE</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>return</span> <span class='Boolean'>TRUE</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * returns NULL if the field_num is invalid 
 */ 
</span><span class='Keyword'>char </span><span class='Operator'>* 
</span><a name="LN2758"></a><span class='Declare_Function'>PQfname</span><span class='Parentheses'>(</span><span class='Keyword'>const </span><a href="libpq-fe.h.html#LN146"><span class='Ref_to_Typedef'>PGresult</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>res</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>field_num</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="fe-exec.c.html#LN70"><span class='Ref_to_Proto'>check_field_number</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN2758"><span class='Ref_to_Parameter'>res</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN2758"><span class='Ref_to_Parameter'>field_num</span></a><span class='Parentheses'>))</span> 
        <span class='Control'>return</span> <span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN2758"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN170"><span class='Ref_to_Member'>attDescs</span></a><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <a href="fe-exec.c.html#LN2758"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN170"><span class='Ref_to_Member'>attDescs</span></a><span class='Delimiter'>[</span><a href="fe-exec.c.html#LN2758"><span class='Ref_to_Parameter'>field_num</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="libpq-fe.h.html#LN236"><span class='Ref_to_Member'>name</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
        <span class='Control'>return</span> <span class='Null_Value'>NULL</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * PQfnumber: find column number given column name 
 * 
 * The column name is parsed as if it were in a SQL statement, including 
 * case-folding and double-quote processing.  But note a possible gotcha: 
 * downcasing in the frontend might follow different locale rules than 
 * downcasing in the backend... 
 * 
 * Returns -1 if no match.  In the present backend it is also possible 
 * to have multiple matches, in which case the first one is found. 
 */ 
</span><span class='Keyword'>int 
</span><a name="LN2780"></a><span class='Declare_Function'>PQfnumber</span><span class='Parentheses'>(</span><span class='Keyword'>const </span><a href="libpq-fe.h.html#LN146"><span class='Ref_to_Typedef'>PGresult</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>res</span><span class='Delimiter'>, </span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>field_name</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN2782"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>field_case</span><span class='Delimiter'>; 
</span><a name="LN2783"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>in_quotes</span><span class='Delimiter'>; 
</span><a name="LN2784"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>all_lower</span> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span><a name="LN2785"></a>    <span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Local'>iptr</span><span class='Delimiter'>; 
</span><a name="LN2786"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>optr</span><span class='Delimiter'>; 
</span><a name="LN2787"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>i</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="fe-exec.c.html#LN2780"><span class='Ref_to_Parameter'>res</span></a><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Note: it is correct to reject a zero-length input string; the proper 
     * input to match a zero-length field name would be "". 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN2780"><span class='Ref_to_Parameter'>field_name</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL </span><span class='Operator'>|| 
</span>        <a href="fe-exec.c.html#LN2780"><span class='Ref_to_Parameter'>field_name</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>] </span><span class='Operator'>== </span><span class='String'>'\0'</span> <span class='Operator'>|| 
</span>        <a href="fe-exec.c.html#LN2780"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN170"><span class='Ref_to_Member'>attDescs</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Check if we can avoid the strdup() and related work because the 
     * passed-in string wouldn't be changed before we do the check anyway. 
     */ 
</span>    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN2785"><span class='Ref_To_Local'>iptr</span></a> <span class='Operator'>= </span><a href="fe-exec.c.html#LN2780"><span class='Ref_to_Parameter'>field_name</span></a><span class='Delimiter'>; </span><span class='Operator'>*</span><a href="fe-exec.c.html#LN2785"><span class='Ref_To_Local'>iptr</span></a><span class='Delimiter'>; </span><a href="fe-exec.c.html#LN2785"><span class='Ref_To_Local'>iptr</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN2807"></a>        <span class='Keyword'>char</span>        <span class='Declare_Local'>c</span> <span class='Operator'>= *</span><a href="fe-exec.c.html#LN2785"><span class='Ref_To_Local'>iptr</span></a><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN2807"><span class='Ref_To_Local'>c</span></a> <span class='Operator'>== </span><span class='String'>'"'</span> <span class='Operator'>|| </span><a href="fe-exec.c.html#LN2807"><span class='Ref_To_Local'>c</span></a> <span class='Operator'>!= </span><a href="../../port/pgstrcasecmp.c.html#LN120"><span class='Ref_to_Func'>pg_tolower</span></a><span class='Parentheses'>((</span><span class='Keyword'>unsigned char</span><span class='Parentheses'>) </span><a href="fe-exec.c.html#LN2807"><span class='Ref_To_Local'>c</span></a><span class='Parentheses'>))</span> 
        <span class='Delimiter'>{ 
</span>            <a href="fe-exec.c.html#LN2784"><span class='Ref_To_Local'>all_lower</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN2784"><span class='Ref_To_Local'>all_lower</span></a><span class='Parentheses'>) 
</span>        <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN2787"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="fe-exec.c.html#LN2787"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="fe-exec.c.html#LN2780"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN169"><span class='Ref_to_Member'>numAttributes</span></a><span class='Delimiter'>; </span><a href="fe-exec.c.html#LN2787"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span>strcmp<span class='Parentheses'>(</span><a href="fe-exec.c.html#LN2780"><span class='Ref_to_Parameter'>field_name</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN2780"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN170"><span class='Ref_to_Member'>attDescs</span></a><span class='Delimiter'>[</span><a href="fe-exec.c.html#LN2787"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="libpq-fe.h.html#LN236"><span class='Ref_to_Member'>name</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
                <span class='Control'>return</span> <a href="fe-exec.c.html#LN2787"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Fall through to the normal check if that didn't work out. */ 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Note: this code will not reject partially quoted strings, eg 
     * foo"BAR"foo will become fooBARfoo when it probably ought to be an error 
     * condition. 
     */ 
</span>    <a href="fe-exec.c.html#LN2782"><span class='Ref_To_Local'>field_case</span></a> <span class='Operator'>= </span>strdup<span class='Parentheses'>(</span><a href="fe-exec.c.html#LN2780"><span class='Ref_to_Parameter'>field_name</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN2782"><span class='Ref_To_Local'>field_case</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>;</span>              <span class='Comment_Single_Line'>/* grotty */ 
</span> 
    <a href="fe-exec.c.html#LN2783"><span class='Ref_To_Local'>in_quotes</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>    <a href="fe-exec.c.html#LN2786"><span class='Ref_To_Local'>optr</span></a> <span class='Operator'>= </span><a href="fe-exec.c.html#LN2782"><span class='Ref_To_Local'>field_case</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN2785"><span class='Ref_To_Local'>iptr</span></a> <span class='Operator'>= </span><a href="fe-exec.c.html#LN2782"><span class='Ref_To_Local'>field_case</span></a><span class='Delimiter'>; </span><span class='Operator'>*</span><a href="fe-exec.c.html#LN2785"><span class='Ref_To_Local'>iptr</span></a><span class='Delimiter'>; </span><a href="fe-exec.c.html#LN2785"><span class='Ref_To_Local'>iptr</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN2836"></a>        <span class='Keyword'>char</span>        <span class='Declare_Local'>c</span> <span class='Operator'>= *</span><a href="fe-exec.c.html#LN2785"><span class='Ref_To_Local'>iptr</span></a><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN2783"><span class='Ref_To_Local'>in_quotes</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN2836"><span class='Ref_To_Local'>c</span></a> <span class='Operator'>== </span><span class='String'>'"'</span><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN2785"><span class='Ref_To_Local'>iptr</span></a><span class='Delimiter'>[</span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>== </span><span class='String'>'"'</span><span class='Parentheses'>) 
</span>                <span class='Delimiter'>{ 
</span>                    <span class='Comment_Multi_Line'>/* doubled quotes become a single quote */ 
</span>                    <span class='Operator'>*</span><a href="fe-exec.c.html#LN2786"><span class='Ref_To_Local'>optr</span></a><span class='Operator'>++ = </span><span class='String'>'"'</span><span class='Delimiter'>; 
</span>                    <a href="fe-exec.c.html#LN2785"><span class='Ref_To_Local'>iptr</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>                <span class='Delimiter'>} 
</span>                <span class='Control'>else</span> 
                    <a href="fe-exec.c.html#LN2783"><span class='Ref_To_Local'>in_quotes</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>            <span class='Control'>else</span> 
                <span class='Operator'>*</span><a href="fe-exec.c.html#LN2786"><span class='Ref_To_Local'>optr</span></a><span class='Operator'>++ = </span><a href="fe-exec.c.html#LN2836"><span class='Ref_To_Local'>c</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN2836"><span class='Ref_To_Local'>c</span></a> <span class='Operator'>== </span><span class='String'>'"'</span><span class='Parentheses'>) 
</span>            <a href="fe-exec.c.html#LN2783"><span class='Ref_To_Local'>in_quotes</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> 
        <span class='Delimiter'>{ 
</span>            <a href="fe-exec.c.html#LN2836"><span class='Ref_To_Local'>c</span></a> <span class='Operator'>= </span><a href="../../port/pgstrcasecmp.c.html#LN120"><span class='Ref_to_Func'>pg_tolower</span></a><span class='Parentheses'>((</span><span class='Keyword'>unsigned char</span><span class='Parentheses'>) </span><a href="fe-exec.c.html#LN2836"><span class='Ref_To_Local'>c</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Operator'>*</span><a href="fe-exec.c.html#LN2786"><span class='Ref_To_Local'>optr</span></a><span class='Operator'>++ = </span><a href="fe-exec.c.html#LN2836"><span class='Ref_To_Local'>c</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end for iptr=field_case;*iptr... &raquo; </span> 
    <span class='Operator'>*</span><a href="fe-exec.c.html#LN2786"><span class='Ref_To_Local'>optr</span></a> <span class='Operator'>= </span><span class='String'>'\0'</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN2787"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="fe-exec.c.html#LN2787"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="fe-exec.c.html#LN2780"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN169"><span class='Ref_to_Member'>numAttributes</span></a><span class='Delimiter'>; </span><a href="fe-exec.c.html#LN2787"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span>strcmp<span class='Parentheses'>(</span><a href="fe-exec.c.html#LN2782"><span class='Ref_To_Local'>field_case</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN2780"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN170"><span class='Ref_to_Member'>attDescs</span></a><span class='Delimiter'>[</span><a href="fe-exec.c.html#LN2787"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="libpq-fe.h.html#LN236"><span class='Ref_to_Member'>name</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <span class='Delimiter'>{ 
</span>            <a href="../../include/snowball/header.h.html#LN64"><span class='Ref_to_Macro'>free</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN2782"><span class='Ref_To_Local'>field_case</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>return</span> <a href="fe-exec.c.html#LN2787"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>} 
</span>    <a href="../../include/snowball/header.h.html#LN64"><span class='Ref_to_Macro'>free</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN2782"><span class='Ref_To_Local'>field_case</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end PQfnumber &raquo; </span> 
 
<a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> 
<a name="LN2877"></a><span class='Declare_Function'>PQftable</span><span class='Parentheses'>(</span><span class='Keyword'>const </span><a href="libpq-fe.h.html#LN146"><span class='Ref_to_Typedef'>PGresult</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>res</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>field_num</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="fe-exec.c.html#LN70"><span class='Ref_to_Proto'>check_field_number</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN2877"><span class='Ref_to_Parameter'>res</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN2877"><span class='Ref_to_Parameter'>field_num</span></a><span class='Parentheses'>))</span> 
        <span class='Control'>return</span> <a href="../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN2877"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN170"><span class='Ref_to_Member'>attDescs</span></a><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <a href="fe-exec.c.html#LN2877"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN170"><span class='Ref_to_Member'>attDescs</span></a><span class='Delimiter'>[</span><a href="fe-exec.c.html#LN2877"><span class='Ref_to_Parameter'>field_num</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="libpq-fe.h.html#LN237"><span class='Ref_to_Member'>tableid</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
        <span class='Control'>return</span> <a href="../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Delimiter'>; 
} 
</span> 
<span class='Keyword'>int 
</span><a name="LN2888"></a><span class='Declare_Function'>PQftablecol</span><span class='Parentheses'>(</span><span class='Keyword'>const </span><a href="libpq-fe.h.html#LN146"><span class='Ref_to_Typedef'>PGresult</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>res</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>field_num</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="fe-exec.c.html#LN70"><span class='Ref_to_Proto'>check_field_number</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN2888"><span class='Ref_to_Parameter'>res</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN2888"><span class='Ref_to_Parameter'>field_num</span></a><span class='Parentheses'>))</span> 
        <span class='Control'>return</span> <span class='Number'>0</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN2888"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN170"><span class='Ref_to_Member'>attDescs</span></a><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <a href="fe-exec.c.html#LN2888"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN170"><span class='Ref_to_Member'>attDescs</span></a><span class='Delimiter'>[</span><a href="fe-exec.c.html#LN2888"><span class='Ref_to_Parameter'>field_num</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="libpq-fe.h.html#LN238"><span class='Ref_to_Member'>columnid</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
        <span class='Control'>return</span> <span class='Number'>0</span><span class='Delimiter'>; 
} 
</span> 
<span class='Keyword'>int 
</span><a name="LN2899"></a><span class='Declare_Function'>PQfformat</span><span class='Parentheses'>(</span><span class='Keyword'>const </span><a href="libpq-fe.h.html#LN146"><span class='Ref_to_Typedef'>PGresult</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>res</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>field_num</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="fe-exec.c.html#LN70"><span class='Ref_to_Proto'>check_field_number</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN2899"><span class='Ref_to_Parameter'>res</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN2899"><span class='Ref_to_Parameter'>field_num</span></a><span class='Parentheses'>))</span> 
        <span class='Control'>return</span> <span class='Number'>0</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN2899"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN170"><span class='Ref_to_Member'>attDescs</span></a><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <a href="fe-exec.c.html#LN2899"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN170"><span class='Ref_to_Member'>attDescs</span></a><span class='Delimiter'>[</span><a href="fe-exec.c.html#LN2899"><span class='Ref_to_Parameter'>field_num</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="libpq-fe.h.html#LN239"><span class='Ref_to_Member'>format</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
        <span class='Control'>return</span> <span class='Number'>0</span><span class='Delimiter'>; 
} 
</span> 
<a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> 
<a name="LN2910"></a><span class='Declare_Function'>PQftype</span><span class='Parentheses'>(</span><span class='Keyword'>const </span><a href="libpq-fe.h.html#LN146"><span class='Ref_to_Typedef'>PGresult</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>res</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>field_num</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="fe-exec.c.html#LN70"><span class='Ref_to_Proto'>check_field_number</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN2910"><span class='Ref_to_Parameter'>res</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN2910"><span class='Ref_to_Parameter'>field_num</span></a><span class='Parentheses'>))</span> 
        <span class='Control'>return</span> <a href="../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN2910"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN170"><span class='Ref_to_Member'>attDescs</span></a><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <a href="fe-exec.c.html#LN2910"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN170"><span class='Ref_to_Member'>attDescs</span></a><span class='Delimiter'>[</span><a href="fe-exec.c.html#LN2910"><span class='Ref_to_Parameter'>field_num</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="libpq-fe.h.html#LN240"><span class='Ref_to_Member'>typid</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
        <span class='Control'>return</span> <a href="../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Delimiter'>; 
} 
</span> 
<span class='Keyword'>int 
</span><a name="LN2921"></a><span class='Declare_Function'>PQfsize</span><span class='Parentheses'>(</span><span class='Keyword'>const </span><a href="libpq-fe.h.html#LN146"><span class='Ref_to_Typedef'>PGresult</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>res</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>field_num</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="fe-exec.c.html#LN70"><span class='Ref_to_Proto'>check_field_number</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN2921"><span class='Ref_to_Parameter'>res</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN2921"><span class='Ref_to_Parameter'>field_num</span></a><span class='Parentheses'>))</span> 
        <span class='Control'>return</span> <span class='Number'>0</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN2921"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN170"><span class='Ref_to_Member'>attDescs</span></a><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <a href="fe-exec.c.html#LN2921"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN170"><span class='Ref_to_Member'>attDescs</span></a><span class='Delimiter'>[</span><a href="fe-exec.c.html#LN2921"><span class='Ref_to_Parameter'>field_num</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="libpq-fe.h.html#LN241"><span class='Ref_to_Member'>typlen</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
        <span class='Control'>return</span> <span class='Number'>0</span><span class='Delimiter'>; 
} 
</span> 
<span class='Keyword'>int 
</span><a name="LN2932"></a><span class='Declare_Function'>PQfmod</span><span class='Parentheses'>(</span><span class='Keyword'>const </span><a href="libpq-fe.h.html#LN146"><span class='Ref_to_Typedef'>PGresult</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>res</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>field_num</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="fe-exec.c.html#LN70"><span class='Ref_to_Proto'>check_field_number</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN2932"><span class='Ref_to_Parameter'>res</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN2932"><span class='Ref_to_Parameter'>field_num</span></a><span class='Parentheses'>))</span> 
        <span class='Control'>return</span> <span class='Number'>0</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN2932"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN170"><span class='Ref_to_Member'>attDescs</span></a><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <a href="fe-exec.c.html#LN2932"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN170"><span class='Ref_to_Member'>attDescs</span></a><span class='Delimiter'>[</span><a href="fe-exec.c.html#LN2932"><span class='Ref_to_Parameter'>field_num</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="libpq-fe.h.html#LN242"><span class='Ref_to_Member'>atttypmod</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
        <span class='Control'>return</span> <span class='Number'>0</span><span class='Delimiter'>; 
} 
</span> 
<span class='Keyword'>char </span><span class='Operator'>* 
</span><a name="LN2943"></a><span class='Declare_Function'>PQcmdStatus</span><span class='Parentheses'>(</span><a href="libpq-fe.h.html#LN146"><span class='Ref_to_Typedef'>PGresult</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>res</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="fe-exec.c.html#LN2943"><span class='Ref_to_Parameter'>res</span></a><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <a href="fe-exec.c.html#LN2943"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN177"><span class='Ref_to_Member'>cmdStatus</span></a><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * PQoidStatus - 
 *  if the last command was an INSERT, return the oid string 
 *  if not, return "" 
 */ 
</span><span class='Keyword'>char </span><span class='Operator'>* 
</span><a name="LN2956"></a><span class='Declare_Function'>PQoidStatus</span><span class='Parentheses'>(</span><span class='Keyword'>const </span><a href="libpq-fe.h.html#LN146"><span class='Ref_to_Typedef'>PGresult</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>res</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Comment_Multi_Line'>/* 
     * This must be enough to hold the result. Don't laugh, this is better 
     * than what this function used to do. 
     */ 
</span><a name="LN2962"></a>    <span class='Keyword'>static char </span><span class='Declare_Local'>buf</span><span class='Delimiter'>[</span><span class='Number'>24</span><span class='Delimiter'>]; 
</span> 
<a name="LN2964"></a>    size_t      <span class='Declare_Local'>len</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="fe-exec.c.html#LN2956"><span class='Ref_to_Parameter'>res</span></a> <span class='Operator'>|| </span>strncmp<span class='Parentheses'>(</span><a href="fe-exec.c.html#LN2956"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN177"><span class='Ref_to_Member'>cmdStatus</span></a><span class='Delimiter'>, </span><span class='String'>"INSERT "</span><span class='Delimiter'>, </span><span class='Number'>7</span><span class='Parentheses'>) </span><span class='Operator'>!= </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <span class='Control'>return</span> <span class='String'>""</span><span class='Delimiter'>; 
</span> 
    <a href="fe-exec.c.html#LN2964"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>= </span>strspn<span class='Parentheses'>(</span><a href="fe-exec.c.html#LN2956"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN177"><span class='Ref_to_Member'>cmdStatus</span></a> <span class='Operator'>+ </span><span class='Number'>7</span><span class='Delimiter'>, </span><span class='String'>"0123456789"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN2964"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>&GT; </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN2962"><span class='Ref_To_Local'>buf</span></a><span class='Parentheses'>) </span><span class='Operator'>- </span><span class='Number'>1</span><span class='Parentheses'>)</span> 
        <a href="fe-exec.c.html#LN2964"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>= </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN2962"><span class='Ref_To_Local'>buf</span></a><span class='Parentheses'>) </span><span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    memcpy<span class='Parentheses'>(</span><a href="fe-exec.c.html#LN2962"><span class='Ref_To_Local'>buf</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN2956"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN177"><span class='Ref_to_Member'>cmdStatus</span></a> <span class='Operator'>+ </span><span class='Number'>7</span><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN2964"><span class='Ref_To_Local'>len</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="fe-exec.c.html#LN2962"><span class='Ref_To_Local'>buf</span></a><span class='Delimiter'>[</span><a href="fe-exec.c.html#LN2964"><span class='Ref_To_Local'>len</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='String'>'\0'</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="fe-exec.c.html#LN2962"><span class='Ref_To_Local'>buf</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end PQoidStatus &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * PQoidValue - 
 *  a perhaps preferable form of the above which just returns 
 *  an Oid type 
 */ 
</span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> 
<a name="LN2984"></a><span class='Declare_Function'>PQoidValue</span><span class='Parentheses'>(</span><span class='Keyword'>const </span><a href="libpq-fe.h.html#LN146"><span class='Ref_to_Typedef'>PGresult</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>res</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN2986"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>endptr</span> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span><a name="LN2987"></a>    <span class='Keyword'>unsigned long </span><span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="fe-exec.c.html#LN2984"><span class='Ref_to_Parameter'>res</span></a> <span class='Operator'>|| 
</span>        strncmp<span class='Parentheses'>(</span><a href="fe-exec.c.html#LN2984"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN177"><span class='Ref_to_Member'>cmdStatus</span></a><span class='Delimiter'>, </span><span class='String'>"INSERT "</span><span class='Delimiter'>, </span><span class='Number'>7</span><span class='Parentheses'>) </span><span class='Operator'>!= </span><span class='Number'>0</span> <span class='Operator'>|| 
</span>        <a href="fe-exec.c.html#LN2984"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN177"><span class='Ref_to_Member'>cmdStatus</span></a><span class='Delimiter'>[</span><span class='Number'>7</span><span class='Delimiter'>] </span><span class='Operator'>&LT; </span><span class='String'>'0'</span> <span class='Operator'>|| 
</span>        <a href="fe-exec.c.html#LN2984"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN177"><span class='Ref_to_Member'>cmdStatus</span></a><span class='Delimiter'>[</span><span class='Number'>7</span><span class='Delimiter'>] </span><span class='Operator'>&GT; </span><span class='String'>'9'</span><span class='Parentheses'>)</span> 
        <span class='Control'>return</span> <a href="../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Delimiter'>; 
</span> 
    <a href="fe-exec.c.html#LN2987"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span>strtoul<span class='Parentheses'>(</span><a href="fe-exec.c.html#LN2984"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN177"><span class='Ref_to_Member'>cmdStatus</span></a> <span class='Operator'>+ </span><span class='Number'>7</span><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="fe-exec.c.html#LN2986"><span class='Ref_To_Local'>endptr</span></a><span class='Delimiter'>, </span><span class='Number'>10</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="fe-exec.c.html#LN2986"><span class='Ref_To_Local'>endptr</span></a> <span class='Operator'>|| </span><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="fe-exec.c.html#LN2986"><span class='Ref_To_Local'>endptr</span></a> <span class='Operator'>!= </span><span class='String'>' '</span> <span class='Operator'>&& *</span><a href="fe-exec.c.html#LN2986"><span class='Ref_To_Local'>endptr</span></a> <span class='Operator'>!= </span><span class='String'>'\0'</span><span class='Parentheses'>))</span> 
        <span class='Control'>return</span> <a href="../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
        <span class='Control'>return</span> <span class='Parentheses'>(</span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a><span class='Parentheses'>) </span><a href="fe-exec.c.html#LN2987"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>; 
} 
</span> 
 
<span class='Comment_Multi_Line'>/* 
 * PQcmdTuples - 
 *  If the last command was INSERT/UPDATE/DELETE/MOVE/FETCH/COPY, return 
 *  a string containing the number of inserted/affected tuples. If not, 
 *  return "". 
 * 
 *  XXX: this should probably return an int 
 */ 
</span><span class='Keyword'>char </span><span class='Operator'>* 
</span><a name="LN3013"></a><span class='Declare_Function'>PQcmdTuples</span><span class='Parentheses'>(</span><a href="libpq-fe.h.html#LN146"><span class='Ref_to_Typedef'>PGresult</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>res</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN3015"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>p</span><span class='Delimiter'>, 
</span><a name="LN3016"></a>               <span class='Operator'>*</span><span class='Declare_Local'>c</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="fe-exec.c.html#LN3013"><span class='Ref_to_Parameter'>res</span></a><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <span class='String'>""</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span>strncmp<span class='Parentheses'>(</span><a href="fe-exec.c.html#LN3013"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN177"><span class='Ref_to_Member'>cmdStatus</span></a><span class='Delimiter'>, </span><span class='String'>"INSERT "</span><span class='Delimiter'>, </span><span class='Number'>7</span><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
    <span class='Delimiter'>{ 
</span>        <a href="fe-exec.c.html#LN3015"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>= </span><a href="fe-exec.c.html#LN3013"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN177"><span class='Ref_to_Member'>cmdStatus</span></a> <span class='Operator'>+ </span><span class='Number'>7</span><span class='Delimiter'>; 
</span>        <span class='Comment_Multi_Line'>/* INSERT: skip oid and space */ 
</span>        <span class='Control'>while</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="fe-exec.c.html#LN3015"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>&& *</span><a href="fe-exec.c.html#LN3015"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>!= </span><span class='String'>' '</span><span class='Parentheses'>) 
</span>            <a href="fe-exec.c.html#LN3015"><span class='Ref_To_Local'>p</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="fe-exec.c.html#LN3015"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>            <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="fe-exec.c.html#LN3054"><span class='Ref_to_Label'>interpret_error</span></a><span class='Delimiter'>;</span>       <span class='Comment_Single_Line'>/* no space? */ 
</span>        <a href="fe-exec.c.html#LN3015"><span class='Ref_To_Local'>p</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span>strncmp<span class='Parentheses'>(</span><a href="fe-exec.c.html#LN3013"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN177"><span class='Ref_to_Member'>cmdStatus</span></a><span class='Delimiter'>, </span><span class='String'>"SELECT "</span><span class='Delimiter'>, </span><span class='Number'>7</span><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span> <span class='Operator'>|| 
</span>             strncmp<span class='Parentheses'>(</span><a href="fe-exec.c.html#LN3013"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN177"><span class='Ref_to_Member'>cmdStatus</span></a><span class='Delimiter'>, </span><span class='String'>"DELETE "</span><span class='Delimiter'>, </span><span class='Number'>7</span><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span> <span class='Operator'>|| 
</span>             strncmp<span class='Parentheses'>(</span><a href="fe-exec.c.html#LN3013"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN177"><span class='Ref_to_Member'>cmdStatus</span></a><span class='Delimiter'>, </span><span class='String'>"UPDATE "</span><span class='Delimiter'>, </span><span class='Number'>7</span><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <a href="fe-exec.c.html#LN3015"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>= </span><a href="fe-exec.c.html#LN3013"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN177"><span class='Ref_to_Member'>cmdStatus</span></a> <span class='Operator'>+ </span><span class='Number'>7</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span>strncmp<span class='Parentheses'>(</span><a href="fe-exec.c.html#LN3013"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN177"><span class='Ref_to_Member'>cmdStatus</span></a><span class='Delimiter'>, </span><span class='String'>"FETCH "</span><span class='Delimiter'>, </span><span class='Number'>6</span><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <a href="fe-exec.c.html#LN3015"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>= </span><a href="fe-exec.c.html#LN3013"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN177"><span class='Ref_to_Member'>cmdStatus</span></a> <span class='Operator'>+ </span><span class='Number'>6</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span>strncmp<span class='Parentheses'>(</span><a href="fe-exec.c.html#LN3013"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN177"><span class='Ref_to_Member'>cmdStatus</span></a><span class='Delimiter'>, </span><span class='String'>"MOVE "</span><span class='Delimiter'>, </span><span class='Number'>5</span><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span> <span class='Operator'>|| 
</span>             strncmp<span class='Parentheses'>(</span><a href="fe-exec.c.html#LN3013"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN177"><span class='Ref_to_Member'>cmdStatus</span></a><span class='Delimiter'>, </span><span class='String'>"COPY "</span><span class='Delimiter'>, </span><span class='Number'>5</span><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <a href="fe-exec.c.html#LN3015"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>= </span><a href="fe-exec.c.html#LN3013"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN177"><span class='Ref_to_Member'>cmdStatus</span></a> <span class='Operator'>+ </span><span class='Number'>5</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
        <span class='Control'>return</span> <span class='String'>""</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* check that we have an integer (at least one digit, nothing else) */ 
</span>    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN3016"><span class='Ref_To_Local'>c</span></a> <span class='Operator'>= </span><a href="fe-exec.c.html#LN3015"><span class='Ref_To_Local'>p</span></a><span class='Delimiter'>; </span><span class='Operator'>*</span><a href="fe-exec.c.html#LN3016"><span class='Ref_To_Local'>c</span></a><span class='Delimiter'>; </span><a href="fe-exec.c.html#LN3016"><span class='Ref_To_Local'>c</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span>isdigit<span class='Parentheses'>((</span><span class='Keyword'>unsigned char</span><span class='Parentheses'>) </span><span class='Operator'>*</span><a href="fe-exec.c.html#LN3016"><span class='Ref_To_Local'>c</span></a><span class='Parentheses'>))</span> 
            <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="fe-exec.c.html#LN3054"><span class='Ref_to_Label'>interpret_error</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN3016"><span class='Ref_To_Local'>c</span></a> <span class='Operator'>== </span><a href="fe-exec.c.html#LN3015"><span class='Ref_To_Local'>p</span></a><span class='Parentheses'>) 
</span>        <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="fe-exec.c.html#LN3054"><span class='Ref_to_Label'>interpret_error</span></a><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="fe-exec.c.html#LN3015"><span class='Ref_To_Local'>p</span></a><span class='Delimiter'>; 
</span> 
<a name="LN3054"></a><span class='Label'>interpret_error</span><span class='Operator'>: 
</span>    <a href="fe-exec.c.html#LN799"><span class='Ref_to_Func'>pqInternalNotice</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="fe-exec.c.html#LN3013"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN185"><span class='Ref_to_Member'>noticeHooks</span></a><span class='Delimiter'>, 
</span>                     <span class='String'>"could not interpret result from server: %s"</span><span class='Delimiter'>, 
</span>                     <a href="fe-exec.c.html#LN3013"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN177"><span class='Ref_to_Member'>cmdStatus</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <span class='String'>""</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end PQcmdTuples &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * PQgetvalue: 
 *  return the value of field 'field_num' of row 'tup_num' 
 */ 
</span><span class='Keyword'>char </span><span class='Operator'>* 
</span><a name="LN3066"></a><span class='Declare_Function'>PQgetvalue</span><span class='Parentheses'>(</span><span class='Keyword'>const </span><a href="libpq-fe.h.html#LN146"><span class='Ref_to_Typedef'>PGresult</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>res</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>tup_num</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>field_num</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="fe-exec.c.html#LN2715"><span class='Ref_to_Func'>check_tuple_field_number</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN3066"><span class='Ref_to_Parameter'>res</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN3066"><span class='Ref_to_Parameter'>tup_num</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN3066"><span class='Ref_to_Parameter'>field_num</span></a><span class='Parentheses'>))</span> 
        <span class='Control'>return</span> <span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <a href="fe-exec.c.html#LN3066"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN171"><span class='Ref_to_Member'>tuples</span></a><span class='Delimiter'>[</span><a href="fe-exec.c.html#LN3066"><span class='Ref_to_Parameter'>tup_num</span></a><span class='Delimiter'>][</span><a href="fe-exec.c.html#LN3066"><span class='Ref_to_Parameter'>field_num</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><span class='Keyword'>value</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* PQgetlength: 
 *  returns the actual length of a field value in bytes. 
 */ 
</span><span class='Keyword'>int 
</span><a name="LN3077"></a><span class='Declare_Function'>PQgetlength</span><span class='Parentheses'>(</span><span class='Keyword'>const </span><a href="libpq-fe.h.html#LN146"><span class='Ref_to_Typedef'>PGresult</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>res</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>tup_num</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>field_num</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="fe-exec.c.html#LN2715"><span class='Ref_to_Func'>check_tuple_field_number</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN3077"><span class='Ref_to_Parameter'>res</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN3077"><span class='Ref_to_Parameter'>tup_num</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN3077"><span class='Ref_to_Parameter'>field_num</span></a><span class='Parentheses'>))</span> 
        <span class='Control'>return</span> <span class='Number'>0</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN3077"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN171"><span class='Ref_to_Member'>tuples</span></a><span class='Delimiter'>[</span><a href="fe-exec.c.html#LN3077"><span class='Ref_to_Parameter'>tup_num</span></a><span class='Delimiter'>][</span><a href="fe-exec.c.html#LN3077"><span class='Ref_to_Parameter'>field_num</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="libpq-int.h.html#LN136"><span class='Ref_to_Member'>len</span></a> <span class='Operator'>!= </span><a href="libpq-int.h.html#LN132"><span class='Ref_to_Const'>NULL_LEN</span></a><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <a href="fe-exec.c.html#LN3077"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN171"><span class='Ref_to_Member'>tuples</span></a><span class='Delimiter'>[</span><a href="fe-exec.c.html#LN3077"><span class='Ref_to_Parameter'>tup_num</span></a><span class='Delimiter'>][</span><a href="fe-exec.c.html#LN3077"><span class='Ref_to_Parameter'>field_num</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="libpq-int.h.html#LN136"><span class='Ref_to_Member'>len</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
        <span class='Control'>return</span> <span class='Number'>0</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* PQgetisnull: 
 *  returns the null status of a field value. 
 */ 
</span><span class='Keyword'>int 
</span><a name="LN3091"></a><span class='Declare_Function'>PQgetisnull</span><span class='Parentheses'>(</span><span class='Keyword'>const </span><a href="libpq-fe.h.html#LN146"><span class='Ref_to_Typedef'>PGresult</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>res</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>tup_num</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>field_num</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="fe-exec.c.html#LN2715"><span class='Ref_to_Func'>check_tuple_field_number</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN3091"><span class='Ref_to_Parameter'>res</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN3091"><span class='Ref_to_Parameter'>tup_num</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN3091"><span class='Ref_to_Parameter'>field_num</span></a><span class='Parentheses'>))</span> 
        <span class='Control'>return</span> <span class='Number'>1</span><span class='Delimiter'>;</span>               <span class='Comment_Single_Line'>/* pretend it is null */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN3091"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN171"><span class='Ref_to_Member'>tuples</span></a><span class='Delimiter'>[</span><a href="fe-exec.c.html#LN3091"><span class='Ref_to_Parameter'>tup_num</span></a><span class='Delimiter'>][</span><a href="fe-exec.c.html#LN3091"><span class='Ref_to_Parameter'>field_num</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="libpq-int.h.html#LN136"><span class='Ref_to_Member'>len</span></a> <span class='Operator'>== </span><a href="libpq-int.h.html#LN132"><span class='Ref_to_Const'>NULL_LEN</span></a><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <span class='Number'>1</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
        <span class='Control'>return</span> <span class='Number'>0</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* PQnparams: 
 *  returns the number of input parameters of a prepared statement. 
 */ 
</span><span class='Keyword'>int 
</span><a name="LN3105"></a><span class='Declare_Function'>PQnparams</span><span class='Parentheses'>(</span><span class='Keyword'>const </span><a href="libpq-fe.h.html#LN146"><span class='Ref_to_Typedef'>PGresult</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>res</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="fe-exec.c.html#LN3105"><span class='Ref_to_Parameter'>res</span></a><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <span class='Number'>0</span><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <a href="fe-exec.c.html#LN3105"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN174"><span class='Ref_to_Member'>numParameters</span></a><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* PQparamtype: 
 *  returns type Oid of the specified statement parameter. 
 */ 
</span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> 
<a name="LN3116"></a><span class='Declare_Function'>PQparamtype</span><span class='Parentheses'>(</span><span class='Keyword'>const </span><a href="libpq-fe.h.html#LN146"><span class='Ref_to_Typedef'>PGresult</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>res</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>param_num</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="fe-exec.c.html#LN2738"><span class='Ref_to_Func'>check_param_number</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN3116"><span class='Ref_to_Parameter'>res</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN3116"><span class='Ref_to_Parameter'>param_num</span></a><span class='Parentheses'>))</span> 
        <span class='Control'>return</span> <a href="../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN3116"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN175"><span class='Ref_to_Member'>paramDescs</span></a><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <a href="fe-exec.c.html#LN3116"><span class='Ref_to_Parameter'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN175"><span class='Ref_to_Member'>paramDescs</span></a><span class='Delimiter'>[</span><a href="fe-exec.c.html#LN3116"><span class='Ref_to_Parameter'>param_num</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="libpq-int.h.html#LN111"><span class='Ref_to_Member'>typid</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
        <span class='Control'>return</span> <a href="../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Delimiter'>; 
} 
</span> 
 
<span class='Comment_Multi_Line'>/* PQsetnonblocking: 
 *  sets the PGconn's database connection non-blocking if the arg is TRUE 
 *  or makes it blocking if the arg is FALSE, this will not protect 
 *  you from PQexec(), you'll only be safe when using the non-blocking API. 
 *  Needs to be called only on a connected database connection. 
 */ 
</span><span class='Keyword'>int 
</span><a name="LN3134"></a><span class='Declare_Function'>PQsetnonblocking</span><span class='Parentheses'>(</span><a href="libpq-fe.h.html#LN139"><span class='Ref_to_Typedef'>PGconn</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>conn</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>arg</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN3136"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>barg</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="fe-exec.c.html#LN3134"><span class='Ref_to_Parameter'>conn</span></a> <span class='Operator'>|| </span><a href="fe-exec.c.html#LN3134"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN377"><span class='Ref_to_Member'>status</span></a> <span class='Operator'>== </span><a href="libpq-fe.h.html#LN49"><span class='Ref_to_EnumConst'>CONNECTION_BAD</span></a><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span> 
    <a href="fe-exec.c.html#LN3136"><span class='Ref_To_Local'>barg</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN3134"><span class='Ref_to_Parameter'>arg</span></a> <span class='Operator'>? </span><span class='Boolean'>TRUE </span><span class='Operator'>: </span><span class='Boolean'>FALSE</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* early out if the socket is already in the state requested */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN3136"><span class='Ref_To_Local'>barg</span></a> <span class='Operator'>== </span><a href="fe-exec.c.html#LN3134"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN384"><span class='Ref_to_Member'>nonblocking</span></a><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <span class='Number'>0</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * to guarantee constancy for flushing/query/result-polling behavior we 
     * need to flush the send queue at this point in order to guarantee proper 
     * behavior. this is ok because either they are making a transition _from_ 
     * or _to_ blocking mode, either way we can block them. 
     */ 
</span>    <span class='Comment_Multi_Line'>/* if we are going from blocking to non-blocking flush here */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="libpq-int.h.html#LN637"><span class='Ref_to_Proto'>pqFlush</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN3134"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>))</span> 
        <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span> 
    <a href="fe-exec.c.html#LN3134"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN384"><span class='Ref_to_Member'>nonblocking</span></a> <span class='Operator'>= </span><a href="fe-exec.c.html#LN3136"><span class='Ref_To_Local'>barg</span></a><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <span class='Number'>0</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end PQsetnonblocking &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * return the blocking status of the database connection 
 *      TRUE == nonblocking, FALSE == blocking 
 */ 
</span><span class='Keyword'>int 
</span><a name="LN3167"></a><span class='Declare_Function'>PQisnonblocking</span><span class='Parentheses'>(</span><span class='Keyword'>const </span><a href="libpq-fe.h.html#LN139"><span class='Ref_to_Typedef'>PGconn</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>conn</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>return</span> <a href="libpq-int.h.html#LN676"><span class='Ref_to_Macro'>pqIsnonblocking</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN3167"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* libpq is thread-safe? */ 
</span><span class='Keyword'>int 
</span><a name="LN3174"></a><span class='Declare_Function'>PQisthreadsafe</span><span class='Parentheses'>(</span><span class='Keyword'>void</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><span class='Directive'>#ifdef</span> ENABLE_THREAD_SAFETY 
    <span class='Control'>return</span> <span class='Boolean'>true</span><span class='Delimiter'>; 
</span><span class='Directive'>#else</span> 
    <span class='Control'>return</span> <span class='Boolean'>false</span><span class='Delimiter'>; 
</span><span class='Directive'>#endif</span> 
<span class='Delimiter'>} 
</span> 
 
<span class='Comment_Multi_Line'>/* try to force data out, really only useful for non-blocking users */ 
</span><span class='Keyword'>int 
</span><a name="LN3186"></a><span class='Declare_Function'>PQflush</span><span class='Parentheses'>(</span><a href="libpq-fe.h.html#LN139"><span class='Ref_to_Typedef'>PGconn</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>conn</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>return</span> <a href="libpq-int.h.html#LN637"><span class='Ref_to_Proto'>pqFlush</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN3186"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
 
<span class='Comment_Multi_Line'>/* 
 *      PQfreemem - safely frees memory allocated 
 * 
 * Needed mostly by Win32, unless multithreaded DLL (/MD in VC6) 
 * Used for freeing memory from PQescapeByte()a/PQunescapeBytea() 
 */ 
</span><span class='Keyword'>void 
</span><a name="LN3199"></a><span class='Declare_Function'>PQfreemem</span><span class='Parentheses'>(</span><span class='Keyword'>void </span><span class='Operator'>*</span><span class='Declare_Parameter'>ptr</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <a href="../../include/snowball/header.h.html#LN64"><span class='Ref_to_Macro'>free</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN3199"><span class='Ref_to_Parameter'>ptr</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * PQfreeNotify - free's the memory associated with a PGnotify 
 * 
 * This function is here only for binary backward compatibility. 
 * New code should use PQfreemem().  A macro will automatically map 
 * calls to PQfreemem.  It should be removed in the future.  bjm 2003-03-24 
 */ 
</span> 
<span class='Keyword'>#undef </span><a href="libpq-fe.h.html#LN507"><span class='Ref_to_Macro'>PQfreeNotify</span></a> 
<a name="LN3213"></a><span class='Keyword'>void</span>        <span class='Declare_Prototype'>PQfreeNotify</span><span class='Parentheses'>(</span><a href="libpq-fe.h.html#LN160"><span class='Ref_to_Typedef'>PGnotify</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>notify</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
<span class='Keyword'>void 
</span><a name="LN3216"></a><span class='Declare_Function'>PQfreeNotify</span><span class='Parentheses'>(</span><a href="libpq-fe.h.html#LN160"><span class='Ref_to_Typedef'>PGnotify</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>notify</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <a href="libpq-fe.h.html#LN504"><span class='Ref_to_Proto'>PQfreemem</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN3216"><span class='Ref_to_Parameter'>notify</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
 
<span class='Comment_Multi_Line'>/* 
 * Escaping arbitrary strings to get valid SQL literal strings. 
 * 
 * Replaces "'" with "''", and if not std_strings, replaces "\" with "\\". 
 * 
 * length is the length of the source string.  (Note: if a terminating NUL 
 * is encountered sooner, PQescapeString stops short of "length"; the behavior 
 * is thus rather like strncpy.) 
 * 
 * For safety the buffer at "to" must be at least 2*length + 1 bytes long. 
 * A terminating NUL character is added to the output string, whether the 
 * input is NUL-terminated or not. 
 * 
 * Returns the actual length of the output (not counting the terminating NUL). 
 */ 
</span><span class='Keyword'>static </span>size_t 
<a name="LN3238"></a><span class='Declare_Function'>PQescapeStringInternal</span><span class='Parentheses'>(</span><a href="libpq-fe.h.html#LN139"><span class='Ref_to_Typedef'>PGconn</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>conn</span><span class='Delimiter'>, 
</span><a name="LN3239"></a>                       <span class='Keyword'>char </span><span class='Operator'>*</span><span class='Declare_Parameter'>to</span><span class='Delimiter'>, </span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>from</span><span class='Delimiter'>, </span>size_t <span class='Declare_Parameter'>length</span><span class='Delimiter'>, 
</span><a name="LN3240"></a>                       <span class='Keyword'>int </span><span class='Operator'>*</span><span class='Declare_Parameter'>error</span><span class='Delimiter'>, 
</span><a name="LN3241"></a>                       <span class='Keyword'>int </span><span class='Declare_Parameter'>encoding</span><span class='Delimiter'>, </span><span class='Keyword'>bool </span><span class='Declare_Parameter'>std_strings</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN3243"></a>    <span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Local'>source</span> <span class='Operator'>= </span><a href="fe-exec.c.html#LN3239"><span class='Ref_to_Parameter'>from</span></a><span class='Delimiter'>; 
</span><a name="LN3244"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>target</span> <span class='Operator'>= </span><a href="fe-exec.c.html#LN3239"><span class='Ref_to_Parameter'>to</span></a><span class='Delimiter'>; 
</span><a name="LN3245"></a>    size_t      <span class='Declare_Local'>remaining</span> <span class='Operator'>= </span><a href="fe-exec.c.html#LN3239"><span class='Ref_to_Parameter'>length</span></a><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN3240"><span class='Ref_to_Parameter'>error</span></a><span class='Parentheses'>) 
</span>        <span class='Operator'>*</span><a href="fe-exec.c.html#LN3240"><span class='Ref_to_Parameter'>error</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>while</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN3245"><span class='Ref_To_Local'>remaining</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span> <span class='Operator'>&& *</span><a href="fe-exec.c.html#LN3243"><span class='Ref_To_Local'>source</span></a> <span class='Operator'>!= </span><span class='String'>'\0'</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN3252"></a>        <span class='Keyword'>char</span>        <span class='Declare_Local'>c</span> <span class='Operator'>= *</span><a href="fe-exec.c.html#LN3243"><span class='Ref_To_Local'>source</span></a><span class='Delimiter'>; 
</span><a name="LN3253"></a>        <span class='Keyword'>int</span>         <span class='Declare_Local'>len</span><span class='Delimiter'>; 
</span><a name="LN3254"></a>        <span class='Keyword'>int</span>         <span class='Declare_Local'>i</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* Fast path for plain ASCII */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/c.h.html#LN972"><span class='Ref_to_Macro'>IS_HIGHBIT_SET</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN3252"><span class='Ref_To_Local'>c</span></a><span class='Parentheses'>))</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* Apply quoting if needed */ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/c.h.html#LN506"><span class='Ref_to_Macro'>SQL_STR_DOUBLE</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN3252"><span class='Ref_To_Local'>c</span></a><span class='Delimiter'>, </span><span class='Operator'>!</span><a href="fe-exec.c.html#LN3241"><span class='Ref_to_Parameter'>std_strings</span></a><span class='Parentheses'>))</span> 
                <span class='Operator'>*</span><a href="fe-exec.c.html#LN3244"><span class='Ref_To_Local'>target</span></a><span class='Operator'>++ = </span><a href="fe-exec.c.html#LN3252"><span class='Ref_To_Local'>c</span></a><span class='Delimiter'>; 
</span>            <span class='Comment_Multi_Line'>/* Copy the character */ 
</span>            <span class='Operator'>*</span><a href="fe-exec.c.html#LN3244"><span class='Ref_To_Local'>target</span></a><span class='Operator'>++ = </span><a href="fe-exec.c.html#LN3252"><span class='Ref_To_Local'>c</span></a><span class='Delimiter'>; 
</span>            <a href="fe-exec.c.html#LN3243"><span class='Ref_To_Local'>source</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>            <a href="fe-exec.c.html#LN3245"><span class='Ref_To_Local'>remaining</span></a><span class='Operator'>--</span><span class='Delimiter'>; 
</span>            <span class='Control'>continue</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span> 
        <span class='Comment_Multi_Line'>/* Slow path for possible multibyte characters */ 
</span>        <a href="fe-exec.c.html#LN3253"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>= </span><a href="../../include/mb/pg_wchar.h.html#LN523"><span class='Ref_to_Proto'>pg_encoding_mblen</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN3241"><span class='Ref_to_Parameter'>encoding</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN3243"><span class='Ref_To_Local'>source</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* Copy the character */ 
</span>        <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN3254"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="fe-exec.c.html#LN3254"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="fe-exec.c.html#LN3253"><span class='Ref_To_Local'>len</span></a><span class='Delimiter'>; </span><a href="fe-exec.c.html#LN3254"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN3245"><span class='Ref_To_Local'>remaining</span></a> <span class='Operator'>== </span><span class='Number'>0</span> <span class='Operator'>|| *</span><a href="fe-exec.c.html#LN3243"><span class='Ref_To_Local'>source</span></a> <span class='Operator'>== </span><span class='String'>'\0'</span><span class='Parentheses'>) 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span>            <span class='Operator'>*</span><a href="fe-exec.c.html#LN3244"><span class='Ref_To_Local'>target</span></a><span class='Operator'>++ = *</span><a href="fe-exec.c.html#LN3243"><span class='Ref_To_Local'>source</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>            <a href="fe-exec.c.html#LN3245"><span class='Ref_To_Local'>remaining</span></a><span class='Operator'>--</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * If we hit premature end of string (ie, incomplete multibyte 
         * character), try to pad out to the correct length with spaces. We 
         * may not be able to pad completely, but we will always be able to 
         * insert at least one pad space (since we'd not have quoted a 
         * multibyte character).  This should be enough to make a string that 
         * the server will error out on. 
         */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN3254"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="fe-exec.c.html#LN3253"><span class='Ref_To_Local'>len</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN3240"><span class='Ref_to_Parameter'>error</span></a><span class='Parentheses'>) 
</span>                <span class='Operator'>*</span><a href="fe-exec.c.html#LN3240"><span class='Ref_to_Parameter'>error</span></a> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN3238"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>) 
</span>                <a href="pqexpbuffer.c.html#LN232"><span class='Ref_to_Func'>printfPQExpBuffer</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="fe-exec.c.html#LN3238"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN491"><span class='Ref_to_Member'>errorMessage</span></a><span class='Delimiter'>, 
</span>                          <a href="win32.c.html#LN36"><span class='Ref_to_Func'>libpq_gettext</span></a><span class='Parentheses'>(</span><span class='String'>"incomplete multibyte character\n"</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>            <span class='Control'>for</span> <span class='Parentheses'>(</span><span class='Delimiter'>; </span><a href="fe-exec.c.html#LN3254"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="fe-exec.c.html#LN3253"><span class='Ref_To_Local'>len</span></a><span class='Delimiter'>; </span><a href="fe-exec.c.html#LN3254"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(((</span>size_t<span class='Parentheses'>) (</span><a href="fe-exec.c.html#LN3244"><span class='Ref_To_Local'>target</span></a> <span class='Operator'>- </span><a href="fe-exec.c.html#LN3239"><span class='Ref_to_Parameter'>to</span></a><span class='Parentheses'>))</span> <span class='Operator'>/ </span><span class='Number'>2</span> <span class='Operator'>&GT;= </span><a href="fe-exec.c.html#LN3239"><span class='Ref_to_Parameter'>length</span></a><span class='Parentheses'>)</span> 
                    <span class='Control'>break</span><span class='Delimiter'>; 
</span>                <span class='Operator'>*</span><a href="fe-exec.c.html#LN3244"><span class='Ref_To_Local'>target</span></a><span class='Operator'>++ = </span><span class='String'>' '</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end while remaining&GT;0&&*source!... &raquo; </span> 
 
    <span class='Comment_Multi_Line'>/* Write the terminating NUL character. */ 
</span>    <span class='Operator'>*</span><a href="fe-exec.c.html#LN3244"><span class='Ref_To_Local'>target</span></a> <span class='Operator'>= </span><span class='String'>'\0'</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="fe-exec.c.html#LN3244"><span class='Ref_To_Local'>target</span></a> <span class='Operator'>- </span><a href="fe-exec.c.html#LN3239"><span class='Ref_to_Parameter'>to</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end PQescapeStringInternal &raquo; </span> 
 
size_t 
<a name="LN3313"></a><span class='Declare_Function'>PQescapeStringConn</span><span class='Parentheses'>(</span><a href="libpq-fe.h.html#LN139"><span class='Ref_to_Typedef'>PGconn</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>conn</span><span class='Delimiter'>, 
</span><a name="LN3314"></a>                   <span class='Keyword'>char </span><span class='Operator'>*</span><span class='Declare_Parameter'>to</span><span class='Delimiter'>, </span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>from</span><span class='Delimiter'>, </span>size_t <span class='Declare_Parameter'>length</span><span class='Delimiter'>, 
</span><a name="LN3315"></a>                   <span class='Keyword'>int </span><span class='Operator'>*</span><span class='Declare_Parameter'>error</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="fe-exec.c.html#LN3313"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* force empty-string result */ 
</span>        <span class='Operator'>*</span><a href="fe-exec.c.html#LN3314"><span class='Ref_to_Parameter'>to</span></a> <span class='Operator'>= </span><span class='String'>'\0'</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN3315"><span class='Ref_to_Parameter'>error</span></a><span class='Parentheses'>) 
</span>            <span class='Operator'>*</span><a href="fe-exec.c.html#LN3315"><span class='Ref_to_Parameter'>error</span></a> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <span class='Number'>0</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>return</span> <a href="fe-exec.c.html#LN3237"><span class='Ref_to_Func'>PQescapeStringInternal</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN3313"><span class='Ref_to_Parameter'>conn</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN3314"><span class='Ref_to_Parameter'>to</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN3314"><span class='Ref_to_Parameter'>from</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN3314"><span class='Ref_to_Parameter'>length</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN3315"><span class='Ref_to_Parameter'>error</span></a><span class='Delimiter'>, 
</span>                                  <a href="fe-exec.c.html#LN3313"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN422"><span class='Ref_to_Member'>client_encoding</span></a><span class='Delimiter'>, 
</span>                                  <a href="fe-exec.c.html#LN3313"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN423"><span class='Ref_to_Member'>std_strings</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
size_t 
<a name="LN3331"></a><span class='Declare_Function'>PQescapeString</span><span class='Parentheses'>(</span><span class='Keyword'>char </span><span class='Operator'>*</span><span class='Declare_Parameter'>to</span><span class='Delimiter'>, </span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>from</span><span class='Delimiter'>, </span>size_t <span class='Declare_Parameter'>length</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>return</span> <a href="fe-exec.c.html#LN3237"><span class='Ref_to_Func'>PQescapeStringInternal</span></a><span class='Parentheses'>(</span><span class='Null_Value'>NULL</span><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN3331"><span class='Ref_to_Parameter'>to</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN3331"><span class='Ref_to_Parameter'>from</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN3331"><span class='Ref_to_Parameter'>length</span></a><span class='Delimiter'>, </span><span class='Null_Value'>NULL</span><span class='Delimiter'>, 
</span>                                  <a href="fe-exec.c.html#LN48"><span class='Ref_to_Global_Var'>static_client_encoding</span></a><span class='Delimiter'>, 
</span>                                  <a href="fe-exec.c.html#LN49"><span class='Ref_to_Global_Var'>static_std_strings</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
 
<span class='Comment_Multi_Line'>/* 
 * Escape arbitrary strings.  If as_ident is true, we escape the result 
 * as an identifier; if false, as a literal.  The result is returned in 
 * a newly allocated buffer.  If we fail due to an encoding violation or out 
 * of memory condition, we return NULL, storing an error message into conn. 
 */ 
</span><span class='Keyword'>static char </span><span class='Operator'>* 
</span><a name="LN3346"></a><span class='Declare_Function'>PQescapeInternal</span><span class='Parentheses'>(</span><a href="libpq-fe.h.html#LN139"><span class='Ref_to_Typedef'>PGconn</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>conn</span><span class='Delimiter'>, </span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>str</span><span class='Delimiter'>, </span>size_t <span class='Declare_Parameter'>len</span><span class='Delimiter'>, </span><span class='Keyword'>bool </span><span class='Declare_Parameter'>as_ident</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN3348"></a>    <span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Local'>s</span><span class='Delimiter'>; 
</span><a name="LN3349"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span><a name="LN3350"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>rp</span><span class='Delimiter'>; 
</span><a name="LN3351"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>num_quotes</span> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><span class='Comment_Single_Line'>/* single or double, depending on as_ident */ 
</span><a name="LN3352"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>num_backslashes</span> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span><a name="LN3353"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>input_len</span><span class='Delimiter'>; 
</span><a name="LN3354"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>result_size</span><span class='Delimiter'>; 
</span><a name="LN3355"></a>    <span class='Keyword'>char</span>        <span class='Declare_Local'>quote_char</span> <span class='Operator'>= </span><a href="fe-exec.c.html#LN3346"><span class='Ref_to_Parameter'>as_ident</span></a> <span class='Operator'>? </span><span class='String'>'"'</span> <span class='Operator'>: </span><span class='String'>'\''</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* We must have a connection, else fail immediately. */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="fe-exec.c.html#LN3346"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Scan the string for characters that must be escaped. */ 
</span>    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN3348"><span class='Ref_To_Local'>s</span></a> <span class='Operator'>= </span><a href="fe-exec.c.html#LN3346"><span class='Ref_to_Parameter'>str</span></a><span class='Delimiter'>; </span><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN3348"><span class='Ref_To_Local'>s</span></a> <span class='Operator'>- </span><a href="fe-exec.c.html#LN3346"><span class='Ref_to_Parameter'>str</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT; </span><a href="fe-exec.c.html#LN3346"><span class='Ref_to_Parameter'>len</span></a> <span class='Operator'>&& *</span><a href="fe-exec.c.html#LN3348"><span class='Ref_To_Local'>s</span></a> <span class='Operator'>!= </span><span class='String'>'\0'</span><span class='Delimiter'>; </span><span class='Operator'>++</span><a href="fe-exec.c.html#LN3348"><span class='Ref_To_Local'>s</span></a><span class='Parentheses'>)</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="fe-exec.c.html#LN3348"><span class='Ref_To_Local'>s</span></a> <span class='Operator'>== </span><a href="fe-exec.c.html#LN3355"><span class='Ref_To_Local'>quote_char</span></a><span class='Parentheses'>) 
</span>            <span class='Operator'>++</span><a href="fe-exec.c.html#LN3351"><span class='Ref_To_Local'>num_quotes</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="fe-exec.c.html#LN3348"><span class='Ref_To_Local'>s</span></a> <span class='Operator'>== </span><span class='String'>'\\'</span><span class='Parentheses'>) 
</span>            <span class='Operator'>++</span><a href="fe-exec.c.html#LN3352"><span class='Ref_To_Local'>num_backslashes</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../../include/c.h.html#LN972"><span class='Ref_to_Macro'>IS_HIGHBIT_SET</span></a><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="fe-exec.c.html#LN3348"><span class='Ref_To_Local'>s</span></a><span class='Parentheses'>))</span> 
        <span class='Delimiter'>{ 
</span><a name="LN3370"></a>            <span class='Keyword'>int</span>         <span class='Declare_Local'>charlen</span><span class='Delimiter'>; 
</span> 
            <span class='Comment_Multi_Line'>/* Slow path for possible multibyte characters */ 
</span>            <a href="fe-exec.c.html#LN3370"><span class='Ref_To_Local'>charlen</span></a> <span class='Operator'>= </span><a href="../../include/mb/pg_wchar.h.html#LN523"><span class='Ref_to_Proto'>pg_encoding_mblen</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN3346"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN422"><span class='Ref_to_Member'>client_encoding</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN3348"><span class='Ref_To_Local'>s</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <span class='Comment_Multi_Line'>/* Multibyte character overruns allowable length. */ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="fe-exec.c.html#LN3348"><span class='Ref_To_Local'>s</span></a> <span class='Operator'>- </span><a href="fe-exec.c.html#LN3346"><span class='Ref_to_Parameter'>str</span></a><span class='Parentheses'>) </span><span class='Operator'>+ </span><a href="fe-exec.c.html#LN3370"><span class='Ref_To_Local'>charlen</span></a> <span class='Operator'>&GT; </span><a href="fe-exec.c.html#LN3346"><span class='Ref_to_Parameter'>len</span></a> <span class='Operator'>|| </span>memchr<span class='Parentheses'>(</span><a href="fe-exec.c.html#LN3348"><span class='Ref_To_Local'>s</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN3370"><span class='Ref_To_Local'>charlen</span></a><span class='Parentheses'>) </span><span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span> 
            <span class='Delimiter'>{ 
</span>                <a href="pqexpbuffer.c.html#LN232"><span class='Ref_to_Func'>printfPQExpBuffer</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="fe-exec.c.html#LN3346"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN491"><span class='Ref_to_Member'>errorMessage</span></a><span class='Delimiter'>, 
</span>                          <a href="win32.c.html#LN36"><span class='Ref_to_Func'>libpq_gettext</span></a><span class='Parentheses'>(</span><span class='String'>"incomplete multibyte character\n"</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>                <span class='Control'>return</span> <span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span> 
            <span class='Comment_Multi_Line'>/* Adjust s, bearing in mind that for loop will increment it. */ 
</span>            <a href="fe-exec.c.html#LN3348"><span class='Ref_To_Local'>s</span></a> <span class='Operator'>+= </span><a href="fe-exec.c.html#LN3370"><span class='Ref_To_Local'>charlen</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end for s=str;(s-str)&LT;len&&*s... &raquo; </span> 
 
    <span class='Comment_Multi_Line'>/* Allocate output buffer. */ 
</span>    <a href="fe-exec.c.html#LN3353"><span class='Ref_To_Local'>input_len</span></a> <span class='Operator'>= </span><a href="fe-exec.c.html#LN3348"><span class='Ref_To_Local'>s</span></a> <span class='Operator'>- </span><a href="fe-exec.c.html#LN3346"><span class='Ref_to_Parameter'>str</span></a><span class='Delimiter'>; 
</span>    <a href="fe-exec.c.html#LN3354"><span class='Ref_To_Local'>result_size</span></a> <span class='Operator'>= </span><a href="fe-exec.c.html#LN3353"><span class='Ref_To_Local'>input_len</span></a> <span class='Operator'>+ </span><a href="fe-exec.c.html#LN3351"><span class='Ref_To_Local'>num_quotes</span></a> <span class='Operator'>+ </span><span class='Number'>3</span><span class='Delimiter'>;</span>   <span class='Comment_Single_Line'>/* two quotes, plus a NUL */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="fe-exec.c.html#LN3346"><span class='Ref_to_Parameter'>as_ident</span></a> <span class='Operator'>&& </span><a href="fe-exec.c.html#LN3352"><span class='Ref_To_Local'>num_backslashes</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>        <a href="fe-exec.c.html#LN3354"><span class='Ref_To_Local'>result_size</span></a> <span class='Operator'>+= </span><a href="fe-exec.c.html#LN3352"><span class='Ref_To_Local'>num_backslashes</span></a> <span class='Operator'>+ </span><span class='Number'>2</span><span class='Delimiter'>; 
</span>    <a href="fe-exec.c.html#LN3349"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="fe-exec.c.html#LN3350"><span class='Ref_To_Local'>rp</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Keyword'>char </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/snowball/header.h.html#LN49"><span class='Ref_to_Macro'>malloc</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN3354"><span class='Ref_To_Local'>result_size</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN3350"><span class='Ref_To_Local'>rp</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="pqexpbuffer.c.html#LN232"><span class='Ref_to_Func'>printfPQExpBuffer</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="fe-exec.c.html#LN3346"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN491"><span class='Ref_to_Member'>errorMessage</span></a><span class='Delimiter'>, 
</span>                          <a href="win32.c.html#LN36"><span class='Ref_to_Func'>libpq_gettext</span></a><span class='Parentheses'>(</span><span class='String'>"out of memory\n"</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * If we are escaping a literal that contains backslashes, we use the 
     * escape string syntax so that the result is correct under either value 
     * of standard_conforming_strings.  We also emit a leading space in this 
     * case, to guard against the possibility that the result might be 
     * interpolated immediately following an identifier. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="fe-exec.c.html#LN3346"><span class='Ref_to_Parameter'>as_ident</span></a> <span class='Operator'>&& </span><a href="fe-exec.c.html#LN3352"><span class='Ref_To_Local'>num_backslashes</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Operator'>*</span><a href="fe-exec.c.html#LN3350"><span class='Ref_To_Local'>rp</span></a><span class='Operator'>++ = </span><span class='String'>' '</span><span class='Delimiter'>; 
</span>        <span class='Operator'>*</span><a href="fe-exec.c.html#LN3350"><span class='Ref_To_Local'>rp</span></a><span class='Operator'>++ = </span><span class='String'>'E'</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* Opening quote. */ 
</span>    <span class='Operator'>*</span><a href="fe-exec.c.html#LN3350"><span class='Ref_To_Local'>rp</span></a><span class='Operator'>++ = </span><a href="fe-exec.c.html#LN3355"><span class='Ref_To_Local'>quote_char</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Use fast path if possible. 
     * 
     * We've already verified that the input string is well-formed in the 
     * current encoding.  If it contains no quotes and, in the case of 
     * literal-escaping, no backslashes, then we can just copy it directly to 
     * the output buffer, adding the necessary quotes. 
     * 
     * If not, we must rescan the input and process each character 
     * individually. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN3351"><span class='Ref_To_Local'>num_quotes</span></a> <span class='Operator'>== </span><span class='Number'>0</span> <span class='Operator'>&& </span><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN3352"><span class='Ref_To_Local'>num_backslashes</span></a> <span class='Operator'>== </span><span class='Number'>0</span> <span class='Operator'>|| </span><a href="fe-exec.c.html#LN3346"><span class='Ref_to_Parameter'>as_ident</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span>        memcpy<span class='Parentheses'>(</span><a href="fe-exec.c.html#LN3350"><span class='Ref_To_Local'>rp</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN3346"><span class='Ref_to_Parameter'>str</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN3353"><span class='Ref_To_Local'>input_len</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="fe-exec.c.html#LN3350"><span class='Ref_To_Local'>rp</span></a> <span class='Operator'>+= </span><a href="fe-exec.c.html#LN3353"><span class='Ref_To_Local'>input_len</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN3348"><span class='Ref_To_Local'>s</span></a> <span class='Operator'>= </span><a href="fe-exec.c.html#LN3346"><span class='Ref_to_Parameter'>str</span></a><span class='Delimiter'>; </span><a href="fe-exec.c.html#LN3348"><span class='Ref_To_Local'>s</span></a> <span class='Operator'>- </span><a href="fe-exec.c.html#LN3346"><span class='Ref_to_Parameter'>str</span></a> <span class='Operator'>&LT; </span><a href="fe-exec.c.html#LN3353"><span class='Ref_To_Local'>input_len</span></a><span class='Delimiter'>; </span><span class='Operator'>++</span><a href="fe-exec.c.html#LN3348"><span class='Ref_To_Local'>s</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="fe-exec.c.html#LN3348"><span class='Ref_To_Local'>s</span></a> <span class='Operator'>== </span><a href="fe-exec.c.html#LN3355"><span class='Ref_To_Local'>quote_char</span></a> <span class='Operator'>|| </span><span class='Parentheses'>(</span><span class='Operator'>!</span><a href="fe-exec.c.html#LN3346"><span class='Ref_to_Parameter'>as_ident</span></a> <span class='Operator'>&& *</span><a href="fe-exec.c.html#LN3348"><span class='Ref_To_Local'>s</span></a> <span class='Operator'>== </span><span class='String'>'\\'</span><span class='Parentheses'>))</span> 
            <span class='Delimiter'>{ 
</span>                <span class='Operator'>*</span><a href="fe-exec.c.html#LN3350"><span class='Ref_To_Local'>rp</span></a><span class='Operator'>++ = *</span><a href="fe-exec.c.html#LN3348"><span class='Ref_To_Local'>s</span></a><span class='Delimiter'>; 
</span>                <span class='Operator'>*</span><a href="fe-exec.c.html#LN3350"><span class='Ref_To_Local'>rp</span></a><span class='Operator'>++ = *</span><a href="fe-exec.c.html#LN3348"><span class='Ref_To_Local'>s</span></a><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>            <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../../include/c.h.html#LN972"><span class='Ref_to_Macro'>IS_HIGHBIT_SET</span></a><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="fe-exec.c.html#LN3348"><span class='Ref_To_Local'>s</span></a><span class='Parentheses'>))</span> 
                <span class='Operator'>*</span><a href="fe-exec.c.html#LN3350"><span class='Ref_To_Local'>rp</span></a><span class='Operator'>++ = *</span><a href="fe-exec.c.html#LN3348"><span class='Ref_To_Local'>s</span></a><span class='Delimiter'>; 
</span>            <span class='Control'>else</span> 
            <span class='Delimiter'>{ 
</span><a name="LN3446"></a>                <span class='Keyword'>int</span>         <span class='Declare_Local'>i</span> <span class='Operator'>= </span><a href="../../include/mb/pg_wchar.h.html#LN523"><span class='Ref_to_Proto'>pg_encoding_mblen</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN3346"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN422"><span class='Ref_to_Member'>client_encoding</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN3348"><span class='Ref_To_Local'>s</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
                <span class='Control'>while</span> <span class='Parentheses'>(</span><span class='Number'>1</span><span class='Parentheses'>) 
</span>                <span class='Delimiter'>{ 
</span>                    <span class='Operator'>*</span><a href="fe-exec.c.html#LN3350"><span class='Ref_To_Local'>rp</span></a><span class='Operator'>++ = *</span><a href="fe-exec.c.html#LN3348"><span class='Ref_To_Local'>s</span></a><span class='Delimiter'>; 
</span>                    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>--</span><a href="fe-exec.c.html#LN3446"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>                        <span class='Control'>break</span><span class='Delimiter'>; 
</span>                    <span class='Operator'>++</span><a href="fe-exec.c.html#LN3348"><span class='Ref_To_Local'>s</span></a><span class='Delimiter'>;</span>        <span class='Comment_Single_Line'>/* for loop will provide the final increment */ 
</span>                <span class='Delimiter'>} 
</span>            <span class='Delimiter'>} 
</span>        <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end for s=str;s-str&LT;input_len... &raquo; </span> 
    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end else &raquo; </span> 
 
    <span class='Comment_Multi_Line'>/* Closing quote and terminating NUL. */ 
</span>    <span class='Operator'>*</span><a href="fe-exec.c.html#LN3350"><span class='Ref_To_Local'>rp</span></a><span class='Operator'>++ = </span><a href="fe-exec.c.html#LN3355"><span class='Ref_To_Local'>quote_char</span></a><span class='Delimiter'>; 
</span>    <span class='Operator'>*</span><a href="fe-exec.c.html#LN3350"><span class='Ref_To_Local'>rp</span></a> <span class='Operator'>= </span><span class='String'>'\0'</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="fe-exec.c.html#LN3349"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end PQescapeInternal &raquo; </span> 
 
<span class='Keyword'>char </span><span class='Operator'>* 
</span><a name="LN3467"></a><span class='Declare_Function'>PQescapeLiteral</span><span class='Parentheses'>(</span><a href="libpq-fe.h.html#LN139"><span class='Ref_to_Typedef'>PGconn</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>conn</span><span class='Delimiter'>, </span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>str</span><span class='Delimiter'>, </span>size_t <span class='Declare_Parameter'>len</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>return</span> <a href="fe-exec.c.html#LN3345"><span class='Ref_to_Func'>PQescapeInternal</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN3467"><span class='Ref_to_Parameter'>conn</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN3467"><span class='Ref_to_Parameter'>str</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN3467"><span class='Ref_to_Parameter'>len</span></a><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Keyword'>char </span><span class='Operator'>* 
</span><a name="LN3473"></a><span class='Declare_Function'>PQescapeIdentifier</span><span class='Parentheses'>(</span><a href="libpq-fe.h.html#LN139"><span class='Ref_to_Typedef'>PGconn</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>conn</span><span class='Delimiter'>, </span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>str</span><span class='Delimiter'>, </span>size_t <span class='Declare_Parameter'>len</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>return</span> <a href="fe-exec.c.html#LN3345"><span class='Ref_to_Func'>PQescapeInternal</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN3473"><span class='Ref_to_Parameter'>conn</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN3473"><span class='Ref_to_Parameter'>str</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN3473"><span class='Ref_to_Parameter'>len</span></a><span class='Delimiter'>, </span><span class='Boolean'>true</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* HEX encoding support for bytea */ 
</span><a name="LN3479"></a><span class='Keyword'>static const char </span><span class='Declare_Var'>hextbl</span><span class='Delimiter'>[] </span><span class='Operator'>= </span><span class='String'>"0123456789abcdef"</span><span class='Delimiter'>; 
</span> 
<a name="LN3481"></a><span class='Keyword'>static const </span><a href="../../include/c.h.html#LN253"><span class='Ref_to_Typedef'>int8</span></a> <span class='Declare_Var'>hexlookup</span><span class='Delimiter'>[</span><span class='Number'>128</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Delimiter'>{ 
</span>    <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, 
</span>    <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, 
</span>    <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, 
</span>    <span class='Number'>0</span><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Number'>2</span><span class='Delimiter'>, </span><span class='Number'>3</span><span class='Delimiter'>, </span><span class='Number'>4</span><span class='Delimiter'>, </span><span class='Number'>5</span><span class='Delimiter'>, </span><span class='Number'>6</span><span class='Delimiter'>, </span><span class='Number'>7</span><span class='Delimiter'>, </span><span class='Number'>8</span><span class='Delimiter'>, </span><span class='Number'>9</span><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, 
</span>    <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Number'>10</span><span class='Delimiter'>, </span><span class='Number'>11</span><span class='Delimiter'>, </span><span class='Number'>12</span><span class='Delimiter'>, </span><span class='Number'>13</span><span class='Delimiter'>, </span><span class='Number'>14</span><span class='Delimiter'>, </span><span class='Number'>15</span><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, 
</span>    <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, 
</span>    <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Number'>10</span><span class='Delimiter'>, </span><span class='Number'>11</span><span class='Delimiter'>, </span><span class='Number'>12</span><span class='Delimiter'>, </span><span class='Number'>13</span><span class='Delimiter'>, </span><span class='Number'>14</span><span class='Delimiter'>, </span><span class='Number'>15</span><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, 
</span>    <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>, 
}; 
</span> 
<span class='Keyword'>static inline char 
</span><a name="LN3493"></a><span class='Declare_Function'>get_hex</span><span class='Parentheses'>(</span><span class='Keyword'>char </span><span class='Declare_Parameter'>c</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN3495"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>res</span> <span class='Operator'>= -</span><span class='Number'>1</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN3493"><span class='Ref_to_Parameter'>c</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span> <span class='Operator'>&& </span><a href="fe-exec.c.html#LN3493"><span class='Ref_to_Parameter'>c</span></a> <span class='Operator'>&LT; </span><span class='Number'>127</span><span class='Parentheses'>) 
</span>        <a href="fe-exec.c.html#LN3495"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="../../backend/utils/adt/mac8.c.html#LN39"><span class='Ref_to_Global_Var'>hexlookup</span></a><span class='Delimiter'>[</span><span class='Parentheses'>(</span><span class='Keyword'>unsigned char</span><span class='Parentheses'>) </span><a href="fe-exec.c.html#LN3493"><span class='Ref_to_Parameter'>c</span></a><span class='Delimiter'>]; 
</span> 
    <span class='Control'>return</span> <span class='Parentheses'>(</span><span class='Keyword'>char</span><span class='Parentheses'>) </span><a href="fe-exec.c.html#LN3495"><span class='Ref_To_Local'>res</span></a><span class='Delimiter'>; 
} 
</span> 
 
<span class='Comment_Multi_Line'>/* 
 *      PQescapeBytea   - converts from binary string to the 
 *      minimal encoding necessary to include the string in an SQL 
 *      INSERT statement with a bytea type column as the target. 
 * 
 *      We can use either hex or escape (traditional) encoding. 
 *      In escape mode, the following transformations are applied: 
 *      '\0' == ASCII  0 == \000 
 *      '\'' == ASCII 39 == '' 
 *      '\\' == ASCII 92 == \\ 
 *      anything &LT; 0x20, or &GT; 0x7e ---&GT; \ooo 
 *                                      (where ooo is an octal expression) 
 * 
 *      If not std_strings, all backslashes sent to the output are doubled. 
 */ 
</span><span class='Keyword'>static unsigned char </span><span class='Operator'>* 
</span><a name="LN3520"></a><span class='Declare_Function'>PQescapeByteaInternal</span><span class='Parentheses'>(</span><a href="libpq-fe.h.html#LN139"><span class='Ref_to_Typedef'>PGconn</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>conn</span><span class='Delimiter'>, 
</span><a name="LN3521"></a>                      <span class='Keyword'>const unsigned char </span><span class='Operator'>*</span><span class='Declare_Parameter'>from</span><span class='Delimiter'>, </span>size_t <span class='Declare_Parameter'>from_length</span><span class='Delimiter'>, 
</span><a name="LN3522"></a>                      size_t <span class='Operator'>*</span><span class='Declare_Parameter'>to_length</span><span class='Delimiter'>, </span><span class='Keyword'>bool </span><span class='Declare_Parameter'>std_strings</span><span class='Delimiter'>, </span><span class='Keyword'>bool </span><span class='Declare_Parameter'>use_hex</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN3524"></a>    <span class='Keyword'>const unsigned char </span><span class='Operator'>*</span><span class='Declare_Local'>vp</span><span class='Delimiter'>; 
</span><a name="LN3525"></a>    <span class='Keyword'>unsigned char </span><span class='Operator'>*</span><span class='Declare_Local'>rp</span><span class='Delimiter'>; 
</span><a name="LN3526"></a>    <span class='Keyword'>unsigned char </span><span class='Operator'>*</span><span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span><a name="LN3527"></a>    size_t      <span class='Declare_Local'>i</span><span class='Delimiter'>; 
</span><a name="LN3528"></a>    size_t      <span class='Declare_Local'>len</span><span class='Delimiter'>; 
</span><a name="LN3529"></a>    size_t      <span class='Declare_Local'>bslash_len</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN3522"><span class='Ref_to_Parameter'>std_strings</span></a> <span class='Operator'>? </span><span class='Number'>1</span> <span class='Operator'>: </span><span class='Number'>2</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * empty string has 1 char ('\0') 
     */ 
</span>    <a href="fe-exec.c.html#LN3528"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN3522"><span class='Ref_to_Parameter'>use_hex</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="fe-exec.c.html#LN3528"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>+= </span><a href="fe-exec.c.html#LN3529"><span class='Ref_To_Local'>bslash_len</span></a> <span class='Operator'>+ </span><span class='Number'>1</span> <span class='Operator'>+ </span><span class='Number'>2</span> <span class='Operator'>* </span><a href="fe-exec.c.html#LN3521"><span class='Ref_to_Parameter'>from_length</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <a href="fe-exec.c.html#LN3524"><span class='Ref_To_Local'>vp</span></a> <span class='Operator'>= </span><a href="fe-exec.c.html#LN3521"><span class='Ref_to_Parameter'>from</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN3527"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><a href="fe-exec.c.html#LN3521"><span class='Ref_to_Parameter'>from_length</span></a><span class='Delimiter'>; </span><a href="fe-exec.c.html#LN3527"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="fe-exec.c.html#LN3527"><span class='Ref_To_Local'>i</span></a><span class='Operator'>--</span><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN3524"><span class='Ref_To_Local'>vp</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="fe-exec.c.html#LN3524"><span class='Ref_To_Local'>vp</span></a> <span class='Operator'>&LT; </span><span class='Number'>0x20</span> <span class='Operator'>|| *</span><a href="fe-exec.c.html#LN3524"><span class='Ref_To_Local'>vp</span></a> <span class='Operator'>&GT; </span><span class='Number'>0x7e</span><span class='Parentheses'>) 
</span>                <a href="fe-exec.c.html#LN3528"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>+= </span><a href="fe-exec.c.html#LN3529"><span class='Ref_To_Local'>bslash_len</span></a> <span class='Operator'>+ </span><span class='Number'>3</span><span class='Delimiter'>; 
</span>            <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="fe-exec.c.html#LN3524"><span class='Ref_To_Local'>vp</span></a> <span class='Operator'>== </span><span class='String'>'\''</span><span class='Parentheses'>) 
</span>                <a href="fe-exec.c.html#LN3528"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>+= </span><span class='Number'>2</span><span class='Delimiter'>; 
</span>            <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="fe-exec.c.html#LN3524"><span class='Ref_To_Local'>vp</span></a> <span class='Operator'>== </span><span class='String'>'\\'</span><span class='Parentheses'>) 
</span>                <a href="fe-exec.c.html#LN3528"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>+= </span><a href="fe-exec.c.html#LN3529"><span class='Ref_To_Local'>bslash_len</span></a> <span class='Operator'>+ </span><a href="fe-exec.c.html#LN3529"><span class='Ref_To_Local'>bslash_len</span></a><span class='Delimiter'>; 
</span>            <span class='Control'>else</span> 
                <a href="fe-exec.c.html#LN3528"><span class='Ref_To_Local'>len</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Operator'>*</span><a href="fe-exec.c.html#LN3522"><span class='Ref_to_Parameter'>to_length</span></a> <span class='Operator'>= </span><a href="fe-exec.c.html#LN3528"><span class='Ref_To_Local'>len</span></a><span class='Delimiter'>; 
</span>    <a href="fe-exec.c.html#LN3525"><span class='Ref_To_Local'>rp</span></a> <span class='Operator'>= </span><a href="fe-exec.c.html#LN3526"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Keyword'>unsigned char </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/snowball/header.h.html#LN49"><span class='Ref_to_Macro'>malloc</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN3528"><span class='Ref_To_Local'>len</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN3525"><span class='Ref_To_Local'>rp</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN3520"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>) 
</span>            <a href="pqexpbuffer.c.html#LN232"><span class='Ref_to_Func'>printfPQExpBuffer</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="fe-exec.c.html#LN3520"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN491"><span class='Ref_to_Member'>errorMessage</span></a><span class='Delimiter'>, 
</span>                              <a href="win32.c.html#LN36"><span class='Ref_to_Func'>libpq_gettext</span></a><span class='Parentheses'>(</span><span class='String'>"out of memory\n"</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN3522"><span class='Ref_to_Parameter'>use_hex</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="fe-exec.c.html#LN3522"><span class='Ref_to_Parameter'>std_strings</span></a><span class='Parentheses'>) 
</span>            <span class='Operator'>*</span><a href="fe-exec.c.html#LN3525"><span class='Ref_To_Local'>rp</span></a><span class='Operator'>++ = </span><span class='String'>'\\'</span><span class='Delimiter'>; 
</span>        <span class='Operator'>*</span><a href="fe-exec.c.html#LN3525"><span class='Ref_To_Local'>rp</span></a><span class='Operator'>++ = </span><span class='String'>'\\'</span><span class='Delimiter'>; 
</span>        <span class='Operator'>*</span><a href="fe-exec.c.html#LN3525"><span class='Ref_To_Local'>rp</span></a><span class='Operator'>++ = </span><span class='String'>'x'</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="fe-exec.c.html#LN3524"><span class='Ref_To_Local'>vp</span></a> <span class='Operator'>= </span><a href="fe-exec.c.html#LN3521"><span class='Ref_to_Parameter'>from</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN3527"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><a href="fe-exec.c.html#LN3521"><span class='Ref_to_Parameter'>from_length</span></a><span class='Delimiter'>; </span><a href="fe-exec.c.html#LN3527"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="fe-exec.c.html#LN3527"><span class='Ref_To_Local'>i</span></a><span class='Operator'>--</span><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN3524"><span class='Ref_To_Local'>vp</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN3577"></a>        <span class='Keyword'>unsigned char </span><span class='Declare_Local'>c</span> <span class='Operator'>= *</span><a href="fe-exec.c.html#LN3524"><span class='Ref_To_Local'>vp</span></a><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN3522"><span class='Ref_to_Parameter'>use_hex</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Operator'>*</span><a href="fe-exec.c.html#LN3525"><span class='Ref_To_Local'>rp</span></a><span class='Operator'>++ = </span><a href="../../../contrib/pgcrypto/pgp-info.c.html#LN86"><span class='Ref_to_Global_Var'>hextbl</span></a><span class='Delimiter'>[</span><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN3577"><span class='Ref_To_Local'>c</span></a> <span class='Operator'>&GT;&GT; </span><span class='Number'>4</span><span class='Parentheses'>) </span><span class='Operator'>& </span><span class='Number'>0xF</span><span class='Delimiter'>]; 
</span>            <span class='Operator'>*</span><a href="fe-exec.c.html#LN3525"><span class='Ref_To_Local'>rp</span></a><span class='Operator'>++ = </span><a href="../../../contrib/pgcrypto/pgp-info.c.html#LN86"><span class='Ref_to_Global_Var'>hextbl</span></a><span class='Delimiter'>[</span><a href="fe-exec.c.html#LN3577"><span class='Ref_To_Local'>c</span></a> <span class='Operator'>& </span><span class='Number'>0xF</span><span class='Delimiter'>]; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN3577"><span class='Ref_To_Local'>c</span></a> <span class='Operator'>&LT; </span><span class='Number'>0x20</span> <span class='Operator'>|| </span><a href="fe-exec.c.html#LN3577"><span class='Ref_To_Local'>c</span></a> <span class='Operator'>&GT; </span><span class='Number'>0x7e</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="fe-exec.c.html#LN3522"><span class='Ref_to_Parameter'>std_strings</span></a><span class='Parentheses'>) 
</span>                <span class='Operator'>*</span><a href="fe-exec.c.html#LN3525"><span class='Ref_To_Local'>rp</span></a><span class='Operator'>++ = </span><span class='String'>'\\'</span><span class='Delimiter'>; 
</span>            <span class='Operator'>*</span><a href="fe-exec.c.html#LN3525"><span class='Ref_To_Local'>rp</span></a><span class='Operator'>++ = </span><span class='String'>'\\'</span><span class='Delimiter'>; 
</span>            <span class='Operator'>*</span><a href="fe-exec.c.html#LN3525"><span class='Ref_To_Local'>rp</span></a><span class='Operator'>++ = </span><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN3577"><span class='Ref_To_Local'>c</span></a> <span class='Operator'>&GT;&GT; </span><span class='Number'>6</span><span class='Parentheses'>) </span><span class='Operator'>+ </span><span class='String'>'0'</span><span class='Delimiter'>; 
</span>            <span class='Operator'>*</span><a href="fe-exec.c.html#LN3525"><span class='Ref_To_Local'>rp</span></a><span class='Operator'>++ = </span><span class='Parentheses'>((</span><a href="fe-exec.c.html#LN3577"><span class='Ref_To_Local'>c</span></a> <span class='Operator'>&GT;&GT; </span><span class='Number'>3</span><span class='Parentheses'>) </span><span class='Operator'>& </span><span class='Number'>07</span><span class='Parentheses'>)</span> <span class='Operator'>+ </span><span class='String'>'0'</span><span class='Delimiter'>; 
</span>            <span class='Operator'>*</span><a href="fe-exec.c.html#LN3525"><span class='Ref_To_Local'>rp</span></a><span class='Operator'>++ = </span><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN3577"><span class='Ref_To_Local'>c</span></a> <span class='Operator'>& </span><span class='Number'>07</span><span class='Parentheses'>) </span><span class='Operator'>+ </span><span class='String'>'0'</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN3577"><span class='Ref_To_Local'>c</span></a> <span class='Operator'>== </span><span class='String'>'\''</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Operator'>*</span><a href="fe-exec.c.html#LN3525"><span class='Ref_To_Local'>rp</span></a><span class='Operator'>++ = </span><span class='String'>'\''</span><span class='Delimiter'>; 
</span>            <span class='Operator'>*</span><a href="fe-exec.c.html#LN3525"><span class='Ref_To_Local'>rp</span></a><span class='Operator'>++ = </span><span class='String'>'\''</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN3577"><span class='Ref_To_Local'>c</span></a> <span class='Operator'>== </span><span class='String'>'\\'</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="fe-exec.c.html#LN3522"><span class='Ref_to_Parameter'>std_strings</span></a><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <span class='Operator'>*</span><a href="fe-exec.c.html#LN3525"><span class='Ref_To_Local'>rp</span></a><span class='Operator'>++ = </span><span class='String'>'\\'</span><span class='Delimiter'>; 
</span>                <span class='Operator'>*</span><a href="fe-exec.c.html#LN3525"><span class='Ref_To_Local'>rp</span></a><span class='Operator'>++ = </span><span class='String'>'\\'</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>            <span class='Operator'>*</span><a href="fe-exec.c.html#LN3525"><span class='Ref_To_Local'>rp</span></a><span class='Operator'>++ = </span><span class='String'>'\\'</span><span class='Delimiter'>; 
</span>            <span class='Operator'>*</span><a href="fe-exec.c.html#LN3525"><span class='Ref_To_Local'>rp</span></a><span class='Operator'>++ = </span><span class='String'>'\\'</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> 
            <span class='Operator'>*</span><a href="fe-exec.c.html#LN3525"><span class='Ref_To_Local'>rp</span></a><span class='Operator'>++ = </span><a href="fe-exec.c.html#LN3577"><span class='Ref_To_Local'>c</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end for i=from_length;i&GT;0;i--... &raquo; </span> 
    <span class='Operator'>*</span><a href="fe-exec.c.html#LN3525"><span class='Ref_To_Local'>rp</span></a> <span class='Operator'>= </span><span class='String'>'\0'</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="fe-exec.c.html#LN3526"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end PQescapeByteaInternal &raquo; </span> 
 
<span class='Keyword'>unsigned char </span><span class='Operator'>* 
</span><a name="LN3617"></a><span class='Declare_Function'>PQescapeByteaConn</span><span class='Parentheses'>(</span><a href="libpq-fe.h.html#LN139"><span class='Ref_to_Typedef'>PGconn</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>conn</span><span class='Delimiter'>, 
</span><a name="LN3618"></a>                  <span class='Keyword'>const unsigned char </span><span class='Operator'>*</span><span class='Declare_Parameter'>from</span><span class='Delimiter'>, </span>size_t <span class='Declare_Parameter'>from_length</span><span class='Delimiter'>, 
</span><a name="LN3619"></a>                  size_t <span class='Operator'>*</span><span class='Declare_Parameter'>to_length</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="fe-exec.c.html#LN3617"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <a href="fe-exec.c.html#LN3519"><span class='Ref_to_Func'>PQescapeByteaInternal</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN3617"><span class='Ref_to_Parameter'>conn</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN3618"><span class='Ref_to_Parameter'>from</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN3618"><span class='Ref_to_Parameter'>from_length</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN3619"><span class='Ref_to_Parameter'>to_length</span></a><span class='Delimiter'>, 
</span>                                 <a href="fe-exec.c.html#LN3617"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN423"><span class='Ref_to_Member'>std_strings</span></a><span class='Delimiter'>, 
</span>                                 <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN3617"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN404"><span class='Ref_to_Member'>sversion</span></a> <span class='Operator'>&GT;= </span><span class='Number'>90000</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
} 
</span> 
<span class='Keyword'>unsigned char </span><span class='Operator'>* 
</span><a name="LN3629"></a><span class='Declare_Function'>PQescapeBytea</span><span class='Parentheses'>(</span><span class='Keyword'>const unsigned char </span><span class='Operator'>*</span><span class='Declare_Parameter'>from</span><span class='Delimiter'>, </span>size_t <span class='Declare_Parameter'>from_length</span><span class='Delimiter'>, </span>size_t <span class='Operator'>*</span><span class='Declare_Parameter'>to_length</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>return</span> <a href="fe-exec.c.html#LN3519"><span class='Ref_to_Func'>PQescapeByteaInternal</span></a><span class='Parentheses'>(</span><span class='Null_Value'>NULL</span><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN3629"><span class='Ref_to_Parameter'>from</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN3629"><span class='Ref_to_Parameter'>from_length</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN3629"><span class='Ref_to_Parameter'>to_length</span></a><span class='Delimiter'>, 
</span>                                 <a href="fe-exec.c.html#LN49"><span class='Ref_to_Global_Var'>static_std_strings</span></a><span class='Delimiter'>, 
</span>                                 <span class='Boolean'>false </span><span class='Comment_Multi_Line'>/* can't use hex */ </span><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
 
<a name="LN3637"></a><span class='Keyword'>#define </span><span class='Declare_Macro'>ISFIRSTOCTDIGIT</span><span class='Parentheses'>(</span><span class='Declare_Parameter'>CH</span><span class='Parentheses'>) ((</span><a href="fe-exec.c.html#LN3637"><span class='Ref_to_Parameter'>CH</span></a><span class='Parentheses'>) </span><span class='Operator'>&GT;= </span><span class='String'>'0'</span> <span class='Operator'>&& </span><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN3637"><span class='Ref_to_Parameter'>CH</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT;= </span><span class='String'>'3'</span><span class='Parentheses'>)</span> 
<a name="LN3638"></a><span class='Keyword'>#define </span><span class='Declare_Macro'>ISOCTDIGIT</span><span class='Parentheses'>(</span><span class='Declare_Parameter'>CH</span><span class='Parentheses'>) ((</span><a href="fe-exec.c.html#LN3638"><span class='Ref_to_Parameter'>CH</span></a><span class='Parentheses'>) </span><span class='Operator'>&GT;= </span><span class='String'>'0'</span> <span class='Operator'>&& </span><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN3638"><span class='Ref_to_Parameter'>CH</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT;= </span><span class='String'>'7'</span><span class='Parentheses'>)</span> 
<a name="LN3639"></a><span class='Keyword'>#define </span><span class='Declare_Macro'>OCTVAL</span><span class='Parentheses'>(</span><span class='Declare_Parameter'>CH</span><span class='Parentheses'>) ((</span><a href="fe-exec.c.html#LN3639"><span class='Ref_to_Parameter'>CH</span></a><span class='Parentheses'>) </span><span class='Operator'>- </span><span class='String'>'0'</span><span class='Parentheses'>)</span> 
 
<span class='Comment_Multi_Line'>/* 
 *      PQunescapeBytea - converts the null terminated string representation 
 *      of a bytea, strtext, into binary, filling a buffer. It returns a 
 *      pointer to the buffer (or NULL on error), and the size of the 
 *      buffer in retbuflen. The pointer may subsequently be used as an 
 *      argument to the function PQfreemem. 
 * 
 *      The following transformations are made: 
 *      \\   == ASCII 92 == \ 
 *      \ooo == a byte whose value = ooo (ooo is an octal number) 
 *      \x   == x (x is any character not matched by the above transformations) 
 */ 
</span><span class='Keyword'>unsigned char </span><span class='Operator'>* 
</span><a name="LN3654"></a><span class='Declare_Function'>PQunescapeBytea</span><span class='Parentheses'>(</span><span class='Keyword'>const unsigned char </span><span class='Operator'>*</span><span class='Declare_Parameter'>strtext</span><span class='Delimiter'>, </span>size_t <span class='Operator'>*</span><span class='Declare_Parameter'>retbuflen</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN3656"></a>    size_t      <span class='Declare_Local'>strtextlen</span><span class='Delimiter'>, 
</span><a name="LN3657"></a>                <span class='Declare_Local'>buflen</span><span class='Delimiter'>; 
</span><a name="LN3658"></a>    <span class='Keyword'>unsigned char </span><span class='Operator'>*</span><span class='Declare_Local'>buffer</span><span class='Delimiter'>, 
</span><a name="LN3659"></a>               <span class='Operator'>*</span><span class='Declare_Local'>tmpbuf</span><span class='Delimiter'>; 
</span><a name="LN3660"></a>    size_t      <span class='Declare_Local'>i</span><span class='Delimiter'>, 
</span><a name="LN3661"></a>                <span class='Declare_Local'>j</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN3654"><span class='Ref_to_Parameter'>strtext</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span> 
    <a href="fe-exec.c.html#LN3656"><span class='Ref_To_Local'>strtextlen</span></a> <span class='Operator'>= </span>strlen<span class='Parentheses'>((</span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="fe-exec.c.html#LN3654"><span class='Ref_to_Parameter'>strtext</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN3654"><span class='Ref_to_Parameter'>strtext</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>] </span><span class='Operator'>== </span><span class='String'>'\\'</span> <span class='Operator'>&& </span><a href="fe-exec.c.html#LN3654"><span class='Ref_to_Parameter'>strtext</span></a><span class='Delimiter'>[</span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>== </span><span class='String'>'x'</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN3670"></a>        <span class='Keyword'>const unsigned char </span><span class='Operator'>*</span><span class='Declare_Local'>s</span><span class='Delimiter'>; 
</span><a name="LN3671"></a>        <span class='Keyword'>unsigned char </span><span class='Operator'>*</span><span class='Declare_Local'>p</span><span class='Delimiter'>; 
</span> 
        <a href="fe-exec.c.html#LN3657"><span class='Ref_To_Local'>buflen</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN3656"><span class='Ref_To_Local'>strtextlen</span></a> <span class='Operator'>- </span><span class='Number'>2</span><span class='Parentheses'>) </span><span class='Operator'>/ </span><span class='Number'>2</span><span class='Delimiter'>; 
</span>        <span class='Comment_Multi_Line'>/* Avoid unportable malloc(0) */ 
</span>        <a href="fe-exec.c.html#LN3658"><span class='Ref_To_Local'>buffer</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Keyword'>unsigned char </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/snowball/header.h.html#LN49"><span class='Ref_to_Macro'>malloc</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN3657"><span class='Ref_To_Local'>buflen</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span> <span class='Operator'>? </span><a href="fe-exec.c.html#LN3657"><span class='Ref_To_Local'>buflen</span></a> <span class='Operator'>: </span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN3658"><span class='Ref_To_Local'>buffer</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>            <span class='Control'>return</span> <span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span> 
        <a href="fe-exec.c.html#LN3670"><span class='Ref_To_Local'>s</span></a> <span class='Operator'>= </span><a href="fe-exec.c.html#LN3654"><span class='Ref_to_Parameter'>strtext</span></a> <span class='Operator'>+ </span><span class='Number'>2</span><span class='Delimiter'>; 
</span>        <a href="fe-exec.c.html#LN3671"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>= </span><a href="fe-exec.c.html#LN3658"><span class='Ref_To_Local'>buffer</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>while</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="fe-exec.c.html#LN3670"><span class='Ref_To_Local'>s</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span><a name="LN3683"></a>            <span class='Keyword'>char</span>        <span class='Declare_Local'>v1</span><span class='Delimiter'>, 
</span><a name="LN3684"></a>                        <span class='Declare_Local'>v2</span><span class='Delimiter'>; 
</span> 
            <span class='Comment_Multi_Line'>/* 
             * Bad input is silently ignored.  Note that this includes 
             * whitespace between hex pairs, which is allowed by byteain. 
             */ 
</span>            <a href="fe-exec.c.html#LN3683"><span class='Ref_To_Local'>v1</span></a> <span class='Operator'>= </span><a href="../../backend/utils/adt/encode.c.html#LN138"><span class='Ref_to_Func'>get_hex</span></a><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="fe-exec.c.html#LN3670"><span class='Ref_To_Local'>s</span></a><span class='Operator'>++</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!*</span><a href="fe-exec.c.html#LN3670"><span class='Ref_To_Local'>s</span></a> <span class='Operator'>|| </span><a href="fe-exec.c.html#LN3683"><span class='Ref_To_Local'>v1</span></a> <span class='Operator'>== </span><span class='Parentheses'>(</span><span class='Keyword'>char</span><span class='Parentheses'>) </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Parentheses'>)</span> 
                <span class='Control'>continue</span><span class='Delimiter'>; 
</span>            <a href="fe-exec.c.html#LN3684"><span class='Ref_To_Local'>v2</span></a> <span class='Operator'>= </span><a href="../../backend/utils/adt/encode.c.html#LN138"><span class='Ref_to_Func'>get_hex</span></a><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="fe-exec.c.html#LN3670"><span class='Ref_To_Local'>s</span></a><span class='Operator'>++</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN3684"><span class='Ref_To_Local'>v2</span></a> <span class='Operator'>!= </span><span class='Parentheses'>(</span><span class='Keyword'>char</span><span class='Parentheses'>) </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Parentheses'>)</span> 
                <span class='Operator'>*</span><a href="fe-exec.c.html#LN3671"><span class='Ref_To_Local'>p</span></a><span class='Operator'>++ = </span><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN3683"><span class='Ref_To_Local'>v1</span></a> <span class='Operator'>&LT;&LT; </span><span class='Number'>4</span><span class='Parentheses'>) </span><span class='Operator'>| </span><a href="fe-exec.c.html#LN3684"><span class='Ref_To_Local'>v2</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span> 
        <a href="fe-exec.c.html#LN3657"><span class='Ref_To_Local'>buflen</span></a> <span class='Operator'>= </span><a href="fe-exec.c.html#LN3671"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>- </span><a href="fe-exec.c.html#LN3658"><span class='Ref_To_Local'>buffer</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if strtext[0]=='\\'&&str... &raquo; </span> 
    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* 
         * Length of input is max length of output, but add one to avoid 
         * unportable malloc(0) if input is zero-length. 
         */ 
</span>        <a href="fe-exec.c.html#LN3658"><span class='Ref_To_Local'>buffer</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Keyword'>unsigned char </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/snowball/header.h.html#LN49"><span class='Ref_to_Macro'>malloc</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN3656"><span class='Ref_To_Local'>strtextlen</span></a> <span class='Operator'>+ </span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN3658"><span class='Ref_To_Local'>buffer</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>            <span class='Control'>return</span> <span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN3660"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><a href="fe-exec.c.html#LN3661"><span class='Ref_To_Local'>j</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="fe-exec.c.html#LN3660"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="fe-exec.c.html#LN3656"><span class='Ref_To_Local'>strtextlen</span></a><span class='Delimiter'>;</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Control'>switch</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN3654"><span class='Ref_to_Parameter'>strtext</span></a><span class='Delimiter'>[</span><a href="fe-exec.c.html#LN3660"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <span class='Control'>case</span> <span class='String'>'\\'</span><span class='Operator'>: 
</span>                    <a href="fe-exec.c.html#LN3660"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>                    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN3654"><span class='Ref_to_Parameter'>strtext</span></a><span class='Delimiter'>[</span><a href="fe-exec.c.html#LN3660"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>] </span><span class='Operator'>== </span><span class='String'>'\\'</span><span class='Parentheses'>) 
</span>                        <a href="fe-exec.c.html#LN3658"><span class='Ref_To_Local'>buffer</span></a><span class='Delimiter'>[</span><a href="fe-exec.c.html#LN3661"><span class='Ref_To_Local'>j</span></a><span class='Operator'>++</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="fe-exec.c.html#LN3654"><span class='Ref_to_Parameter'>strtext</span></a><span class='Delimiter'>[</span><a href="fe-exec.c.html#LN3660"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Delimiter'>]; 
</span>                    <span class='Control'>else</span> 
                    <span class='Delimiter'>{ 
</span>                        <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="fe-exec.c.html#LN3637"><span class='Ref_to_Macro'>ISFIRSTOCTDIGIT</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN3654"><span class='Ref_to_Parameter'>strtext</span></a><span class='Delimiter'>[</span><a href="fe-exec.c.html#LN3660"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Parentheses'>))</span> <span class='Operator'>&& 
</span>                            <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN3638"><span class='Ref_to_Macro'>ISOCTDIGIT</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN3654"><span class='Ref_to_Parameter'>strtext</span></a><span class='Delimiter'>[</span><a href="fe-exec.c.html#LN3660"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>+ </span><span class='Number'>1</span><span class='Delimiter'>]</span><span class='Parentheses'>))</span> <span class='Operator'>&& 
</span>                            <span class='Parentheses'>(</span><a href="fe-exec.c.html#LN3638"><span class='Ref_to_Macro'>ISOCTDIGIT</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN3654"><span class='Ref_to_Parameter'>strtext</span></a><span class='Delimiter'>[</span><a href="fe-exec.c.html#LN3660"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>+ </span><span class='Number'>2</span><span class='Delimiter'>]</span><span class='Parentheses'>)))</span> 
                        <span class='Delimiter'>{ 
</span><a name="LN3724"></a>                            <span class='Keyword'>int</span>         <span class='Declare_Local'>byte</span><span class='Delimiter'>; 
</span> 
                            <a href="fe-exec.c.html#LN3724"><span class='Ref_To_Local'>byte</span></a> <span class='Operator'>= </span><a href="fe-exec.c.html#LN3639"><span class='Ref_to_Macro'>OCTVAL</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN3654"><span class='Ref_to_Parameter'>strtext</span></a><span class='Delimiter'>[</span><a href="fe-exec.c.html#LN3660"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Delimiter'>]</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                            <a href="fe-exec.c.html#LN3724"><span class='Ref_To_Local'>byte</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN3724"><span class='Ref_To_Local'>byte</span></a> <span class='Operator'>&LT;&LT; </span><span class='Number'>3</span><span class='Parentheses'>) </span><span class='Operator'>+ </span><a href="fe-exec.c.html#LN3639"><span class='Ref_to_Macro'>OCTVAL</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN3654"><span class='Ref_to_Parameter'>strtext</span></a><span class='Delimiter'>[</span><a href="fe-exec.c.html#LN3660"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Delimiter'>]</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                            <a href="fe-exec.c.html#LN3724"><span class='Ref_To_Local'>byte</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN3724"><span class='Ref_To_Local'>byte</span></a> <span class='Operator'>&LT;&LT; </span><span class='Number'>3</span><span class='Parentheses'>) </span><span class='Operator'>+ </span><a href="fe-exec.c.html#LN3639"><span class='Ref_to_Macro'>OCTVAL</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN3654"><span class='Ref_to_Parameter'>strtext</span></a><span class='Delimiter'>[</span><a href="fe-exec.c.html#LN3660"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Delimiter'>]</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                            <a href="fe-exec.c.html#LN3658"><span class='Ref_To_Local'>buffer</span></a><span class='Delimiter'>[</span><a href="fe-exec.c.html#LN3661"><span class='Ref_To_Local'>j</span></a><span class='Operator'>++</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="fe-exec.c.html#LN3724"><span class='Ref_To_Local'>byte</span></a><span class='Delimiter'>; 
</span>                        <span class='Delimiter'>} 
</span>                    <span class='Delimiter'>} 
</span> 
                    <span class='Comment_Multi_Line'>/* 
                     * Note: if we see '\' followed by something that isn't a 
                     * recognized escape sequence, we loop around having done 
                     * nothing except advance i.  Therefore the something will 
                     * be emitted as ordinary data on the next cycle. Corner 
                     * case: '\' at end of string will just be discarded. 
                     */ 
</span>                    <span class='Control'>break</span><span class='Delimiter'>; 
</span> 
                <span class='Control'>default</span><span class='Operator'>: 
</span>                    <a href="fe-exec.c.html#LN3658"><span class='Ref_To_Local'>buffer</span></a><span class='Delimiter'>[</span><a href="fe-exec.c.html#LN3661"><span class='Ref_To_Local'>j</span></a><span class='Operator'>++</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="fe-exec.c.html#LN3654"><span class='Ref_to_Parameter'>strtext</span></a><span class='Delimiter'>[</span><a href="fe-exec.c.html#LN3660"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Delimiter'>]; 
</span>                    <span class='Control'>break</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end switch strtext[i] &raquo; </span> 
        <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end for i=j=0;i&LT;strtextlen; &raquo; </span> 
        <a href="fe-exec.c.html#LN3657"><span class='Ref_To_Local'>buflen</span></a> <span class='Operator'>= </span><a href="fe-exec.c.html#LN3661"><span class='Ref_To_Local'>j</span></a><span class='Delimiter'>;</span>             <span class='Comment_Single_Line'>/* buflen is the length of the dequoted data */ 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end else &raquo; </span> 
 
    <span class='Comment_Multi_Line'>/* Shrink the buffer to be no larger than necessary */ 
</span>    <span class='Comment_Multi_Line'>/* +1 avoids unportable behavior when buflen==0 */ 
</span>    <a href="fe-exec.c.html#LN3659"><span class='Ref_To_Local'>tmpbuf</span></a> <span class='Operator'>= </span><a href="../../include/snowball/header.h.html#LN59"><span class='Ref_to_Macro'>realloc</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN3658"><span class='Ref_To_Local'>buffer</span></a><span class='Delimiter'>, </span><a href="fe-exec.c.html#LN3657"><span class='Ref_To_Local'>buflen</span></a> <span class='Operator'>+ </span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* It would only be a very brain-dead realloc that could fail, but... */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="fe-exec.c.html#LN3659"><span class='Ref_To_Local'>tmpbuf</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="../../include/snowball/header.h.html#LN64"><span class='Ref_to_Macro'>free</span></a><span class='Parentheses'>(</span><a href="fe-exec.c.html#LN3658"><span class='Ref_To_Local'>buffer</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Operator'>*</span><a href="fe-exec.c.html#LN3654"><span class='Ref_to_Parameter'>retbuflen</span></a> <span class='Operator'>= </span><a href="fe-exec.c.html#LN3657"><span class='Ref_To_Local'>buflen</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <a href="fe-exec.c.html#LN3659"><span class='Ref_To_Local'>tmpbuf</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end PQunescapeBytea &raquo; </span> 
</pre>
<table bgcolor='#c0c0c0' width='100%'><tr><td><a href='../../../Contents.html'>Contents</a></td></tr>
</table><hr><p class='blurb' align='center'><a href='http://www.sourceinsight.com'>HTML Created by Source Insight Version 4.00.0084 Built on 2017-02-26</a></p>
</body></html>