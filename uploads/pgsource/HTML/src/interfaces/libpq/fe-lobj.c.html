<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta name="generator" content="Source Insight Version 4.00.0084 Built on 2017-02-26">
<meta charset='UTF-8' />
<style type='text/css'><!--
TD {background-color: #C0C0C0; font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 70%; }
.blurb {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 70%; }
.filename {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 120%; font-weight: bold; }
.dirname {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 100%; font-weight: bold; margin-top: 2.5em;}
--></style>
<title>src\interfaces\libpq\fe-lobj.c</title>
<LINK REL=StyleSheet HREF="../../../C_Cpp_Source_File.css" TYPE='text/css' MEDIA=screen>
</head>
<body bgcolor=#ffffff>
<table bgcolor='#c0c0c0' width='100%'>
<tr><td><p class='filename'><b>src\interfaces\libpq\fe-lobj.c</b></p></td>
<td align='right'>
Wed Jun 14 08:26:11 2017
</td></tr>
<tr><td><a href='../../../Contents.html'>Contents</a></td></tr>
</table>
<pre>
<span class='Comment_Multi_Line'>/*------------------------------------------------------------------------- 
 * 
 * fe-lobj.c 
 *    Front-end large object interface 
 * 
 * Portions Copyright (c) 1996-2017, PostgreSQL Global Development Group 
 * Portions Copyright (c) 1994, Regents of the University of California 
 * 
 * 
 * IDENTIFICATION 
 *    src/interfaces/libpq/fe-lobj.c 
 * 
 *------------------------------------------------------------------------- 
 */ 
</span> 
<span class='Directive'>#ifdef</span> <a href="../../include/c.h.html#LN61"><span class='Ref_to_Const'>WIN32</span></a> 
<span class='Comment_Multi_Line'>/* 
 *  As unlink/rename are #define'd in port.h (via postgres_fe.h), io.h 
 *  must be included first on MS C.  Might as well do it for all WIN32's 
 *  here. 
 */ 
</span><span class='Keyword'>#include </span><span class='String'>&LT;io.h&GT;</span> 
<span class='Directive'>#endif</span> 
 
<span class='Keyword'>#include </span><span class='String'>"postgres_fe.h"</span> 
 
<span class='Directive'>#ifdef</span> <a href="../../include/c.h.html#LN61"><span class='Ref_to_Const'>WIN32</span></a> 
<span class='Keyword'>#include </span><span class='String'>"win32.h"</span> 
<span class='Directive'>#else</span> 
<span class='Keyword'>#include </span><span class='String'>&LT;unistd.h&GT;</span> 
<span class='Directive'>#endif</span> 
 
<span class='Keyword'>#include </span><span class='String'>&LT;fcntl.h&GT;</span> 
<span class='Keyword'>#include </span><span class='String'>&LT;limits.h&GT;</span> 
<span class='Keyword'>#include </span><span class='String'>&LT;sys/stat.h&GT;</span> 
<span class='Keyword'>#include </span><span class='String'>&LT;netinet/in.h&GT;</span>         <span class='Comment_Single_Line'>/* for ntohl/htonl */ 
</span><span class='Keyword'>#include </span><span class='String'>&LT;arpa/inet.h&GT;</span> 
 
<span class='Keyword'>#include </span><span class='String'>"libpq-fe.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"libpq-int.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"libpq/libpq-fs.h"</span>     <span class='Comment_Single_Line'>/* must come after sys/stat.h */ 
</span> 
<a name="LN42"></a><span class='Keyword'>#define </span><span class='Declare_Constant'>LO_BUFSIZE</span>        <span class='Number'>8192</span> 
 
<a name="LN44"></a><span class='Keyword'>static int</span>  <span class='Declare_Prototype'>lo_initialize</span><span class='Parentheses'>(</span><a href="libpq-fe.h.html#LN139"><span class='Ref_to_Typedef'>PGconn</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>conn</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN45"></a><span class='Keyword'>static </span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>  <span class='Declare_Prototype'>lo_import_internal</span><span class='Parentheses'>(</span><a href="libpq-fe.h.html#LN139"><span class='Ref_to_Typedef'>PGconn</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>conn</span><span class='Delimiter'>, </span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>filename</span><span class='Delimiter'>, </span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Declare_Parameter'>oid</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN46"></a><span class='Keyword'>static </span><a href="../../include/postgres_ext.h.html#LN46"><span class='Ref_to_Typedef'>pg_int64</span></a> <span class='Declare_Prototype'>lo_hton64</span><span class='Parentheses'>(</span><a href="../../include/postgres_ext.h.html#LN46"><span class='Ref_to_Typedef'>pg_int64</span></a> <span class='Declare_Parameter'>host64</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN47"></a><span class='Keyword'>static </span><a href="../../include/postgres_ext.h.html#LN46"><span class='Ref_to_Typedef'>pg_int64</span></a> <span class='Declare_Prototype'>lo_ntoh64</span><span class='Parentheses'>(</span><a href="../../include/postgres_ext.h.html#LN46"><span class='Ref_to_Typedef'>pg_int64</span></a> <span class='Declare_Parameter'>net64</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
<span class='Comment_Multi_Line'>/* 
 * lo_open 
 *    opens an existing large object 
 * 
 * returns the file descriptor for use in later lo_* calls 
 * return -1 upon failure. 
 */ 
</span><span class='Keyword'>int 
</span><a name="LN57"></a><span class='Declare_Function'>lo_open</span><span class='Parentheses'>(</span><a href="libpq-fe.h.html#LN139"><span class='Ref_to_Typedef'>PGconn</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>conn</span><span class='Delimiter'>, </span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Declare_Parameter'>lobjId</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>mode</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN59"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>fd</span><span class='Delimiter'>; 
</span><a name="LN60"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>result_len</span><span class='Delimiter'>; 
</span><a name="LN61"></a>    <a href="libpq-fe.h.html#LN219"><span class='Ref_to_Typedef'>PQArgBlock</span></a>  <span class='Declare_Local'>argv</span><span class='Delimiter'>[</span><span class='Number'>2</span><span class='Delimiter'>]; 
</span><a name="LN62"></a>    <a href="libpq-fe.h.html#LN146"><span class='Ref_to_Typedef'>PGresult</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>res</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN57"><span class='Ref_to_Parameter'>conn</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL </span><span class='Operator'>|| </span><a href="fe-lobj.c.html#LN57"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN426"><span class='Ref_to_Member'>lobjfuncs</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN44"><span class='Ref_to_Proto'>lo_initialize</span></a><span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN57"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
            <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="fe-lobj.c.html#LN61"><span class='Ref_To_Local'>argv</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="libpq-fe.h.html#LN222"><span class='Ref_to_Member'>isint</span></a> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <a href="fe-lobj.c.html#LN61"><span class='Ref_To_Local'>argv</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="libpq-fe.h.html#LN221"><span class='Ref_to_Member'>len</span></a> <span class='Operator'>= </span><span class='Number'>4</span><span class='Delimiter'>; 
</span>    <a href="fe-lobj.c.html#LN61"><span class='Ref_To_Local'>argv</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="libpq-fe.h.html#LN227"><span class='Ref_to_Member'>u</span></a><span class='Operator'>.</span>integer <span class='Operator'>= </span><a href="fe-lobj.c.html#LN57"><span class='Ref_to_Parameter'>lobjId</span></a><span class='Delimiter'>; 
</span> 
    <a href="fe-lobj.c.html#LN61"><span class='Ref_To_Local'>argv</span></a><span class='Delimiter'>[</span><span class='Number'>1</span><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="libpq-fe.h.html#LN222"><span class='Ref_to_Member'>isint</span></a> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <a href="fe-lobj.c.html#LN61"><span class='Ref_To_Local'>argv</span></a><span class='Delimiter'>[</span><span class='Number'>1</span><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="libpq-fe.h.html#LN221"><span class='Ref_to_Member'>len</span></a> <span class='Operator'>= </span><span class='Number'>4</span><span class='Delimiter'>; 
</span>    <a href="fe-lobj.c.html#LN61"><span class='Ref_To_Local'>argv</span></a><span class='Delimiter'>[</span><span class='Number'>1</span><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="libpq-fe.h.html#LN227"><span class='Ref_to_Member'>u</span></a><span class='Operator'>.</span>integer <span class='Operator'>= </span><a href="fe-lobj.c.html#LN57"><span class='Ref_to_Parameter'>mode</span></a><span class='Delimiter'>; 
</span> 
    <a href="fe-lobj.c.html#LN62"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="libpq-fe.h.html#LN457"><span class='Ref_to_Proto'>PQfn</span></a><span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN57"><span class='Ref_to_Parameter'>conn</span></a><span class='Delimiter'>, </span><a href="fe-lobj.c.html#LN57"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN426"><span class='Ref_to_Member'>lobjfuncs</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN266"><span class='Ref_to_Member'>fn_lo_open</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="fe-lobj.c.html#LN59"><span class='Ref_To_Local'>fd</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="fe-lobj.c.html#LN60"><span class='Ref_To_Local'>result_len</span></a><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Delimiter'>, </span><a href="fe-lobj.c.html#LN61"><span class='Ref_To_Local'>argv</span></a><span class='Delimiter'>, </span><span class='Number'>2</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="libpq-fe.h.html#LN466"><span class='Ref_to_Proto'>PQresultStatus</span></a><span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN62"><span class='Ref_To_Local'>res</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span><a href="libpq-fe.h.html#LN84"><span class='Ref_to_EnumConst'>PGRES_COMMAND_OK</span></a><span class='Parentheses'>)</span> 
    <span class='Delimiter'>{ 
</span>        <a href="libpq-fe.h.html#LN501"><span class='Ref_to_Proto'>PQclear</span></a><span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN62"><span class='Ref_To_Local'>res</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <a href="fe-lobj.c.html#LN59"><span class='Ref_To_Local'>fd</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <a href="libpq-fe.h.html#LN501"><span class='Ref_to_Proto'>PQclear</span></a><span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN62"><span class='Ref_To_Local'>res</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
}</span><span class='Auto_Annotations'> &laquo; end lo_open &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * lo_close 
 *    closes an existing large object 
 * 
 * returns 0 upon success 
 * returns -1 upon failure. 
 */ 
</span><span class='Keyword'>int 
</span><a name="LN99"></a><span class='Declare_Function'>lo_close</span><span class='Parentheses'>(</span><a href="libpq-fe.h.html#LN139"><span class='Ref_to_Typedef'>PGconn</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>conn</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>fd</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN101"></a>    <a href="libpq-fe.h.html#LN219"><span class='Ref_to_Typedef'>PQArgBlock</span></a>  <span class='Declare_Local'>argv</span><span class='Delimiter'>[</span><span class='Number'>1</span><span class='Delimiter'>]; 
</span><a name="LN102"></a>    <a href="libpq-fe.h.html#LN146"><span class='Ref_to_Typedef'>PGresult</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>res</span><span class='Delimiter'>; 
</span><a name="LN103"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>retval</span><span class='Delimiter'>; 
</span><a name="LN104"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>result_len</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN99"><span class='Ref_to_Parameter'>conn</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL </span><span class='Operator'>|| </span><a href="fe-lobj.c.html#LN99"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN426"><span class='Ref_to_Member'>lobjfuncs</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN44"><span class='Ref_to_Proto'>lo_initialize</span></a><span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN99"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
            <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="fe-lobj.c.html#LN101"><span class='Ref_To_Local'>argv</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="libpq-fe.h.html#LN222"><span class='Ref_to_Member'>isint</span></a> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <a href="fe-lobj.c.html#LN101"><span class='Ref_To_Local'>argv</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="libpq-fe.h.html#LN221"><span class='Ref_to_Member'>len</span></a> <span class='Operator'>= </span><span class='Number'>4</span><span class='Delimiter'>; 
</span>    <a href="fe-lobj.c.html#LN101"><span class='Ref_To_Local'>argv</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="libpq-fe.h.html#LN227"><span class='Ref_to_Member'>u</span></a><span class='Operator'>.</span>integer <span class='Operator'>= </span><a href="fe-lobj.c.html#LN99"><span class='Ref_to_Parameter'>fd</span></a><span class='Delimiter'>; 
</span>    <a href="fe-lobj.c.html#LN102"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="libpq-fe.h.html#LN457"><span class='Ref_to_Proto'>PQfn</span></a><span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN99"><span class='Ref_to_Parameter'>conn</span></a><span class='Delimiter'>, </span><a href="fe-lobj.c.html#LN99"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN426"><span class='Ref_to_Member'>lobjfuncs</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN267"><span class='Ref_to_Member'>fn_lo_close</span></a><span class='Delimiter'>, 
</span>               <span class='Operator'>&</span><a href="fe-lobj.c.html#LN103"><span class='Ref_To_Local'>retval</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="fe-lobj.c.html#LN104"><span class='Ref_To_Local'>result_len</span></a><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Delimiter'>, </span><a href="fe-lobj.c.html#LN101"><span class='Ref_To_Local'>argv</span></a><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="libpq-fe.h.html#LN466"><span class='Ref_to_Proto'>PQresultStatus</span></a><span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN102"><span class='Ref_To_Local'>res</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span><a href="libpq-fe.h.html#LN84"><span class='Ref_to_EnumConst'>PGRES_COMMAND_OK</span></a><span class='Parentheses'>)</span> 
    <span class='Delimiter'>{ 
</span>        <a href="libpq-fe.h.html#LN501"><span class='Ref_to_Proto'>PQclear</span></a><span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN102"><span class='Ref_To_Local'>res</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <a href="fe-lobj.c.html#LN103"><span class='Ref_To_Local'>retval</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <a href="libpq-fe.h.html#LN501"><span class='Ref_to_Proto'>PQclear</span></a><span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN102"><span class='Ref_To_Local'>res</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
}</span><span class='Auto_Annotations'> &laquo; end lo_close &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * lo_truncate 
 *    truncates an existing large object to the given size 
 * 
 * returns 0 upon success 
 * returns -1 upon failure 
 */ 
</span><span class='Keyword'>int 
</span><a name="LN137"></a><span class='Declare_Function'>lo_truncate</span><span class='Parentheses'>(</span><a href="libpq-fe.h.html#LN139"><span class='Ref_to_Typedef'>PGconn</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>conn</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>fd</span><span class='Delimiter'>, </span>size_t <span class='Declare_Parameter'>len</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN139"></a>    <a href="libpq-fe.h.html#LN219"><span class='Ref_to_Typedef'>PQArgBlock</span></a>  <span class='Declare_Local'>argv</span><span class='Delimiter'>[</span><span class='Number'>2</span><span class='Delimiter'>]; 
</span><a name="LN140"></a>    <a href="libpq-fe.h.html#LN146"><span class='Ref_to_Typedef'>PGresult</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>res</span><span class='Delimiter'>; 
</span><a name="LN141"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>retval</span><span class='Delimiter'>; 
</span><a name="LN142"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>result_len</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN137"><span class='Ref_to_Parameter'>conn</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL </span><span class='Operator'>|| </span><a href="fe-lobj.c.html#LN137"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN426"><span class='Ref_to_Member'>lobjfuncs</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN44"><span class='Ref_to_Proto'>lo_initialize</span></a><span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN137"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
            <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* Must check this on-the-fly because it's not there pre-8.3 */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN137"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN426"><span class='Ref_to_Member'>lobjfuncs</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN275"><span class='Ref_to_Member'>fn_lo_truncate</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="pqexpbuffer.c.html#LN232"><span class='Ref_to_Func'>printfPQExpBuffer</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="fe-lobj.c.html#LN137"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN491"><span class='Ref_to_Member'>errorMessage</span></a><span class='Delimiter'>, 
</span>            <a href="win32.c.html#LN36"><span class='Ref_to_Func'>libpq_gettext</span></a><span class='Parentheses'>(</span><span class='String'>"cannot determine OID of function lo_truncate\n"</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Long ago, somebody thought it'd be a good idea to declare this function 
     * as taking size_t ... but the underlying backend function only accepts a 
     * signed int32 length.  So throw error if the given value overflows 
     * int32.  (A possible alternative is to automatically redirect the call 
     * to lo_truncate64; but if the caller wanted to rely on that backend 
     * function being available, he could have called lo_truncate64 for 
     * himself.) 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN137"><span class='Ref_to_Parameter'>len</span></a> <span class='Operator'>&GT; </span><span class='Parentheses'>(</span>size_t<span class='Parentheses'>) </span>INT_MAX<span class='Parentheses'>)</span> 
    <span class='Delimiter'>{ 
</span>        <a href="pqexpbuffer.c.html#LN232"><span class='Ref_to_Func'>printfPQExpBuffer</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="fe-lobj.c.html#LN137"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN491"><span class='Ref_to_Member'>errorMessage</span></a><span class='Delimiter'>, 
</span>           <a href="win32.c.html#LN36"><span class='Ref_to_Func'>libpq_gettext</span></a><span class='Parentheses'>(</span><span class='String'>"argument of lo_truncate exceeds integer range\n"</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="fe-lobj.c.html#LN139"><span class='Ref_To_Local'>argv</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="libpq-fe.h.html#LN222"><span class='Ref_to_Member'>isint</span></a> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <a href="fe-lobj.c.html#LN139"><span class='Ref_To_Local'>argv</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="libpq-fe.h.html#LN221"><span class='Ref_to_Member'>len</span></a> <span class='Operator'>= </span><span class='Number'>4</span><span class='Delimiter'>; 
</span>    <a href="fe-lobj.c.html#LN139"><span class='Ref_To_Local'>argv</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="libpq-fe.h.html#LN227"><span class='Ref_to_Member'>u</span></a><span class='Operator'>.</span>integer <span class='Operator'>= </span><a href="fe-lobj.c.html#LN137"><span class='Ref_to_Parameter'>fd</span></a><span class='Delimiter'>; 
</span> 
    <a href="fe-lobj.c.html#LN139"><span class='Ref_To_Local'>argv</span></a><span class='Delimiter'>[</span><span class='Number'>1</span><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="libpq-fe.h.html#LN222"><span class='Ref_to_Member'>isint</span></a> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <a href="fe-lobj.c.html#LN139"><span class='Ref_To_Local'>argv</span></a><span class='Delimiter'>[</span><span class='Number'>1</span><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="libpq-fe.h.html#LN221"><span class='Ref_to_Member'>len</span></a> <span class='Operator'>= </span><span class='Number'>4</span><span class='Delimiter'>; 
</span>    <a href="fe-lobj.c.html#LN139"><span class='Ref_To_Local'>argv</span></a><span class='Delimiter'>[</span><span class='Number'>1</span><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="libpq-fe.h.html#LN227"><span class='Ref_to_Member'>u</span></a><span class='Operator'>.</span>integer <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Keyword'>int</span><span class='Parentheses'>) </span><a href="fe-lobj.c.html#LN137"><span class='Ref_to_Parameter'>len</span></a><span class='Delimiter'>; 
</span> 
    <a href="fe-lobj.c.html#LN140"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="libpq-fe.h.html#LN457"><span class='Ref_to_Proto'>PQfn</span></a><span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN137"><span class='Ref_to_Parameter'>conn</span></a><span class='Delimiter'>, </span><a href="fe-lobj.c.html#LN137"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN426"><span class='Ref_to_Member'>lobjfuncs</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN275"><span class='Ref_to_Member'>fn_lo_truncate</span></a><span class='Delimiter'>, 
</span>               <span class='Operator'>&</span><a href="fe-lobj.c.html#LN141"><span class='Ref_To_Local'>retval</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="fe-lobj.c.html#LN142"><span class='Ref_To_Local'>result_len</span></a><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Delimiter'>, </span><a href="fe-lobj.c.html#LN139"><span class='Ref_To_Local'>argv</span></a><span class='Delimiter'>, </span><span class='Number'>2</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="libpq-fe.h.html#LN466"><span class='Ref_to_Proto'>PQresultStatus</span></a><span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN140"><span class='Ref_To_Local'>res</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span><a href="libpq-fe.h.html#LN84"><span class='Ref_to_EnumConst'>PGRES_COMMAND_OK</span></a><span class='Parentheses'>)</span> 
    <span class='Delimiter'>{ 
</span>        <a href="libpq-fe.h.html#LN501"><span class='Ref_to_Proto'>PQclear</span></a><span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN140"><span class='Ref_To_Local'>res</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <a href="fe-lobj.c.html#LN141"><span class='Ref_To_Local'>retval</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <a href="libpq-fe.h.html#LN501"><span class='Ref_to_Proto'>PQclear</span></a><span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN140"><span class='Ref_To_Local'>res</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
}</span><span class='Auto_Annotations'> &laquo; end lo_truncate &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * lo_truncate64 
 *    truncates an existing large object to the given size 
 * 
 * returns 0 upon success 
 * returns -1 upon failure 
 */ 
</span><span class='Keyword'>int 
</span><a name="LN205"></a><span class='Declare_Function'>lo_truncate64</span><span class='Parentheses'>(</span><a href="libpq-fe.h.html#LN139"><span class='Ref_to_Typedef'>PGconn</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>conn</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>fd</span><span class='Delimiter'>, </span><a href="../../include/postgres_ext.h.html#LN46"><span class='Ref_to_Typedef'>pg_int64</span></a> <span class='Declare_Parameter'>len</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN207"></a>    <a href="libpq-fe.h.html#LN219"><span class='Ref_to_Typedef'>PQArgBlock</span></a>  <span class='Declare_Local'>argv</span><span class='Delimiter'>[</span><span class='Number'>2</span><span class='Delimiter'>]; 
</span><a name="LN208"></a>    <a href="libpq-fe.h.html#LN146"><span class='Ref_to_Typedef'>PGresult</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>res</span><span class='Delimiter'>; 
</span><a name="LN209"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>retval</span><span class='Delimiter'>; 
</span><a name="LN210"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>result_len</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN205"><span class='Ref_to_Parameter'>conn</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL </span><span class='Operator'>|| </span><a href="fe-lobj.c.html#LN205"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN426"><span class='Ref_to_Member'>lobjfuncs</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN44"><span class='Ref_to_Proto'>lo_initialize</span></a><span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN205"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
            <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN205"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN426"><span class='Ref_to_Member'>lobjfuncs</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN276"><span class='Ref_to_Member'>fn_lo_truncate64</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="pqexpbuffer.c.html#LN232"><span class='Ref_to_Func'>printfPQExpBuffer</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="fe-lobj.c.html#LN205"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN491"><span class='Ref_to_Member'>errorMessage</span></a><span class='Delimiter'>, 
</span>          <a href="win32.c.html#LN36"><span class='Ref_to_Func'>libpq_gettext</span></a><span class='Parentheses'>(</span><span class='String'>"cannot determine OID of function lo_truncate64\n"</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="fe-lobj.c.html#LN207"><span class='Ref_To_Local'>argv</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="libpq-fe.h.html#LN222"><span class='Ref_to_Member'>isint</span></a> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <a href="fe-lobj.c.html#LN207"><span class='Ref_To_Local'>argv</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="libpq-fe.h.html#LN221"><span class='Ref_to_Member'>len</span></a> <span class='Operator'>= </span><span class='Number'>4</span><span class='Delimiter'>; 
</span>    <a href="fe-lobj.c.html#LN207"><span class='Ref_To_Local'>argv</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="libpq-fe.h.html#LN227"><span class='Ref_to_Member'>u</span></a><span class='Operator'>.</span>integer <span class='Operator'>= </span><a href="fe-lobj.c.html#LN205"><span class='Ref_to_Parameter'>fd</span></a><span class='Delimiter'>; 
</span> 
    <a href="fe-lobj.c.html#LN205"><span class='Ref_to_Parameter'>len</span></a> <span class='Operator'>= </span><a href="fe-lobj.c.html#LN46"><span class='Ref_to_Proto'>lo_hton64</span></a><span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN205"><span class='Ref_to_Parameter'>len</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="fe-lobj.c.html#LN207"><span class='Ref_To_Local'>argv</span></a><span class='Delimiter'>[</span><span class='Number'>1</span><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="libpq-fe.h.html#LN222"><span class='Ref_to_Member'>isint</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <a href="fe-lobj.c.html#LN207"><span class='Ref_To_Local'>argv</span></a><span class='Delimiter'>[</span><span class='Number'>1</span><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="libpq-fe.h.html#LN221"><span class='Ref_to_Member'>len</span></a> <span class='Operator'>= </span><span class='Number'>8</span><span class='Delimiter'>; 
</span>    <a href="fe-lobj.c.html#LN207"><span class='Ref_To_Local'>argv</span></a><span class='Delimiter'>[</span><span class='Number'>1</span><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="libpq-fe.h.html#LN227"><span class='Ref_to_Member'>u</span></a><span class='Operator'>.</span>ptr <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Keyword'>int </span><span class='Operator'>*</span><span class='Parentheses'>) </span><span class='Operator'>&</span><a href="fe-lobj.c.html#LN205"><span class='Ref_to_Parameter'>len</span></a><span class='Delimiter'>; 
</span> 
    <a href="fe-lobj.c.html#LN208"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="libpq-fe.h.html#LN457"><span class='Ref_to_Proto'>PQfn</span></a><span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN205"><span class='Ref_to_Parameter'>conn</span></a><span class='Delimiter'>, </span><a href="fe-lobj.c.html#LN205"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN426"><span class='Ref_to_Member'>lobjfuncs</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN276"><span class='Ref_to_Member'>fn_lo_truncate64</span></a><span class='Delimiter'>, 
</span>               <span class='Operator'>&</span><a href="fe-lobj.c.html#LN209"><span class='Ref_To_Local'>retval</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="fe-lobj.c.html#LN210"><span class='Ref_To_Local'>result_len</span></a><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Delimiter'>, </span><a href="fe-lobj.c.html#LN207"><span class='Ref_To_Local'>argv</span></a><span class='Delimiter'>, </span><span class='Number'>2</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="libpq-fe.h.html#LN466"><span class='Ref_to_Proto'>PQresultStatus</span></a><span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN208"><span class='Ref_To_Local'>res</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span><a href="libpq-fe.h.html#LN84"><span class='Ref_to_EnumConst'>PGRES_COMMAND_OK</span></a><span class='Parentheses'>)</span> 
    <span class='Delimiter'>{ 
</span>        <a href="libpq-fe.h.html#LN501"><span class='Ref_to_Proto'>PQclear</span></a><span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN208"><span class='Ref_To_Local'>res</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <a href="fe-lobj.c.html#LN209"><span class='Ref_To_Local'>retval</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <a href="libpq-fe.h.html#LN501"><span class='Ref_to_Proto'>PQclear</span></a><span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN208"><span class='Ref_To_Local'>res</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
}</span><span class='Auto_Annotations'> &laquo; end lo_truncate64 &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * lo_read 
 *    read len bytes of the large object into buf 
 * 
 * returns the number of bytes read, or -1 on failure. 
 * the CALLER must have allocated enough space to hold the result returned 
 */ 
</span> 
<span class='Keyword'>int 
</span><a name="LN258"></a><span class='Declare_Function'>lo_read</span><span class='Parentheses'>(</span><a href="libpq-fe.h.html#LN139"><span class='Ref_to_Typedef'>PGconn</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>conn</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>fd</span><span class='Delimiter'>, </span><span class='Keyword'>char </span><span class='Operator'>*</span><span class='Declare_Parameter'>buf</span><span class='Delimiter'>, </span>size_t <span class='Declare_Parameter'>len</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN260"></a>    <a href="libpq-fe.h.html#LN219"><span class='Ref_to_Typedef'>PQArgBlock</span></a>  <span class='Declare_Local'>argv</span><span class='Delimiter'>[</span><span class='Number'>2</span><span class='Delimiter'>]; 
</span><a name="LN261"></a>    <a href="libpq-fe.h.html#LN146"><span class='Ref_to_Typedef'>PGresult</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>res</span><span class='Delimiter'>; 
</span><a name="LN262"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>result_len</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN258"><span class='Ref_to_Parameter'>conn</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL </span><span class='Operator'>|| </span><a href="fe-lobj.c.html#LN258"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN426"><span class='Ref_to_Member'>lobjfuncs</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN44"><span class='Ref_to_Proto'>lo_initialize</span></a><span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN258"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
            <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Long ago, somebody thought it'd be a good idea to declare this function 
     * as taking size_t ... but the underlying backend function only accepts a 
     * signed int32 length.  So throw error if the given value overflows 
     * int32. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN258"><span class='Ref_to_Parameter'>len</span></a> <span class='Operator'>&GT; </span><span class='Parentheses'>(</span>size_t<span class='Parentheses'>) </span>INT_MAX<span class='Parentheses'>)</span> 
    <span class='Delimiter'>{ 
</span>        <a href="pqexpbuffer.c.html#LN232"><span class='Ref_to_Func'>printfPQExpBuffer</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="fe-lobj.c.html#LN258"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN491"><span class='Ref_to_Member'>errorMessage</span></a><span class='Delimiter'>, 
</span>               <a href="win32.c.html#LN36"><span class='Ref_to_Func'>libpq_gettext</span></a><span class='Parentheses'>(</span><span class='String'>"argument of lo_read exceeds integer range\n"</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="fe-lobj.c.html#LN260"><span class='Ref_To_Local'>argv</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="libpq-fe.h.html#LN222"><span class='Ref_to_Member'>isint</span></a> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <a href="fe-lobj.c.html#LN260"><span class='Ref_To_Local'>argv</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="libpq-fe.h.html#LN221"><span class='Ref_to_Member'>len</span></a> <span class='Operator'>= </span><span class='Number'>4</span><span class='Delimiter'>; 
</span>    <a href="fe-lobj.c.html#LN260"><span class='Ref_To_Local'>argv</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="libpq-fe.h.html#LN227"><span class='Ref_to_Member'>u</span></a><span class='Operator'>.</span>integer <span class='Operator'>= </span><a href="fe-lobj.c.html#LN258"><span class='Ref_to_Parameter'>fd</span></a><span class='Delimiter'>; 
</span> 
    <a href="fe-lobj.c.html#LN260"><span class='Ref_To_Local'>argv</span></a><span class='Delimiter'>[</span><span class='Number'>1</span><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="libpq-fe.h.html#LN222"><span class='Ref_to_Member'>isint</span></a> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <a href="fe-lobj.c.html#LN260"><span class='Ref_To_Local'>argv</span></a><span class='Delimiter'>[</span><span class='Number'>1</span><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="libpq-fe.h.html#LN221"><span class='Ref_to_Member'>len</span></a> <span class='Operator'>= </span><span class='Number'>4</span><span class='Delimiter'>; 
</span>    <a href="fe-lobj.c.html#LN260"><span class='Ref_To_Local'>argv</span></a><span class='Delimiter'>[</span><span class='Number'>1</span><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="libpq-fe.h.html#LN227"><span class='Ref_to_Member'>u</span></a><span class='Operator'>.</span>integer <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Keyword'>int</span><span class='Parentheses'>) </span><a href="fe-lobj.c.html#LN258"><span class='Ref_to_Parameter'>len</span></a><span class='Delimiter'>; 
</span> 
    <a href="fe-lobj.c.html#LN261"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="libpq-fe.h.html#LN457"><span class='Ref_to_Proto'>PQfn</span></a><span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN258"><span class='Ref_to_Parameter'>conn</span></a><span class='Delimiter'>, </span><a href="fe-lobj.c.html#LN258"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN426"><span class='Ref_to_Member'>lobjfuncs</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN277"><span class='Ref_to_Member'>fn_lo_read</span></a><span class='Delimiter'>, 
</span>               <span class='Parentheses'>(</span><span class='Keyword'>void </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="fe-lobj.c.html#LN258"><span class='Ref_to_Parameter'>buf</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="fe-lobj.c.html#LN262"><span class='Ref_To_Local'>result_len</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Delimiter'>, </span><a href="fe-lobj.c.html#LN260"><span class='Ref_To_Local'>argv</span></a><span class='Delimiter'>, </span><span class='Number'>2</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="libpq-fe.h.html#LN466"><span class='Ref_to_Proto'>PQresultStatus</span></a><span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN261"><span class='Ref_To_Local'>res</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span><a href="libpq-fe.h.html#LN84"><span class='Ref_to_EnumConst'>PGRES_COMMAND_OK</span></a><span class='Parentheses'>)</span> 
    <span class='Delimiter'>{ 
</span>        <a href="libpq-fe.h.html#LN501"><span class='Ref_to_Proto'>PQclear</span></a><span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN261"><span class='Ref_To_Local'>res</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <a href="fe-lobj.c.html#LN262"><span class='Ref_To_Local'>result_len</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <a href="libpq-fe.h.html#LN501"><span class='Ref_to_Proto'>PQclear</span></a><span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN261"><span class='Ref_To_Local'>res</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
}</span><span class='Auto_Annotations'> &laquo; end lo_read &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * lo_write 
 *    write len bytes of buf into the large object fd 
 * 
 * returns the number of bytes written, or -1 on failure. 
 */ 
</span><span class='Keyword'>int 
</span><a name="LN312"></a><span class='Declare_Function'>lo_write</span><span class='Parentheses'>(</span><a href="libpq-fe.h.html#LN139"><span class='Ref_to_Typedef'>PGconn</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>conn</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>fd</span><span class='Delimiter'>, </span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>buf</span><span class='Delimiter'>, </span>size_t <span class='Declare_Parameter'>len</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN314"></a>    <a href="libpq-fe.h.html#LN219"><span class='Ref_to_Typedef'>PQArgBlock</span></a>  <span class='Declare_Local'>argv</span><span class='Delimiter'>[</span><span class='Number'>2</span><span class='Delimiter'>]; 
</span><a name="LN315"></a>    <a href="libpq-fe.h.html#LN146"><span class='Ref_to_Typedef'>PGresult</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>res</span><span class='Delimiter'>; 
</span><a name="LN316"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>result_len</span><span class='Delimiter'>; 
</span><a name="LN317"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>retval</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN312"><span class='Ref_to_Parameter'>conn</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL </span><span class='Operator'>|| </span><a href="fe-lobj.c.html#LN312"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN426"><span class='Ref_to_Member'>lobjfuncs</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN44"><span class='Ref_to_Proto'>lo_initialize</span></a><span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN312"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
            <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Long ago, somebody thought it'd be a good idea to declare this function 
     * as taking size_t ... but the underlying backend function only accepts a 
     * signed int32 length.  So throw error if the given value overflows 
     * int32. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN312"><span class='Ref_to_Parameter'>len</span></a> <span class='Operator'>&GT; </span><span class='Parentheses'>(</span>size_t<span class='Parentheses'>) </span>INT_MAX<span class='Parentheses'>)</span> 
    <span class='Delimiter'>{ 
</span>        <a href="pqexpbuffer.c.html#LN232"><span class='Ref_to_Func'>printfPQExpBuffer</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="fe-lobj.c.html#LN312"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN491"><span class='Ref_to_Member'>errorMessage</span></a><span class='Delimiter'>, 
</span>              <a href="win32.c.html#LN36"><span class='Ref_to_Func'>libpq_gettext</span></a><span class='Parentheses'>(</span><span class='String'>"argument of lo_write exceeds integer range\n"</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="fe-lobj.c.html#LN314"><span class='Ref_To_Local'>argv</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="libpq-fe.h.html#LN222"><span class='Ref_to_Member'>isint</span></a> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <a href="fe-lobj.c.html#LN314"><span class='Ref_To_Local'>argv</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="libpq-fe.h.html#LN221"><span class='Ref_to_Member'>len</span></a> <span class='Operator'>= </span><span class='Number'>4</span><span class='Delimiter'>; 
</span>    <a href="fe-lobj.c.html#LN314"><span class='Ref_To_Local'>argv</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="libpq-fe.h.html#LN227"><span class='Ref_to_Member'>u</span></a><span class='Operator'>.</span>integer <span class='Operator'>= </span><a href="fe-lobj.c.html#LN312"><span class='Ref_to_Parameter'>fd</span></a><span class='Delimiter'>; 
</span> 
    <a href="fe-lobj.c.html#LN314"><span class='Ref_To_Local'>argv</span></a><span class='Delimiter'>[</span><span class='Number'>1</span><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="libpq-fe.h.html#LN222"><span class='Ref_to_Member'>isint</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <a href="fe-lobj.c.html#LN314"><span class='Ref_To_Local'>argv</span></a><span class='Delimiter'>[</span><span class='Number'>1</span><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="libpq-fe.h.html#LN221"><span class='Ref_to_Member'>len</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Keyword'>int</span><span class='Parentheses'>) </span><a href="fe-lobj.c.html#LN312"><span class='Ref_to_Parameter'>len</span></a><span class='Delimiter'>; 
</span>    <a href="fe-lobj.c.html#LN314"><span class='Ref_To_Local'>argv</span></a><span class='Delimiter'>[</span><span class='Number'>1</span><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="libpq-fe.h.html#LN227"><span class='Ref_to_Member'>u</span></a><span class='Operator'>.</span>ptr <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Keyword'>int </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="fe-lobj.c.html#LN312"><span class='Ref_to_Parameter'>buf</span></a><span class='Delimiter'>; 
</span> 
    <a href="fe-lobj.c.html#LN315"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="libpq-fe.h.html#LN457"><span class='Ref_to_Proto'>PQfn</span></a><span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN312"><span class='Ref_to_Parameter'>conn</span></a><span class='Delimiter'>, </span><a href="fe-lobj.c.html#LN312"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN426"><span class='Ref_to_Member'>lobjfuncs</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN278"><span class='Ref_to_Member'>fn_lo_write</span></a><span class='Delimiter'>, 
</span>               <span class='Operator'>&</span><a href="fe-lobj.c.html#LN317"><span class='Ref_To_Local'>retval</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="fe-lobj.c.html#LN316"><span class='Ref_To_Local'>result_len</span></a><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Delimiter'>, </span><a href="fe-lobj.c.html#LN314"><span class='Ref_To_Local'>argv</span></a><span class='Delimiter'>, </span><span class='Number'>2</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="libpq-fe.h.html#LN466"><span class='Ref_to_Proto'>PQresultStatus</span></a><span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN315"><span class='Ref_To_Local'>res</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span><a href="libpq-fe.h.html#LN84"><span class='Ref_to_EnumConst'>PGRES_COMMAND_OK</span></a><span class='Parentheses'>)</span> 
    <span class='Delimiter'>{ 
</span>        <a href="libpq-fe.h.html#LN501"><span class='Ref_to_Proto'>PQclear</span></a><span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN315"><span class='Ref_To_Local'>res</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <a href="fe-lobj.c.html#LN317"><span class='Ref_To_Local'>retval</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <a href="libpq-fe.h.html#LN501"><span class='Ref_to_Proto'>PQclear</span></a><span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN315"><span class='Ref_To_Local'>res</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
}</span><span class='Auto_Annotations'> &laquo; end lo_write &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * lo_lseek 
 *    change the current read or write location on a large object 
 */ 
</span><span class='Keyword'>int 
</span><a name="LN365"></a><span class='Declare_Function'>lo_lseek</span><span class='Parentheses'>(</span><a href="libpq-fe.h.html#LN139"><span class='Ref_to_Typedef'>PGconn</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>conn</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>fd</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>offset</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>whence</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN367"></a>    <a href="libpq-fe.h.html#LN219"><span class='Ref_to_Typedef'>PQArgBlock</span></a>  <span class='Declare_Local'>argv</span><span class='Delimiter'>[</span><span class='Number'>3</span><span class='Delimiter'>]; 
</span><a name="LN368"></a>    <a href="libpq-fe.h.html#LN146"><span class='Ref_to_Typedef'>PGresult</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>res</span><span class='Delimiter'>; 
</span><a name="LN369"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>retval</span><span class='Delimiter'>; 
</span><a name="LN370"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>result_len</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN365"><span class='Ref_to_Parameter'>conn</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL </span><span class='Operator'>|| </span><a href="fe-lobj.c.html#LN365"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN426"><span class='Ref_to_Member'>lobjfuncs</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN44"><span class='Ref_to_Proto'>lo_initialize</span></a><span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN365"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
            <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="fe-lobj.c.html#LN367"><span class='Ref_To_Local'>argv</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="libpq-fe.h.html#LN222"><span class='Ref_to_Member'>isint</span></a> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <a href="fe-lobj.c.html#LN367"><span class='Ref_To_Local'>argv</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="libpq-fe.h.html#LN221"><span class='Ref_to_Member'>len</span></a> <span class='Operator'>= </span><span class='Number'>4</span><span class='Delimiter'>; 
</span>    <a href="fe-lobj.c.html#LN367"><span class='Ref_To_Local'>argv</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="libpq-fe.h.html#LN227"><span class='Ref_to_Member'>u</span></a><span class='Operator'>.</span>integer <span class='Operator'>= </span><a href="fe-lobj.c.html#LN365"><span class='Ref_to_Parameter'>fd</span></a><span class='Delimiter'>; 
</span> 
    <a href="fe-lobj.c.html#LN367"><span class='Ref_To_Local'>argv</span></a><span class='Delimiter'>[</span><span class='Number'>1</span><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="libpq-fe.h.html#LN222"><span class='Ref_to_Member'>isint</span></a> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <a href="fe-lobj.c.html#LN367"><span class='Ref_To_Local'>argv</span></a><span class='Delimiter'>[</span><span class='Number'>1</span><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="libpq-fe.h.html#LN221"><span class='Ref_to_Member'>len</span></a> <span class='Operator'>= </span><span class='Number'>4</span><span class='Delimiter'>; 
</span>    <a href="fe-lobj.c.html#LN367"><span class='Ref_To_Local'>argv</span></a><span class='Delimiter'>[</span><span class='Number'>1</span><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="libpq-fe.h.html#LN227"><span class='Ref_to_Member'>u</span></a><span class='Operator'>.</span>integer <span class='Operator'>= </span><a href="fe-lobj.c.html#LN365"><span class='Ref_to_Parameter'>offset</span></a><span class='Delimiter'>; 
</span> 
    <a href="fe-lobj.c.html#LN367"><span class='Ref_To_Local'>argv</span></a><span class='Delimiter'>[</span><span class='Number'>2</span><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="libpq-fe.h.html#LN222"><span class='Ref_to_Member'>isint</span></a> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <a href="fe-lobj.c.html#LN367"><span class='Ref_To_Local'>argv</span></a><span class='Delimiter'>[</span><span class='Number'>2</span><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="libpq-fe.h.html#LN221"><span class='Ref_to_Member'>len</span></a> <span class='Operator'>= </span><span class='Number'>4</span><span class='Delimiter'>; 
</span>    <a href="fe-lobj.c.html#LN367"><span class='Ref_To_Local'>argv</span></a><span class='Delimiter'>[</span><span class='Number'>2</span><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="libpq-fe.h.html#LN227"><span class='Ref_to_Member'>u</span></a><span class='Operator'>.</span>integer <span class='Operator'>= </span><a href="fe-lobj.c.html#LN365"><span class='Ref_to_Parameter'>whence</span></a><span class='Delimiter'>; 
</span> 
    <a href="fe-lobj.c.html#LN368"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="libpq-fe.h.html#LN457"><span class='Ref_to_Proto'>PQfn</span></a><span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN365"><span class='Ref_to_Parameter'>conn</span></a><span class='Delimiter'>, </span><a href="fe-lobj.c.html#LN365"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN426"><span class='Ref_to_Member'>lobjfuncs</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN271"><span class='Ref_to_Member'>fn_lo_lseek</span></a><span class='Delimiter'>, 
</span>               <span class='Operator'>&</span><a href="fe-lobj.c.html#LN369"><span class='Ref_To_Local'>retval</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="fe-lobj.c.html#LN370"><span class='Ref_To_Local'>result_len</span></a><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Delimiter'>, </span><a href="fe-lobj.c.html#LN367"><span class='Ref_To_Local'>argv</span></a><span class='Delimiter'>, </span><span class='Number'>3</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="libpq-fe.h.html#LN466"><span class='Ref_to_Proto'>PQresultStatus</span></a><span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN368"><span class='Ref_To_Local'>res</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span><a href="libpq-fe.h.html#LN84"><span class='Ref_to_EnumConst'>PGRES_COMMAND_OK</span></a><span class='Parentheses'>)</span> 
    <span class='Delimiter'>{ 
</span>        <a href="libpq-fe.h.html#LN501"><span class='Ref_to_Proto'>PQclear</span></a><span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN368"><span class='Ref_To_Local'>res</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <a href="fe-lobj.c.html#LN369"><span class='Ref_To_Local'>retval</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <a href="libpq-fe.h.html#LN501"><span class='Ref_to_Proto'>PQclear</span></a><span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN368"><span class='Ref_To_Local'>res</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
}</span><span class='Auto_Annotations'> &laquo; end lo_lseek &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * lo_lseek64 
 *    change the current read or write location on a large object 
 */ 
</span><a href="../../include/postgres_ext.h.html#LN46"><span class='Ref_to_Typedef'>pg_int64</span></a> 
<a name="LN409"></a><span class='Declare_Function'>lo_lseek64</span><span class='Parentheses'>(</span><a href="libpq-fe.h.html#LN139"><span class='Ref_to_Typedef'>PGconn</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>conn</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>fd</span><span class='Delimiter'>, </span><a href="../../include/postgres_ext.h.html#LN46"><span class='Ref_to_Typedef'>pg_int64</span></a> <span class='Declare_Parameter'>offset</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>whence</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN411"></a>    <a href="libpq-fe.h.html#LN219"><span class='Ref_to_Typedef'>PQArgBlock</span></a>  <span class='Declare_Local'>argv</span><span class='Delimiter'>[</span><span class='Number'>3</span><span class='Delimiter'>]; 
</span><a name="LN412"></a>    <a href="libpq-fe.h.html#LN146"><span class='Ref_to_Typedef'>PGresult</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>res</span><span class='Delimiter'>; 
</span><a name="LN413"></a>    <a href="../../include/postgres_ext.h.html#LN46"><span class='Ref_to_Typedef'>pg_int64</span></a>    <span class='Declare_Local'>retval</span><span class='Delimiter'>; 
</span><a name="LN414"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>result_len</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN409"><span class='Ref_to_Parameter'>conn</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL </span><span class='Operator'>|| </span><a href="fe-lobj.c.html#LN409"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN426"><span class='Ref_to_Member'>lobjfuncs</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN44"><span class='Ref_to_Proto'>lo_initialize</span></a><span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN409"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
            <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN409"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN426"><span class='Ref_to_Member'>lobjfuncs</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN272"><span class='Ref_to_Member'>fn_lo_lseek64</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="pqexpbuffer.c.html#LN232"><span class='Ref_to_Func'>printfPQExpBuffer</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="fe-lobj.c.html#LN409"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN491"><span class='Ref_to_Member'>errorMessage</span></a><span class='Delimiter'>, 
</span>             <a href="win32.c.html#LN36"><span class='Ref_to_Func'>libpq_gettext</span></a><span class='Parentheses'>(</span><span class='String'>"cannot determine OID of function lo_lseek64\n"</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="fe-lobj.c.html#LN411"><span class='Ref_To_Local'>argv</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="libpq-fe.h.html#LN222"><span class='Ref_to_Member'>isint</span></a> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <a href="fe-lobj.c.html#LN411"><span class='Ref_To_Local'>argv</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="libpq-fe.h.html#LN221"><span class='Ref_to_Member'>len</span></a> <span class='Operator'>= </span><span class='Number'>4</span><span class='Delimiter'>; 
</span>    <a href="fe-lobj.c.html#LN411"><span class='Ref_To_Local'>argv</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="libpq-fe.h.html#LN227"><span class='Ref_to_Member'>u</span></a><span class='Operator'>.</span>integer <span class='Operator'>= </span><a href="fe-lobj.c.html#LN409"><span class='Ref_to_Parameter'>fd</span></a><span class='Delimiter'>; 
</span> 
    <a href="fe-lobj.c.html#LN409"><span class='Ref_to_Parameter'>offset</span></a> <span class='Operator'>= </span><a href="fe-lobj.c.html#LN46"><span class='Ref_to_Proto'>lo_hton64</span></a><span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN409"><span class='Ref_to_Parameter'>offset</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="fe-lobj.c.html#LN411"><span class='Ref_To_Local'>argv</span></a><span class='Delimiter'>[</span><span class='Number'>1</span><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="libpq-fe.h.html#LN222"><span class='Ref_to_Member'>isint</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <a href="fe-lobj.c.html#LN411"><span class='Ref_To_Local'>argv</span></a><span class='Delimiter'>[</span><span class='Number'>1</span><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="libpq-fe.h.html#LN221"><span class='Ref_to_Member'>len</span></a> <span class='Operator'>= </span><span class='Number'>8</span><span class='Delimiter'>; 
</span>    <a href="fe-lobj.c.html#LN411"><span class='Ref_To_Local'>argv</span></a><span class='Delimiter'>[</span><span class='Number'>1</span><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="libpq-fe.h.html#LN227"><span class='Ref_to_Member'>u</span></a><span class='Operator'>.</span>ptr <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Keyword'>int </span><span class='Operator'>*</span><span class='Parentheses'>) </span><span class='Operator'>&</span><a href="fe-lobj.c.html#LN409"><span class='Ref_to_Parameter'>offset</span></a><span class='Delimiter'>; 
</span> 
    <a href="fe-lobj.c.html#LN411"><span class='Ref_To_Local'>argv</span></a><span class='Delimiter'>[</span><span class='Number'>2</span><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="libpq-fe.h.html#LN222"><span class='Ref_to_Member'>isint</span></a> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <a href="fe-lobj.c.html#LN411"><span class='Ref_To_Local'>argv</span></a><span class='Delimiter'>[</span><span class='Number'>2</span><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="libpq-fe.h.html#LN221"><span class='Ref_to_Member'>len</span></a> <span class='Operator'>= </span><span class='Number'>4</span><span class='Delimiter'>; 
</span>    <a href="fe-lobj.c.html#LN411"><span class='Ref_To_Local'>argv</span></a><span class='Delimiter'>[</span><span class='Number'>2</span><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="libpq-fe.h.html#LN227"><span class='Ref_to_Member'>u</span></a><span class='Operator'>.</span>integer <span class='Operator'>= </span><a href="fe-lobj.c.html#LN409"><span class='Ref_to_Parameter'>whence</span></a><span class='Delimiter'>; 
</span> 
    <a href="fe-lobj.c.html#LN412"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="libpq-fe.h.html#LN457"><span class='Ref_to_Proto'>PQfn</span></a><span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN409"><span class='Ref_to_Parameter'>conn</span></a><span class='Delimiter'>, </span><a href="fe-lobj.c.html#LN409"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN426"><span class='Ref_to_Member'>lobjfuncs</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN272"><span class='Ref_to_Member'>fn_lo_lseek64</span></a><span class='Delimiter'>, 
</span>               <span class='Parentheses'>(</span><span class='Keyword'>void </span><span class='Operator'>*</span><span class='Parentheses'>) </span><span class='Operator'>&</span><a href="fe-lobj.c.html#LN413"><span class='Ref_To_Local'>retval</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="fe-lobj.c.html#LN414"><span class='Ref_To_Local'>result_len</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Delimiter'>, </span><a href="fe-lobj.c.html#LN411"><span class='Ref_To_Local'>argv</span></a><span class='Delimiter'>, </span><span class='Number'>3</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="libpq-fe.h.html#LN466"><span class='Ref_to_Proto'>PQresultStatus</span></a><span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN412"><span class='Ref_To_Local'>res</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span><a href="libpq-fe.h.html#LN84"><span class='Ref_to_EnumConst'>PGRES_COMMAND_OK</span></a> <span class='Operator'>&& </span><a href="fe-lobj.c.html#LN414"><span class='Ref_To_Local'>result_len</span></a> <span class='Operator'>== </span><span class='Number'>8</span><span class='Parentheses'>)</span> 
    <span class='Delimiter'>{ 
</span>        <a href="libpq-fe.h.html#LN501"><span class='Ref_to_Proto'>PQclear</span></a><span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN412"><span class='Ref_To_Local'>res</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <a href="fe-lobj.c.html#LN47"><span class='Ref_to_Proto'>lo_ntoh64</span></a><span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN413"><span class='Ref_To_Local'>retval</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <a href="libpq-fe.h.html#LN501"><span class='Ref_to_Proto'>PQclear</span></a><span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN412"><span class='Ref_To_Local'>res</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
}</span><span class='Auto_Annotations'> &laquo; end lo_lseek64 &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * lo_creat 
 *    create a new large object 
 * the mode is ignored (once upon a time it had a use) 
 * 
 * returns the oid of the large object created or 
 * InvalidOid upon failure 
 */ 
</span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> 
<a name="LN465"></a><span class='Declare_Function'>lo_creat</span><span class='Parentheses'>(</span><a href="libpq-fe.h.html#LN139"><span class='Ref_to_Typedef'>PGconn</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>conn</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>mode</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN467"></a>    <a href="libpq-fe.h.html#LN219"><span class='Ref_to_Typedef'>PQArgBlock</span></a>  <span class='Declare_Local'>argv</span><span class='Delimiter'>[</span><span class='Number'>1</span><span class='Delimiter'>]; 
</span><a name="LN468"></a>    <a href="libpq-fe.h.html#LN146"><span class='Ref_to_Typedef'>PGresult</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>res</span><span class='Delimiter'>; 
</span><a name="LN469"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>retval</span><span class='Delimiter'>; 
</span><a name="LN470"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>result_len</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN465"><span class='Ref_to_Parameter'>conn</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL </span><span class='Operator'>|| </span><a href="fe-lobj.c.html#LN465"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN426"><span class='Ref_to_Member'>lobjfuncs</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN44"><span class='Ref_to_Proto'>lo_initialize</span></a><span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN465"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
            <span class='Control'>return</span> <a href="../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="fe-lobj.c.html#LN467"><span class='Ref_To_Local'>argv</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="libpq-fe.h.html#LN222"><span class='Ref_to_Member'>isint</span></a> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <a href="fe-lobj.c.html#LN467"><span class='Ref_To_Local'>argv</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="libpq-fe.h.html#LN221"><span class='Ref_to_Member'>len</span></a> <span class='Operator'>= </span><span class='Number'>4</span><span class='Delimiter'>; 
</span>    <a href="fe-lobj.c.html#LN467"><span class='Ref_To_Local'>argv</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="libpq-fe.h.html#LN227"><span class='Ref_to_Member'>u</span></a><span class='Operator'>.</span>integer <span class='Operator'>= </span><a href="fe-lobj.c.html#LN465"><span class='Ref_to_Parameter'>mode</span></a><span class='Delimiter'>; 
</span>    <a href="fe-lobj.c.html#LN468"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="libpq-fe.h.html#LN457"><span class='Ref_to_Proto'>PQfn</span></a><span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN465"><span class='Ref_to_Parameter'>conn</span></a><span class='Delimiter'>, </span><a href="fe-lobj.c.html#LN465"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN426"><span class='Ref_to_Member'>lobjfuncs</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN268"><span class='Ref_to_Member'>fn_lo_creat</span></a><span class='Delimiter'>, 
</span>               <span class='Operator'>&</span><a href="fe-lobj.c.html#LN469"><span class='Ref_To_Local'>retval</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="fe-lobj.c.html#LN470"><span class='Ref_To_Local'>result_len</span></a><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Delimiter'>, </span><a href="fe-lobj.c.html#LN467"><span class='Ref_To_Local'>argv</span></a><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="libpq-fe.h.html#LN466"><span class='Ref_to_Proto'>PQresultStatus</span></a><span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN468"><span class='Ref_To_Local'>res</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span><a href="libpq-fe.h.html#LN84"><span class='Ref_to_EnumConst'>PGRES_COMMAND_OK</span></a><span class='Parentheses'>)</span> 
    <span class='Delimiter'>{ 
</span>        <a href="libpq-fe.h.html#LN501"><span class='Ref_to_Proto'>PQclear</span></a><span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN468"><span class='Ref_To_Local'>res</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <span class='Parentheses'>(</span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a><span class='Parentheses'>) </span><a href="fe-lobj.c.html#LN469"><span class='Ref_To_Local'>retval</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <a href="libpq-fe.h.html#LN501"><span class='Ref_to_Proto'>PQclear</span></a><span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN468"><span class='Ref_To_Local'>res</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <a href="../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
}</span><span class='Auto_Annotations'> &laquo; end lo_creat &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * lo_create 
 *    create a new large object 
 * if lobjId isn't InvalidOid, it specifies the OID to (attempt to) create 
 * 
 * returns the oid of the large object created or 
 * InvalidOid upon failure 
 */ 
</span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> 
<a name="LN504"></a><span class='Declare_Function'>lo_create</span><span class='Parentheses'>(</span><a href="libpq-fe.h.html#LN139"><span class='Ref_to_Typedef'>PGconn</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>conn</span><span class='Delimiter'>, </span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Declare_Parameter'>lobjId</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN506"></a>    <a href="libpq-fe.h.html#LN219"><span class='Ref_to_Typedef'>PQArgBlock</span></a>  <span class='Declare_Local'>argv</span><span class='Delimiter'>[</span><span class='Number'>1</span><span class='Delimiter'>]; 
</span><a name="LN507"></a>    <a href="libpq-fe.h.html#LN146"><span class='Ref_to_Typedef'>PGresult</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>res</span><span class='Delimiter'>; 
</span><a name="LN508"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>retval</span><span class='Delimiter'>; 
</span><a name="LN509"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>result_len</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN504"><span class='Ref_to_Parameter'>conn</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL </span><span class='Operator'>|| </span><a href="fe-lobj.c.html#LN504"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN426"><span class='Ref_to_Member'>lobjfuncs</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN44"><span class='Ref_to_Proto'>lo_initialize</span></a><span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN504"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
            <span class='Control'>return</span> <a href="../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* Must check this on-the-fly because it's not there pre-8.1 */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN504"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN426"><span class='Ref_to_Member'>lobjfuncs</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN269"><span class='Ref_to_Member'>fn_lo_create</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="pqexpbuffer.c.html#LN232"><span class='Ref_to_Func'>printfPQExpBuffer</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="fe-lobj.c.html#LN504"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN491"><span class='Ref_to_Member'>errorMessage</span></a><span class='Delimiter'>, 
</span>              <a href="win32.c.html#LN36"><span class='Ref_to_Func'>libpq_gettext</span></a><span class='Parentheses'>(</span><span class='String'>"cannot determine OID of function lo_create\n"</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <a href="../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="fe-lobj.c.html#LN506"><span class='Ref_To_Local'>argv</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="libpq-fe.h.html#LN222"><span class='Ref_to_Member'>isint</span></a> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <a href="fe-lobj.c.html#LN506"><span class='Ref_To_Local'>argv</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="libpq-fe.h.html#LN221"><span class='Ref_to_Member'>len</span></a> <span class='Operator'>= </span><span class='Number'>4</span><span class='Delimiter'>; 
</span>    <a href="fe-lobj.c.html#LN506"><span class='Ref_To_Local'>argv</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="libpq-fe.h.html#LN227"><span class='Ref_to_Member'>u</span></a><span class='Operator'>.</span>integer <span class='Operator'>= </span><a href="fe-lobj.c.html#LN504"><span class='Ref_to_Parameter'>lobjId</span></a><span class='Delimiter'>; 
</span>    <a href="fe-lobj.c.html#LN507"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="libpq-fe.h.html#LN457"><span class='Ref_to_Proto'>PQfn</span></a><span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN504"><span class='Ref_to_Parameter'>conn</span></a><span class='Delimiter'>, </span><a href="fe-lobj.c.html#LN504"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN426"><span class='Ref_to_Member'>lobjfuncs</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN269"><span class='Ref_to_Member'>fn_lo_create</span></a><span class='Delimiter'>, 
</span>               <span class='Operator'>&</span><a href="fe-lobj.c.html#LN508"><span class='Ref_To_Local'>retval</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="fe-lobj.c.html#LN509"><span class='Ref_To_Local'>result_len</span></a><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Delimiter'>, </span><a href="fe-lobj.c.html#LN506"><span class='Ref_To_Local'>argv</span></a><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="libpq-fe.h.html#LN466"><span class='Ref_to_Proto'>PQresultStatus</span></a><span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN507"><span class='Ref_To_Local'>res</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span><a href="libpq-fe.h.html#LN84"><span class='Ref_to_EnumConst'>PGRES_COMMAND_OK</span></a><span class='Parentheses'>)</span> 
    <span class='Delimiter'>{ 
</span>        <a href="libpq-fe.h.html#LN501"><span class='Ref_to_Proto'>PQclear</span></a><span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN507"><span class='Ref_To_Local'>res</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <span class='Parentheses'>(</span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a><span class='Parentheses'>) </span><a href="fe-lobj.c.html#LN508"><span class='Ref_To_Local'>retval</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <a href="libpq-fe.h.html#LN501"><span class='Ref_to_Proto'>PQclear</span></a><span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN507"><span class='Ref_To_Local'>res</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <a href="../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
}</span><span class='Auto_Annotations'> &laquo; end lo_create &raquo; </span> 
 
 
<span class='Comment_Multi_Line'>/* 
 * lo_tell 
 *    returns the current seek location of the large object 
 */ 
</span><span class='Keyword'>int 
</span><a name="LN548"></a><span class='Declare_Function'>lo_tell</span><span class='Parentheses'>(</span><a href="libpq-fe.h.html#LN139"><span class='Ref_to_Typedef'>PGconn</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>conn</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>fd</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN550"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>retval</span><span class='Delimiter'>; 
</span><a name="LN551"></a>    <a href="libpq-fe.h.html#LN219"><span class='Ref_to_Typedef'>PQArgBlock</span></a>  <span class='Declare_Local'>argv</span><span class='Delimiter'>[</span><span class='Number'>1</span><span class='Delimiter'>]; 
</span><a name="LN552"></a>    <a href="libpq-fe.h.html#LN146"><span class='Ref_to_Typedef'>PGresult</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>res</span><span class='Delimiter'>; 
</span><a name="LN553"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>result_len</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN548"><span class='Ref_to_Parameter'>conn</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL </span><span class='Operator'>|| </span><a href="fe-lobj.c.html#LN548"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN426"><span class='Ref_to_Member'>lobjfuncs</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN44"><span class='Ref_to_Proto'>lo_initialize</span></a><span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN548"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
            <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="fe-lobj.c.html#LN551"><span class='Ref_To_Local'>argv</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="libpq-fe.h.html#LN222"><span class='Ref_to_Member'>isint</span></a> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <a href="fe-lobj.c.html#LN551"><span class='Ref_To_Local'>argv</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="libpq-fe.h.html#LN221"><span class='Ref_to_Member'>len</span></a> <span class='Operator'>= </span><span class='Number'>4</span><span class='Delimiter'>; 
</span>    <a href="fe-lobj.c.html#LN551"><span class='Ref_To_Local'>argv</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="libpq-fe.h.html#LN227"><span class='Ref_to_Member'>u</span></a><span class='Operator'>.</span>integer <span class='Operator'>= </span><a href="fe-lobj.c.html#LN548"><span class='Ref_to_Parameter'>fd</span></a><span class='Delimiter'>; 
</span> 
    <a href="fe-lobj.c.html#LN552"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="libpq-fe.h.html#LN457"><span class='Ref_to_Proto'>PQfn</span></a><span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN548"><span class='Ref_to_Parameter'>conn</span></a><span class='Delimiter'>, </span><a href="fe-lobj.c.html#LN548"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN426"><span class='Ref_to_Member'>lobjfuncs</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN273"><span class='Ref_to_Member'>fn_lo_tell</span></a><span class='Delimiter'>, 
</span>               <span class='Operator'>&</span><a href="fe-lobj.c.html#LN550"><span class='Ref_To_Local'>retval</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="fe-lobj.c.html#LN553"><span class='Ref_To_Local'>result_len</span></a><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Delimiter'>, </span><a href="fe-lobj.c.html#LN551"><span class='Ref_To_Local'>argv</span></a><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="libpq-fe.h.html#LN466"><span class='Ref_to_Proto'>PQresultStatus</span></a><span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN552"><span class='Ref_To_Local'>res</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span><a href="libpq-fe.h.html#LN84"><span class='Ref_to_EnumConst'>PGRES_COMMAND_OK</span></a><span class='Parentheses'>)</span> 
    <span class='Delimiter'>{ 
</span>        <a href="libpq-fe.h.html#LN501"><span class='Ref_to_Proto'>PQclear</span></a><span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN552"><span class='Ref_To_Local'>res</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <a href="fe-lobj.c.html#LN550"><span class='Ref_To_Local'>retval</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <a href="libpq-fe.h.html#LN501"><span class='Ref_to_Proto'>PQclear</span></a><span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN552"><span class='Ref_To_Local'>res</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
}</span><span class='Auto_Annotations'> &laquo; end lo_tell &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * lo_tell64 
 *    returns the current seek location of the large object 
 */ 
</span><a href="../../include/postgres_ext.h.html#LN46"><span class='Ref_to_Typedef'>pg_int64</span></a> 
<a name="LN584"></a><span class='Declare_Function'>lo_tell64</span><span class='Parentheses'>(</span><a href="libpq-fe.h.html#LN139"><span class='Ref_to_Typedef'>PGconn</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>conn</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>fd</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN586"></a>    <a href="../../include/postgres_ext.h.html#LN46"><span class='Ref_to_Typedef'>pg_int64</span></a>    <span class='Declare_Local'>retval</span><span class='Delimiter'>; 
</span><a name="LN587"></a>    <a href="libpq-fe.h.html#LN219"><span class='Ref_to_Typedef'>PQArgBlock</span></a>  <span class='Declare_Local'>argv</span><span class='Delimiter'>[</span><span class='Number'>1</span><span class='Delimiter'>]; 
</span><a name="LN588"></a>    <a href="libpq-fe.h.html#LN146"><span class='Ref_to_Typedef'>PGresult</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>res</span><span class='Delimiter'>; 
</span><a name="LN589"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>result_len</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN584"><span class='Ref_to_Parameter'>conn</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL </span><span class='Operator'>|| </span><a href="fe-lobj.c.html#LN584"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN426"><span class='Ref_to_Member'>lobjfuncs</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN44"><span class='Ref_to_Proto'>lo_initialize</span></a><span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN584"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
            <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN584"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN426"><span class='Ref_to_Member'>lobjfuncs</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN274"><span class='Ref_to_Member'>fn_lo_tell64</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="pqexpbuffer.c.html#LN232"><span class='Ref_to_Func'>printfPQExpBuffer</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="fe-lobj.c.html#LN584"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN491"><span class='Ref_to_Member'>errorMessage</span></a><span class='Delimiter'>, 
</span>              <a href="win32.c.html#LN36"><span class='Ref_to_Func'>libpq_gettext</span></a><span class='Parentheses'>(</span><span class='String'>"cannot determine OID of function lo_tell64\n"</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="fe-lobj.c.html#LN587"><span class='Ref_To_Local'>argv</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="libpq-fe.h.html#LN222"><span class='Ref_to_Member'>isint</span></a> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <a href="fe-lobj.c.html#LN587"><span class='Ref_To_Local'>argv</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="libpq-fe.h.html#LN221"><span class='Ref_to_Member'>len</span></a> <span class='Operator'>= </span><span class='Number'>4</span><span class='Delimiter'>; 
</span>    <a href="fe-lobj.c.html#LN587"><span class='Ref_To_Local'>argv</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="libpq-fe.h.html#LN227"><span class='Ref_to_Member'>u</span></a><span class='Operator'>.</span>integer <span class='Operator'>= </span><a href="fe-lobj.c.html#LN584"><span class='Ref_to_Parameter'>fd</span></a><span class='Delimiter'>; 
</span> 
    <a href="fe-lobj.c.html#LN588"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="libpq-fe.h.html#LN457"><span class='Ref_to_Proto'>PQfn</span></a><span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN584"><span class='Ref_to_Parameter'>conn</span></a><span class='Delimiter'>, </span><a href="fe-lobj.c.html#LN584"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN426"><span class='Ref_to_Member'>lobjfuncs</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN274"><span class='Ref_to_Member'>fn_lo_tell64</span></a><span class='Delimiter'>, 
</span>               <span class='Parentheses'>(</span><span class='Keyword'>void </span><span class='Operator'>*</span><span class='Parentheses'>) </span><span class='Operator'>&</span><a href="fe-lobj.c.html#LN586"><span class='Ref_To_Local'>retval</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="fe-lobj.c.html#LN589"><span class='Ref_To_Local'>result_len</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Delimiter'>, </span><a href="fe-lobj.c.html#LN587"><span class='Ref_To_Local'>argv</span></a><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="libpq-fe.h.html#LN466"><span class='Ref_to_Proto'>PQresultStatus</span></a><span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN588"><span class='Ref_To_Local'>res</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span><a href="libpq-fe.h.html#LN84"><span class='Ref_to_EnumConst'>PGRES_COMMAND_OK</span></a> <span class='Operator'>&& </span><a href="fe-lobj.c.html#LN589"><span class='Ref_To_Local'>result_len</span></a> <span class='Operator'>== </span><span class='Number'>8</span><span class='Parentheses'>)</span> 
    <span class='Delimiter'>{ 
</span>        <a href="libpq-fe.h.html#LN501"><span class='Ref_to_Proto'>PQclear</span></a><span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN588"><span class='Ref_To_Local'>res</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <a href="fe-lobj.c.html#LN47"><span class='Ref_to_Proto'>lo_ntoh64</span></a><span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN586"><span class='Ref_To_Local'>retval</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <a href="libpq-fe.h.html#LN501"><span class='Ref_to_Proto'>PQclear</span></a><span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN588"><span class='Ref_To_Local'>res</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
}</span><span class='Auto_Annotations'> &laquo; end lo_tell64 &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * lo_unlink 
 *    delete a file 
 */ 
</span> 
<span class='Keyword'>int 
</span><a name="LN628"></a><span class='Declare_Function'>lo_unlink</span><span class='Parentheses'>(</span><a href="libpq-fe.h.html#LN139"><span class='Ref_to_Typedef'>PGconn</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>conn</span><span class='Delimiter'>, </span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Declare_Parameter'>lobjId</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN630"></a>    <a href="libpq-fe.h.html#LN219"><span class='Ref_to_Typedef'>PQArgBlock</span></a>  <span class='Declare_Local'>argv</span><span class='Delimiter'>[</span><span class='Number'>1</span><span class='Delimiter'>]; 
</span><a name="LN631"></a>    <a href="libpq-fe.h.html#LN146"><span class='Ref_to_Typedef'>PGresult</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>res</span><span class='Delimiter'>; 
</span><a name="LN632"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>result_len</span><span class='Delimiter'>; 
</span><a name="LN633"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>retval</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN628"><span class='Ref_to_Parameter'>conn</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL </span><span class='Operator'>|| </span><a href="fe-lobj.c.html#LN628"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN426"><span class='Ref_to_Member'>lobjfuncs</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN44"><span class='Ref_to_Proto'>lo_initialize</span></a><span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN628"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
            <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="fe-lobj.c.html#LN630"><span class='Ref_To_Local'>argv</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="libpq-fe.h.html#LN222"><span class='Ref_to_Member'>isint</span></a> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <a href="fe-lobj.c.html#LN630"><span class='Ref_To_Local'>argv</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="libpq-fe.h.html#LN221"><span class='Ref_to_Member'>len</span></a> <span class='Operator'>= </span><span class='Number'>4</span><span class='Delimiter'>; 
</span>    <a href="fe-lobj.c.html#LN630"><span class='Ref_To_Local'>argv</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="libpq-fe.h.html#LN227"><span class='Ref_to_Member'>u</span></a><span class='Operator'>.</span>integer <span class='Operator'>= </span><a href="fe-lobj.c.html#LN628"><span class='Ref_to_Parameter'>lobjId</span></a><span class='Delimiter'>; 
</span> 
    <a href="fe-lobj.c.html#LN631"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="libpq-fe.h.html#LN457"><span class='Ref_to_Proto'>PQfn</span></a><span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN628"><span class='Ref_to_Parameter'>conn</span></a><span class='Delimiter'>, </span><a href="fe-lobj.c.html#LN628"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN426"><span class='Ref_to_Member'>lobjfuncs</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN270"><span class='Ref_to_Member'>fn_lo_unlink</span></a><span class='Delimiter'>, 
</span>               <span class='Operator'>&</span><a href="fe-lobj.c.html#LN633"><span class='Ref_To_Local'>retval</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="fe-lobj.c.html#LN632"><span class='Ref_To_Local'>result_len</span></a><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Delimiter'>, </span><a href="fe-lobj.c.html#LN630"><span class='Ref_To_Local'>argv</span></a><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="libpq-fe.h.html#LN466"><span class='Ref_to_Proto'>PQresultStatus</span></a><span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN631"><span class='Ref_To_Local'>res</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span><a href="libpq-fe.h.html#LN84"><span class='Ref_to_EnumConst'>PGRES_COMMAND_OK</span></a><span class='Parentheses'>)</span> 
    <span class='Delimiter'>{ 
</span>        <a href="libpq-fe.h.html#LN501"><span class='Ref_to_Proto'>PQclear</span></a><span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN631"><span class='Ref_To_Local'>res</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <a href="fe-lobj.c.html#LN633"><span class='Ref_To_Local'>retval</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <a href="libpq-fe.h.html#LN501"><span class='Ref_to_Proto'>PQclear</span></a><span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN631"><span class='Ref_To_Local'>res</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
}</span><span class='Auto_Annotations'> &laquo; end lo_unlink &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * lo_import - 
 *    imports a file as an (inversion) large object. 
 * 
 * returns the oid of that object upon success, 
 * returns InvalidOid upon failure 
 */ 
</span> 
<a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> 
<a name="LN668"></a><span class='Declare_Function'>lo_import</span><span class='Parentheses'>(</span><a href="libpq-fe.h.html#LN139"><span class='Ref_to_Typedef'>PGconn</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>conn</span><span class='Delimiter'>, </span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>filename</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>return</span> <a href="fe-lobj.c.html#LN45"><span class='Ref_to_Proto'>lo_import_internal</span></a><span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN668"><span class='Ref_to_Parameter'>conn</span></a><span class='Delimiter'>, </span><a href="fe-lobj.c.html#LN668"><span class='Ref_to_Parameter'>filename</span></a><span class='Delimiter'>, </span><a href="../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * lo_import_with_oid - 
 *    imports a file as an (inversion) large object. 
 *    large object id can be specified. 
 * 
 * returns the oid of that object upon success, 
 * returns InvalidOid upon failure 
 */ 
</span> 
<a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> 
<a name="LN683"></a><span class='Declare_Function'>lo_import_with_oid</span><span class='Parentheses'>(</span><a href="libpq-fe.h.html#LN139"><span class='Ref_to_Typedef'>PGconn</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>conn</span><span class='Delimiter'>, </span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>filename</span><span class='Delimiter'>, </span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Declare_Parameter'>lobjId</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>return</span> <a href="fe-lobj.c.html#LN45"><span class='Ref_to_Proto'>lo_import_internal</span></a><span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN683"><span class='Ref_to_Parameter'>conn</span></a><span class='Delimiter'>, </span><a href="fe-lobj.c.html#LN683"><span class='Ref_to_Parameter'>filename</span></a><span class='Delimiter'>, </span><a href="fe-lobj.c.html#LN683"><span class='Ref_to_Parameter'>lobjId</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Keyword'>static </span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> 
<a name="LN689"></a><span class='Declare_Function'>lo_import_internal</span><span class='Parentheses'>(</span><a href="libpq-fe.h.html#LN139"><span class='Ref_to_Typedef'>PGconn</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>conn</span><span class='Delimiter'>, </span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>filename</span><span class='Delimiter'>, </span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Declare_Parameter'>oid</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN691"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>fd</span><span class='Delimiter'>; 
</span><a name="LN692"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>nbytes</span><span class='Delimiter'>, 
</span><a name="LN693"></a>                <span class='Declare_Local'>tmp</span><span class='Delimiter'>; 
</span><a name="LN694"></a>    <span class='Keyword'>char</span>        <span class='Declare_Local'>buf</span><span class='Delimiter'>[</span><a href="fe-lobj.c.html#LN42"><span class='Ref_to_Const'>LO_BUFSIZE</span></a><span class='Delimiter'>]; 
</span><a name="LN695"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>lobjOid</span><span class='Delimiter'>; 
</span><a name="LN696"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>lobj</span><span class='Delimiter'>; 
</span><a name="LN697"></a>    <span class='Keyword'>char</span>        <span class='Declare_Local'>sebuf</span><span class='Delimiter'>[</span><span class='Number'>256</span><span class='Delimiter'>]; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * open the file to be read in 
     */ 
</span>    <a href="fe-lobj.c.html#LN691"><span class='Ref_To_Local'>fd</span></a> <span class='Operator'>= </span><a href="../../include/port.h.html#LN289"><span class='Ref_to_Macro'>open</span></a><span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN689"><span class='Ref_to_Parameter'>filename</span></a><span class='Delimiter'>, </span>O_RDONLY <span class='Operator'>| </span><a href="../../include/c.h.html#LN1032"><span class='Ref_to_Const'>PG_BINARY</span></a><span class='Delimiter'>, </span><span class='Number'>0666</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN691"><span class='Ref_To_Local'>fd</span></a> <span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{</span>                           <span class='Comment_Single_Line'>/* error */ 
</span>        <a href="pqexpbuffer.c.html#LN232"><span class='Ref_to_Func'>printfPQExpBuffer</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="fe-lobj.c.html#LN689"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN491"><span class='Ref_to_Member'>errorMessage</span></a><span class='Delimiter'>, 
</span>                          <a href="win32.c.html#LN36"><span class='Ref_to_Func'>libpq_gettext</span></a><span class='Parentheses'>(</span><span class='String'>"could not open file \"%s\": %s\n"</span><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                          <a href="fe-lobj.c.html#LN689"><span class='Ref_to_Parameter'>filename</span></a><span class='Delimiter'>, </span><a href="../../port/thread.c.html#LN59"><span class='Ref_to_Func'>pqStrerror</span></a><span class='Parentheses'>(</span>errno<span class='Delimiter'>, </span><a href="fe-lobj.c.html#LN697"><span class='Ref_To_Local'>sebuf</span></a><span class='Delimiter'>, </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN697"><span class='Ref_To_Local'>sebuf</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <a href="../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * create an inversion object 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN689"><span class='Ref_to_Parameter'>oid</span></a> <span class='Operator'>== </span><a href="../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Parentheses'>) 
</span>        <a href="fe-lobj.c.html#LN695"><span class='Ref_To_Local'>lobjOid</span></a> <span class='Operator'>= </span><a href="fe-lobj.c.html#LN464"><span class='Ref_to_Func'>lo_creat</span></a><span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN689"><span class='Ref_to_Parameter'>conn</span></a><span class='Delimiter'>, </span><a href="../../include/libpq/libpq-fs.h.html#LN21"><span class='Ref_to_Const'>INV_READ</span></a> <span class='Operator'>| </span><a href="../../include/libpq/libpq-fs.h.html#LN20"><span class='Ref_to_Const'>INV_WRITE</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
        <a href="fe-lobj.c.html#LN695"><span class='Ref_To_Local'>lobjOid</span></a> <span class='Operator'>= </span><a href="fe-lobj.c.html#LN503"><span class='Ref_to_Func'>lo_create</span></a><span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN689"><span class='Ref_to_Parameter'>conn</span></a><span class='Delimiter'>, </span><a href="fe-lobj.c.html#LN689"><span class='Ref_to_Parameter'>oid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN695"><span class='Ref_To_Local'>lobjOid</span></a> <span class='Operator'>== </span><a href="../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* we assume lo_create() already set a suitable error message */ 
</span>        <span class='Parentheses'>(</span><span class='Keyword'>void</span><span class='Parentheses'>) </span><a href="win32.h.html#LN11"><span class='Ref_to_Macro'>close</span></a><span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN691"><span class='Ref_To_Local'>fd</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <a href="../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="fe-lobj.c.html#LN696"><span class='Ref_To_Local'>lobj</span></a> <span class='Operator'>= </span><a href="fe-lobj.c.html#LN56"><span class='Ref_to_Func'>lo_open</span></a><span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN689"><span class='Ref_to_Parameter'>conn</span></a><span class='Delimiter'>, </span><a href="fe-lobj.c.html#LN695"><span class='Ref_To_Local'>lobjOid</span></a><span class='Delimiter'>, </span><a href="../../include/libpq/libpq-fs.h.html#LN20"><span class='Ref_to_Const'>INV_WRITE</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN696"><span class='Ref_To_Local'>lobj</span></a> <span class='Operator'>== -</span><span class='Number'>1</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* we assume lo_open() already set a suitable error message */ 
</span>        <span class='Parentheses'>(</span><span class='Keyword'>void</span><span class='Parentheses'>) </span><a href="win32.h.html#LN11"><span class='Ref_to_Macro'>close</span></a><span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN691"><span class='Ref_To_Local'>fd</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <a href="../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * read in from the file and write to the large object 
     */ 
</span>    <span class='Control'>while</span> <span class='Parentheses'>((</span><a href="fe-lobj.c.html#LN692"><span class='Ref_To_Local'>nbytes</span></a> <span class='Operator'>= </span><a href="win32.h.html#LN12"><span class='Ref_to_Macro'>read</span></a><span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN691"><span class='Ref_To_Local'>fd</span></a><span class='Delimiter'>, </span><a href="fe-lobj.c.html#LN694"><span class='Ref_To_Local'>buf</span></a><span class='Delimiter'>, </span><a href="fe-lobj.c.html#LN42"><span class='Ref_to_Const'>LO_BUFSIZE</span></a><span class='Parentheses'>))</span> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
    <span class='Delimiter'>{ 
</span>        <a href="fe-lobj.c.html#LN693"><span class='Ref_To_Local'>tmp</span></a> <span class='Operator'>= </span><a href="../../include/libpq/be-fsstubs.h.html#LN27"><span class='Ref_to_Proto'>lo_write</span></a><span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN689"><span class='Ref_to_Parameter'>conn</span></a><span class='Delimiter'>, </span><a href="fe-lobj.c.html#LN696"><span class='Ref_To_Local'>lobj</span></a><span class='Delimiter'>, </span><a href="fe-lobj.c.html#LN694"><span class='Ref_To_Local'>buf</span></a><span class='Delimiter'>, </span><a href="fe-lobj.c.html#LN692"><span class='Ref_To_Local'>nbytes</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN693"><span class='Ref_To_Local'>tmp</span></a> <span class='Operator'>!= </span><a href="fe-lobj.c.html#LN692"><span class='Ref_To_Local'>nbytes</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* 
             * If lo_write() failed, we are now in an aborted transaction so 
             * there's no need for lo_close(); furthermore, if we tried it 
             * we'd overwrite the useful error result with a useless one. So 
             * just nail the doors shut and get out of town. 
             */ 
</span>            <span class='Parentheses'>(</span><span class='Keyword'>void</span><span class='Parentheses'>) </span><a href="win32.h.html#LN11"><span class='Ref_to_Macro'>close</span></a><span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN691"><span class='Ref_To_Local'>fd</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>return</span> <a href="../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN692"><span class='Ref_To_Local'>nbytes</span></a> <span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* We must do lo_close before setting the errorMessage */ 
</span><a name="LN756"></a>        <span class='Keyword'>int</span>         <span class='Declare_Local'>save_errno</span> <span class='Operator'>= </span>errno<span class='Delimiter'>; 
</span> 
        <span class='Parentheses'>(</span><span class='Keyword'>void</span><span class='Parentheses'>) </span><a href="fe-lobj.c.html#LN98"><span class='Ref_to_Func'>lo_close</span></a><span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN689"><span class='Ref_to_Parameter'>conn</span></a><span class='Delimiter'>, </span><a href="fe-lobj.c.html#LN696"><span class='Ref_To_Local'>lobj</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Parentheses'>(</span><span class='Keyword'>void</span><span class='Parentheses'>) </span><a href="win32.h.html#LN11"><span class='Ref_to_Macro'>close</span></a><span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN691"><span class='Ref_To_Local'>fd</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="pqexpbuffer.c.html#LN232"><span class='Ref_to_Func'>printfPQExpBuffer</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="fe-lobj.c.html#LN689"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN491"><span class='Ref_to_Member'>errorMessage</span></a><span class='Delimiter'>, 
</span>                      <a href="win32.c.html#LN36"><span class='Ref_to_Func'>libpq_gettext</span></a><span class='Parentheses'>(</span><span class='String'>"could not read from file \"%s\": %s\n"</span><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                          <a href="fe-lobj.c.html#LN689"><span class='Ref_to_Parameter'>filename</span></a><span class='Delimiter'>, 
</span>                          <a href="../../port/thread.c.html#LN59"><span class='Ref_to_Func'>pqStrerror</span></a><span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN756"><span class='Ref_To_Local'>save_errno</span></a><span class='Delimiter'>, </span><a href="fe-lobj.c.html#LN697"><span class='Ref_To_Local'>sebuf</span></a><span class='Delimiter'>, </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN697"><span class='Ref_To_Local'>sebuf</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <a href="../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Parentheses'>(</span><span class='Keyword'>void</span><span class='Parentheses'>) </span><a href="win32.h.html#LN11"><span class='Ref_to_Macro'>close</span></a><span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN691"><span class='Ref_To_Local'>fd</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN98"><span class='Ref_to_Func'>lo_close</span></a><span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN689"><span class='Ref_to_Parameter'>conn</span></a><span class='Delimiter'>, </span><a href="fe-lobj.c.html#LN696"><span class='Ref_To_Local'>lobj</span></a><span class='Parentheses'>) </span><span class='Operator'>!= </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* we assume lo_close() already set a suitable error message */ 
</span>        <span class='Control'>return</span> <a href="../../include/postgres_ext.h.html#LN33"><span class='Ref_to_Const'>InvalidOid</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>return</span> <a href="fe-lobj.c.html#LN695"><span class='Ref_To_Local'>lobjOid</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end lo_import_internal &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * lo_export - 
 *    exports an (inversion) large object. 
 * returns -1 upon failure, 1 if OK 
 */ 
</span><span class='Keyword'>int 
</span><a name="LN784"></a><span class='Declare_Function'>lo_export</span><span class='Parentheses'>(</span><a href="libpq-fe.h.html#LN139"><span class='Ref_to_Typedef'>PGconn</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>conn</span><span class='Delimiter'>, </span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a> <span class='Declare_Parameter'>lobjId</span><span class='Delimiter'>, </span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>filename</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN786"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>result</span> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span><a name="LN787"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>fd</span><span class='Delimiter'>; 
</span><a name="LN788"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>nbytes</span><span class='Delimiter'>, 
</span><a name="LN789"></a>                <span class='Declare_Local'>tmp</span><span class='Delimiter'>; 
</span><a name="LN790"></a>    <span class='Keyword'>char</span>        <span class='Declare_Local'>buf</span><span class='Delimiter'>[</span><a href="fe-lobj.c.html#LN42"><span class='Ref_to_Const'>LO_BUFSIZE</span></a><span class='Delimiter'>]; 
</span><a name="LN791"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>lobj</span><span class='Delimiter'>; 
</span><a name="LN792"></a>    <span class='Keyword'>char</span>        <span class='Declare_Local'>sebuf</span><span class='Delimiter'>[</span><span class='Number'>256</span><span class='Delimiter'>]; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * open the large object. 
     */ 
</span>    <a href="fe-lobj.c.html#LN791"><span class='Ref_To_Local'>lobj</span></a> <span class='Operator'>= </span><a href="fe-lobj.c.html#LN56"><span class='Ref_to_Func'>lo_open</span></a><span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN784"><span class='Ref_to_Parameter'>conn</span></a><span class='Delimiter'>, </span><a href="fe-lobj.c.html#LN784"><span class='Ref_to_Parameter'>lobjId</span></a><span class='Delimiter'>, </span><a href="../../include/libpq/libpq-fs.h.html#LN21"><span class='Ref_to_Const'>INV_READ</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN791"><span class='Ref_To_Local'>lobj</span></a> <span class='Operator'>== -</span><span class='Number'>1</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* we assume lo_open() already set a suitable error message */ 
</span>        <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * create the file to be written to 
     */ 
</span>    <a href="fe-lobj.c.html#LN787"><span class='Ref_To_Local'>fd</span></a> <span class='Operator'>= </span><a href="../../include/port.h.html#LN289"><span class='Ref_to_Macro'>open</span></a><span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN784"><span class='Ref_to_Parameter'>filename</span></a><span class='Delimiter'>, </span>O_CREAT <span class='Operator'>| </span>O_WRONLY <span class='Operator'>| </span>O_TRUNC <span class='Operator'>| </span><a href="../../include/c.h.html#LN1032"><span class='Ref_to_Const'>PG_BINARY</span></a><span class='Delimiter'>, </span><span class='Number'>0666</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN787"><span class='Ref_To_Local'>fd</span></a> <span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* We must do lo_close before setting the errorMessage */ 
</span><a name="LN811"></a>        <span class='Keyword'>int</span>         <span class='Declare_Local'>save_errno</span> <span class='Operator'>= </span>errno<span class='Delimiter'>; 
</span> 
        <span class='Parentheses'>(</span><span class='Keyword'>void</span><span class='Parentheses'>) </span><a href="fe-lobj.c.html#LN98"><span class='Ref_to_Func'>lo_close</span></a><span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN784"><span class='Ref_to_Parameter'>conn</span></a><span class='Delimiter'>, </span><a href="fe-lobj.c.html#LN791"><span class='Ref_To_Local'>lobj</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="pqexpbuffer.c.html#LN232"><span class='Ref_to_Func'>printfPQExpBuffer</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="fe-lobj.c.html#LN784"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN491"><span class='Ref_to_Member'>errorMessage</span></a><span class='Delimiter'>, 
</span>                          <a href="win32.c.html#LN36"><span class='Ref_to_Func'>libpq_gettext</span></a><span class='Parentheses'>(</span><span class='String'>"could not open file \"%s\": %s\n"</span><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                          <a href="fe-lobj.c.html#LN784"><span class='Ref_to_Parameter'>filename</span></a><span class='Delimiter'>, 
</span>                          <a href="../../port/thread.c.html#LN59"><span class='Ref_to_Func'>pqStrerror</span></a><span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN811"><span class='Ref_To_Local'>save_errno</span></a><span class='Delimiter'>, </span><a href="fe-lobj.c.html#LN792"><span class='Ref_To_Local'>sebuf</span></a><span class='Delimiter'>, </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN792"><span class='Ref_To_Local'>sebuf</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * read in from the large object and write to the file 
     */ 
</span>    <span class='Control'>while</span> <span class='Parentheses'>((</span><a href="fe-lobj.c.html#LN788"><span class='Ref_To_Local'>nbytes</span></a> <span class='Operator'>= </span><a href="../../include/libpq/be-fsstubs.h.html#LN26"><span class='Ref_to_Proto'>lo_read</span></a><span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN784"><span class='Ref_to_Parameter'>conn</span></a><span class='Delimiter'>, </span><a href="fe-lobj.c.html#LN791"><span class='Ref_To_Local'>lobj</span></a><span class='Delimiter'>, </span><a href="fe-lobj.c.html#LN790"><span class='Ref_To_Local'>buf</span></a><span class='Delimiter'>, </span><a href="fe-lobj.c.html#LN42"><span class='Ref_to_Const'>LO_BUFSIZE</span></a><span class='Parentheses'>))</span> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
    <span class='Delimiter'>{ 
</span>        <a href="fe-lobj.c.html#LN789"><span class='Ref_To_Local'>tmp</span></a> <span class='Operator'>= </span><a href="win32.h.html#LN13"><span class='Ref_to_Macro'>write</span></a><span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN787"><span class='Ref_To_Local'>fd</span></a><span class='Delimiter'>, </span><a href="fe-lobj.c.html#LN790"><span class='Ref_To_Local'>buf</span></a><span class='Delimiter'>, </span><a href="fe-lobj.c.html#LN788"><span class='Ref_To_Local'>nbytes</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN789"><span class='Ref_To_Local'>tmp</span></a> <span class='Operator'>!= </span><a href="fe-lobj.c.html#LN788"><span class='Ref_To_Local'>nbytes</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* We must do lo_close before setting the errorMessage */ 
</span><a name="LN830"></a>            <span class='Keyword'>int</span>         <span class='Declare_Local'>save_errno</span> <span class='Operator'>= </span>errno<span class='Delimiter'>; 
</span> 
            <span class='Parentheses'>(</span><span class='Keyword'>void</span><span class='Parentheses'>) </span><a href="fe-lobj.c.html#LN98"><span class='Ref_to_Func'>lo_close</span></a><span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN784"><span class='Ref_to_Parameter'>conn</span></a><span class='Delimiter'>, </span><a href="fe-lobj.c.html#LN791"><span class='Ref_To_Local'>lobj</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Parentheses'>(</span><span class='Keyword'>void</span><span class='Parentheses'>) </span><a href="win32.h.html#LN11"><span class='Ref_to_Macro'>close</span></a><span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN787"><span class='Ref_To_Local'>fd</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="pqexpbuffer.c.html#LN232"><span class='Ref_to_Func'>printfPQExpBuffer</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="fe-lobj.c.html#LN784"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN491"><span class='Ref_to_Member'>errorMessage</span></a><span class='Delimiter'>, 
</span>                       <a href="win32.c.html#LN36"><span class='Ref_to_Func'>libpq_gettext</span></a><span class='Parentheses'>(</span><span class='String'>"could not write to file \"%s\": %s\n"</span><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                              <a href="fe-lobj.c.html#LN784"><span class='Ref_to_Parameter'>filename</span></a><span class='Delimiter'>, 
</span>                              <a href="../../port/thread.c.html#LN59"><span class='Ref_to_Func'>pqStrerror</span></a><span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN830"><span class='Ref_To_Local'>save_errno</span></a><span class='Delimiter'>, </span><a href="fe-lobj.c.html#LN792"><span class='Ref_To_Local'>sebuf</span></a><span class='Delimiter'>, </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN792"><span class='Ref_To_Local'>sebuf</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>            <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * If lo_read() failed, we are now in an aborted transaction so there's no 
     * need for lo_close(); furthermore, if we tried it we'd overwrite the 
     * useful error result with a useless one. So skip lo_close() if we got a 
     * failure result. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN788"><span class='Ref_To_Local'>nbytes</span></a> <span class='Operator'>&LT; </span><span class='Number'>0</span> <span class='Operator'>|| 
</span>        <a href="fe-lobj.c.html#LN98"><span class='Ref_to_Func'>lo_close</span></a><span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN784"><span class='Ref_to_Parameter'>conn</span></a><span class='Delimiter'>, </span><a href="fe-lobj.c.html#LN791"><span class='Ref_To_Local'>lobj</span></a><span class='Parentheses'>) </span><span class='Operator'>!= </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* assume lo_read() or lo_close() left a suitable error message */ 
</span>        <a href="fe-lobj.c.html#LN786"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= -</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* if we already failed, don't overwrite that msg with a close error */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="win32.h.html#LN11"><span class='Ref_to_Macro'>close</span></a><span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN787"><span class='Ref_To_Local'>fd</span></a><span class='Parentheses'>) </span><span class='Operator'>&& </span><a href="fe-lobj.c.html#LN786"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>&GT;= </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
    <span class='Delimiter'>{ 
</span>        <a href="pqexpbuffer.c.html#LN232"><span class='Ref_to_Func'>printfPQExpBuffer</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="fe-lobj.c.html#LN784"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN491"><span class='Ref_to_Member'>errorMessage</span></a><span class='Delimiter'>, 
</span>                       <a href="win32.c.html#LN36"><span class='Ref_to_Func'>libpq_gettext</span></a><span class='Parentheses'>(</span><span class='String'>"could not write to file \"%s\": %s\n"</span><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                          <a href="fe-lobj.c.html#LN784"><span class='Ref_to_Parameter'>filename</span></a><span class='Delimiter'>, </span><a href="../../port/thread.c.html#LN59"><span class='Ref_to_Func'>pqStrerror</span></a><span class='Parentheses'>(</span>errno<span class='Delimiter'>, </span><a href="fe-lobj.c.html#LN792"><span class='Ref_To_Local'>sebuf</span></a><span class='Delimiter'>, </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN792"><span class='Ref_To_Local'>sebuf</span></a><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span>        <a href="fe-lobj.c.html#LN786"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= -</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>return</span> <a href="fe-lobj.c.html#LN786"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end lo_export &raquo; </span> 
 
 
<span class='Comment_Multi_Line'>/* 
 * lo_initialize 
 * 
 * Initialize the large object interface for an existing connection. 
 * We ask the backend about the functions OID's in pg_proc for all 
 * functions that are required for large object operations. 
 */ 
</span><span class='Keyword'>static int 
</span><a name="LN876"></a><span class='Declare_Function'>lo_initialize</span><span class='Parentheses'>(</span><a href="libpq-fe.h.html#LN139"><span class='Ref_to_Typedef'>PGconn</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>conn</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN878"></a>    <a href="libpq-fe.h.html#LN146"><span class='Ref_to_Typedef'>PGresult</span></a>   <span class='Operator'>*</span><span class='Declare_Local'>res</span><span class='Delimiter'>; 
</span><a name="LN879"></a>    <a href="libpq-int.h.html#LN264"><span class='Ref_to_Typedef'>PGlobjfuncs</span></a> <span class='Operator'>*</span><span class='Declare_Local'>lobjfuncs</span><span class='Delimiter'>; 
</span><a name="LN880"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>n</span><span class='Delimiter'>; 
</span><a name="LN881"></a>    <span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Local'>query</span><span class='Delimiter'>; 
</span><a name="LN882"></a>    <span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Local'>fname</span><span class='Delimiter'>; 
</span><a name="LN883"></a>    <a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a>         <span class='Declare_Local'>foid</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="fe-lobj.c.html#LN876"><span class='Ref_to_Parameter'>conn</span></a><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Allocate the structure to hold the functions OID's 
     */ 
</span>    <a href="fe-lobj.c.html#LN879"><span class='Ref_To_Local'>lobjfuncs</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="libpq-int.h.html#LN264"><span class='Ref_to_Typedef'>PGlobjfuncs</span></a> <span class='Operator'>*</span><span class='Parentheses'>) </span><a href="../../include/snowball/header.h.html#LN49"><span class='Ref_to_Macro'>malloc</span></a><span class='Parentheses'>(</span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="libpq-int.h.html#LN264"><span class='Ref_to_Typedef'>PGlobjfuncs</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN879"><span class='Ref_To_Local'>lobjfuncs</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="pqexpbuffer.c.html#LN232"><span class='Ref_to_Func'>printfPQExpBuffer</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="fe-lobj.c.html#LN876"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN491"><span class='Ref_to_Member'>errorMessage</span></a><span class='Delimiter'>, 
</span>                          <a href="win32.c.html#LN36"><span class='Ref_to_Func'>libpq_gettext</span></a><span class='Parentheses'>(</span><span class='String'>"out of memory\n"</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <a href="../../include/c.h.html#LN856"><span class='Ref_to_Macro'>MemSet</span></a><span class='Parentheses'>((</span><span class='Keyword'>char </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="fe-lobj.c.html#LN879"><span class='Ref_To_Local'>lobjfuncs</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Delimiter'>, </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="libpq-int.h.html#LN264"><span class='Ref_to_Typedef'>PGlobjfuncs</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Execute the query to get all the functions at once.  In 7.3 and later 
     * we need to be schema-safe.  lo_create only exists in 8.1 and up. 
     * lo_truncate only exists in 8.3 and up. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN876"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN404"><span class='Ref_to_Member'>sversion</span></a> <span class='Operator'>&GT;= </span><span class='Number'>70300</span><span class='Parentheses'>) 
</span>        <a href="fe-lobj.c.html#LN881"><span class='Ref_To_Local'>query</span></a> <span class='Operator'>= </span><span class='String'>"select proname, oid from pg_catalog.pg_proc "</span> 
            <span class='String'>"where proname in ("</span> 
            <span class='String'>"'lo_open', "</span> 
            <span class='String'>"'lo_close', "</span> 
            <span class='String'>"'lo_creat', "</span> 
            <span class='String'>"'lo_create', "</span> 
            <span class='String'>"'lo_unlink', "</span> 
            <span class='String'>"'lo_lseek', "</span> 
            <span class='String'>"'lo_lseek64', "</span> 
            <span class='String'>"'lo_tell', "</span> 
            <span class='String'>"'lo_tell64', "</span> 
            <span class='String'>"'lo_truncate', "</span> 
            <span class='String'>"'lo_truncate64', "</span> 
            <span class='String'>"'loread', "</span> 
            <span class='String'>"'lowrite') "</span> 
            <span class='String'>"and pronamespace = (select oid from pg_catalog.pg_namespace "</span> 
            <span class='String'>"where nspname = 'pg_catalog')"</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
        <a href="fe-lobj.c.html#LN881"><span class='Ref_To_Local'>query</span></a> <span class='Operator'>= </span><span class='String'>"select proname, oid from pg_proc "</span> 
            <span class='String'>"where proname = 'lo_open' "</span> 
            <span class='String'>"or proname = 'lo_close' "</span> 
            <span class='String'>"or proname = 'lo_creat' "</span> 
            <span class='String'>"or proname = 'lo_unlink' "</span> 
            <span class='String'>"or proname = 'lo_lseek' "</span> 
            <span class='String'>"or proname = 'lo_tell' "</span> 
            <span class='String'>"or proname = 'loread' "</span> 
            <span class='String'>"or proname = 'lowrite'"</span><span class='Delimiter'>; 
</span> 
    <a href="fe-lobj.c.html#LN878"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>= </span><a href="libpq-fe.h.html#LN380"><span class='Ref_to_Proto'>PQexec</span></a><span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN876"><span class='Ref_to_Parameter'>conn</span></a><span class='Delimiter'>, </span><a href="fe-lobj.c.html#LN881"><span class='Ref_To_Local'>query</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN878"><span class='Ref_To_Local'>res</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="../../include/snowball/header.h.html#LN64"><span class='Ref_to_Macro'>free</span></a><span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN879"><span class='Ref_To_Local'>lobjfuncs</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN878"><span class='Ref_To_Local'>res</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN176"><span class='Ref_to_Member'>resultStatus</span></a> <span class='Operator'>!= </span><a href="libpq-fe.h.html#LN87"><span class='Ref_to_EnumConst'>PGRES_TUPLES_OK</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="../../include/snowball/header.h.html#LN64"><span class='Ref_to_Macro'>free</span></a><span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN879"><span class='Ref_To_Local'>lobjfuncs</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="libpq-fe.h.html#LN501"><span class='Ref_to_Proto'>PQclear</span></a><span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN878"><span class='Ref_To_Local'>res</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="pqexpbuffer.c.html#LN232"><span class='Ref_to_Func'>printfPQExpBuffer</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="fe-lobj.c.html#LN876"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN491"><span class='Ref_to_Member'>errorMessage</span></a><span class='Delimiter'>, 
</span>                          <a href="win32.c.html#LN36"><span class='Ref_to_Func'>libpq_gettext</span></a><span class='Parentheses'>(</span><span class='String'>"query to initialize large object functions did not return data\n"</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Examine the result and put the OID's into the struct 
     */ 
</span>    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN880"><span class='Ref_To_Local'>n</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="fe-lobj.c.html#LN880"><span class='Ref_To_Local'>n</span></a> <span class='Operator'>&LT; </span><a href="libpq-fe.h.html#LN473"><span class='Ref_to_Proto'>PQntuples</span></a><span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN878"><span class='Ref_To_Local'>res</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; </span><a href="fe-lobj.c.html#LN880"><span class='Ref_To_Local'>n</span></a><span class='Operator'>++</span><span class='Parentheses'>)</span> 
    <span class='Delimiter'>{ 
</span>        <a href="fe-lobj.c.html#LN882"><span class='Ref_To_Local'>fname</span></a> <span class='Operator'>= </span><a href="libpq-fe.h.html#LN488"><span class='Ref_to_Proto'>PQgetvalue</span></a><span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN878"><span class='Ref_To_Local'>res</span></a><span class='Delimiter'>, </span><a href="fe-lobj.c.html#LN880"><span class='Ref_To_Local'>n</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="fe-lobj.c.html#LN883"><span class='Ref_To_Local'>foid</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/postgres_ext.h.html#LN30"><span class='Ref_to_Typedef'>Oid</span></a><span class='Parentheses'>) </span>atoi<span class='Parentheses'>(</span><a href="libpq-fe.h.html#LN488"><span class='Ref_to_Proto'>PQgetvalue</span></a><span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN878"><span class='Ref_To_Local'>res</span></a><span class='Delimiter'>, </span><a href="fe-lobj.c.html#LN880"><span class='Ref_To_Local'>n</span></a><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span>strcmp<span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN882"><span class='Ref_To_Local'>fname</span></a><span class='Delimiter'>, </span><span class='String'>"lo_open"</span><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
            <a href="fe-lobj.c.html#LN879"><span class='Ref_To_Local'>lobjfuncs</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN266"><span class='Ref_to_Member'>fn_lo_open</span></a> <span class='Operator'>= </span><a href="fe-lobj.c.html#LN883"><span class='Ref_To_Local'>foid</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span>strcmp<span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN882"><span class='Ref_To_Local'>fname</span></a><span class='Delimiter'>, </span><span class='String'>"lo_close"</span><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
            <a href="fe-lobj.c.html#LN879"><span class='Ref_To_Local'>lobjfuncs</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN267"><span class='Ref_to_Member'>fn_lo_close</span></a> <span class='Operator'>= </span><a href="fe-lobj.c.html#LN883"><span class='Ref_To_Local'>foid</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span>strcmp<span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN882"><span class='Ref_To_Local'>fname</span></a><span class='Delimiter'>, </span><span class='String'>"lo_creat"</span><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
            <a href="fe-lobj.c.html#LN879"><span class='Ref_To_Local'>lobjfuncs</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN268"><span class='Ref_to_Member'>fn_lo_creat</span></a> <span class='Operator'>= </span><a href="fe-lobj.c.html#LN883"><span class='Ref_To_Local'>foid</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span>strcmp<span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN882"><span class='Ref_To_Local'>fname</span></a><span class='Delimiter'>, </span><span class='String'>"lo_create"</span><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
            <a href="fe-lobj.c.html#LN879"><span class='Ref_To_Local'>lobjfuncs</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN269"><span class='Ref_to_Member'>fn_lo_create</span></a> <span class='Operator'>= </span><a href="fe-lobj.c.html#LN883"><span class='Ref_To_Local'>foid</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span>strcmp<span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN882"><span class='Ref_To_Local'>fname</span></a><span class='Delimiter'>, </span><span class='String'>"lo_unlink"</span><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
            <a href="fe-lobj.c.html#LN879"><span class='Ref_To_Local'>lobjfuncs</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN270"><span class='Ref_to_Member'>fn_lo_unlink</span></a> <span class='Operator'>= </span><a href="fe-lobj.c.html#LN883"><span class='Ref_To_Local'>foid</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span>strcmp<span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN882"><span class='Ref_To_Local'>fname</span></a><span class='Delimiter'>, </span><span class='String'>"lo_lseek"</span><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
            <a href="fe-lobj.c.html#LN879"><span class='Ref_To_Local'>lobjfuncs</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN271"><span class='Ref_to_Member'>fn_lo_lseek</span></a> <span class='Operator'>= </span><a href="fe-lobj.c.html#LN883"><span class='Ref_To_Local'>foid</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span>strcmp<span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN882"><span class='Ref_To_Local'>fname</span></a><span class='Delimiter'>, </span><span class='String'>"lo_lseek64"</span><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
            <a href="fe-lobj.c.html#LN879"><span class='Ref_To_Local'>lobjfuncs</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN272"><span class='Ref_to_Member'>fn_lo_lseek64</span></a> <span class='Operator'>= </span><a href="fe-lobj.c.html#LN883"><span class='Ref_To_Local'>foid</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span>strcmp<span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN882"><span class='Ref_To_Local'>fname</span></a><span class='Delimiter'>, </span><span class='String'>"lo_tell"</span><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
            <a href="fe-lobj.c.html#LN879"><span class='Ref_To_Local'>lobjfuncs</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN273"><span class='Ref_to_Member'>fn_lo_tell</span></a> <span class='Operator'>= </span><a href="fe-lobj.c.html#LN883"><span class='Ref_To_Local'>foid</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span>strcmp<span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN882"><span class='Ref_To_Local'>fname</span></a><span class='Delimiter'>, </span><span class='String'>"lo_tell64"</span><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
            <a href="fe-lobj.c.html#LN879"><span class='Ref_To_Local'>lobjfuncs</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN274"><span class='Ref_to_Member'>fn_lo_tell64</span></a> <span class='Operator'>= </span><a href="fe-lobj.c.html#LN883"><span class='Ref_To_Local'>foid</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span>strcmp<span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN882"><span class='Ref_To_Local'>fname</span></a><span class='Delimiter'>, </span><span class='String'>"lo_truncate"</span><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
            <a href="fe-lobj.c.html#LN879"><span class='Ref_To_Local'>lobjfuncs</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN275"><span class='Ref_to_Member'>fn_lo_truncate</span></a> <span class='Operator'>= </span><a href="fe-lobj.c.html#LN883"><span class='Ref_To_Local'>foid</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span>strcmp<span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN882"><span class='Ref_To_Local'>fname</span></a><span class='Delimiter'>, </span><span class='String'>"lo_truncate64"</span><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
            <a href="fe-lobj.c.html#LN879"><span class='Ref_To_Local'>lobjfuncs</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN276"><span class='Ref_to_Member'>fn_lo_truncate64</span></a> <span class='Operator'>= </span><a href="fe-lobj.c.html#LN883"><span class='Ref_To_Local'>foid</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span>strcmp<span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN882"><span class='Ref_To_Local'>fname</span></a><span class='Delimiter'>, </span><span class='String'>"loread"</span><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
            <a href="fe-lobj.c.html#LN879"><span class='Ref_To_Local'>lobjfuncs</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN277"><span class='Ref_to_Member'>fn_lo_read</span></a> <span class='Operator'>= </span><a href="fe-lobj.c.html#LN883"><span class='Ref_To_Local'>foid</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span>strcmp<span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN882"><span class='Ref_To_Local'>fname</span></a><span class='Delimiter'>, </span><span class='String'>"lowrite"</span><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
            <a href="fe-lobj.c.html#LN879"><span class='Ref_To_Local'>lobjfuncs</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN278"><span class='Ref_to_Member'>fn_lo_write</span></a> <span class='Operator'>= </span><a href="fe-lobj.c.html#LN883"><span class='Ref_To_Local'>foid</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end for n=0;n&LT;PQntuples(res);... &raquo; </span> 
 
    <a href="libpq-fe.h.html#LN501"><span class='Ref_to_Proto'>PQclear</span></a><span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN878"><span class='Ref_To_Local'>res</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Finally check that we got all required large object interface functions 
     * (ones that have been added later than the stone age are instead checked 
     * only if used) 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN879"><span class='Ref_To_Local'>lobjfuncs</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN266"><span class='Ref_to_Member'>fn_lo_open</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="pqexpbuffer.c.html#LN232"><span class='Ref_to_Func'>printfPQExpBuffer</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="fe-lobj.c.html#LN876"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN491"><span class='Ref_to_Member'>errorMessage</span></a><span class='Delimiter'>, 
</span>                <a href="win32.c.html#LN36"><span class='Ref_to_Func'>libpq_gettext</span></a><span class='Parentheses'>(</span><span class='String'>"cannot determine OID of function lo_open\n"</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <a href="../../include/snowball/header.h.html#LN64"><span class='Ref_to_Macro'>free</span></a><span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN879"><span class='Ref_To_Local'>lobjfuncs</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN879"><span class='Ref_To_Local'>lobjfuncs</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN267"><span class='Ref_to_Member'>fn_lo_close</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="pqexpbuffer.c.html#LN232"><span class='Ref_to_Func'>printfPQExpBuffer</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="fe-lobj.c.html#LN876"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN491"><span class='Ref_to_Member'>errorMessage</span></a><span class='Delimiter'>, 
</span>               <a href="win32.c.html#LN36"><span class='Ref_to_Func'>libpq_gettext</span></a><span class='Parentheses'>(</span><span class='String'>"cannot determine OID of function lo_close\n"</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <a href="../../include/snowball/header.h.html#LN64"><span class='Ref_to_Macro'>free</span></a><span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN879"><span class='Ref_To_Local'>lobjfuncs</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN879"><span class='Ref_To_Local'>lobjfuncs</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN268"><span class='Ref_to_Member'>fn_lo_creat</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="pqexpbuffer.c.html#LN232"><span class='Ref_to_Func'>printfPQExpBuffer</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="fe-lobj.c.html#LN876"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN491"><span class='Ref_to_Member'>errorMessage</span></a><span class='Delimiter'>, 
</span>               <a href="win32.c.html#LN36"><span class='Ref_to_Func'>libpq_gettext</span></a><span class='Parentheses'>(</span><span class='String'>"cannot determine OID of function lo_creat\n"</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <a href="../../include/snowball/header.h.html#LN64"><span class='Ref_to_Macro'>free</span></a><span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN879"><span class='Ref_To_Local'>lobjfuncs</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN879"><span class='Ref_To_Local'>lobjfuncs</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN270"><span class='Ref_to_Member'>fn_lo_unlink</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="pqexpbuffer.c.html#LN232"><span class='Ref_to_Func'>printfPQExpBuffer</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="fe-lobj.c.html#LN876"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN491"><span class='Ref_to_Member'>errorMessage</span></a><span class='Delimiter'>, 
</span>              <a href="win32.c.html#LN36"><span class='Ref_to_Func'>libpq_gettext</span></a><span class='Parentheses'>(</span><span class='String'>"cannot determine OID of function lo_unlink\n"</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <a href="../../include/snowball/header.h.html#LN64"><span class='Ref_to_Macro'>free</span></a><span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN879"><span class='Ref_To_Local'>lobjfuncs</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN879"><span class='Ref_To_Local'>lobjfuncs</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN271"><span class='Ref_to_Member'>fn_lo_lseek</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="pqexpbuffer.c.html#LN232"><span class='Ref_to_Func'>printfPQExpBuffer</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="fe-lobj.c.html#LN876"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN491"><span class='Ref_to_Member'>errorMessage</span></a><span class='Delimiter'>, 
</span>               <a href="win32.c.html#LN36"><span class='Ref_to_Func'>libpq_gettext</span></a><span class='Parentheses'>(</span><span class='String'>"cannot determine OID of function lo_lseek\n"</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <a href="../../include/snowball/header.h.html#LN64"><span class='Ref_to_Macro'>free</span></a><span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN879"><span class='Ref_To_Local'>lobjfuncs</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN879"><span class='Ref_To_Local'>lobjfuncs</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN273"><span class='Ref_to_Member'>fn_lo_tell</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="pqexpbuffer.c.html#LN232"><span class='Ref_to_Func'>printfPQExpBuffer</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="fe-lobj.c.html#LN876"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN491"><span class='Ref_to_Member'>errorMessage</span></a><span class='Delimiter'>, 
</span>                <a href="win32.c.html#LN36"><span class='Ref_to_Func'>libpq_gettext</span></a><span class='Parentheses'>(</span><span class='String'>"cannot determine OID of function lo_tell\n"</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <a href="../../include/snowball/header.h.html#LN64"><span class='Ref_to_Macro'>free</span></a><span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN879"><span class='Ref_To_Local'>lobjfuncs</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN879"><span class='Ref_To_Local'>lobjfuncs</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN277"><span class='Ref_to_Member'>fn_lo_read</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="pqexpbuffer.c.html#LN232"><span class='Ref_to_Func'>printfPQExpBuffer</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="fe-lobj.c.html#LN876"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN491"><span class='Ref_to_Member'>errorMessage</span></a><span class='Delimiter'>, 
</span>                 <a href="win32.c.html#LN36"><span class='Ref_to_Func'>libpq_gettext</span></a><span class='Parentheses'>(</span><span class='String'>"cannot determine OID of function loread\n"</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <a href="../../include/snowball/header.h.html#LN64"><span class='Ref_to_Macro'>free</span></a><span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN879"><span class='Ref_To_Local'>lobjfuncs</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN879"><span class='Ref_To_Local'>lobjfuncs</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN278"><span class='Ref_to_Member'>fn_lo_write</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="pqexpbuffer.c.html#LN232"><span class='Ref_to_Func'>printfPQExpBuffer</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="fe-lobj.c.html#LN876"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN491"><span class='Ref_to_Member'>errorMessage</span></a><span class='Delimiter'>, 
</span>                <a href="win32.c.html#LN36"><span class='Ref_to_Func'>libpq_gettext</span></a><span class='Parentheses'>(</span><span class='String'>"cannot determine OID of function lowrite\n"</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>        <a href="../../include/snowball/header.h.html#LN64"><span class='Ref_to_Macro'>free</span></a><span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN879"><span class='Ref_To_Local'>lobjfuncs</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Put the structure into the connection control 
     */ 
</span>    <a href="fe-lobj.c.html#LN876"><span class='Ref_to_Parameter'>conn</span></a><span class='Operator'>-&GT;</span><a href="libpq-int.h.html#LN426"><span class='Ref_to_Member'>lobjfuncs</span></a> <span class='Operator'>= </span><a href="fe-lobj.c.html#LN879"><span class='Ref_To_Local'>lobjfuncs</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <span class='Number'>0</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end lo_initialize &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * lo_hton64 
 *    converts a 64-bit integer from host byte order to network byte order 
 */ 
</span><span class='Keyword'>static </span><a href="../../include/postgres_ext.h.html#LN46"><span class='Ref_to_Typedef'>pg_int64</span></a> 
<a name="LN1061"></a><span class='Declare_Function'>lo_hton64</span><span class='Parentheses'>(</span><a href="../../include/postgres_ext.h.html#LN46"><span class='Ref_to_Typedef'>pg_int64</span></a> <span class='Declare_Parameter'>host64</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>union</span> 
    <span class='Delimiter'>{ 
</span><a name="LN1065"></a>        <a href="../../include/postgres_ext.h.html#LN46"><span class='Ref_to_Typedef'>pg_int64</span></a>    <span class='Declare_Member'>i64</span><span class='Delimiter'>; 
</span><a name="LN1066"></a>        <a href="../../include/c.h.html#LN267"><span class='Ref_to_Typedef'>uint32</span></a>      <span class='Declare_Member'>i32</span><span class='Delimiter'>[</span><span class='Number'>2</span><span class='Delimiter'>]; 
</span><a name="LN1067"></a>    <span class='Delimiter'>}</span>           <span class='Declare_Local'>swap</span><span class='Delimiter'>; 
</span><a name="LN1068"></a>    <a href="../../include/c.h.html#LN267"><span class='Ref_to_Typedef'>uint32</span></a>      <span class='Declare_Local'>t</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* High order half first, since we're doing MSB-first */ 
</span>    <a href="fe-lobj.c.html#LN1068"><span class='Ref_To_Local'>t</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/c.h.html#LN267"><span class='Ref_to_Typedef'>uint32</span></a><span class='Parentheses'>) (</span><a href="fe-lobj.c.html#LN1061"><span class='Ref_to_Parameter'>host64</span></a> <span class='Operator'>&GT;&GT; </span><span class='Number'>32</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="fe-lobj.c.html#LN1067"><span class='Ref_To_Local'>swap</span></a><span class='Operator'>.</span><a href="fe-lobj.c.html#LN1066"><span class='Ref_to_Member'>i32</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>] </span><span class='Operator'>= </span>htonl<span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN1068"><span class='Ref_To_Local'>t</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Now the low order half */ 
</span>    <a href="fe-lobj.c.html#LN1068"><span class='Ref_To_Local'>t</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/c.h.html#LN267"><span class='Ref_to_Typedef'>uint32</span></a><span class='Parentheses'>) </span><a href="fe-lobj.c.html#LN1061"><span class='Ref_to_Parameter'>host64</span></a><span class='Delimiter'>; 
</span>    <a href="fe-lobj.c.html#LN1067"><span class='Ref_To_Local'>swap</span></a><span class='Operator'>.</span><a href="fe-lobj.c.html#LN1066"><span class='Ref_to_Member'>i32</span></a><span class='Delimiter'>[</span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span>htonl<span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN1068"><span class='Ref_To_Local'>t</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="fe-lobj.c.html#LN1067"><span class='Ref_To_Local'>swap</span></a><span class='Operator'>.</span><a href="fe-lobj.c.html#LN1065"><span class='Ref_to_Member'>i64</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end lo_hton64 &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * lo_ntoh64 
 *    converts a 64-bit integer from network byte order to host byte order 
 */ 
</span><span class='Keyword'>static </span><a href="../../include/postgres_ext.h.html#LN46"><span class='Ref_to_Typedef'>pg_int64</span></a> 
<a name="LN1086"></a><span class='Declare_Function'>lo_ntoh64</span><span class='Parentheses'>(</span><a href="../../include/postgres_ext.h.html#LN46"><span class='Ref_to_Typedef'>pg_int64</span></a> <span class='Declare_Parameter'>net64</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>union</span> 
    <span class='Delimiter'>{ 
</span><a name="LN1090"></a>        <a href="../../include/postgres_ext.h.html#LN46"><span class='Ref_to_Typedef'>pg_int64</span></a>    <span class='Declare_Member'>i64</span><span class='Delimiter'>; 
</span><a name="LN1091"></a>        <a href="../../include/c.h.html#LN267"><span class='Ref_to_Typedef'>uint32</span></a>      <span class='Declare_Member'>i32</span><span class='Delimiter'>[</span><span class='Number'>2</span><span class='Delimiter'>]; 
</span><a name="LN1092"></a>    <span class='Delimiter'>}</span>           <span class='Declare_Local'>swap</span><span class='Delimiter'>; 
</span><a name="LN1093"></a>    <a href="../../include/postgres_ext.h.html#LN46"><span class='Ref_to_Typedef'>pg_int64</span></a>    <span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span> 
    <a href="fe-lobj.c.html#LN1092"><span class='Ref_To_Local'>swap</span></a><span class='Operator'>.</span><a href="fe-lobj.c.html#LN1090"><span class='Ref_to_Member'>i64</span></a> <span class='Operator'>= </span><a href="fe-lobj.c.html#LN1086"><span class='Ref_to_Parameter'>net64</span></a><span class='Delimiter'>; 
</span> 
    <a href="fe-lobj.c.html#LN1093"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../../include/c.h.html#LN267"><span class='Ref_to_Typedef'>uint32</span></a><span class='Parentheses'>) </span>ntohl<span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN1092"><span class='Ref_To_Local'>swap</span></a><span class='Operator'>.</span><a href="fe-lobj.c.html#LN1091"><span class='Ref_to_Member'>i32</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>]</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="fe-lobj.c.html#LN1093"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>&LT;&LT;= </span><span class='Number'>32</span><span class='Delimiter'>; 
</span>    <a href="fe-lobj.c.html#LN1093"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>|= </span><span class='Parentheses'>(</span><a href="../../include/c.h.html#LN267"><span class='Ref_to_Typedef'>uint32</span></a><span class='Parentheses'>) </span>ntohl<span class='Parentheses'>(</span><a href="fe-lobj.c.html#LN1092"><span class='Ref_To_Local'>swap</span></a><span class='Operator'>.</span><a href="fe-lobj.c.html#LN1091"><span class='Ref_to_Member'>i32</span></a><span class='Delimiter'>[</span><span class='Number'>1</span><span class='Delimiter'>]</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="fe-lobj.c.html#LN1093"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>; 
} 
</span></pre>
<table bgcolor='#c0c0c0' width='100%'><tr><td><a href='../../../Contents.html'>Contents</a></td></tr>
</table><hr><p class='blurb' align='center'><a href='http://www.sourceinsight.com'>HTML Created by Source Insight Version 4.00.0084 Built on 2017-02-26</a></p>
</body></html>