<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta name="generator" content="Source Insight Version 4.00.0084 Built on 2017-02-26">
<meta charset='UTF-8' />
<style type='text/css'><!--
TD {background-color: #C0C0C0; font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 70%; }
.blurb {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 70%; }
.filename {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 120%; font-weight: bold; }
.dirname {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 100%; font-weight: bold; margin-top: 2.5em;}
--></style>
<title>src\port\path.c</title>
<LINK REL=StyleSheet HREF="../../C_Cpp_Source_File.css" TYPE='text/css' MEDIA=screen>
</head>
<body bgcolor=#ffffff>
<table bgcolor='#c0c0c0' width='100%'>
<tr><td><p class='filename'><b>src\port\path.c</b></p></td>
<td align='right'>
Wed Jun 14 08:26:14 2017
</td></tr>
<tr><td><a href='../../Contents.html'>Contents</a></td></tr>
</table>
<pre>
<span class='Comment_Multi_Line'>/*------------------------------------------------------------------------- 
 * 
 * path.c 
 *    portable path handling routines 
 * 
 * Portions Copyright (c) 1996-2017, PostgreSQL Global Development Group 
 * Portions Copyright (c) 1994, Regents of the University of California 
 * 
 * 
 * IDENTIFICATION 
 *    src/port/path.c 
 * 
 *------------------------------------------------------------------------- 
 */ 
</span> 
<span class='Directive'>#ifndef</span> <a href="../bin/pg_waldump/rmgrdesc.c.html#LN7"><span class='Ref_to_Const'>FRONTEND</span></a> 
<span class='Keyword'>#include </span><span class='String'>"postgres.h"</span> 
<span class='Directive'>#else</span> 
<span class='Keyword'>#include </span><span class='String'>"postgres_fe.h"</span> 
<span class='Directive'>#endif</span> 
 
<span class='Keyword'>#include </span><span class='String'>&LT;ctype.h&GT;</span> 
<span class='Keyword'>#include </span><span class='String'>&LT;sys/stat.h&GT;</span> 
<span class='Directive'>#ifdef</span> <a href="../include/c.h.html#LN61"><span class='Ref_to_Const'>WIN32</span></a> 
<span class='Directive'>#ifdef</span> <a href="path.c.html#LN27"><span class='Ref_to_Const'>_WIN32_IE</span></a> 
<span class='Keyword'>#undef </span><a href="path.c.html#LN27"><span class='Ref_to_Const'>_WIN32_IE</span></a> 
<span class='Directive'>#endif</span> 
<a name="LN27"></a><span class='Keyword'>#define </span><span class='Declare_Constant'>_WIN32_IE</span> <span class='Number'>0x0500</span> 
<span class='Directive'>#ifdef</span> <span class='Keyword'>near 
#undef near 
</span><span class='Directive'>#endif</span> 
<a name="LN31"></a><span class='Keyword'>#define </span><span class='Declare_Constant'>near</span> 
<span class='Keyword'>#include </span><span class='String'>&LT;shlobj.h&GT;</span> 
<span class='Directive'>#else</span> 
<span class='Keyword'>#include </span><span class='String'>&LT;unistd.h&GT;</span> 
<span class='Directive'>#endif</span> 
 
<span class='Keyword'>#include </span><span class='String'>"pg_config_paths.h"</span> 
 
 
<span class='Directive'>#ifndef</span> <a href="../include/c.h.html#LN61"><span class='Ref_to_Const'>WIN32</span></a> 
<a name="LN41"></a><span class='Keyword'>#define </span><span class='Declare_Macro'>IS_PATH_VAR_SEP</span><span class='Parentheses'>(</span><span class='Declare_Parameter'>ch</span><span class='Parentheses'>) ((</span><a href="path.c.html#LN41"><span class='Ref_to_Parameter'>ch</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='String'>':'</span><span class='Parentheses'>)</span> 
<span class='Directive'>#else</span> 
<a name="LN43"></a><span class='Keyword'>#define </span><span class='Declare_Macro'>IS_PATH_VAR_SEP</span><span class='Parentheses'>(</span><span class='Declare_Parameter'>ch</span><span class='Parentheses'>) ((</span><a href="path.c.html#LN43"><span class='Ref_to_Parameter'>ch</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='String'>';'</span><span class='Parentheses'>)</span> 
<span class='Directive'>#endif</span> 
 
<a name="LN46"></a><span class='Keyword'>static void </span><span class='Declare_Prototype'>make_relative_path</span><span class='Parentheses'>(</span><span class='Keyword'>char </span><span class='Operator'>*</span><span class='Declare_Parameter'>ret_path</span><span class='Delimiter'>, </span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>target_path</span><span class='Delimiter'>, 
</span><a name="LN47"></a>                   <span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>bin_path</span><span class='Delimiter'>, </span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>my_exec_path</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN48"></a><span class='Keyword'>static void </span><span class='Declare_Prototype'>trim_directory</span><span class='Parentheses'>(</span><span class='Keyword'>char </span><span class='Operator'>*</span><span class='Declare_Parameter'>path</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN49"></a><span class='Keyword'>static void </span><span class='Declare_Prototype'>trim_trailing_separator</span><span class='Parentheses'>(</span><span class='Keyword'>char </span><span class='Operator'>*</span><span class='Declare_Parameter'>path</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
 
<span class='Comment_Multi_Line'>/* 
 * skip_drive 
 * 
 * On Windows, a path may begin with "C:" or "//network/".  Advance over 
 * this and point to the effective start of the path. 
 */ 
</span><span class='Directive'>#ifdef</span> <a href="../include/c.h.html#LN61"><span class='Ref_to_Const'>WIN32</span></a> 
 
<span class='Keyword'>static char </span><span class='Operator'>* 
</span><a name="LN61"></a><span class='Declare_Function'>skip_drive</span><span class='Parentheses'>(</span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>path</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../include/port.h.html#LN74"><span class='Ref_to_Macro'>IS_DIR_SEP</span></a><span class='Parentheses'>(</span><a href="path.c.html#LN61"><span class='Ref_to_Parameter'>path</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>]</span><span class='Parentheses'>) </span><span class='Operator'>&& </span><a href="../include/port.h.html#LN74"><span class='Ref_to_Macro'>IS_DIR_SEP</span></a><span class='Parentheses'>(</span><a href="path.c.html#LN61"><span class='Ref_to_Parameter'>path</span></a><span class='Delimiter'>[</span><span class='Number'>1</span><span class='Delimiter'>]</span><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span>        <a href="path.c.html#LN61"><span class='Ref_to_Parameter'>path</span></a> <span class='Operator'>+= </span><span class='Number'>2</span><span class='Delimiter'>; 
</span>        <span class='Control'>while</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="path.c.html#LN61"><span class='Ref_to_Parameter'>path</span></a> <span class='Operator'>&& !</span><a href="../include/port.h.html#LN74"><span class='Ref_to_Macro'>IS_DIR_SEP</span></a><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="path.c.html#LN61"><span class='Ref_to_Parameter'>path</span></a><span class='Parentheses'>))</span> 
            <a href="path.c.html#LN61"><span class='Ref_to_Parameter'>path</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span>isalpha<span class='Parentheses'>((</span><span class='Keyword'>unsigned char</span><span class='Parentheses'>) </span><a href="path.c.html#LN61"><span class='Ref_to_Parameter'>path</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>]</span><span class='Parentheses'>)</span> <span class='Operator'>&& </span><a href="path.c.html#LN61"><span class='Ref_to_Parameter'>path</span></a><span class='Delimiter'>[</span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>== </span><span class='String'>':'</span><span class='Parentheses'>)</span> 
    <span class='Delimiter'>{ 
</span>        <a href="path.c.html#LN61"><span class='Ref_to_Parameter'>path</span></a> <span class='Operator'>+= </span><span class='Number'>2</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>return</span> <span class='Parentheses'>(</span><span class='Keyword'>char </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="path.c.html#LN61"><span class='Ref_to_Parameter'>path</span></a><span class='Delimiter'>; 
} 
</span><span class='Directive'>#else</span> 
 
<a name="LN77"></a><span class='Keyword'>#define </span><span class='Declare_Macro'>skip_drive</span><span class='Parentheses'>(</span><span class='Declare_Parameter'>path</span><span class='Parentheses'>)</span>    <span class='Parentheses'>(</span><a href="path.c.html#LN77"><span class='Ref_to_Parameter'>path</span></a><span class='Parentheses'>) 
</span><span class='Directive'>#endif</span> 
 
<span class='Comment_Multi_Line'>/* 
 *  has_drive_prefix 
 * 
 * Return true if the given pathname has a drive prefix. 
 */ 
</span><span class='Keyword'>bool 
</span><a name="LN86"></a><span class='Declare_Function'>has_drive_prefix</span><span class='Parentheses'>(</span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>path</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><span class='Directive'>#ifdef</span> <a href="../include/c.h.html#LN61"><span class='Ref_to_Const'>WIN32</span></a> 
    <span class='Control'>return</span> <a href="path.c.html#LN60"><span class='Ref_to_Func'>skip_drive</span></a><span class='Parentheses'>(</span><a href="path.c.html#LN86"><span class='Ref_to_Parameter'>path</span></a><span class='Parentheses'>) </span><span class='Operator'>!= </span><a href="path.c.html#LN86"><span class='Ref_to_Parameter'>path</span></a><span class='Delimiter'>; 
</span><span class='Directive'>#else</span> 
    <span class='Control'>return</span> <span class='Boolean'>false</span><span class='Delimiter'>; 
</span><span class='Directive'>#endif</span> 
<span class='Delimiter'>} 
</span> 
<span class='Comment_Multi_Line'>/* 
 *  first_dir_separator 
 * 
 * Find the location of the first directory separator, return 
 * NULL if not found. 
 */ 
</span><span class='Keyword'>char </span><span class='Operator'>* 
</span><a name="LN102"></a><span class='Declare_Function'>first_dir_separator</span><span class='Parentheses'>(</span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>filename</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN104"></a>    <span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Local'>p</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="path.c.html#LN104"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>= </span><a href="path.c.html#LN60"><span class='Ref_to_Func'>skip_drive</span></a><span class='Parentheses'>(</span><a href="path.c.html#LN102"><span class='Ref_to_Parameter'>filename</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; </span><span class='Operator'>*</span><a href="path.c.html#LN104"><span class='Ref_To_Local'>p</span></a><span class='Delimiter'>; </span><a href="path.c.html#LN104"><span class='Ref_To_Local'>p</span></a><span class='Operator'>++</span><span class='Parentheses'>)</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../include/port.h.html#LN74"><span class='Ref_to_Macro'>IS_DIR_SEP</span></a><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="path.c.html#LN104"><span class='Ref_To_Local'>p</span></a><span class='Parentheses'>))</span> 
            <span class='Control'>return</span> <span class='Parentheses'>(</span><span class='Keyword'>char </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="path.c.html#LN104"><span class='Ref_To_Local'>p</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <span class='Null_Value'>NULL</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 *  first_path_var_separator 
 * 
 * Find the location of the first path separator (i.e. ':' on 
 * Unix, ';' on Windows), return NULL if not found. 
 */ 
</span><span class='Keyword'>char </span><span class='Operator'>* 
</span><a name="LN119"></a><span class='Declare_Function'>first_path_var_separator</span><span class='Parentheses'>(</span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>pathlist</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN121"></a>    <span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Local'>p</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* skip_drive is not needed */ 
</span>    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="path.c.html#LN121"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>= </span><a href="path.c.html#LN119"><span class='Ref_to_Parameter'>pathlist</span></a><span class='Delimiter'>; </span><span class='Operator'>*</span><a href="path.c.html#LN121"><span class='Ref_To_Local'>p</span></a><span class='Delimiter'>; </span><a href="path.c.html#LN121"><span class='Ref_To_Local'>p</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="path.c.html#LN41"><span class='Ref_to_Macro'>IS_PATH_VAR_SEP</span></a><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="path.c.html#LN121"><span class='Ref_To_Local'>p</span></a><span class='Parentheses'>))</span> 
            <span class='Control'>return</span> <span class='Parentheses'>(</span><span class='Keyword'>char </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="path.c.html#LN121"><span class='Ref_To_Local'>p</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <span class='Null_Value'>NULL</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 *  last_dir_separator 
 * 
 * Find the location of the last directory separator, return 
 * NULL if not found. 
 */ 
</span><span class='Keyword'>char </span><span class='Operator'>* 
</span><a name="LN137"></a><span class='Declare_Function'>last_dir_separator</span><span class='Parentheses'>(</span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>filename</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN139"></a>    <span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Local'>p</span><span class='Delimiter'>, 
</span><a name="LN140"></a>               <span class='Operator'>*</span><span class='Declare_Local'>ret</span> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="path.c.html#LN139"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>= </span><a href="path.c.html#LN60"><span class='Ref_to_Func'>skip_drive</span></a><span class='Parentheses'>(</span><a href="path.c.html#LN137"><span class='Ref_to_Parameter'>filename</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; </span><span class='Operator'>*</span><a href="path.c.html#LN139"><span class='Ref_To_Local'>p</span></a><span class='Delimiter'>; </span><a href="path.c.html#LN139"><span class='Ref_To_Local'>p</span></a><span class='Operator'>++</span><span class='Parentheses'>)</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../include/port.h.html#LN74"><span class='Ref_to_Macro'>IS_DIR_SEP</span></a><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="path.c.html#LN139"><span class='Ref_To_Local'>p</span></a><span class='Parentheses'>))</span> 
            <a href="path.c.html#LN140"><span class='Ref_To_Local'>ret</span></a> <span class='Operator'>= </span><a href="path.c.html#LN139"><span class='Ref_To_Local'>p</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <span class='Parentheses'>(</span><span class='Keyword'>char </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="path.c.html#LN140"><span class='Ref_To_Local'>ret</span></a><span class='Delimiter'>; 
} 
</span> 
 
<span class='Comment_Multi_Line'>/* 
 *  make_native_path - on WIN32, change / to \ in the path 
 * 
 *  This effectively undoes canonicalize_path. 
 * 
 *  This is required because WIN32 COPY is an internal CMD.EXE 
 *  command and doesn't process forward slashes in the same way 
 *  as external commands.  Quoting the first argument to COPY 
 *  does not convert forward to backward slashes, but COPY does 
 *  properly process quoted forward slashes in the second argument. 
 * 
 *  COPY works with quoted forward slashes in the first argument 
 *  only if the current directory is the same as the directory 
 *  of the first argument. 
 */ 
</span><span class='Keyword'>void 
</span><a name="LN165"></a><span class='Declare_Function'>make_native_path</span><span class='Parentheses'>(</span><span class='Keyword'>char </span><span class='Operator'>*</span><span class='Declare_Parameter'>filename</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><span class='Directive'>#ifdef</span> <a href="../include/c.h.html#LN61"><span class='Ref_to_Const'>WIN32</span></a> 
<a name="LN168"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>p</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="path.c.html#LN168"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>= </span><a href="path.c.html#LN165"><span class='Ref_to_Parameter'>filename</span></a><span class='Delimiter'>; </span><span class='Operator'>*</span><a href="path.c.html#LN168"><span class='Ref_To_Local'>p</span></a><span class='Delimiter'>; </span><a href="path.c.html#LN168"><span class='Ref_To_Local'>p</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="path.c.html#LN168"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>== </span><span class='String'>'/'</span><span class='Parentheses'>) 
</span>            <span class='Operator'>*</span><a href="path.c.html#LN168"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>= </span><span class='String'>'\\'</span><span class='Delimiter'>; 
</span><span class='Directive'>#endif</span> 
<span class='Delimiter'>} 
</span> 
 
<span class='Comment_Multi_Line'>/* 
 * This function cleans up the paths for use with either cmd.exe or Msys 
 * on Windows. We need them to use filenames without spaces, for which a 
 * short filename is the safest equivalent, eg: 
 *      C:/Progra~1/ 
 */ 
</span><span class='Keyword'>void 
</span><a name="LN184"></a><span class='Declare_Function'>cleanup_path</span><span class='Parentheses'>(</span><span class='Keyword'>char </span><span class='Operator'>*</span><span class='Declare_Parameter'>path</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><span class='Directive'>#ifdef</span> <a href="../include/c.h.html#LN61"><span class='Ref_to_Const'>WIN32</span></a> 
<a name="LN187"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>ptr</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * GetShortPathName() will fail if the path does not exist, or short names 
     * are disabled on this file system.  In both cases, we just return the 
     * original path.  This is particularly useful for --sysconfdir, which 
     * might not exist. 
     */ 
</span>    GetShortPathName<span class='Parentheses'>(</span><a href="path.c.html#LN184"><span class='Ref_to_Parameter'>path</span></a><span class='Delimiter'>, </span><a href="path.c.html#LN184"><span class='Ref_to_Parameter'>path</span></a><span class='Delimiter'>, </span><a href="../include/pg_config_manual.h.html#LN88"><span class='Ref_to_Const'>MAXPGPATH</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Replace '\' with '/' */ 
</span>    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="path.c.html#LN187"><span class='Ref_To_Local'>ptr</span></a> <span class='Operator'>= </span><a href="path.c.html#LN184"><span class='Ref_to_Parameter'>path</span></a><span class='Delimiter'>; </span><span class='Operator'>*</span><a href="path.c.html#LN187"><span class='Ref_To_Local'>ptr</span></a><span class='Delimiter'>; </span><a href="path.c.html#LN187"><span class='Ref_To_Local'>ptr</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="path.c.html#LN187"><span class='Ref_To_Local'>ptr</span></a> <span class='Operator'>== </span><span class='String'>'\\'</span><span class='Parentheses'>) 
</span>            <span class='Operator'>*</span><a href="path.c.html#LN187"><span class='Ref_To_Local'>ptr</span></a> <span class='Operator'>= </span><span class='String'>'/'</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span><span class='Directive'>#endif</span> 
<span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end cleanup_path &raquo; </span> 
 
 
<span class='Comment_Multi_Line'>/* 
 * join_path_components - join two path components, inserting a slash 
 * 
 * We omit the slash if either given component is empty. 
 * 
 * ret_path is the output area (must be of size MAXPGPATH) 
 * 
 * ret_path can be the same as head, but not the same as tail. 
 */ 
</span><span class='Keyword'>void 
</span><a name="LN217"></a><span class='Declare_Function'>join_path_components</span><span class='Parentheses'>(</span><span class='Keyword'>char </span><span class='Operator'>*</span><span class='Declare_Parameter'>ret_path</span><span class='Delimiter'>, 
</span><a name="LN218"></a>                     <span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>head</span><span class='Delimiter'>, </span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>tail</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="path.c.html#LN217"><span class='Ref_to_Parameter'>ret_path</span></a> <span class='Operator'>!= </span><a href="path.c.html#LN218"><span class='Ref_to_Parameter'>head</span></a><span class='Parentheses'>) 
</span>        <a href="strlcpy.c.html#LN43"><span class='Ref_to_Func'>strlcpy</span></a><span class='Parentheses'>(</span><a href="path.c.html#LN217"><span class='Ref_to_Parameter'>ret_path</span></a><span class='Delimiter'>, </span><a href="path.c.html#LN218"><span class='Ref_to_Parameter'>head</span></a><span class='Delimiter'>, </span><a href="../include/pg_config_manual.h.html#LN88"><span class='Ref_to_Const'>MAXPGPATH</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Remove any leading "." in the tail component. 
     * 
     * Note: we used to try to remove ".." as well, but that's tricky to get 
     * right; now we just leave it to be done by canonicalize_path() later. 
     */ 
</span>    <span class='Control'>while</span> <span class='Parentheses'>(</span><a href="path.c.html#LN218"><span class='Ref_to_Parameter'>tail</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>] </span><span class='Operator'>== </span><span class='String'>'.'</span> <span class='Operator'>&& </span><a href="../include/port.h.html#LN74"><span class='Ref_to_Macro'>IS_DIR_SEP</span></a><span class='Parentheses'>(</span><a href="path.c.html#LN218"><span class='Ref_to_Parameter'>tail</span></a><span class='Delimiter'>[</span><span class='Number'>1</span><span class='Delimiter'>]</span><span class='Parentheses'>))</span> 
        <a href="path.c.html#LN218"><span class='Ref_to_Parameter'>tail</span></a> <span class='Operator'>+= </span><span class='Number'>2</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="path.c.html#LN218"><span class='Ref_to_Parameter'>tail</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* only separate with slash if head wasn't empty */ 
</span>        <a href="../pl/plperl/plperl.h.html#LN60"><span class='Ref_to_Macro'>snprintf</span></a><span class='Parentheses'>(</span><a href="path.c.html#LN217"><span class='Ref_to_Parameter'>ret_path</span></a> <span class='Operator'>+ </span>strlen<span class='Parentheses'>(</span><a href="path.c.html#LN217"><span class='Ref_to_Parameter'>ret_path</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="../include/pg_config_manual.h.html#LN88"><span class='Ref_to_Const'>MAXPGPATH</span></a> <span class='Operator'>- </span>strlen<span class='Parentheses'>(</span><a href="path.c.html#LN217"><span class='Ref_to_Parameter'>ret_path</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                 <span class='String'>"%s%s"</span><span class='Delimiter'>, 
</span>                 <span class='Parentheses'>(</span><span class='Operator'>*</span><span class='Parentheses'>(</span><a href="path.c.html#LN60"><span class='Ref_to_Func'>skip_drive</span></a><span class='Parentheses'>(</span><a href="path.c.html#LN218"><span class='Ref_to_Parameter'>head</span></a><span class='Parentheses'>))</span> <span class='Operator'>!= </span><span class='String'>'\0'</span><span class='Parentheses'>)</span> <span class='Operator'>? </span><span class='String'>"/"</span> <span class='Operator'>: </span><span class='String'>""</span><span class='Delimiter'>, 
</span>                 <a href="path.c.html#LN218"><span class='Ref_to_Parameter'>tail</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
}</span><span class='Auto_Annotations'> &laquo; end join_path_components &raquo; </span> 
 
 
<span class='Comment_Multi_Line'>/* 
 *  Clean up path by: 
 *      o  make Win32 path use Unix slashes 
 *      o  remove trailing quote on Win32 
 *      o  remove trailing slash 
 *      o  remove duplicate adjacent separators 
 *      o  remove trailing '.' 
 *      o  process trailing '..' ourselves 
 */ 
</span><span class='Keyword'>void 
</span><a name="LN253"></a><span class='Declare_Function'>canonicalize_path</span><span class='Parentheses'>(</span><span class='Keyword'>char </span><span class='Operator'>*</span><span class='Declare_Parameter'>path</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN255"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>p</span><span class='Delimiter'>, 
</span><a name="LN256"></a>               <span class='Operator'>*</span><span class='Declare_Local'>to_p</span><span class='Delimiter'>; 
</span><a name="LN257"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>spath</span><span class='Delimiter'>; 
</span><a name="LN258"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>was_sep</span> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span><a name="LN259"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>pending_strips</span><span class='Delimiter'>; 
</span> 
<span class='Directive'>#ifdef</span> <a href="../include/c.h.html#LN61"><span class='Ref_to_Const'>WIN32</span></a> 
 
    <span class='Comment_Multi_Line'>/* 
     * The Windows command processor will accept suitably quoted paths with 
     * forward slashes, but barfs badly with mixed forward and back slashes. 
     */ 
</span>    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="path.c.html#LN255"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>= </span><a href="path.c.html#LN253"><span class='Ref_to_Parameter'>path</span></a><span class='Delimiter'>; </span><span class='Operator'>*</span><a href="path.c.html#LN255"><span class='Ref_To_Local'>p</span></a><span class='Delimiter'>; </span><a href="path.c.html#LN255"><span class='Ref_To_Local'>p</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="path.c.html#LN255"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>== </span><span class='String'>'\\'</span><span class='Parentheses'>) 
</span>            <span class='Operator'>*</span><a href="path.c.html#LN255"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>= </span><span class='String'>'/'</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * In Win32, if you do: prog.exe "a b" "\c\d\" the system will pass \c\d" 
     * as argv[2], so trim off trailing quote. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="path.c.html#LN255"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>&GT; </span><a href="path.c.html#LN253"><span class='Ref_to_Parameter'>path</span></a> <span class='Operator'>&& *</span><span class='Parentheses'>(</span><a href="path.c.html#LN255"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='String'>'"'</span><span class='Parentheses'>)</span> 
        <span class='Operator'>*</span><span class='Parentheses'>(</span><a href="path.c.html#LN255"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Parentheses'>) </span><span class='Operator'>= </span><span class='String'>'/'</span><span class='Delimiter'>; 
</span><span class='Directive'>#endif</span> 
 
    <span class='Comment_Multi_Line'>/* 
     * Removing the trailing slash on a path means we never get ugly double 
     * trailing slashes. Also, Win32 can't stat() a directory with a trailing 
     * slash. Don't remove a leading slash, though. 
     */ 
</span>    <a href="path.c.html#LN49"><span class='Ref_to_Proto'>trim_trailing_separator</span></a><span class='Parentheses'>(</span><a href="path.c.html#LN253"><span class='Ref_to_Parameter'>path</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Remove duplicate adjacent separators 
     */ 
</span>    <a href="path.c.html#LN255"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>= </span><a href="path.c.html#LN253"><span class='Ref_to_Parameter'>path</span></a><span class='Delimiter'>; 
</span><span class='Directive'>#ifdef</span> <a href="../include/c.h.html#LN61"><span class='Ref_to_Const'>WIN32</span></a> 
    <span class='Comment_Multi_Line'>/* Don't remove leading double-slash on Win32 */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="path.c.html#LN255"><span class='Ref_To_Local'>p</span></a><span class='Parentheses'>) 
</span>        <a href="path.c.html#LN255"><span class='Ref_To_Local'>p</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span><span class='Directive'>#endif</span> 
    <a href="path.c.html#LN256"><span class='Ref_To_Local'>to_p</span></a> <span class='Operator'>= </span><a href="path.c.html#LN255"><span class='Ref_To_Local'>p</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>for</span> <span class='Parentheses'>(</span><span class='Delimiter'>; </span><span class='Operator'>*</span><a href="path.c.html#LN255"><span class='Ref_To_Local'>p</span></a><span class='Delimiter'>; </span><a href="path.c.html#LN255"><span class='Ref_To_Local'>p</span></a><span class='Operator'>++</span><span class='Delimiter'>, </span><a href="path.c.html#LN256"><span class='Ref_To_Local'>to_p</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* Handle many adjacent slashes, like "/a///b" */ 
</span>        <span class='Control'>while</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="path.c.html#LN255"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>== </span><span class='String'>'/'</span> <span class='Operator'>&& </span><a href="path.c.html#LN258"><span class='Ref_To_Local'>was_sep</span></a><span class='Parentheses'>) 
</span>            <a href="path.c.html#LN255"><span class='Ref_To_Local'>p</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="path.c.html#LN256"><span class='Ref_To_Local'>to_p</span></a> <span class='Operator'>!= </span><a href="path.c.html#LN255"><span class='Ref_To_Local'>p</span></a><span class='Parentheses'>) 
</span>            <span class='Operator'>*</span><a href="path.c.html#LN256"><span class='Ref_To_Local'>to_p</span></a> <span class='Operator'>= *</span><a href="path.c.html#LN255"><span class='Ref_To_Local'>p</span></a><span class='Delimiter'>; 
</span>        <a href="path.c.html#LN258"><span class='Ref_To_Local'>was_sep</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="path.c.html#LN255"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>== </span><span class='String'>'/'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Operator'>*</span><a href="path.c.html#LN256"><span class='Ref_To_Local'>to_p</span></a> <span class='Operator'>= </span><span class='String'>'\0'</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Remove any trailing uses of "." and process ".." ourselves 
     * 
     * Note that "/../.." should reduce to just "/", while "../.." has to be 
     * kept as-is.  In the latter case we put back mistakenly trimmed ".." 
     * components below.  Also note that we want a Windows drive spec to be 
     * visible to trim_directory(), but it's not part of the logic that's 
     * looking at the name components; hence distinction between path and 
     * spath. 
     */ 
</span>    <a href="path.c.html#LN257"><span class='Ref_To_Local'>spath</span></a> <span class='Operator'>= </span><a href="path.c.html#LN60"><span class='Ref_to_Func'>skip_drive</span></a><span class='Parentheses'>(</span><a href="path.c.html#LN253"><span class='Ref_to_Parameter'>path</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="path.c.html#LN259"><span class='Ref_To_Local'>pending_strips</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <span class='Control'>for</span> <span class='Parentheses'>(</span><span class='Delimiter'>;;</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN323"></a>        <span class='Keyword'>int</span>         <span class='Declare_Local'>len</span> <span class='Operator'>= </span>strlen<span class='Parentheses'>(</span><a href="path.c.html#LN257"><span class='Ref_To_Local'>spath</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="path.c.html#LN323"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>&GT;= </span><span class='Number'>2</span> <span class='Operator'>&& </span>strcmp<span class='Parentheses'>(</span><a href="path.c.html#LN257"><span class='Ref_To_Local'>spath</span></a> <span class='Operator'>+ </span><a href="path.c.html#LN323"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>- </span><span class='Number'>2</span><span class='Delimiter'>, </span><span class='String'>"/."</span><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
            <a href="path.c.html#LN48"><span class='Ref_to_Proto'>trim_directory</span></a><span class='Parentheses'>(</span><a href="path.c.html#LN253"><span class='Ref_to_Parameter'>path</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span>strcmp<span class='Parentheses'>(</span><a href="path.c.html#LN257"><span class='Ref_To_Local'>spath</span></a><span class='Delimiter'>, </span><span class='String'>"."</span><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* Want to leave "." alone, but "./.." has to become ".." */ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="path.c.html#LN259"><span class='Ref_To_Local'>pending_strips</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>                <span class='Operator'>*</span><a href="path.c.html#LN257"><span class='Ref_To_Local'>spath</span></a> <span class='Operator'>= </span><span class='String'>'\0'</span><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="path.c.html#LN323"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>&GT;= </span><span class='Number'>3</span> <span class='Operator'>&& </span>strcmp<span class='Parentheses'>(</span><a href="path.c.html#LN257"><span class='Ref_To_Local'>spath</span></a> <span class='Operator'>+ </span><a href="path.c.html#LN323"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>- </span><span class='Number'>3</span><span class='Delimiter'>, </span><span class='String'>"/.."</span><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> <span class='Operator'>|| 
</span>                 strcmp<span class='Parentheses'>(</span><a href="path.c.html#LN257"><span class='Ref_To_Local'>spath</span></a><span class='Delimiter'>, </span><span class='String'>".."</span><span class='Parentheses'>)</span> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <span class='Delimiter'>{ 
</span>            <a href="path.c.html#LN48"><span class='Ref_to_Proto'>trim_directory</span></a><span class='Parentheses'>(</span><a href="path.c.html#LN253"><span class='Ref_to_Parameter'>path</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="path.c.html#LN259"><span class='Ref_To_Local'>pending_strips</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="path.c.html#LN259"><span class='Ref_To_Local'>pending_strips</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span> <span class='Operator'>&& *</span><a href="path.c.html#LN257"><span class='Ref_To_Local'>spath</span></a> <span class='Operator'>!= </span><span class='String'>'\0'</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* trim a regular directory name canceled by ".." */ 
</span>            <a href="path.c.html#LN48"><span class='Ref_to_Proto'>trim_directory</span></a><span class='Parentheses'>(</span><a href="path.c.html#LN253"><span class='Ref_to_Parameter'>path</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="path.c.html#LN259"><span class='Ref_To_Local'>pending_strips</span></a><span class='Operator'>--</span><span class='Delimiter'>; 
</span>            <span class='Comment_Multi_Line'>/* foo/.. should become ".", not empty */ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="path.c.html#LN257"><span class='Ref_To_Local'>spath</span></a> <span class='Operator'>== </span><span class='String'>'\0'</span><span class='Parentheses'>) 
</span>                <a href="../../contrib/cube/cubeparse.y.html#LN150"><span class='Ref_to_Proto'>strcpy</span></a><span class='Parentheses'>(</span><a href="path.c.html#LN257"><span class='Ref_To_Local'>spath</span></a><span class='Delimiter'>, </span><span class='String'>"."</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> 
            <span class='Control'>break</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end for ;; &raquo; </span> 
 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="path.c.html#LN259"><span class='Ref_To_Local'>pending_strips</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* 
         * We could only get here if path is now totally empty (other than a 
         * possible drive specifier on Windows). We have to put back one or 
         * more ".."'s that we took off. 
         */ 
</span>        <span class='Control'>while</span> <span class='Parentheses'>(</span><span class='Operator'>--</span><a href="path.c.html#LN259"><span class='Ref_To_Local'>pending_strips</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>            strcat<span class='Parentheses'>(</span><a href="path.c.html#LN253"><span class='Ref_to_Parameter'>path</span></a><span class='Delimiter'>, </span><span class='String'>"../"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        strcat<span class='Parentheses'>(</span><a href="path.c.html#LN253"><span class='Ref_to_Parameter'>path</span></a><span class='Delimiter'>, </span><span class='String'>".."</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
}</span><span class='Auto_Annotations'> &laquo; end canonicalize_path &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * Detect whether a path contains any parent-directory references ("..") 
 * 
 * The input *must* have been put through canonicalize_path previously. 
 * 
 * This is a bit tricky because we mustn't be fooled by "..a.." (legal) 
 * nor "C:.." (legal on Unix but not Windows). 
 */ 
</span><span class='Keyword'>bool 
</span><a name="LN375"></a><span class='Declare_Function'>path_contains_parent_reference</span><span class='Parentheses'>(</span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>path</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN377"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>path_len</span><span class='Delimiter'>; 
</span> 
    <a href="path.c.html#LN375"><span class='Ref_to_Parameter'>path</span></a> <span class='Operator'>= </span><a href="path.c.html#LN60"><span class='Ref_to_Func'>skip_drive</span></a><span class='Parentheses'>(</span><a href="path.c.html#LN375"><span class='Ref_to_Parameter'>path</span></a><span class='Parentheses'>)</span><span class='Delimiter'>;</span>    <span class='Comment_Single_Line'>/* C: shouldn't affect our conclusion */ 
</span> 
    <a href="path.c.html#LN377"><span class='Ref_To_Local'>path_len</span></a> <span class='Operator'>= </span>strlen<span class='Parentheses'>(</span><a href="path.c.html#LN375"><span class='Ref_to_Parameter'>path</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * ".." could be the whole path; otherwise, if it's present it must be at 
     * the beginning, in the middle, or at the end. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span>strcmp<span class='Parentheses'>(</span><a href="path.c.html#LN375"><span class='Ref_to_Parameter'>path</span></a><span class='Delimiter'>, </span><span class='String'>".."</span><span class='Parentheses'>)</span> <span class='Operator'>== </span><span class='Number'>0</span> <span class='Operator'>|| 
</span>        strncmp<span class='Parentheses'>(</span><a href="path.c.html#LN375"><span class='Ref_to_Parameter'>path</span></a><span class='Delimiter'>, </span><span class='String'>"../"</span><span class='Delimiter'>, </span><span class='Number'>3</span><span class='Parentheses'>)</span> <span class='Operator'>== </span><span class='Number'>0</span> <span class='Operator'>|| 
</span>        strstr<span class='Parentheses'>(</span><a href="path.c.html#LN375"><span class='Ref_to_Parameter'>path</span></a><span class='Delimiter'>, </span><span class='String'>"/../"</span><span class='Parentheses'>)</span> <span class='Operator'>!= </span><span class='Null_Value'>NULL </span><span class='Operator'>|| 
</span>        <span class='Parentheses'>(</span><a href="path.c.html#LN377"><span class='Ref_To_Local'>path_len</span></a> <span class='Operator'>&GT;= </span><span class='Number'>3</span> <span class='Operator'>&& </span>strcmp<span class='Parentheses'>(</span><a href="path.c.html#LN375"><span class='Ref_to_Parameter'>path</span></a> <span class='Operator'>+ </span><a href="path.c.html#LN377"><span class='Ref_To_Local'>path_len</span></a> <span class='Operator'>- </span><span class='Number'>3</span><span class='Delimiter'>, </span><span class='String'>"/.."</span><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>))</span> 
        <span class='Control'>return</span> <span class='Boolean'>true</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <span class='Boolean'>false</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end path_contains_parent_reference &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * Detect whether a path is only in or below the current working directory. 
 * An absolute path that matches the current working directory should 
 * return false (we only want relative to the cwd).  We don't allow 
 * "/../" even if that would keep us under the cwd (it is too hard to 
 * track that). 
 */ 
</span><span class='Keyword'>bool 
</span><a name="LN404"></a><span class='Declare_Function'>path_is_relative_and_below_cwd</span><span class='Parentheses'>(</span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>path</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../include/port.h.html#LN76"><span class='Ref_to_Macro'>is_absolute_path</span></a><span class='Parentheses'>(</span><a href="path.c.html#LN404"><span class='Ref_to_Parameter'>path</span></a><span class='Parentheses'>))</span> 
        <span class='Control'>return</span> <span class='Boolean'>false</span><span class='Delimiter'>; 
</span>    <span class='Comment_Multi_Line'>/* don't allow anything above the cwd */ 
</span>    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../include/port.h.html#LN45"><span class='Ref_to_Proto'>path_contains_parent_reference</span></a><span class='Parentheses'>(</span><a href="path.c.html#LN404"><span class='Ref_to_Parameter'>path</span></a><span class='Parentheses'>))</span> 
        <span class='Control'>return</span> <span class='Boolean'>false</span><span class='Delimiter'>; 
</span><span class='Directive'>#ifdef</span> <a href="../include/c.h.html#LN61"><span class='Ref_to_Const'>WIN32</span></a> 
 
    <span class='Comment_Multi_Line'>/* 
     * On Win32, a drive letter _not_ followed by a slash, e.g. 'E:abc', is 
     * relative to the cwd on that drive, or the drive's root directory if 
     * that drive has no cwd.  Because the path itself cannot tell us which is 
     * the case, we have to assume the worst, i.e. that it is not below the 
     * cwd.  We could use GetFullPathName() to find the full path but that 
     * could change if the current directory for the drive changes underneath 
     * us, so we just disallow it. 
     */ 
</span>    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span>isalpha<span class='Parentheses'>((</span><span class='Keyword'>unsigned char</span><span class='Parentheses'>) </span><a href="path.c.html#LN404"><span class='Ref_to_Parameter'>path</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>]</span><span class='Parentheses'>)</span> <span class='Operator'>&& </span><a href="path.c.html#LN404"><span class='Ref_to_Parameter'>path</span></a><span class='Delimiter'>[</span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>== </span><span class='String'>':'</span> <span class='Operator'>&& 
</span>             <span class='Operator'>!</span><a href="../include/port.h.html#LN74"><span class='Ref_to_Macro'>IS_DIR_SEP</span></a><span class='Parentheses'>(</span><a href="path.c.html#LN404"><span class='Ref_to_Parameter'>path</span></a><span class='Delimiter'>[</span><span class='Number'>2</span><span class='Delimiter'>]</span><span class='Parentheses'>))</span> 
        <span class='Control'>return</span> <span class='Boolean'>false</span><span class='Delimiter'>; 
</span><span class='Directive'>#endif</span> 
    <span class='Control'>else</span> 
        <span class='Control'>return</span> <span class='Boolean'>true</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end path_is_relative_and_below_cwd &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * Detect whether path1 is a prefix of path2 (including equality). 
 * 
 * This is pretty trivial, but it seems better to export a function than 
 * to export IS_DIR_SEP. 
 */ 
</span><span class='Keyword'>bool 
</span><a name="LN437"></a><span class='Declare_Function'>path_is_prefix_of_path</span><span class='Parentheses'>(</span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>path1</span><span class='Delimiter'>, </span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>path2</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN439"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>path1_len</span> <span class='Operator'>= </span>strlen<span class='Parentheses'>(</span><a href="path.c.html#LN437"><span class='Ref_to_Parameter'>path1</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span>strncmp<span class='Parentheses'>(</span><a href="path.c.html#LN437"><span class='Ref_to_Parameter'>path1</span></a><span class='Delimiter'>, </span><a href="path.c.html#LN437"><span class='Ref_to_Parameter'>path2</span></a><span class='Delimiter'>, </span><a href="path.c.html#LN439"><span class='Ref_To_Local'>path1_len</span></a><span class='Parentheses'>)</span> <span class='Operator'>== </span><span class='Number'>0</span> <span class='Operator'>&& 
</span>        <span class='Parentheses'>(</span><a href="../include/port.h.html#LN74"><span class='Ref_to_Macro'>IS_DIR_SEP</span></a><span class='Parentheses'>(</span><a href="path.c.html#LN437"><span class='Ref_to_Parameter'>path2</span></a><span class='Delimiter'>[</span><a href="path.c.html#LN439"><span class='Ref_To_Local'>path1_len</span></a><span class='Delimiter'>]</span><span class='Parentheses'>) </span><span class='Operator'>|| </span><a href="path.c.html#LN437"><span class='Ref_to_Parameter'>path2</span></a><span class='Delimiter'>[</span><a href="path.c.html#LN439"><span class='Ref_To_Local'>path1_len</span></a><span class='Delimiter'>] </span><span class='Operator'>== </span><span class='String'>'\0'</span><span class='Parentheses'>))</span> 
        <span class='Control'>return</span> <span class='Boolean'>true</span><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <span class='Boolean'>false</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * Extracts the actual name of the program as called - 
 * stripped of .exe suffix if any 
 */ 
</span><span class='Keyword'>const char </span><span class='Operator'>* 
</span><a name="LN452"></a><span class='Declare_Function'>get_progname</span><span class='Parentheses'>(</span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>argv0</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN454"></a>    <span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Local'>nodir_name</span><span class='Delimiter'>; 
</span><a name="LN455"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>progname</span><span class='Delimiter'>; 
</span> 
    <a href="path.c.html#LN454"><span class='Ref_To_Local'>nodir_name</span></a> <span class='Operator'>= </span><a href="../include/port.h.html#LN38"><span class='Ref_to_Proto'>last_dir_separator</span></a><span class='Parentheses'>(</span><a href="path.c.html#LN452"><span class='Ref_to_Parameter'>argv0</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="path.c.html#LN454"><span class='Ref_To_Local'>nodir_name</span></a><span class='Parentheses'>) 
</span>        <a href="path.c.html#LN454"><span class='Ref_To_Local'>nodir_name</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
        <a href="path.c.html#LN454"><span class='Ref_To_Local'>nodir_name</span></a> <span class='Operator'>= </span><a href="path.c.html#LN60"><span class='Ref_to_Func'>skip_drive</span></a><span class='Parentheses'>(</span><a href="path.c.html#LN452"><span class='Ref_to_Parameter'>argv0</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Make a copy in case argv[0] is modified by ps_status. Leaks memory, but 
     * called only once. 
     */ 
</span>    <a href="path.c.html#LN455"><span class='Ref_To_Local'>progname</span></a> <span class='Operator'>= </span>strdup<span class='Parentheses'>(</span><a href="path.c.html#LN454"><span class='Ref_To_Local'>nodir_name</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="path.c.html#LN455"><span class='Ref_To_Local'>progname</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="../../contrib/seg/segscan.l.html#LN10"><span class='Ref_to_Macro'>fprintf</span></a><span class='Parentheses'>(</span>stderr<span class='Delimiter'>, </span><span class='String'>"%s: out of memory\n"</span><span class='Delimiter'>, </span><a href="path.c.html#LN454"><span class='Ref_To_Local'>nodir_name</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        abort<span class='Parentheses'>()</span><span class='Delimiter'>;</span>                <span class='Comment_Single_Line'>/* This could exit the postmaster */ 
</span>    <span class='Delimiter'>} 
</span> 
<span class='Directive'>#if</span> defined<span class='Parentheses'>(</span>__CYGWIN__<span class='Parentheses'>) </span><span class='Operator'>|| </span>defined<span class='Parentheses'>(</span><a href="../include/c.h.html#LN61"><span class='Ref_to_Const'>WIN32</span></a><span class='Parentheses'>) 
</span>    <span class='Comment_Multi_Line'>/* strip ".exe" suffix, regardless of case */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span>strlen<span class='Parentheses'>(</span><a href="path.c.html#LN455"><span class='Ref_To_Local'>progname</span></a><span class='Parentheses'>)</span> <span class='Operator'>&GT; </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../include/port.h.html#LN107"><span class='Ref_to_Const'>EXE</span></a><span class='Parentheses'>)</span> <span class='Operator'>- </span><span class='Number'>1</span> <span class='Operator'>&& 
</span>    <a href="pgstrcasecmp.c.html#LN34"><span class='Ref_to_Func'>pg_strcasecmp</span></a><span class='Parentheses'>(</span><a href="path.c.html#LN455"><span class='Ref_To_Local'>progname</span></a> <span class='Operator'>+ </span>strlen<span class='Parentheses'>(</span><a href="path.c.html#LN455"><span class='Ref_To_Local'>progname</span></a><span class='Parentheses'>)</span> <span class='Operator'>- </span><span class='Parentheses'>(</span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../include/port.h.html#LN107"><span class='Ref_to_Const'>EXE</span></a><span class='Parentheses'>) </span><span class='Operator'>- </span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="../include/port.h.html#LN107"><span class='Ref_to_Const'>EXE</span></a><span class='Parentheses'>)</span> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <a href="path.c.html#LN455"><span class='Ref_To_Local'>progname</span></a><span class='Delimiter'>[</span>strlen<span class='Parentheses'>(</span><a href="path.c.html#LN455"><span class='Ref_To_Local'>progname</span></a><span class='Parentheses'>) </span><span class='Operator'>- </span><span class='Parentheses'>(</span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="../include/port.h.html#LN107"><span class='Ref_to_Const'>EXE</span></a><span class='Parentheses'>) </span><span class='Operator'>- </span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='String'>'\0'</span><span class='Delimiter'>; 
</span><span class='Directive'>#endif</span> 
 
    <span class='Control'>return</span> <a href="path.c.html#LN455"><span class='Ref_To_Local'>progname</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end get_progname &raquo; </span> 
 
 
<span class='Comment_Multi_Line'>/* 
 * dir_strcmp: strcmp except any two DIR_SEP characters are considered equal, 
 * and we honor filesystem case insensitivity if known 
 */ 
</span><span class='Keyword'>static int 
</span><a name="LN490"></a><span class='Declare_Function'>dir_strcmp</span><span class='Parentheses'>(</span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>s1</span><span class='Delimiter'>, </span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>s2</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>while</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="path.c.html#LN490"><span class='Ref_to_Parameter'>s1</span></a> <span class='Operator'>&& *</span><a href="path.c.html#LN490"><span class='Ref_to_Parameter'>s2</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span> 
<span class='Directive'>#ifndef</span> <a href="../include/c.h.html#LN61"><span class='Ref_to_Const'>WIN32</span></a> 
            <span class='Operator'>*</span><a href="path.c.html#LN490"><span class='Ref_to_Parameter'>s1</span></a> <span class='Operator'>!= *</span><a href="path.c.html#LN490"><span class='Ref_to_Parameter'>s2</span></a> 
<span class='Directive'>#else</span> 
        <span class='Comment_Multi_Line'>/* On windows, paths are case-insensitive */ 
</span>            <a href="pgstrcasecmp.c.html#LN120"><span class='Ref_to_Func'>pg_tolower</span></a><span class='Parentheses'>((</span><span class='Keyword'>unsigned char</span><span class='Parentheses'>) </span><span class='Operator'>*</span><a href="path.c.html#LN490"><span class='Ref_to_Parameter'>s1</span></a><span class='Parentheses'>)</span> <span class='Operator'>!= </span><a href="pgstrcasecmp.c.html#LN120"><span class='Ref_to_Func'>pg_tolower</span></a><span class='Parentheses'>((</span><span class='Keyword'>unsigned char</span><span class='Parentheses'>) </span><span class='Operator'>*</span><a href="path.c.html#LN490"><span class='Ref_to_Parameter'>s2</span></a><span class='Parentheses'>)</span> 
<span class='Directive'>#endif</span> 
            <span class='Operator'>&& !</span><span class='Parentheses'>(</span><a href="../include/port.h.html#LN74"><span class='Ref_to_Macro'>IS_DIR_SEP</span></a><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="path.c.html#LN490"><span class='Ref_to_Parameter'>s1</span></a><span class='Parentheses'>) </span><span class='Operator'>&& </span><a href="../include/port.h.html#LN74"><span class='Ref_to_Macro'>IS_DIR_SEP</span></a><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="path.c.html#LN490"><span class='Ref_to_Parameter'>s2</span></a><span class='Parentheses'>)))</span> 
            <span class='Control'>return</span> <span class='Parentheses'>(</span><span class='Keyword'>int</span><span class='Parentheses'>) </span><span class='Operator'>*</span><a href="path.c.html#LN490"><span class='Ref_to_Parameter'>s1</span></a> <span class='Operator'>- </span><span class='Parentheses'>(</span><span class='Keyword'>int</span><span class='Parentheses'>) </span><span class='Operator'>*</span><a href="path.c.html#LN490"><span class='Ref_to_Parameter'>s2</span></a><span class='Delimiter'>; 
</span>        <a href="path.c.html#LN490"><span class='Ref_to_Parameter'>s1</span></a><span class='Operator'>++</span><span class='Delimiter'>, </span><a href="path.c.html#LN490"><span class='Ref_to_Parameter'>s2</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="path.c.html#LN490"><span class='Ref_to_Parameter'>s1</span></a><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <span class='Number'>1</span><span class='Delimiter'>;</span>               <span class='Comment_Single_Line'>/* s1 longer */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="path.c.html#LN490"><span class='Ref_to_Parameter'>s2</span></a><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>;</span>              <span class='Comment_Single_Line'>/* s2 longer */ 
</span>    <span class='Control'>return</span> <span class='Number'>0</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end dir_strcmp &raquo; </span> 
 
 
<span class='Comment_Multi_Line'>/* 
 * make_relative_path - make a path relative to the actual binary location 
 * 
 * This function exists to support relocation of installation trees. 
 * 
 *  ret_path is the output area (must be of size MAXPGPATH) 
 *  target_path is the compiled-in path to the directory we want to find 
 *  bin_path is the compiled-in path to the directory of executables 
 *  my_exec_path is the actual location of my executable 
 * 
 * We determine the common prefix of target_path and bin_path, then compare 
 * the remainder of bin_path to the last directory component(s) of 
 * my_exec_path.  If they match, build the result as the part of my_exec_path 
 * preceding the match, joined to the remainder of target_path.  If no match, 
 * return target_path as-is. 
 * 
 * For example: 
 *      target_path  = '/usr/local/share/postgresql' 
 *      bin_path     = '/usr/local/bin' 
 *      my_exec_path = '/opt/pgsql/bin/postmaster' 
 * Given these inputs, the common prefix is '/usr/local/', the tail of 
 * bin_path is 'bin' which does match the last directory component of 
 * my_exec_path, so we would return '/opt/pgsql/share/postgresql' 
 */ 
</span><span class='Keyword'>static void 
</span><a name="LN538"></a><span class='Declare_Function'>make_relative_path</span><span class='Parentheses'>(</span><span class='Keyword'>char </span><span class='Operator'>*</span><span class='Declare_Parameter'>ret_path</span><span class='Delimiter'>, </span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>target_path</span><span class='Delimiter'>, 
</span><a name="LN539"></a>                   <span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>bin_path</span><span class='Delimiter'>, </span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>my_exec_path</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN541"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>prefix_len</span><span class='Delimiter'>; 
</span><a name="LN542"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>tail_start</span><span class='Delimiter'>; 
</span><a name="LN543"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>tail_len</span><span class='Delimiter'>; 
</span><a name="LN544"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>i</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Determine the common prefix --- note we require it to end on a 
     * directory separator, consider eg '/usr/lib' and '/usr/libexec'. 
     */ 
</span>    <a href="path.c.html#LN541"><span class='Ref_To_Local'>prefix_len</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="path.c.html#LN544"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="path.c.html#LN538"><span class='Ref_to_Parameter'>target_path</span></a><span class='Delimiter'>[</span><a href="path.c.html#LN544"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>] </span><span class='Operator'>&& </span><a href="path.c.html#LN539"><span class='Ref_to_Parameter'>bin_path</span></a><span class='Delimiter'>[</span><a href="path.c.html#LN544"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]; </span><a href="path.c.html#LN544"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../include/port.h.html#LN74"><span class='Ref_to_Macro'>IS_DIR_SEP</span></a><span class='Parentheses'>(</span><a href="path.c.html#LN538"><span class='Ref_to_Parameter'>target_path</span></a><span class='Delimiter'>[</span><a href="path.c.html#LN544"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Parentheses'>) </span><span class='Operator'>&& </span><a href="../include/port.h.html#LN74"><span class='Ref_to_Macro'>IS_DIR_SEP</span></a><span class='Parentheses'>(</span><a href="path.c.html#LN539"><span class='Ref_to_Parameter'>bin_path</span></a><span class='Delimiter'>[</span><a href="path.c.html#LN544"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Parentheses'>))</span> 
            <a href="path.c.html#LN541"><span class='Ref_To_Local'>prefix_len</span></a> <span class='Operator'>= </span><a href="path.c.html#LN544"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>+ </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="path.c.html#LN538"><span class='Ref_to_Parameter'>target_path</span></a><span class='Delimiter'>[</span><a href="path.c.html#LN544"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>] </span><span class='Operator'>!= </span><a href="path.c.html#LN539"><span class='Ref_to_Parameter'>bin_path</span></a><span class='Delimiter'>[</span><a href="path.c.html#LN544"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Parentheses'>) 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="path.c.html#LN541"><span class='Ref_To_Local'>prefix_len</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>        <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="path.c.html#LN585"><span class='Ref_to_Label'>no_match</span></a><span class='Delimiter'>;</span>          <span class='Comment_Single_Line'>/* no common prefix? */ 
</span>    <a href="path.c.html#LN543"><span class='Ref_To_Local'>tail_len</span></a> <span class='Operator'>= </span>strlen<span class='Parentheses'>(</span><a href="path.c.html#LN539"><span class='Ref_to_Parameter'>bin_path</span></a><span class='Parentheses'>) </span><span class='Operator'>- </span><a href="path.c.html#LN541"><span class='Ref_To_Local'>prefix_len</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Set up my_exec_path without the actual executable name, and 
     * canonicalize to simplify comparison to bin_path. 
     */ 
</span>    <a href="strlcpy.c.html#LN43"><span class='Ref_to_Func'>strlcpy</span></a><span class='Parentheses'>(</span><a href="path.c.html#LN538"><span class='Ref_to_Parameter'>ret_path</span></a><span class='Delimiter'>, </span><a href="path.c.html#LN539"><span class='Ref_to_Parameter'>my_exec_path</span></a><span class='Delimiter'>, </span><a href="../include/pg_config_manual.h.html#LN88"><span class='Ref_to_Const'>MAXPGPATH</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="path.c.html#LN48"><span class='Ref_to_Proto'>trim_directory</span></a><span class='Parentheses'>(</span><a href="path.c.html#LN538"><span class='Ref_to_Parameter'>ret_path</span></a><span class='Parentheses'>)</span><span class='Delimiter'>;</span>   <span class='Comment_Single_Line'>/* remove my executable name */ 
</span>    <a href="../include/port.h.html#LN42"><span class='Ref_to_Proto'>canonicalize_path</span></a><span class='Parentheses'>(</span><a href="path.c.html#LN538"><span class='Ref_to_Parameter'>ret_path</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Tail match? 
     */ 
</span>    <a href="path.c.html#LN542"><span class='Ref_To_Local'>tail_start</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Keyword'>int</span><span class='Parentheses'>) </span>strlen<span class='Parentheses'>(</span><a href="path.c.html#LN538"><span class='Ref_to_Parameter'>ret_path</span></a><span class='Parentheses'>) </span><span class='Operator'>- </span><a href="path.c.html#LN543"><span class='Ref_To_Local'>tail_len</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="path.c.html#LN542"><span class='Ref_To_Local'>tail_start</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span> <span class='Operator'>&& 
</span>        <a href="../include/port.h.html#LN74"><span class='Ref_to_Macro'>IS_DIR_SEP</span></a><span class='Parentheses'>(</span><a href="path.c.html#LN538"><span class='Ref_to_Parameter'>ret_path</span></a><span class='Delimiter'>[</span><a href="path.c.html#LN542"><span class='Ref_To_Local'>tail_start</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>]</span><span class='Parentheses'>) </span><span class='Operator'>&& 
</span>        <a href="path.c.html#LN489"><span class='Ref_to_Func'>dir_strcmp</span></a><span class='Parentheses'>(</span><a href="path.c.html#LN538"><span class='Ref_to_Parameter'>ret_path</span></a> <span class='Operator'>+ </span><a href="path.c.html#LN542"><span class='Ref_To_Local'>tail_start</span></a><span class='Delimiter'>, </span><a href="path.c.html#LN539"><span class='Ref_to_Parameter'>bin_path</span></a> <span class='Operator'>+ </span><a href="path.c.html#LN541"><span class='Ref_To_Local'>prefix_len</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
    <span class='Delimiter'>{ 
</span>        <a href="path.c.html#LN538"><span class='Ref_to_Parameter'>ret_path</span></a><span class='Delimiter'>[</span><a href="path.c.html#LN542"><span class='Ref_To_Local'>tail_start</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='String'>'\0'</span><span class='Delimiter'>; 
</span>        <a href="path.c.html#LN49"><span class='Ref_to_Proto'>trim_trailing_separator</span></a><span class='Parentheses'>(</span><a href="path.c.html#LN538"><span class='Ref_to_Parameter'>ret_path</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="../include/port.h.html#LN40"><span class='Ref_to_Proto'>join_path_components</span></a><span class='Parentheses'>(</span><a href="path.c.html#LN538"><span class='Ref_to_Parameter'>ret_path</span></a><span class='Delimiter'>, </span><a href="path.c.html#LN538"><span class='Ref_to_Parameter'>ret_path</span></a><span class='Delimiter'>, </span><a href="path.c.html#LN538"><span class='Ref_to_Parameter'>target_path</span></a> <span class='Operator'>+ </span><a href="path.c.html#LN541"><span class='Ref_To_Local'>prefix_len</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="../include/port.h.html#LN42"><span class='Ref_to_Proto'>canonicalize_path</span></a><span class='Parentheses'>(</span><a href="path.c.html#LN538"><span class='Ref_to_Parameter'>ret_path</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>return</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
<a name="LN585"></a><span class='Label'>no_match</span><span class='Operator'>: 
</span>    <a href="strlcpy.c.html#LN43"><span class='Ref_to_Func'>strlcpy</span></a><span class='Parentheses'>(</span><a href="path.c.html#LN538"><span class='Ref_to_Parameter'>ret_path</span></a><span class='Delimiter'>, </span><a href="path.c.html#LN538"><span class='Ref_to_Parameter'>target_path</span></a><span class='Delimiter'>, </span><a href="../include/pg_config_manual.h.html#LN88"><span class='Ref_to_Const'>MAXPGPATH</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../include/port.h.html#LN42"><span class='Ref_to_Proto'>canonicalize_path</span></a><span class='Parentheses'>(</span><a href="path.c.html#LN538"><span class='Ref_to_Parameter'>ret_path</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end make_relative_path &raquo; </span> 
 
 
<span class='Comment_Multi_Line'>/* 
 * make_absolute_path 
 * 
 * If the given pathname isn't already absolute, make it so, interpreting 
 * it relative to the current working directory. 
 * 
 * Also canonicalizes the path.  The result is always a malloc'd copy. 
 * 
 * In backend, failure cases result in ereport(ERROR); in frontend, 
 * we write a complaint on stderr and return NULL. 
 * 
 * Note: interpretation of relative-path arguments during postmaster startup 
 * should happen before doing ChangeToDataDir(), else the user will probably 
 * not like the results. 
 */ 
</span><span class='Keyword'>char </span><span class='Operator'>* 
</span><a name="LN607"></a><span class='Declare_Function'>make_absolute_path</span><span class='Parentheses'>(</span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>path</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN609"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>new</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* Returning null for null input is convenient for some callers */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="path.c.html#LN607"><span class='Ref_to_Parameter'>path</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../include/port.h.html#LN76"><span class='Ref_to_Macro'>is_absolute_path</span></a><span class='Parentheses'>(</span><a href="path.c.html#LN607"><span class='Ref_to_Parameter'>path</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span><a name="LN617"></a>        <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>buf</span><span class='Delimiter'>; 
</span><a name="LN618"></a>        size_t      <span class='Declare_Local'>buflen</span><span class='Delimiter'>; 
</span> 
        <a href="path.c.html#LN618"><span class='Ref_To_Local'>buflen</span></a> <span class='Operator'>= </span><a href="../include/pg_config_manual.h.html#LN88"><span class='Ref_to_Const'>MAXPGPATH</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>for</span> <span class='Parentheses'>(</span><span class='Delimiter'>;;</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <a href="path.c.html#LN617"><span class='Ref_To_Local'>buf</span></a> <span class='Operator'>= </span><a href="../include/snowball/header.h.html#LN49"><span class='Ref_to_Macro'>malloc</span></a><span class='Parentheses'>(</span><a href="path.c.html#LN618"><span class='Ref_To_Local'>buflen</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="path.c.html#LN617"><span class='Ref_To_Local'>buf</span></a><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span><span class='Directive'>#ifndef</span> <a href="../bin/pg_waldump/rmgrdesc.c.html#LN7"><span class='Ref_to_Const'>FRONTEND</span></a> 
                <a href="../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                        <span class='Parentheses'>(</span><a href="../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_OUT_OF_MEMORY<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                         <a href="../backend/utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"out of memory"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span><span class='Directive'>#else</span> 
                <a href="../../contrib/seg/segscan.l.html#LN10"><span class='Ref_to_Macro'>fprintf</span></a><span class='Parentheses'>(</span>stderr<span class='Delimiter'>, </span>_<span class='Parentheses'>(</span><span class='String'>"out of memory\n"</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>                <span class='Control'>return</span> <span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span><span class='Directive'>#endif</span> 
            <span class='Delimiter'>} 
</span> 
            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../common/exec.c.html#LN38"><span class='Ref_to_Macro'>getcwd</span></a><span class='Parentheses'>(</span><a href="path.c.html#LN617"><span class='Ref_To_Local'>buf</span></a><span class='Delimiter'>, </span><a href="path.c.html#LN618"><span class='Ref_To_Local'>buflen</span></a><span class='Parentheses'>))</span> 
                <span class='Control'>break</span><span class='Delimiter'>; 
</span>            <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span>errno <span class='Operator'>== </span>ERANGE<span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <a href="../include/snowball/header.h.html#LN64"><span class='Ref_to_Macro'>free</span></a><span class='Parentheses'>(</span><a href="path.c.html#LN617"><span class='Ref_To_Local'>buf</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <a href="path.c.html#LN618"><span class='Ref_To_Local'>buflen</span></a> <span class='Operator'>*= </span><span class='Number'>2</span><span class='Delimiter'>; 
</span>                <span class='Control'>continue</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>            <span class='Control'>else</span> 
            <span class='Delimiter'>{ 
</span><a name="LN646"></a>                <span class='Keyword'>int</span>         <span class='Declare_Local'>save_errno</span> <span class='Operator'>= </span>errno<span class='Delimiter'>; 
</span> 
                <a href="../include/snowball/header.h.html#LN64"><span class='Ref_to_Macro'>free</span></a><span class='Parentheses'>(</span><a href="path.c.html#LN617"><span class='Ref_To_Local'>buf</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                errno <span class='Operator'>= </span><a href="path.c.html#LN646"><span class='Ref_To_Local'>save_errno</span></a><span class='Delimiter'>; 
</span><span class='Directive'>#ifndef</span> <a href="../bin/pg_waldump/rmgrdesc.c.html#LN7"><span class='Ref_to_Const'>FRONTEND</span></a> 
                <a href="../backend/bootstrap/bootscanner.l.html#LN129"><span class='Ref_to_Proto'>elog</span></a><span class='Parentheses'>(</span><a href="../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, </span><span class='String'>"could not get current working directory: %m"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><span class='Directive'>#else</span> 
                <a href="../../contrib/seg/segscan.l.html#LN10"><span class='Ref_to_Macro'>fprintf</span></a><span class='Parentheses'>(</span>stderr<span class='Delimiter'>, </span>_<span class='Parentheses'>(</span><span class='String'>"could not get current working directory: %s\n"</span><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                        <a href="strerror.c.html#LN17"><span class='Ref_to_Func'>strerror</span></a><span class='Parentheses'>(</span>errno<span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>                <span class='Control'>return</span> <span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span><span class='Directive'>#endif</span> 
            <span class='Delimiter'>} 
</span>        <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end for ;; &raquo; </span> 
 
        <span class='Control'>new</span> <span class='Operator'>= </span><a href="../include/snowball/header.h.html#LN49"><span class='Ref_to_Macro'>malloc</span></a><span class='Parentheses'>(</span>strlen<span class='Parentheses'>(</span><a href="path.c.html#LN617"><span class='Ref_To_Local'>buf</span></a><span class='Parentheses'>) </span><span class='Operator'>+ </span>strlen<span class='Parentheses'>(</span><a href="path.c.html#LN607"><span class='Ref_to_Parameter'>path</span></a><span class='Parentheses'>) </span><span class='Operator'>+ </span><span class='Number'>2</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><span class='Control'>new</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <a href="../include/snowball/header.h.html#LN64"><span class='Ref_to_Macro'>free</span></a><span class='Parentheses'>(</span><a href="path.c.html#LN617"><span class='Ref_To_Local'>buf</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><span class='Directive'>#ifndef</span> <a href="../bin/pg_waldump/rmgrdesc.c.html#LN7"><span class='Ref_to_Const'>FRONTEND</span></a> 
            <a href="../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                    <span class='Parentheses'>(</span><a href="../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_OUT_OF_MEMORY<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                     <a href="../backend/utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"out of memory"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span><span class='Directive'>#else</span> 
            <a href="../../contrib/seg/segscan.l.html#LN10"><span class='Ref_to_Macro'>fprintf</span></a><span class='Parentheses'>(</span>stderr<span class='Delimiter'>, </span>_<span class='Parentheses'>(</span><span class='String'>"out of memory\n"</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>            <span class='Control'>return</span> <span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span><span class='Directive'>#endif</span> 
        <span class='Delimiter'>} 
</span>        <a href="../include/port.h.html#LN170"><span class='Ref_to_Macro'>sprintf</span></a><span class='Parentheses'>(</span><span class='Control'>new</span><span class='Delimiter'>, </span><span class='String'>"%s/%s"</span><span class='Delimiter'>, </span><a href="path.c.html#LN617"><span class='Ref_To_Local'>buf</span></a><span class='Delimiter'>, </span><a href="path.c.html#LN607"><span class='Ref_to_Parameter'>path</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="../include/snowball/header.h.html#LN64"><span class='Ref_to_Macro'>free</span></a><span class='Parentheses'>(</span><a href="path.c.html#LN617"><span class='Ref_To_Local'>buf</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if !is_absolute_path(pat... &raquo; </span> 
    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Control'>new</span> <span class='Operator'>= </span>strdup<span class='Parentheses'>(</span><a href="path.c.html#LN607"><span class='Ref_to_Parameter'>path</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><span class='Control'>new</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span><span class='Directive'>#ifndef</span> <a href="../bin/pg_waldump/rmgrdesc.c.html#LN7"><span class='Ref_to_Const'>FRONTEND</span></a> 
            <a href="../include/utils/elog.h.html#LN121"><span class='Ref_to_Macro'>ereport</span></a><span class='Parentheses'>(</span><a href="../include/port/win32/sys/socket.h.html#LN22"><span class='Ref_to_Const'>ERROR</span></a><span class='Delimiter'>, 
</span>                    <span class='Parentheses'>(</span><a href="../include/utils/elog.h.html#LN130"><span class='Ref_to_Proto'>errcode</span></a><span class='Parentheses'>(</span>ERRCODE_OUT_OF_MEMORY<span class='Parentheses'>)</span><span class='Delimiter'>, 
</span>                     <a href="../backend/utils/error/elog.c.html#LN795"><span class='Ref_to_Func'>errmsg</span></a><span class='Parentheses'>(</span><span class='String'>"out of memory"</span><span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span><span class='Directive'>#else</span> 
            <a href="../../contrib/seg/segscan.l.html#LN10"><span class='Ref_to_Macro'>fprintf</span></a><span class='Parentheses'>(</span>stderr<span class='Delimiter'>, </span>_<span class='Parentheses'>(</span><span class='String'>"out of memory\n"</span><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>            <span class='Control'>return</span> <span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span><span class='Directive'>#endif</span> 
        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* Make sure punctuation is canonical, too */ 
</span>    <a href="../include/port.h.html#LN42"><span class='Ref_to_Proto'>canonicalize_path</span></a><span class='Parentheses'>(</span><span class='Control'>new</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <span class='Control'>new</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end make_absolute_path &raquo; </span> 
 
 
<span class='Comment_Multi_Line'>/* 
 *  get_share_path 
 */ 
</span><span class='Keyword'>void 
</span><a name="LN703"></a><span class='Declare_Function'>get_share_path</span><span class='Parentheses'>(</span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>my_exec_path</span><span class='Delimiter'>, </span><span class='Keyword'>char </span><span class='Operator'>*</span><span class='Declare_Parameter'>ret_path</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <a href="path.c.html#LN46"><span class='Ref_to_Proto'>make_relative_path</span></a><span class='Parentheses'>(</span><a href="path.c.html#LN703"><span class='Ref_to_Parameter'>ret_path</span></a><span class='Delimiter'>, </span>PGSHAREDIR<span class='Delimiter'>, </span>PGBINDIR<span class='Delimiter'>, </span><a href="path.c.html#LN703"><span class='Ref_to_Parameter'>my_exec_path</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 *  get_etc_path 
 */ 
</span><span class='Keyword'>void 
</span><a name="LN712"></a><span class='Declare_Function'>get_etc_path</span><span class='Parentheses'>(</span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>my_exec_path</span><span class='Delimiter'>, </span><span class='Keyword'>char </span><span class='Operator'>*</span><span class='Declare_Parameter'>ret_path</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <a href="path.c.html#LN46"><span class='Ref_to_Proto'>make_relative_path</span></a><span class='Parentheses'>(</span><a href="path.c.html#LN712"><span class='Ref_to_Parameter'>ret_path</span></a><span class='Delimiter'>, </span>SYSCONFDIR<span class='Delimiter'>, </span>PGBINDIR<span class='Delimiter'>, </span><a href="path.c.html#LN712"><span class='Ref_to_Parameter'>my_exec_path</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 *  get_include_path 
 */ 
</span><span class='Keyword'>void 
</span><a name="LN721"></a><span class='Declare_Function'>get_include_path</span><span class='Parentheses'>(</span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>my_exec_path</span><span class='Delimiter'>, </span><span class='Keyword'>char </span><span class='Operator'>*</span><span class='Declare_Parameter'>ret_path</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <a href="path.c.html#LN46"><span class='Ref_to_Proto'>make_relative_path</span></a><span class='Parentheses'>(</span><a href="path.c.html#LN721"><span class='Ref_to_Parameter'>ret_path</span></a><span class='Delimiter'>, </span>INCLUDEDIR<span class='Delimiter'>, </span>PGBINDIR<span class='Delimiter'>, </span><a href="path.c.html#LN721"><span class='Ref_to_Parameter'>my_exec_path</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 *  get_pkginclude_path 
 */ 
</span><span class='Keyword'>void 
</span><a name="LN730"></a><span class='Declare_Function'>get_pkginclude_path</span><span class='Parentheses'>(</span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>my_exec_path</span><span class='Delimiter'>, </span><span class='Keyword'>char </span><span class='Operator'>*</span><span class='Declare_Parameter'>ret_path</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <a href="path.c.html#LN46"><span class='Ref_to_Proto'>make_relative_path</span></a><span class='Parentheses'>(</span><a href="path.c.html#LN730"><span class='Ref_to_Parameter'>ret_path</span></a><span class='Delimiter'>, </span>PKGINCLUDEDIR<span class='Delimiter'>, </span>PGBINDIR<span class='Delimiter'>, </span><a href="path.c.html#LN730"><span class='Ref_to_Parameter'>my_exec_path</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 *  get_includeserver_path 
 */ 
</span><span class='Keyword'>void 
</span><a name="LN739"></a><span class='Declare_Function'>get_includeserver_path</span><span class='Parentheses'>(</span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>my_exec_path</span><span class='Delimiter'>, </span><span class='Keyword'>char </span><span class='Operator'>*</span><span class='Declare_Parameter'>ret_path</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <a href="path.c.html#LN46"><span class='Ref_to_Proto'>make_relative_path</span></a><span class='Parentheses'>(</span><a href="path.c.html#LN739"><span class='Ref_to_Parameter'>ret_path</span></a><span class='Delimiter'>, </span>INCLUDEDIRSERVER<span class='Delimiter'>, </span>PGBINDIR<span class='Delimiter'>, </span><a href="path.c.html#LN739"><span class='Ref_to_Parameter'>my_exec_path</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 *  get_lib_path 
 */ 
</span><span class='Keyword'>void 
</span><a name="LN748"></a><span class='Declare_Function'>get_lib_path</span><span class='Parentheses'>(</span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>my_exec_path</span><span class='Delimiter'>, </span><span class='Keyword'>char </span><span class='Operator'>*</span><span class='Declare_Parameter'>ret_path</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <a href="path.c.html#LN46"><span class='Ref_to_Proto'>make_relative_path</span></a><span class='Parentheses'>(</span><a href="path.c.html#LN748"><span class='Ref_to_Parameter'>ret_path</span></a><span class='Delimiter'>, </span>LIBDIR<span class='Delimiter'>, </span>PGBINDIR<span class='Delimiter'>, </span><a href="path.c.html#LN748"><span class='Ref_to_Parameter'>my_exec_path</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 *  get_pkglib_path 
 */ 
</span><span class='Keyword'>void 
</span><a name="LN757"></a><span class='Declare_Function'>get_pkglib_path</span><span class='Parentheses'>(</span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>my_exec_path</span><span class='Delimiter'>, </span><span class='Keyword'>char </span><span class='Operator'>*</span><span class='Declare_Parameter'>ret_path</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <a href="path.c.html#LN46"><span class='Ref_to_Proto'>make_relative_path</span></a><span class='Parentheses'>(</span><a href="path.c.html#LN757"><span class='Ref_to_Parameter'>ret_path</span></a><span class='Delimiter'>, </span>PKGLIBDIR<span class='Delimiter'>, </span>PGBINDIR<span class='Delimiter'>, </span><a href="path.c.html#LN757"><span class='Ref_to_Parameter'>my_exec_path</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 *  get_locale_path 
 */ 
</span><span class='Keyword'>void 
</span><a name="LN766"></a><span class='Declare_Function'>get_locale_path</span><span class='Parentheses'>(</span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>my_exec_path</span><span class='Delimiter'>, </span><span class='Keyword'>char </span><span class='Operator'>*</span><span class='Declare_Parameter'>ret_path</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <a href="path.c.html#LN46"><span class='Ref_to_Proto'>make_relative_path</span></a><span class='Parentheses'>(</span><a href="path.c.html#LN766"><span class='Ref_to_Parameter'>ret_path</span></a><span class='Delimiter'>, </span>LOCALEDIR<span class='Delimiter'>, </span>PGBINDIR<span class='Delimiter'>, </span><a href="path.c.html#LN766"><span class='Ref_to_Parameter'>my_exec_path</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 *  get_doc_path 
 */ 
</span><span class='Keyword'>void 
</span><a name="LN775"></a><span class='Declare_Function'>get_doc_path</span><span class='Parentheses'>(</span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>my_exec_path</span><span class='Delimiter'>, </span><span class='Keyword'>char </span><span class='Operator'>*</span><span class='Declare_Parameter'>ret_path</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <a href="path.c.html#LN46"><span class='Ref_to_Proto'>make_relative_path</span></a><span class='Parentheses'>(</span><a href="path.c.html#LN775"><span class='Ref_to_Parameter'>ret_path</span></a><span class='Delimiter'>, </span>DOCDIR<span class='Delimiter'>, </span>PGBINDIR<span class='Delimiter'>, </span><a href="path.c.html#LN775"><span class='Ref_to_Parameter'>my_exec_path</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 *  get_html_path 
 */ 
</span><span class='Keyword'>void 
</span><a name="LN784"></a><span class='Declare_Function'>get_html_path</span><span class='Parentheses'>(</span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>my_exec_path</span><span class='Delimiter'>, </span><span class='Keyword'>char </span><span class='Operator'>*</span><span class='Declare_Parameter'>ret_path</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <a href="path.c.html#LN46"><span class='Ref_to_Proto'>make_relative_path</span></a><span class='Parentheses'>(</span><a href="path.c.html#LN784"><span class='Ref_to_Parameter'>ret_path</span></a><span class='Delimiter'>, </span>HTMLDIR<span class='Delimiter'>, </span>PGBINDIR<span class='Delimiter'>, </span><a href="path.c.html#LN784"><span class='Ref_to_Parameter'>my_exec_path</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 *  get_man_path 
 */ 
</span><span class='Keyword'>void 
</span><a name="LN793"></a><span class='Declare_Function'>get_man_path</span><span class='Parentheses'>(</span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>my_exec_path</span><span class='Delimiter'>, </span><span class='Keyword'>char </span><span class='Operator'>*</span><span class='Declare_Parameter'>ret_path</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <a href="path.c.html#LN46"><span class='Ref_to_Proto'>make_relative_path</span></a><span class='Parentheses'>(</span><a href="path.c.html#LN793"><span class='Ref_to_Parameter'>ret_path</span></a><span class='Delimiter'>, </span>MANDIR<span class='Delimiter'>, </span>PGBINDIR<span class='Delimiter'>, </span><a href="path.c.html#LN793"><span class='Ref_to_Parameter'>my_exec_path</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
 
<span class='Comment_Multi_Line'>/* 
 *  get_home_path 
 * 
 * On Unix, this actually returns the user's home directory.  On Windows 
 * it returns the PostgreSQL-specific application data folder. 
 */ 
</span><span class='Keyword'>bool 
</span><a name="LN806"></a><span class='Declare_Function'>get_home_path</span><span class='Parentheses'>(</span><span class='Keyword'>char </span><span class='Operator'>*</span><span class='Declare_Parameter'>ret_path</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><span class='Directive'>#ifndef</span> <a href="../include/c.h.html#LN61"><span class='Ref_to_Const'>WIN32</span></a> 
<a name="LN809"></a>    <span class='Keyword'>char</span>        <span class='Declare_Local'>pwdbuf</span><span class='Delimiter'>[</span>BUFSIZ<span class='Delimiter'>]; 
</span><a name="LN810"></a>    <span class='Control'>struct</span> passwd <span class='Declare_Local'>pwdstr</span><span class='Delimiter'>; 
</span><a name="LN811"></a>    <span class='Control'>struct</span> passwd <span class='Operator'>*</span><span class='Declare_Local'>pwd</span> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span> 
    <span class='Parentheses'>(</span><span class='Keyword'>void</span><span class='Parentheses'>) </span><a href="thread.c.html#LN93"><span class='Ref_to_Func'>pqGetpwuid</span></a><span class='Parentheses'>(</span>geteuid<span class='Parentheses'>()</span><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="path.c.html#LN810"><span class='Ref_To_Local'>pwdstr</span></a><span class='Delimiter'>, </span><a href="path.c.html#LN809"><span class='Ref_To_Local'>pwdbuf</span></a><span class='Delimiter'>, </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="path.c.html#LN809"><span class='Ref_To_Local'>pwdbuf</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="path.c.html#LN811"><span class='Ref_To_Local'>pwd</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="path.c.html#LN811"><span class='Ref_To_Local'>pwd</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <span class='Boolean'>false</span><span class='Delimiter'>; 
</span>    <a href="strlcpy.c.html#LN43"><span class='Ref_to_Func'>strlcpy</span></a><span class='Parentheses'>(</span><a href="path.c.html#LN806"><span class='Ref_to_Parameter'>ret_path</span></a><span class='Delimiter'>, </span><a href="path.c.html#LN811"><span class='Ref_To_Local'>pwd</span></a><span class='Operator'>-&GT;</span>pw_dir<span class='Delimiter'>, </span><a href="../include/pg_config_manual.h.html#LN88"><span class='Ref_to_Const'>MAXPGPATH</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <span class='Boolean'>true</span><span class='Delimiter'>; 
</span><span class='Directive'>#else</span> 
<a name="LN819"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>tmppath</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Note: We use getenv() here because the more modern SHGetFolderPath() 
     * would force the backend to link with shell32.lib, which eats valuable 
     * desktop heap.  XXX This function is used only in psql, which already 
     * brings in shell32 via libpq.  Moving this function to its own file 
     * would keep it out of the backend, freeing it from this concern. 
     */ 
</span>    <a href="path.c.html#LN819"><span class='Ref_To_Local'>tmppath</span></a> <span class='Operator'>= </span>getenv<span class='Parentheses'>(</span><span class='String'>"APPDATA"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="path.c.html#LN819"><span class='Ref_To_Local'>tmppath</span></a><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <span class='Boolean'>false</span><span class='Delimiter'>; 
</span>    <a href="../pl/plperl/plperl.h.html#LN60"><span class='Ref_to_Macro'>snprintf</span></a><span class='Parentheses'>(</span><a href="path.c.html#LN806"><span class='Ref_to_Parameter'>ret_path</span></a><span class='Delimiter'>, </span><a href="../include/pg_config_manual.h.html#LN88"><span class='Ref_to_Const'>MAXPGPATH</span></a><span class='Delimiter'>, </span><span class='String'>"%s/postgresql"</span><span class='Delimiter'>, </span><a href="path.c.html#LN819"><span class='Ref_To_Local'>tmppath</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <span class='Boolean'>true</span><span class='Delimiter'>; 
</span><span class='Directive'>#endif</span> 
<span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end get_home_path &raquo; </span> 
 
 
<span class='Comment_Multi_Line'>/* 
 * get_parent_directory 
 * 
 * Modify the given string in-place to name the parent directory of the 
 * named file. 
 * 
 * If the input is just a file name with no directory part, the result is 
 * an empty string, not ".".  This is appropriate when the next step is 
 * join_path_components(), but might need special handling otherwise. 
 * 
 * Caution: this will not produce desirable results if the string ends 
 * with "..".  For most callers this is not a problem since the string 
 * is already known to name a regular file.  If in doubt, apply 
 * canonicalize_path() first. 
 */ 
</span><span class='Keyword'>void 
</span><a name="LN853"></a><span class='Declare_Function'>get_parent_directory</span><span class='Parentheses'>(</span><span class='Keyword'>char </span><span class='Operator'>*</span><span class='Declare_Parameter'>path</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <a href="path.c.html#LN48"><span class='Ref_to_Proto'>trim_directory</span></a><span class='Parentheses'>(</span><a href="path.c.html#LN853"><span class='Ref_to_Parameter'>path</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
 
<span class='Comment_Multi_Line'>/* 
 *  trim_directory 
 * 
 *  Trim trailing directory from path, that is, remove any trailing slashes, 
 *  the last pathname component, and the slash just ahead of it --- but never 
 *  remove a leading slash. 
 */ 
</span><span class='Keyword'>static void 
</span><a name="LN867"></a><span class='Declare_Function'>trim_directory</span><span class='Parentheses'>(</span><span class='Keyword'>char </span><span class='Operator'>*</span><span class='Declare_Parameter'>path</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN869"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>p</span><span class='Delimiter'>; 
</span> 
    <a href="path.c.html#LN867"><span class='Ref_to_Parameter'>path</span></a> <span class='Operator'>= </span><a href="path.c.html#LN60"><span class='Ref_to_Func'>skip_drive</span></a><span class='Parentheses'>(</span><a href="path.c.html#LN867"><span class='Ref_to_Parameter'>path</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="path.c.html#LN867"><span class='Ref_to_Parameter'>path</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>] </span><span class='Operator'>== </span><span class='String'>'\0'</span><span class='Parentheses'>) 
</span>        <span class='Control'>return</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* back up over trailing slash(es) */ 
</span>    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="path.c.html#LN869"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>= </span><a href="path.c.html#LN867"><span class='Ref_to_Parameter'>path</span></a> <span class='Operator'>+ </span>strlen<span class='Parentheses'>(</span><a href="path.c.html#LN867"><span class='Ref_to_Parameter'>path</span></a><span class='Parentheses'>) </span><span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>; </span><a href="../include/port.h.html#LN74"><span class='Ref_to_Macro'>IS_DIR_SEP</span></a><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="path.c.html#LN869"><span class='Ref_To_Local'>p</span></a><span class='Parentheses'>) </span><span class='Operator'>&& </span><a href="path.c.html#LN869"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>&GT; </span><a href="path.c.html#LN867"><span class='Ref_to_Parameter'>path</span></a><span class='Delimiter'>; </span><a href="path.c.html#LN869"><span class='Ref_To_Local'>p</span></a><span class='Operator'>--</span><span class='Parentheses'>)</span> 
        <span class='Delimiter'>; 
</span>    <span class='Comment_Multi_Line'>/* back up over directory name */ 
</span>    <span class='Control'>for</span> <span class='Parentheses'>(</span><span class='Delimiter'>; </span><span class='Operator'>!</span><a href="../include/port.h.html#LN74"><span class='Ref_to_Macro'>IS_DIR_SEP</span></a><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="path.c.html#LN869"><span class='Ref_To_Local'>p</span></a><span class='Parentheses'>) </span><span class='Operator'>&& </span><a href="path.c.html#LN869"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>&GT; </span><a href="path.c.html#LN867"><span class='Ref_to_Parameter'>path</span></a><span class='Delimiter'>; </span><a href="path.c.html#LN869"><span class='Ref_To_Local'>p</span></a><span class='Operator'>--</span><span class='Parentheses'>)</span> 
        <span class='Delimiter'>; 
</span>    <span class='Comment_Multi_Line'>/* if multiple slashes before directory name, remove 'em all */ 
</span>    <span class='Control'>for</span> <span class='Parentheses'>(</span><span class='Delimiter'>; </span><a href="path.c.html#LN869"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>&GT; </span><a href="path.c.html#LN867"><span class='Ref_to_Parameter'>path</span></a> <span class='Operator'>&& </span><a href="../include/port.h.html#LN74"><span class='Ref_to_Macro'>IS_DIR_SEP</span></a><span class='Parentheses'>(</span><span class='Operator'>*</span><span class='Parentheses'>(</span><a href="path.c.html#LN869"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Parentheses'>))</span><span class='Delimiter'>; </span><a href="path.c.html#LN869"><span class='Ref_To_Local'>p</span></a><span class='Operator'>--</span><span class='Parentheses'>)</span> 
        <span class='Delimiter'>; 
</span>    <span class='Comment_Multi_Line'>/* don't erase a leading slash */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="path.c.html#LN869"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>== </span><a href="path.c.html#LN867"><span class='Ref_to_Parameter'>path</span></a> <span class='Operator'>&& </span><a href="../include/port.h.html#LN74"><span class='Ref_to_Macro'>IS_DIR_SEP</span></a><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="path.c.html#LN869"><span class='Ref_To_Local'>p</span></a><span class='Parentheses'>))</span> 
        <a href="path.c.html#LN869"><span class='Ref_To_Local'>p</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>    <span class='Operator'>*</span><a href="path.c.html#LN869"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>= </span><span class='String'>'\0'</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end trim_directory &raquo; </span> 
 
 
<span class='Comment_Multi_Line'>/* 
 *  trim_trailing_separator 
 * 
 * trim off trailing slashes, but not a leading slash 
 */ 
</span><span class='Keyword'>static void 
</span><a name="LN898"></a><span class='Declare_Function'>trim_trailing_separator</span><span class='Parentheses'>(</span><span class='Keyword'>char </span><span class='Operator'>*</span><span class='Declare_Parameter'>path</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN900"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>p</span><span class='Delimiter'>; 
</span> 
    <a href="path.c.html#LN898"><span class='Ref_to_Parameter'>path</span></a> <span class='Operator'>= </span><a href="path.c.html#LN60"><span class='Ref_to_Func'>skip_drive</span></a><span class='Parentheses'>(</span><a href="path.c.html#LN898"><span class='Ref_to_Parameter'>path</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="path.c.html#LN900"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>= </span><a href="path.c.html#LN898"><span class='Ref_to_Parameter'>path</span></a> <span class='Operator'>+ </span>strlen<span class='Parentheses'>(</span><a href="path.c.html#LN898"><span class='Ref_to_Parameter'>path</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="path.c.html#LN900"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>&GT; </span><a href="path.c.html#LN898"><span class='Ref_to_Parameter'>path</span></a><span class='Parentheses'>) 
</span>        <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="path.c.html#LN900"><span class='Ref_To_Local'>p</span></a><span class='Operator'>--</span><span class='Delimiter'>; </span><a href="path.c.html#LN900"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>&GT; </span><a href="path.c.html#LN898"><span class='Ref_to_Parameter'>path</span></a> <span class='Operator'>&& </span><a href="../include/port.h.html#LN74"><span class='Ref_to_Macro'>IS_DIR_SEP</span></a><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="path.c.html#LN900"><span class='Ref_To_Local'>p</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; </span><a href="path.c.html#LN900"><span class='Ref_To_Local'>p</span></a><span class='Operator'>--</span><span class='Parentheses'>)</span> 
            <span class='Operator'>*</span><a href="path.c.html#LN900"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>= </span><span class='String'>'\0'</span><span class='Delimiter'>; 
} 
</span></pre>
<table bgcolor='#c0c0c0' width='100%'><tr><td><a href='../../Contents.html'>Contents</a></td></tr>
</table><hr><p class='blurb' align='center'><a href='http://www.sourceinsight.com'>HTML Created by Source Insight Version 4.00.0084 Built on 2017-02-26</a></p>
</body></html>