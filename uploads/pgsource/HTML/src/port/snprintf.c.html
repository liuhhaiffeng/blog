<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta name="generator" content="Source Insight Version 4.00.0084 Built on 2017-02-26">
<meta charset='UTF-8' />
<style type='text/css'><!--
TD {background-color: #C0C0C0; font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 70%; }
.blurb {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 70%; }
.filename {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 120%; font-weight: bold; }
.dirname {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 100%; font-weight: bold; margin-top: 2.5em;}
--></style>
<title>src\port\snprintf.c</title>
<LINK REL=StyleSheet HREF="../../C_Cpp_Source_File.css" TYPE='text/css' MEDIA=screen>
</head>
<body bgcolor=#ffffff>
<table bgcolor='#c0c0c0' width='100%'>
<tr><td><p class='filename'><b>src\port\snprintf.c</b></p></td>
<td align='right'>
Wed Jun 14 08:26:14 2017
</td></tr>
<tr><td><a href='../../Contents.html'>Contents</a></td></tr>
</table>
<pre>
<span class='Comment_Multi_Line'>/* 
 * Copyright (c) 1983, 1995, 1996 Eric P. Allman 
 * Copyright (c) 1988, 1993 
 *  The Regents of the University of California.  All rights reserved. 
 * 
 * Redistribution and use in source and binary forms, with or without 
 * modification, are permitted provided that the following conditions 
 * are met: 
 * 1. Redistributions of source code must retain the above copyright 
 *    notice, this list of conditions and the following disclaimer. 
 * 2. Redistributions in binary form must reproduce the above copyright 
 *    notice, this list of conditions and the following disclaimer in the 
 *    documentation and/or other materials provided with the distribution. 
 * 3. Neither the name of the University nor the names of its contributors 
 *    may be used to endorse or promote products derived from this software 
 *    without specific prior written permission. 
 * 
 * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND 
 * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE 
 * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE 
 * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE 
 * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL 
 * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS 
 * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) 
 * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT 
 * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY 
 * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF 
 * SUCH DAMAGE. 
 * 
 * src/port/snprintf.c 
 */ 
</span> 
<span class='Keyword'>#include </span><span class='String'>"c.h"</span> 
 
<span class='Keyword'>#include </span><span class='String'>&LT;ctype.h&GT;</span> 
<span class='Directive'>#ifdef</span> _MSC_VER 
<span class='Keyword'>#include </span><span class='String'>&LT;float.h&GT;</span>              <span class='Comment_Single_Line'>/* for _isnan */ 
</span><span class='Directive'>#endif</span> 
<span class='Keyword'>#include </span><span class='String'>&LT;limits.h&GT;</span> 
<span class='Keyword'>#include </span><span class='String'>&LT;math.h&GT;</span> 
<span class='Directive'>#ifndef</span> <a href="../include/c.h.html#LN61"><span class='Ref_to_Const'>WIN32</span></a> 
<span class='Keyword'>#include </span><span class='String'>&LT;sys/ioctl.h&GT;</span> 
<span class='Directive'>#endif</span> 
<span class='Keyword'>#include </span><span class='String'>&LT;sys/param.h&GT;</span> 
 
<span class='Directive'>#ifndef</span> <a href="snprintf.c.html#LN46"><span class='Ref_to_Const'>NL_ARGMAX</span></a> 
<a name="LN46"></a><span class='Keyword'>#define </span><span class='Declare_Constant'>NL_ARGMAX</span> <span class='Number'>16</span> 
<span class='Directive'>#endif</span> 
 
 
<span class='Comment_Multi_Line'>/* 
 *  SNPRINTF, VSNPRINTF and friends 
 * 
 * These versions have been grabbed off the net.  They have been 
 * cleaned up to compile properly and support for most of the Single Unix 
 * Specification has been added.  Remaining unimplemented features are: 
 * 
 * 1. No locale support: the radix character is always '.' and the ' 
 * (single quote) format flag is ignored. 
 * 
 * 2. No support for the "%n" format specification. 
 * 
 * 3. No support for wide characters ("lc" and "ls" formats). 
 * 
 * 4. No support for "long double" ("Lf" and related formats). 
 * 
 * 5. Space and '#' flags are not implemented. 
 * 
 * 
 * The result values of these functions are not the same across different 
 * platforms.  This implementation is compatible with the Single Unix Spec: 
 * 
 * 1. -1 is returned only if processing is abandoned due to an invalid 
 * parameter, such as incorrect format string.  (Although not required by 
 * the spec, this happens only when no characters have yet been transmitted 
 * to the destination.) 
 * 
 * 2. For snprintf and sprintf, 0 is returned if str == NULL or count == 0; 
 * no data has been stored. 
 * 
 * 3. Otherwise, the number of bytes actually transmitted to the destination 
 * is returned (excluding the trailing '\0' for snprintf and sprintf). 
 * 
 * For snprintf with nonzero count, the result cannot be more than count-1 
 * (a trailing '\0' is always stored); it is not possible to distinguish 
 * buffer overrun from exact fit.  This is unlike some implementations that 
 * return the number of bytes that would have been needed for the complete 
 * result string. 
 */ 
</span> 
<span class='Comment_Multi_Line'>/************************************************************** 
 * Original: 
 * Patrick Powell Tue Apr 11 09:48:21 PDT 1995 
 * A bombproof version of doprnt (dopr) included. 
 * Sigh.  This sort of thing is always nasty do deal with.  Note that 
 * the version here does not include floating point. (now it does ... tgl) 
 **************************************************************/ 
</span> 
<span class='Comment_Multi_Line'>/* Prevent recursion */ 
</span><span class='Keyword'>#undef</span>  <a href="../pl/plperl/plperl.h.html#LN59"><span class='Ref_to_Macro'>vsnprintf</span></a> 
<span class='Keyword'>#undef</span>  <a href="../pl/plperl/plperl.h.html#LN60"><span class='Ref_to_Macro'>snprintf</span></a> 
<span class='Keyword'>#undef</span>  <a href="../include/port.h.html#LN170"><span class='Ref_to_Macro'>sprintf</span></a> 
<span class='Keyword'>#undef</span>  <a href="../include/port.h.html#LN171"><span class='Ref_to_Macro'>vfprintf</span></a> 
<span class='Keyword'>#undef</span>  <a href="../../contrib/seg/segscan.l.html#LN10"><span class='Ref_to_Macro'>fprintf</span></a> 
<span class='Keyword'>#undef</span>  <a href="../include/port.h.html#LN173"><span class='Ref_to_Macro'>printf</span></a> 
 
<span class='Comment_Multi_Line'>/* Info about where the formatted output is going */ 
</span><span class='Control'>typedef</span> <span class='Control'>struct</span> 
<span class='Delimiter'>{ 
</span><a name="LN109"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Member'>bufptr</span><span class='Delimiter'>;</span>         <span class='Comment_Single_Line'>/* next buffer output position */ 
</span><a name="LN110"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Member'>bufstart</span><span class='Delimiter'>;</span>       <span class='Comment_Single_Line'>/* first buffer element */ 
</span><a name="LN111"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Member'>bufend</span><span class='Delimiter'>;</span>         <span class='Comment_Single_Line'>/* last buffer element, or NULL */ 
</span>    <span class='Comment_Multi_Line'>/* bufend == NULL is for sprintf, where we assume buf is big enough */ 
</span><a name="LN113"></a>    FILE       <span class='Operator'>*</span><span class='Declare_Member'>stream</span><span class='Delimiter'>;</span>         <span class='Comment_Single_Line'>/* eventual output destination, or NULL */ 
</span><a name="LN114"></a>    <span class='Keyword'>int</span>         <span class='Declare_Member'>nchars</span><span class='Delimiter'>;</span>         <span class='Comment_Single_Line'>/* # chars already sent to stream */ 
</span><a name="LN115"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Member'>failed</span><span class='Delimiter'>;</span>         <span class='Comment_Single_Line'>/* call is a failure; errno is set */ 
</span><a name="LN116"></a><span class='Delimiter'>} </span><span class='Declare_Typedef'>PrintfTarget</span><span class='Delimiter'>; 
</span> 
<span class='Comment_Multi_Line'>/* 
 * Info about the type and value of a formatting parameter.  Note that we 
 * don't currently support "long double", "wint_t", or "wchar_t *" data, 
 * nor the '%n' formatting code; else we'd need more types.  Also, at this 
 * level we need not worry about signed vs unsigned values. 
 */ 
</span><span class='Control'>typedef</span> <span class='Control'>enum</span> 
<span class='Delimiter'>{ 
</span><a name="LN126"></a>    <span class='Declare_Enum_Const'>ATYPE_NONE</span> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>, 
</span><a name="LN127"></a>    <span class='Declare_Enum_Const'>ATYPE_INT</span><span class='Delimiter'>, 
</span><a name="LN128"></a>    <span class='Declare_Enum_Const'>ATYPE_LONG</span><span class='Delimiter'>, 
</span><a name="LN129"></a>    <span class='Declare_Enum_Const'>ATYPE_LONGLONG</span><span class='Delimiter'>, 
</span><a name="LN130"></a>    <span class='Declare_Enum_Const'>ATYPE_DOUBLE</span><span class='Delimiter'>, 
</span><a name="LN131"></a>    <span class='Declare_Enum_Const'>ATYPE_CHARPTR</span> 
<a name="LN132"></a><span class='Delimiter'>} </span><span class='Declare_Typedef'>PrintfArgType</span><span class='Delimiter'>; 
</span> 
<span class='Control'>typedef</span> <span class='Control'>union</span> 
<span class='Delimiter'>{ 
</span><a name="LN136"></a>    <span class='Keyword'>int</span>         <span class='Declare_Member'>i</span><span class='Delimiter'>; 
</span><a name="LN137"></a>    <span class='Keyword'>long</span>        <span class='Declare_Member'>l</span><span class='Delimiter'>; 
</span><a name="LN138"></a>    <a href="../include/c.h.html#LN294"><span class='Ref_to_Typedef'>int64</span></a>       <span class='Declare_Member'>ll</span><span class='Delimiter'>; 
</span><a name="LN139"></a>    <span class='Keyword'>double</span>      <span class='Declare_Member'>d</span><span class='Delimiter'>; 
</span><a name="LN140"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Member'>cptr</span><span class='Delimiter'>; 
</span><a name="LN141"></a>} <span class='Declare_Typedef'>PrintfArgValue</span><span class='Delimiter'>; 
</span> 
 
<a name="LN144"></a><span class='Keyword'>static void </span><span class='Declare_Prototype'>flushbuffer</span><span class='Parentheses'>(</span><a href="snprintf.c.html#LN107"><span class='Ref_to_Typedef'>PrintfTarget</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>target</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN145"></a><span class='Keyword'>static void </span><span class='Declare_Prototype'>dopr</span><span class='Parentheses'>(</span><a href="snprintf.c.html#LN107"><span class='Ref_to_Typedef'>PrintfTarget</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>target</span><span class='Delimiter'>, </span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>format</span><span class='Delimiter'>, </span>va_list <span class='Declare_Parameter'>args</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
 
<span class='Keyword'>int 
</span><a name="LN149"></a><span class='Declare_Function'>pg_vsnprintf</span><span class='Parentheses'>(</span><span class='Keyword'>char </span><span class='Operator'>*</span><span class='Declare_Parameter'>str</span><span class='Delimiter'>, </span>size_t <span class='Declare_Parameter'>count</span><span class='Delimiter'>, </span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>fmt</span><span class='Delimiter'>, </span>va_list <span class='Declare_Parameter'>args</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN151"></a>    <a href="snprintf.c.html#LN107"><span class='Ref_to_Typedef'>PrintfTarget</span></a> <span class='Declare_Local'>target</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="snprintf.c.html#LN149"><span class='Ref_to_Parameter'>str</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL </span><span class='Operator'>|| </span><a href="snprintf.c.html#LN149"><span class='Ref_to_Parameter'>count</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <span class='Number'>0</span><span class='Delimiter'>; 
</span>    <a href="snprintf.c.html#LN151"><span class='Ref_To_Local'>target</span></a><span class='Operator'>.</span><a href="snprintf.c.html#LN110"><span class='Ref_to_Member'>bufstart</span></a> <span class='Operator'>= </span><a href="snprintf.c.html#LN151"><span class='Ref_To_Local'>target</span></a><span class='Operator'>.</span><a href="snprintf.c.html#LN109"><span class='Ref_to_Member'>bufptr</span></a> <span class='Operator'>= </span><a href="snprintf.c.html#LN149"><span class='Ref_to_Parameter'>str</span></a><span class='Delimiter'>; 
</span>    <a href="snprintf.c.html#LN151"><span class='Ref_To_Local'>target</span></a><span class='Operator'>.</span><a href="snprintf.c.html#LN111"><span class='Ref_to_Member'>bufend</span></a> <span class='Operator'>= </span><a href="snprintf.c.html#LN149"><span class='Ref_to_Parameter'>str</span></a> <span class='Operator'>+ </span><a href="snprintf.c.html#LN149"><span class='Ref_to_Parameter'>count</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <a href="snprintf.c.html#LN151"><span class='Ref_To_Local'>target</span></a><span class='Operator'>.</span><a href="snprintf.c.html#LN113"><span class='Ref_to_Member'>stream</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <span class='Comment_Multi_Line'>/* target.nchars is unused in this case */ 
</span>    <a href="snprintf.c.html#LN151"><span class='Ref_To_Local'>target</span></a><span class='Operator'>.</span><a href="snprintf.c.html#LN115"><span class='Ref_to_Member'>failed</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>    <a href="snprintf.c.html#LN145"><span class='Ref_to_Proto'>dopr</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="snprintf.c.html#LN151"><span class='Ref_To_Local'>target</span></a><span class='Delimiter'>, </span><a href="snprintf.c.html#LN149"><span class='Ref_to_Parameter'>fmt</span></a><span class='Delimiter'>, </span><a href="snprintf.c.html#LN149"><span class='Ref_to_Parameter'>args</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Operator'>*</span><span class='Parentheses'>(</span><a href="snprintf.c.html#LN151"><span class='Ref_To_Local'>target</span></a><span class='Operator'>.</span><a href="snprintf.c.html#LN109"><span class='Ref_to_Member'>bufptr</span></a><span class='Parentheses'>) </span><span class='Operator'>= </span><span class='String'>'\0'</span><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <a href="snprintf.c.html#LN151"><span class='Ref_To_Local'>target</span></a><span class='Operator'>.</span><a href="snprintf.c.html#LN115"><span class='Ref_to_Member'>failed</span></a> <span class='Operator'>? -</span><span class='Number'>1</span> <span class='Operator'>: </span><span class='Parentheses'>(</span><a href="snprintf.c.html#LN151"><span class='Ref_To_Local'>target</span></a><span class='Operator'>.</span><a href="snprintf.c.html#LN109"><span class='Ref_to_Member'>bufptr</span></a> <span class='Operator'>- </span><a href="snprintf.c.html#LN151"><span class='Ref_To_Local'>target</span></a><span class='Operator'>.</span><a href="snprintf.c.html#LN110"><span class='Ref_to_Member'>bufstart</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Keyword'>int 
</span><a name="LN166"></a><span class='Declare_Function'>pg_snprintf</span><span class='Parentheses'>(</span><span class='Keyword'>char </span><span class='Operator'>*</span><span class='Declare_Parameter'>str</span><span class='Delimiter'>, </span>size_t <span class='Declare_Parameter'>count</span><span class='Delimiter'>, </span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>fmt</span><span class='Delimiter'>,</span><span class='Operator'>...</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN168"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>len</span><span class='Delimiter'>; 
</span><a name="LN169"></a>    va_list     <span class='Declare_Local'>args</span><span class='Delimiter'>; 
</span> 
    <a href="../pl/plperl/ppport.h.html#LN5587"><span class='Ref_to_Proto'>va_start</span></a><span class='Parentheses'>(</span><a href="snprintf.c.html#LN169"><span class='Ref_To_Local'>args</span></a><span class='Delimiter'>, </span><a href="snprintf.c.html#LN166"><span class='Ref_to_Parameter'>fmt</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="snprintf.c.html#LN168"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>= </span><a href="snprintf.c.html#LN148"><span class='Ref_to_Func'>pg_vsnprintf</span></a><span class='Parentheses'>(</span><a href="snprintf.c.html#LN166"><span class='Ref_to_Parameter'>str</span></a><span class='Delimiter'>, </span><a href="snprintf.c.html#LN166"><span class='Ref_to_Parameter'>count</span></a><span class='Delimiter'>, </span><a href="snprintf.c.html#LN166"><span class='Ref_to_Parameter'>fmt</span></a><span class='Delimiter'>, </span><a href="snprintf.c.html#LN169"><span class='Ref_To_Local'>args</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../pl/plperl/ppport.h.html#LN5589"><span class='Ref_to_Proto'>va_end</span></a><span class='Parentheses'>(</span><a href="snprintf.c.html#LN169"><span class='Ref_To_Local'>args</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <a href="snprintf.c.html#LN168"><span class='Ref_To_Local'>len</span></a><span class='Delimiter'>; 
} 
</span> 
<span class='Keyword'>static int 
</span><a name="LN178"></a><span class='Declare_Function'>pg_vsprintf</span><span class='Parentheses'>(</span><span class='Keyword'>char </span><span class='Operator'>*</span><span class='Declare_Parameter'>str</span><span class='Delimiter'>, </span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>fmt</span><span class='Delimiter'>, </span>va_list <span class='Declare_Parameter'>args</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN180"></a>    <a href="snprintf.c.html#LN107"><span class='Ref_to_Typedef'>PrintfTarget</span></a> <span class='Declare_Local'>target</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="snprintf.c.html#LN178"><span class='Ref_to_Parameter'>str</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <span class='Number'>0</span><span class='Delimiter'>; 
</span>    <a href="snprintf.c.html#LN180"><span class='Ref_To_Local'>target</span></a><span class='Operator'>.</span><a href="snprintf.c.html#LN110"><span class='Ref_to_Member'>bufstart</span></a> <span class='Operator'>= </span><a href="snprintf.c.html#LN180"><span class='Ref_To_Local'>target</span></a><span class='Operator'>.</span><a href="snprintf.c.html#LN109"><span class='Ref_to_Member'>bufptr</span></a> <span class='Operator'>= </span><a href="snprintf.c.html#LN178"><span class='Ref_to_Parameter'>str</span></a><span class='Delimiter'>; 
</span>    <a href="snprintf.c.html#LN180"><span class='Ref_To_Local'>target</span></a><span class='Operator'>.</span><a href="snprintf.c.html#LN111"><span class='Ref_to_Member'>bufend</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="snprintf.c.html#LN180"><span class='Ref_To_Local'>target</span></a><span class='Operator'>.</span><a href="snprintf.c.html#LN113"><span class='Ref_to_Member'>stream</span></a> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <span class='Comment_Multi_Line'>/* target.nchars is unused in this case */ 
</span>    <a href="snprintf.c.html#LN180"><span class='Ref_To_Local'>target</span></a><span class='Operator'>.</span><a href="snprintf.c.html#LN115"><span class='Ref_to_Member'>failed</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>    <a href="snprintf.c.html#LN145"><span class='Ref_to_Proto'>dopr</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="snprintf.c.html#LN180"><span class='Ref_To_Local'>target</span></a><span class='Delimiter'>, </span><a href="snprintf.c.html#LN178"><span class='Ref_to_Parameter'>fmt</span></a><span class='Delimiter'>, </span><a href="snprintf.c.html#LN178"><span class='Ref_to_Parameter'>args</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Operator'>*</span><span class='Parentheses'>(</span><a href="snprintf.c.html#LN180"><span class='Ref_To_Local'>target</span></a><span class='Operator'>.</span><a href="snprintf.c.html#LN109"><span class='Ref_to_Member'>bufptr</span></a><span class='Parentheses'>) </span><span class='Operator'>= </span><span class='String'>'\0'</span><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <a href="snprintf.c.html#LN180"><span class='Ref_To_Local'>target</span></a><span class='Operator'>.</span><a href="snprintf.c.html#LN115"><span class='Ref_to_Member'>failed</span></a> <span class='Operator'>? -</span><span class='Number'>1</span> <span class='Operator'>: </span><span class='Parentheses'>(</span><a href="snprintf.c.html#LN180"><span class='Ref_To_Local'>target</span></a><span class='Operator'>.</span><a href="snprintf.c.html#LN109"><span class='Ref_to_Member'>bufptr</span></a> <span class='Operator'>- </span><a href="snprintf.c.html#LN180"><span class='Ref_To_Local'>target</span></a><span class='Operator'>.</span><a href="snprintf.c.html#LN110"><span class='Ref_to_Member'>bufstart</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Keyword'>int 
</span><a name="LN195"></a><span class='Declare_Function'>pg_sprintf</span><span class='Parentheses'>(</span><span class='Keyword'>char </span><span class='Operator'>*</span><span class='Declare_Parameter'>str</span><span class='Delimiter'>, </span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>fmt</span><span class='Delimiter'>,</span><span class='Operator'>...</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN197"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>len</span><span class='Delimiter'>; 
</span><a name="LN198"></a>    va_list     <span class='Declare_Local'>args</span><span class='Delimiter'>; 
</span> 
    <a href="../pl/plperl/ppport.h.html#LN5587"><span class='Ref_to_Proto'>va_start</span></a><span class='Parentheses'>(</span><a href="snprintf.c.html#LN198"><span class='Ref_To_Local'>args</span></a><span class='Delimiter'>, </span><a href="snprintf.c.html#LN195"><span class='Ref_to_Parameter'>fmt</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="snprintf.c.html#LN197"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>= </span><a href="snprintf.c.html#LN177"><span class='Ref_to_Func'>pg_vsprintf</span></a><span class='Parentheses'>(</span><a href="snprintf.c.html#LN195"><span class='Ref_to_Parameter'>str</span></a><span class='Delimiter'>, </span><a href="snprintf.c.html#LN195"><span class='Ref_to_Parameter'>fmt</span></a><span class='Delimiter'>, </span><a href="snprintf.c.html#LN198"><span class='Ref_To_Local'>args</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../pl/plperl/ppport.h.html#LN5589"><span class='Ref_to_Proto'>va_end</span></a><span class='Parentheses'>(</span><a href="snprintf.c.html#LN198"><span class='Ref_To_Local'>args</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <a href="snprintf.c.html#LN197"><span class='Ref_To_Local'>len</span></a><span class='Delimiter'>; 
} 
</span> 
<span class='Keyword'>int 
</span><a name="LN207"></a><span class='Declare_Function'>pg_vfprintf</span><span class='Parentheses'>(</span>FILE <span class='Operator'>*</span><span class='Declare_Parameter'>stream</span><span class='Delimiter'>, </span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>fmt</span><span class='Delimiter'>, </span>va_list <span class='Declare_Parameter'>args</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN209"></a>    <a href="snprintf.c.html#LN107"><span class='Ref_to_Typedef'>PrintfTarget</span></a> <span class='Declare_Local'>target</span><span class='Delimiter'>; 
</span><a name="LN210"></a>    <span class='Keyword'>char</span>        <span class='Declare_Local'>buffer</span><span class='Delimiter'>[</span><span class='Number'>1024</span><span class='Delimiter'>];</span>   <span class='Comment_Single_Line'>/* size is arbitrary */ 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="snprintf.c.html#LN207"><span class='Ref_to_Parameter'>stream</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        errno <span class='Operator'>= </span>EINVAL<span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <a href="snprintf.c.html#LN209"><span class='Ref_To_Local'>target</span></a><span class='Operator'>.</span><a href="snprintf.c.html#LN110"><span class='Ref_to_Member'>bufstart</span></a> <span class='Operator'>= </span><a href="snprintf.c.html#LN209"><span class='Ref_To_Local'>target</span></a><span class='Operator'>.</span><a href="snprintf.c.html#LN109"><span class='Ref_to_Member'>bufptr</span></a> <span class='Operator'>= </span><a href="snprintf.c.html#LN210"><span class='Ref_To_Local'>buffer</span></a><span class='Delimiter'>; 
</span>    <a href="snprintf.c.html#LN209"><span class='Ref_To_Local'>target</span></a><span class='Operator'>.</span><a href="snprintf.c.html#LN111"><span class='Ref_to_Member'>bufend</span></a> <span class='Operator'>= </span><a href="snprintf.c.html#LN210"><span class='Ref_To_Local'>buffer</span></a> <span class='Operator'>+ </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="snprintf.c.html#LN210"><span class='Ref_To_Local'>buffer</span></a><span class='Parentheses'>) </span><span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>    <a href="snprintf.c.html#LN209"><span class='Ref_To_Local'>target</span></a><span class='Operator'>.</span><a href="snprintf.c.html#LN113"><span class='Ref_to_Member'>stream</span></a> <span class='Operator'>= </span><a href="snprintf.c.html#LN207"><span class='Ref_to_Parameter'>stream</span></a><span class='Delimiter'>; 
</span>    <a href="snprintf.c.html#LN209"><span class='Ref_To_Local'>target</span></a><span class='Operator'>.</span><a href="snprintf.c.html#LN114"><span class='Ref_to_Member'>nchars</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <a href="snprintf.c.html#LN209"><span class='Ref_To_Local'>target</span></a><span class='Operator'>.</span><a href="snprintf.c.html#LN115"><span class='Ref_to_Member'>failed</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>    <a href="snprintf.c.html#LN145"><span class='Ref_to_Proto'>dopr</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="snprintf.c.html#LN209"><span class='Ref_To_Local'>target</span></a><span class='Delimiter'>, </span><a href="snprintf.c.html#LN207"><span class='Ref_to_Parameter'>fmt</span></a><span class='Delimiter'>, </span><a href="snprintf.c.html#LN207"><span class='Ref_to_Parameter'>args</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Comment_Multi_Line'>/* dump any remaining buffer contents */ 
</span>    <a href="snprintf.c.html#LN144"><span class='Ref_to_Proto'>flushbuffer</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="snprintf.c.html#LN209"><span class='Ref_To_Local'>target</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <a href="snprintf.c.html#LN209"><span class='Ref_To_Local'>target</span></a><span class='Operator'>.</span><a href="snprintf.c.html#LN115"><span class='Ref_to_Member'>failed</span></a> <span class='Operator'>? -</span><span class='Number'>1</span> <span class='Operator'>: </span><a href="snprintf.c.html#LN209"><span class='Ref_To_Local'>target</span></a><span class='Operator'>.</span><a href="snprintf.c.html#LN114"><span class='Ref_to_Member'>nchars</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end pg_vfprintf &raquo; </span> 
 
<span class='Keyword'>int 
</span><a name="LN229"></a><span class='Declare_Function'>pg_fprintf</span><span class='Parentheses'>(</span>FILE <span class='Operator'>*</span><span class='Declare_Parameter'>stream</span><span class='Delimiter'>, </span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>fmt</span><span class='Delimiter'>,</span><span class='Operator'>...</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN231"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>len</span><span class='Delimiter'>; 
</span><a name="LN232"></a>    va_list     <span class='Declare_Local'>args</span><span class='Delimiter'>; 
</span> 
    <a href="../pl/plperl/ppport.h.html#LN5587"><span class='Ref_to_Proto'>va_start</span></a><span class='Parentheses'>(</span><a href="snprintf.c.html#LN232"><span class='Ref_To_Local'>args</span></a><span class='Delimiter'>, </span><a href="snprintf.c.html#LN229"><span class='Ref_to_Parameter'>fmt</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="snprintf.c.html#LN231"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>= </span><a href="../include/port.h.html#LN158"><span class='Ref_to_Proto'>pg_vfprintf</span></a><span class='Parentheses'>(</span><a href="snprintf.c.html#LN229"><span class='Ref_to_Parameter'>stream</span></a><span class='Delimiter'>, </span><a href="snprintf.c.html#LN229"><span class='Ref_to_Parameter'>fmt</span></a><span class='Delimiter'>, </span><a href="snprintf.c.html#LN232"><span class='Ref_To_Local'>args</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../pl/plperl/ppport.h.html#LN5589"><span class='Ref_to_Proto'>va_end</span></a><span class='Parentheses'>(</span><a href="snprintf.c.html#LN232"><span class='Ref_To_Local'>args</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <a href="snprintf.c.html#LN231"><span class='Ref_To_Local'>len</span></a><span class='Delimiter'>; 
} 
</span> 
<span class='Keyword'>int 
</span><a name="LN241"></a><span class='Declare_Function'>pg_printf</span><span class='Parentheses'>(</span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>fmt</span><span class='Delimiter'>,</span><span class='Operator'>...</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN243"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>len</span><span class='Delimiter'>; 
</span><a name="LN244"></a>    va_list     <span class='Declare_Local'>args</span><span class='Delimiter'>; 
</span> 
    <a href="../pl/plperl/ppport.h.html#LN5587"><span class='Ref_to_Proto'>va_start</span></a><span class='Parentheses'>(</span><a href="snprintf.c.html#LN244"><span class='Ref_To_Local'>args</span></a><span class='Delimiter'>, </span><a href="snprintf.c.html#LN241"><span class='Ref_to_Parameter'>fmt</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="snprintf.c.html#LN243"><span class='Ref_To_Local'>len</span></a> <span class='Operator'>= </span><a href="../include/port.h.html#LN158"><span class='Ref_to_Proto'>pg_vfprintf</span></a><span class='Parentheses'>(</span>stdout<span class='Delimiter'>, </span><a href="snprintf.c.html#LN241"><span class='Ref_to_Parameter'>fmt</span></a><span class='Delimiter'>, </span><a href="snprintf.c.html#LN244"><span class='Ref_To_Local'>args</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="../pl/plperl/ppport.h.html#LN5589"><span class='Ref_to_Proto'>va_end</span></a><span class='Parentheses'>(</span><a href="snprintf.c.html#LN244"><span class='Ref_To_Local'>args</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <a href="snprintf.c.html#LN243"><span class='Ref_To_Local'>len</span></a><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * Attempt to write the entire buffer to target-&GT;stream; discard the entire 
 * buffer in any case.  Call this only when target-&GT;stream is defined. 
 */ 
</span><span class='Keyword'>static void 
</span><a name="LN257"></a><span class='Declare_Function'>flushbuffer</span><span class='Parentheses'>(</span><a href="snprintf.c.html#LN107"><span class='Ref_to_Typedef'>PrintfTarget</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>target</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN259"></a>    size_t      <span class='Declare_Local'>nc</span> <span class='Operator'>= </span><a href="snprintf.c.html#LN257"><span class='Ref_to_Parameter'>target</span></a><span class='Operator'>-&GT;</span><a href="snprintf.c.html#LN109"><span class='Ref_to_Member'>bufptr</span></a> <span class='Operator'>- </span><a href="snprintf.c.html#LN257"><span class='Ref_to_Parameter'>target</span></a><span class='Operator'>-&GT;</span><a href="snprintf.c.html#LN110"><span class='Ref_to_Member'>bufstart</span></a><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="snprintf.c.html#LN257"><span class='Ref_to_Parameter'>target</span></a><span class='Operator'>-&GT;</span><a href="snprintf.c.html#LN115"><span class='Ref_to_Member'>failed</span></a> <span class='Operator'>&& </span><a href="snprintf.c.html#LN259"><span class='Ref_To_Local'>nc</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN263"></a>        size_t      <span class='Declare_Local'>written</span><span class='Delimiter'>; 
</span> 
        <a href="snprintf.c.html#LN263"><span class='Ref_To_Local'>written</span></a> <span class='Operator'>= </span>fwrite<span class='Parentheses'>(</span><a href="snprintf.c.html#LN257"><span class='Ref_to_Parameter'>target</span></a><span class='Operator'>-&GT;</span><a href="snprintf.c.html#LN110"><span class='Ref_to_Member'>bufstart</span></a><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Delimiter'>, </span><a href="snprintf.c.html#LN259"><span class='Ref_To_Local'>nc</span></a><span class='Delimiter'>, </span><a href="snprintf.c.html#LN257"><span class='Ref_to_Parameter'>target</span></a><span class='Operator'>-&GT;</span><a href="snprintf.c.html#LN113"><span class='Ref_to_Member'>stream</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="snprintf.c.html#LN257"><span class='Ref_to_Parameter'>target</span></a><span class='Operator'>-&GT;</span><a href="snprintf.c.html#LN114"><span class='Ref_to_Member'>nchars</span></a> <span class='Operator'>+= </span><a href="snprintf.c.html#LN263"><span class='Ref_To_Local'>written</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="snprintf.c.html#LN263"><span class='Ref_To_Local'>written</span></a> <span class='Operator'>!= </span><a href="snprintf.c.html#LN259"><span class='Ref_To_Local'>nc</span></a><span class='Parentheses'>) 
</span>            <a href="snprintf.c.html#LN257"><span class='Ref_to_Parameter'>target</span></a><span class='Operator'>-&GT;</span><a href="snprintf.c.html#LN115"><span class='Ref_to_Member'>failed</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <a href="snprintf.c.html#LN257"><span class='Ref_to_Parameter'>target</span></a><span class='Operator'>-&GT;</span><a href="snprintf.c.html#LN109"><span class='Ref_to_Member'>bufptr</span></a> <span class='Operator'>= </span><a href="snprintf.c.html#LN257"><span class='Ref_to_Parameter'>target</span></a><span class='Operator'>-&GT;</span><a href="snprintf.c.html#LN110"><span class='Ref_to_Member'>bufstart</span></a><span class='Delimiter'>; 
} 
</span> 
 
<a name="LN274"></a><span class='Keyword'>static void </span><span class='Declare_Prototype'>fmtstr</span><span class='Parentheses'>(</span><span class='Keyword'>char </span><span class='Operator'>*</span><span class='Declare_Parameter'>value</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>leftjust</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>minlen</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>maxwidth</span><span class='Delimiter'>, 
</span><a name="LN275"></a>       <span class='Keyword'>int </span><span class='Declare_Parameter'>pointflag</span><span class='Delimiter'>, </span><a href="snprintf.c.html#LN107"><span class='Ref_to_Typedef'>PrintfTarget</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>target</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN276"></a><span class='Keyword'>static void </span><span class='Declare_Prototype'>fmtptr</span><span class='Parentheses'>(</span><span class='Keyword'>void </span><span class='Operator'>*</span><span class='Declare_Parameter'>value</span><span class='Delimiter'>, </span><a href="snprintf.c.html#LN107"><span class='Ref_to_Typedef'>PrintfTarget</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>target</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN277"></a><span class='Keyword'>static void </span><span class='Declare_Prototype'>fmtint</span><span class='Parentheses'>(</span><a href="../include/c.h.html#LN294"><span class='Ref_to_Typedef'>int64</span></a> <span class='Declare_Parameter'>value</span><span class='Delimiter'>, </span><span class='Keyword'>char </span><span class='Declare_Parameter'>type</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>forcesign</span><span class='Delimiter'>, 
</span><a name="LN278"></a>       <span class='Keyword'>int </span><span class='Declare_Parameter'>leftjust</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>minlen</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>zpad</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>precision</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>pointflag</span><span class='Delimiter'>, 
</span><a name="LN279"></a>       <a href="snprintf.c.html#LN107"><span class='Ref_to_Typedef'>PrintfTarget</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>target</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN280"></a><span class='Keyword'>static void </span><span class='Declare_Prototype'>fmtchar</span><span class='Parentheses'>(</span><span class='Keyword'>int </span><span class='Declare_Parameter'>value</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>leftjust</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>minlen</span><span class='Delimiter'>, </span><a href="snprintf.c.html#LN107"><span class='Ref_to_Typedef'>PrintfTarget</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>target</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN281"></a><span class='Keyword'>static void </span><span class='Declare_Prototype'>fmtfloat</span><span class='Parentheses'>(</span><span class='Keyword'>double </span><span class='Declare_Parameter'>value</span><span class='Delimiter'>, </span><span class='Keyword'>char </span><span class='Declare_Parameter'>type</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>forcesign</span><span class='Delimiter'>, 
</span><a name="LN282"></a>         <span class='Keyword'>int </span><span class='Declare_Parameter'>leftjust</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>minlen</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>zpad</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>precision</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>pointflag</span><span class='Delimiter'>, 
</span><a name="LN283"></a>         <a href="snprintf.c.html#LN107"><span class='Ref_to_Typedef'>PrintfTarget</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>target</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN284"></a><span class='Keyword'>static void </span><span class='Declare_Prototype'>dostr</span><span class='Parentheses'>(</span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>str</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>slen</span><span class='Delimiter'>, </span><a href="snprintf.c.html#LN107"><span class='Ref_to_Typedef'>PrintfTarget</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>target</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN285"></a><span class='Keyword'>static void </span><span class='Declare_Prototype'>dopr_outch</span><span class='Parentheses'>(</span><span class='Keyword'>int </span><span class='Declare_Parameter'>c</span><span class='Delimiter'>, </span><a href="snprintf.c.html#LN107"><span class='Ref_to_Typedef'>PrintfTarget</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>target</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN286"></a><span class='Keyword'>static int</span>  <span class='Declare_Prototype'>adjust_sign</span><span class='Parentheses'>(</span><span class='Keyword'>int </span><span class='Declare_Parameter'>is_negative</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>forcesign</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Operator'>*</span><span class='Declare_Parameter'>signvalue</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN287"></a><span class='Keyword'>static void </span><span class='Declare_Prototype'>adjust_padlen</span><span class='Parentheses'>(</span><span class='Keyword'>int </span><span class='Declare_Parameter'>minlen</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>vallen</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>leftjust</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Operator'>*</span><span class='Declare_Parameter'>padlen</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN288"></a><span class='Keyword'>static void </span><span class='Declare_Prototype'>leading_pad</span><span class='Parentheses'>(</span><span class='Keyword'>int </span><span class='Declare_Parameter'>zpad</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Operator'>*</span><span class='Declare_Parameter'>signvalue</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Operator'>*</span><span class='Declare_Parameter'>padlen</span><span class='Delimiter'>, 
</span><a name="LN289"></a>            <a href="snprintf.c.html#LN107"><span class='Ref_to_Typedef'>PrintfTarget</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>target</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN290"></a><span class='Keyword'>static void </span><span class='Declare_Prototype'>trailing_pad</span><span class='Parentheses'>(</span><span class='Keyword'>int </span><span class='Operator'>*</span><span class='Declare_Parameter'>padlen</span><span class='Delimiter'>, </span><a href="snprintf.c.html#LN107"><span class='Ref_to_Typedef'>PrintfTarget</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>target</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
 
<span class='Comment_Multi_Line'>/* 
 * dopr(): poor man's version of doprintf 
 */ 
</span><span class='Keyword'>static void 
</span><a name="LN297"></a><span class='Declare_Function'>dopr</span><span class='Parentheses'>(</span><a href="snprintf.c.html#LN107"><span class='Ref_to_Typedef'>PrintfTarget</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>target</span><span class='Delimiter'>, </span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>format</span><span class='Delimiter'>, </span>va_list <span class='Declare_Parameter'>args</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN299"></a>    <span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Local'>format_start</span> <span class='Operator'>= </span><a href="snprintf.c.html#LN297"><span class='Ref_to_Parameter'>format</span></a><span class='Delimiter'>; 
</span><a name="LN300"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>ch</span><span class='Delimiter'>; 
</span><a name="LN301"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>have_dollar</span><span class='Delimiter'>; 
</span><a name="LN302"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>have_non_dollar</span><span class='Delimiter'>; 
</span><a name="LN303"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>have_star</span><span class='Delimiter'>; 
</span><a name="LN304"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>afterstar</span><span class='Delimiter'>; 
</span><a name="LN305"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>accum</span><span class='Delimiter'>; 
</span><a name="LN306"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>longlongflag</span><span class='Delimiter'>; 
</span><a name="LN307"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>longflag</span><span class='Delimiter'>; 
</span><a name="LN308"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>pointflag</span><span class='Delimiter'>; 
</span><a name="LN309"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>leftjust</span><span class='Delimiter'>; 
</span><a name="LN310"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>fieldwidth</span><span class='Delimiter'>; 
</span><a name="LN311"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>precision</span><span class='Delimiter'>; 
</span><a name="LN312"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>zpad</span><span class='Delimiter'>; 
</span><a name="LN313"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>forcesign</span><span class='Delimiter'>; 
</span><a name="LN314"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>last_dollar</span><span class='Delimiter'>; 
</span><a name="LN315"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>fmtpos</span><span class='Delimiter'>; 
</span><a name="LN316"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>cvalue</span><span class='Delimiter'>; 
</span><a name="LN317"></a>    <a href="../include/c.h.html#LN294"><span class='Ref_to_Typedef'>int64</span></a>       <span class='Declare_Local'>numvalue</span><span class='Delimiter'>; 
</span><a name="LN318"></a>    <span class='Keyword'>double</span>      <span class='Declare_Local'>fvalue</span><span class='Delimiter'>; 
</span><a name="LN319"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>strvalue</span><span class='Delimiter'>; 
</span><a name="LN320"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>i</span><span class='Delimiter'>; 
</span><a name="LN321"></a>    <a href="snprintf.c.html#LN124"><span class='Ref_to_Typedef'>PrintfArgType</span></a> <span class='Declare_Local'>argtypes</span><span class='Delimiter'>[</span><a href="snprintf.c.html#LN46"><span class='Ref_to_Const'>NL_ARGMAX</span></a> <span class='Operator'>+ </span><span class='Number'>1</span><span class='Delimiter'>]; 
</span><a name="LN322"></a>    <a href="snprintf.c.html#LN134"><span class='Ref_to_Typedef'>PrintfArgValue</span></a> <span class='Declare_Local'>argvalues</span><span class='Delimiter'>[</span><a href="snprintf.c.html#LN46"><span class='Ref_to_Const'>NL_ARGMAX</span></a> <span class='Operator'>+ </span><span class='Number'>1</span><span class='Delimiter'>]; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Parse the format string to determine whether there are %n$ format 
     * specs, and identify the types and order of the format parameters. 
     */ 
</span>    <a href="snprintf.c.html#LN301"><span class='Ref_To_Local'>have_dollar</span></a> <span class='Operator'>= </span><a href="snprintf.c.html#LN302"><span class='Ref_To_Local'>have_non_dollar</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>    <a href="snprintf.c.html#LN314"><span class='Ref_To_Local'>last_dollar</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <a href="../include/c.h.html#LN856"><span class='Ref_to_Macro'>MemSet</span></a><span class='Parentheses'>(</span><a href="snprintf.c.html#LN321"><span class='Ref_To_Local'>argtypes</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Delimiter'>, </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><a href="snprintf.c.html#LN321"><span class='Ref_To_Local'>argtypes</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>while</span> <span class='Parentheses'>((</span><a href="snprintf.c.html#LN300"><span class='Ref_To_Local'>ch</span></a> <span class='Operator'>= *</span><a href="snprintf.c.html#LN297"><span class='Ref_to_Parameter'>format</span></a><span class='Operator'>++</span><span class='Parentheses'>) </span><span class='Operator'>!= </span><span class='String'>'\0'</span><span class='Parentheses'>)</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="snprintf.c.html#LN300"><span class='Ref_To_Local'>ch</span></a> <span class='Operator'>!= </span><span class='String'>'%'</span><span class='Parentheses'>) 
</span>            <span class='Control'>continue</span><span class='Delimiter'>; 
</span>        <a href="snprintf.c.html#LN307"><span class='Ref_To_Local'>longflag</span></a> <span class='Operator'>= </span><a href="snprintf.c.html#LN306"><span class='Ref_To_Local'>longlongflag</span></a> <span class='Operator'>= </span><a href="snprintf.c.html#LN308"><span class='Ref_To_Local'>pointflag</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>        <a href="snprintf.c.html#LN315"><span class='Ref_To_Local'>fmtpos</span></a> <span class='Operator'>= </span><a href="snprintf.c.html#LN305"><span class='Ref_To_Local'>accum</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>        <a href="snprintf.c.html#LN304"><span class='Ref_To_Local'>afterstar</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span><a name="LN339"></a><span class='Label'>nextch1</span><span class='Operator'>: 
</span>        <a href="snprintf.c.html#LN300"><span class='Ref_To_Local'>ch</span></a> <span class='Operator'>= *</span><a href="snprintf.c.html#LN297"><span class='Ref_to_Parameter'>format</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="snprintf.c.html#LN300"><span class='Ref_To_Local'>ch</span></a> <span class='Operator'>== </span><span class='String'>'\0'</span><span class='Parentheses'>) 
</span>            <span class='Control'>break</span><span class='Delimiter'>;</span>              <span class='Comment_Single_Line'>/* illegal, but we don't complain */ 
</span>        <span class='Control'>switch</span> <span class='Parentheses'>(</span><a href="snprintf.c.html#LN300"><span class='Ref_To_Local'>ch</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Control'>case</span> <span class='String'>'-'</span><span class='Operator'>: 
</span>            <span class='Control'>case</span> <span class='String'>'+'</span><span class='Operator'>: 
</span>                <span class='Control'>goto</span> <span class='Symbol_Characters'>&uarr;</span><a href="snprintf.c.html#LN339"><span class='Ref_to_Label'>nextch1</span></a><span class='Delimiter'>; 
</span>            <span class='Control'>case</span> <span class='String'>'0'</span><span class='Operator'>: 
</span>            <span class='Control'>case</span> <span class='String'>'1'</span><span class='Operator'>: 
</span>            <span class='Control'>case</span> <span class='String'>'2'</span><span class='Operator'>: 
</span>            <span class='Control'>case</span> <span class='String'>'3'</span><span class='Operator'>: 
</span>            <span class='Control'>case</span> <span class='String'>'4'</span><span class='Operator'>: 
</span>            <span class='Control'>case</span> <span class='String'>'5'</span><span class='Operator'>: 
</span>            <span class='Control'>case</span> <span class='String'>'6'</span><span class='Operator'>: 
</span>            <span class='Control'>case</span> <span class='String'>'7'</span><span class='Operator'>: 
</span>            <span class='Control'>case</span> <span class='String'>'8'</span><span class='Operator'>: 
</span>            <span class='Control'>case</span> <span class='String'>'9'</span><span class='Operator'>: 
</span>                <a href="snprintf.c.html#LN305"><span class='Ref_To_Local'>accum</span></a> <span class='Operator'>= </span><a href="snprintf.c.html#LN305"><span class='Ref_To_Local'>accum</span></a> <span class='Operator'>* </span><span class='Number'>10</span> <span class='Operator'>+ </span><span class='Parentheses'>(</span><a href="snprintf.c.html#LN300"><span class='Ref_To_Local'>ch</span></a> <span class='Operator'>- </span><span class='String'>'0'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <span class='Control'>goto</span> <span class='Symbol_Characters'>&uarr;</span><a href="snprintf.c.html#LN339"><span class='Ref_to_Label'>nextch1</span></a><span class='Delimiter'>; 
</span>            <span class='Control'>case</span> <span class='String'>'.'</span><span class='Operator'>: 
</span>                <a href="snprintf.c.html#LN308"><span class='Ref_To_Local'>pointflag</span></a> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>                <a href="snprintf.c.html#LN305"><span class='Ref_To_Local'>accum</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>                <span class='Control'>goto</span> <span class='Symbol_Characters'>&uarr;</span><a href="snprintf.c.html#LN339"><span class='Ref_to_Label'>nextch1</span></a><span class='Delimiter'>; 
</span>            <span class='Control'>case</span> <span class='String'>'*'</span><span class='Operator'>: 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="snprintf.c.html#LN304"><span class='Ref_To_Local'>afterstar</span></a><span class='Parentheses'>) 
</span>                    <a href="snprintf.c.html#LN302"><span class='Ref_To_Local'>have_non_dollar</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>;</span>     <span class='Comment_Single_Line'>/* multiple stars */ 
</span>                <a href="snprintf.c.html#LN304"><span class='Ref_To_Local'>afterstar</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>                <a href="snprintf.c.html#LN305"><span class='Ref_To_Local'>accum</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>                <span class='Control'>goto</span> <span class='Symbol_Characters'>&uarr;</span><a href="snprintf.c.html#LN339"><span class='Ref_to_Label'>nextch1</span></a><span class='Delimiter'>; 
</span>            <span class='Control'>case</span> <span class='String'>'$'</span><span class='Operator'>: 
</span>                <a href="snprintf.c.html#LN301"><span class='Ref_To_Local'>have_dollar</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="snprintf.c.html#LN305"><span class='Ref_To_Local'>accum</span></a> <span class='Operator'>&LT;= </span><span class='Number'>0</span> <span class='Operator'>|| </span><a href="snprintf.c.html#LN305"><span class='Ref_To_Local'>accum</span></a> <span class='Operator'>&GT; </span><a href="snprintf.c.html#LN46"><span class='Ref_to_Const'>NL_ARGMAX</span></a><span class='Parentheses'>) 
</span>                    <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="snprintf.c.html#LN787"><span class='Ref_to_Label'>bad_format</span></a><span class='Delimiter'>; 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="snprintf.c.html#LN304"><span class='Ref_To_Local'>afterstar</span></a><span class='Parentheses'>) 
</span>                <span class='Delimiter'>{ 
</span>                    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="snprintf.c.html#LN321"><span class='Ref_To_Local'>argtypes</span></a><span class='Delimiter'>[</span><a href="snprintf.c.html#LN305"><span class='Ref_To_Local'>accum</span></a><span class='Delimiter'>] </span><span class='Operator'>&& 
</span>                        <a href="snprintf.c.html#LN321"><span class='Ref_To_Local'>argtypes</span></a><span class='Delimiter'>[</span><a href="snprintf.c.html#LN305"><span class='Ref_To_Local'>accum</span></a><span class='Delimiter'>] </span><span class='Operator'>!= </span><a href="snprintf.c.html#LN127"><span class='Ref_to_EnumConst'>ATYPE_INT</span></a><span class='Parentheses'>) 
</span>                        <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="snprintf.c.html#LN787"><span class='Ref_to_Label'>bad_format</span></a><span class='Delimiter'>; 
</span>                    <a href="snprintf.c.html#LN321"><span class='Ref_To_Local'>argtypes</span></a><span class='Delimiter'>[</span><a href="snprintf.c.html#LN305"><span class='Ref_To_Local'>accum</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="snprintf.c.html#LN127"><span class='Ref_to_EnumConst'>ATYPE_INT</span></a><span class='Delimiter'>; 
</span>                    <a href="snprintf.c.html#LN314"><span class='Ref_To_Local'>last_dollar</span></a> <span class='Operator'>= </span><a href="../interfaces/ecpg/pgtypeslib/numeric.c.html#LN10"><span class='Ref_to_Macro'>Max</span></a><span class='Parentheses'>(</span><a href="snprintf.c.html#LN314"><span class='Ref_To_Local'>last_dollar</span></a><span class='Delimiter'>, </span><a href="snprintf.c.html#LN305"><span class='Ref_To_Local'>accum</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                    <a href="snprintf.c.html#LN304"><span class='Ref_To_Local'>afterstar</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>                <span class='Delimiter'>} 
</span>                <span class='Control'>else</span> 
                    <a href="snprintf.c.html#LN315"><span class='Ref_To_Local'>fmtpos</span></a> <span class='Operator'>= </span><a href="snprintf.c.html#LN305"><span class='Ref_To_Local'>accum</span></a><span class='Delimiter'>; 
</span>                <a href="snprintf.c.html#LN305"><span class='Ref_To_Local'>accum</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>                <span class='Control'>goto</span> <span class='Symbol_Characters'>&uarr;</span><a href="snprintf.c.html#LN339"><span class='Ref_to_Label'>nextch1</span></a><span class='Delimiter'>; 
</span>            <span class='Control'>case</span> <span class='String'>'l'</span><span class='Operator'>: 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="snprintf.c.html#LN307"><span class='Ref_To_Local'>longflag</span></a><span class='Parentheses'>) 
</span>                    <a href="snprintf.c.html#LN306"><span class='Ref_To_Local'>longlongflag</span></a> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>                <span class='Control'>else</span> 
                    <a href="snprintf.c.html#LN307"><span class='Ref_To_Local'>longflag</span></a> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>                <span class='Control'>goto</span> <span class='Symbol_Characters'>&uarr;</span><a href="snprintf.c.html#LN339"><span class='Ref_to_Label'>nextch1</span></a><span class='Delimiter'>; 
</span>            <span class='Control'>case</span> <span class='String'>'z'</span><span class='Operator'>: 
</span><span class='Directive'>#if</span> SIZEOF_SIZE_T <span class='Operator'>== </span><span class='Number'>8</span> 
<span class='Directive'>#ifdef</span> HAVE_LONG_INT_64 
                <a href="snprintf.c.html#LN307"><span class='Ref_To_Local'>longflag</span></a> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span><span class='Directive'>#elif</span> defined<span class='Parentheses'>(</span>HAVE_LONG_LONG_INT_64<span class='Parentheses'>) 
</span>                <a href="snprintf.c.html#LN306"><span class='Ref_To_Local'>longlongflag</span></a> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span><span class='Directive'>#else</span> 
#error <span class='String'>"Don't know how to print 64bit integers"</span> 
<span class='Directive'>#endif</span> 
<span class='Directive'>#else</span> 
                <span class='Comment_Multi_Line'>/* assume size_t is same size as int */ 
</span><span class='Directive'>#endif</span> 
                <span class='Control'>goto</span> <span class='Symbol_Characters'>&uarr;</span><a href="snprintf.c.html#LN339"><span class='Ref_to_Label'>nextch1</span></a><span class='Delimiter'>; 
</span>            <span class='Control'>case</span> <span class='String'>'h'</span><span class='Operator'>: 
</span>            <span class='Control'>case</span> <span class='String'>'\''</span><span class='Operator'>: 
</span>                <span class='Comment_Multi_Line'>/* ignore these */ 
</span>                <span class='Control'>goto</span> <span class='Symbol_Characters'>&uarr;</span><a href="snprintf.c.html#LN339"><span class='Ref_to_Label'>nextch1</span></a><span class='Delimiter'>; 
</span>            <span class='Control'>case</span> <span class='String'>'d'</span><span class='Operator'>: 
</span>            <span class='Control'>case</span> <span class='String'>'i'</span><span class='Operator'>: 
</span>            <span class='Control'>case</span> <span class='String'>'o'</span><span class='Operator'>: 
</span>            <span class='Control'>case</span> <span class='String'>'u'</span><span class='Operator'>: 
</span>            <span class='Control'>case</span> <span class='String'>'x'</span><span class='Operator'>: 
</span>            <span class='Control'>case</span> <span class='String'>'X'</span><span class='Operator'>: 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="snprintf.c.html#LN315"><span class='Ref_To_Local'>fmtpos</span></a><span class='Parentheses'>) 
</span>                <span class='Delimiter'>{ 
</span><a name="LN418"></a>                    <a href="snprintf.c.html#LN124"><span class='Ref_to_Typedef'>PrintfArgType</span></a> <span class='Declare_Local'>atype</span><span class='Delimiter'>; 
</span> 
                    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="snprintf.c.html#LN306"><span class='Ref_To_Local'>longlongflag</span></a><span class='Parentheses'>) 
</span>                        <a href="snprintf.c.html#LN418"><span class='Ref_To_Local'>atype</span></a> <span class='Operator'>= </span><a href="snprintf.c.html#LN129"><span class='Ref_to_EnumConst'>ATYPE_LONGLONG</span></a><span class='Delimiter'>; 
</span>                    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="snprintf.c.html#LN307"><span class='Ref_To_Local'>longflag</span></a><span class='Parentheses'>) 
</span>                        <a href="snprintf.c.html#LN418"><span class='Ref_To_Local'>atype</span></a> <span class='Operator'>= </span><a href="snprintf.c.html#LN128"><span class='Ref_to_EnumConst'>ATYPE_LONG</span></a><span class='Delimiter'>; 
</span>                    <span class='Control'>else</span> 
                        <a href="snprintf.c.html#LN418"><span class='Ref_To_Local'>atype</span></a> <span class='Operator'>= </span><a href="snprintf.c.html#LN127"><span class='Ref_to_EnumConst'>ATYPE_INT</span></a><span class='Delimiter'>; 
</span>                    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="snprintf.c.html#LN321"><span class='Ref_To_Local'>argtypes</span></a><span class='Delimiter'>[</span><a href="snprintf.c.html#LN315"><span class='Ref_To_Local'>fmtpos</span></a><span class='Delimiter'>] </span><span class='Operator'>&& 
</span>                        <a href="snprintf.c.html#LN321"><span class='Ref_To_Local'>argtypes</span></a><span class='Delimiter'>[</span><a href="snprintf.c.html#LN315"><span class='Ref_To_Local'>fmtpos</span></a><span class='Delimiter'>] </span><span class='Operator'>!= </span><a href="snprintf.c.html#LN418"><span class='Ref_To_Local'>atype</span></a><span class='Parentheses'>) 
</span>                        <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="snprintf.c.html#LN787"><span class='Ref_to_Label'>bad_format</span></a><span class='Delimiter'>; 
</span>                    <a href="snprintf.c.html#LN321"><span class='Ref_To_Local'>argtypes</span></a><span class='Delimiter'>[</span><a href="snprintf.c.html#LN315"><span class='Ref_To_Local'>fmtpos</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="snprintf.c.html#LN418"><span class='Ref_To_Local'>atype</span></a><span class='Delimiter'>; 
</span>                    <a href="snprintf.c.html#LN314"><span class='Ref_To_Local'>last_dollar</span></a> <span class='Operator'>= </span><a href="../interfaces/ecpg/pgtypeslib/numeric.c.html#LN10"><span class='Ref_to_Macro'>Max</span></a><span class='Parentheses'>(</span><a href="snprintf.c.html#LN314"><span class='Ref_To_Local'>last_dollar</span></a><span class='Delimiter'>, </span><a href="snprintf.c.html#LN315"><span class='Ref_To_Local'>fmtpos</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <span class='Delimiter'>} 
</span>                <span class='Control'>else</span> 
                    <a href="snprintf.c.html#LN302"><span class='Ref_To_Local'>have_non_dollar</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span>            <span class='Control'>case</span> <span class='String'>'c'</span><span class='Operator'>: 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="snprintf.c.html#LN315"><span class='Ref_To_Local'>fmtpos</span></a><span class='Parentheses'>) 
</span>                <span class='Delimiter'>{ 
</span>                    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="snprintf.c.html#LN321"><span class='Ref_To_Local'>argtypes</span></a><span class='Delimiter'>[</span><a href="snprintf.c.html#LN315"><span class='Ref_To_Local'>fmtpos</span></a><span class='Delimiter'>] </span><span class='Operator'>&& 
</span>                        <a href="snprintf.c.html#LN321"><span class='Ref_To_Local'>argtypes</span></a><span class='Delimiter'>[</span><a href="snprintf.c.html#LN315"><span class='Ref_To_Local'>fmtpos</span></a><span class='Delimiter'>] </span><span class='Operator'>!= </span><a href="snprintf.c.html#LN127"><span class='Ref_to_EnumConst'>ATYPE_INT</span></a><span class='Parentheses'>) 
</span>                        <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="snprintf.c.html#LN787"><span class='Ref_to_Label'>bad_format</span></a><span class='Delimiter'>; 
</span>                    <a href="snprintf.c.html#LN321"><span class='Ref_To_Local'>argtypes</span></a><span class='Delimiter'>[</span><a href="snprintf.c.html#LN315"><span class='Ref_To_Local'>fmtpos</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="snprintf.c.html#LN127"><span class='Ref_to_EnumConst'>ATYPE_INT</span></a><span class='Delimiter'>; 
</span>                    <a href="snprintf.c.html#LN314"><span class='Ref_To_Local'>last_dollar</span></a> <span class='Operator'>= </span><a href="../interfaces/ecpg/pgtypeslib/numeric.c.html#LN10"><span class='Ref_to_Macro'>Max</span></a><span class='Parentheses'>(</span><a href="snprintf.c.html#LN314"><span class='Ref_To_Local'>last_dollar</span></a><span class='Delimiter'>, </span><a href="snprintf.c.html#LN315"><span class='Ref_To_Local'>fmtpos</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <span class='Delimiter'>} 
</span>                <span class='Control'>else</span> 
                    <a href="snprintf.c.html#LN302"><span class='Ref_To_Local'>have_non_dollar</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span>            <span class='Control'>case</span> <span class='String'>'s'</span><span class='Operator'>: 
</span>            <span class='Control'>case</span> <span class='String'>'p'</span><span class='Operator'>: 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="snprintf.c.html#LN315"><span class='Ref_To_Local'>fmtpos</span></a><span class='Parentheses'>) 
</span>                <span class='Delimiter'>{ 
</span>                    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="snprintf.c.html#LN321"><span class='Ref_To_Local'>argtypes</span></a><span class='Delimiter'>[</span><a href="snprintf.c.html#LN315"><span class='Ref_To_Local'>fmtpos</span></a><span class='Delimiter'>] </span><span class='Operator'>&& 
</span>                        <a href="snprintf.c.html#LN321"><span class='Ref_To_Local'>argtypes</span></a><span class='Delimiter'>[</span><a href="snprintf.c.html#LN315"><span class='Ref_To_Local'>fmtpos</span></a><span class='Delimiter'>] </span><span class='Operator'>!= </span><a href="snprintf.c.html#LN131"><span class='Ref_to_EnumConst'>ATYPE_CHARPTR</span></a><span class='Parentheses'>) 
</span>                        <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="snprintf.c.html#LN787"><span class='Ref_to_Label'>bad_format</span></a><span class='Delimiter'>; 
</span>                    <a href="snprintf.c.html#LN321"><span class='Ref_To_Local'>argtypes</span></a><span class='Delimiter'>[</span><a href="snprintf.c.html#LN315"><span class='Ref_To_Local'>fmtpos</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="snprintf.c.html#LN131"><span class='Ref_to_EnumConst'>ATYPE_CHARPTR</span></a><span class='Delimiter'>; 
</span>                    <a href="snprintf.c.html#LN314"><span class='Ref_To_Local'>last_dollar</span></a> <span class='Operator'>= </span><a href="../interfaces/ecpg/pgtypeslib/numeric.c.html#LN10"><span class='Ref_to_Macro'>Max</span></a><span class='Parentheses'>(</span><a href="snprintf.c.html#LN314"><span class='Ref_To_Local'>last_dollar</span></a><span class='Delimiter'>, </span><a href="snprintf.c.html#LN315"><span class='Ref_To_Local'>fmtpos</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <span class='Delimiter'>} 
</span>                <span class='Control'>else</span> 
                    <a href="snprintf.c.html#LN302"><span class='Ref_To_Local'>have_non_dollar</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span>            <span class='Control'>case</span> <span class='String'>'e'</span><span class='Operator'>: 
</span>            <span class='Control'>case</span> <span class='String'>'E'</span><span class='Operator'>: 
</span>            <span class='Control'>case</span> <span class='String'>'f'</span><span class='Operator'>: 
</span>            <span class='Control'>case</span> <span class='String'>'g'</span><span class='Operator'>: 
</span>            <span class='Control'>case</span> <span class='String'>'G'</span><span class='Operator'>: 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="snprintf.c.html#LN315"><span class='Ref_To_Local'>fmtpos</span></a><span class='Parentheses'>) 
</span>                <span class='Delimiter'>{ 
</span>                    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="snprintf.c.html#LN321"><span class='Ref_To_Local'>argtypes</span></a><span class='Delimiter'>[</span><a href="snprintf.c.html#LN315"><span class='Ref_To_Local'>fmtpos</span></a><span class='Delimiter'>] </span><span class='Operator'>&& 
</span>                        <a href="snprintf.c.html#LN321"><span class='Ref_To_Local'>argtypes</span></a><span class='Delimiter'>[</span><a href="snprintf.c.html#LN315"><span class='Ref_To_Local'>fmtpos</span></a><span class='Delimiter'>] </span><span class='Operator'>!= </span><a href="snprintf.c.html#LN130"><span class='Ref_to_EnumConst'>ATYPE_DOUBLE</span></a><span class='Parentheses'>) 
</span>                        <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="snprintf.c.html#LN787"><span class='Ref_to_Label'>bad_format</span></a><span class='Delimiter'>; 
</span>                    <a href="snprintf.c.html#LN321"><span class='Ref_To_Local'>argtypes</span></a><span class='Delimiter'>[</span><a href="snprintf.c.html#LN315"><span class='Ref_To_Local'>fmtpos</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="snprintf.c.html#LN130"><span class='Ref_to_EnumConst'>ATYPE_DOUBLE</span></a><span class='Delimiter'>; 
</span>                    <a href="snprintf.c.html#LN314"><span class='Ref_To_Local'>last_dollar</span></a> <span class='Operator'>= </span><a href="../interfaces/ecpg/pgtypeslib/numeric.c.html#LN10"><span class='Ref_to_Macro'>Max</span></a><span class='Parentheses'>(</span><a href="snprintf.c.html#LN314"><span class='Ref_To_Local'>last_dollar</span></a><span class='Delimiter'>, </span><a href="snprintf.c.html#LN315"><span class='Ref_To_Local'>fmtpos</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <span class='Delimiter'>} 
</span>                <span class='Control'>else</span> 
                    <a href="snprintf.c.html#LN302"><span class='Ref_To_Local'>have_non_dollar</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span>            <span class='Control'>case</span> <span class='String'>'%'</span><span class='Operator'>: 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end switch ch &raquo; </span> 
 
        <span class='Comment_Multi_Line'>/* 
         * If we finish the spec with afterstar still set, there's a 
         * non-dollar star in there. 
         */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="snprintf.c.html#LN304"><span class='Ref_To_Local'>afterstar</span></a><span class='Parentheses'>) 
</span>            <a href="snprintf.c.html#LN302"><span class='Ref_To_Local'>have_non_dollar</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end while (ch=*format++)!='\0' &raquo; </span> 
 
    <span class='Comment_Multi_Line'>/* Per spec, you use either all dollar or all not. */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="snprintf.c.html#LN301"><span class='Ref_To_Local'>have_dollar</span></a> <span class='Operator'>&& </span><a href="snprintf.c.html#LN302"><span class='Ref_To_Local'>have_non_dollar</span></a><span class='Parentheses'>) 
</span>        <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="snprintf.c.html#LN787"><span class='Ref_to_Label'>bad_format</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * In dollar mode, collect the arguments in physical order. 
     */ 
</span>    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="snprintf.c.html#LN320"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>; </span><a href="snprintf.c.html#LN320"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT;= </span><a href="snprintf.c.html#LN314"><span class='Ref_To_Local'>last_dollar</span></a><span class='Delimiter'>; </span><a href="snprintf.c.html#LN320"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>switch</span> <span class='Parentheses'>(</span><a href="snprintf.c.html#LN321"><span class='Ref_To_Local'>argtypes</span></a><span class='Delimiter'>[</span><a href="snprintf.c.html#LN320"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Control'>case</span> <a href="snprintf.c.html#LN126"><span class='Ref_to_EnumConst'>ATYPE_NONE</span></a><span class='Operator'>: 
</span>                <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="snprintf.c.html#LN787"><span class='Ref_to_Label'>bad_format</span></a><span class='Delimiter'>; 
</span>            <span class='Control'>case</span> <a href="snprintf.c.html#LN127"><span class='Ref_to_EnumConst'>ATYPE_INT</span></a><span class='Operator'>: 
</span>                <a href="snprintf.c.html#LN322"><span class='Ref_To_Local'>argvalues</span></a><span class='Delimiter'>[</span><a href="snprintf.c.html#LN320"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="snprintf.c.html#LN136"><span class='Ref_to_Member'>i</span></a> <span class='Operator'>= </span>va_arg<span class='Parentheses'>(</span><a href="snprintf.c.html#LN297"><span class='Ref_to_Parameter'>args</span></a><span class='Delimiter'>, </span><span class='Keyword'>int</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span>            <span class='Control'>case</span> <a href="snprintf.c.html#LN128"><span class='Ref_to_EnumConst'>ATYPE_LONG</span></a><span class='Operator'>: 
</span>                <a href="snprintf.c.html#LN322"><span class='Ref_To_Local'>argvalues</span></a><span class='Delimiter'>[</span><a href="snprintf.c.html#LN320"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="snprintf.c.html#LN137"><span class='Ref_to_Member'>l</span></a> <span class='Operator'>= </span>va_arg<span class='Parentheses'>(</span><a href="snprintf.c.html#LN297"><span class='Ref_to_Parameter'>args</span></a><span class='Delimiter'>, </span><span class='Keyword'>long</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span>            <span class='Control'>case</span> <a href="snprintf.c.html#LN129"><span class='Ref_to_EnumConst'>ATYPE_LONGLONG</span></a><span class='Operator'>: 
</span>                <a href="snprintf.c.html#LN322"><span class='Ref_To_Local'>argvalues</span></a><span class='Delimiter'>[</span><a href="snprintf.c.html#LN320"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="snprintf.c.html#LN138"><span class='Ref_to_Member'>ll</span></a> <span class='Operator'>= </span>va_arg<span class='Parentheses'>(</span><a href="snprintf.c.html#LN297"><span class='Ref_to_Parameter'>args</span></a><span class='Delimiter'>, </span><a href="../include/c.h.html#LN294"><span class='Ref_to_Typedef'>int64</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span>            <span class='Control'>case</span> <a href="snprintf.c.html#LN130"><span class='Ref_to_EnumConst'>ATYPE_DOUBLE</span></a><span class='Operator'>: 
</span>                <a href="snprintf.c.html#LN322"><span class='Ref_To_Local'>argvalues</span></a><span class='Delimiter'>[</span><a href="snprintf.c.html#LN320"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="snprintf.c.html#LN139"><span class='Ref_to_Member'>d</span></a> <span class='Operator'>= </span>va_arg<span class='Parentheses'>(</span><a href="snprintf.c.html#LN297"><span class='Ref_to_Parameter'>args</span></a><span class='Delimiter'>, </span><span class='Keyword'>double</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span>            <span class='Control'>case</span> <a href="snprintf.c.html#LN131"><span class='Ref_to_EnumConst'>ATYPE_CHARPTR</span></a><span class='Operator'>: 
</span>                <a href="snprintf.c.html#LN322"><span class='Ref_To_Local'>argvalues</span></a><span class='Delimiter'>[</span><a href="snprintf.c.html#LN320"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="snprintf.c.html#LN140"><span class='Ref_to_Member'>cptr</span></a> <span class='Operator'>= </span>va_arg<span class='Parentheses'>(</span><a href="snprintf.c.html#LN297"><span class='Ref_to_Parameter'>args</span></a><span class='Delimiter'>, </span><span class='Keyword'>char </span><span class='Operator'>*</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end switch argtypes[i] &raquo; </span> 
    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end for i=1;i&LT;=last_dollar;i+... &raquo; </span> 
 
    <span class='Comment_Multi_Line'>/* 
     * At last we can parse the format for real. 
     */ 
</span>    <a href="snprintf.c.html#LN297"><span class='Ref_to_Parameter'>format</span></a> <span class='Operator'>= </span><a href="snprintf.c.html#LN299"><span class='Ref_To_Local'>format_start</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>while</span> <span class='Parentheses'>((</span><a href="snprintf.c.html#LN300"><span class='Ref_To_Local'>ch</span></a> <span class='Operator'>= *</span><a href="snprintf.c.html#LN297"><span class='Ref_to_Parameter'>format</span></a><span class='Operator'>++</span><span class='Parentheses'>) </span><span class='Operator'>!= </span><span class='String'>'\0'</span><span class='Parentheses'>)</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="snprintf.c.html#LN297"><span class='Ref_to_Parameter'>target</span></a><span class='Operator'>-&GT;</span><a href="snprintf.c.html#LN115"><span class='Ref_to_Member'>failed</span></a><span class='Parentheses'>) 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="snprintf.c.html#LN300"><span class='Ref_To_Local'>ch</span></a> <span class='Operator'>!= </span><span class='String'>'%'</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <a href="snprintf.c.html#LN285"><span class='Ref_to_Proto'>dopr_outch</span></a><span class='Parentheses'>(</span><a href="snprintf.c.html#LN300"><span class='Ref_To_Local'>ch</span></a><span class='Delimiter'>, </span><a href="snprintf.c.html#LN297"><span class='Ref_to_Parameter'>target</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>continue</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <a href="snprintf.c.html#LN310"><span class='Ref_To_Local'>fieldwidth</span></a> <span class='Operator'>= </span><a href="snprintf.c.html#LN311"><span class='Ref_To_Local'>precision</span></a> <span class='Operator'>= </span><a href="snprintf.c.html#LN312"><span class='Ref_To_Local'>zpad</span></a> <span class='Operator'>= </span><a href="snprintf.c.html#LN309"><span class='Ref_To_Local'>leftjust</span></a> <span class='Operator'>= </span><a href="snprintf.c.html#LN313"><span class='Ref_To_Local'>forcesign</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>        <a href="snprintf.c.html#LN307"><span class='Ref_To_Local'>longflag</span></a> <span class='Operator'>= </span><a href="snprintf.c.html#LN306"><span class='Ref_To_Local'>longlongflag</span></a> <span class='Operator'>= </span><a href="snprintf.c.html#LN308"><span class='Ref_To_Local'>pointflag</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>        <a href="snprintf.c.html#LN315"><span class='Ref_To_Local'>fmtpos</span></a> <span class='Operator'>= </span><a href="snprintf.c.html#LN305"><span class='Ref_To_Local'>accum</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>        <a href="snprintf.c.html#LN303"><span class='Ref_To_Local'>have_star</span></a> <span class='Operator'>= </span><a href="snprintf.c.html#LN304"><span class='Ref_To_Local'>afterstar</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span><a name="LN537"></a><span class='Label'>nextch2</span><span class='Operator'>: 
</span>        <a href="snprintf.c.html#LN300"><span class='Ref_To_Local'>ch</span></a> <span class='Operator'>= *</span><a href="snprintf.c.html#LN297"><span class='Ref_to_Parameter'>format</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="snprintf.c.html#LN300"><span class='Ref_To_Local'>ch</span></a> <span class='Operator'>== </span><span class='String'>'\0'</span><span class='Parentheses'>) 
</span>            <span class='Control'>break</span><span class='Delimiter'>;</span>              <span class='Comment_Single_Line'>/* illegal, but we don't complain */ 
</span>        <span class='Control'>switch</span> <span class='Parentheses'>(</span><a href="snprintf.c.html#LN300"><span class='Ref_To_Local'>ch</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Control'>case</span> <span class='String'>'-'</span><span class='Operator'>: 
</span>                <a href="snprintf.c.html#LN309"><span class='Ref_To_Local'>leftjust</span></a> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>                <span class='Control'>goto</span> <span class='Symbol_Characters'>&uarr;</span><a href="snprintf.c.html#LN537"><span class='Ref_to_Label'>nextch2</span></a><span class='Delimiter'>; 
</span>            <span class='Control'>case</span> <span class='String'>'+'</span><span class='Operator'>: 
</span>                <a href="snprintf.c.html#LN313"><span class='Ref_To_Local'>forcesign</span></a> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>                <span class='Control'>goto</span> <span class='Symbol_Characters'>&uarr;</span><a href="snprintf.c.html#LN537"><span class='Ref_to_Label'>nextch2</span></a><span class='Delimiter'>; 
</span>            <span class='Control'>case</span> <span class='String'>'0'</span><span class='Operator'>: 
</span>                <span class='Comment_Multi_Line'>/* set zero padding if no nonzero digits yet */ 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="snprintf.c.html#LN305"><span class='Ref_To_Local'>accum</span></a> <span class='Operator'>== </span><span class='Number'>0</span> <span class='Operator'>&& !</span><a href="snprintf.c.html#LN308"><span class='Ref_To_Local'>pointflag</span></a><span class='Parentheses'>) 
</span>                    <a href="snprintf.c.html#LN312"><span class='Ref_To_Local'>zpad</span></a> <span class='Operator'>= </span><span class='String'>'0'</span><span class='Delimiter'>; 
</span>                <span class='Comment_Multi_Line'>/* FALL THRU */ 
</span>            <span class='Control'>case</span> <span class='String'>'1'</span><span class='Operator'>: 
</span>            <span class='Control'>case</span> <span class='String'>'2'</span><span class='Operator'>: 
</span>            <span class='Control'>case</span> <span class='String'>'3'</span><span class='Operator'>: 
</span>            <span class='Control'>case</span> <span class='String'>'4'</span><span class='Operator'>: 
</span>            <span class='Control'>case</span> <span class='String'>'5'</span><span class='Operator'>: 
</span>            <span class='Control'>case</span> <span class='String'>'6'</span><span class='Operator'>: 
</span>            <span class='Control'>case</span> <span class='String'>'7'</span><span class='Operator'>: 
</span>            <span class='Control'>case</span> <span class='String'>'8'</span><span class='Operator'>: 
</span>            <span class='Control'>case</span> <span class='String'>'9'</span><span class='Operator'>: 
</span>                <a href="snprintf.c.html#LN305"><span class='Ref_To_Local'>accum</span></a> <span class='Operator'>= </span><a href="snprintf.c.html#LN305"><span class='Ref_To_Local'>accum</span></a> <span class='Operator'>* </span><span class='Number'>10</span> <span class='Operator'>+ </span><span class='Parentheses'>(</span><a href="snprintf.c.html#LN300"><span class='Ref_To_Local'>ch</span></a> <span class='Operator'>- </span><span class='String'>'0'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <span class='Control'>goto</span> <span class='Symbol_Characters'>&uarr;</span><a href="snprintf.c.html#LN537"><span class='Ref_to_Label'>nextch2</span></a><span class='Delimiter'>; 
</span>            <span class='Control'>case</span> <span class='String'>'.'</span><span class='Operator'>: 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="snprintf.c.html#LN303"><span class='Ref_To_Local'>have_star</span></a><span class='Parentheses'>) 
</span>                    <a href="snprintf.c.html#LN303"><span class='Ref_To_Local'>have_star</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>                <span class='Control'>else</span> 
                    <a href="snprintf.c.html#LN310"><span class='Ref_To_Local'>fieldwidth</span></a> <span class='Operator'>= </span><a href="snprintf.c.html#LN305"><span class='Ref_To_Local'>accum</span></a><span class='Delimiter'>; 
</span>                <a href="snprintf.c.html#LN308"><span class='Ref_To_Local'>pointflag</span></a> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>                <a href="snprintf.c.html#LN305"><span class='Ref_To_Local'>accum</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>                <span class='Control'>goto</span> <span class='Symbol_Characters'>&uarr;</span><a href="snprintf.c.html#LN537"><span class='Ref_to_Label'>nextch2</span></a><span class='Delimiter'>; 
</span>            <span class='Control'>case</span> <span class='String'>'*'</span><span class='Operator'>: 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="snprintf.c.html#LN301"><span class='Ref_To_Local'>have_dollar</span></a><span class='Parentheses'>) 
</span>                <span class='Delimiter'>{ 
</span>                    <span class='Comment_Multi_Line'>/* process value after reading n$ */ 
</span>                    <a href="snprintf.c.html#LN304"><span class='Ref_To_Local'>afterstar</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>                <span class='Delimiter'>} 
</span>                <span class='Control'>else</span> 
                <span class='Delimiter'>{ 
</span>                    <span class='Comment_Multi_Line'>/* fetch and process value now */ 
</span><a name="LN582"></a>                    <span class='Keyword'>int</span>         <span class='Declare_Local'>starval</span> <span class='Operator'>= </span>va_arg<span class='Parentheses'>(</span><a href="snprintf.c.html#LN297"><span class='Ref_to_Parameter'>args</span></a><span class='Delimiter'>, </span><span class='Keyword'>int</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
                    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="snprintf.c.html#LN308"><span class='Ref_To_Local'>pointflag</span></a><span class='Parentheses'>) 
</span>                    <span class='Delimiter'>{ 
</span>                        <a href="snprintf.c.html#LN311"><span class='Ref_To_Local'>precision</span></a> <span class='Operator'>= </span><a href="snprintf.c.html#LN582"><span class='Ref_To_Local'>starval</span></a><span class='Delimiter'>; 
</span>                        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="snprintf.c.html#LN311"><span class='Ref_To_Local'>precision</span></a> <span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>                        <span class='Delimiter'>{ 
</span>                            <a href="snprintf.c.html#LN311"><span class='Ref_To_Local'>precision</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>                            <a href="snprintf.c.html#LN308"><span class='Ref_To_Local'>pointflag</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>                        <span class='Delimiter'>} 
</span>                    <span class='Delimiter'>} 
</span>                    <span class='Control'>else</span> 
                    <span class='Delimiter'>{ 
</span>                        <a href="snprintf.c.html#LN310"><span class='Ref_To_Local'>fieldwidth</span></a> <span class='Operator'>= </span><a href="snprintf.c.html#LN582"><span class='Ref_To_Local'>starval</span></a><span class='Delimiter'>; 
</span>                        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="snprintf.c.html#LN310"><span class='Ref_To_Local'>fieldwidth</span></a> <span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>                        <span class='Delimiter'>{ 
</span>                            <a href="snprintf.c.html#LN309"><span class='Ref_To_Local'>leftjust</span></a> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>                            <a href="snprintf.c.html#LN310"><span class='Ref_To_Local'>fieldwidth</span></a> <span class='Operator'>= -</span><a href="snprintf.c.html#LN310"><span class='Ref_To_Local'>fieldwidth</span></a><span class='Delimiter'>; 
</span>                        <span class='Delimiter'>} 
</span>                    <span class='Delimiter'>} 
</span>                <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end else &raquo; </span> 
                <a href="snprintf.c.html#LN303"><span class='Ref_To_Local'>have_star</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>                <a href="snprintf.c.html#LN305"><span class='Ref_To_Local'>accum</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>                <span class='Control'>goto</span> <span class='Symbol_Characters'>&uarr;</span><a href="snprintf.c.html#LN537"><span class='Ref_to_Label'>nextch2</span></a><span class='Delimiter'>; 
</span>            <span class='Control'>case</span> <span class='String'>'$'</span><span class='Operator'>: 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="snprintf.c.html#LN304"><span class='Ref_To_Local'>afterstar</span></a><span class='Parentheses'>) 
</span>                <span class='Delimiter'>{ 
</span>                    <span class='Comment_Multi_Line'>/* fetch and process star value */ 
</span><a name="LN610"></a>                    <span class='Keyword'>int</span>         <span class='Declare_Local'>starval</span> <span class='Operator'>= </span><a href="snprintf.c.html#LN322"><span class='Ref_To_Local'>argvalues</span></a><span class='Delimiter'>[</span><a href="snprintf.c.html#LN305"><span class='Ref_To_Local'>accum</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="snprintf.c.html#LN136"><span class='Ref_to_Member'>i</span></a><span class='Delimiter'>; 
</span> 
                    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="snprintf.c.html#LN308"><span class='Ref_To_Local'>pointflag</span></a><span class='Parentheses'>) 
</span>                    <span class='Delimiter'>{ 
</span>                        <a href="snprintf.c.html#LN311"><span class='Ref_To_Local'>precision</span></a> <span class='Operator'>= </span><a href="snprintf.c.html#LN610"><span class='Ref_To_Local'>starval</span></a><span class='Delimiter'>; 
</span>                        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="snprintf.c.html#LN311"><span class='Ref_To_Local'>precision</span></a> <span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>                        <span class='Delimiter'>{ 
</span>                            <a href="snprintf.c.html#LN311"><span class='Ref_To_Local'>precision</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>                            <a href="snprintf.c.html#LN308"><span class='Ref_To_Local'>pointflag</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>                        <span class='Delimiter'>} 
</span>                    <span class='Delimiter'>} 
</span>                    <span class='Control'>else</span> 
                    <span class='Delimiter'>{ 
</span>                        <a href="snprintf.c.html#LN310"><span class='Ref_To_Local'>fieldwidth</span></a> <span class='Operator'>= </span><a href="snprintf.c.html#LN610"><span class='Ref_To_Local'>starval</span></a><span class='Delimiter'>; 
</span>                        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="snprintf.c.html#LN310"><span class='Ref_To_Local'>fieldwidth</span></a> <span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>                        <span class='Delimiter'>{ 
</span>                            <a href="snprintf.c.html#LN309"><span class='Ref_To_Local'>leftjust</span></a> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>                            <a href="snprintf.c.html#LN310"><span class='Ref_To_Local'>fieldwidth</span></a> <span class='Operator'>= -</span><a href="snprintf.c.html#LN310"><span class='Ref_To_Local'>fieldwidth</span></a><span class='Delimiter'>; 
</span>                        <span class='Delimiter'>} 
</span>                    <span class='Delimiter'>} 
</span>                    <a href="snprintf.c.html#LN304"><span class='Ref_To_Local'>afterstar</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>                <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if afterstar &raquo; </span> 
                <span class='Control'>else</span> 
                    <a href="snprintf.c.html#LN315"><span class='Ref_To_Local'>fmtpos</span></a> <span class='Operator'>= </span><a href="snprintf.c.html#LN305"><span class='Ref_To_Local'>accum</span></a><span class='Delimiter'>; 
</span>                <a href="snprintf.c.html#LN305"><span class='Ref_To_Local'>accum</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>                <span class='Control'>goto</span> <span class='Symbol_Characters'>&uarr;</span><a href="snprintf.c.html#LN537"><span class='Ref_to_Label'>nextch2</span></a><span class='Delimiter'>; 
</span>            <span class='Control'>case</span> <span class='String'>'l'</span><span class='Operator'>: 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="snprintf.c.html#LN307"><span class='Ref_To_Local'>longflag</span></a><span class='Parentheses'>) 
</span>                    <a href="snprintf.c.html#LN306"><span class='Ref_To_Local'>longlongflag</span></a> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>                <span class='Control'>else</span> 
                    <a href="snprintf.c.html#LN307"><span class='Ref_To_Local'>longflag</span></a> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>                <span class='Control'>goto</span> <span class='Symbol_Characters'>&uarr;</span><a href="snprintf.c.html#LN537"><span class='Ref_to_Label'>nextch2</span></a><span class='Delimiter'>; 
</span>            <span class='Control'>case</span> <span class='String'>'z'</span><span class='Operator'>: 
</span><span class='Directive'>#if</span> SIZEOF_SIZE_T <span class='Operator'>== </span><span class='Number'>8</span> 
<span class='Directive'>#ifdef</span> HAVE_LONG_INT_64 
                <a href="snprintf.c.html#LN307"><span class='Ref_To_Local'>longflag</span></a> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span><span class='Directive'>#elif</span> defined<span class='Parentheses'>(</span>HAVE_LONG_LONG_INT_64<span class='Parentheses'>) 
</span>                <a href="snprintf.c.html#LN306"><span class='Ref_To_Local'>longlongflag</span></a> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span><span class='Directive'>#else</span> 
#error <span class='String'>"Don't know how to print 64bit integers"</span> 
<span class='Directive'>#endif</span> 
<span class='Directive'>#else</span> 
                <span class='Comment_Multi_Line'>/* assume size_t is same size as int */ 
</span><span class='Directive'>#endif</span> 
                <span class='Control'>goto</span> <span class='Symbol_Characters'>&uarr;</span><a href="snprintf.c.html#LN537"><span class='Ref_to_Label'>nextch2</span></a><span class='Delimiter'>; 
</span>            <span class='Control'>case</span> <span class='String'>'h'</span><span class='Operator'>: 
</span>            <span class='Control'>case</span> <span class='String'>'\''</span><span class='Operator'>: 
</span>                <span class='Comment_Multi_Line'>/* ignore these */ 
</span>                <span class='Control'>goto</span> <span class='Symbol_Characters'>&uarr;</span><a href="snprintf.c.html#LN537"><span class='Ref_to_Label'>nextch2</span></a><span class='Delimiter'>; 
</span>            <span class='Control'>case</span> <span class='String'>'d'</span><span class='Operator'>: 
</span>            <span class='Control'>case</span> <span class='String'>'i'</span><span class='Operator'>: 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="snprintf.c.html#LN303"><span class='Ref_To_Local'>have_star</span></a><span class='Parentheses'>) 
</span>                <span class='Delimiter'>{ 
</span>                    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="snprintf.c.html#LN308"><span class='Ref_To_Local'>pointflag</span></a><span class='Parentheses'>) 
</span>                        <a href="snprintf.c.html#LN311"><span class='Ref_To_Local'>precision</span></a> <span class='Operator'>= </span><a href="snprintf.c.html#LN305"><span class='Ref_To_Local'>accum</span></a><span class='Delimiter'>; 
</span>                    <span class='Control'>else</span> 
                        <a href="snprintf.c.html#LN310"><span class='Ref_To_Local'>fieldwidth</span></a> <span class='Operator'>= </span><a href="snprintf.c.html#LN305"><span class='Ref_To_Local'>accum</span></a><span class='Delimiter'>; 
</span>                <span class='Delimiter'>} 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="snprintf.c.html#LN301"><span class='Ref_To_Local'>have_dollar</span></a><span class='Parentheses'>) 
</span>                <span class='Delimiter'>{ 
</span>                    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="snprintf.c.html#LN306"><span class='Ref_To_Local'>longlongflag</span></a><span class='Parentheses'>) 
</span>                        <a href="snprintf.c.html#LN317"><span class='Ref_To_Local'>numvalue</span></a> <span class='Operator'>= </span><a href="snprintf.c.html#LN322"><span class='Ref_To_Local'>argvalues</span></a><span class='Delimiter'>[</span><a href="snprintf.c.html#LN315"><span class='Ref_To_Local'>fmtpos</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="snprintf.c.html#LN138"><span class='Ref_to_Member'>ll</span></a><span class='Delimiter'>; 
</span>                    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="snprintf.c.html#LN307"><span class='Ref_To_Local'>longflag</span></a><span class='Parentheses'>) 
</span>                        <a href="snprintf.c.html#LN317"><span class='Ref_To_Local'>numvalue</span></a> <span class='Operator'>= </span><a href="snprintf.c.html#LN322"><span class='Ref_To_Local'>argvalues</span></a><span class='Delimiter'>[</span><a href="snprintf.c.html#LN315"><span class='Ref_To_Local'>fmtpos</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="snprintf.c.html#LN137"><span class='Ref_to_Member'>l</span></a><span class='Delimiter'>; 
</span>                    <span class='Control'>else</span> 
                        <a href="snprintf.c.html#LN317"><span class='Ref_To_Local'>numvalue</span></a> <span class='Operator'>= </span><a href="snprintf.c.html#LN322"><span class='Ref_To_Local'>argvalues</span></a><span class='Delimiter'>[</span><a href="snprintf.c.html#LN315"><span class='Ref_To_Local'>fmtpos</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="snprintf.c.html#LN136"><span class='Ref_to_Member'>i</span></a><span class='Delimiter'>; 
</span>                <span class='Delimiter'>} 
</span>                <span class='Control'>else</span> 
                <span class='Delimiter'>{ 
</span>                    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="snprintf.c.html#LN306"><span class='Ref_To_Local'>longlongflag</span></a><span class='Parentheses'>) 
</span>                        <a href="snprintf.c.html#LN317"><span class='Ref_To_Local'>numvalue</span></a> <span class='Operator'>= </span>va_arg<span class='Parentheses'>(</span><a href="snprintf.c.html#LN297"><span class='Ref_to_Parameter'>args</span></a><span class='Delimiter'>, </span><a href="../include/c.h.html#LN294"><span class='Ref_to_Typedef'>int64</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="snprintf.c.html#LN307"><span class='Ref_To_Local'>longflag</span></a><span class='Parentheses'>) 
</span>                        <a href="snprintf.c.html#LN317"><span class='Ref_To_Local'>numvalue</span></a> <span class='Operator'>= </span>va_arg<span class='Parentheses'>(</span><a href="snprintf.c.html#LN297"><span class='Ref_to_Parameter'>args</span></a><span class='Delimiter'>, </span><span class='Keyword'>long</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                    <span class='Control'>else</span> 
                        <a href="snprintf.c.html#LN317"><span class='Ref_To_Local'>numvalue</span></a> <span class='Operator'>= </span>va_arg<span class='Parentheses'>(</span><a href="snprintf.c.html#LN297"><span class='Ref_to_Parameter'>args</span></a><span class='Delimiter'>, </span><span class='Keyword'>int</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <span class='Delimiter'>} 
</span>                <a href="snprintf.c.html#LN277"><span class='Ref_to_Proto'>fmtint</span></a><span class='Parentheses'>(</span><a href="snprintf.c.html#LN317"><span class='Ref_To_Local'>numvalue</span></a><span class='Delimiter'>, </span><a href="snprintf.c.html#LN300"><span class='Ref_To_Local'>ch</span></a><span class='Delimiter'>, </span><a href="snprintf.c.html#LN313"><span class='Ref_To_Local'>forcesign</span></a><span class='Delimiter'>, </span><a href="snprintf.c.html#LN309"><span class='Ref_To_Local'>leftjust</span></a><span class='Delimiter'>, </span><a href="snprintf.c.html#LN310"><span class='Ref_To_Local'>fieldwidth</span></a><span class='Delimiter'>, </span><a href="snprintf.c.html#LN312"><span class='Ref_To_Local'>zpad</span></a><span class='Delimiter'>, 
</span>                       <a href="snprintf.c.html#LN311"><span class='Ref_To_Local'>precision</span></a><span class='Delimiter'>, </span><a href="snprintf.c.html#LN308"><span class='Ref_To_Local'>pointflag</span></a><span class='Delimiter'>, </span><a href="snprintf.c.html#LN297"><span class='Ref_to_Parameter'>target</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span>            <span class='Control'>case</span> <span class='String'>'o'</span><span class='Operator'>: 
</span>            <span class='Control'>case</span> <span class='String'>'u'</span><span class='Operator'>: 
</span>            <span class='Control'>case</span> <span class='String'>'x'</span><span class='Operator'>: 
</span>            <span class='Control'>case</span> <span class='String'>'X'</span><span class='Operator'>: 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="snprintf.c.html#LN303"><span class='Ref_To_Local'>have_star</span></a><span class='Parentheses'>) 
</span>                <span class='Delimiter'>{ 
</span>                    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="snprintf.c.html#LN308"><span class='Ref_To_Local'>pointflag</span></a><span class='Parentheses'>) 
</span>                        <a href="snprintf.c.html#LN311"><span class='Ref_To_Local'>precision</span></a> <span class='Operator'>= </span><a href="snprintf.c.html#LN305"><span class='Ref_To_Local'>accum</span></a><span class='Delimiter'>; 
</span>                    <span class='Control'>else</span> 
                        <a href="snprintf.c.html#LN310"><span class='Ref_To_Local'>fieldwidth</span></a> <span class='Operator'>= </span><a href="snprintf.c.html#LN305"><span class='Ref_To_Local'>accum</span></a><span class='Delimiter'>; 
</span>                <span class='Delimiter'>} 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="snprintf.c.html#LN301"><span class='Ref_To_Local'>have_dollar</span></a><span class='Parentheses'>) 
</span>                <span class='Delimiter'>{ 
</span>                    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="snprintf.c.html#LN306"><span class='Ref_To_Local'>longlongflag</span></a><span class='Parentheses'>) 
</span>                        <a href="snprintf.c.html#LN317"><span class='Ref_To_Local'>numvalue</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../include/c.h.html#LN297"><span class='Ref_to_Typedef'>uint64</span></a><span class='Parentheses'>) </span><a href="snprintf.c.html#LN322"><span class='Ref_To_Local'>argvalues</span></a><span class='Delimiter'>[</span><a href="snprintf.c.html#LN315"><span class='Ref_To_Local'>fmtpos</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="snprintf.c.html#LN138"><span class='Ref_to_Member'>ll</span></a><span class='Delimiter'>; 
</span>                    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="snprintf.c.html#LN307"><span class='Ref_To_Local'>longflag</span></a><span class='Parentheses'>) 
</span>                        <a href="snprintf.c.html#LN317"><span class='Ref_To_Local'>numvalue</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Keyword'>unsigned long</span><span class='Parentheses'>) </span><a href="snprintf.c.html#LN322"><span class='Ref_To_Local'>argvalues</span></a><span class='Delimiter'>[</span><a href="snprintf.c.html#LN315"><span class='Ref_To_Local'>fmtpos</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="snprintf.c.html#LN137"><span class='Ref_to_Member'>l</span></a><span class='Delimiter'>; 
</span>                    <span class='Control'>else</span> 
                        <a href="snprintf.c.html#LN317"><span class='Ref_To_Local'>numvalue</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Keyword'>unsigned int</span><span class='Parentheses'>) </span><a href="snprintf.c.html#LN322"><span class='Ref_To_Local'>argvalues</span></a><span class='Delimiter'>[</span><a href="snprintf.c.html#LN315"><span class='Ref_To_Local'>fmtpos</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="snprintf.c.html#LN136"><span class='Ref_to_Member'>i</span></a><span class='Delimiter'>; 
</span>                <span class='Delimiter'>} 
</span>                <span class='Control'>else</span> 
                <span class='Delimiter'>{ 
</span>                    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="snprintf.c.html#LN306"><span class='Ref_To_Local'>longlongflag</span></a><span class='Parentheses'>) 
</span>                        <a href="snprintf.c.html#LN317"><span class='Ref_To_Local'>numvalue</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../include/c.h.html#LN297"><span class='Ref_to_Typedef'>uint64</span></a><span class='Parentheses'>) </span>va_arg<span class='Parentheses'>(</span><a href="snprintf.c.html#LN297"><span class='Ref_to_Parameter'>args</span></a><span class='Delimiter'>, </span><a href="../include/c.h.html#LN294"><span class='Ref_to_Typedef'>int64</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="snprintf.c.html#LN307"><span class='Ref_To_Local'>longflag</span></a><span class='Parentheses'>) 
</span>                        <a href="snprintf.c.html#LN317"><span class='Ref_To_Local'>numvalue</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Keyword'>unsigned long</span><span class='Parentheses'>) </span>va_arg<span class='Parentheses'>(</span><a href="snprintf.c.html#LN297"><span class='Ref_to_Parameter'>args</span></a><span class='Delimiter'>, </span><span class='Keyword'>long</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                    <span class='Control'>else</span> 
                        <a href="snprintf.c.html#LN317"><span class='Ref_To_Local'>numvalue</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Keyword'>unsigned int</span><span class='Parentheses'>) </span>va_arg<span class='Parentheses'>(</span><a href="snprintf.c.html#LN297"><span class='Ref_to_Parameter'>args</span></a><span class='Delimiter'>, </span><span class='Keyword'>int</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <span class='Delimiter'>} 
</span>                <a href="snprintf.c.html#LN277"><span class='Ref_to_Proto'>fmtint</span></a><span class='Parentheses'>(</span><a href="snprintf.c.html#LN317"><span class='Ref_To_Local'>numvalue</span></a><span class='Delimiter'>, </span><a href="snprintf.c.html#LN300"><span class='Ref_To_Local'>ch</span></a><span class='Delimiter'>, </span><a href="snprintf.c.html#LN313"><span class='Ref_To_Local'>forcesign</span></a><span class='Delimiter'>, </span><a href="snprintf.c.html#LN309"><span class='Ref_To_Local'>leftjust</span></a><span class='Delimiter'>, </span><a href="snprintf.c.html#LN310"><span class='Ref_To_Local'>fieldwidth</span></a><span class='Delimiter'>, </span><a href="snprintf.c.html#LN312"><span class='Ref_To_Local'>zpad</span></a><span class='Delimiter'>, 
</span>                       <a href="snprintf.c.html#LN311"><span class='Ref_To_Local'>precision</span></a><span class='Delimiter'>, </span><a href="snprintf.c.html#LN308"><span class='Ref_To_Local'>pointflag</span></a><span class='Delimiter'>, </span><a href="snprintf.c.html#LN297"><span class='Ref_to_Parameter'>target</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span>            <span class='Control'>case</span> <span class='String'>'c'</span><span class='Operator'>: 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="snprintf.c.html#LN303"><span class='Ref_To_Local'>have_star</span></a><span class='Parentheses'>) 
</span>                <span class='Delimiter'>{ 
</span>                    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="snprintf.c.html#LN308"><span class='Ref_To_Local'>pointflag</span></a><span class='Parentheses'>) 
</span>                        <a href="snprintf.c.html#LN311"><span class='Ref_To_Local'>precision</span></a> <span class='Operator'>= </span><a href="snprintf.c.html#LN305"><span class='Ref_To_Local'>accum</span></a><span class='Delimiter'>; 
</span>                    <span class='Control'>else</span> 
                        <a href="snprintf.c.html#LN310"><span class='Ref_To_Local'>fieldwidth</span></a> <span class='Operator'>= </span><a href="snprintf.c.html#LN305"><span class='Ref_To_Local'>accum</span></a><span class='Delimiter'>; 
</span>                <span class='Delimiter'>} 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="snprintf.c.html#LN301"><span class='Ref_To_Local'>have_dollar</span></a><span class='Parentheses'>) 
</span>                    <a href="snprintf.c.html#LN316"><span class='Ref_To_Local'>cvalue</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Keyword'>unsigned char</span><span class='Parentheses'>) </span><a href="snprintf.c.html#LN322"><span class='Ref_To_Local'>argvalues</span></a><span class='Delimiter'>[</span><a href="snprintf.c.html#LN315"><span class='Ref_To_Local'>fmtpos</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="snprintf.c.html#LN136"><span class='Ref_to_Member'>i</span></a><span class='Delimiter'>; 
</span>                <span class='Control'>else</span> 
                    <a href="snprintf.c.html#LN316"><span class='Ref_To_Local'>cvalue</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Keyword'>unsigned char</span><span class='Parentheses'>) </span>va_arg<span class='Parentheses'>(</span><a href="snprintf.c.html#LN297"><span class='Ref_to_Parameter'>args</span></a><span class='Delimiter'>, </span><span class='Keyword'>int</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <a href="snprintf.c.html#LN280"><span class='Ref_to_Proto'>fmtchar</span></a><span class='Parentheses'>(</span><a href="snprintf.c.html#LN316"><span class='Ref_To_Local'>cvalue</span></a><span class='Delimiter'>, </span><a href="snprintf.c.html#LN309"><span class='Ref_To_Local'>leftjust</span></a><span class='Delimiter'>, </span><a href="snprintf.c.html#LN310"><span class='Ref_To_Local'>fieldwidth</span></a><span class='Delimiter'>, </span><a href="snprintf.c.html#LN297"><span class='Ref_to_Parameter'>target</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span>            <span class='Control'>case</span> <span class='String'>'s'</span><span class='Operator'>: 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="snprintf.c.html#LN303"><span class='Ref_To_Local'>have_star</span></a><span class='Parentheses'>) 
</span>                <span class='Delimiter'>{ 
</span>                    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="snprintf.c.html#LN308"><span class='Ref_To_Local'>pointflag</span></a><span class='Parentheses'>) 
</span>                        <a href="snprintf.c.html#LN311"><span class='Ref_To_Local'>precision</span></a> <span class='Operator'>= </span><a href="snprintf.c.html#LN305"><span class='Ref_To_Local'>accum</span></a><span class='Delimiter'>; 
</span>                    <span class='Control'>else</span> 
                        <a href="snprintf.c.html#LN310"><span class='Ref_To_Local'>fieldwidth</span></a> <span class='Operator'>= </span><a href="snprintf.c.html#LN305"><span class='Ref_To_Local'>accum</span></a><span class='Delimiter'>; 
</span>                <span class='Delimiter'>} 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="snprintf.c.html#LN301"><span class='Ref_To_Local'>have_dollar</span></a><span class='Parentheses'>) 
</span>                    <a href="snprintf.c.html#LN319"><span class='Ref_To_Local'>strvalue</span></a> <span class='Operator'>= </span><a href="snprintf.c.html#LN322"><span class='Ref_To_Local'>argvalues</span></a><span class='Delimiter'>[</span><a href="snprintf.c.html#LN315"><span class='Ref_To_Local'>fmtpos</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="snprintf.c.html#LN140"><span class='Ref_to_Member'>cptr</span></a><span class='Delimiter'>; 
</span>                <span class='Control'>else</span> 
                    <a href="snprintf.c.html#LN319"><span class='Ref_To_Local'>strvalue</span></a> <span class='Operator'>= </span>va_arg<span class='Parentheses'>(</span><a href="snprintf.c.html#LN297"><span class='Ref_to_Parameter'>args</span></a><span class='Delimiter'>, </span><span class='Keyword'>char </span><span class='Operator'>*</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <a href="snprintf.c.html#LN274"><span class='Ref_to_Proto'>fmtstr</span></a><span class='Parentheses'>(</span><a href="snprintf.c.html#LN319"><span class='Ref_To_Local'>strvalue</span></a><span class='Delimiter'>, </span><a href="snprintf.c.html#LN309"><span class='Ref_To_Local'>leftjust</span></a><span class='Delimiter'>, </span><a href="snprintf.c.html#LN310"><span class='Ref_To_Local'>fieldwidth</span></a><span class='Delimiter'>, </span><a href="snprintf.c.html#LN311"><span class='Ref_To_Local'>precision</span></a><span class='Delimiter'>, </span><a href="snprintf.c.html#LN308"><span class='Ref_To_Local'>pointflag</span></a><span class='Delimiter'>, 
</span>                       <a href="snprintf.c.html#LN297"><span class='Ref_to_Parameter'>target</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span>            <span class='Control'>case</span> <span class='String'>'p'</span><span class='Operator'>: 
</span>                <span class='Comment_Multi_Line'>/* fieldwidth/leftjust are ignored ... */ 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="snprintf.c.html#LN301"><span class='Ref_To_Local'>have_dollar</span></a><span class='Parentheses'>) 
</span>                    <a href="snprintf.c.html#LN319"><span class='Ref_To_Local'>strvalue</span></a> <span class='Operator'>= </span><a href="snprintf.c.html#LN322"><span class='Ref_To_Local'>argvalues</span></a><span class='Delimiter'>[</span><a href="snprintf.c.html#LN315"><span class='Ref_To_Local'>fmtpos</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="snprintf.c.html#LN140"><span class='Ref_to_Member'>cptr</span></a><span class='Delimiter'>; 
</span>                <span class='Control'>else</span> 
                    <a href="snprintf.c.html#LN319"><span class='Ref_To_Local'>strvalue</span></a> <span class='Operator'>= </span>va_arg<span class='Parentheses'>(</span><a href="snprintf.c.html#LN297"><span class='Ref_to_Parameter'>args</span></a><span class='Delimiter'>, </span><span class='Keyword'>char </span><span class='Operator'>*</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <a href="snprintf.c.html#LN276"><span class='Ref_to_Proto'>fmtptr</span></a><span class='Parentheses'>((</span><span class='Keyword'>void </span><span class='Operator'>*</span><span class='Parentheses'>) </span><a href="snprintf.c.html#LN319"><span class='Ref_To_Local'>strvalue</span></a><span class='Delimiter'>, </span><a href="snprintf.c.html#LN297"><span class='Ref_to_Parameter'>target</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span>            <span class='Control'>case</span> <span class='String'>'e'</span><span class='Operator'>: 
</span>            <span class='Control'>case</span> <span class='String'>'E'</span><span class='Operator'>: 
</span>            <span class='Control'>case</span> <span class='String'>'f'</span><span class='Operator'>: 
</span>            <span class='Control'>case</span> <span class='String'>'g'</span><span class='Operator'>: 
</span>            <span class='Control'>case</span> <span class='String'>'G'</span><span class='Operator'>: 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="snprintf.c.html#LN303"><span class='Ref_To_Local'>have_star</span></a><span class='Parentheses'>) 
</span>                <span class='Delimiter'>{ 
</span>                    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="snprintf.c.html#LN308"><span class='Ref_To_Local'>pointflag</span></a><span class='Parentheses'>) 
</span>                        <a href="snprintf.c.html#LN311"><span class='Ref_To_Local'>precision</span></a> <span class='Operator'>= </span><a href="snprintf.c.html#LN305"><span class='Ref_To_Local'>accum</span></a><span class='Delimiter'>; 
</span>                    <span class='Control'>else</span> 
                        <a href="snprintf.c.html#LN310"><span class='Ref_To_Local'>fieldwidth</span></a> <span class='Operator'>= </span><a href="snprintf.c.html#LN305"><span class='Ref_To_Local'>accum</span></a><span class='Delimiter'>; 
</span>                <span class='Delimiter'>} 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="snprintf.c.html#LN301"><span class='Ref_To_Local'>have_dollar</span></a><span class='Parentheses'>) 
</span>                    <a href="snprintf.c.html#LN318"><span class='Ref_To_Local'>fvalue</span></a> <span class='Operator'>= </span><a href="snprintf.c.html#LN322"><span class='Ref_To_Local'>argvalues</span></a><span class='Delimiter'>[</span><a href="snprintf.c.html#LN315"><span class='Ref_To_Local'>fmtpos</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="snprintf.c.html#LN139"><span class='Ref_to_Member'>d</span></a><span class='Delimiter'>; 
</span>                <span class='Control'>else</span> 
                    <a href="snprintf.c.html#LN318"><span class='Ref_To_Local'>fvalue</span></a> <span class='Operator'>= </span>va_arg<span class='Parentheses'>(</span><a href="snprintf.c.html#LN297"><span class='Ref_to_Parameter'>args</span></a><span class='Delimiter'>, </span><span class='Keyword'>double</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <a href="snprintf.c.html#LN281"><span class='Ref_to_Proto'>fmtfloat</span></a><span class='Parentheses'>(</span><a href="snprintf.c.html#LN318"><span class='Ref_To_Local'>fvalue</span></a><span class='Delimiter'>, </span><a href="snprintf.c.html#LN300"><span class='Ref_To_Local'>ch</span></a><span class='Delimiter'>, </span><a href="snprintf.c.html#LN313"><span class='Ref_To_Local'>forcesign</span></a><span class='Delimiter'>, </span><a href="snprintf.c.html#LN309"><span class='Ref_To_Local'>leftjust</span></a><span class='Delimiter'>, 
</span>                         <a href="snprintf.c.html#LN310"><span class='Ref_To_Local'>fieldwidth</span></a><span class='Delimiter'>, </span><a href="snprintf.c.html#LN312"><span class='Ref_To_Local'>zpad</span></a><span class='Delimiter'>, 
</span>                         <a href="snprintf.c.html#LN311"><span class='Ref_To_Local'>precision</span></a><span class='Delimiter'>, </span><a href="snprintf.c.html#LN308"><span class='Ref_To_Local'>pointflag</span></a><span class='Delimiter'>, 
</span>                         <a href="snprintf.c.html#LN297"><span class='Ref_to_Parameter'>target</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span>            <span class='Control'>case</span> <span class='String'>'%'</span><span class='Operator'>: 
</span>                <a href="snprintf.c.html#LN285"><span class='Ref_to_Proto'>dopr_outch</span></a><span class='Parentheses'>(</span><span class='String'>'%'</span><span class='Delimiter'>, </span><a href="snprintf.c.html#LN297"><span class='Ref_to_Parameter'>target</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end switch ch &raquo; </span> 
    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end while (ch=*format++)!='\0' &raquo; </span> 
 
    <span class='Control'>return</span><span class='Delimiter'>; 
</span> 
<a name="LN787"></a><span class='Label'>bad_format</span><span class='Operator'>: 
</span>    errno <span class='Operator'>= </span>EINVAL<span class='Delimiter'>; 
</span>    <a href="snprintf.c.html#LN297"><span class='Ref_to_Parameter'>target</span></a><span class='Operator'>-&GT;</span><a href="snprintf.c.html#LN115"><span class='Ref_to_Member'>failed</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end dopr &raquo; </span> 
 
<span class='Keyword'>static </span>size_t 
<a name="LN793"></a><span class='Declare_Function'>pg_strnlen</span><span class='Parentheses'>(</span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>str</span><span class='Delimiter'>, </span>size_t <span class='Declare_Parameter'>maxlen</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN795"></a>    <span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Local'>p</span> <span class='Operator'>= </span><a href="snprintf.c.html#LN793"><span class='Ref_to_Parameter'>str</span></a><span class='Delimiter'>; 
</span> 
    <span class='Control'>while</span> <span class='Parentheses'>(</span><a href="snprintf.c.html#LN793"><span class='Ref_to_Parameter'>maxlen</span></a><span class='Operator'>-- &GT; </span><span class='Number'>0</span> <span class='Operator'>&& *</span><a href="snprintf.c.html#LN795"><span class='Ref_To_Local'>p</span></a><span class='Parentheses'>) 
</span>        <a href="snprintf.c.html#LN795"><span class='Ref_To_Local'>p</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <a href="snprintf.c.html#LN795"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>- </span><a href="snprintf.c.html#LN793"><span class='Ref_to_Parameter'>str</span></a><span class='Delimiter'>; 
} 
</span> 
<span class='Keyword'>static void 
</span><a name="LN803"></a><span class='Declare_Function'>fmtstr</span><span class='Parentheses'>(</span><span class='Keyword'>char </span><span class='Operator'>*</span><span class='Declare_Parameter'>value</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>leftjust</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>minlen</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>maxwidth</span><span class='Delimiter'>, 
</span><a name="LN804"></a>       <span class='Keyword'>int </span><span class='Declare_Parameter'>pointflag</span><span class='Delimiter'>, </span><a href="snprintf.c.html#LN107"><span class='Ref_to_Typedef'>PrintfTarget</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>target</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN806"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>padlen</span><span class='Delimiter'>, 
</span><a name="LN807"></a>                <span class='Declare_Local'>vallen</span><span class='Delimiter'>;</span>         <span class='Comment_Single_Line'>/* amount to pad */ 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * If a maxwidth (precision) is specified, we must not fetch more bytes 
     * than that. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="snprintf.c.html#LN804"><span class='Ref_to_Parameter'>pointflag</span></a><span class='Parentheses'>) 
</span>        <a href="snprintf.c.html#LN807"><span class='Ref_To_Local'>vallen</span></a> <span class='Operator'>= </span><a href="snprintf.c.html#LN792"><span class='Ref_to_Func'>pg_strnlen</span></a><span class='Parentheses'>(</span><span class='Keyword'>value</span><span class='Delimiter'>, </span><a href="snprintf.c.html#LN803"><span class='Ref_to_Parameter'>maxwidth</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
        <a href="snprintf.c.html#LN807"><span class='Ref_To_Local'>vallen</span></a> <span class='Operator'>= </span>strlen<span class='Parentheses'>(</span><span class='Keyword'>value</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="snprintf.c.html#LN287"><span class='Ref_to_Proto'>adjust_padlen</span></a><span class='Parentheses'>(</span><a href="snprintf.c.html#LN803"><span class='Ref_to_Parameter'>minlen</span></a><span class='Delimiter'>, </span><a href="snprintf.c.html#LN807"><span class='Ref_To_Local'>vallen</span></a><span class='Delimiter'>, </span><a href="snprintf.c.html#LN803"><span class='Ref_to_Parameter'>leftjust</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="snprintf.c.html#LN806"><span class='Ref_To_Local'>padlen</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>while</span> <span class='Parentheses'>(</span><a href="snprintf.c.html#LN806"><span class='Ref_To_Local'>padlen</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="snprintf.c.html#LN285"><span class='Ref_to_Proto'>dopr_outch</span></a><span class='Parentheses'>(</span><span class='String'>' '</span><span class='Delimiter'>, </span><a href="snprintf.c.html#LN804"><span class='Ref_to_Parameter'>target</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Operator'>--</span><a href="snprintf.c.html#LN806"><span class='Ref_To_Local'>padlen</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="snprintf.c.html#LN284"><span class='Ref_to_Proto'>dostr</span></a><span class='Parentheses'>(</span><span class='Keyword'>value</span><span class='Delimiter'>, </span><a href="snprintf.c.html#LN807"><span class='Ref_To_Local'>vallen</span></a><span class='Delimiter'>, </span><a href="snprintf.c.html#LN804"><span class='Ref_to_Parameter'>target</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="snprintf.c.html#LN290"><span class='Ref_to_Proto'>trailing_pad</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="snprintf.c.html#LN806"><span class='Ref_To_Local'>padlen</span></a><span class='Delimiter'>, </span><a href="snprintf.c.html#LN804"><span class='Ref_to_Parameter'>target</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end fmtstr &raquo; </span> 
 
<span class='Keyword'>static void 
</span><a name="LN832"></a><span class='Declare_Function'>fmtptr</span><span class='Parentheses'>(</span><span class='Keyword'>void </span><span class='Operator'>*</span><span class='Declare_Parameter'>value</span><span class='Delimiter'>, </span><a href="snprintf.c.html#LN107"><span class='Ref_to_Typedef'>PrintfTarget</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>target</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN834"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>vallen</span><span class='Delimiter'>; 
</span><a name="LN835"></a>    <span class='Keyword'>char</span>        <span class='Declare_Local'>convert</span><span class='Delimiter'>[</span><span class='Number'>64</span><span class='Delimiter'>]; 
</span> 
    <span class='Comment_Multi_Line'>/* we rely on regular C library's sprintf to do the basic conversion */ 
</span>    <a href="snprintf.c.html#LN834"><span class='Ref_To_Local'>vallen</span></a> <span class='Operator'>= </span><a href="../include/port.h.html#LN170"><span class='Ref_to_Macro'>sprintf</span></a><span class='Parentheses'>(</span><a href="snprintf.c.html#LN835"><span class='Ref_To_Local'>convert</span></a><span class='Delimiter'>, </span><span class='String'>"%p"</span><span class='Delimiter'>, </span><span class='Keyword'>value</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="snprintf.c.html#LN834"><span class='Ref_To_Local'>vallen</span></a> <span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>        <a href="snprintf.c.html#LN832"><span class='Ref_to_Parameter'>target</span></a><span class='Operator'>-&GT;</span><a href="snprintf.c.html#LN115"><span class='Ref_to_Member'>failed</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
        <a href="snprintf.c.html#LN284"><span class='Ref_to_Proto'>dostr</span></a><span class='Parentheses'>(</span><a href="snprintf.c.html#LN835"><span class='Ref_To_Local'>convert</span></a><span class='Delimiter'>, </span><a href="snprintf.c.html#LN834"><span class='Ref_To_Local'>vallen</span></a><span class='Delimiter'>, </span><a href="snprintf.c.html#LN832"><span class='Ref_to_Parameter'>target</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Keyword'>static void 
</span><a name="LN846"></a><span class='Declare_Function'>fmtint</span><span class='Parentheses'>(</span><a href="../include/c.h.html#LN294"><span class='Ref_to_Typedef'>int64</span></a> <span class='Declare_Parameter'>value</span><span class='Delimiter'>, </span><span class='Keyword'>char </span><span class='Declare_Parameter'>type</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>forcesign</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>leftjust</span><span class='Delimiter'>, 
</span><a name="LN847"></a>       <span class='Keyword'>int </span><span class='Declare_Parameter'>minlen</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>zpad</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>precision</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>pointflag</span><span class='Delimiter'>, 
</span><a name="LN848"></a>       <a href="snprintf.c.html#LN107"><span class='Ref_to_Typedef'>PrintfTarget</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>target</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN850"></a>    <a href="../include/c.h.html#LN297"><span class='Ref_to_Typedef'>uint64</span></a>      <span class='Declare_Local'>base</span><span class='Delimiter'>; 
</span><a name="LN851"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>dosign</span><span class='Delimiter'>; 
</span><a name="LN852"></a>    <span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Local'>cvt</span> <span class='Operator'>= </span><span class='String'>"0123456789abcdef"</span><span class='Delimiter'>; 
</span><a name="LN853"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>signvalue</span> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span><a name="LN854"></a>    <span class='Keyword'>char</span>        <span class='Declare_Local'>convert</span><span class='Delimiter'>[</span><span class='Number'>64</span><span class='Delimiter'>]; 
</span><a name="LN855"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>vallen</span> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span><a name="LN856"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>padlen</span> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>;</span>     <span class='Comment_Single_Line'>/* amount to pad */ 
</span><a name="LN857"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>zeropad</span><span class='Delimiter'>;</span>        <span class='Comment_Single_Line'>/* extra leading zeroes */ 
</span> 
    <span class='Control'>switch</span> <span class='Parentheses'>(</span><a href="snprintf.c.html#LN846"><span class='Ref_to_Parameter'>type</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>case</span> <span class='String'>'d'</span><span class='Operator'>: 
</span>        <span class='Control'>case</span> <span class='String'>'i'</span><span class='Operator'>: 
</span>            <a href="snprintf.c.html#LN850"><span class='Ref_To_Local'>base</span></a> <span class='Operator'>= </span><span class='Number'>10</span><span class='Delimiter'>; 
</span>            <a href="snprintf.c.html#LN851"><span class='Ref_To_Local'>dosign</span></a> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Control'>case</span> <span class='String'>'o'</span><span class='Operator'>: 
</span>            <a href="snprintf.c.html#LN850"><span class='Ref_To_Local'>base</span></a> <span class='Operator'>= </span><span class='Number'>8</span><span class='Delimiter'>; 
</span>            <a href="snprintf.c.html#LN851"><span class='Ref_To_Local'>dosign</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Control'>case</span> <span class='String'>'u'</span><span class='Operator'>: 
</span>            <a href="snprintf.c.html#LN850"><span class='Ref_To_Local'>base</span></a> <span class='Operator'>= </span><span class='Number'>10</span><span class='Delimiter'>; 
</span>            <a href="snprintf.c.html#LN851"><span class='Ref_To_Local'>dosign</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Control'>case</span> <span class='String'>'x'</span><span class='Operator'>: 
</span>            <a href="snprintf.c.html#LN850"><span class='Ref_To_Local'>base</span></a> <span class='Operator'>= </span><span class='Number'>16</span><span class='Delimiter'>; 
</span>            <a href="snprintf.c.html#LN851"><span class='Ref_To_Local'>dosign</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Control'>case</span> <span class='String'>'X'</span><span class='Operator'>: 
</span>            <a href="snprintf.c.html#LN852"><span class='Ref_To_Local'>cvt</span></a> <span class='Operator'>= </span><span class='String'>"0123456789ABCDEF"</span><span class='Delimiter'>; 
</span>            <a href="snprintf.c.html#LN850"><span class='Ref_To_Local'>base</span></a> <span class='Operator'>= </span><span class='Number'>16</span><span class='Delimiter'>; 
</span>            <a href="snprintf.c.html#LN851"><span class='Ref_To_Local'>dosign</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Control'>default</span><span class='Operator'>: 
</span>            <span class='Control'>return</span><span class='Delimiter'>;</span>             <span class='Comment_Single_Line'>/* keep compiler quiet */ 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end switch type &raquo; </span> 
 
    <span class='Comment_Multi_Line'>/* Handle +/- */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="snprintf.c.html#LN851"><span class='Ref_To_Local'>dosign</span></a> <span class='Operator'>&& </span><a href="snprintf.c.html#LN286"><span class='Ref_to_Proto'>adjust_sign</span></a><span class='Parentheses'>((</span><span class='Keyword'>value </span><span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="snprintf.c.html#LN846"><span class='Ref_to_Parameter'>forcesign</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="snprintf.c.html#LN853"><span class='Ref_To_Local'>signvalue</span></a><span class='Parentheses'>))</span> 
        <span class='Keyword'>value </span><span class='Operator'>= -</span><span class='Keyword'>value</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * SUS: the result of converting 0 with an explicit precision of 0 is no 
     * characters 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Keyword'>value </span><span class='Operator'>== </span><span class='Number'>0</span> <span class='Operator'>&& </span><a href="snprintf.c.html#LN847"><span class='Ref_to_Parameter'>pointflag</span></a> <span class='Operator'>&& </span><a href="snprintf.c.html#LN847"><span class='Ref_to_Parameter'>precision</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>        <a href="snprintf.c.html#LN855"><span class='Ref_To_Local'>vallen</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* make integer string */ 
</span><a name="LN900"></a>        <a href="../include/c.h.html#LN297"><span class='Ref_to_Typedef'>uint64</span></a>      <span class='Declare_Local'>uvalue</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../include/c.h.html#LN297"><span class='Ref_to_Typedef'>uint64</span></a><span class='Parentheses'>) </span><span class='Keyword'>value</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>do</span> 
        <span class='Delimiter'>{ 
</span>            <a href="snprintf.c.html#LN854"><span class='Ref_To_Local'>convert</span></a><span class='Delimiter'>[</span><a href="snprintf.c.html#LN855"><span class='Ref_To_Local'>vallen</span></a><span class='Operator'>++</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="snprintf.c.html#LN852"><span class='Ref_To_Local'>cvt</span></a><span class='Delimiter'>[</span><a href="snprintf.c.html#LN900"><span class='Ref_To_Local'>uvalue</span></a> <span class='Operator'>% </span><a href="snprintf.c.html#LN850"><span class='Ref_To_Local'>base</span></a><span class='Delimiter'>]; 
</span>            <a href="snprintf.c.html#LN900"><span class='Ref_To_Local'>uvalue</span></a> <span class='Operator'>= </span><a href="snprintf.c.html#LN900"><span class='Ref_To_Local'>uvalue</span></a> <span class='Operator'>/ </span><a href="snprintf.c.html#LN850"><span class='Ref_To_Local'>base</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} </span><span class='Control'>while</span> <span class='Parentheses'>(</span><a href="snprintf.c.html#LN900"><span class='Ref_To_Local'>uvalue</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="snprintf.c.html#LN857"><span class='Ref_To_Local'>zeropad</span></a> <span class='Operator'>= </span><a href="../interfaces/ecpg/pgtypeslib/numeric.c.html#LN10"><span class='Ref_to_Macro'>Max</span></a><span class='Parentheses'>(</span><span class='Number'>0</span><span class='Delimiter'>, </span><a href="snprintf.c.html#LN847"><span class='Ref_to_Parameter'>precision</span></a> <span class='Operator'>- </span><a href="snprintf.c.html#LN855"><span class='Ref_To_Local'>vallen</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="snprintf.c.html#LN287"><span class='Ref_to_Proto'>adjust_padlen</span></a><span class='Parentheses'>(</span><a href="snprintf.c.html#LN847"><span class='Ref_to_Parameter'>minlen</span></a><span class='Delimiter'>, </span><a href="snprintf.c.html#LN855"><span class='Ref_To_Local'>vallen</span></a> <span class='Operator'>+ </span><a href="snprintf.c.html#LN857"><span class='Ref_To_Local'>zeropad</span></a><span class='Delimiter'>, </span><a href="snprintf.c.html#LN846"><span class='Ref_to_Parameter'>leftjust</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="snprintf.c.html#LN856"><span class='Ref_To_Local'>padlen</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="snprintf.c.html#LN288"><span class='Ref_to_Proto'>leading_pad</span></a><span class='Parentheses'>(</span><a href="snprintf.c.html#LN847"><span class='Ref_to_Parameter'>zpad</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="snprintf.c.html#LN853"><span class='Ref_To_Local'>signvalue</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="snprintf.c.html#LN856"><span class='Ref_To_Local'>padlen</span></a><span class='Delimiter'>, </span><a href="snprintf.c.html#LN848"><span class='Ref_to_Parameter'>target</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>while</span> <span class='Parentheses'>(</span><a href="snprintf.c.html#LN857"><span class='Ref_To_Local'>zeropad</span></a><span class='Operator'>-- &GT; </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>        <a href="snprintf.c.html#LN285"><span class='Ref_to_Proto'>dopr_outch</span></a><span class='Parentheses'>(</span><span class='String'>'0'</span><span class='Delimiter'>, </span><a href="snprintf.c.html#LN848"><span class='Ref_to_Parameter'>target</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>while</span> <span class='Parentheses'>(</span><a href="snprintf.c.html#LN855"><span class='Ref_To_Local'>vallen</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>        <a href="snprintf.c.html#LN285"><span class='Ref_to_Proto'>dopr_outch</span></a><span class='Parentheses'>(</span><a href="snprintf.c.html#LN854"><span class='Ref_To_Local'>convert</span></a><span class='Delimiter'>[</span><span class='Operator'>--</span><a href="snprintf.c.html#LN855"><span class='Ref_To_Local'>vallen</span></a><span class='Delimiter'>], </span><a href="snprintf.c.html#LN848"><span class='Ref_to_Parameter'>target</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="snprintf.c.html#LN290"><span class='Ref_to_Proto'>trailing_pad</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="snprintf.c.html#LN856"><span class='Ref_To_Local'>padlen</span></a><span class='Delimiter'>, </span><a href="snprintf.c.html#LN848"><span class='Ref_to_Parameter'>target</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end fmtint &raquo; </span> 
 
<span class='Keyword'>static void 
</span><a name="LN925"></a><span class='Declare_Function'>fmtchar</span><span class='Parentheses'>(</span><span class='Keyword'>int </span><span class='Declare_Parameter'>value</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>leftjust</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>minlen</span><span class='Delimiter'>, </span><a href="snprintf.c.html#LN107"><span class='Ref_to_Typedef'>PrintfTarget</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>target</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN927"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>padlen</span> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>;</span>     <span class='Comment_Single_Line'>/* amount to pad */ 
</span> 
    <a href="snprintf.c.html#LN287"><span class='Ref_to_Proto'>adjust_padlen</span></a><span class='Parentheses'>(</span><a href="snprintf.c.html#LN925"><span class='Ref_to_Parameter'>minlen</span></a><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Delimiter'>, </span><a href="snprintf.c.html#LN925"><span class='Ref_to_Parameter'>leftjust</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="snprintf.c.html#LN927"><span class='Ref_To_Local'>padlen</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>while</span> <span class='Parentheses'>(</span><a href="snprintf.c.html#LN927"><span class='Ref_To_Local'>padlen</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="snprintf.c.html#LN285"><span class='Ref_to_Proto'>dopr_outch</span></a><span class='Parentheses'>(</span><span class='String'>' '</span><span class='Delimiter'>, </span><a href="snprintf.c.html#LN925"><span class='Ref_to_Parameter'>target</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Operator'>--</span><a href="snprintf.c.html#LN927"><span class='Ref_To_Local'>padlen</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="snprintf.c.html#LN285"><span class='Ref_to_Proto'>dopr_outch</span></a><span class='Parentheses'>(</span><span class='Keyword'>value</span><span class='Delimiter'>, </span><a href="snprintf.c.html#LN925"><span class='Ref_to_Parameter'>target</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="snprintf.c.html#LN290"><span class='Ref_to_Proto'>trailing_pad</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="snprintf.c.html#LN927"><span class='Ref_To_Local'>padlen</span></a><span class='Delimiter'>, </span><a href="snprintf.c.html#LN925"><span class='Ref_to_Parameter'>target</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Keyword'>static void 
</span><a name="LN943"></a><span class='Declare_Function'>fmtfloat</span><span class='Parentheses'>(</span><span class='Keyword'>double </span><span class='Declare_Parameter'>value</span><span class='Delimiter'>, </span><span class='Keyword'>char </span><span class='Declare_Parameter'>type</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>forcesign</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>leftjust</span><span class='Delimiter'>, 
</span><a name="LN944"></a>         <span class='Keyword'>int </span><span class='Declare_Parameter'>minlen</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>zpad</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>precision</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>pointflag</span><span class='Delimiter'>, 
</span><a name="LN945"></a>         <a href="snprintf.c.html#LN107"><span class='Ref_to_Typedef'>PrintfTarget</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>target</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN947"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>signvalue</span> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span><a name="LN948"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>prec</span><span class='Delimiter'>; 
</span><a name="LN949"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>vallen</span><span class='Delimiter'>; 
</span><a name="LN950"></a>    <span class='Keyword'>char</span>        <span class='Declare_Local'>fmt</span><span class='Delimiter'>[</span><span class='Number'>32</span><span class='Delimiter'>]; 
</span><a name="LN951"></a>    <span class='Keyword'>char</span>        <span class='Declare_Local'>convert</span><span class='Delimiter'>[</span><span class='Number'>1024</span><span class='Delimiter'>]; 
</span><a name="LN952"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>zeropadlen</span> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><span class='Comment_Single_Line'>/* amount to pad with zeroes */ 
</span><a name="LN953"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>padlen</span> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>;</span>     <span class='Comment_Single_Line'>/* amount to pad with spaces */ 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * We rely on the regular C library's sprintf to do the basic conversion, 
     * then handle padding considerations here. 
     * 
     * The dynamic range of "double" is about 1E+-308 for IEEE math, and not 
     * too wildly more than that with other hardware.  In "f" format, sprintf 
     * could therefore generate at most 308 characters to the left of the 
     * decimal point; while we need to allow the precision to get as high as 
     * 308+17 to ensure that we don't truncate significant digits from very 
     * small values.  To handle both these extremes, we use a buffer of 1024 
     * bytes and limit requested precision to 350 digits; this should prevent 
     * buffer overrun even with non-IEEE math.  If the original precision 
     * request was more than 350, separately pad with zeroes. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="snprintf.c.html#LN944"><span class='Ref_to_Parameter'>precision</span></a> <span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>)</span>          <span class='Comment_Single_Line'>/* cover possible overflow of "accum" */ 
</span>        <a href="snprintf.c.html#LN944"><span class='Ref_to_Parameter'>precision</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <a href="snprintf.c.html#LN948"><span class='Ref_To_Local'>prec</span></a> <span class='Operator'>= </span><a href="../interfaces/ecpg/pgtypeslib/numeric.c.html#LN11"><span class='Ref_to_Macro'>Min</span></a><span class='Parentheses'>(</span><a href="snprintf.c.html#LN944"><span class='Ref_to_Parameter'>precision</span></a><span class='Delimiter'>, </span><span class='Number'>350</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="snprintf.c.html#LN944"><span class='Ref_to_Parameter'>pointflag</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../include/port.h.html#LN170"><span class='Ref_to_Macro'>sprintf</span></a><span class='Parentheses'>(</span><a href="snprintf.c.html#LN950"><span class='Ref_To_Local'>fmt</span></a><span class='Delimiter'>, </span><span class='String'>"%%.%d%c"</span><span class='Delimiter'>, </span><a href="snprintf.c.html#LN948"><span class='Ref_To_Local'>prec</span></a><span class='Delimiter'>, </span><a href="snprintf.c.html#LN943"><span class='Ref_to_Parameter'>type</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
            <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="snprintf.c.html#LN1029"><span class='Ref_to_Label'>fail</span></a><span class='Delimiter'>; 
</span>        <a href="snprintf.c.html#LN952"><span class='Ref_To_Local'>zeropadlen</span></a> <span class='Operator'>= </span><a href="snprintf.c.html#LN944"><span class='Ref_to_Parameter'>precision</span></a> <span class='Operator'>- </span><a href="snprintf.c.html#LN948"><span class='Ref_To_Local'>prec</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../include/port.h.html#LN170"><span class='Ref_to_Macro'>sprintf</span></a><span class='Parentheses'>(</span><a href="snprintf.c.html#LN950"><span class='Ref_To_Local'>fmt</span></a><span class='Delimiter'>, </span><span class='String'>"%%%c"</span><span class='Delimiter'>, </span><a href="snprintf.c.html#LN943"><span class='Ref_to_Parameter'>type</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="snprintf.c.html#LN1029"><span class='Ref_to_Label'>fail</span></a><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="../interfaces/ecpg/test/expected/pgtypeslib-nan_test.c.html#LN30"><span class='Ref_to_Macro'>isnan</span></a><span class='Parentheses'>(</span><span class='Keyword'>value</span><span class='Parentheses'>)</span> <span class='Operator'>&& </span><a href="snprintf.c.html#LN286"><span class='Ref_to_Proto'>adjust_sign</span></a><span class='Parentheses'>((</span><span class='Keyword'>value </span><span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="snprintf.c.html#LN943"><span class='Ref_to_Parameter'>forcesign</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="snprintf.c.html#LN947"><span class='Ref_To_Local'>signvalue</span></a><span class='Parentheses'>))</span> 
        <span class='Keyword'>value </span><span class='Operator'>= -</span><span class='Keyword'>value</span><span class='Delimiter'>; 
</span> 
    <a href="snprintf.c.html#LN949"><span class='Ref_To_Local'>vallen</span></a> <span class='Operator'>= </span><a href="../include/port.h.html#LN170"><span class='Ref_to_Macro'>sprintf</span></a><span class='Parentheses'>(</span><a href="snprintf.c.html#LN951"><span class='Ref_To_Local'>convert</span></a><span class='Delimiter'>, </span><a href="snprintf.c.html#LN950"><span class='Ref_To_Local'>fmt</span></a><span class='Delimiter'>, </span><span class='Keyword'>value</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="snprintf.c.html#LN949"><span class='Ref_To_Local'>vallen</span></a> <span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>        <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="snprintf.c.html#LN1029"><span class='Ref_to_Label'>fail</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* If it's infinity or NaN, forget about doing any zero-padding */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="snprintf.c.html#LN952"><span class='Ref_To_Local'>zeropadlen</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span> <span class='Operator'>&& !</span>isdigit<span class='Parentheses'>((</span><span class='Keyword'>unsigned char</span><span class='Parentheses'>) </span><a href="snprintf.c.html#LN951"><span class='Ref_To_Local'>convert</span></a><span class='Delimiter'>[</span><a href="snprintf.c.html#LN949"><span class='Ref_To_Local'>vallen</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>]</span><span class='Parentheses'>))</span> 
        <a href="snprintf.c.html#LN952"><span class='Ref_To_Local'>zeropadlen</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span> 
    <a href="snprintf.c.html#LN287"><span class='Ref_to_Proto'>adjust_padlen</span></a><span class='Parentheses'>(</span><a href="snprintf.c.html#LN944"><span class='Ref_to_Parameter'>minlen</span></a><span class='Delimiter'>, </span><a href="snprintf.c.html#LN949"><span class='Ref_To_Local'>vallen</span></a> <span class='Operator'>+ </span><a href="snprintf.c.html#LN952"><span class='Ref_To_Local'>zeropadlen</span></a><span class='Delimiter'>, </span><a href="snprintf.c.html#LN943"><span class='Ref_to_Parameter'>leftjust</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="snprintf.c.html#LN953"><span class='Ref_To_Local'>padlen</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="snprintf.c.html#LN288"><span class='Ref_to_Proto'>leading_pad</span></a><span class='Parentheses'>(</span><a href="snprintf.c.html#LN944"><span class='Ref_to_Parameter'>zpad</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="snprintf.c.html#LN947"><span class='Ref_To_Local'>signvalue</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="snprintf.c.html#LN953"><span class='Ref_To_Local'>padlen</span></a><span class='Delimiter'>, </span><a href="snprintf.c.html#LN945"><span class='Ref_to_Parameter'>target</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="snprintf.c.html#LN952"><span class='Ref_To_Local'>zeropadlen</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* If 'e' or 'E' format, inject zeroes before the exponent */ 
</span><a name="LN1000"></a>        <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>epos</span> <span class='Operator'>= </span>strrchr<span class='Parentheses'>(</span><a href="snprintf.c.html#LN951"><span class='Ref_To_Local'>convert</span></a><span class='Delimiter'>, </span><span class='String'>'e'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="snprintf.c.html#LN1000"><span class='Ref_To_Local'>epos</span></a><span class='Parentheses'>) 
</span>            <a href="snprintf.c.html#LN1000"><span class='Ref_To_Local'>epos</span></a> <span class='Operator'>= </span>strrchr<span class='Parentheses'>(</span><a href="snprintf.c.html#LN951"><span class='Ref_To_Local'>convert</span></a><span class='Delimiter'>, </span><span class='String'>'E'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="snprintf.c.html#LN1000"><span class='Ref_To_Local'>epos</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* pad after exponent */ 
</span>            <a href="snprintf.c.html#LN284"><span class='Ref_to_Proto'>dostr</span></a><span class='Parentheses'>(</span><a href="snprintf.c.html#LN951"><span class='Ref_To_Local'>convert</span></a><span class='Delimiter'>, </span><a href="snprintf.c.html#LN1000"><span class='Ref_To_Local'>epos</span></a> <span class='Operator'>- </span><a href="snprintf.c.html#LN951"><span class='Ref_To_Local'>convert</span></a><span class='Delimiter'>, </span><a href="snprintf.c.html#LN945"><span class='Ref_to_Parameter'>target</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>while</span> <span class='Parentheses'>(</span><a href="snprintf.c.html#LN952"><span class='Ref_To_Local'>zeropadlen</span></a><span class='Operator'>-- &GT; </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>                <a href="snprintf.c.html#LN285"><span class='Ref_to_Proto'>dopr_outch</span></a><span class='Parentheses'>(</span><span class='String'>'0'</span><span class='Delimiter'>, </span><a href="snprintf.c.html#LN945"><span class='Ref_to_Parameter'>target</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="snprintf.c.html#LN284"><span class='Ref_to_Proto'>dostr</span></a><span class='Parentheses'>(</span><a href="snprintf.c.html#LN1000"><span class='Ref_To_Local'>epos</span></a><span class='Delimiter'>, </span><a href="snprintf.c.html#LN949"><span class='Ref_To_Local'>vallen</span></a> <span class='Operator'>- </span><span class='Parentheses'>(</span><a href="snprintf.c.html#LN1000"><span class='Ref_To_Local'>epos</span></a> <span class='Operator'>- </span><a href="snprintf.c.html#LN951"><span class='Ref_To_Local'>convert</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, </span><a href="snprintf.c.html#LN945"><span class='Ref_to_Parameter'>target</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* no exponent, pad after the digits */ 
</span>            <a href="snprintf.c.html#LN284"><span class='Ref_to_Proto'>dostr</span></a><span class='Parentheses'>(</span><a href="snprintf.c.html#LN951"><span class='Ref_To_Local'>convert</span></a><span class='Delimiter'>, </span><a href="snprintf.c.html#LN949"><span class='Ref_To_Local'>vallen</span></a><span class='Delimiter'>, </span><a href="snprintf.c.html#LN945"><span class='Ref_to_Parameter'>target</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>while</span> <span class='Parentheses'>(</span><a href="snprintf.c.html#LN952"><span class='Ref_To_Local'>zeropadlen</span></a><span class='Operator'>-- &GT; </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>                <a href="snprintf.c.html#LN285"><span class='Ref_to_Proto'>dopr_outch</span></a><span class='Parentheses'>(</span><span class='String'>'0'</span><span class='Delimiter'>, </span><a href="snprintf.c.html#LN945"><span class='Ref_to_Parameter'>target</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if zeropadlen&GT;0 &raquo; </span> 
    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* no zero padding, just emit the number as-is */ 
</span>        <a href="snprintf.c.html#LN284"><span class='Ref_to_Proto'>dostr</span></a><span class='Parentheses'>(</span><a href="snprintf.c.html#LN951"><span class='Ref_To_Local'>convert</span></a><span class='Delimiter'>, </span><a href="snprintf.c.html#LN949"><span class='Ref_To_Local'>vallen</span></a><span class='Delimiter'>, </span><a href="snprintf.c.html#LN945"><span class='Ref_to_Parameter'>target</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <a href="snprintf.c.html#LN290"><span class='Ref_to_Proto'>trailing_pad</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="snprintf.c.html#LN953"><span class='Ref_To_Local'>padlen</span></a><span class='Delimiter'>, </span><a href="snprintf.c.html#LN945"><span class='Ref_to_Parameter'>target</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>return</span><span class='Delimiter'>; 
</span> 
<a name="LN1029"></a><span class='Label'>fail</span><span class='Operator'>: 
</span>    <a href="snprintf.c.html#LN945"><span class='Ref_to_Parameter'>target</span></a><span class='Operator'>-&GT;</span><a href="snprintf.c.html#LN115"><span class='Ref_to_Member'>failed</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end fmtfloat &raquo; </span> 
 
<span class='Keyword'>static void 
</span><a name="LN1034"></a><span class='Declare_Function'>dostr</span><span class='Parentheses'>(</span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>str</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>slen</span><span class='Delimiter'>, </span><a href="snprintf.c.html#LN107"><span class='Ref_to_Typedef'>PrintfTarget</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>target</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>while</span> <span class='Parentheses'>(</span><a href="snprintf.c.html#LN1034"><span class='Ref_to_Parameter'>slen</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN1038"></a>        <span class='Keyword'>int</span>         <span class='Declare_Local'>avail</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="snprintf.c.html#LN1034"><span class='Ref_to_Parameter'>target</span></a><span class='Operator'>-&GT;</span><a href="snprintf.c.html#LN111"><span class='Ref_to_Member'>bufend</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>            <a href="snprintf.c.html#LN1038"><span class='Ref_To_Local'>avail</span></a> <span class='Operator'>= </span><a href="snprintf.c.html#LN1034"><span class='Ref_to_Parameter'>target</span></a><span class='Operator'>-&GT;</span><a href="snprintf.c.html#LN111"><span class='Ref_to_Member'>bufend</span></a> <span class='Operator'>- </span><a href="snprintf.c.html#LN1034"><span class='Ref_to_Parameter'>target</span></a><span class='Operator'>-&GT;</span><a href="snprintf.c.html#LN109"><span class='Ref_to_Member'>bufptr</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> 
            <a href="snprintf.c.html#LN1038"><span class='Ref_To_Local'>avail</span></a> <span class='Operator'>= </span><a href="snprintf.c.html#LN1034"><span class='Ref_to_Parameter'>slen</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="snprintf.c.html#LN1038"><span class='Ref_To_Local'>avail</span></a> <span class='Operator'>&LT;= </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* buffer full, can we dump to stream? */ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="snprintf.c.html#LN1034"><span class='Ref_to_Parameter'>target</span></a><span class='Operator'>-&GT;</span><a href="snprintf.c.html#LN113"><span class='Ref_to_Member'>stream</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>                <span class='Control'>return</span><span class='Delimiter'>;</span>         <span class='Comment_Single_Line'>/* no, lose the data */ 
</span>            <a href="snprintf.c.html#LN144"><span class='Ref_to_Proto'>flushbuffer</span></a><span class='Parentheses'>(</span><a href="snprintf.c.html#LN1034"><span class='Ref_to_Parameter'>target</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>continue</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <a href="snprintf.c.html#LN1038"><span class='Ref_To_Local'>avail</span></a> <span class='Operator'>= </span><a href="../interfaces/ecpg/pgtypeslib/numeric.c.html#LN11"><span class='Ref_to_Macro'>Min</span></a><span class='Parentheses'>(</span><a href="snprintf.c.html#LN1038"><span class='Ref_To_Local'>avail</span></a><span class='Delimiter'>, </span><a href="snprintf.c.html#LN1034"><span class='Ref_to_Parameter'>slen</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="../include/c.h.html#LN1057"><span class='Ref_to_Macro'>memmove</span></a><span class='Parentheses'>(</span><a href="snprintf.c.html#LN1034"><span class='Ref_to_Parameter'>target</span></a><span class='Operator'>-&GT;</span><a href="snprintf.c.html#LN109"><span class='Ref_to_Member'>bufptr</span></a><span class='Delimiter'>, </span><a href="snprintf.c.html#LN1034"><span class='Ref_to_Parameter'>str</span></a><span class='Delimiter'>, </span><a href="snprintf.c.html#LN1038"><span class='Ref_To_Local'>avail</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="snprintf.c.html#LN1034"><span class='Ref_to_Parameter'>target</span></a><span class='Operator'>-&GT;</span><a href="snprintf.c.html#LN109"><span class='Ref_to_Member'>bufptr</span></a> <span class='Operator'>+= </span><a href="snprintf.c.html#LN1038"><span class='Ref_To_Local'>avail</span></a><span class='Delimiter'>; 
</span>        <a href="snprintf.c.html#LN1034"><span class='Ref_to_Parameter'>str</span></a> <span class='Operator'>+= </span><a href="snprintf.c.html#LN1038"><span class='Ref_To_Local'>avail</span></a><span class='Delimiter'>; 
</span>        <a href="snprintf.c.html#LN1034"><span class='Ref_to_Parameter'>slen</span></a> <span class='Operator'>-= </span><a href="snprintf.c.html#LN1038"><span class='Ref_To_Local'>avail</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end while slen&GT;0 &raquo; </span> 
<span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end dostr &raquo; </span> 
 
<span class='Keyword'>static void 
</span><a name="LN1061"></a><span class='Declare_Function'>dopr_outch</span><span class='Parentheses'>(</span><span class='Keyword'>int </span><span class='Declare_Parameter'>c</span><span class='Delimiter'>, </span><a href="snprintf.c.html#LN107"><span class='Ref_to_Typedef'>PrintfTarget</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>target</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="snprintf.c.html#LN1061"><span class='Ref_to_Parameter'>target</span></a><span class='Operator'>-&GT;</span><a href="snprintf.c.html#LN111"><span class='Ref_to_Member'>bufend</span></a> <span class='Operator'>!= </span><span class='Null_Value'>NULL </span><span class='Operator'>&& </span><a href="snprintf.c.html#LN1061"><span class='Ref_to_Parameter'>target</span></a><span class='Operator'>-&GT;</span><a href="snprintf.c.html#LN109"><span class='Ref_to_Member'>bufptr</span></a> <span class='Operator'>&GT;= </span><a href="snprintf.c.html#LN1061"><span class='Ref_to_Parameter'>target</span></a><span class='Operator'>-&GT;</span><a href="snprintf.c.html#LN111"><span class='Ref_to_Member'>bufend</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* buffer full, can we dump to stream? */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="snprintf.c.html#LN1061"><span class='Ref_to_Parameter'>target</span></a><span class='Operator'>-&GT;</span><a href="snprintf.c.html#LN113"><span class='Ref_to_Member'>stream</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>            <span class='Control'>return</span><span class='Delimiter'>;</span>             <span class='Comment_Single_Line'>/* no, lose the data */ 
</span>        <a href="snprintf.c.html#LN144"><span class='Ref_to_Proto'>flushbuffer</span></a><span class='Parentheses'>(</span><a href="snprintf.c.html#LN1061"><span class='Ref_to_Parameter'>target</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Operator'>*</span><span class='Parentheses'>(</span><a href="snprintf.c.html#LN1061"><span class='Ref_to_Parameter'>target</span></a><span class='Operator'>-&GT;</span><a href="snprintf.c.html#LN109"><span class='Ref_to_Member'>bufptr</span></a><span class='Operator'>++</span><span class='Parentheses'>) </span><span class='Operator'>= </span><a href="snprintf.c.html#LN1061"><span class='Ref_to_Parameter'>c</span></a><span class='Delimiter'>; 
} 
</span> 
 
<span class='Keyword'>static int 
</span><a name="LN1075"></a><span class='Declare_Function'>adjust_sign</span><span class='Parentheses'>(</span><span class='Keyword'>int </span><span class='Declare_Parameter'>is_negative</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>forcesign</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Operator'>*</span><span class='Declare_Parameter'>signvalue</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="snprintf.c.html#LN1075"><span class='Ref_to_Parameter'>is_negative</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Operator'>*</span><a href="snprintf.c.html#LN1075"><span class='Ref_to_Parameter'>signvalue</span></a> <span class='Operator'>= </span><span class='String'>'-'</span><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <span class='Boolean'>true</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="snprintf.c.html#LN1075"><span class='Ref_to_Parameter'>forcesign</span></a><span class='Parentheses'>) 
</span>        <span class='Operator'>*</span><a href="snprintf.c.html#LN1075"><span class='Ref_to_Parameter'>signvalue</span></a> <span class='Operator'>= </span><span class='String'>'+'</span><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <span class='Boolean'>false</span><span class='Delimiter'>; 
} 
</span> 
 
<span class='Keyword'>static void 
</span><a name="LN1089"></a><span class='Declare_Function'>adjust_padlen</span><span class='Parentheses'>(</span><span class='Keyword'>int </span><span class='Declare_Parameter'>minlen</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>vallen</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>leftjust</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Operator'>*</span><span class='Declare_Parameter'>padlen</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Operator'>*</span><a href="snprintf.c.html#LN1089"><span class='Ref_to_Parameter'>padlen</span></a> <span class='Operator'>= </span><a href="snprintf.c.html#LN1089"><span class='Ref_to_Parameter'>minlen</span></a> <span class='Operator'>- </span><a href="snprintf.c.html#LN1089"><span class='Ref_to_Parameter'>vallen</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="snprintf.c.html#LN1089"><span class='Ref_to_Parameter'>padlen</span></a> <span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>        <span class='Operator'>*</span><a href="snprintf.c.html#LN1089"><span class='Ref_to_Parameter'>padlen</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="snprintf.c.html#LN1089"><span class='Ref_to_Parameter'>leftjust</span></a><span class='Parentheses'>) 
</span>        <span class='Operator'>*</span><a href="snprintf.c.html#LN1089"><span class='Ref_to_Parameter'>padlen</span></a> <span class='Operator'>= -</span><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="snprintf.c.html#LN1089"><span class='Ref_to_Parameter'>padlen</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
 
<span class='Keyword'>static void 
</span><a name="LN1100"></a><span class='Declare_Function'>leading_pad</span><span class='Parentheses'>(</span><span class='Keyword'>int </span><span class='Declare_Parameter'>zpad</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Operator'>*</span><span class='Declare_Parameter'>signvalue</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Operator'>*</span><span class='Declare_Parameter'>padlen</span><span class='Delimiter'>, </span><a href="snprintf.c.html#LN107"><span class='Ref_to_Typedef'>PrintfTarget</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>target</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="snprintf.c.html#LN1100"><span class='Ref_to_Parameter'>padlen</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span> <span class='Operator'>&& </span><a href="snprintf.c.html#LN1100"><span class='Ref_to_Parameter'>zpad</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="snprintf.c.html#LN1100"><span class='Ref_to_Parameter'>signvalue</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <a href="snprintf.c.html#LN285"><span class='Ref_to_Proto'>dopr_outch</span></a><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="snprintf.c.html#LN1100"><span class='Ref_to_Parameter'>signvalue</span></a><span class='Delimiter'>, </span><a href="snprintf.c.html#LN1100"><span class='Ref_to_Parameter'>target</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Operator'>--</span><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="snprintf.c.html#LN1100"><span class='Ref_to_Parameter'>padlen</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Operator'>*</span><a href="snprintf.c.html#LN1100"><span class='Ref_to_Parameter'>signvalue</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>while</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="snprintf.c.html#LN1100"><span class='Ref_to_Parameter'>padlen</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <a href="snprintf.c.html#LN285"><span class='Ref_to_Proto'>dopr_outch</span></a><span class='Parentheses'>(</span><a href="snprintf.c.html#LN1100"><span class='Ref_to_Parameter'>zpad</span></a><span class='Delimiter'>, </span><a href="snprintf.c.html#LN1100"><span class='Ref_to_Parameter'>target</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Operator'>--</span><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="snprintf.c.html#LN1100"><span class='Ref_to_Parameter'>padlen</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>while</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="snprintf.c.html#LN1100"><span class='Ref_to_Parameter'>padlen</span></a> <span class='Operator'>&GT; </span><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="snprintf.c.html#LN1100"><span class='Ref_to_Parameter'>signvalue</span></a> <span class='Operator'>!= </span><span class='Number'>0</span><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span>        <a href="snprintf.c.html#LN285"><span class='Ref_to_Proto'>dopr_outch</span></a><span class='Parentheses'>(</span><span class='String'>' '</span><span class='Delimiter'>, </span><a href="snprintf.c.html#LN1100"><span class='Ref_to_Parameter'>target</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Operator'>--</span><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="snprintf.c.html#LN1100"><span class='Ref_to_Parameter'>padlen</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="snprintf.c.html#LN1100"><span class='Ref_to_Parameter'>signvalue</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="snprintf.c.html#LN285"><span class='Ref_to_Proto'>dopr_outch</span></a><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="snprintf.c.html#LN1100"><span class='Ref_to_Parameter'>signvalue</span></a><span class='Delimiter'>, </span><a href="snprintf.c.html#LN1100"><span class='Ref_to_Parameter'>target</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="snprintf.c.html#LN1100"><span class='Ref_to_Parameter'>padlen</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>            <span class='Operator'>--</span><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="snprintf.c.html#LN1100"><span class='Ref_to_Parameter'>padlen</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="snprintf.c.html#LN1100"><span class='Ref_to_Parameter'>padlen</span></a> <span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>            <span class='Operator'>++</span><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="snprintf.c.html#LN1100"><span class='Ref_to_Parameter'>padlen</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
}</span><span class='Auto_Annotations'> &laquo; end leading_pad &raquo; </span> 
 
 
<span class='Keyword'>static void 
</span><a name="LN1133"></a><span class='Declare_Function'>trailing_pad</span><span class='Parentheses'>(</span><span class='Keyword'>int </span><span class='Operator'>*</span><span class='Declare_Parameter'>padlen</span><span class='Delimiter'>, </span><a href="snprintf.c.html#LN107"><span class='Ref_to_Typedef'>PrintfTarget</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>target</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>while</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="snprintf.c.html#LN1133"><span class='Ref_to_Parameter'>padlen</span></a> <span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="snprintf.c.html#LN285"><span class='Ref_to_Proto'>dopr_outch</span></a><span class='Parentheses'>(</span><span class='String'>' '</span><span class='Delimiter'>, </span><a href="snprintf.c.html#LN1133"><span class='Ref_to_Parameter'>target</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Operator'>++</span><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="snprintf.c.html#LN1133"><span class='Ref_to_Parameter'>padlen</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
} 
</span></pre>
<table bgcolor='#c0c0c0' width='100%'><tr><td><a href='../../Contents.html'>Contents</a></td></tr>
</table><hr><p class='blurb' align='center'><a href='http://www.sourceinsight.com'>HTML Created by Source Insight Version 4.00.0084 Built on 2017-02-26</a></p>
</body></html>