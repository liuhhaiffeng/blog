<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta name="generator" content="Source Insight Version 4.00.0084 Built on 2017-02-26">
<meta charset='UTF-8' />
<style type='text/css'><!--
TD {background-color: #C0C0C0; font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 70%; }
.blurb {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 70%; }
.filename {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 120%; font-weight: bold; }
.dirname {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 100%; font-weight: bold; margin-top: 2.5em;}
--></style>
<title>src\timezone\localtime.c</title>
<LINK REL=StyleSheet HREF="../../C_Cpp_Source_File.css" TYPE='text/css' MEDIA=screen>
</head>
<body bgcolor=#ffffff>
<table bgcolor='#c0c0c0' width='100%'>
<tr><td><p class='filename'><b>src\timezone\localtime.c</b></p></td>
<td align='right'>
Wed Jun 14 08:26:15 2017
</td></tr>
<tr><td><a href='../../Contents.html'>Contents</a></td></tr>
</table>
<pre>
<span class='Comment_Multi_Line'>/* 
 * This file is in the public domain, so clarified as of 
 * 1996-06-05 by Arthur David Olson. 
 * 
 * IDENTIFICATION 
 *    src/timezone/localtime.c 
 */ 
</span> 
<span class='Comment_Multi_Line'>/* 
 * Leap second handling from Bradley White. 
 * POSIX-style TZ environment variable handling from Guy Harris. 
 */ 
</span> 
<span class='Comment_Multi_Line'>/* this file needs to build in both frontend and backend contexts */ 
</span><span class='Keyword'>#include </span><span class='String'>"c.h"</span> 
 
<span class='Keyword'>#include </span><span class='String'>&LT;fcntl.h&GT;</span> 
 
<span class='Keyword'>#include </span><span class='String'>"datatype/timestamp.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"pgtz.h"</span> 
 
<span class='Keyword'>#include </span><span class='String'>"private.h"</span> 
<span class='Keyword'>#include </span><span class='String'>"tzfile.h"</span> 
 
 
<span class='Directive'>#ifndef</span> <a href="localtime.c.html#LN45"><span class='Ref_to_Const'>WILDABBR</span></a> 
<span class='Comment_Multi_Line'>/* 
 * Someone might make incorrect use of a time zone abbreviation: 
 *  1.  They might reference tzname[0] before calling tzset (explicitly 
 *      or implicitly). 
 *  2.  They might reference tzname[1] before calling tzset (explicitly 
 *      or implicitly). 
 *  3.  They might reference tzname[1] after setting to a time zone 
 *      in which Daylight Saving Time is never observed. 
 *  4.  They might reference tzname[0] after setting to a time zone 
 *      in which Standard Time is never observed. 
 *  5.  They might reference tm.TM_ZONE after calling offtime. 
 * What's best to do in the above cases is open to debate; 
 * for now, we just set things up so that in any of the five cases 
 * WILDABBR is used. Another possibility: initialize tzname[0] to the 
 * string "tzname[0] used before set", and similarly for the other cases. 
 * And another: initialize tzname[0] to "ERA", with an explanation in the 
 * manual page of what this "time zone abbreviation" means (doing this so 
 * that tzname[0] has the "normal" length of three characters). 
 */ 
</span><a name="LN45"></a><span class='Keyword'>#define </span><span class='Declare_Constant'>WILDABBR</span>    <span class='String'>"   "</span> 
<span class='Directive'>#endif</span>   <span class='Comment_Single_Line'>/* !defined WILDABBR */ 
</span> 
<a name="LN48"></a><span class='Keyword'>static const char </span><span class='Declare_Var'>wildabbr</span><span class='Delimiter'>[] </span><span class='Operator'>= </span><a href="localtime.c.html#LN45"><span class='Ref_to_Const'>WILDABBR</span></a><span class='Delimiter'>; 
</span> 
<a name="LN50"></a><span class='Keyword'>static const char </span><span class='Declare_Var'>gmt</span><span class='Delimiter'>[] </span><span class='Operator'>= </span><span class='String'>"GMT"</span><span class='Delimiter'>; 
</span> 
<span class='Comment_Multi_Line'>/* The minimum and maximum finite time values.  This assumes no padding.  */ 
</span><a name="LN53"></a><span class='Keyword'>static const </span><a href="../include/pgtime.h.html#LN22"><span class='Ref_to_Typedef'>pg_time_t</span></a> <span class='Declare_Var'>time_t_min</span> <span class='Operator'>= </span><a href="private.h.html#LN81"><span class='Ref_to_Macro'>MINVAL</span></a><span class='Parentheses'>(</span><a href="../include/pgtime.h.html#LN22"><span class='Ref_to_Typedef'>pg_time_t</span></a><span class='Delimiter'>, </span><a href="private.h.html#LN69"><span class='Ref_to_Macro'>TYPE_BIT</span></a><span class='Parentheses'>(</span><a href="../include/pgtime.h.html#LN22"><span class='Ref_to_Typedef'>pg_time_t</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span><a name="LN54"></a><span class='Keyword'>static const </span><a href="../include/pgtime.h.html#LN22"><span class='Ref_to_Typedef'>pg_time_t</span></a> <span class='Declare_Var'>time_t_max</span> <span class='Operator'>= </span><a href="private.h.html#LN78"><span class='Ref_to_Macro'>MAXVAL</span></a><span class='Parentheses'>(</span><a href="../include/pgtime.h.html#LN22"><span class='Ref_to_Typedef'>pg_time_t</span></a><span class='Delimiter'>, </span><a href="private.h.html#LN69"><span class='Ref_to_Macro'>TYPE_BIT</span></a><span class='Parentheses'>(</span><a href="../include/pgtime.h.html#LN22"><span class='Ref_to_Typedef'>pg_time_t</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
<span class='Comment_Multi_Line'>/* 
 * We cache the result of trying to load the TZDEFRULES zone here. 
 * tzdefrules_loaded is 0 if not tried yet, +1 if good, -1 if failed. 
 */ 
</span><a name="LN60"></a><span class='Keyword'>static </span><span class='Control'>struct</span> <a href="pgtz.h.html#LN40"><span class='Ref_to_Struct'>state</span></a> <span class='Declare_Var'>tzdefrules_s</span><span class='Delimiter'>; 
</span><a name="LN61"></a><span class='Keyword'>static int</span>  <span class='Declare_Var'>tzdefrules_loaded</span> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span> 
<span class='Comment_Multi_Line'>/* 
 * The DST rules to use if TZ has no rules and we can't load TZDEFRULES. 
 * We default to US rules as of 1999-08-17. 
 * POSIX 1003.1 section 8.1.1 says that the default DST rules are 
 * implementation dependent; for historical reasons, US rules are a 
 * common default. 
 */ 
</span><a name="LN70"></a><span class='Keyword'>#define </span><span class='Declare_Constant'>TZDEFRULESTRING</span> <span class='String'>",M4.1.0,M10.5.0"</span> 
 
<span class='Comment_Multi_Line'>/* structs ttinfo, lsinfo, state have been moved to pgtz.h */ 
</span> 
<a name="LN74"></a><span class='Control'>enum</span> <span class='Declare_Enum'>r_type</span> 
<span class='Delimiter'>{ 
</span><a name="LN76"></a>    <span class='Declare_Enum_Const'>JULIAN_DAY</span><span class='Delimiter'>,</span>                 <span class='Comment_Single_Line'>/* Jn = Julian day */ 
</span><a name="LN77"></a>    <span class='Declare_Enum_Const'>DAY_OF_YEAR</span><span class='Delimiter'>,</span>                <span class='Comment_Single_Line'>/* n = day of year */ 
</span><a name="LN78"></a>    <span class='Declare_Enum_Const'>MONTH_NTH_DAY_OF_WEEK</span>       <span class='Comment_Single_Line'>/* Mm.n.d = month, week, day of week */ 
</span><span class='Delimiter'>}; 
</span> 
<a name="LN81"></a><span class='Control'>struct</span> <span class='Declare_Struct'>rule</span> 
<span class='Delimiter'>{ 
</span><a name="LN83"></a>    <span class='Control'>enum</span> <a href="localtime.c.html#LN83"><span class='Ref_to_Member'>r_type</span></a> <span class='Declare_Member'>r_type</span><span class='Delimiter'>;</span>         <span class='Comment_Single_Line'>/* type of rule */ 
</span><a name="LN84"></a>    <span class='Keyword'>int</span>         <span class='Declare_Member'>r_day</span><span class='Delimiter'>;</span>          <span class='Comment_Single_Line'>/* day number of rule */ 
</span><a name="LN85"></a>    <span class='Keyword'>int</span>         <span class='Declare_Member'>r_week</span><span class='Delimiter'>;</span>         <span class='Comment_Single_Line'>/* week number of rule */ 
</span><a name="LN86"></a>    <span class='Keyword'>int</span>         <span class='Declare_Member'>r_mon</span><span class='Delimiter'>;</span>          <span class='Comment_Single_Line'>/* month number of rule */ 
</span><a name="LN87"></a>    <a href="../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>       <span class='Declare_Member'>r_time</span><span class='Delimiter'>;</span>         <span class='Comment_Single_Line'>/* transition time of rule */ 
</span><span class='Delimiter'>}; 
</span> 
<span class='Comment_Multi_Line'>/* 
 * Prototypes for static functions. 
 */ 
</span> 
<a name="LN94"></a><span class='Keyword'>static </span><span class='Control'>struct</span> <a href="../include/pgtime.h.html#LN24"><span class='Ref_to_Struct'>pg_tm</span></a> <span class='Operator'>*</span><span class='Declare_Prototype'>gmtsub</span><span class='Parentheses'>(</span><a href="../include/pgtime.h.html#LN22"><span class='Ref_to_Typedef'>pg_time_t</span></a> <span class='Declare_Parameter'>const</span> <span class='Operator'>*</span><span class='Delimiter'>, </span><a href="../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a><span class='Delimiter'>, </span><span class='Control'>struct</span> <span class='Declare_Parameter'>pg_tm</span> <span class='Operator'>*</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN95"></a><span class='Keyword'>static bool </span><span class='Declare_Prototype'>increment_overflow</span><span class='Parentheses'>(</span><span class='Declare_Parameter'>int</span> <span class='Operator'>*</span><span class='Delimiter'>, </span><span class='Keyword'>int</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN96"></a><span class='Keyword'>static bool </span><span class='Declare_Prototype'>increment_overflow_time</span><span class='Parentheses'>(</span><span class='Declare_Parameter'>pg_time_t</span> <span class='Operator'>*</span><span class='Delimiter'>, </span><a href="../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN97"></a><span class='Keyword'>static </span><span class='Control'>struct</span> <a href="../include/pgtime.h.html#LN24"><span class='Ref_to_Struct'>pg_tm</span></a> <span class='Operator'>*</span><span class='Declare_Prototype'>timesub</span><span class='Parentheses'>(</span><a href="../include/pgtime.h.html#LN22"><span class='Ref_to_Typedef'>pg_time_t</span></a> <span class='Declare_Parameter'>const</span> <span class='Operator'>*</span><span class='Delimiter'>, </span><a href="../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a><span class='Delimiter'>, </span><span class='Control'>struct</span> <a href="pgtz.h.html#LN40"><span class='Ref_to_Struct'>state</span></a> <span class='Declare_Parameter'>const</span> <span class='Operator'>*</span><span class='Delimiter'>, 
</span><a name="LN98"></a>        <span class='Control'>struct</span> <span class='Declare_Parameter'>pg_tm</span> <span class='Operator'>*</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN99"></a><span class='Keyword'>static bool </span><span class='Declare_Prototype'>typesequiv</span><span class='Parentheses'>(</span><span class='Control'>struct</span> <a href="pgtz.h.html#LN40"><span class='Ref_to_Struct'>state</span></a> <span class='Declare_Parameter'>const</span> <span class='Operator'>*</span><span class='Delimiter'>, </span><span class='Keyword'>int</span><span class='Delimiter'>, </span><span class='Keyword'>int</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
 
<span class='Comment_Multi_Line'>/* 
 * Section 4.12.3 of X3.159-1989 requires that 
 *  Except for the strftime function, these functions [asctime, 
 *  ctime, gmtime, localtime] return values in one of two static 
 *  objects: a broken-down time structure and an array of char. 
 * Thanks to Paul Eggert for noting this. 
 */ 
</span> 
<a name="LN110"></a><span class='Keyword'>static </span><span class='Control'>struct</span> <a href="../include/pgtime.h.html#LN24"><span class='Ref_to_Struct'>pg_tm</span></a> <span class='Declare_Var'>tm</span><span class='Delimiter'>; 
</span> 
<span class='Comment_Multi_Line'>/* Initialize *S to a value based on GMTOFF, ISDST, and ABBRIND.  */ 
</span><span class='Keyword'>static void 
</span><a name="LN114"></a><span class='Declare_Function'>init_ttinfo</span><span class='Parentheses'>(</span><span class='Control'>struct</span> <a href="pgtz.h.html#LN25"><span class='Ref_to_Struct'>ttinfo</span></a> <span class='Operator'>* </span><span class='Declare_Parameter'>s</span><span class='Delimiter'>, </span><a href="../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a> <span class='Declare_Parameter'>gmtoff</span><span class='Delimiter'>, </span><span class='Keyword'>bool </span><span class='Declare_Parameter'>isdst</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>abbrind</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <a href="localtime.c.html#LN114"><span class='Ref_to_Parameter'>s</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN27"><span class='Ref_to_Member'>tt_gmtoff</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN114"><span class='Ref_to_Parameter'>gmtoff</span></a><span class='Delimiter'>; 
</span>    <a href="localtime.c.html#LN114"><span class='Ref_to_Parameter'>s</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN28"><span class='Ref_to_Member'>tt_isdst</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN114"><span class='Ref_to_Parameter'>isdst</span></a><span class='Delimiter'>; 
</span>    <a href="localtime.c.html#LN114"><span class='Ref_to_Parameter'>s</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN29"><span class='Ref_to_Member'>tt_abbrind</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN114"><span class='Ref_to_Parameter'>abbrind</span></a><span class='Delimiter'>; 
</span>    <a href="localtime.c.html#LN114"><span class='Ref_to_Parameter'>s</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN30"><span class='Ref_to_Member'>tt_ttisstd</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>    <a href="localtime.c.html#LN114"><span class='Ref_to_Parameter'>s</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN31"><span class='Ref_to_Member'>tt_ttisgmt</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
} 
</span> 
<span class='Keyword'>static </span><a href="../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a> 
<a name="LN124"></a><span class='Declare_Function'>detzcode</span><span class='Parentheses'>(</span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>codep</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN126"></a>    <a href="../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>       <span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span><a name="LN127"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>i</span><span class='Delimiter'>; 
</span><a name="LN128"></a>    <a href="../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>       <span class='Declare_Local'>one</span> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span><a name="LN129"></a>    <a href="../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>       <span class='Declare_Local'>halfmaxval</span> <span class='Operator'>= </span><a href="localtime.c.html#LN128"><span class='Ref_To_Local'>one</span></a> <span class='Operator'>&LT;&LT; </span><span class='Parentheses'>(</span><span class='Number'>32</span> <span class='Operator'>- </span><span class='Number'>2</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN130"></a>    <a href="../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>       <span class='Declare_Local'>maxval</span> <span class='Operator'>= </span><a href="localtime.c.html#LN129"><span class='Ref_To_Local'>halfmaxval</span></a> <span class='Operator'>- </span><span class='Number'>1</span> <span class='Operator'>+ </span><a href="localtime.c.html#LN129"><span class='Ref_To_Local'>halfmaxval</span></a><span class='Delimiter'>; 
</span><a name="LN131"></a>    <a href="../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>       <span class='Declare_Local'>minval</span> <span class='Operator'>= -</span><span class='Number'>1</span> <span class='Operator'>- </span><a href="localtime.c.html#LN130"><span class='Ref_To_Local'>maxval</span></a><span class='Delimiter'>; 
</span> 
    <a href="localtime.c.html#LN126"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN124"><span class='Ref_to_Parameter'>codep</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>] </span><span class='Operator'>& </span><span class='Number'>0x7f</span><span class='Delimiter'>; 
</span>    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN127"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>; </span><a href="localtime.c.html#LN127"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><span class='Number'>4</span><span class='Delimiter'>; </span><span class='Operator'>++</span><a href="localtime.c.html#LN127"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>) 
</span>        <a href="localtime.c.html#LN126"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="localtime.c.html#LN126"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>&LT;&LT; </span><span class='Number'>8</span><span class='Parentheses'>) </span><span class='Operator'>| </span><span class='Parentheses'>(</span><a href="localtime.c.html#LN124"><span class='Ref_to_Parameter'>codep</span></a><span class='Delimiter'>[</span><a href="localtime.c.html#LN127"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>] </span><span class='Operator'>& </span><span class='Number'>0xff</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN124"><span class='Ref_to_Parameter'>codep</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>] </span><span class='Operator'>& </span><span class='Number'>0x80</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* 
         * Do two's-complement negation even on non-two's-complement machines. 
         * If the result would be minval - 1, return minval. 
         */ 
</span>        <a href="localtime.c.html#LN126"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>-= !</span><a href="private.h.html#LN71"><span class='Ref_to_Macro'>TWOS_COMPLEMENT</span></a><span class='Parentheses'>(</span><a href="../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a><span class='Parentheses'>) </span><span class='Operator'>&&</span><a href="localtime.c.html#LN126"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>!= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>        <a href="localtime.c.html#LN126"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>+= </span><a href="localtime.c.html#LN131"><span class='Ref_To_Local'>minval</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>return</span> <a href="localtime.c.html#LN126"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end detzcode &raquo; </span> 
 
<span class='Keyword'>static </span><a href="../include/c.h.html#LN294"><span class='Ref_to_Typedef'>int64</span></a> 
<a name="LN150"></a><span class='Declare_Function'>detzcode64</span><span class='Parentheses'>(</span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>codep</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN152"></a>    <a href="../include/c.h.html#LN297"><span class='Ref_to_Typedef'>uint64</span></a>      <span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span><a name="LN153"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>i</span><span class='Delimiter'>; 
</span><a name="LN154"></a>    <a href="../include/c.h.html#LN294"><span class='Ref_to_Typedef'>int64</span></a>       <span class='Declare_Local'>one</span> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span><a name="LN155"></a>    <a href="../include/c.h.html#LN294"><span class='Ref_to_Typedef'>int64</span></a>       <span class='Declare_Local'>halfmaxval</span> <span class='Operator'>= </span><a href="localtime.c.html#LN154"><span class='Ref_To_Local'>one</span></a> <span class='Operator'>&LT;&LT; </span><span class='Parentheses'>(</span><span class='Number'>64</span> <span class='Operator'>- </span><span class='Number'>2</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN156"></a>    <a href="../include/c.h.html#LN294"><span class='Ref_to_Typedef'>int64</span></a>       <span class='Declare_Local'>maxval</span> <span class='Operator'>= </span><a href="localtime.c.html#LN155"><span class='Ref_To_Local'>halfmaxval</span></a> <span class='Operator'>- </span><span class='Number'>1</span> <span class='Operator'>+ </span><a href="localtime.c.html#LN155"><span class='Ref_To_Local'>halfmaxval</span></a><span class='Delimiter'>; 
</span><a name="LN157"></a>    <a href="../include/c.h.html#LN294"><span class='Ref_to_Typedef'>int64</span></a>       <span class='Declare_Local'>minval</span> <span class='Operator'>= -</span><a href="private.h.html#LN71"><span class='Ref_to_Macro'>TWOS_COMPLEMENT</span></a><span class='Parentheses'>(</span><a href="../include/c.h.html#LN294"><span class='Ref_to_Typedef'>int64</span></a><span class='Parentheses'>) </span><span class='Operator'>-</span><a href="localtime.c.html#LN156"><span class='Ref_To_Local'>maxval</span></a><span class='Delimiter'>; 
</span> 
    <a href="localtime.c.html#LN152"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN150"><span class='Ref_to_Parameter'>codep</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>] </span><span class='Operator'>& </span><span class='Number'>0x7f</span><span class='Delimiter'>; 
</span>    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN153"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>; </span><a href="localtime.c.html#LN153"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><span class='Number'>8</span><span class='Delimiter'>; </span><span class='Operator'>++</span><a href="localtime.c.html#LN153"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>) 
</span>        <a href="localtime.c.html#LN152"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="localtime.c.html#LN152"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>&LT;&LT; </span><span class='Number'>8</span><span class='Parentheses'>) </span><span class='Operator'>| </span><span class='Parentheses'>(</span><a href="localtime.c.html#LN150"><span class='Ref_to_Parameter'>codep</span></a><span class='Delimiter'>[</span><a href="localtime.c.html#LN153"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>] </span><span class='Operator'>& </span><span class='Number'>0xff</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN150"><span class='Ref_to_Parameter'>codep</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>] </span><span class='Operator'>& </span><span class='Number'>0x80</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* 
         * Do two's-complement negation even on non-two's-complement machines. 
         * If the result would be minval - 1, return minval. 
         */ 
</span>        <a href="localtime.c.html#LN152"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>-= !</span><a href="private.h.html#LN71"><span class='Ref_to_Macro'>TWOS_COMPLEMENT</span></a><span class='Parentheses'>(</span><a href="../include/c.h.html#LN294"><span class='Ref_to_Typedef'>int64</span></a><span class='Parentheses'>) </span><span class='Operator'>&&</span><a href="localtime.c.html#LN152"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>!= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>        <a href="localtime.c.html#LN152"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>+= </span><a href="localtime.c.html#LN157"><span class='Ref_To_Local'>minval</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>return</span> <a href="localtime.c.html#LN152"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end detzcode64 &raquo; </span> 
 
<span class='Keyword'>static bool 
</span><a name="LN176"></a><span class='Declare_Function'>differ_by_repeat</span><span class='Parentheses'>(</span><span class='Keyword'>const </span><a href="../include/pgtime.h.html#LN22"><span class='Ref_to_Typedef'>pg_time_t</span></a> <span class='Declare_Parameter'>t1</span><span class='Delimiter'>, </span><span class='Keyword'>const </span><a href="../include/pgtime.h.html#LN22"><span class='Ref_to_Typedef'>pg_time_t</span></a> <span class='Declare_Parameter'>t0</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="private.h.html#LN69"><span class='Ref_to_Macro'>TYPE_BIT</span></a><span class='Parentheses'>(</span><a href="../include/pgtime.h.html#LN22"><span class='Ref_to_Typedef'>pg_time_t</span></a><span class='Parentheses'>) </span><span class='Operator'>-</span><a href="private.h.html#LN70"><span class='Ref_to_Macro'>TYPE_SIGNED</span></a><span class='Parentheses'>(</span><a href="../include/pgtime.h.html#LN22"><span class='Ref_to_Typedef'>pg_time_t</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT;</span><a href="private.h.html#LN166"><span class='Ref_to_Const'>SECSPERREPEAT_BITS</span></a><span class='Parentheses'>)</span> 
        <span class='Control'>return</span> <span class='Number'>0</span><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <a href="localtime.c.html#LN176"><span class='Ref_to_Parameter'>t1</span></a> <span class='Operator'>- </span><a href="localtime.c.html#LN176"><span class='Ref_to_Parameter'>t0</span></a> <span class='Operator'>== </span><a href="private.h.html#LN164"><span class='Ref_to_Const'>SECSPERREPEAT</span></a><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* Input buffer for data read from a compiled tz file.  */ 
</span><a name="LN184"></a><span class='Control'>union</span> <span class='Declare_Union'>input_buffer</span> 
<span class='Delimiter'>{ 
</span>    <span class='Comment_Multi_Line'>/* The first part of the buffer, interpreted as a header.  */ 
</span><a name="LN187"></a>    <span class='Control'>struct</span> <a href="localtime.c.html#LN187"><span class='Ref_to_Member'>tzhead</span></a> <span class='Declare_Member'>tzhead</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* The entire buffer.  */ 
</span><a name="LN190"></a>    <span class='Keyword'>char</span>        <span class='Declare_Member'>buf</span><span class='Delimiter'>[</span><span class='Number'>2</span> <span class='Operator'>* </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><span class='Control'>struct</span> <a href="localtime.c.html#LN187"><span class='Ref_to_Member'>tzhead</span></a><span class='Parentheses'>) </span><span class='Operator'>+ </span><span class='Number'>2</span> <span class='Operator'>* </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><span class='Control'>struct</span> <a href="pgtz.h.html#LN40"><span class='Ref_to_Struct'>state</span></a><span class='Parentheses'>) 
</span>                    <span class='Operator'>+</span>           <span class='Number'>4</span> <span class='Operator'>* </span><a href="tzfile.h.html#LN92"><span class='Ref_to_Const'>TZ_MAX_TIMES</span></a><span class='Delimiter'>]; 
}; 
</span> 
<span class='Comment_Multi_Line'>/* Local storage needed for 'tzloadbody'.  */ 
</span><a name="LN195"></a><span class='Control'>union</span> <span class='Declare_Union'>local_storage</span> 
<span class='Delimiter'>{ 
</span>    <span class='Comment_Multi_Line'>/* We don't need the "fullname" member */ 
</span> 
    <span class='Comment_Multi_Line'>/* The results of analyzing the file's contents after it is opened.  */ 
</span>    <span class='Control'>struct</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* The input buffer.  */ 
</span><a name="LN203"></a>        <span class='Control'>union</span> <a href="localtime.c.html#LN184"><span class='Ref_to_Union'>input_buffer</span></a> <span class='Declare_Member'>u</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* A temporary state used for parsing a TZ string in the file.  */ 
</span><a name="LN206"></a>        <span class='Control'>struct</span> <a href="pgtz.h.html#LN40"><span class='Ref_to_Struct'>state</span></a> <span class='Declare_Member'>st</span><span class='Delimiter'>; 
</span><a name="LN207"></a>    <span class='Delimiter'>}</span>           <span class='Declare_Member'>u</span><span class='Delimiter'>; 
}; 
</span> 
<span class='Comment_Multi_Line'>/* Load tz data from the file named NAME into *SP.  Read extended 
 * format if DOEXTEND.  Use *LSP for temporary storage.  Return 0 on 
 * success, an errno value on failure. 
 * PG: If "canonname" is not NULL, then on success the canonical spelling of 
 * given name is stored there (the buffer must be &GT; TZ_STRLEN_MAX bytes!). 
 */ 
</span><span class='Keyword'>static int 
</span><a name="LN217"></a><span class='Declare_Function'>tzloadbody</span><span class='Parentheses'>(</span><span class='Keyword'>char const </span><span class='Operator'>* </span><span class='Declare_Parameter'>name</span><span class='Delimiter'>, </span><span class='Keyword'>char </span><span class='Operator'>*</span><span class='Declare_Parameter'>canonname</span><span class='Delimiter'>, </span><span class='Control'>struct</span> <a href="pgtz.h.html#LN40"><span class='Ref_to_Struct'>state</span></a> <span class='Operator'>* </span><span class='Declare_Parameter'>sp</span><span class='Delimiter'>, </span><span class='Keyword'>bool </span><span class='Declare_Parameter'>doextend</span><span class='Delimiter'>, 
</span><a name="LN218"></a>           <span class='Control'>union</span> <a href="localtime.c.html#LN195"><span class='Ref_to_Union'>local_storage</span></a> <span class='Operator'>* </span><span class='Declare_Parameter'>lsp</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN220"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>i</span><span class='Delimiter'>; 
</span><a name="LN221"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>fid</span><span class='Delimiter'>; 
</span><a name="LN222"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>stored</span><span class='Delimiter'>; 
</span><a name="LN223"></a>    <a href="../include/port/win32.h.html#LN419"><span class='Ref_to_Typedef'>ssize_t</span></a>     <span class='Declare_Local'>nread</span><span class='Delimiter'>; 
</span><a name="LN224"></a>    <span class='Control'>union</span> <a href="localtime.c.html#LN184"><span class='Ref_to_Union'>input_buffer</span></a> <span class='Operator'>*</span><span class='Declare_Local'>up</span> <span class='Operator'>= &</span><a href="localtime.c.html#LN218"><span class='Ref_to_Parameter'>lsp</span></a><span class='Operator'>-&GT;</span><a href="localtime.c.html#LN207"><span class='Ref_to_Member'>u</span></a><span class='Operator'>.</span><a href="localtime.c.html#LN203"><span class='Ref_to_Member'>u</span></a><span class='Delimiter'>; 
</span><a name="LN225"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>tzheadsize</span> <span class='Operator'>= </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><span class='Control'>struct</span> <a href="tzfile.h.html#LN32"><span class='Ref_to_Struct'>tzhead</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <a href="localtime.c.html#LN217"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN46"><span class='Ref_to_Member'>goback</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN217"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN47"><span class='Ref_to_Member'>goahead</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="localtime.c.html#LN217"><span class='Ref_to_Parameter'>name</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="localtime.c.html#LN217"><span class='Ref_to_Parameter'>name</span></a> <span class='Operator'>= </span><a href="tzfile.h.html#LN23"><span class='Ref_to_Const'>TZDEFAULT</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="localtime.c.html#LN217"><span class='Ref_to_Parameter'>name</span></a><span class='Parentheses'>) 
</span>            <span class='Control'>return</span> EINVAL<span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN217"><span class='Ref_to_Parameter'>name</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>] </span><span class='Operator'>== </span><span class='String'>':'</span><span class='Parentheses'>) 
</span>        <span class='Operator'>++</span><a href="localtime.c.html#LN217"><span class='Ref_to_Parameter'>name</span></a><span class='Delimiter'>; 
</span> 
    <a href="localtime.c.html#LN221"><span class='Ref_To_Local'>fid</span></a> <span class='Operator'>= </span><a href="../bin/initdb/findtimezone.c.html#LN62"><span class='Ref_to_Func'>pg_open_tzfile</span></a><span class='Parentheses'>(</span><a href="localtime.c.html#LN217"><span class='Ref_to_Parameter'>name</span></a><span class='Delimiter'>, </span><a href="localtime.c.html#LN217"><span class='Ref_to_Parameter'>canonname</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN221"><span class='Ref_To_Local'>fid</span></a> <span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> ENOENT<span class='Delimiter'>;</span>          <span class='Comment_Single_Line'>/* pg_open_tzfile may not set errno */ 
</span> 
    <a href="localtime.c.html#LN223"><span class='Ref_To_Local'>nread</span></a> <span class='Operator'>= </span><a href="../interfaces/libpq/win32.h.html#LN12"><span class='Ref_to_Macro'>read</span></a><span class='Parentheses'>(</span><a href="localtime.c.html#LN221"><span class='Ref_To_Local'>fid</span></a><span class='Delimiter'>, </span><a href="localtime.c.html#LN224"><span class='Ref_To_Local'>up</span></a><span class='Operator'>-&GT;</span><a href="localtime.c.html#LN190"><span class='Ref_to_Member'>buf</span></a><span class='Delimiter'>, </span><span class='Keyword'>sizeof </span><a href="localtime.c.html#LN224"><span class='Ref_To_Local'>up</span></a><span class='Operator'>-&GT;</span><a href="localtime.c.html#LN190"><span class='Ref_to_Member'>buf</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN223"><span class='Ref_To_Local'>nread</span></a> <span class='Operator'>&LT; </span><a href="localtime.c.html#LN225"><span class='Ref_To_Local'>tzheadsize</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN246"></a>        <span class='Keyword'>int</span>         <span class='Declare_Local'>err</span> <span class='Operator'>= </span><a href="localtime.c.html#LN223"><span class='Ref_To_Local'>nread</span></a> <span class='Operator'>&LT; </span><span class='Number'>0</span> <span class='Operator'>? </span>errno <span class='Operator'>: </span>EINVAL<span class='Delimiter'>; 
</span> 
        <a href="../interfaces/libpq/win32.h.html#LN11"><span class='Ref_to_Macro'>close</span></a><span class='Parentheses'>(</span><a href="localtime.c.html#LN221"><span class='Ref_To_Local'>fid</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <a href="localtime.c.html#LN246"><span class='Ref_To_Local'>err</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="../interfaces/libpq/win32.h.html#LN11"><span class='Ref_to_Macro'>close</span></a><span class='Parentheses'>(</span><a href="localtime.c.html#LN221"><span class='Ref_To_Local'>fid</span></a><span class='Parentheses'>) </span><span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <span class='Control'>return</span> errno<span class='Delimiter'>; 
</span>    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN222"><span class='Ref_To_Local'>stored</span></a> <span class='Operator'>= </span><span class='Number'>4</span><span class='Delimiter'>; </span><a href="localtime.c.html#LN222"><span class='Ref_To_Local'>stored</span></a> <span class='Operator'>&LT;= </span><span class='Number'>8</span><span class='Delimiter'>; </span><a href="localtime.c.html#LN222"><span class='Ref_To_Local'>stored</span></a> <span class='Operator'>*= </span><span class='Number'>2</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN255"></a>        <a href="../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>       <span class='Declare_Local'>ttisstdcnt</span> <span class='Operator'>= </span><a href="localtime.c.html#LN123"><span class='Ref_to_Func'>detzcode</span></a><span class='Parentheses'>(</span><a href="localtime.c.html#LN224"><span class='Ref_To_Local'>up</span></a><span class='Operator'>-&GT;</span><a href="localtime.c.html#LN187"><span class='Ref_to_Member'>tzhead</span></a><span class='Operator'>.</span><a href="tzfile.h.html#LN38"><span class='Ref_to_Member'>tzh_ttisstdcnt</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN256"></a>        <a href="../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>       <span class='Declare_Local'>ttisgmtcnt</span> <span class='Operator'>= </span><a href="localtime.c.html#LN123"><span class='Ref_to_Func'>detzcode</span></a><span class='Parentheses'>(</span><a href="localtime.c.html#LN224"><span class='Ref_To_Local'>up</span></a><span class='Operator'>-&GT;</span><a href="localtime.c.html#LN187"><span class='Ref_to_Member'>tzhead</span></a><span class='Operator'>.</span><a href="tzfile.h.html#LN37"><span class='Ref_to_Member'>tzh_ttisgmtcnt</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN257"></a>        <a href="../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>       <span class='Declare_Local'>leapcnt</span> <span class='Operator'>= </span><a href="localtime.c.html#LN123"><span class='Ref_to_Func'>detzcode</span></a><span class='Parentheses'>(</span><a href="localtime.c.html#LN224"><span class='Ref_To_Local'>up</span></a><span class='Operator'>-&GT;</span><a href="localtime.c.html#LN187"><span class='Ref_to_Member'>tzhead</span></a><span class='Operator'>.</span><a href="tzfile.h.html#LN39"><span class='Ref_to_Member'>tzh_leapcnt</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN258"></a>        <a href="../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>       <span class='Declare_Local'>timecnt</span> <span class='Operator'>= </span><a href="localtime.c.html#LN123"><span class='Ref_to_Func'>detzcode</span></a><span class='Parentheses'>(</span><a href="localtime.c.html#LN224"><span class='Ref_To_Local'>up</span></a><span class='Operator'>-&GT;</span><a href="localtime.c.html#LN187"><span class='Ref_to_Member'>tzhead</span></a><span class='Operator'>.</span><a href="tzfile.h.html#LN40"><span class='Ref_to_Member'>tzh_timecnt</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN259"></a>        <a href="../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>       <span class='Declare_Local'>typecnt</span> <span class='Operator'>= </span><a href="localtime.c.html#LN123"><span class='Ref_to_Func'>detzcode</span></a><span class='Parentheses'>(</span><a href="localtime.c.html#LN224"><span class='Ref_To_Local'>up</span></a><span class='Operator'>-&GT;</span><a href="localtime.c.html#LN187"><span class='Ref_to_Member'>tzhead</span></a><span class='Operator'>.</span><a href="tzfile.h.html#LN41"><span class='Ref_to_Member'>tzh_typecnt</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN260"></a>        <a href="../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>       <span class='Declare_Local'>charcnt</span> <span class='Operator'>= </span><a href="localtime.c.html#LN123"><span class='Ref_to_Func'>detzcode</span></a><span class='Parentheses'>(</span><a href="localtime.c.html#LN224"><span class='Ref_To_Local'>up</span></a><span class='Operator'>-&GT;</span><a href="localtime.c.html#LN187"><span class='Ref_to_Member'>tzhead</span></a><span class='Operator'>.</span><a href="tzfile.h.html#LN42"><span class='Ref_to_Member'>tzh_charcnt</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN261"></a>        <span class='Keyword'>char const </span><span class='Operator'>*</span><span class='Declare_Local'>p</span> <span class='Operator'>= </span><a href="localtime.c.html#LN224"><span class='Ref_To_Local'>up</span></a><span class='Operator'>-&GT;</span><a href="localtime.c.html#LN190"><span class='Ref_to_Member'>buf</span></a> <span class='Operator'>+ </span><a href="localtime.c.html#LN225"><span class='Ref_To_Local'>tzheadsize</span></a><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><span class='Parentheses'>(</span><span class='Number'>0</span> <span class='Operator'>&LT;= </span><a href="localtime.c.html#LN257"><span class='Ref_To_Local'>leapcnt</span></a> <span class='Operator'>&& </span><a href="localtime.c.html#LN257"><span class='Ref_To_Local'>leapcnt</span></a> <span class='Operator'>&LT; </span><a href="tzfile.h.html#LN100"><span class='Ref_to_Const'>TZ_MAX_LEAPS</span></a> 
              <span class='Operator'>&& </span><span class='Number'>0</span> <span class='Operator'>&LT; </span><a href="localtime.c.html#LN259"><span class='Ref_To_Local'>typecnt</span></a> <span class='Operator'>&& </span><a href="localtime.c.html#LN259"><span class='Ref_To_Local'>typecnt</span></a> <span class='Operator'>&LT; </span><a href="tzfile.h.html#LN95"><span class='Ref_to_Const'>TZ_MAX_TYPES</span></a> 
              <span class='Operator'>&& </span><span class='Number'>0</span> <span class='Operator'>&LT;= </span><a href="localtime.c.html#LN258"><span class='Ref_To_Local'>timecnt</span></a> <span class='Operator'>&& </span><a href="localtime.c.html#LN258"><span class='Ref_To_Local'>timecnt</span></a> <span class='Operator'>&LT; </span><a href="tzfile.h.html#LN92"><span class='Ref_to_Const'>TZ_MAX_TIMES</span></a> 
              <span class='Operator'>&& </span><span class='Number'>0</span> <span class='Operator'>&LT;= </span><a href="localtime.c.html#LN260"><span class='Ref_To_Local'>charcnt</span></a> <span class='Operator'>&& </span><a href="localtime.c.html#LN260"><span class='Ref_To_Local'>charcnt</span></a> <span class='Operator'>&LT; </span><a href="tzfile.h.html#LN97"><span class='Ref_to_Const'>TZ_MAX_CHARS</span></a> 
              <span class='Operator'>&& </span><span class='Parentheses'>(</span><a href="localtime.c.html#LN255"><span class='Ref_To_Local'>ttisstdcnt</span></a> <span class='Operator'>== </span><a href="localtime.c.html#LN259"><span class='Ref_To_Local'>typecnt</span></a> <span class='Operator'>|| </span><a href="localtime.c.html#LN255"><span class='Ref_To_Local'>ttisstdcnt</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>              <span class='Operator'>&& </span><span class='Parentheses'>(</span><a href="localtime.c.html#LN256"><span class='Ref_To_Local'>ttisgmtcnt</span></a> <span class='Operator'>== </span><a href="localtime.c.html#LN259"><span class='Ref_To_Local'>typecnt</span></a> <span class='Operator'>|| </span><a href="localtime.c.html#LN256"><span class='Ref_To_Local'>ttisgmtcnt</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)))</span> 
            <span class='Control'>return</span> EINVAL<span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN223"><span class='Ref_To_Local'>nread</span></a> 
            <span class='Operator'>&LT; </span><span class='Parentheses'>(</span><a href="localtime.c.html#LN225"><span class='Ref_To_Local'>tzheadsize</span></a>       <span class='Comment_Single_Line'>/* struct tzhead */ 
</span>               <span class='Operator'>+ </span><a href="localtime.c.html#LN258"><span class='Ref_To_Local'>timecnt</span></a> <span class='Operator'>* </span><a href="localtime.c.html#LN222"><span class='Ref_To_Local'>stored</span></a>       <span class='Comment_Single_Line'>/* ats */ 
</span>               <span class='Operator'>+ </span><a href="localtime.c.html#LN258"><span class='Ref_To_Local'>timecnt</span></a>        <span class='Comment_Single_Line'>/* types */ 
</span>               <span class='Operator'>+ </span><a href="localtime.c.html#LN259"><span class='Ref_To_Local'>typecnt</span></a> <span class='Operator'>* </span><span class='Number'>6</span>    <span class='Comment_Single_Line'>/* ttinfos */ 
</span>               <span class='Operator'>+ </span><a href="localtime.c.html#LN260"><span class='Ref_To_Local'>charcnt</span></a>        <span class='Comment_Single_Line'>/* chars */ 
</span>               <span class='Operator'>+ </span><a href="localtime.c.html#LN257"><span class='Ref_To_Local'>leapcnt</span></a> <span class='Operator'>* </span><span class='Parentheses'>(</span><a href="localtime.c.html#LN222"><span class='Ref_To_Local'>stored</span></a> <span class='Operator'>+ </span><span class='Number'>4</span><span class='Parentheses'>) </span><span class='Comment_Single_Line'>/* lsinfos */ 
</span>               <span class='Operator'>+ </span><a href="localtime.c.html#LN255"><span class='Ref_To_Local'>ttisstdcnt</span></a>     <span class='Comment_Single_Line'>/* ttisstds */ 
</span>               <span class='Operator'>+ </span><a href="localtime.c.html#LN256"><span class='Ref_To_Local'>ttisgmtcnt</span></a><span class='Parentheses'>))</span>   <span class='Comment_Single_Line'>/* ttisgmts */ 
</span>            <span class='Control'>return</span> EINVAL<span class='Delimiter'>; 
</span>        <a href="localtime.c.html#LN217"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN42"><span class='Ref_to_Member'>leapcnt</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN257"><span class='Ref_To_Local'>leapcnt</span></a><span class='Delimiter'>; 
</span>        <a href="localtime.c.html#LN217"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN43"><span class='Ref_to_Member'>timecnt</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN258"><span class='Ref_To_Local'>timecnt</span></a><span class='Delimiter'>; 
</span>        <a href="localtime.c.html#LN217"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN44"><span class='Ref_to_Member'>typecnt</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN259"><span class='Ref_To_Local'>typecnt</span></a><span class='Delimiter'>; 
</span>        <a href="localtime.c.html#LN217"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN45"><span class='Ref_to_Member'>charcnt</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN260"><span class='Ref_To_Local'>charcnt</span></a><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * Read transitions, discarding those out of pg_time_t range. But 
         * pretend the last transition before time_t_min occurred at 
         * time_t_min. 
         */ 
</span>        <a href="localtime.c.html#LN258"><span class='Ref_To_Local'>timecnt</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>        <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN220"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="localtime.c.html#LN220"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="localtime.c.html#LN217"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN43"><span class='Ref_to_Member'>timecnt</span></a><span class='Delimiter'>; </span><span class='Operator'>++</span><a href="localtime.c.html#LN220"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span><a name="LN293"></a>            <a href="../include/c.h.html#LN294"><span class='Ref_to_Typedef'>int64</span></a>       <span class='Declare_Local'>at</span> 
            <span class='Operator'>= </span><a href="localtime.c.html#LN222"><span class='Ref_To_Local'>stored</span></a> <span class='Operator'>== </span><span class='Number'>4</span> <span class='Operator'>? </span><a href="localtime.c.html#LN123"><span class='Ref_to_Func'>detzcode</span></a><span class='Parentheses'>(</span><a href="localtime.c.html#LN261"><span class='Ref_To_Local'>p</span></a><span class='Parentheses'>) </span><span class='Operator'>: </span><a href="localtime.c.html#LN149"><span class='Ref_to_Func'>detzcode64</span></a><span class='Parentheses'>(</span><a href="localtime.c.html#LN261"><span class='Ref_To_Local'>p</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <a href="localtime.c.html#LN217"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN49"><span class='Ref_to_Member'>types</span></a><span class='Delimiter'>[</span><a href="localtime.c.html#LN220"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="localtime.c.html#LN293"><span class='Ref_To_Local'>at</span></a> <span class='Operator'>&LT;= </span><a href="localtime.c.html#LN54"><span class='Ref_to_Global_Var'>time_t_max</span></a><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN217"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN49"><span class='Ref_to_Member'>types</span></a><span class='Delimiter'>[</span><a href="localtime.c.html#LN220"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span><a name="LN299"></a>                <a href="../include/pgtime.h.html#LN22"><span class='Ref_to_Typedef'>pg_time_t</span></a>   <span class='Declare_Local'>attime</span> 
                <span class='Operator'>= </span><span class='Parentheses'>((</span><a href="private.h.html#LN70"><span class='Ref_to_Macro'>TYPE_SIGNED</span></a><span class='Parentheses'>(</span><a href="../include/pgtime.h.html#LN22"><span class='Ref_to_Typedef'>pg_time_t</span></a><span class='Parentheses'>) </span><span class='Operator'>? </span><a href="localtime.c.html#LN293"><span class='Ref_To_Local'>at</span></a> <span class='Operator'>&LT; </span><a href="localtime.c.html#LN53"><span class='Ref_to_Global_Var'>time_t_min</span></a> <span class='Operator'>: </span><a href="localtime.c.html#LN293"><span class='Ref_To_Local'>at</span></a> <span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
                   <span class='Operator'>? </span><a href="localtime.c.html#LN53"><span class='Ref_to_Global_Var'>time_t_min</span></a> <span class='Operator'>: </span><a href="localtime.c.html#LN293"><span class='Ref_To_Local'>at</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN258"><span class='Ref_To_Local'>timecnt</span></a> <span class='Operator'>&& </span><a href="localtime.c.html#LN299"><span class='Ref_To_Local'>attime</span></a> <span class='Operator'>&LT;= </span><a href="localtime.c.html#LN217"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN48"><span class='Ref_to_Member'>ats</span></a><span class='Delimiter'>[</span><a href="localtime.c.html#LN258"><span class='Ref_To_Local'>timecnt</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>]</span><span class='Parentheses'>) 
</span>                <span class='Delimiter'>{ 
</span>                    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN299"><span class='Ref_To_Local'>attime</span></a> <span class='Operator'>&LT; </span><a href="localtime.c.html#LN217"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN48"><span class='Ref_to_Member'>ats</span></a><span class='Delimiter'>[</span><a href="localtime.c.html#LN258"><span class='Ref_To_Local'>timecnt</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>]</span><span class='Parentheses'>) 
</span>                        <span class='Control'>return</span> EINVAL<span class='Delimiter'>; 
</span>                    <a href="localtime.c.html#LN217"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN49"><span class='Ref_to_Member'>types</span></a><span class='Delimiter'>[</span><a href="localtime.c.html#LN220"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>                    <a href="localtime.c.html#LN258"><span class='Ref_To_Local'>timecnt</span></a><span class='Operator'>--</span><span class='Delimiter'>; 
</span>                <span class='Delimiter'>} 
</span>                <a href="localtime.c.html#LN217"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN48"><span class='Ref_to_Member'>ats</span></a><span class='Delimiter'>[</span><a href="localtime.c.html#LN258"><span class='Ref_To_Local'>timecnt</span></a><span class='Operator'>++</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="localtime.c.html#LN299"><span class='Ref_To_Local'>attime</span></a><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>            <a href="localtime.c.html#LN261"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>+= </span><a href="localtime.c.html#LN222"><span class='Ref_To_Local'>stored</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end for i=0;i&LT;sp-&GT;timecnt;++i &raquo; </span> 
 
        <a href="localtime.c.html#LN258"><span class='Ref_To_Local'>timecnt</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>        <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN220"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="localtime.c.html#LN220"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="localtime.c.html#LN217"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN43"><span class='Ref_to_Member'>timecnt</span></a><span class='Delimiter'>; </span><span class='Operator'>++</span><a href="localtime.c.html#LN220"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span><a name="LN318"></a>            <span class='Keyword'>unsigned char </span><span class='Declare_Local'>typ</span> <span class='Operator'>= *</span><a href="localtime.c.html#LN261"><span class='Ref_To_Local'>p</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN217"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN44"><span class='Ref_to_Member'>typecnt</span></a> <span class='Operator'>&LT;= </span><a href="localtime.c.html#LN318"><span class='Ref_To_Local'>typ</span></a><span class='Parentheses'>) 
</span>                <span class='Control'>return</span> EINVAL<span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN217"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN49"><span class='Ref_to_Member'>types</span></a><span class='Delimiter'>[</span><a href="localtime.c.html#LN220"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Parentheses'>) 
</span>                <a href="localtime.c.html#LN217"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN49"><span class='Ref_to_Member'>types</span></a><span class='Delimiter'>[</span><a href="localtime.c.html#LN258"><span class='Ref_To_Local'>timecnt</span></a><span class='Operator'>++</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="localtime.c.html#LN318"><span class='Ref_To_Local'>typ</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <a href="localtime.c.html#LN217"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN43"><span class='Ref_to_Member'>timecnt</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN258"><span class='Ref_To_Local'>timecnt</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN220"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="localtime.c.html#LN220"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="localtime.c.html#LN217"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN44"><span class='Ref_to_Member'>typecnt</span></a><span class='Delimiter'>; </span><span class='Operator'>++</span><a href="localtime.c.html#LN220"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span><a name="LN328"></a>            <span class='Control'>struct</span> <a href="pgtz.h.html#LN25"><span class='Ref_to_Struct'>ttinfo</span></a> <span class='Operator'>*</span><span class='Declare_Local'>ttisp</span><span class='Delimiter'>; 
</span><a name="LN329"></a>            <span class='Keyword'>unsigned char </span><span class='Declare_Local'>isdst</span><span class='Delimiter'>, 
</span><a name="LN330"></a>                        <span class='Declare_Local'>abbrind</span><span class='Delimiter'>; 
</span> 
            <a href="localtime.c.html#LN328"><span class='Ref_To_Local'>ttisp</span></a> <span class='Operator'>= &</span><a href="localtime.c.html#LN217"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN50"><span class='Ref_to_Member'>ttis</span></a><span class='Delimiter'>[</span><a href="localtime.c.html#LN220"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]; 
</span>            <a href="localtime.c.html#LN328"><span class='Ref_To_Local'>ttisp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN27"><span class='Ref_to_Member'>tt_gmtoff</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN123"><span class='Ref_to_Func'>detzcode</span></a><span class='Parentheses'>(</span><a href="localtime.c.html#LN261"><span class='Ref_To_Local'>p</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="localtime.c.html#LN261"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>+= </span><span class='Number'>4</span><span class='Delimiter'>; 
</span>            <a href="localtime.c.html#LN329"><span class='Ref_To_Local'>isdst</span></a> <span class='Operator'>= *</span><a href="localtime.c.html#LN261"><span class='Ref_To_Local'>p</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><span class='Parentheses'>(</span><a href="localtime.c.html#LN329"><span class='Ref_To_Local'>isdst</span></a> <span class='Operator'>&LT; </span><span class='Number'>2</span><span class='Parentheses'>))</span> 
                <span class='Control'>return</span> EINVAL<span class='Delimiter'>; 
</span>            <a href="localtime.c.html#LN328"><span class='Ref_To_Local'>ttisp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN28"><span class='Ref_to_Member'>tt_isdst</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN329"><span class='Ref_To_Local'>isdst</span></a><span class='Delimiter'>; 
</span>            <a href="localtime.c.html#LN330"><span class='Ref_To_Local'>abbrind</span></a> <span class='Operator'>= *</span><a href="localtime.c.html#LN261"><span class='Ref_To_Local'>p</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><span class='Parentheses'>(</span><a href="localtime.c.html#LN330"><span class='Ref_To_Local'>abbrind</span></a> <span class='Operator'>&LT; </span><a href="localtime.c.html#LN217"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN45"><span class='Ref_to_Member'>charcnt</span></a><span class='Parentheses'>))</span> 
                <span class='Control'>return</span> EINVAL<span class='Delimiter'>; 
</span>            <a href="localtime.c.html#LN328"><span class='Ref_To_Local'>ttisp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN29"><span class='Ref_to_Member'>tt_abbrind</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN330"><span class='Ref_To_Local'>abbrind</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN220"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="localtime.c.html#LN220"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="localtime.c.html#LN217"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN45"><span class='Ref_to_Member'>charcnt</span></a><span class='Delimiter'>; </span><span class='Operator'>++</span><a href="localtime.c.html#LN220"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>) 
</span>            <a href="localtime.c.html#LN217"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN51"><span class='Ref_to_Member'>chars</span></a><span class='Delimiter'>[</span><a href="localtime.c.html#LN220"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>] </span><span class='Operator'>= *</span><a href="localtime.c.html#LN261"><span class='Ref_To_Local'>p</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>        <a href="localtime.c.html#LN217"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN51"><span class='Ref_to_Member'>chars</span></a><span class='Delimiter'>[</span><a href="localtime.c.html#LN220"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='String'>'\0'</span><span class='Delimiter'>;</span>    <span class='Comment_Single_Line'>/* ensure '\0' at end */ 
</span> 
        <span class='Comment_Multi_Line'>/* Read leap seconds, discarding those out of pg_time_t range.  */ 
</span>        <a href="localtime.c.html#LN257"><span class='Ref_To_Local'>leapcnt</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>        <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN220"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="localtime.c.html#LN220"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="localtime.c.html#LN217"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN42"><span class='Ref_to_Member'>leapcnt</span></a><span class='Delimiter'>; </span><span class='Operator'>++</span><a href="localtime.c.html#LN220"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span><a name="LN352"></a>            <a href="../include/c.h.html#LN294"><span class='Ref_to_Typedef'>int64</span></a>       <span class='Declare_Local'>tr</span> <span class='Operator'>= </span><a href="localtime.c.html#LN222"><span class='Ref_To_Local'>stored</span></a> <span class='Operator'>== </span><span class='Number'>4</span> <span class='Operator'>? </span><a href="localtime.c.html#LN123"><span class='Ref_to_Func'>detzcode</span></a><span class='Parentheses'>(</span><a href="localtime.c.html#LN261"><span class='Ref_To_Local'>p</span></a><span class='Parentheses'>) </span><span class='Operator'>: </span><a href="localtime.c.html#LN149"><span class='Ref_to_Func'>detzcode64</span></a><span class='Parentheses'>(</span><a href="localtime.c.html#LN261"><span class='Ref_To_Local'>p</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN353"></a>            <a href="../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>       <span class='Declare_Local'>corr</span> <span class='Operator'>= </span><a href="localtime.c.html#LN123"><span class='Ref_to_Func'>detzcode</span></a><span class='Parentheses'>(</span><a href="localtime.c.html#LN261"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>+ </span><a href="localtime.c.html#LN222"><span class='Ref_To_Local'>stored</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <a href="localtime.c.html#LN261"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>+= </span><a href="localtime.c.html#LN222"><span class='Ref_To_Local'>stored</span></a> <span class='Operator'>+ </span><span class='Number'>4</span><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN352"><span class='Ref_To_Local'>tr</span></a> <span class='Operator'>&LT;= </span><a href="localtime.c.html#LN54"><span class='Ref_to_Global_Var'>time_t_max</span></a><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span><a name="LN358"></a>                <a href="../include/pgtime.h.html#LN22"><span class='Ref_to_Typedef'>pg_time_t</span></a>   <span class='Declare_Local'>trans</span> 
                <span class='Operator'>= </span><span class='Parentheses'>((</span><a href="private.h.html#LN70"><span class='Ref_to_Macro'>TYPE_SIGNED</span></a><span class='Parentheses'>(</span><a href="../include/pgtime.h.html#LN22"><span class='Ref_to_Typedef'>pg_time_t</span></a><span class='Parentheses'>) </span><span class='Operator'>? </span><a href="localtime.c.html#LN352"><span class='Ref_To_Local'>tr</span></a> <span class='Operator'>&LT; </span><a href="localtime.c.html#LN53"><span class='Ref_to_Global_Var'>time_t_min</span></a> <span class='Operator'>: </span><a href="localtime.c.html#LN352"><span class='Ref_To_Local'>tr</span></a> <span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
                   <span class='Operator'>? </span><a href="localtime.c.html#LN53"><span class='Ref_to_Global_Var'>time_t_min</span></a> <span class='Operator'>: </span><a href="localtime.c.html#LN352"><span class='Ref_To_Local'>tr</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN257"><span class='Ref_To_Local'>leapcnt</span></a> <span class='Operator'>&& </span><a href="localtime.c.html#LN358"><span class='Ref_To_Local'>trans</span></a> <span class='Operator'>&LT;= </span><a href="localtime.c.html#LN217"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN53"><span class='Ref_to_Member'>lsis</span></a><span class='Delimiter'>[</span><a href="localtime.c.html#LN257"><span class='Ref_To_Local'>leapcnt</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="pgtz.h.html#LN36"><span class='Ref_to_Member'>ls_trans</span></a><span class='Parentheses'>) 
</span>                <span class='Delimiter'>{ 
</span>                    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN358"><span class='Ref_To_Local'>trans</span></a> <span class='Operator'>&LT; </span><a href="localtime.c.html#LN217"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN53"><span class='Ref_to_Member'>lsis</span></a><span class='Delimiter'>[</span><a href="localtime.c.html#LN257"><span class='Ref_To_Local'>leapcnt</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="pgtz.h.html#LN36"><span class='Ref_to_Member'>ls_trans</span></a><span class='Parentheses'>) 
</span>                        <span class='Control'>return</span> EINVAL<span class='Delimiter'>; 
</span>                    <a href="localtime.c.html#LN257"><span class='Ref_To_Local'>leapcnt</span></a><span class='Operator'>--</span><span class='Delimiter'>; 
</span>                <span class='Delimiter'>} 
</span>                <a href="localtime.c.html#LN217"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN53"><span class='Ref_to_Member'>lsis</span></a><span class='Delimiter'>[</span><a href="localtime.c.html#LN257"><span class='Ref_To_Local'>leapcnt</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="pgtz.h.html#LN36"><span class='Ref_to_Member'>ls_trans</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN358"><span class='Ref_To_Local'>trans</span></a><span class='Delimiter'>; 
</span>                <a href="localtime.c.html#LN217"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN53"><span class='Ref_to_Member'>lsis</span></a><span class='Delimiter'>[</span><a href="localtime.c.html#LN257"><span class='Ref_To_Local'>leapcnt</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="pgtz.h.html#LN37"><span class='Ref_to_Member'>ls_corr</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN353"><span class='Ref_To_Local'>corr</span></a><span class='Delimiter'>; 
</span>                <a href="localtime.c.html#LN257"><span class='Ref_To_Local'>leapcnt</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>        <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end for i=0;i&LT;sp-&GT;leapcnt;++i &raquo; </span> 
        <a href="localtime.c.html#LN217"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN42"><span class='Ref_to_Member'>leapcnt</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN257"><span class='Ref_To_Local'>leapcnt</span></a><span class='Delimiter'>; 
</span> 
        <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN220"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="localtime.c.html#LN220"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="localtime.c.html#LN217"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN44"><span class='Ref_to_Member'>typecnt</span></a><span class='Delimiter'>; </span><span class='Operator'>++</span><a href="localtime.c.html#LN220"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span><a name="LN377"></a>            <span class='Control'>struct</span> <a href="pgtz.h.html#LN25"><span class='Ref_to_Struct'>ttinfo</span></a> <span class='Operator'>*</span><span class='Declare_Local'>ttisp</span><span class='Delimiter'>; 
</span> 
            <a href="localtime.c.html#LN377"><span class='Ref_To_Local'>ttisp</span></a> <span class='Operator'>= &</span><a href="localtime.c.html#LN217"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN50"><span class='Ref_to_Member'>ttis</span></a><span class='Delimiter'>[</span><a href="localtime.c.html#LN220"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN255"><span class='Ref_To_Local'>ttisstdcnt</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>                <a href="localtime.c.html#LN377"><span class='Ref_To_Local'>ttisp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN30"><span class='Ref_to_Member'>tt_ttisstd</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>            <span class='Control'>else</span> 
            <span class='Delimiter'>{ 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="localtime.c.html#LN261"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>!= </span><span class='Boolean'>true </span><span class='Operator'>&& *</span><a href="localtime.c.html#LN261"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>!= </span><span class='Boolean'>false</span><span class='Parentheses'>) 
</span>                    <span class='Control'>return</span> EINVAL<span class='Delimiter'>; 
</span>                <a href="localtime.c.html#LN377"><span class='Ref_To_Local'>ttisp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN30"><span class='Ref_to_Member'>tt_ttisstd</span></a> <span class='Operator'>= *</span><a href="localtime.c.html#LN261"><span class='Ref_To_Local'>p</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN220"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="localtime.c.html#LN220"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="localtime.c.html#LN217"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN44"><span class='Ref_to_Member'>typecnt</span></a><span class='Delimiter'>; </span><span class='Operator'>++</span><a href="localtime.c.html#LN220"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span><a name="LN391"></a>            <span class='Control'>struct</span> <a href="pgtz.h.html#LN25"><span class='Ref_to_Struct'>ttinfo</span></a> <span class='Operator'>*</span><span class='Declare_Local'>ttisp</span><span class='Delimiter'>; 
</span> 
            <a href="localtime.c.html#LN391"><span class='Ref_To_Local'>ttisp</span></a> <span class='Operator'>= &</span><a href="localtime.c.html#LN217"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN50"><span class='Ref_to_Member'>ttis</span></a><span class='Delimiter'>[</span><a href="localtime.c.html#LN220"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN256"><span class='Ref_To_Local'>ttisgmtcnt</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>                <a href="localtime.c.html#LN391"><span class='Ref_To_Local'>ttisp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN31"><span class='Ref_to_Member'>tt_ttisgmt</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>            <span class='Control'>else</span> 
            <span class='Delimiter'>{ 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="localtime.c.html#LN261"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>!= </span><span class='Boolean'>true </span><span class='Operator'>&& *</span><a href="localtime.c.html#LN261"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>!= </span><span class='Boolean'>false</span><span class='Parentheses'>) 
</span>                    <span class='Control'>return</span> EINVAL<span class='Delimiter'>; 
</span>                <a href="localtime.c.html#LN391"><span class='Ref_To_Local'>ttisp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN31"><span class='Ref_to_Member'>tt_ttisgmt</span></a> <span class='Operator'>= *</span><a href="localtime.c.html#LN261"><span class='Ref_To_Local'>p</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>        <span class='Delimiter'>} 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * If this is an old file, we're done. 
         */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN224"><span class='Ref_To_Local'>up</span></a><span class='Operator'>-&GT;</span><a href="localtime.c.html#LN187"><span class='Ref_to_Member'>tzhead</span></a><span class='Operator'>.</span><a href="tzfile.h.html#LN35"><span class='Ref_to_Member'>tzh_version</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>] </span><span class='Operator'>== </span><span class='String'>'\0'</span><span class='Parentheses'>) 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <a href="localtime.c.html#LN223"><span class='Ref_To_Local'>nread</span></a> <span class='Operator'>-= </span><a href="localtime.c.html#LN261"><span class='Ref_To_Local'>p</span></a> <span class='Operator'>- </span><a href="localtime.c.html#LN224"><span class='Ref_To_Local'>up</span></a><span class='Operator'>-&GT;</span><a href="localtime.c.html#LN190"><span class='Ref_to_Member'>buf</span></a><span class='Delimiter'>; 
</span>        <a href="../include/c.h.html#LN1057"><span class='Ref_to_Macro'>memmove</span></a><span class='Parentheses'>(</span><a href="localtime.c.html#LN224"><span class='Ref_To_Local'>up</span></a><span class='Operator'>-&GT;</span><a href="localtime.c.html#LN190"><span class='Ref_to_Member'>buf</span></a><span class='Delimiter'>, </span><a href="localtime.c.html#LN261"><span class='Ref_To_Local'>p</span></a><span class='Delimiter'>, </span><a href="localtime.c.html#LN223"><span class='Ref_To_Local'>nread</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end for stored=4;stored&LT;=8;st... &raquo; </span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN217"><span class='Ref_to_Parameter'>doextend</span></a> <span class='Operator'>&& </span><a href="localtime.c.html#LN223"><span class='Ref_To_Local'>nread</span></a> <span class='Operator'>&GT; </span><span class='Number'>2</span> <span class='Operator'>&& 
</span>        <a href="localtime.c.html#LN224"><span class='Ref_To_Local'>up</span></a><span class='Operator'>-&GT;</span><a href="localtime.c.html#LN190"><span class='Ref_to_Member'>buf</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>] </span><span class='Operator'>== </span><span class='String'>'\n'</span> <span class='Operator'>&& </span><a href="localtime.c.html#LN224"><span class='Ref_To_Local'>up</span></a><span class='Operator'>-&GT;</span><a href="localtime.c.html#LN190"><span class='Ref_to_Member'>buf</span></a><span class='Delimiter'>[</span><a href="localtime.c.html#LN223"><span class='Ref_To_Local'>nread</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>== </span><span class='String'>'\n'</span> <span class='Operator'>&& 
</span>        <a href="localtime.c.html#LN217"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN44"><span class='Ref_to_Member'>typecnt</span></a> <span class='Operator'>+ </span><span class='Number'>2</span> <span class='Operator'>&LT;= </span><a href="tzfile.h.html#LN95"><span class='Ref_to_Const'>TZ_MAX_TYPES</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span><a name="LN416"></a>        <span class='Control'>struct</span> <a href="pgtz.h.html#LN40"><span class='Ref_to_Struct'>state</span></a> <span class='Operator'>*</span><span class='Declare_Local'>ts</span> <span class='Operator'>= &</span><a href="localtime.c.html#LN218"><span class='Ref_to_Parameter'>lsp</span></a><span class='Operator'>-&GT;</span><a href="localtime.c.html#LN207"><span class='Ref_to_Member'>u</span></a><span class='Operator'>.</span><a href="localtime.c.html#LN206"><span class='Ref_to_Member'>st</span></a><span class='Delimiter'>; 
</span> 
        <a href="localtime.c.html#LN224"><span class='Ref_To_Local'>up</span></a><span class='Operator'>-&GT;</span><a href="localtime.c.html#LN190"><span class='Ref_to_Member'>buf</span></a><span class='Delimiter'>[</span><a href="localtime.c.html#LN223"><span class='Ref_To_Local'>nread</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='String'>'\0'</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="pgtz.h.html#LN72"><span class='Ref_to_Proto'>tzparse</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="localtime.c.html#LN224"><span class='Ref_To_Local'>up</span></a><span class='Operator'>-&GT;</span><a href="localtime.c.html#LN190"><span class='Ref_to_Member'>buf</span></a><span class='Delimiter'>[</span><span class='Number'>1</span><span class='Delimiter'>], </span><a href="localtime.c.html#LN416"><span class='Ref_To_Local'>ts</span></a><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Parentheses'>) 
</span>            <span class='Operator'>&& </span><a href="localtime.c.html#LN416"><span class='Ref_To_Local'>ts</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN44"><span class='Ref_to_Member'>typecnt</span></a> <span class='Operator'>== </span><span class='Number'>2</span><span class='Parentheses'>)</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Comment_Multi_Line'>/* 
             * Attempt to reuse existing abbreviations. Without this, 
             * America/Anchorage would be right on the edge after 2037 when 
             * TZ_MAX_CHARS is 50, as sp-&GT;charcnt equals 40 (for LMT AST AWT 
             * APT AHST AHDT YST AKDT AKST) and ts-&GT;charcnt equals 10 (for 
             * AKST AKDT).  Reusing means sp-&GT;charcnt can stay 40 in this 
             * example. 
             */ 
</span><a name="LN430"></a>            <span class='Keyword'>int</span>         <span class='Declare_Local'>gotabbr</span> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span><a name="LN431"></a>            <span class='Keyword'>int</span>         <span class='Declare_Local'>charcnt</span> <span class='Operator'>= </span><a href="localtime.c.html#LN217"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN45"><span class='Ref_to_Member'>charcnt</span></a><span class='Delimiter'>; 
</span> 
            <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN220"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="localtime.c.html#LN220"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><span class='Number'>2</span><span class='Delimiter'>; </span><a href="localtime.c.html#LN220"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span><a name="LN435"></a>                <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>tsabbr</span> <span class='Operator'>= </span><a href="localtime.c.html#LN416"><span class='Ref_To_Local'>ts</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN51"><span class='Ref_to_Member'>chars</span></a> <span class='Operator'>+ </span><a href="localtime.c.html#LN416"><span class='Ref_To_Local'>ts</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN50"><span class='Ref_to_Member'>ttis</span></a><span class='Delimiter'>[</span><a href="localtime.c.html#LN220"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="pgtz.h.html#LN29"><span class='Ref_to_Member'>tt_abbrind</span></a><span class='Delimiter'>; 
</span><a name="LN436"></a>                <span class='Keyword'>int</span>         <span class='Declare_Local'>j</span><span class='Delimiter'>; 
</span> 
                <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN436"><span class='Ref_To_Local'>j</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="localtime.c.html#LN436"><span class='Ref_To_Local'>j</span></a> <span class='Operator'>&LT; </span><a href="localtime.c.html#LN431"><span class='Ref_To_Local'>charcnt</span></a><span class='Delimiter'>; </span><a href="localtime.c.html#LN436"><span class='Ref_To_Local'>j</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>                    <span class='Control'>if</span> <span class='Parentheses'>(</span>strcmp<span class='Parentheses'>(</span><a href="localtime.c.html#LN217"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN51"><span class='Ref_to_Member'>chars</span></a> <span class='Operator'>+ </span><a href="localtime.c.html#LN436"><span class='Ref_To_Local'>j</span></a><span class='Delimiter'>, </span><a href="localtime.c.html#LN435"><span class='Ref_To_Local'>tsabbr</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
                    <span class='Delimiter'>{ 
</span>                        <a href="localtime.c.html#LN416"><span class='Ref_To_Local'>ts</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN50"><span class='Ref_to_Member'>ttis</span></a><span class='Delimiter'>[</span><a href="localtime.c.html#LN220"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="pgtz.h.html#LN29"><span class='Ref_to_Member'>tt_abbrind</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN436"><span class='Ref_To_Local'>j</span></a><span class='Delimiter'>; 
</span>                        <a href="localtime.c.html#LN430"><span class='Ref_To_Local'>gotabbr</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>                        <span class='Control'>break</span><span class='Delimiter'>; 
</span>                    <span class='Delimiter'>} 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><span class='Parentheses'>(</span><a href="localtime.c.html#LN436"><span class='Ref_To_Local'>j</span></a> <span class='Operator'>&LT; </span><a href="localtime.c.html#LN431"><span class='Ref_To_Local'>charcnt</span></a><span class='Parentheses'>))</span> 
                <span class='Delimiter'>{ 
</span><a name="LN447"></a>                    <span class='Keyword'>int</span>         <span class='Declare_Local'>tsabbrlen</span> <span class='Operator'>= </span>strlen<span class='Parentheses'>(</span><a href="localtime.c.html#LN435"><span class='Ref_To_Local'>tsabbr</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
                    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN436"><span class='Ref_To_Local'>j</span></a> <span class='Operator'>+ </span><a href="localtime.c.html#LN447"><span class='Ref_To_Local'>tsabbrlen</span></a> <span class='Operator'>&LT; </span><a href="tzfile.h.html#LN97"><span class='Ref_to_Const'>TZ_MAX_CHARS</span></a><span class='Parentheses'>) 
</span>                    <span class='Delimiter'>{ 
</span>                        <a href="../../contrib/cube/cubeparse.y.html#LN150"><span class='Ref_to_Proto'>strcpy</span></a><span class='Parentheses'>(</span><a href="localtime.c.html#LN217"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN51"><span class='Ref_to_Member'>chars</span></a> <span class='Operator'>+ </span><a href="localtime.c.html#LN436"><span class='Ref_To_Local'>j</span></a><span class='Delimiter'>, </span><a href="localtime.c.html#LN435"><span class='Ref_To_Local'>tsabbr</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                        <a href="localtime.c.html#LN431"><span class='Ref_To_Local'>charcnt</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN436"><span class='Ref_To_Local'>j</span></a> <span class='Operator'>+ </span><a href="localtime.c.html#LN447"><span class='Ref_To_Local'>tsabbrlen</span></a> <span class='Operator'>+ </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>                        <a href="localtime.c.html#LN416"><span class='Ref_To_Local'>ts</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN50"><span class='Ref_to_Member'>ttis</span></a><span class='Delimiter'>[</span><a href="localtime.c.html#LN220"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="pgtz.h.html#LN29"><span class='Ref_to_Member'>tt_abbrind</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN436"><span class='Ref_To_Local'>j</span></a><span class='Delimiter'>; 
</span>                        <a href="localtime.c.html#LN430"><span class='Ref_To_Local'>gotabbr</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>                    <span class='Delimiter'>} 
</span>                <span class='Delimiter'>} 
</span>            <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end for i=0;i&LT;2;i++ &raquo; </span> 
            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN430"><span class='Ref_To_Local'>gotabbr</span></a> <span class='Operator'>== </span><span class='Number'>2</span><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <a href="localtime.c.html#LN217"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN45"><span class='Ref_to_Member'>charcnt</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN431"><span class='Ref_To_Local'>charcnt</span></a><span class='Delimiter'>; 
</span> 
                <span class='Comment_Multi_Line'>/* 
                 * Ignore any trailing, no-op transitions generated by zic as 
                 * they don't help here and can run afoul of bugs in zic 2016j 
                 * or earlier. 
                 */ 
</span>                <span class='Control'>while</span> <span class='Parentheses'>(</span><span class='Number'>1</span> <span class='Operator'>&LT; </span><a href="localtime.c.html#LN217"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN43"><span class='Ref_to_Member'>timecnt</span></a> 
                       <span class='Operator'>&& </span><span class='Parentheses'>(</span><a href="localtime.c.html#LN217"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN49"><span class='Ref_to_Member'>types</span></a><span class='Delimiter'>[</span><a href="localtime.c.html#LN217"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN43"><span class='Ref_to_Member'>timecnt</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>] 
</span>                           <span class='Operator'>== </span><a href="localtime.c.html#LN217"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN49"><span class='Ref_to_Member'>types</span></a><span class='Delimiter'>[</span><a href="localtime.c.html#LN217"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN43"><span class='Ref_to_Member'>timecnt</span></a> <span class='Operator'>- </span><span class='Number'>2</span><span class='Delimiter'>]</span><span class='Parentheses'>))</span> 
                    <a href="localtime.c.html#LN217"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN43"><span class='Ref_to_Member'>timecnt</span></a><span class='Operator'>--</span><span class='Delimiter'>; 
</span> 
                <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN220"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="localtime.c.html#LN220"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="localtime.c.html#LN416"><span class='Ref_To_Local'>ts</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN43"><span class='Ref_to_Member'>timecnt</span></a><span class='Delimiter'>; </span><a href="localtime.c.html#LN220"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>                    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN217"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN48"><span class='Ref_to_Member'>ats</span></a><span class='Delimiter'>[</span><a href="localtime.c.html#LN217"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN43"><span class='Ref_to_Member'>timecnt</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>] </span><span class='Operator'>&LT; </span><a href="localtime.c.html#LN416"><span class='Ref_To_Local'>ts</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN48"><span class='Ref_to_Member'>ats</span></a><span class='Delimiter'>[</span><a href="localtime.c.html#LN220"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Parentheses'>) 
</span>                        <span class='Control'>break</span><span class='Delimiter'>; 
</span>                <span class='Control'>while</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN220"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="localtime.c.html#LN416"><span class='Ref_To_Local'>ts</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN43"><span class='Ref_to_Member'>timecnt</span></a> 
                       <span class='Operator'>&& </span><a href="localtime.c.html#LN217"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN43"><span class='Ref_to_Member'>timecnt</span></a> <span class='Operator'>&LT; </span><a href="tzfile.h.html#LN92"><span class='Ref_to_Const'>TZ_MAX_TIMES</span></a><span class='Parentheses'>) 
</span>                <span class='Delimiter'>{ 
</span>                    <a href="localtime.c.html#LN217"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN48"><span class='Ref_to_Member'>ats</span></a><span class='Delimiter'>[</span><a href="localtime.c.html#LN217"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN43"><span class='Ref_to_Member'>timecnt</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="localtime.c.html#LN416"><span class='Ref_To_Local'>ts</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN48"><span class='Ref_to_Member'>ats</span></a><span class='Delimiter'>[</span><a href="localtime.c.html#LN220"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]; 
</span>                    <a href="localtime.c.html#LN217"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN49"><span class='Ref_to_Member'>types</span></a><span class='Delimiter'>[</span><a href="localtime.c.html#LN217"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN43"><span class='Ref_to_Member'>timecnt</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Parentheses'>(</span><a href="localtime.c.html#LN217"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN44"><span class='Ref_to_Member'>typecnt</span></a> 
                                              <span class='Operator'>+ </span><a href="localtime.c.html#LN416"><span class='Ref_To_Local'>ts</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN49"><span class='Ref_to_Member'>types</span></a><span class='Delimiter'>[</span><a href="localtime.c.html#LN220"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                    <a href="localtime.c.html#LN217"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN43"><span class='Ref_to_Member'>timecnt</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>                    <a href="localtime.c.html#LN220"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>                <span class='Delimiter'>} 
</span>                <a href="localtime.c.html#LN217"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN50"><span class='Ref_to_Member'>ttis</span></a><span class='Delimiter'>[</span><a href="localtime.c.html#LN217"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN44"><span class='Ref_to_Member'>typecnt</span></a><span class='Operator'>++</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="localtime.c.html#LN416"><span class='Ref_To_Local'>ts</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN50"><span class='Ref_to_Member'>ttis</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>]; 
</span>                <a href="localtime.c.html#LN217"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN50"><span class='Ref_to_Member'>ttis</span></a><span class='Delimiter'>[</span><a href="localtime.c.html#LN217"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN44"><span class='Ref_to_Member'>typecnt</span></a><span class='Operator'>++</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="localtime.c.html#LN416"><span class='Ref_To_Local'>ts</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN50"><span class='Ref_to_Member'>ttis</span></a><span class='Delimiter'>[</span><span class='Number'>1</span><span class='Delimiter'>]; 
</span>            <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if gotabbr==2 &raquo; </span> 
        <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if tzparse(&up-&GT;buf[1],t... &raquo; </span> 
    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if doextend&&nread&GT;2&&up... &raquo; </span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN217"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN43"><span class='Ref_to_Member'>timecnt</span></a> <span class='Operator'>&GT; </span><span class='Number'>1</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN220"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>; </span><a href="localtime.c.html#LN220"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="localtime.c.html#LN217"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN43"><span class='Ref_to_Member'>timecnt</span></a><span class='Delimiter'>; </span><span class='Operator'>++</span><a href="localtime.c.html#LN220"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>) 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN99"><span class='Ref_to_Proto'>typesequiv</span></a><span class='Parentheses'>(</span><a href="localtime.c.html#LN217"><span class='Ref_to_Parameter'>sp</span></a><span class='Delimiter'>, </span><a href="localtime.c.html#LN217"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN49"><span class='Ref_to_Member'>types</span></a><span class='Delimiter'>[</span><a href="localtime.c.html#LN220"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>], </span><a href="localtime.c.html#LN217"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN49"><span class='Ref_to_Member'>types</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>]</span><span class='Parentheses'>) </span><span class='Operator'>&& 
</span>                <a href="localtime.c.html#LN175"><span class='Ref_to_Func'>differ_by_repeat</span></a><span class='Parentheses'>(</span><a href="localtime.c.html#LN217"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN48"><span class='Ref_to_Member'>ats</span></a><span class='Delimiter'>[</span><a href="localtime.c.html#LN220"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>], </span><a href="localtime.c.html#LN217"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN48"><span class='Ref_to_Member'>ats</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>]</span><span class='Parentheses'>))</span> 
            <span class='Delimiter'>{ 
</span>                <a href="localtime.c.html#LN217"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN46"><span class='Ref_to_Member'>goback</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>        <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN220"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN217"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN43"><span class='Ref_to_Member'>timecnt</span></a> <span class='Operator'>- </span><span class='Number'>2</span><span class='Delimiter'>; </span><a href="localtime.c.html#LN220"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&GT;= </span><span class='Number'>0</span><span class='Delimiter'>; </span><span class='Operator'>--</span><a href="localtime.c.html#LN220"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>) 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN99"><span class='Ref_to_Proto'>typesequiv</span></a><span class='Parentheses'>(</span><a href="localtime.c.html#LN217"><span class='Ref_to_Parameter'>sp</span></a><span class='Delimiter'>, </span><a href="localtime.c.html#LN217"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN49"><span class='Ref_to_Member'>types</span></a><span class='Delimiter'>[</span><a href="localtime.c.html#LN217"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN43"><span class='Ref_to_Member'>timecnt</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>], 
</span>                           <a href="localtime.c.html#LN217"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN49"><span class='Ref_to_Member'>types</span></a><span class='Delimiter'>[</span><a href="localtime.c.html#LN220"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Parentheses'>) </span><span class='Operator'>&& 
</span>                <a href="localtime.c.html#LN175"><span class='Ref_to_Func'>differ_by_repeat</span></a><span class='Parentheses'>(</span><a href="localtime.c.html#LN217"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN48"><span class='Ref_to_Member'>ats</span></a><span class='Delimiter'>[</span><a href="localtime.c.html#LN217"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN43"><span class='Ref_to_Member'>timecnt</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>], 
</span>                                 <a href="localtime.c.html#LN217"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN48"><span class='Ref_to_Member'>ats</span></a><span class='Delimiter'>[</span><a href="localtime.c.html#LN220"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Parentheses'>))</span> 
            <span class='Delimiter'>{ 
</span>                <a href="localtime.c.html#LN217"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN47"><span class='Ref_to_Member'>goahead</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * If type 0 is unused in transitions, it's the type to use for early 
     * times. 
     */ 
</span>    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN220"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="localtime.c.html#LN220"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="localtime.c.html#LN217"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN43"><span class='Ref_to_Member'>timecnt</span></a><span class='Delimiter'>; </span><span class='Operator'>++</span><a href="localtime.c.html#LN220"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>) 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN217"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN49"><span class='Ref_to_Member'>types</span></a><span class='Delimiter'>[</span><a href="localtime.c.html#LN220"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>] </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>    <a href="localtime.c.html#LN220"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN220"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="localtime.c.html#LN217"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN43"><span class='Ref_to_Member'>timecnt</span></a> <span class='Operator'>? -</span><span class='Number'>1</span> <span class='Operator'>: </span><span class='Number'>0</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Absent the above, if there are transition times and the first 
     * transition is to a daylight time find the standard type less than and 
     * closest to the type of the first transition. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN220"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><span class='Number'>0</span> <span class='Operator'>&& </span><a href="localtime.c.html#LN217"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN43"><span class='Ref_to_Member'>timecnt</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span> <span class='Operator'>&& </span><a href="localtime.c.html#LN217"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN50"><span class='Ref_to_Member'>ttis</span></a><span class='Delimiter'>[</span><a href="localtime.c.html#LN217"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN49"><span class='Ref_to_Member'>types</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>]]</span><span class='Operator'>.</span><a href="pgtz.h.html#LN28"><span class='Ref_to_Member'>tt_isdst</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="localtime.c.html#LN220"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN217"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN49"><span class='Ref_to_Member'>types</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>]; 
</span>        <span class='Control'>while</span> <span class='Parentheses'>(</span><span class='Operator'>--</span><a href="localtime.c.html#LN220"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&GT;= </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="localtime.c.html#LN217"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN50"><span class='Ref_to_Member'>ttis</span></a><span class='Delimiter'>[</span><a href="localtime.c.html#LN220"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="pgtz.h.html#LN28"><span class='Ref_to_Member'>tt_isdst</span></a><span class='Parentheses'>) 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * If no result yet, find the first standard type. If there is none, punt 
     * to type zero. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN220"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="localtime.c.html#LN220"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>        <span class='Control'>while</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN217"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN50"><span class='Ref_to_Member'>ttis</span></a><span class='Delimiter'>[</span><a href="localtime.c.html#LN220"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="pgtz.h.html#LN28"><span class='Ref_to_Member'>tt_isdst</span></a><span class='Parentheses'>) 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>++</span><a href="localtime.c.html#LN220"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&GT;= </span><a href="localtime.c.html#LN217"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN44"><span class='Ref_to_Member'>typecnt</span></a><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <a href="localtime.c.html#LN220"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>    <span class='Delimiter'>} 
</span>    <a href="localtime.c.html#LN217"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN54"><span class='Ref_to_Member'>defaulttype</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN220"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <span class='Number'>0</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end tzloadbody &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* Load tz data from the file named NAME into *SP.  Read extended 
 * format if DOEXTEND.  Return 0 on success, an errno value on failure. 
 * PG: If "canonname" is not NULL, then on success the canonical spelling of 
 * given name is stored there (the buffer must be &GT; TZ_STRLEN_MAX bytes!). 
 */ 
</span><span class='Keyword'>int 
</span><a name="LN555"></a><span class='Declare_Function'>tzload</span><span class='Parentheses'>(</span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>name</span><span class='Delimiter'>, </span><span class='Keyword'>char </span><span class='Operator'>*</span><span class='Declare_Parameter'>canonname</span><span class='Delimiter'>, </span><span class='Control'>struct</span> <a href="pgtz.h.html#LN40"><span class='Ref_to_Struct'>state</span></a> <span class='Operator'>* </span><span class='Declare_Parameter'>sp</span><span class='Delimiter'>, </span><span class='Keyword'>bool </span><span class='Declare_Parameter'>doextend</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN557"></a>    <span class='Control'>union</span> <a href="localtime.c.html#LN195"><span class='Ref_to_Union'>local_storage</span></a> <span class='Operator'>*</span><span class='Declare_Local'>lsp</span> <span class='Operator'>= </span><a href="../include/snowball/header.h.html#LN49"><span class='Ref_to_Macro'>malloc</span></a><span class='Parentheses'>(</span><span class='Keyword'>sizeof </span><span class='Operator'>*</span><a href="localtime.c.html#LN557"><span class='Ref_To_Local'>lsp</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="localtime.c.html#LN557"><span class='Ref_To_Local'>lsp</span></a><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> errno<span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span><a name="LN563"></a>        <span class='Keyword'>int</span>         <span class='Declare_Local'>err</span> <span class='Operator'>= </span><a href="localtime.c.html#LN216"><span class='Ref_to_Func'>tzloadbody</span></a><span class='Parentheses'>(</span><a href="localtime.c.html#LN555"><span class='Ref_to_Parameter'>name</span></a><span class='Delimiter'>, </span><a href="localtime.c.html#LN555"><span class='Ref_to_Parameter'>canonname</span></a><span class='Delimiter'>, </span><a href="localtime.c.html#LN555"><span class='Ref_to_Parameter'>sp</span></a><span class='Delimiter'>, </span><a href="localtime.c.html#LN555"><span class='Ref_to_Parameter'>doextend</span></a><span class='Delimiter'>, </span><a href="localtime.c.html#LN557"><span class='Ref_To_Local'>lsp</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <a href="../include/snowball/header.h.html#LN64"><span class='Ref_to_Macro'>free</span></a><span class='Parentheses'>(</span><a href="localtime.c.html#LN557"><span class='Ref_To_Local'>lsp</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <a href="localtime.c.html#LN563"><span class='Ref_To_Local'>err</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
} 
</span> 
<span class='Keyword'>static bool 
</span><a name="LN571"></a><span class='Declare_Function'>typesequiv</span><span class='Parentheses'>(</span><span class='Keyword'>const </span><span class='Control'>struct</span> <a href="pgtz.h.html#LN40"><span class='Ref_to_Struct'>state</span></a> <span class='Operator'>* </span><span class='Declare_Parameter'>sp</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>a</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>b</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN573"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN571"><span class='Ref_to_Parameter'>sp</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL </span><span class='Operator'>|| 
</span>        <a href="localtime.c.html#LN571"><span class='Ref_to_Parameter'>a</span></a> <span class='Operator'>&LT; </span><span class='Number'>0</span> <span class='Operator'>|| </span><a href="localtime.c.html#LN571"><span class='Ref_to_Parameter'>a</span></a> <span class='Operator'>&GT;= </span><a href="localtime.c.html#LN571"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN44"><span class='Ref_to_Member'>typecnt</span></a> <span class='Operator'>|| 
</span>        <a href="localtime.c.html#LN571"><span class='Ref_to_Parameter'>b</span></a> <span class='Operator'>&LT; </span><span class='Number'>0</span> <span class='Operator'>|| </span><a href="localtime.c.html#LN571"><span class='Ref_to_Parameter'>b</span></a> <span class='Operator'>&GT;= </span><a href="localtime.c.html#LN571"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN44"><span class='Ref_to_Member'>typecnt</span></a><span class='Parentheses'>) 
</span>        <a href="localtime.c.html#LN573"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span><a name="LN581"></a>        <span class='Keyword'>const </span><span class='Control'>struct</span> <a href="pgtz.h.html#LN25"><span class='Ref_to_Struct'>ttinfo</span></a> <span class='Operator'>*</span><span class='Declare_Local'>ap</span> <span class='Operator'>= &</span><a href="localtime.c.html#LN571"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN50"><span class='Ref_to_Member'>ttis</span></a><span class='Delimiter'>[</span><a href="localtime.c.html#LN571"><span class='Ref_to_Parameter'>a</span></a><span class='Delimiter'>]; 
</span><a name="LN582"></a>        <span class='Keyword'>const </span><span class='Control'>struct</span> <a href="pgtz.h.html#LN25"><span class='Ref_to_Struct'>ttinfo</span></a> <span class='Operator'>*</span><span class='Declare_Local'>bp</span> <span class='Operator'>= &</span><a href="localtime.c.html#LN571"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN50"><span class='Ref_to_Member'>ttis</span></a><span class='Delimiter'>[</span><a href="localtime.c.html#LN571"><span class='Ref_to_Parameter'>b</span></a><span class='Delimiter'>]; 
</span> 
        <a href="localtime.c.html#LN573"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN581"><span class='Ref_To_Local'>ap</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN27"><span class='Ref_to_Member'>tt_gmtoff</span></a> <span class='Operator'>== </span><a href="localtime.c.html#LN582"><span class='Ref_To_Local'>bp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN27"><span class='Ref_to_Member'>tt_gmtoff</span></a> <span class='Operator'>&& 
</span>            <a href="localtime.c.html#LN581"><span class='Ref_To_Local'>ap</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN28"><span class='Ref_to_Member'>tt_isdst</span></a> <span class='Operator'>== </span><a href="localtime.c.html#LN582"><span class='Ref_To_Local'>bp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN28"><span class='Ref_to_Member'>tt_isdst</span></a> <span class='Operator'>&& 
</span>            <a href="localtime.c.html#LN581"><span class='Ref_To_Local'>ap</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN30"><span class='Ref_to_Member'>tt_ttisstd</span></a> <span class='Operator'>== </span><a href="localtime.c.html#LN582"><span class='Ref_To_Local'>bp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN30"><span class='Ref_to_Member'>tt_ttisstd</span></a> <span class='Operator'>&& 
</span>            <a href="localtime.c.html#LN581"><span class='Ref_To_Local'>ap</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN31"><span class='Ref_to_Member'>tt_ttisgmt</span></a> <span class='Operator'>== </span><a href="localtime.c.html#LN582"><span class='Ref_To_Local'>bp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN31"><span class='Ref_to_Member'>tt_ttisgmt</span></a> <span class='Operator'>&& 
</span>            strcmp<span class='Parentheses'>(</span><span class='Operator'>&</span><a href="localtime.c.html#LN571"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN51"><span class='Ref_to_Member'>chars</span></a><span class='Delimiter'>[</span><a href="localtime.c.html#LN581"><span class='Ref_To_Local'>ap</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN29"><span class='Ref_to_Member'>tt_abbrind</span></a><span class='Delimiter'>], 
</span>                   <span class='Operator'>&</span><a href="localtime.c.html#LN571"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN51"><span class='Ref_to_Member'>chars</span></a><span class='Delimiter'>[</span><a href="localtime.c.html#LN582"><span class='Ref_To_Local'>bp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN29"><span class='Ref_to_Member'>tt_abbrind</span></a><span class='Delimiter'>]</span><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>return</span> <a href="localtime.c.html#LN573"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end typesequiv &raquo; </span> 
 
<a name="LN594"></a><span class='Keyword'>static const int </span><span class='Declare_Var'>mon_lengths</span><span class='Delimiter'>[</span><span class='Number'>2</span><span class='Delimiter'>][</span><a href="private.h.html#LN114"><span class='Ref_to_Const'>MONSPERYEAR</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Delimiter'>{ 
</span>    <span class='Delimiter'>{</span><span class='Number'>31</span><span class='Delimiter'>, </span><span class='Number'>28</span><span class='Delimiter'>, </span><span class='Number'>31</span><span class='Delimiter'>, </span><span class='Number'>30</span><span class='Delimiter'>, </span><span class='Number'>31</span><span class='Delimiter'>, </span><span class='Number'>30</span><span class='Delimiter'>, </span><span class='Number'>31</span><span class='Delimiter'>, </span><span class='Number'>31</span><span class='Delimiter'>, </span><span class='Number'>30</span><span class='Delimiter'>, </span><span class='Number'>31</span><span class='Delimiter'>, </span><span class='Number'>30</span><span class='Delimiter'>, </span><span class='Number'>31</span><span class='Delimiter'>}, 
</span>    <span class='Delimiter'>{</span><span class='Number'>31</span><span class='Delimiter'>, </span><span class='Number'>29</span><span class='Delimiter'>, </span><span class='Number'>31</span><span class='Delimiter'>, </span><span class='Number'>30</span><span class='Delimiter'>, </span><span class='Number'>31</span><span class='Delimiter'>, </span><span class='Number'>30</span><span class='Delimiter'>, </span><span class='Number'>31</span><span class='Delimiter'>, </span><span class='Number'>31</span><span class='Delimiter'>, </span><span class='Number'>30</span><span class='Delimiter'>, </span><span class='Number'>31</span><span class='Delimiter'>, </span><span class='Number'>30</span><span class='Delimiter'>, </span><span class='Number'>31</span><span class='Delimiter'>} 
}; 
</span> 
<a name="LN599"></a><span class='Keyword'>static const int </span><span class='Declare_Var'>year_lengths</span><span class='Delimiter'>[</span><span class='Number'>2</span><span class='Delimiter'>] </span><span class='Operator'>= </span><span class='Delimiter'>{ 
</span>    <a href="private.h.html#LN110"><span class='Ref_to_Const'>DAYSPERNYEAR</span></a><span class='Delimiter'>, </span><a href="private.h.html#LN111"><span class='Ref_to_Const'>DAYSPERLYEAR</span></a> 
<span class='Delimiter'>}; 
</span> 
<span class='Comment_Multi_Line'>/* 
 * Given a pointer into a time zone string, scan until a character that is not 
 * a valid character in a zone name is found. Return a pointer to that 
 * character. 
 */ 
</span><span class='Keyword'>static const char </span><span class='Operator'>* 
</span><a name="LN609"></a><span class='Declare_Function'>getzname</span><span class='Parentheses'>(</span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>strp</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN611"></a>    <span class='Keyword'>char</span>        <span class='Declare_Local'>c</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>while</span> <span class='Parentheses'>((</span><a href="localtime.c.html#LN611"><span class='Ref_To_Local'>c</span></a> <span class='Operator'>= *</span><a href="localtime.c.html#LN609"><span class='Ref_to_Parameter'>strp</span></a><span class='Parentheses'>) </span><span class='Operator'>!= </span><span class='String'>'\0'</span> <span class='Operator'>&& !</span><a href="private.h.html#LN48"><span class='Ref_to_Macro'>is_digit</span></a><span class='Parentheses'>(</span><a href="localtime.c.html#LN611"><span class='Ref_To_Local'>c</span></a><span class='Parentheses'>) </span><span class='Operator'>&& </span><a href="localtime.c.html#LN611"><span class='Ref_To_Local'>c</span></a> <span class='Operator'>!= </span><span class='String'>','</span> <span class='Operator'>&& </span><a href="localtime.c.html#LN611"><span class='Ref_To_Local'>c</span></a> <span class='Operator'>!= </span><span class='String'>'-'</span> <span class='Operator'>&& 
</span>           <a href="localtime.c.html#LN611"><span class='Ref_To_Local'>c</span></a> <span class='Operator'>!= </span><span class='String'>'+'</span><span class='Parentheses'>)</span> 
        <span class='Operator'>++</span><a href="localtime.c.html#LN609"><span class='Ref_to_Parameter'>strp</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <a href="localtime.c.html#LN609"><span class='Ref_to_Parameter'>strp</span></a><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * Given a pointer into an extended time zone string, scan until the ending 
 * delimiter of the zone name is located. Return a pointer to the delimiter. 
 * 
 * As with getzname above, the legal character set is actually quite 
 * restricted, with other characters producing undefined results. 
 * We don't do any checking here; checking is done later in common-case code. 
 */ 
</span><span class='Keyword'>static const char </span><span class='Operator'>* 
</span><a name="LN628"></a><span class='Declare_Function'>getqzname</span><span class='Parentheses'>(</span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>strp</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>delim</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN630"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>c</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>while</span> <span class='Parentheses'>((</span><a href="localtime.c.html#LN630"><span class='Ref_To_Local'>c</span></a> <span class='Operator'>= *</span><a href="localtime.c.html#LN628"><span class='Ref_to_Parameter'>strp</span></a><span class='Parentheses'>) </span><span class='Operator'>!= </span><span class='String'>'\0'</span> <span class='Operator'>&& </span><a href="localtime.c.html#LN630"><span class='Ref_To_Local'>c</span></a> <span class='Operator'>!= </span><a href="localtime.c.html#LN628"><span class='Ref_to_Parameter'>delim</span></a><span class='Parentheses'>)</span> 
        <span class='Operator'>++</span><a href="localtime.c.html#LN628"><span class='Ref_to_Parameter'>strp</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <a href="localtime.c.html#LN628"><span class='Ref_to_Parameter'>strp</span></a><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * Given a pointer into a time zone string, extract a number from that string. 
 * Check that the number is within a specified range; if it is not, return 
 * NULL. 
 * Otherwise, return a pointer to the first character not part of the number. 
 */ 
</span><span class='Keyword'>static const char </span><span class='Operator'>* 
</span><a name="LN644"></a><span class='Declare_Function'>getnum</span><span class='Parentheses'>(</span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>strp</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Operator'>*</span><span class='Declare_Parameter'>nump</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>min</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>max</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN646"></a>    <span class='Keyword'>char</span>        <span class='Declare_Local'>c</span><span class='Delimiter'>; 
</span><a name="LN647"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>num</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN644"><span class='Ref_to_Parameter'>strp</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL </span><span class='Operator'>|| !</span><a href="private.h.html#LN48"><span class='Ref_to_Macro'>is_digit</span></a><span class='Parentheses'>(</span><a href="localtime.c.html#LN646"><span class='Ref_To_Local'>c</span></a> <span class='Operator'>= *</span><a href="localtime.c.html#LN644"><span class='Ref_to_Parameter'>strp</span></a><span class='Parentheses'>))</span> 
        <span class='Control'>return</span> <span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <a href="localtime.c.html#LN647"><span class='Ref_To_Local'>num</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <span class='Control'>do</span> 
    <span class='Delimiter'>{ 
</span>        <a href="localtime.c.html#LN647"><span class='Ref_To_Local'>num</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN647"><span class='Ref_To_Local'>num</span></a> <span class='Operator'>* </span><span class='Number'>10</span> <span class='Operator'>+ </span><span class='Parentheses'>(</span><a href="localtime.c.html#LN646"><span class='Ref_To_Local'>c</span></a> <span class='Operator'>- </span><span class='String'>'0'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN647"><span class='Ref_To_Local'>num</span></a> <span class='Operator'>&GT; </span><a href="localtime.c.html#LN644"><span class='Ref_to_Parameter'>max</span></a><span class='Parentheses'>) 
</span>            <span class='Control'>return</span> <span class='Null_Value'>NULL</span><span class='Delimiter'>;</span>        <span class='Comment_Single_Line'>/* illegal value */ 
</span>        <a href="localtime.c.html#LN646"><span class='Ref_To_Local'>c</span></a> <span class='Operator'>= *++</span><a href="localtime.c.html#LN644"><span class='Ref_to_Parameter'>strp</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} </span><span class='Control'>while</span> <span class='Parentheses'>(</span><a href="private.h.html#LN48"><span class='Ref_to_Macro'>is_digit</span></a><span class='Parentheses'>(</span><a href="localtime.c.html#LN646"><span class='Ref_To_Local'>c</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN647"><span class='Ref_To_Local'>num</span></a> <span class='Operator'>&LT; </span><a href="localtime.c.html#LN644"><span class='Ref_to_Parameter'>min</span></a><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <span class='Null_Value'>NULL</span><span class='Delimiter'>;</span>            <span class='Comment_Single_Line'>/* illegal value */ 
</span>    <span class='Operator'>*</span><a href="localtime.c.html#LN644"><span class='Ref_to_Parameter'>nump</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN647"><span class='Ref_To_Local'>num</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <a href="localtime.c.html#LN644"><span class='Ref_to_Parameter'>strp</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end getnum &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * Given a pointer into a time zone string, extract a number of seconds, 
 * in hh[:mm[:ss]] form, from the string. 
 * If any error occurs, return NULL. 
 * Otherwise, return a pointer to the first character not part of the number 
 * of seconds. 
 */ 
</span><span class='Keyword'>static const char </span><span class='Operator'>* 
</span><a name="LN673"></a><span class='Declare_Function'>getsecs</span><span class='Parentheses'>(</span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>strp</span><span class='Delimiter'>, </span><a href="../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>secsp</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN675"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>num</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * 'HOURSPERDAY * DAYSPERWEEK - 1' allows quasi-Posix rules like 
     * "M10.4.6/26", which does not conform to Posix, but which specifies the 
     * equivalent of "02:00 on the first Sunday on or after 23 Oct". 
     */ 
</span>    <a href="localtime.c.html#LN673"><span class='Ref_to_Parameter'>strp</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN643"><span class='Ref_to_Func'>getnum</span></a><span class='Parentheses'>(</span><a href="localtime.c.html#LN673"><span class='Ref_to_Parameter'>strp</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="localtime.c.html#LN675"><span class='Ref_To_Local'>num</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Delimiter'>, </span><a href="private.h.html#LN108"><span class='Ref_to_Const'>HOURSPERDAY</span></a> <span class='Operator'>* </span><a href="private.h.html#LN109"><span class='Ref_to_Const'>DAYSPERWEEK</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN673"><span class='Ref_to_Parameter'>strp</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <span class='Operator'>*</span><a href="localtime.c.html#LN673"><span class='Ref_to_Parameter'>secsp</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN675"><span class='Ref_To_Local'>num</span></a> <span class='Operator'>* </span><span class='Parentheses'>(</span><a href="../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a><span class='Parentheses'>) </span><a href="private.h.html#LN112"><span class='Ref_to_Const'>SECSPERHOUR</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="localtime.c.html#LN673"><span class='Ref_to_Parameter'>strp</span></a> <span class='Operator'>== </span><span class='String'>':'</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Operator'>++</span><a href="localtime.c.html#LN673"><span class='Ref_to_Parameter'>strp</span></a><span class='Delimiter'>; 
</span>        <a href="localtime.c.html#LN673"><span class='Ref_to_Parameter'>strp</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN643"><span class='Ref_to_Func'>getnum</span></a><span class='Parentheses'>(</span><a href="localtime.c.html#LN673"><span class='Ref_to_Parameter'>strp</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="localtime.c.html#LN675"><span class='Ref_To_Local'>num</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Delimiter'>, </span><a href="private.h.html#LN107"><span class='Ref_to_Const'>MINSPERHOUR</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN673"><span class='Ref_to_Parameter'>strp</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>            <span class='Control'>return</span> <span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>        <span class='Operator'>*</span><a href="localtime.c.html#LN673"><span class='Ref_to_Parameter'>secsp</span></a> <span class='Operator'>+= </span><a href="localtime.c.html#LN675"><span class='Ref_To_Local'>num</span></a> <span class='Operator'>* </span><a href="private.h.html#LN106"><span class='Ref_to_Const'>SECSPERMIN</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="localtime.c.html#LN673"><span class='Ref_to_Parameter'>strp</span></a> <span class='Operator'>== </span><span class='String'>':'</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Operator'>++</span><a href="localtime.c.html#LN673"><span class='Ref_to_Parameter'>strp</span></a><span class='Delimiter'>; 
</span>            <span class='Comment_Multi_Line'>/* 'SECSPERMIN' allows for leap seconds.  */ 
</span>            <a href="localtime.c.html#LN673"><span class='Ref_to_Parameter'>strp</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN643"><span class='Ref_to_Func'>getnum</span></a><span class='Parentheses'>(</span><a href="localtime.c.html#LN673"><span class='Ref_to_Parameter'>strp</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="localtime.c.html#LN675"><span class='Ref_To_Local'>num</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Delimiter'>, </span><a href="private.h.html#LN106"><span class='Ref_to_Const'>SECSPERMIN</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN673"><span class='Ref_to_Parameter'>strp</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>                <span class='Control'>return</span> <span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>            <span class='Operator'>*</span><a href="localtime.c.html#LN673"><span class='Ref_to_Parameter'>secsp</span></a> <span class='Operator'>+= </span><a href="localtime.c.html#LN675"><span class='Ref_To_Local'>num</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>return</span> <a href="localtime.c.html#LN673"><span class='Ref_to_Parameter'>strp</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end getsecs &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * Given a pointer into a time zone string, extract an offset, in 
 * [+-]hh[:mm[:ss]] form, from the string. 
 * If any error occurs, return NULL. 
 * Otherwise, return a pointer to the first character not part of the time. 
 */ 
</span><span class='Keyword'>static const char </span><span class='Operator'>* 
</span><a name="LN713"></a><span class='Declare_Function'>getoffset</span><span class='Parentheses'>(</span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>strp</span><span class='Delimiter'>, </span><a href="../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>offsetp</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN715"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>neg</span> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="localtime.c.html#LN713"><span class='Ref_to_Parameter'>strp</span></a> <span class='Operator'>== </span><span class='String'>'-'</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="localtime.c.html#LN715"><span class='Ref_To_Local'>neg</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>        <span class='Operator'>++</span><a href="localtime.c.html#LN713"><span class='Ref_to_Parameter'>strp</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="localtime.c.html#LN713"><span class='Ref_to_Parameter'>strp</span></a> <span class='Operator'>== </span><span class='String'>'+'</span><span class='Parentheses'>) 
</span>        <span class='Operator'>++</span><a href="localtime.c.html#LN713"><span class='Ref_to_Parameter'>strp</span></a><span class='Delimiter'>; 
</span>    <a href="localtime.c.html#LN713"><span class='Ref_to_Parameter'>strp</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN672"><span class='Ref_to_Func'>getsecs</span></a><span class='Parentheses'>(</span><a href="localtime.c.html#LN713"><span class='Ref_to_Parameter'>strp</span></a><span class='Delimiter'>, </span><a href="localtime.c.html#LN713"><span class='Ref_to_Parameter'>offsetp</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN713"><span class='Ref_to_Parameter'>strp</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <span class='Null_Value'>NULL</span><span class='Delimiter'>;</span>            <span class='Comment_Single_Line'>/* illegal time */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN715"><span class='Ref_To_Local'>neg</span></a><span class='Parentheses'>) 
</span>        <span class='Operator'>*</span><a href="localtime.c.html#LN713"><span class='Ref_to_Parameter'>offsetp</span></a> <span class='Operator'>= -*</span><a href="localtime.c.html#LN713"><span class='Ref_to_Parameter'>offsetp</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <a href="localtime.c.html#LN713"><span class='Ref_to_Parameter'>strp</span></a><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * Given a pointer into a time zone string, extract a rule in the form 
 * date[/time]. See POSIX section 8 for the format of "date" and "time". 
 * If a valid rule is not found, return NULL. 
 * Otherwise, return a pointer to the first character not part of the rule. 
 */ 
</span><span class='Keyword'>static const char </span><span class='Operator'>* 
</span><a name="LN739"></a><span class='Declare_Function'>getrule</span><span class='Parentheses'>(</span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>strp</span><span class='Delimiter'>, </span><span class='Control'>struct</span> <a href="zic.c.html#LN52"><span class='Ref_to_Struct'>rule</span></a> <span class='Operator'>* </span><span class='Declare_Parameter'>rulep</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="localtime.c.html#LN739"><span class='Ref_to_Parameter'>strp</span></a> <span class='Operator'>== </span><span class='String'>'J'</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* 
         * Julian day. 
         */ 
</span>        <a href="localtime.c.html#LN739"><span class='Ref_to_Parameter'>rulep</span></a><span class='Operator'>-&GT;</span><a href="localtime.c.html#LN83"><span class='Ref_to_Member'>r_type</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN76"><span class='Ref_to_EnumConst'>JULIAN_DAY</span></a><span class='Delimiter'>; 
</span>        <span class='Operator'>++</span><a href="localtime.c.html#LN739"><span class='Ref_to_Parameter'>strp</span></a><span class='Delimiter'>; 
</span>        <a href="localtime.c.html#LN739"><span class='Ref_to_Parameter'>strp</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN643"><span class='Ref_to_Func'>getnum</span></a><span class='Parentheses'>(</span><a href="localtime.c.html#LN739"><span class='Ref_to_Parameter'>strp</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="localtime.c.html#LN739"><span class='Ref_to_Parameter'>rulep</span></a><span class='Operator'>-&GT;</span><a href="localtime.c.html#LN84"><span class='Ref_to_Member'>r_day</span></a><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Delimiter'>, </span><a href="private.h.html#LN110"><span class='Ref_to_Const'>DAYSPERNYEAR</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="localtime.c.html#LN739"><span class='Ref_to_Parameter'>strp</span></a> <span class='Operator'>== </span><span class='String'>'M'</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* 
         * Month, week, day. 
         */ 
</span>        <a href="localtime.c.html#LN739"><span class='Ref_to_Parameter'>rulep</span></a><span class='Operator'>-&GT;</span><a href="localtime.c.html#LN83"><span class='Ref_to_Member'>r_type</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN78"><span class='Ref_to_EnumConst'>MONTH_NTH_DAY_OF_WEEK</span></a><span class='Delimiter'>; 
</span>        <span class='Operator'>++</span><a href="localtime.c.html#LN739"><span class='Ref_to_Parameter'>strp</span></a><span class='Delimiter'>; 
</span>        <a href="localtime.c.html#LN739"><span class='Ref_to_Parameter'>strp</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN643"><span class='Ref_to_Func'>getnum</span></a><span class='Parentheses'>(</span><a href="localtime.c.html#LN739"><span class='Ref_to_Parameter'>strp</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="localtime.c.html#LN739"><span class='Ref_to_Parameter'>rulep</span></a><span class='Operator'>-&GT;</span><a href="localtime.c.html#LN86"><span class='Ref_to_Member'>r_mon</span></a><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Delimiter'>, </span><a href="private.h.html#LN114"><span class='Ref_to_Const'>MONSPERYEAR</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN739"><span class='Ref_to_Parameter'>strp</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>            <span class='Control'>return</span> <span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="localtime.c.html#LN739"><span class='Ref_to_Parameter'>strp</span></a><span class='Operator'>++ != </span><span class='String'>'.'</span><span class='Parentheses'>) 
</span>            <span class='Control'>return</span> <span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>        <a href="localtime.c.html#LN739"><span class='Ref_to_Parameter'>strp</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN643"><span class='Ref_to_Func'>getnum</span></a><span class='Parentheses'>(</span><a href="localtime.c.html#LN739"><span class='Ref_to_Parameter'>strp</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="localtime.c.html#LN739"><span class='Ref_to_Parameter'>rulep</span></a><span class='Operator'>-&GT;</span><a href="localtime.c.html#LN85"><span class='Ref_to_Member'>r_week</span></a><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Delimiter'>, </span><span class='Number'>5</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN739"><span class='Ref_to_Parameter'>strp</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>            <span class='Control'>return</span> <span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="localtime.c.html#LN739"><span class='Ref_to_Parameter'>strp</span></a><span class='Operator'>++ != </span><span class='String'>'.'</span><span class='Parentheses'>) 
</span>            <span class='Control'>return</span> <span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>        <a href="localtime.c.html#LN739"><span class='Ref_to_Parameter'>strp</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN643"><span class='Ref_to_Func'>getnum</span></a><span class='Parentheses'>(</span><a href="localtime.c.html#LN739"><span class='Ref_to_Parameter'>strp</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="localtime.c.html#LN739"><span class='Ref_to_Parameter'>rulep</span></a><span class='Operator'>-&GT;</span><a href="localtime.c.html#LN84"><span class='Ref_to_Member'>r_day</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Delimiter'>, </span><a href="private.h.html#LN109"><span class='Ref_to_Const'>DAYSPERWEEK</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="private.h.html#LN48"><span class='Ref_to_Macro'>is_digit</span></a><span class='Parentheses'>(</span><span class='Operator'>*</span><a href="localtime.c.html#LN739"><span class='Ref_to_Parameter'>strp</span></a><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* 
         * Day of year. 
         */ 
</span>        <a href="localtime.c.html#LN739"><span class='Ref_to_Parameter'>rulep</span></a><span class='Operator'>-&GT;</span><a href="localtime.c.html#LN83"><span class='Ref_to_Member'>r_type</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN77"><span class='Ref_to_EnumConst'>DAY_OF_YEAR</span></a><span class='Delimiter'>; 
</span>        <a href="localtime.c.html#LN739"><span class='Ref_to_Parameter'>strp</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN643"><span class='Ref_to_Func'>getnum</span></a><span class='Parentheses'>(</span><a href="localtime.c.html#LN739"><span class='Ref_to_Parameter'>strp</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="localtime.c.html#LN739"><span class='Ref_to_Parameter'>rulep</span></a><span class='Operator'>-&GT;</span><a href="localtime.c.html#LN84"><span class='Ref_to_Member'>r_day</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Delimiter'>, </span><a href="private.h.html#LN111"><span class='Ref_to_Const'>DAYSPERLYEAR</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> 
        <span class='Control'>return</span> <span class='Null_Value'>NULL</span><span class='Delimiter'>;</span>            <span class='Comment_Single_Line'>/* invalid format */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN739"><span class='Ref_to_Parameter'>strp</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="localtime.c.html#LN739"><span class='Ref_to_Parameter'>strp</span></a> <span class='Operator'>== </span><span class='String'>'/'</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* 
         * Time specified. 
         */ 
</span>        <span class='Operator'>++</span><a href="localtime.c.html#LN739"><span class='Ref_to_Parameter'>strp</span></a><span class='Delimiter'>; 
</span>        <a href="localtime.c.html#LN739"><span class='Ref_to_Parameter'>strp</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN712"><span class='Ref_to_Func'>getoffset</span></a><span class='Parentheses'>(</span><a href="localtime.c.html#LN739"><span class='Ref_to_Parameter'>strp</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="localtime.c.html#LN739"><span class='Ref_to_Parameter'>rulep</span></a><span class='Operator'>-&GT;</span><a href="localtime.c.html#LN87"><span class='Ref_to_Member'>r_time</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> 
        <a href="localtime.c.html#LN739"><span class='Ref_to_Parameter'>rulep</span></a><span class='Operator'>-&GT;</span><a href="localtime.c.html#LN87"><span class='Ref_to_Member'>r_time</span></a> <span class='Operator'>= </span><span class='Number'>2</span> <span class='Operator'>* </span><a href="private.h.html#LN112"><span class='Ref_to_Const'>SECSPERHOUR</span></a><span class='Delimiter'>;</span>        <span class='Comment_Single_Line'>/* default = 2:00:00 */ 
</span>    <span class='Control'>return</span> <a href="localtime.c.html#LN739"><span class='Ref_to_Parameter'>strp</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end getrule &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * Given a year, a rule, and the offset from UT at the time that rule takes 
 * effect, calculate the year-relative time that rule takes effect. 
 */ 
</span><span class='Keyword'>static </span><a href="../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a> 
<a name="LN799"></a><span class='Declare_Function'>transtime</span><span class='Parentheses'>(</span><span class='Keyword'>int </span><span class='Declare_Parameter'>year</span><span class='Delimiter'>, </span><span class='Keyword'>const </span><span class='Control'>struct</span> <a href="zic.c.html#LN52"><span class='Ref_to_Struct'>rule</span></a> <span class='Operator'>* </span><span class='Declare_Parameter'>rulep</span><span class='Delimiter'>, 
</span><a name="LN800"></a>          <a href="../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a> <span class='Declare_Parameter'>offset</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN802"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>leapyear</span><span class='Delimiter'>; 
</span><a name="LN803"></a>    <a href="../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>       <span class='Declare_Local'>value</span><span class='Delimiter'>; 
</span><a name="LN804"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>i</span><span class='Delimiter'>, 
</span><a name="LN805"></a>                <span class='Declare_Local'>d</span><span class='Delimiter'>, 
</span><a name="LN806"></a>                <span class='Declare_Local'>m1</span><span class='Delimiter'>, 
</span><a name="LN807"></a>                <span class='Declare_Local'>yy0</span><span class='Delimiter'>, 
</span><a name="LN808"></a>                <span class='Declare_Local'>yy1</span><span class='Delimiter'>, 
</span><a name="LN809"></a>                <span class='Declare_Local'>yy2</span><span class='Delimiter'>, 
</span><a name="LN810"></a>                <span class='Declare_Local'>dow</span><span class='Delimiter'>; 
</span> 
    <a href="private.h.html#LN97"><span class='Ref_to_Macro'>INITIALIZE</span></a><span class='Parentheses'>(</span><span class='Keyword'>value</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="localtime.c.html#LN802"><span class='Ref_To_Local'>leapyear</span></a> <span class='Operator'>= </span><a href="private.h.html#LN142"><span class='Ref_to_Macro'>isleap</span></a><span class='Parentheses'>(</span><a href="localtime.c.html#LN799"><span class='Ref_to_Parameter'>year</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>switch</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN799"><span class='Ref_to_Parameter'>rulep</span></a><span class='Operator'>-&GT;</span><a href="localtime.c.html#LN83"><span class='Ref_to_Member'>r_type</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span> 
        <span class='Control'>case</span> <a href="localtime.c.html#LN76"><span class='Ref_to_EnumConst'>JULIAN_DAY</span></a><span class='Operator'>: 
</span> 
            <span class='Comment_Multi_Line'>/* 
             * Jn - Julian day, 1 == January 1, 60 == March 1 even in leap 
             * years. In non-leap years, or if the day number is 59 or less, 
             * just add SECSPERDAY times the day number-1 to the time of 
             * January 1, midnight, to get the day. 
             */ 
</span>            <span class='Keyword'>value </span><span class='Operator'>= </span><span class='Parentheses'>(</span><a href="localtime.c.html#LN799"><span class='Ref_to_Parameter'>rulep</span></a><span class='Operator'>-&GT;</span><a href="localtime.c.html#LN84"><span class='Ref_to_Member'>r_day</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Parentheses'>) </span><span class='Operator'>* </span><a href="private.h.html#LN113"><span class='Ref_to_Const'>SECSPERDAY</span></a><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN802"><span class='Ref_To_Local'>leapyear</span></a> <span class='Operator'>&& </span><a href="localtime.c.html#LN799"><span class='Ref_to_Parameter'>rulep</span></a><span class='Operator'>-&GT;</span><a href="localtime.c.html#LN84"><span class='Ref_to_Member'>r_day</span></a> <span class='Operator'>&GT;= </span><span class='Number'>60</span><span class='Parentheses'>) 
</span>                <span class='Keyword'>value </span><span class='Operator'>+= </span><a href="private.h.html#LN113"><span class='Ref_to_Const'>SECSPERDAY</span></a><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>case</span> <a href="localtime.c.html#LN77"><span class='Ref_to_EnumConst'>DAY_OF_YEAR</span></a><span class='Operator'>: 
</span> 
            <span class='Comment_Multi_Line'>/* 
             * n - day of year. Just add SECSPERDAY times the day number to 
             * the time of January 1, midnight, to get the day. 
             */ 
</span>            <span class='Keyword'>value </span><span class='Operator'>= </span><a href="localtime.c.html#LN799"><span class='Ref_to_Parameter'>rulep</span></a><span class='Operator'>-&GT;</span><a href="localtime.c.html#LN84"><span class='Ref_to_Member'>r_day</span></a> <span class='Operator'>* </span><a href="private.h.html#LN113"><span class='Ref_to_Const'>SECSPERDAY</span></a><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>case</span> <a href="localtime.c.html#LN78"><span class='Ref_to_EnumConst'>MONTH_NTH_DAY_OF_WEEK</span></a><span class='Operator'>: 
</span> 
            <span class='Comment_Multi_Line'>/* 
             * Mm.n.d - nth "dth day" of month m. 
             */ 
</span> 
            <span class='Comment_Multi_Line'>/* 
             * Use Zeller's Congruence to get day-of-week of first day of 
             * month. 
             */ 
</span>            <a href="localtime.c.html#LN806"><span class='Ref_To_Local'>m1</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="localtime.c.html#LN799"><span class='Ref_to_Parameter'>rulep</span></a><span class='Operator'>-&GT;</span><a href="localtime.c.html#LN86"><span class='Ref_to_Member'>r_mon</span></a> <span class='Operator'>+ </span><span class='Number'>9</span><span class='Parentheses'>) </span><span class='Operator'>% </span><span class='Number'>12</span> <span class='Operator'>+ </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>            <a href="localtime.c.html#LN807"><span class='Ref_To_Local'>yy0</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="localtime.c.html#LN799"><span class='Ref_to_Parameter'>rulep</span></a><span class='Operator'>-&GT;</span><a href="localtime.c.html#LN86"><span class='Ref_to_Member'>r_mon</span></a> <span class='Operator'>&LT;= </span><span class='Number'>2</span><span class='Parentheses'>) </span><span class='Operator'>? </span><span class='Parentheses'>(</span><a href="localtime.c.html#LN799"><span class='Ref_to_Parameter'>year</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Parentheses'>) </span><span class='Operator'>: </span><a href="localtime.c.html#LN799"><span class='Ref_to_Parameter'>year</span></a><span class='Delimiter'>; 
</span>            <a href="localtime.c.html#LN808"><span class='Ref_To_Local'>yy1</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN807"><span class='Ref_To_Local'>yy0</span></a> <span class='Operator'>/ </span><span class='Number'>100</span><span class='Delimiter'>; 
</span>            <a href="localtime.c.html#LN809"><span class='Ref_To_Local'>yy2</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN807"><span class='Ref_To_Local'>yy0</span></a> <span class='Operator'>% </span><span class='Number'>100</span><span class='Delimiter'>; 
</span>            <a href="localtime.c.html#LN810"><span class='Ref_To_Local'>dow</span></a> <span class='Operator'>= </span><span class='Parentheses'>((</span><span class='Number'>26</span> <span class='Operator'>* </span><a href="localtime.c.html#LN806"><span class='Ref_To_Local'>m1</span></a> <span class='Operator'>- </span><span class='Number'>2</span><span class='Parentheses'>) </span><span class='Operator'>/ </span><span class='Number'>10</span> <span class='Operator'>+ 
</span>                   <span class='Number'>1</span> <span class='Operator'>+ </span><a href="localtime.c.html#LN809"><span class='Ref_To_Local'>yy2</span></a> <span class='Operator'>+ </span><a href="localtime.c.html#LN809"><span class='Ref_To_Local'>yy2</span></a> <span class='Operator'>/ </span><span class='Number'>4</span> <span class='Operator'>+ </span><a href="localtime.c.html#LN808"><span class='Ref_To_Local'>yy1</span></a> <span class='Operator'>/ </span><span class='Number'>4</span> <span class='Operator'>- </span><span class='Number'>2</span> <span class='Operator'>* </span><a href="localtime.c.html#LN808"><span class='Ref_To_Local'>yy1</span></a><span class='Parentheses'>)</span> <span class='Operator'>% </span><span class='Number'>7</span><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN810"><span class='Ref_To_Local'>dow</span></a> <span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>                <a href="localtime.c.html#LN810"><span class='Ref_To_Local'>dow</span></a> <span class='Operator'>+= </span><a href="private.h.html#LN109"><span class='Ref_to_Const'>DAYSPERWEEK</span></a><span class='Delimiter'>; 
</span> 
            <span class='Comment_Multi_Line'>/* 
             * "dow" is the day-of-week of the first day of the month. Get the 
             * day-of-month (zero-origin) of the first "dow" day of the month. 
             */ 
</span>            <a href="localtime.c.html#LN805"><span class='Ref_To_Local'>d</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN799"><span class='Ref_to_Parameter'>rulep</span></a><span class='Operator'>-&GT;</span><a href="localtime.c.html#LN84"><span class='Ref_to_Member'>r_day</span></a> <span class='Operator'>- </span><a href="localtime.c.html#LN810"><span class='Ref_To_Local'>dow</span></a><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN805"><span class='Ref_To_Local'>d</span></a> <span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>                <a href="localtime.c.html#LN805"><span class='Ref_To_Local'>d</span></a> <span class='Operator'>+= </span><a href="private.h.html#LN109"><span class='Ref_to_Const'>DAYSPERWEEK</span></a><span class='Delimiter'>; 
</span>            <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN804"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>; </span><a href="localtime.c.html#LN804"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="localtime.c.html#LN799"><span class='Ref_to_Parameter'>rulep</span></a><span class='Operator'>-&GT;</span><a href="localtime.c.html#LN85"><span class='Ref_to_Member'>r_week</span></a><span class='Delimiter'>; </span><span class='Operator'>++</span><a href="localtime.c.html#LN804"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN805"><span class='Ref_To_Local'>d</span></a> <span class='Operator'>+ </span><a href="private.h.html#LN109"><span class='Ref_to_Const'>DAYSPERWEEK</span></a> <span class='Operator'>&GT;= 
</span>                    <a href="localtime.c.html#LN594"><span class='Ref_to_Global_Var'>mon_lengths</span></a><span class='Delimiter'>[</span><span class='Parentheses'>(</span><span class='Keyword'>int</span><span class='Parentheses'>) </span><a href="localtime.c.html#LN802"><span class='Ref_To_Local'>leapyear</span></a><span class='Delimiter'>][</span><a href="localtime.c.html#LN799"><span class='Ref_to_Parameter'>rulep</span></a><span class='Operator'>-&GT;</span><a href="localtime.c.html#LN86"><span class='Ref_to_Member'>r_mon</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>]</span><span class='Parentheses'>)</span> 
                    <span class='Control'>break</span><span class='Delimiter'>; 
</span>                <a href="localtime.c.html#LN805"><span class='Ref_To_Local'>d</span></a> <span class='Operator'>+= </span><a href="private.h.html#LN109"><span class='Ref_to_Const'>DAYSPERWEEK</span></a><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span> 
            <span class='Comment_Multi_Line'>/* 
             * "d" is the day-of-month (zero-origin) of the day we want. 
             */ 
</span>            <span class='Keyword'>value </span><span class='Operator'>= </span><a href="localtime.c.html#LN805"><span class='Ref_To_Local'>d</span></a> <span class='Operator'>* </span><a href="private.h.html#LN113"><span class='Ref_to_Const'>SECSPERDAY</span></a><span class='Delimiter'>; 
</span>            <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN804"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="localtime.c.html#LN804"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="localtime.c.html#LN799"><span class='Ref_to_Parameter'>rulep</span></a><span class='Operator'>-&GT;</span><a href="localtime.c.html#LN86"><span class='Ref_to_Member'>r_mon</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>; </span><span class='Operator'>++</span><a href="localtime.c.html#LN804"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>) 
</span>                <span class='Keyword'>value </span><span class='Operator'>+= </span><a href="localtime.c.html#LN594"><span class='Ref_to_Global_Var'>mon_lengths</span></a><span class='Delimiter'>[</span><span class='Parentheses'>(</span><span class='Keyword'>int</span><span class='Parentheses'>) </span><a href="localtime.c.html#LN802"><span class='Ref_To_Local'>leapyear</span></a><span class='Delimiter'>][</span><a href="localtime.c.html#LN804"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>] </span><span class='Operator'>* </span><a href="private.h.html#LN113"><span class='Ref_to_Const'>SECSPERDAY</span></a><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end switch rulep-&GT;r_type &raquo; </span> 
 
    <span class='Comment_Multi_Line'>/* 
     * "value" is the year-relative time of 00:00:00 UT on the day in 
     * question. To get the year-relative time of the specified local time on 
     * that day, add the transition time and the current offset from UT. 
     */ 
</span>    <span class='Control'>return</span> <span class='Keyword'>value </span><span class='Operator'>+ </span><a href="localtime.c.html#LN799"><span class='Ref_to_Parameter'>rulep</span></a><span class='Operator'>-&GT;</span><a href="localtime.c.html#LN87"><span class='Ref_to_Member'>r_time</span></a> <span class='Operator'>+ </span><a href="localtime.c.html#LN800"><span class='Ref_to_Parameter'>offset</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end transtime &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * Given a POSIX section 8-style TZ string, fill in the rule tables as 
 * appropriate. 
 * Returns true on success, false on failure. 
 */ 
</span><span class='Keyword'>bool 
</span><a name="LN896"></a><span class='Declare_Function'>tzparse</span><span class='Parentheses'>(</span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>name</span><span class='Delimiter'>, </span><span class='Control'>struct</span> <a href="pgtz.h.html#LN40"><span class='Ref_to_Struct'>state</span></a> <span class='Operator'>* </span><span class='Declare_Parameter'>sp</span><span class='Delimiter'>, </span><span class='Keyword'>bool </span><span class='Declare_Parameter'>lastditch</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN898"></a>    <span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Local'>stdname</span><span class='Delimiter'>; 
</span><a name="LN899"></a>    <span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Local'>dstname</span> <span class='Operator'>= </span><span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span><a name="LN900"></a>    size_t      <span class='Declare_Local'>stdlen</span><span class='Delimiter'>; 
</span><a name="LN901"></a>    size_t      <span class='Declare_Local'>dstlen</span><span class='Delimiter'>; 
</span><a name="LN902"></a>    size_t      <span class='Declare_Local'>charcnt</span><span class='Delimiter'>; 
</span><a name="LN903"></a>    <a href="../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>       <span class='Declare_Local'>stdoffset</span><span class='Delimiter'>; 
</span><a name="LN904"></a>    <a href="../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>       <span class='Declare_Local'>dstoffset</span><span class='Delimiter'>; 
</span><a name="LN905"></a>    <span class='Keyword'>char</span>       <span class='Operator'>*</span><span class='Declare_Local'>cp</span><span class='Delimiter'>; 
</span><a name="LN906"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>load_ok</span><span class='Delimiter'>; 
</span> 
    <a href="localtime.c.html#LN898"><span class='Ref_To_Local'>stdname</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN896"><span class='Ref_to_Parameter'>name</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN896"><span class='Ref_to_Parameter'>lastditch</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* 
         * This is intentionally somewhat different from the IANA code.  We do 
         * not want to invoke tzload() in the lastditch case: we can't assume 
         * pg_open_tzfile() is sane yet, and we don't care about leap seconds 
         * anyway. 
         */ 
</span>        <a href="localtime.c.html#LN900"><span class='Ref_To_Local'>stdlen</span></a> <span class='Operator'>= </span>strlen<span class='Parentheses'>(</span><a href="localtime.c.html#LN896"><span class='Ref_to_Parameter'>name</span></a><span class='Parentheses'>)</span><span class='Delimiter'>;</span>  <span class='Comment_Single_Line'>/* length of standard zone name */ 
</span>        <a href="localtime.c.html#LN896"><span class='Ref_to_Parameter'>name</span></a> <span class='Operator'>+= </span><a href="localtime.c.html#LN900"><span class='Ref_To_Local'>stdlen</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN900"><span class='Ref_To_Local'>stdlen</span></a> <span class='Operator'>&GT;= </span><span class='Keyword'>sizeof </span><a href="localtime.c.html#LN896"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN51"><span class='Ref_to_Member'>chars</span></a><span class='Parentheses'>) 
</span>            <a href="localtime.c.html#LN900"><span class='Ref_To_Local'>stdlen</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Keyword'>sizeof </span><a href="localtime.c.html#LN896"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN51"><span class='Ref_to_Member'>chars</span></a><span class='Parentheses'>) </span><span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>        <a href="localtime.c.html#LN902"><span class='Ref_To_Local'>charcnt</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN900"><span class='Ref_To_Local'>stdlen</span></a> <span class='Operator'>+ </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>        <a href="localtime.c.html#LN903"><span class='Ref_To_Local'>stdoffset</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>        <a href="localtime.c.html#LN896"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN46"><span class='Ref_to_Member'>goback</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN896"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN47"><span class='Ref_to_Member'>goahead</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>;</span>       <span class='Comment_Single_Line'>/* simulate failed tzload() */ 
</span>        <a href="localtime.c.html#LN906"><span class='Ref_To_Local'>load_ok</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="localtime.c.html#LN896"><span class='Ref_to_Parameter'>name</span></a> <span class='Operator'>== </span><span class='String'>'&LT;'</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <a href="localtime.c.html#LN896"><span class='Ref_to_Parameter'>name</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>            <a href="localtime.c.html#LN898"><span class='Ref_To_Local'>stdname</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN896"><span class='Ref_to_Parameter'>name</span></a><span class='Delimiter'>; 
</span>            <a href="localtime.c.html#LN896"><span class='Ref_to_Parameter'>name</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN627"><span class='Ref_to_Func'>getqzname</span></a><span class='Parentheses'>(</span><a href="localtime.c.html#LN896"><span class='Ref_to_Parameter'>name</span></a><span class='Delimiter'>, </span><span class='String'>'&GT;'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="localtime.c.html#LN896"><span class='Ref_to_Parameter'>name</span></a> <span class='Operator'>!= </span><span class='String'>'&GT;'</span><span class='Parentheses'>) 
</span>                <span class='Control'>return</span> <span class='Boolean'>false</span><span class='Delimiter'>; 
</span>            <a href="localtime.c.html#LN900"><span class='Ref_To_Local'>stdlen</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN896"><span class='Ref_to_Parameter'>name</span></a> <span class='Operator'>- </span><a href="localtime.c.html#LN898"><span class='Ref_To_Local'>stdname</span></a><span class='Delimiter'>; 
</span>            <a href="localtime.c.html#LN896"><span class='Ref_to_Parameter'>name</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> 
        <span class='Delimiter'>{ 
</span>            <a href="localtime.c.html#LN896"><span class='Ref_to_Parameter'>name</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN608"><span class='Ref_to_Func'>getzname</span></a><span class='Parentheses'>(</span><a href="localtime.c.html#LN896"><span class='Ref_to_Parameter'>name</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="localtime.c.html#LN900"><span class='Ref_To_Local'>stdlen</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN896"><span class='Ref_to_Parameter'>name</span></a> <span class='Operator'>- </span><a href="localtime.c.html#LN898"><span class='Ref_To_Local'>stdname</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="localtime.c.html#LN896"><span class='Ref_to_Parameter'>name</span></a> <span class='Operator'>== </span><span class='String'>'\0'</span><span class='Parentheses'>)</span>      <span class='Comment_Single_Line'>/* we allow empty STD abbrev, unlike IANA */ 
</span>            <span class='Control'>return</span> <span class='Boolean'>false</span><span class='Delimiter'>; 
</span>        <a href="localtime.c.html#LN896"><span class='Ref_to_Parameter'>name</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN712"><span class='Ref_to_Func'>getoffset</span></a><span class='Parentheses'>(</span><a href="localtime.c.html#LN896"><span class='Ref_to_Parameter'>name</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="localtime.c.html#LN903"><span class='Ref_To_Local'>stdoffset</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN896"><span class='Ref_to_Parameter'>name</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>            <span class='Control'>return</span> <span class='Boolean'>false</span><span class='Delimiter'>; 
</span>        <a href="localtime.c.html#LN902"><span class='Ref_To_Local'>charcnt</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN900"><span class='Ref_To_Local'>stdlen</span></a> <span class='Operator'>+ </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Keyword'>sizeof </span><a href="localtime.c.html#LN896"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN51"><span class='Ref_to_Member'>chars</span></a> <span class='Operator'>&LT; </span><a href="localtime.c.html#LN902"><span class='Ref_To_Local'>charcnt</span></a><span class='Parentheses'>) 
</span>            <span class='Control'>return</span> <span class='Boolean'>false</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Multi_Line'>/* 
         * This bit also differs from the IANA code, which doesn't make any 
         * attempt to avoid repetitive loadings of the TZDEFRULES zone. 
         */ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN61"><span class='Ref_to_Global_Var'>tzdefrules_loaded</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="pgtz.h.html#LN70"><span class='Ref_to_Proto'>tzload</span></a><span class='Parentheses'>(</span><a href="tzfile.h.html#LN24"><span class='Ref_to_Const'>TZDEFRULES</span></a><span class='Delimiter'>, </span><span class='Null_Value'>NULL</span><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="localtime.c.html#LN60"><span class='Ref_to_Global_Var'>tzdefrules_s</span></a><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
                <a href="localtime.c.html#LN61"><span class='Ref_to_Global_Var'>tzdefrules_loaded</span></a> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>            <span class='Control'>else</span> 
                <a href="localtime.c.html#LN61"><span class='Ref_to_Global_Var'>tzdefrules_loaded</span></a> <span class='Operator'>= -</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <a href="localtime.c.html#LN906"><span class='Ref_To_Local'>load_ok</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="localtime.c.html#LN61"><span class='Ref_to_Global_Var'>tzdefrules_loaded</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN906"><span class='Ref_To_Local'>load_ok</span></a><span class='Parentheses'>) 
</span>            memcpy<span class='Parentheses'>(</span><a href="localtime.c.html#LN896"><span class='Ref_to_Parameter'>sp</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="localtime.c.html#LN60"><span class='Ref_to_Global_Var'>tzdefrules_s</span></a><span class='Delimiter'>, </span><span class='Keyword'>sizeof</span><span class='Parentheses'>(</span><span class='Control'>struct</span> <a href="pgtz.h.html#LN40"><span class='Ref_to_Struct'>state</span></a><span class='Parentheses'>))</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end else &raquo; </span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="localtime.c.html#LN906"><span class='Ref_To_Local'>load_ok</span></a><span class='Parentheses'>) 
</span>        <a href="localtime.c.html#LN896"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN42"><span class='Ref_to_Member'>leapcnt</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>;</span>        <span class='Comment_Single_Line'>/* so, we're off a little */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="localtime.c.html#LN896"><span class='Ref_to_Parameter'>name</span></a> <span class='Operator'>!= </span><span class='String'>'\0'</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="localtime.c.html#LN896"><span class='Ref_to_Parameter'>name</span></a> <span class='Operator'>== </span><span class='String'>'&LT;'</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <a href="localtime.c.html#LN899"><span class='Ref_To_Local'>dstname</span></a> <span class='Operator'>= ++</span><a href="localtime.c.html#LN896"><span class='Ref_to_Parameter'>name</span></a><span class='Delimiter'>; 
</span>            <a href="localtime.c.html#LN896"><span class='Ref_to_Parameter'>name</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN627"><span class='Ref_to_Func'>getqzname</span></a><span class='Parentheses'>(</span><a href="localtime.c.html#LN896"><span class='Ref_to_Parameter'>name</span></a><span class='Delimiter'>, </span><span class='String'>'&GT;'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="localtime.c.html#LN896"><span class='Ref_to_Parameter'>name</span></a> <span class='Operator'>!= </span><span class='String'>'&GT;'</span><span class='Parentheses'>) 
</span>                <span class='Control'>return</span> <span class='Boolean'>false</span><span class='Delimiter'>; 
</span>            <a href="localtime.c.html#LN901"><span class='Ref_To_Local'>dstlen</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN896"><span class='Ref_to_Parameter'>name</span></a> <span class='Operator'>- </span><a href="localtime.c.html#LN899"><span class='Ref_To_Local'>dstname</span></a><span class='Delimiter'>; 
</span>            <a href="localtime.c.html#LN896"><span class='Ref_to_Parameter'>name</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> 
        <span class='Delimiter'>{ 
</span>            <a href="localtime.c.html#LN899"><span class='Ref_To_Local'>dstname</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN896"><span class='Ref_to_Parameter'>name</span></a><span class='Delimiter'>; 
</span>            <a href="localtime.c.html#LN896"><span class='Ref_to_Parameter'>name</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN608"><span class='Ref_to_Func'>getzname</span></a><span class='Parentheses'>(</span><a href="localtime.c.html#LN896"><span class='Ref_to_Parameter'>name</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="localtime.c.html#LN901"><span class='Ref_To_Local'>dstlen</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN896"><span class='Ref_to_Parameter'>name</span></a> <span class='Operator'>- </span><a href="localtime.c.html#LN899"><span class='Ref_To_Local'>dstname</span></a><span class='Delimiter'>;</span>    <span class='Comment_Single_Line'>/* length of DST zone name */ 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="localtime.c.html#LN901"><span class='Ref_To_Local'>dstlen</span></a><span class='Parentheses'>) 
</span>            <span class='Control'>return</span> <span class='Boolean'>false</span><span class='Delimiter'>; 
</span>        <a href="localtime.c.html#LN902"><span class='Ref_To_Local'>charcnt</span></a> <span class='Operator'>+= </span><a href="localtime.c.html#LN901"><span class='Ref_To_Local'>dstlen</span></a> <span class='Operator'>+ </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Keyword'>sizeof </span><a href="localtime.c.html#LN896"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN51"><span class='Ref_to_Member'>chars</span></a> <span class='Operator'>&LT; </span><a href="localtime.c.html#LN902"><span class='Ref_To_Local'>charcnt</span></a><span class='Parentheses'>) 
</span>            <span class='Control'>return</span> <span class='Boolean'>false</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="localtime.c.html#LN896"><span class='Ref_to_Parameter'>name</span></a> <span class='Operator'>!= </span><span class='String'>'\0'</span> <span class='Operator'>&& *</span><a href="localtime.c.html#LN896"><span class='Ref_to_Parameter'>name</span></a> <span class='Operator'>!= </span><span class='String'>','</span> <span class='Operator'>&& *</span><a href="localtime.c.html#LN896"><span class='Ref_to_Parameter'>name</span></a> <span class='Operator'>!= </span><span class='String'>';'</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <a href="localtime.c.html#LN896"><span class='Ref_to_Parameter'>name</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN712"><span class='Ref_to_Func'>getoffset</span></a><span class='Parentheses'>(</span><a href="localtime.c.html#LN896"><span class='Ref_to_Parameter'>name</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="localtime.c.html#LN904"><span class='Ref_To_Local'>dstoffset</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN896"><span class='Ref_to_Parameter'>name</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>                <span class='Control'>return</span> <span class='Boolean'>false</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> 
            <a href="localtime.c.html#LN904"><span class='Ref_To_Local'>dstoffset</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN903"><span class='Ref_To_Local'>stdoffset</span></a> <span class='Operator'>- </span><a href="private.h.html#LN112"><span class='Ref_to_Const'>SECSPERHOUR</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="localtime.c.html#LN896"><span class='Ref_to_Parameter'>name</span></a> <span class='Operator'>== </span><span class='String'>'\0'</span> <span class='Operator'>&& !</span><a href="localtime.c.html#LN906"><span class='Ref_To_Local'>load_ok</span></a><span class='Parentheses'>) 
</span>            <a href="localtime.c.html#LN896"><span class='Ref_to_Parameter'>name</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN70"><span class='Ref_to_Const'>TZDEFRULESTRING</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="localtime.c.html#LN896"><span class='Ref_to_Parameter'>name</span></a> <span class='Operator'>== </span><span class='String'>','</span> <span class='Operator'>|| *</span><a href="localtime.c.html#LN896"><span class='Ref_to_Parameter'>name</span></a> <span class='Operator'>== </span><span class='String'>';'</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span><a name="LN1003"></a>            <span class='Control'>struct</span> <a href="zic.c.html#LN52"><span class='Ref_to_Struct'>rule</span></a> <span class='Declare_Local'>start</span><span class='Delimiter'>; 
</span><a name="LN1004"></a>            <span class='Control'>struct</span> <a href="zic.c.html#LN52"><span class='Ref_to_Struct'>rule</span></a> <span class='Declare_Local'>end</span><span class='Delimiter'>; 
</span><a name="LN1005"></a>            <span class='Keyword'>int</span>         <span class='Declare_Local'>year</span><span class='Delimiter'>; 
</span><a name="LN1006"></a>            <span class='Keyword'>int</span>         <span class='Declare_Local'>yearlim</span><span class='Delimiter'>; 
</span><a name="LN1007"></a>            <span class='Keyword'>int</span>         <span class='Declare_Local'>timecnt</span><span class='Delimiter'>; 
</span><a name="LN1008"></a>            <a href="../include/pgtime.h.html#LN22"><span class='Ref_to_Typedef'>pg_time_t</span></a>   <span class='Declare_Local'>janfirst</span><span class='Delimiter'>; 
</span><a name="LN1009"></a>            <a href="../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>       <span class='Declare_Local'>janoffset</span> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span><a name="LN1010"></a>            <span class='Keyword'>int</span>         <span class='Declare_Local'>yearbeg</span><span class='Delimiter'>; 
</span> 
            <span class='Operator'>++</span><a href="localtime.c.html#LN896"><span class='Ref_to_Parameter'>name</span></a><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="localtime.c.html#LN896"><span class='Ref_to_Parameter'>name</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN738"><span class='Ref_to_Func'>getrule</span></a><span class='Parentheses'>(</span><a href="localtime.c.html#LN896"><span class='Ref_to_Parameter'>name</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="localtime.c.html#LN1003"><span class='Ref_To_Local'>start</span></a><span class='Parentheses'>))</span> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span> 
                <span class='Control'>return</span> <span class='Boolean'>false</span><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="localtime.c.html#LN896"><span class='Ref_to_Parameter'>name</span></a><span class='Operator'>++ != </span><span class='String'>','</span><span class='Parentheses'>) 
</span>                <span class='Control'>return</span> <span class='Boolean'>false</span><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="localtime.c.html#LN896"><span class='Ref_to_Parameter'>name</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN738"><span class='Ref_to_Func'>getrule</span></a><span class='Parentheses'>(</span><a href="localtime.c.html#LN896"><span class='Ref_to_Parameter'>name</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="localtime.c.html#LN1004"><span class='Ref_To_Local'>end</span></a><span class='Parentheses'>))</span> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>)</span> 
                <span class='Control'>return</span> <span class='Boolean'>false</span><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="localtime.c.html#LN896"><span class='Ref_to_Parameter'>name</span></a> <span class='Operator'>!= </span><span class='String'>'\0'</span><span class='Parentheses'>) 
</span>                <span class='Control'>return</span> <span class='Boolean'>false</span><span class='Delimiter'>; 
</span>            <a href="localtime.c.html#LN896"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN44"><span class='Ref_to_Member'>typecnt</span></a> <span class='Operator'>= </span><span class='Number'>2</span><span class='Delimiter'>;</span>    <span class='Comment_Single_Line'>/* standard time and DST */ 
</span> 
            <span class='Comment_Multi_Line'>/* 
             * Two transitions per year, from EPOCH_YEAR forward. 
             */ 
</span>            <a href="localtime.c.html#LN113"><span class='Ref_to_Func'>init_ttinfo</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="localtime.c.html#LN896"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN50"><span class='Ref_to_Member'>ttis</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>], </span><span class='Operator'>-</span><a href="localtime.c.html#LN904"><span class='Ref_To_Local'>dstoffset</span></a><span class='Delimiter'>, </span><span class='Boolean'>true</span><span class='Delimiter'>, </span><a href="localtime.c.html#LN900"><span class='Ref_To_Local'>stdlen</span></a> <span class='Operator'>+ </span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="localtime.c.html#LN113"><span class='Ref_to_Func'>init_ttinfo</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="localtime.c.html#LN896"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN50"><span class='Ref_to_Member'>ttis</span></a><span class='Delimiter'>[</span><span class='Number'>1</span><span class='Delimiter'>], </span><span class='Operator'>-</span><a href="localtime.c.html#LN903"><span class='Ref_To_Local'>stdoffset</span></a><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="localtime.c.html#LN896"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN54"><span class='Ref_to_Member'>defaulttype</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>            <a href="localtime.c.html#LN1007"><span class='Ref_To_Local'>timecnt</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>            <a href="localtime.c.html#LN1008"><span class='Ref_To_Local'>janfirst</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>            <a href="localtime.c.html#LN1010"><span class='Ref_To_Local'>yearbeg</span></a> <span class='Operator'>= </span><a href="private.h.html#LN139"><span class='Ref_to_Const'>EPOCH_YEAR</span></a><span class='Delimiter'>; 
</span> 
            <span class='Control'>do</span> 
            <span class='Delimiter'>{ 
</span><a name="LN1035"></a>                <a href="../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>       <span class='Declare_Local'>yearsecs</span> 
                <span class='Operator'>= </span><a href="localtime.c.html#LN599"><span class='Ref_to_Global_Var'>year_lengths</span></a><span class='Delimiter'>[</span><a href="private.h.html#LN142"><span class='Ref_to_Macro'>isleap</span></a><span class='Parentheses'>(</span><a href="localtime.c.html#LN1010"><span class='Ref_To_Local'>yearbeg</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>] </span><span class='Operator'>* </span><a href="private.h.html#LN113"><span class='Ref_to_Const'>SECSPERDAY</span></a><span class='Delimiter'>; 
</span> 
                <a href="localtime.c.html#LN1010"><span class='Ref_To_Local'>yearbeg</span></a><span class='Operator'>--</span><span class='Delimiter'>; 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN96"><span class='Ref_to_Proto'>increment_overflow_time</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="localtime.c.html#LN1008"><span class='Ref_To_Local'>janfirst</span></a><span class='Delimiter'>, </span><span class='Operator'>-</span><a href="localtime.c.html#LN1035"><span class='Ref_To_Local'>yearsecs</span></a><span class='Parentheses'>))</span> 
                <span class='Delimiter'>{ 
</span>                    <a href="localtime.c.html#LN1009"><span class='Ref_To_Local'>janoffset</span></a> <span class='Operator'>= -</span><a href="localtime.c.html#LN1035"><span class='Ref_To_Local'>yearsecs</span></a><span class='Delimiter'>; 
</span>                    <span class='Control'>break</span><span class='Delimiter'>; 
</span>                <span class='Delimiter'>} 
</span>            <span class='Delimiter'>} </span><span class='Control'>while</span> <span class='Parentheses'>(</span><a href="private.h.html#LN139"><span class='Ref_to_Const'>EPOCH_YEAR</span></a> <span class='Operator'>- </span><a href="private.h.html#LN104"><span class='Ref_to_Const'>YEARSPERREPEAT</span></a> <span class='Operator'>/ </span><span class='Number'>2</span> <span class='Operator'>&LT; </span><a href="localtime.c.html#LN1010"><span class='Ref_To_Local'>yearbeg</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
            <a href="localtime.c.html#LN1006"><span class='Ref_To_Local'>yearlim</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN1010"><span class='Ref_To_Local'>yearbeg</span></a> <span class='Operator'>+ </span><a href="private.h.html#LN104"><span class='Ref_to_Const'>YEARSPERREPEAT</span></a> <span class='Operator'>+ </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>            <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN1005"><span class='Ref_To_Local'>year</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN1010"><span class='Ref_To_Local'>yearbeg</span></a><span class='Delimiter'>; </span><a href="localtime.c.html#LN1005"><span class='Ref_To_Local'>year</span></a> <span class='Operator'>&LT; </span><a href="localtime.c.html#LN1006"><span class='Ref_To_Local'>yearlim</span></a><span class='Delimiter'>; </span><a href="localtime.c.html#LN1005"><span class='Ref_To_Local'>year</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <a href="../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a> 
<a name="LN1050"></a>                            <span class='Declare_Local'>starttime</span> <span class='Operator'>= </span><a href="localtime.c.html#LN798"><span class='Ref_to_Func'>transtime</span></a><span class='Parentheses'>(</span><a href="localtime.c.html#LN1005"><span class='Ref_To_Local'>year</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="localtime.c.html#LN1003"><span class='Ref_To_Local'>start</span></a><span class='Delimiter'>, </span><a href="localtime.c.html#LN903"><span class='Ref_To_Local'>stdoffset</span></a><span class='Parentheses'>)</span><span class='Delimiter'>, 
</span><a name="LN1051"></a>                            <span class='Declare_Local'>endtime</span> <span class='Operator'>= </span><a href="localtime.c.html#LN798"><span class='Ref_to_Func'>transtime</span></a><span class='Parentheses'>(</span><a href="localtime.c.html#LN1005"><span class='Ref_To_Local'>year</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="localtime.c.html#LN1004"><span class='Ref_To_Local'>end</span></a><span class='Delimiter'>, </span><a href="localtime.c.html#LN904"><span class='Ref_To_Local'>dstoffset</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <a href="../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a> 
<a name="LN1053"></a>                            <span class='Declare_Local'>yearsecs</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="localtime.c.html#LN599"><span class='Ref_to_Global_Var'>year_lengths</span></a><span class='Delimiter'>[</span><a href="private.h.html#LN142"><span class='Ref_to_Macro'>isleap</span></a><span class='Parentheses'>(</span><a href="localtime.c.html#LN1005"><span class='Ref_To_Local'>year</span></a><span class='Parentheses'>)</span><span class='Delimiter'>] 
</span>                                        <span class='Operator'>* </span><a href="private.h.html#LN113"><span class='Ref_to_Const'>SECSPERDAY</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><a name="LN1055"></a>                <span class='Keyword'>bool</span>        <span class='Declare_Local'>reversed</span> <span class='Operator'>= </span><a href="localtime.c.html#LN1051"><span class='Ref_To_Local'>endtime</span></a> <span class='Operator'>&LT; </span><a href="localtime.c.html#LN1050"><span class='Ref_To_Local'>starttime</span></a><span class='Delimiter'>; 
</span> 
                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN1055"><span class='Ref_To_Local'>reversed</span></a><span class='Parentheses'>) 
</span>                <span class='Delimiter'>{ 
</span><a name="LN1059"></a>                    <a href="../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>       <span class='Declare_Local'>swap</span> <span class='Operator'>= </span><a href="localtime.c.html#LN1050"><span class='Ref_To_Local'>starttime</span></a><span class='Delimiter'>; 
</span> 
                    <a href="localtime.c.html#LN1050"><span class='Ref_To_Local'>starttime</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN1051"><span class='Ref_To_Local'>endtime</span></a><span class='Delimiter'>; 
</span>                    <a href="localtime.c.html#LN1051"><span class='Ref_To_Local'>endtime</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN1059"><span class='Ref_To_Local'>swap</span></a><span class='Delimiter'>; 
</span>                <span class='Delimiter'>} 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN1055"><span class='Ref_To_Local'>reversed</span></a> 
                    <span class='Operator'>|| </span><span class='Parentheses'>(</span><a href="localtime.c.html#LN1050"><span class='Ref_To_Local'>starttime</span></a> <span class='Operator'>&LT; </span><a href="localtime.c.html#LN1051"><span class='Ref_To_Local'>endtime</span></a> 
                        <span class='Operator'>&& </span><span class='Parentheses'>(</span><a href="localtime.c.html#LN1051"><span class='Ref_To_Local'>endtime</span></a> <span class='Operator'>- </span><a href="localtime.c.html#LN1050"><span class='Ref_To_Local'>starttime</span></a> 
                            <span class='Operator'>&LT; </span><span class='Parentheses'>(</span><a href="localtime.c.html#LN1053"><span class='Ref_To_Local'>yearsecs</span></a> 
                               <span class='Operator'>+ </span><span class='Parentheses'>(</span><a href="localtime.c.html#LN903"><span class='Ref_To_Local'>stdoffset</span></a> <span class='Operator'>- </span><a href="localtime.c.html#LN904"><span class='Ref_To_Local'>dstoffset</span></a><span class='Parentheses'>)))))</span> 
                <span class='Delimiter'>{ 
</span>                    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="tzfile.h.html#LN92"><span class='Ref_to_Const'>TZ_MAX_TIMES</span></a> <span class='Operator'>- </span><span class='Number'>2</span> <span class='Operator'>&LT; </span><a href="localtime.c.html#LN1007"><span class='Ref_To_Local'>timecnt</span></a><span class='Parentheses'>) 
</span>                        <span class='Control'>break</span><span class='Delimiter'>; 
</span>                    <a href="localtime.c.html#LN896"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN48"><span class='Ref_to_Member'>ats</span></a><span class='Delimiter'>[</span><a href="localtime.c.html#LN1007"><span class='Ref_To_Local'>timecnt</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="localtime.c.html#LN1008"><span class='Ref_To_Local'>janfirst</span></a><span class='Delimiter'>; 
</span>                    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="localtime.c.html#LN96"><span class='Ref_to_Proto'>increment_overflow_time</span></a> 
                        <span class='Parentheses'>(</span><span class='Operator'>&</span><a href="localtime.c.html#LN896"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN48"><span class='Ref_to_Member'>ats</span></a><span class='Delimiter'>[</span><a href="localtime.c.html#LN1007"><span class='Ref_To_Local'>timecnt</span></a><span class='Delimiter'>], 
</span>                         <a href="localtime.c.html#LN1009"><span class='Ref_To_Local'>janoffset</span></a> <span class='Operator'>+ </span><a href="localtime.c.html#LN1050"><span class='Ref_To_Local'>starttime</span></a><span class='Parentheses'>))</span> 
                        <a href="localtime.c.html#LN896"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN49"><span class='Ref_to_Member'>types</span></a><span class='Delimiter'>[</span><a href="localtime.c.html#LN1007"><span class='Ref_To_Local'>timecnt</span></a><span class='Operator'>++</span><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="localtime.c.html#LN1055"><span class='Ref_To_Local'>reversed</span></a><span class='Delimiter'>; 
</span>                    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN1009"><span class='Ref_To_Local'>janoffset</span></a><span class='Parentheses'>) 
</span>                        <a href="localtime.c.html#LN896"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN54"><span class='Ref_to_Member'>defaulttype</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN1055"><span class='Ref_To_Local'>reversed</span></a><span class='Delimiter'>; 
</span>                    <a href="localtime.c.html#LN896"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN48"><span class='Ref_to_Member'>ats</span></a><span class='Delimiter'>[</span><a href="localtime.c.html#LN1007"><span class='Ref_To_Local'>timecnt</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="localtime.c.html#LN1008"><span class='Ref_To_Local'>janfirst</span></a><span class='Delimiter'>; 
</span>                    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="localtime.c.html#LN96"><span class='Ref_to_Proto'>increment_overflow_time</span></a> 
                        <span class='Parentheses'>(</span><span class='Operator'>&</span><a href="localtime.c.html#LN896"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN48"><span class='Ref_to_Member'>ats</span></a><span class='Delimiter'>[</span><a href="localtime.c.html#LN1007"><span class='Ref_To_Local'>timecnt</span></a><span class='Delimiter'>], 
</span>                         <a href="localtime.c.html#LN1009"><span class='Ref_To_Local'>janoffset</span></a> <span class='Operator'>+ </span><a href="localtime.c.html#LN1051"><span class='Ref_To_Local'>endtime</span></a><span class='Parentheses'>))</span> 
                    <span class='Delimiter'>{ 
</span>                        <a href="localtime.c.html#LN896"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN49"><span class='Ref_to_Member'>types</span></a><span class='Delimiter'>[</span><a href="localtime.c.html#LN1007"><span class='Ref_To_Local'>timecnt</span></a><span class='Operator'>++</span><span class='Delimiter'>] </span><span class='Operator'>= !</span><a href="localtime.c.html#LN1055"><span class='Ref_To_Local'>reversed</span></a><span class='Delimiter'>; 
</span>                        <a href="localtime.c.html#LN1006"><span class='Ref_To_Local'>yearlim</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN1005"><span class='Ref_To_Local'>year</span></a> <span class='Operator'>+ </span><a href="private.h.html#LN104"><span class='Ref_to_Const'>YEARSPERREPEAT</span></a> <span class='Operator'>+ </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>                    <span class='Delimiter'>} 
</span>                    <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN1009"><span class='Ref_To_Local'>janoffset</span></a><span class='Parentheses'>) 
</span>                        <a href="localtime.c.html#LN896"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN54"><span class='Ref_to_Member'>defaulttype</span></a> <span class='Operator'>= !</span><a href="localtime.c.html#LN1055"><span class='Ref_To_Local'>reversed</span></a><span class='Delimiter'>; 
</span>                <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if reversed||(starttime&LT;... &raquo; </span> 
                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN96"><span class='Ref_to_Proto'>increment_overflow_time</span></a> 
                    <span class='Parentheses'>(</span><span class='Operator'>&</span><a href="localtime.c.html#LN1008"><span class='Ref_To_Local'>janfirst</span></a><span class='Delimiter'>, </span><a href="localtime.c.html#LN1009"><span class='Ref_To_Local'>janoffset</span></a> <span class='Operator'>+ </span><a href="localtime.c.html#LN1053"><span class='Ref_To_Local'>yearsecs</span></a><span class='Parentheses'>))</span> 
                    <span class='Control'>break</span><span class='Delimiter'>; 
</span>                <a href="localtime.c.html#LN1009"><span class='Ref_To_Local'>janoffset</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end for year=yearbeg;year&LT;yea... &raquo; </span> 
            <a href="localtime.c.html#LN896"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN43"><span class='Ref_to_Member'>timecnt</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN1007"><span class='Ref_To_Local'>timecnt</span></a><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="localtime.c.html#LN1007"><span class='Ref_To_Local'>timecnt</span></a><span class='Parentheses'>) 
</span>                <a href="localtime.c.html#LN896"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN44"><span class='Ref_to_Member'>typecnt</span></a> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>;</span>    <span class='Comment_Single_Line'>/* Perpetual DST.  */ 
</span>            <span class='Control'>else</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="private.h.html#LN104"><span class='Ref_to_Const'>YEARSPERREPEAT</span></a> <span class='Operator'>&LT; </span><a href="localtime.c.html#LN1005"><span class='Ref_To_Local'>year</span></a> <span class='Operator'>- </span><a href="localtime.c.html#LN1010"><span class='Ref_To_Local'>yearbeg</span></a><span class='Parentheses'>) 
</span>                <a href="localtime.c.html#LN896"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN46"><span class='Ref_to_Member'>goback</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN896"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN47"><span class='Ref_to_Member'>goahead</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if *name==','||*name==';... &raquo; </span> 
        <span class='Control'>else</span> 
        <span class='Delimiter'>{ 
</span><a name="LN1103"></a>            <a href="../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>       <span class='Declare_Local'>theirstdoffset</span><span class='Delimiter'>; 
</span><a name="LN1104"></a>            <a href="../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>       <span class='Declare_Local'>theirdstoffset</span><span class='Delimiter'>; 
</span><a name="LN1105"></a>            <a href="../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a>       <span class='Declare_Local'>theiroffset</span><span class='Delimiter'>; 
</span><a name="LN1106"></a>            <span class='Keyword'>bool</span>        <span class='Declare_Local'>isdst</span><span class='Delimiter'>; 
</span><a name="LN1107"></a>            <span class='Keyword'>int</span>         <span class='Declare_Local'>i</span><span class='Delimiter'>; 
</span><a name="LN1108"></a>            <span class='Keyword'>int</span>         <span class='Declare_Local'>j</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="localtime.c.html#LN896"><span class='Ref_to_Parameter'>name</span></a> <span class='Operator'>!= </span><span class='String'>'\0'</span><span class='Parentheses'>) 
</span>                <span class='Control'>return</span> <span class='Boolean'>false</span><span class='Delimiter'>; 
</span> 
            <span class='Comment_Multi_Line'>/* 
             * Initial values of theirstdoffset and theirdstoffset. 
             */ 
</span>            <a href="localtime.c.html#LN1103"><span class='Ref_To_Local'>theirstdoffset</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>            <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN1107"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="localtime.c.html#LN1107"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="localtime.c.html#LN896"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN43"><span class='Ref_to_Member'>timecnt</span></a><span class='Delimiter'>; </span><span class='Operator'>++</span><a href="localtime.c.html#LN1107"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <a href="localtime.c.html#LN1108"><span class='Ref_To_Local'>j</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN896"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN49"><span class='Ref_to_Member'>types</span></a><span class='Delimiter'>[</span><a href="localtime.c.html#LN1107"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]; 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="localtime.c.html#LN896"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN50"><span class='Ref_to_Member'>ttis</span></a><span class='Delimiter'>[</span><a href="localtime.c.html#LN1108"><span class='Ref_To_Local'>j</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="pgtz.h.html#LN28"><span class='Ref_to_Member'>tt_isdst</span></a><span class='Parentheses'>) 
</span>                <span class='Delimiter'>{ 
</span>                    <a href="localtime.c.html#LN1103"><span class='Ref_To_Local'>theirstdoffset</span></a> <span class='Operator'>= 
</span>                        <span class='Operator'>-</span><a href="localtime.c.html#LN896"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN50"><span class='Ref_to_Member'>ttis</span></a><span class='Delimiter'>[</span><a href="localtime.c.html#LN1108"><span class='Ref_To_Local'>j</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="pgtz.h.html#LN27"><span class='Ref_to_Member'>tt_gmtoff</span></a><span class='Delimiter'>; 
</span>                    <span class='Control'>break</span><span class='Delimiter'>; 
</span>                <span class='Delimiter'>} 
</span>            <span class='Delimiter'>} 
</span>            <a href="localtime.c.html#LN1104"><span class='Ref_To_Local'>theirdstoffset</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>            <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN1107"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="localtime.c.html#LN1107"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="localtime.c.html#LN896"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN43"><span class='Ref_to_Member'>timecnt</span></a><span class='Delimiter'>; </span><span class='Operator'>++</span><a href="localtime.c.html#LN1107"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <a href="localtime.c.html#LN1108"><span class='Ref_To_Local'>j</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN896"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN49"><span class='Ref_to_Member'>types</span></a><span class='Delimiter'>[</span><a href="localtime.c.html#LN1107"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]; 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN896"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN50"><span class='Ref_to_Member'>ttis</span></a><span class='Delimiter'>[</span><a href="localtime.c.html#LN1108"><span class='Ref_To_Local'>j</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="pgtz.h.html#LN28"><span class='Ref_to_Member'>tt_isdst</span></a><span class='Parentheses'>) 
</span>                <span class='Delimiter'>{ 
</span>                    <a href="localtime.c.html#LN1104"><span class='Ref_To_Local'>theirdstoffset</span></a> <span class='Operator'>= 
</span>                        <span class='Operator'>-</span><a href="localtime.c.html#LN896"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN50"><span class='Ref_to_Member'>ttis</span></a><span class='Delimiter'>[</span><a href="localtime.c.html#LN1108"><span class='Ref_To_Local'>j</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="pgtz.h.html#LN27"><span class='Ref_to_Member'>tt_gmtoff</span></a><span class='Delimiter'>; 
</span>                    <span class='Control'>break</span><span class='Delimiter'>; 
</span>                <span class='Delimiter'>} 
</span>            <span class='Delimiter'>} 
</span> 
            <span class='Comment_Multi_Line'>/* 
             * Initially we're assumed to be in standard time. 
             */ 
</span>            <a href="localtime.c.html#LN1106"><span class='Ref_To_Local'>isdst</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>            <a href="localtime.c.html#LN1105"><span class='Ref_To_Local'>theiroffset</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN1103"><span class='Ref_To_Local'>theirstdoffset</span></a><span class='Delimiter'>; 
</span> 
            <span class='Comment_Multi_Line'>/* 
             * Now juggle transition times and types tracking offsets as you 
             * do. 
             */ 
</span>            <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN1107"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="localtime.c.html#LN1107"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="localtime.c.html#LN896"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN43"><span class='Ref_to_Member'>timecnt</span></a><span class='Delimiter'>; </span><span class='Operator'>++</span><a href="localtime.c.html#LN1107"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <a href="localtime.c.html#LN1108"><span class='Ref_To_Local'>j</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN896"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN49"><span class='Ref_to_Member'>types</span></a><span class='Delimiter'>[</span><a href="localtime.c.html#LN1107"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]; 
</span>                <a href="localtime.c.html#LN896"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN49"><span class='Ref_to_Member'>types</span></a><span class='Delimiter'>[</span><a href="localtime.c.html#LN1107"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>] </span><span class='Operator'>= </span><a href="localtime.c.html#LN896"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN50"><span class='Ref_to_Member'>ttis</span></a><span class='Delimiter'>[</span><a href="localtime.c.html#LN1108"><span class='Ref_To_Local'>j</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="pgtz.h.html#LN28"><span class='Ref_to_Member'>tt_isdst</span></a><span class='Delimiter'>; 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN896"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN50"><span class='Ref_to_Member'>ttis</span></a><span class='Delimiter'>[</span><a href="localtime.c.html#LN1108"><span class='Ref_To_Local'>j</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="pgtz.h.html#LN31"><span class='Ref_to_Member'>tt_ttisgmt</span></a><span class='Parentheses'>) 
</span>                <span class='Delimiter'>{ 
</span>                    <span class='Comment_Multi_Line'>/* No adjustment to transition time */ 
</span>                <span class='Delimiter'>} 
</span>                <span class='Control'>else</span> 
                <span class='Delimiter'>{ 
</span>                    <span class='Comment_Multi_Line'>/* 
                     * If summer time is in effect, and the transition time 
                     * was not specified as standard time, add the summer time 
                     * offset to the transition time; otherwise, add the 
                     * standard time offset to the transition time. 
                     */ 
</span> 
                    <span class='Comment_Multi_Line'>/* 
                     * Transitions from DST to DDST will effectively disappear 
                     * since POSIX provides for only one DST offset. 
                     */ 
</span>                    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN1106"><span class='Ref_To_Local'>isdst</span></a> <span class='Operator'>&& !</span><a href="localtime.c.html#LN896"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN50"><span class='Ref_to_Member'>ttis</span></a><span class='Delimiter'>[</span><a href="localtime.c.html#LN1108"><span class='Ref_To_Local'>j</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="pgtz.h.html#LN30"><span class='Ref_to_Member'>tt_ttisstd</span></a><span class='Parentheses'>) 
</span>                    <span class='Delimiter'>{ 
</span>                        <a href="localtime.c.html#LN896"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN48"><span class='Ref_to_Member'>ats</span></a><span class='Delimiter'>[</span><a href="localtime.c.html#LN1107"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>] </span><span class='Operator'>+= </span><a href="localtime.c.html#LN904"><span class='Ref_To_Local'>dstoffset</span></a> <span class='Operator'>- 
</span>                            <a href="localtime.c.html#LN1104"><span class='Ref_To_Local'>theirdstoffset</span></a><span class='Delimiter'>; 
</span>                    <span class='Delimiter'>} 
</span>                    <span class='Control'>else</span> 
                    <span class='Delimiter'>{ 
</span>                        <a href="localtime.c.html#LN896"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN48"><span class='Ref_to_Member'>ats</span></a><span class='Delimiter'>[</span><a href="localtime.c.html#LN1107"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>] </span><span class='Operator'>+= </span><a href="localtime.c.html#LN903"><span class='Ref_To_Local'>stdoffset</span></a> <span class='Operator'>- 
</span>                            <a href="localtime.c.html#LN1103"><span class='Ref_To_Local'>theirstdoffset</span></a><span class='Delimiter'>; 
</span>                    <span class='Delimiter'>} 
</span>                <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end else &raquo; </span> 
                <a href="localtime.c.html#LN1105"><span class='Ref_To_Local'>theiroffset</span></a> <span class='Operator'>= -</span><a href="localtime.c.html#LN896"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN50"><span class='Ref_to_Member'>ttis</span></a><span class='Delimiter'>[</span><a href="localtime.c.html#LN1108"><span class='Ref_To_Local'>j</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="pgtz.h.html#LN27"><span class='Ref_to_Member'>tt_gmtoff</span></a><span class='Delimiter'>; 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN896"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN50"><span class='Ref_to_Member'>ttis</span></a><span class='Delimiter'>[</span><a href="localtime.c.html#LN1108"><span class='Ref_To_Local'>j</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="pgtz.h.html#LN28"><span class='Ref_to_Member'>tt_isdst</span></a><span class='Parentheses'>) 
</span>                    <a href="localtime.c.html#LN1104"><span class='Ref_To_Local'>theirdstoffset</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN1105"><span class='Ref_To_Local'>theiroffset</span></a><span class='Delimiter'>; 
</span>                <span class='Control'>else</span> 
                    <a href="localtime.c.html#LN1103"><span class='Ref_To_Local'>theirstdoffset</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN1105"><span class='Ref_To_Local'>theiroffset</span></a><span class='Delimiter'>; 
</span>            <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end for i=0;i&LT;sp-&GT;timecnt;++i &raquo; </span> 
 
            <span class='Comment_Multi_Line'>/* 
             * Finally, fill in ttis. 
             */ 
</span>            <a href="localtime.c.html#LN113"><span class='Ref_to_Func'>init_ttinfo</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="localtime.c.html#LN896"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN50"><span class='Ref_to_Member'>ttis</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>], </span><span class='Operator'>-</span><a href="localtime.c.html#LN903"><span class='Ref_To_Local'>stdoffset</span></a><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="localtime.c.html#LN113"><span class='Ref_to_Func'>init_ttinfo</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="localtime.c.html#LN896"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN50"><span class='Ref_to_Member'>ttis</span></a><span class='Delimiter'>[</span><span class='Number'>1</span><span class='Delimiter'>], </span><span class='Operator'>-</span><a href="localtime.c.html#LN904"><span class='Ref_To_Local'>dstoffset</span></a><span class='Delimiter'>, </span><span class='Boolean'>true</span><span class='Delimiter'>, </span><a href="localtime.c.html#LN900"><span class='Ref_To_Local'>stdlen</span></a> <span class='Operator'>+ </span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="localtime.c.html#LN896"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN44"><span class='Ref_to_Member'>typecnt</span></a> <span class='Operator'>= </span><span class='Number'>2</span><span class='Delimiter'>; 
</span>            <a href="localtime.c.html#LN896"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN54"><span class='Ref_to_Member'>defaulttype</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end else &raquo; </span> 
    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if *name!='\0' &raquo; </span> 
    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <a href="localtime.c.html#LN901"><span class='Ref_To_Local'>dstlen</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>        <a href="localtime.c.html#LN896"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN44"><span class='Ref_to_Member'>typecnt</span></a> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>;</span>        <span class='Comment_Single_Line'>/* only standard time */ 
</span>        <a href="localtime.c.html#LN896"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN43"><span class='Ref_to_Member'>timecnt</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>        <a href="localtime.c.html#LN113"><span class='Ref_to_Func'>init_ttinfo</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="localtime.c.html#LN896"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN50"><span class='Ref_to_Member'>ttis</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>], </span><span class='Operator'>-</span><a href="localtime.c.html#LN903"><span class='Ref_To_Local'>stdoffset</span></a><span class='Delimiter'>, </span><span class='Boolean'>false</span><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="localtime.c.html#LN896"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN54"><span class='Ref_to_Member'>defaulttype</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <a href="localtime.c.html#LN896"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN45"><span class='Ref_to_Member'>charcnt</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN902"><span class='Ref_To_Local'>charcnt</span></a><span class='Delimiter'>; 
</span>    <a href="localtime.c.html#LN905"><span class='Ref_To_Local'>cp</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN896"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN51"><span class='Ref_to_Member'>chars</span></a><span class='Delimiter'>; 
</span>    memcpy<span class='Parentheses'>(</span><a href="localtime.c.html#LN905"><span class='Ref_To_Local'>cp</span></a><span class='Delimiter'>, </span><a href="localtime.c.html#LN898"><span class='Ref_To_Local'>stdname</span></a><span class='Delimiter'>, </span><a href="localtime.c.html#LN900"><span class='Ref_To_Local'>stdlen</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="localtime.c.html#LN905"><span class='Ref_To_Local'>cp</span></a> <span class='Operator'>+= </span><a href="localtime.c.html#LN900"><span class='Ref_To_Local'>stdlen</span></a><span class='Delimiter'>; 
</span>    <span class='Operator'>*</span><a href="localtime.c.html#LN905"><span class='Ref_To_Local'>cp</span></a><span class='Operator'>++ = </span><span class='String'>'\0'</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN901"><span class='Ref_To_Local'>dstlen</span></a> <span class='Operator'>!= </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        memcpy<span class='Parentheses'>(</span><a href="localtime.c.html#LN905"><span class='Ref_To_Local'>cp</span></a><span class='Delimiter'>, </span><a href="localtime.c.html#LN899"><span class='Ref_To_Local'>dstname</span></a><span class='Delimiter'>, </span><a href="localtime.c.html#LN901"><span class='Ref_To_Local'>dstlen</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Operator'>*</span><span class='Parentheses'>(</span><a href="localtime.c.html#LN905"><span class='Ref_To_Local'>cp</span></a> <span class='Operator'>+ </span><a href="localtime.c.html#LN901"><span class='Ref_To_Local'>dstlen</span></a><span class='Parentheses'>) </span><span class='Operator'>= </span><span class='String'>'\0'</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>return</span> <span class='Boolean'>true</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end tzparse &raquo; </span> 
 
<span class='Keyword'>static void 
</span><a name="LN1219"></a><span class='Declare_Function'>gmtload</span><span class='Parentheses'>(</span><span class='Control'>struct</span> <a href="pgtz.h.html#LN40"><span class='Ref_to_Struct'>state</span></a> <span class='Operator'>* </span><span class='Declare_Parameter'>sp</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="pgtz.h.html#LN70"><span class='Ref_to_Proto'>tzload</span></a><span class='Parentheses'>(</span><a href="localtime.c.html#LN50"><span class='Ref_to_Global_Var'>gmt</span></a><span class='Delimiter'>, </span><span class='Null_Value'>NULL</span><span class='Delimiter'>, </span><a href="localtime.c.html#LN1219"><span class='Ref_to_Parameter'>sp</span></a><span class='Delimiter'>, </span><span class='Boolean'>true</span><span class='Parentheses'>) </span><span class='Operator'>!= </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
        <a href="pgtz.h.html#LN72"><span class='Ref_to_Proto'>tzparse</span></a><span class='Parentheses'>(</span><a href="localtime.c.html#LN50"><span class='Ref_to_Global_Var'>gmt</span></a><span class='Delimiter'>, </span><a href="localtime.c.html#LN1219"><span class='Ref_to_Parameter'>sp</span></a><span class='Delimiter'>, </span><span class='Boolean'>true</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
 
<span class='Comment_Multi_Line'>/* 
 * The easy way to behave "as if no library function calls" localtime 
 * is to not call it, so we drop its guts into "localsub", which can be 
 * freely called. (And no, the PANS doesn't require the above behavior, 
 * but it *is* desirable.) 
 */ 
</span><span class='Keyword'>static </span><span class='Control'>struct</span> <a href="../include/pgtime.h.html#LN24"><span class='Ref_to_Struct'>pg_tm</span></a> <span class='Operator'>* 
</span><a name="LN1233"></a><span class='Declare_Function'>localsub</span><span class='Parentheses'>(</span><span class='Control'>struct</span> <a href="pgtz.h.html#LN40"><span class='Ref_to_Struct'>state</span></a> <span class='Keyword'>const </span><span class='Operator'>* </span><span class='Declare_Parameter'>sp</span><span class='Delimiter'>, </span><a href="../include/pgtime.h.html#LN22"><span class='Ref_to_Typedef'>pg_time_t</span></a> <span class='Keyword'>const </span><span class='Operator'>* </span><span class='Declare_Parameter'>timep</span><span class='Delimiter'>, 
</span><a name="LN1234"></a>         <span class='Control'>struct</span> <a href="../include/pgtime.h.html#LN24"><span class='Ref_to_Struct'>pg_tm</span></a> <span class='Operator'>* </span><span class='Declare_Parameter'>tmp</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1236"></a>    <span class='Keyword'>const </span><span class='Control'>struct</span> <a href="pgtz.h.html#LN25"><span class='Ref_to_Struct'>ttinfo</span></a> <span class='Operator'>*</span><span class='Declare_Local'>ttisp</span><span class='Delimiter'>; 
</span><a name="LN1237"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>i</span><span class='Delimiter'>; 
</span><a name="LN1238"></a>    <span class='Control'>struct</span> <a href="../include/pgtime.h.html#LN24"><span class='Ref_to_Struct'>pg_tm</span></a> <span class='Operator'>*</span><span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span><a name="LN1239"></a>    <span class='Keyword'>const </span><a href="../include/pgtime.h.html#LN22"><span class='Ref_to_Typedef'>pg_time_t</span></a> <span class='Declare_Local'>t</span> <span class='Operator'>= *</span><a href="localtime.c.html#LN1233"><span class='Ref_to_Parameter'>timep</span></a><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN1233"><span class='Ref_to_Parameter'>sp</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <a href="localtime.c.html#LN94"><span class='Ref_to_Proto'>gmtsub</span></a><span class='Parentheses'>(</span><a href="localtime.c.html#LN1233"><span class='Ref_to_Parameter'>timep</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Delimiter'>, </span><a href="localtime.c.html#LN1234"><span class='Ref_to_Parameter'>tmp</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="localtime.c.html#LN1233"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN46"><span class='Ref_to_Member'>goback</span></a> <span class='Operator'>&& </span><a href="localtime.c.html#LN1239"><span class='Ref_To_Local'>t</span></a> <span class='Operator'>&LT; </span><a href="localtime.c.html#LN1233"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN48"><span class='Ref_to_Member'>ats</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>]</span><span class='Parentheses'>) </span><span class='Operator'>|| 
</span>        <span class='Parentheses'>(</span><a href="localtime.c.html#LN1233"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN47"><span class='Ref_to_Member'>goahead</span></a> <span class='Operator'>&& </span><a href="localtime.c.html#LN1239"><span class='Ref_To_Local'>t</span></a> <span class='Operator'>&GT; </span><a href="localtime.c.html#LN1233"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN48"><span class='Ref_to_Member'>ats</span></a><span class='Delimiter'>[</span><a href="localtime.c.html#LN1233"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN43"><span class='Ref_to_Member'>timecnt</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>]</span><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span><a name="LN1246"></a>        <a href="../include/pgtime.h.html#LN22"><span class='Ref_to_Typedef'>pg_time_t</span></a>   <span class='Declare_Local'>newt</span> <span class='Operator'>= </span><a href="localtime.c.html#LN1239"><span class='Ref_To_Local'>t</span></a><span class='Delimiter'>; 
</span><a name="LN1247"></a>        <a href="../include/pgtime.h.html#LN22"><span class='Ref_to_Typedef'>pg_time_t</span></a>   <span class='Declare_Local'>seconds</span><span class='Delimiter'>; 
</span><a name="LN1248"></a>        <a href="../include/pgtime.h.html#LN22"><span class='Ref_to_Typedef'>pg_time_t</span></a>   <span class='Declare_Local'>years</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN1239"><span class='Ref_To_Local'>t</span></a> <span class='Operator'>&LT; </span><a href="localtime.c.html#LN1233"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN48"><span class='Ref_to_Member'>ats</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>]</span><span class='Parentheses'>) 
</span>            <a href="localtime.c.html#LN1247"><span class='Ref_To_Local'>seconds</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN1233"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN48"><span class='Ref_to_Member'>ats</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>] </span><span class='Operator'>- </span><a href="localtime.c.html#LN1239"><span class='Ref_To_Local'>t</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> 
            <a href="localtime.c.html#LN1247"><span class='Ref_To_Local'>seconds</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN1239"><span class='Ref_To_Local'>t</span></a> <span class='Operator'>- </span><a href="localtime.c.html#LN1233"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN48"><span class='Ref_to_Member'>ats</span></a><span class='Delimiter'>[</span><a href="localtime.c.html#LN1233"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN43"><span class='Ref_to_Member'>timecnt</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>]; 
</span>        <span class='Operator'>--</span><a href="localtime.c.html#LN1247"><span class='Ref_To_Local'>seconds</span></a><span class='Delimiter'>; 
</span>        <a href="localtime.c.html#LN1248"><span class='Ref_To_Local'>years</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="localtime.c.html#LN1247"><span class='Ref_To_Local'>seconds</span></a> <span class='Operator'>/ </span><a href="private.h.html#LN164"><span class='Ref_to_Const'>SECSPERREPEAT</span></a> <span class='Operator'>+ </span><span class='Number'>1</span><span class='Parentheses'>) </span><span class='Operator'>* </span><a href="private.h.html#LN104"><span class='Ref_to_Const'>YEARSPERREPEAT</span></a><span class='Delimiter'>; 
</span>        <a href="localtime.c.html#LN1247"><span class='Ref_To_Local'>seconds</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN1248"><span class='Ref_To_Local'>years</span></a> <span class='Operator'>* </span><a href="private.h.html#LN163"><span class='Ref_to_Const'>AVGSECSPERYEAR</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN1239"><span class='Ref_To_Local'>t</span></a> <span class='Operator'>&LT; </span><a href="localtime.c.html#LN1233"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN48"><span class='Ref_to_Member'>ats</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>]</span><span class='Parentheses'>) 
</span>            <a href="localtime.c.html#LN1246"><span class='Ref_To_Local'>newt</span></a> <span class='Operator'>+= </span><a href="localtime.c.html#LN1247"><span class='Ref_To_Local'>seconds</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> 
            <a href="localtime.c.html#LN1246"><span class='Ref_To_Local'>newt</span></a> <span class='Operator'>-= </span><a href="localtime.c.html#LN1247"><span class='Ref_To_Local'>seconds</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN1246"><span class='Ref_To_Local'>newt</span></a> <span class='Operator'>&LT; </span><a href="localtime.c.html#LN1233"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN48"><span class='Ref_to_Member'>ats</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>] </span><span class='Operator'>|| 
</span>            <a href="localtime.c.html#LN1246"><span class='Ref_To_Local'>newt</span></a> <span class='Operator'>&GT; </span><a href="localtime.c.html#LN1233"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN48"><span class='Ref_to_Member'>ats</span></a><span class='Delimiter'>[</span><a href="localtime.c.html#LN1233"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN43"><span class='Ref_to_Member'>timecnt</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>]</span><span class='Parentheses'>) 
</span>            <span class='Control'>return</span> <span class='Null_Value'>NULL</span><span class='Delimiter'>;</span>        <span class='Comment_Single_Line'>/* "cannot happen" */ 
</span>        <a href="localtime.c.html#LN1238"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN1232"><span class='Ref_to_Func'>localsub</span></a><span class='Parentheses'>(</span><a href="localtime.c.html#LN1233"><span class='Ref_to_Parameter'>sp</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="localtime.c.html#LN1246"><span class='Ref_To_Local'>newt</span></a><span class='Delimiter'>, </span><a href="localtime.c.html#LN1234"><span class='Ref_to_Parameter'>tmp</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN1238"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span><a name="LN1267"></a>            <a href="../include/c.h.html#LN294"><span class='Ref_to_Typedef'>int64</span></a>       <span class='Declare_Local'>newy</span><span class='Delimiter'>; 
</span> 
            <a href="localtime.c.html#LN1267"><span class='Ref_To_Local'>newy</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN1238"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="../include/pgtime.h.html#LN31"><span class='Ref_to_Member'>tm_year</span></a><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN1239"><span class='Ref_To_Local'>t</span></a> <span class='Operator'>&LT; </span><a href="localtime.c.html#LN1233"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN48"><span class='Ref_to_Member'>ats</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>]</span><span class='Parentheses'>) 
</span>                <a href="localtime.c.html#LN1267"><span class='Ref_To_Local'>newy</span></a> <span class='Operator'>-= </span><a href="localtime.c.html#LN1248"><span class='Ref_To_Local'>years</span></a><span class='Delimiter'>; 
</span>            <span class='Control'>else</span> 
                <a href="localtime.c.html#LN1267"><span class='Ref_To_Local'>newy</span></a> <span class='Operator'>+= </span><a href="localtime.c.html#LN1248"><span class='Ref_To_Local'>years</span></a><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><span class='Parentheses'>(</span>INT_MIN <span class='Operator'>&LT;= </span><a href="localtime.c.html#LN1267"><span class='Ref_To_Local'>newy</span></a> <span class='Operator'>&& </span><a href="localtime.c.html#LN1267"><span class='Ref_To_Local'>newy</span></a> <span class='Operator'>&LT;= </span>INT_MAX<span class='Parentheses'>))</span> 
                <span class='Control'>return</span> <span class='Null_Value'>NULL</span><span class='Delimiter'>; 
</span>            <a href="localtime.c.html#LN1238"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="../include/pgtime.h.html#LN31"><span class='Ref_to_Member'>tm_year</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN1267"><span class='Ref_To_Local'>newy</span></a><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>return</span> <a href="localtime.c.html#LN1238"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if (sp-&GT;goback&&t&LT;sp-&GT;at... &raquo; </span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN1233"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN43"><span class='Ref_to_Member'>timecnt</span></a> <span class='Operator'>== </span><span class='Number'>0</span> <span class='Operator'>|| </span><a href="localtime.c.html#LN1239"><span class='Ref_To_Local'>t</span></a> <span class='Operator'>&LT; </span><a href="localtime.c.html#LN1233"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN48"><span class='Ref_to_Member'>ats</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>]</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="localtime.c.html#LN1237"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN1233"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN54"><span class='Ref_to_Member'>defaulttype</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span><a name="LN1286"></a>        <span class='Keyword'>int</span>         <span class='Declare_Local'>lo</span> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span><a name="LN1287"></a>        <span class='Keyword'>int</span>         <span class='Declare_Local'>hi</span> <span class='Operator'>= </span><a href="localtime.c.html#LN1233"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN43"><span class='Ref_to_Member'>timecnt</span></a><span class='Delimiter'>; 
</span> 
        <span class='Control'>while</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN1286"><span class='Ref_To_Local'>lo</span></a> <span class='Operator'>&LT; </span><a href="localtime.c.html#LN1287"><span class='Ref_To_Local'>hi</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span><a name="LN1291"></a>            <span class='Keyword'>int</span>         <span class='Declare_Local'>mid</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="localtime.c.html#LN1286"><span class='Ref_To_Local'>lo</span></a> <span class='Operator'>+ </span><a href="localtime.c.html#LN1287"><span class='Ref_To_Local'>hi</span></a><span class='Parentheses'>) </span><span class='Operator'>&GT;&GT; </span><span class='Number'>1</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN1239"><span class='Ref_To_Local'>t</span></a> <span class='Operator'>&LT; </span><a href="localtime.c.html#LN1233"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN48"><span class='Ref_to_Member'>ats</span></a><span class='Delimiter'>[</span><a href="localtime.c.html#LN1291"><span class='Ref_To_Local'>mid</span></a><span class='Delimiter'>]</span><span class='Parentheses'>) 
</span>                <a href="localtime.c.html#LN1287"><span class='Ref_To_Local'>hi</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN1291"><span class='Ref_To_Local'>mid</span></a><span class='Delimiter'>; 
</span>            <span class='Control'>else</span> 
                <a href="localtime.c.html#LN1286"><span class='Ref_To_Local'>lo</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN1291"><span class='Ref_To_Local'>mid</span></a> <span class='Operator'>+ </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <a href="localtime.c.html#LN1237"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Keyword'>int</span><span class='Parentheses'>) </span><a href="localtime.c.html#LN1233"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN49"><span class='Ref_to_Member'>types</span></a><span class='Delimiter'>[</span><a href="localtime.c.html#LN1286"><span class='Ref_To_Local'>lo</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>]; 
</span>    <span class='Delimiter'>} 
</span>    <a href="localtime.c.html#LN1236"><span class='Ref_To_Local'>ttisp</span></a> <span class='Operator'>= &</span><a href="localtime.c.html#LN1233"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN50"><span class='Ref_to_Member'>ttis</span></a><span class='Delimiter'>[</span><a href="localtime.c.html#LN1237"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]; 
</span> 
    <a href="localtime.c.html#LN1238"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN97"><span class='Ref_to_Proto'>timesub</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="localtime.c.html#LN1239"><span class='Ref_To_Local'>t</span></a><span class='Delimiter'>, </span><a href="localtime.c.html#LN1236"><span class='Ref_To_Local'>ttisp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN27"><span class='Ref_to_Member'>tt_gmtoff</span></a><span class='Delimiter'>, </span><a href="localtime.c.html#LN1233"><span class='Ref_to_Parameter'>sp</span></a><span class='Delimiter'>, </span><a href="localtime.c.html#LN1234"><span class='Ref_to_Parameter'>tmp</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN1238"><span class='Ref_To_Local'>result</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="localtime.c.html#LN1238"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="../include/pgtime.h.html#LN34"><span class='Ref_to_Member'>tm_isdst</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN1236"><span class='Ref_To_Local'>ttisp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN28"><span class='Ref_to_Member'>tt_isdst</span></a><span class='Delimiter'>; 
</span>        <a href="localtime.c.html#LN1238"><span class='Ref_To_Local'>result</span></a><span class='Operator'>-&GT;</span><a href="../include/pgtime.h.html#LN36"><span class='Ref_to_Member'>tm_zone</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Keyword'>char </span><span class='Operator'>*</span><span class='Parentheses'>) </span><span class='Operator'>&</span><a href="localtime.c.html#LN1233"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN51"><span class='Ref_to_Member'>chars</span></a><span class='Delimiter'>[</span><a href="localtime.c.html#LN1236"><span class='Ref_To_Local'>ttisp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN29"><span class='Ref_to_Member'>tt_abbrind</span></a><span class='Delimiter'>]; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>return</span> <a href="localtime.c.html#LN1238"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end localsub &raquo; </span> 
 
 
<span class='Control'>struct</span> <a href="../include/pgtime.h.html#LN24"><span class='Ref_to_Struct'>pg_tm</span></a> <span class='Operator'>* 
</span><a name="LN1313"></a><span class='Declare_Function'>pg_localtime</span><span class='Parentheses'>(</span><span class='Keyword'>const </span><a href="../include/pgtime.h.html#LN22"><span class='Ref_to_Typedef'>pg_time_t</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>timep</span><span class='Delimiter'>, </span><span class='Keyword'>const </span><a href="pgtz.h.html#LN58"><span class='Ref_to_Struct'>pg_tz</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>tz</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>return</span> <a href="localtime.c.html#LN1232"><span class='Ref_to_Func'>localsub</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="localtime.c.html#LN1313"><span class='Ref_to_Parameter'>tz</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN62"><span class='Ref_to_Member'>state</span></a><span class='Delimiter'>, </span><a href="localtime.c.html#LN1313"><span class='Ref_to_Parameter'>timep</span></a><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="localtime.c.html#LN110"><span class='Ref_to_Global_Var'>tm</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
 
<span class='Comment_Multi_Line'>/* 
 * gmtsub is to gmtime as localsub is to localtime. 
 * 
 * Except we have a private "struct state" for GMT, so no sp is passed in. 
 */ 
</span><span class='Keyword'>static </span><span class='Control'>struct</span> <a href="../include/pgtime.h.html#LN24"><span class='Ref_to_Struct'>pg_tm</span></a> <span class='Operator'>* 
</span><a name="LN1325"></a><span class='Declare_Function'>gmtsub</span><span class='Parentheses'>(</span><a href="../include/pgtime.h.html#LN22"><span class='Ref_to_Typedef'>pg_time_t</span></a> <span class='Keyword'>const </span><span class='Operator'>* </span><span class='Declare_Parameter'>timep</span><span class='Delimiter'>, </span><a href="../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a> <span class='Declare_Parameter'>offset</span><span class='Delimiter'>, </span><span class='Control'>struct</span> <a href="../include/pgtime.h.html#LN24"><span class='Ref_to_Struct'>pg_tm</span></a> <span class='Operator'>* </span><span class='Declare_Parameter'>tmp</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1327"></a>    <span class='Control'>struct</span> <a href="../include/pgtime.h.html#LN24"><span class='Ref_to_Struct'>pg_tm</span></a> <span class='Operator'>*</span><span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* GMT timezone state data is kept here */ 
</span><a name="LN1330"></a>    <span class='Keyword'>static </span><span class='Control'>struct</span> <a href="pgtz.h.html#LN40"><span class='Ref_to_Struct'>state</span></a> <span class='Declare_Local'>gmtmem</span><span class='Delimiter'>; 
</span><a name="LN1331"></a>    <span class='Keyword'>static bool </span><span class='Declare_Local'>gmt_is_set</span> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span><a name="LN1332"></a><span class='Keyword'>#define </span><span class='Declare_Constant'>gmtptr</span>      <span class='Parentheses'>(</span><span class='Operator'>&</span><a href="localtime.c.html#LN1330"><span class='Ref_To_Local'>gmtmem</span></a><span class='Parentheses'>) 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="localtime.c.html#LN1331"><span class='Ref_To_Local'>gmt_is_set</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="localtime.c.html#LN1331"><span class='Ref_To_Local'>gmt_is_set</span></a> <span class='Operator'>= </span><span class='Boolean'>true</span><span class='Delimiter'>; 
</span>        <a href="localtime.c.html#LN1218"><span class='Ref_to_Func'>gmtload</span></a><span class='Parentheses'>(</span><a href="localtime.c.html#LN1332"><span class='Ref_to_Const'>gmtptr</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <a href="localtime.c.html#LN1327"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN97"><span class='Ref_to_Proto'>timesub</span></a><span class='Parentheses'>(</span><a href="localtime.c.html#LN1325"><span class='Ref_to_Parameter'>timep</span></a><span class='Delimiter'>, </span><a href="localtime.c.html#LN1325"><span class='Ref_to_Parameter'>offset</span></a><span class='Delimiter'>, </span><a href="localtime.c.html#LN1332"><span class='Ref_to_Const'>gmtptr</span></a><span class='Delimiter'>, </span><a href="localtime.c.html#LN1325"><span class='Ref_to_Parameter'>tmp</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Could get fancy here and deliver something such as "+xx" or "-xx" if 
     * offset is non-zero, but this is no time for a treasure hunt. 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN1325"><span class='Ref_to_Parameter'>offset</span></a> <span class='Operator'>!= </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>        <a href="localtime.c.html#LN1325"><span class='Ref_to_Parameter'>tmp</span></a><span class='Operator'>-&GT;</span><a href="../include/pgtime.h.html#LN36"><span class='Ref_to_Member'>tm_zone</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN48"><span class='Ref_to_Global_Var'>wildabbr</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>else</span> 
        <a href="localtime.c.html#LN1325"><span class='Ref_to_Parameter'>tmp</span></a><span class='Operator'>-&GT;</span><a href="../include/pgtime.h.html#LN36"><span class='Ref_to_Member'>tm_zone</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN1332"><span class='Ref_to_Const'>gmtptr</span></a><span class='Operator'>-&GT;</span>chars<span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <a href="localtime.c.html#LN1327"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end gmtsub &raquo; </span> 
 
<span class='Control'>struct</span> <a href="../include/pgtime.h.html#LN24"><span class='Ref_to_Struct'>pg_tm</span></a> <span class='Operator'>* 
</span><a name="LN1354"></a><span class='Declare_Function'>pg_gmtime</span><span class='Parentheses'>(</span><span class='Keyword'>const </span><a href="../include/pgtime.h.html#LN22"><span class='Ref_to_Typedef'>pg_time_t</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>timep</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>return</span> <a href="localtime.c.html#LN94"><span class='Ref_to_Proto'>gmtsub</span></a><span class='Parentheses'>(</span><a href="localtime.c.html#LN1354"><span class='Ref_to_Parameter'>timep</span></a><span class='Delimiter'>, </span><span class='Number'>0</span><span class='Delimiter'>, </span><span class='Operator'>&</span><a href="localtime.c.html#LN110"><span class='Ref_to_Global_Var'>tm</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * Return the number of leap years through the end of the given year 
 * where, to make the math easy, the answer for year zero is defined as zero. 
 */ 
</span><span class='Keyword'>static int 
</span><a name="LN1364"></a><span class='Declare_Function'>leaps_thru_end_of</span><span class='Parentheses'>(</span><span class='Keyword'>const int </span><span class='Declare_Parameter'>y</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>return</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN1364"><span class='Ref_to_Parameter'>y</span></a> <span class='Operator'>&GT;= </span><span class='Number'>0</span><span class='Parentheses'>) </span><span class='Operator'>? </span><span class='Parentheses'>(</span><a href="localtime.c.html#LN1364"><span class='Ref_to_Parameter'>y</span></a> <span class='Operator'>/ </span><span class='Number'>4</span> <span class='Operator'>- </span><a href="localtime.c.html#LN1364"><span class='Ref_to_Parameter'>y</span></a> <span class='Operator'>/ </span><span class='Number'>100</span> <span class='Operator'>+ </span><a href="localtime.c.html#LN1364"><span class='Ref_to_Parameter'>y</span></a> <span class='Operator'>/ </span><span class='Number'>400</span><span class='Parentheses'>) </span><span class='Operator'>: 
</span>        <span class='Operator'>-</span><span class='Parentheses'>(</span><a href="localtime.c.html#LN1363"><span class='Ref_to_Func'>leaps_thru_end_of</span></a><span class='Parentheses'>(</span><span class='Operator'>-</span><span class='Parentheses'>(</span><a href="localtime.c.html#LN1364"><span class='Ref_to_Parameter'>y</span></a> <span class='Operator'>+ </span><span class='Number'>1</span><span class='Parentheses'>))</span> <span class='Operator'>+ </span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<span class='Keyword'>static </span><span class='Control'>struct</span> <a href="../include/pgtime.h.html#LN24"><span class='Ref_to_Struct'>pg_tm</span></a> <span class='Operator'>* 
</span><a name="LN1371"></a><span class='Declare_Function'>timesub</span><span class='Parentheses'>(</span><span class='Keyword'>const </span><a href="../include/pgtime.h.html#LN22"><span class='Ref_to_Typedef'>pg_time_t</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>timep</span><span class='Delimiter'>, </span><a href="../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a> <span class='Declare_Parameter'>offset</span><span class='Delimiter'>, 
</span><a name="LN1372"></a>        <span class='Keyword'>const </span><span class='Control'>struct</span> <a href="pgtz.h.html#LN40"><span class='Ref_to_Struct'>state</span></a> <span class='Operator'>* </span><span class='Declare_Parameter'>sp</span><span class='Delimiter'>, </span><span class='Control'>struct</span> <a href="../include/pgtime.h.html#LN24"><span class='Ref_to_Struct'>pg_tm</span></a> <span class='Operator'>* </span><span class='Declare_Parameter'>tmp</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1374"></a>    <span class='Keyword'>const </span><span class='Control'>struct</span> <a href="pgtz.h.html#LN34"><span class='Ref_to_Struct'>lsinfo</span></a> <span class='Operator'>*</span><span class='Declare_Local'>lp</span><span class='Delimiter'>; 
</span><a name="LN1375"></a>    <a href="../include/pgtime.h.html#LN22"><span class='Ref_to_Typedef'>pg_time_t</span></a>   <span class='Declare_Local'>tdays</span><span class='Delimiter'>; 
</span><a name="LN1376"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>idays</span><span class='Delimiter'>;</span>          <span class='Comment_Single_Line'>/* unsigned would be so 2003 */ 
</span><a name="LN1377"></a>    <a href="../include/c.h.html#LN294"><span class='Ref_to_Typedef'>int64</span></a>       <span class='Declare_Local'>rem</span><span class='Delimiter'>; 
</span><a name="LN1378"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>y</span><span class='Delimiter'>; 
</span><a name="LN1379"></a>    <span class='Keyword'>const int</span>  <span class='Operator'>*</span><span class='Declare_Local'>ip</span><span class='Delimiter'>; 
</span><a name="LN1380"></a>    <a href="../include/c.h.html#LN294"><span class='Ref_to_Typedef'>int64</span></a>       <span class='Declare_Local'>corr</span><span class='Delimiter'>; 
</span><a name="LN1381"></a>    <span class='Keyword'>bool</span>        <span class='Declare_Local'>hit</span><span class='Delimiter'>; 
</span><a name="LN1382"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>i</span><span class='Delimiter'>; 
</span> 
    <a href="localtime.c.html#LN1380"><span class='Ref_To_Local'>corr</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <a href="localtime.c.html#LN1381"><span class='Ref_To_Local'>hit</span></a> <span class='Operator'>= </span><span class='Boolean'>false</span><span class='Delimiter'>; 
</span>    <a href="localtime.c.html#LN1382"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="localtime.c.html#LN1372"><span class='Ref_to_Parameter'>sp</span></a> <span class='Operator'>== </span><span class='Null_Value'>NULL</span><span class='Parentheses'>) </span><span class='Operator'>? </span><span class='Number'>0</span> <span class='Operator'>: </span><a href="localtime.c.html#LN1372"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN42"><span class='Ref_to_Member'>leapcnt</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>while</span> <span class='Parentheses'>(</span><span class='Operator'>--</span><a href="localtime.c.html#LN1382"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&GT;= </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="localtime.c.html#LN1374"><span class='Ref_To_Local'>lp</span></a> <span class='Operator'>= &</span><a href="localtime.c.html#LN1372"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN53"><span class='Ref_to_Member'>lsis</span></a><span class='Delimiter'>[</span><a href="localtime.c.html#LN1382"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="localtime.c.html#LN1371"><span class='Ref_to_Parameter'>timep</span></a> <span class='Operator'>&GT;= </span><a href="localtime.c.html#LN1374"><span class='Ref_To_Local'>lp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN36"><span class='Ref_to_Member'>ls_trans</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>*</span><a href="localtime.c.html#LN1371"><span class='Ref_to_Parameter'>timep</span></a> <span class='Operator'>== </span><a href="localtime.c.html#LN1374"><span class='Ref_To_Local'>lp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN36"><span class='Ref_to_Member'>ls_trans</span></a><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <a href="localtime.c.html#LN1381"><span class='Ref_To_Local'>hit</span></a> <span class='Operator'>= </span><span class='Parentheses'>((</span><a href="localtime.c.html#LN1382"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>== </span><span class='Number'>0</span> <span class='Operator'>&& </span><a href="localtime.c.html#LN1374"><span class='Ref_To_Local'>lp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN37"><span class='Ref_to_Member'>ls_corr</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span><span class='Parentheses'>) </span><span class='Operator'>|| 
</span>                       <a href="localtime.c.html#LN1374"><span class='Ref_To_Local'>lp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN37"><span class='Ref_to_Member'>ls_corr</span></a> <span class='Operator'>&GT; </span><a href="localtime.c.html#LN1372"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN53"><span class='Ref_to_Member'>lsis</span></a><span class='Delimiter'>[</span><a href="localtime.c.html#LN1382"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="pgtz.h.html#LN37"><span class='Ref_to_Member'>ls_corr</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN1381"><span class='Ref_To_Local'>hit</span></a><span class='Parentheses'>) 
</span>                    <span class='Control'>while</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN1382"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&GT; </span><span class='Number'>0</span> <span class='Operator'>&& 
</span>                           <a href="localtime.c.html#LN1372"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN53"><span class='Ref_to_Member'>lsis</span></a><span class='Delimiter'>[</span><a href="localtime.c.html#LN1382"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="pgtz.h.html#LN36"><span class='Ref_to_Member'>ls_trans</span></a> <span class='Operator'>== 
</span>                           <a href="localtime.c.html#LN1372"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN53"><span class='Ref_to_Member'>lsis</span></a><span class='Delimiter'>[</span><a href="localtime.c.html#LN1382"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="pgtz.h.html#LN36"><span class='Ref_to_Member'>ls_trans</span></a> <span class='Operator'>+ </span><span class='Number'>1</span> <span class='Operator'>&& 
</span>                           <a href="localtime.c.html#LN1372"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN53"><span class='Ref_to_Member'>lsis</span></a><span class='Delimiter'>[</span><a href="localtime.c.html#LN1382"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="pgtz.h.html#LN37"><span class='Ref_to_Member'>ls_corr</span></a> <span class='Operator'>== 
</span>                           <a href="localtime.c.html#LN1372"><span class='Ref_to_Parameter'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN53"><span class='Ref_to_Member'>lsis</span></a><span class='Delimiter'>[</span><a href="localtime.c.html#LN1382"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="pgtz.h.html#LN37"><span class='Ref_to_Member'>ls_corr</span></a> <span class='Operator'>+ </span><span class='Number'>1</span><span class='Parentheses'>) 
</span>                    <span class='Delimiter'>{ 
</span>                        <span class='Operator'>++</span><a href="localtime.c.html#LN1381"><span class='Ref_To_Local'>hit</span></a><span class='Delimiter'>; 
</span>                        <span class='Operator'>--</span><a href="localtime.c.html#LN1382"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>; 
</span>                    <span class='Delimiter'>} 
</span>            <span class='Delimiter'>} 
</span>            <a href="localtime.c.html#LN1380"><span class='Ref_To_Local'>corr</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN1374"><span class='Ref_To_Local'>lp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN37"><span class='Ref_to_Member'>ls_corr</span></a><span class='Delimiter'>; 
</span>            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if *timep&GT;=lp-&GT;ls_trans &raquo; </span> 
    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end while --i&GT;=0 &raquo; </span> 
    <a href="localtime.c.html#LN1378"><span class='Ref_To_Local'>y</span></a> <span class='Operator'>= </span><a href="private.h.html#LN139"><span class='Ref_to_Const'>EPOCH_YEAR</span></a><span class='Delimiter'>; 
</span>    <a href="localtime.c.html#LN1375"><span class='Ref_To_Local'>tdays</span></a> <span class='Operator'>= *</span><a href="localtime.c.html#LN1371"><span class='Ref_to_Parameter'>timep</span></a> <span class='Operator'>/ </span><a href="private.h.html#LN113"><span class='Ref_to_Const'>SECSPERDAY</span></a><span class='Delimiter'>; 
</span>    <a href="localtime.c.html#LN1377"><span class='Ref_To_Local'>rem</span></a> <span class='Operator'>= *</span><a href="localtime.c.html#LN1371"><span class='Ref_to_Parameter'>timep</span></a> <span class='Operator'>% </span><a href="private.h.html#LN113"><span class='Ref_to_Const'>SECSPERDAY</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>while</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN1375"><span class='Ref_To_Local'>tdays</span></a> <span class='Operator'>&LT; </span><span class='Number'>0</span> <span class='Operator'>|| </span><a href="localtime.c.html#LN1375"><span class='Ref_To_Local'>tdays</span></a> <span class='Operator'>&GT;= </span><a href="localtime.c.html#LN599"><span class='Ref_to_Global_Var'>year_lengths</span></a><span class='Delimiter'>[</span><a href="private.h.html#LN142"><span class='Ref_to_Macro'>isleap</span></a><span class='Parentheses'>(</span><a href="localtime.c.html#LN1378"><span class='Ref_To_Local'>y</span></a><span class='Parentheses'>)</span><span class='Delimiter'>]</span><span class='Parentheses'>)</span> 
    <span class='Delimiter'>{ 
</span><a name="LN1416"></a>        <span class='Keyword'>int</span>         <span class='Declare_Local'>newy</span><span class='Delimiter'>; 
</span><a name="LN1417"></a>        <a href="../include/pgtime.h.html#LN22"><span class='Ref_to_Typedef'>pg_time_t</span></a>   <span class='Declare_Local'>tdelta</span><span class='Delimiter'>; 
</span><a name="LN1418"></a>        <span class='Keyword'>int</span>         <span class='Declare_Local'>idelta</span><span class='Delimiter'>; 
</span><a name="LN1419"></a>        <span class='Keyword'>int</span>         <span class='Declare_Local'>leapdays</span><span class='Delimiter'>; 
</span> 
        <a href="localtime.c.html#LN1417"><span class='Ref_To_Local'>tdelta</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN1375"><span class='Ref_To_Local'>tdays</span></a> <span class='Operator'>/ </span><a href="private.h.html#LN111"><span class='Ref_to_Const'>DAYSPERLYEAR</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><span class='Parentheses'>((</span><span class='Operator'>!</span><a href="private.h.html#LN70"><span class='Ref_to_Macro'>TYPE_SIGNED</span></a><span class='Parentheses'>(</span><a href="../include/pgtime.h.html#LN22"><span class='Ref_to_Typedef'>pg_time_t</span></a><span class='Parentheses'>) </span><span class='Operator'>||</span>INT_MIN <span class='Operator'>&LT;= </span><a href="localtime.c.html#LN1417"><span class='Ref_To_Local'>tdelta</span></a><span class='Parentheses'>)</span> 
              <span class='Operator'>&& </span><a href="localtime.c.html#LN1417"><span class='Ref_To_Local'>tdelta</span></a> <span class='Operator'>&LT;= </span>INT_MAX<span class='Parentheses'>))</span> 
            <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="localtime.c.html#LN1499"><span class='Ref_to_Label'>out_of_range</span></a><span class='Delimiter'>; 
</span>        <a href="localtime.c.html#LN1418"><span class='Ref_To_Local'>idelta</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN1417"><span class='Ref_To_Local'>tdelta</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN1418"><span class='Ref_To_Local'>idelta</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>            <a href="localtime.c.html#LN1418"><span class='Ref_To_Local'>idelta</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="localtime.c.html#LN1375"><span class='Ref_To_Local'>tdays</span></a> <span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>) </span><span class='Operator'>? -</span><span class='Number'>1</span> <span class='Operator'>: </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>        <a href="localtime.c.html#LN1416"><span class='Ref_To_Local'>newy</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN1378"><span class='Ref_To_Local'>y</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN95"><span class='Ref_to_Proto'>increment_overflow</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="localtime.c.html#LN1416"><span class='Ref_To_Local'>newy</span></a><span class='Delimiter'>, </span><a href="localtime.c.html#LN1418"><span class='Ref_To_Local'>idelta</span></a><span class='Parentheses'>))</span> 
            <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="localtime.c.html#LN1499"><span class='Ref_to_Label'>out_of_range</span></a><span class='Delimiter'>; 
</span>        <a href="localtime.c.html#LN1419"><span class='Ref_To_Local'>leapdays</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN1363"><span class='Ref_to_Func'>leaps_thru_end_of</span></a><span class='Parentheses'>(</span><a href="localtime.c.html#LN1416"><span class='Ref_To_Local'>newy</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Parentheses'>) </span><span class='Operator'>- 
</span>            <a href="localtime.c.html#LN1363"><span class='Ref_to_Func'>leaps_thru_end_of</span></a><span class='Parentheses'>(</span><a href="localtime.c.html#LN1378"><span class='Ref_To_Local'>y</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="localtime.c.html#LN1375"><span class='Ref_To_Local'>tdays</span></a> <span class='Operator'>-= </span><span class='Parentheses'>((</span><a href="../include/pgtime.h.html#LN22"><span class='Ref_to_Typedef'>pg_time_t</span></a><span class='Parentheses'>) </span><a href="localtime.c.html#LN1416"><span class='Ref_To_Local'>newy</span></a> <span class='Operator'>- </span><a href="localtime.c.html#LN1378"><span class='Ref_To_Local'>y</span></a><span class='Parentheses'>)</span> <span class='Operator'>* </span><a href="private.h.html#LN110"><span class='Ref_to_Const'>DAYSPERNYEAR</span></a><span class='Delimiter'>; 
</span>        <a href="localtime.c.html#LN1375"><span class='Ref_To_Local'>tdays</span></a> <span class='Operator'>-= </span><a href="localtime.c.html#LN1419"><span class='Ref_To_Local'>leapdays</span></a><span class='Delimiter'>; 
</span>        <a href="localtime.c.html#LN1378"><span class='Ref_To_Local'>y</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN1416"><span class='Ref_To_Local'>newy</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end while tdays&LT;0||tdays&GT;=year_... &raquo; </span> 
 
    <span class='Comment_Multi_Line'>/* 
     * Given the range, we can now fearlessly cast... 
     */ 
</span>    <a href="localtime.c.html#LN1376"><span class='Ref_To_Local'>idays</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN1375"><span class='Ref_To_Local'>tdays</span></a><span class='Delimiter'>; 
</span>    <a href="localtime.c.html#LN1377"><span class='Ref_To_Local'>rem</span></a> <span class='Operator'>+= </span><a href="localtime.c.html#LN1371"><span class='Ref_to_Parameter'>offset</span></a> <span class='Operator'>- </span><a href="localtime.c.html#LN1380"><span class='Ref_To_Local'>corr</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>while</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN1377"><span class='Ref_To_Local'>rem</span></a> <span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="localtime.c.html#LN1377"><span class='Ref_To_Local'>rem</span></a> <span class='Operator'>+= </span><a href="private.h.html#LN113"><span class='Ref_to_Const'>SECSPERDAY</span></a><span class='Delimiter'>; 
</span>        <span class='Operator'>--</span><a href="localtime.c.html#LN1376"><span class='Ref_To_Local'>idays</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>while</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN1377"><span class='Ref_To_Local'>rem</span></a> <span class='Operator'>&GT;= </span><a href="private.h.html#LN113"><span class='Ref_to_Const'>SECSPERDAY</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="localtime.c.html#LN1377"><span class='Ref_To_Local'>rem</span></a> <span class='Operator'>-= </span><a href="private.h.html#LN113"><span class='Ref_to_Const'>SECSPERDAY</span></a><span class='Delimiter'>; 
</span>        <span class='Operator'>++</span><a href="localtime.c.html#LN1376"><span class='Ref_To_Local'>idays</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>while</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN1376"><span class='Ref_To_Local'>idays</span></a> <span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN95"><span class='Ref_to_Proto'>increment_overflow</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="localtime.c.html#LN1378"><span class='Ref_To_Local'>y</span></a><span class='Delimiter'>, </span><span class='Operator'>-</span><span class='Number'>1</span><span class='Parentheses'>))</span> 
            <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="localtime.c.html#LN1499"><span class='Ref_to_Label'>out_of_range</span></a><span class='Delimiter'>; 
</span>        <a href="localtime.c.html#LN1376"><span class='Ref_To_Local'>idays</span></a> <span class='Operator'>+= </span><a href="localtime.c.html#LN599"><span class='Ref_to_Global_Var'>year_lengths</span></a><span class='Delimiter'>[</span><a href="private.h.html#LN142"><span class='Ref_to_Macro'>isleap</span></a><span class='Parentheses'>(</span><a href="localtime.c.html#LN1378"><span class='Ref_To_Local'>y</span></a><span class='Parentheses'>)</span><span class='Delimiter'>]; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>while</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN1376"><span class='Ref_To_Local'>idays</span></a> <span class='Operator'>&GT;= </span><a href="localtime.c.html#LN599"><span class='Ref_to_Global_Var'>year_lengths</span></a><span class='Delimiter'>[</span><a href="private.h.html#LN142"><span class='Ref_to_Macro'>isleap</span></a><span class='Parentheses'>(</span><a href="localtime.c.html#LN1378"><span class='Ref_To_Local'>y</span></a><span class='Parentheses'>)</span><span class='Delimiter'>]</span><span class='Parentheses'>)</span> 
    <span class='Delimiter'>{ 
</span>        <a href="localtime.c.html#LN1376"><span class='Ref_To_Local'>idays</span></a> <span class='Operator'>-= </span><a href="localtime.c.html#LN599"><span class='Ref_to_Global_Var'>year_lengths</span></a><span class='Delimiter'>[</span><a href="private.h.html#LN142"><span class='Ref_to_Macro'>isleap</span></a><span class='Parentheses'>(</span><a href="localtime.c.html#LN1378"><span class='Ref_To_Local'>y</span></a><span class='Parentheses'>)</span><span class='Delimiter'>]; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN95"><span class='Ref_to_Proto'>increment_overflow</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="localtime.c.html#LN1378"><span class='Ref_To_Local'>y</span></a><span class='Delimiter'>, </span><span class='Number'>1</span><span class='Parentheses'>))</span> 
            <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="localtime.c.html#LN1499"><span class='Ref_to_Label'>out_of_range</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <a href="localtime.c.html#LN1372"><span class='Ref_to_Parameter'>tmp</span></a><span class='Operator'>-&GT;</span><a href="../include/pgtime.h.html#LN31"><span class='Ref_to_Member'>tm_year</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN1378"><span class='Ref_To_Local'>y</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN95"><span class='Ref_to_Proto'>increment_overflow</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="localtime.c.html#LN1372"><span class='Ref_to_Parameter'>tmp</span></a><span class='Operator'>-&GT;</span><a href="../include/pgtime.h.html#LN31"><span class='Ref_to_Member'>tm_year</span></a><span class='Delimiter'>, </span><span class='Operator'>-</span><a href="private.h.html#LN137"><span class='Ref_to_Const'>TM_YEAR_BASE</span></a><span class='Parentheses'>))</span> 
        <span class='Control'>goto</span> <span class='Symbol_Characters'>&darr;</span><a href="localtime.c.html#LN1499"><span class='Ref_to_Label'>out_of_range</span></a><span class='Delimiter'>; 
</span>    <a href="localtime.c.html#LN1372"><span class='Ref_to_Parameter'>tmp</span></a><span class='Operator'>-&GT;</span><a href="../include/pgtime.h.html#LN33"><span class='Ref_to_Member'>tm_yday</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN1376"><span class='Ref_To_Local'>idays</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * The "extra" mods below avoid overflow problems. 
     */ 
</span>    <a href="localtime.c.html#LN1372"><span class='Ref_to_Parameter'>tmp</span></a><span class='Operator'>-&GT;</span><a href="../include/pgtime.h.html#LN32"><span class='Ref_to_Member'>tm_wday</span></a> <span class='Operator'>= </span><a href="private.h.html#LN140"><span class='Ref_to_Const'>EPOCH_WDAY</span></a> <span class='Operator'>+ 
</span>        <span class='Parentheses'>((</span><a href="localtime.c.html#LN1378"><span class='Ref_To_Local'>y</span></a> <span class='Operator'>- </span><a href="private.h.html#LN139"><span class='Ref_to_Const'>EPOCH_YEAR</span></a><span class='Parentheses'>) </span><span class='Operator'>% </span><a href="private.h.html#LN109"><span class='Ref_to_Const'>DAYSPERWEEK</span></a><span class='Parentheses'>)</span> <span class='Operator'>* 
</span>        <span class='Parentheses'>(</span><a href="private.h.html#LN110"><span class='Ref_to_Const'>DAYSPERNYEAR</span></a> <span class='Operator'>% </span><a href="private.h.html#LN109"><span class='Ref_to_Const'>DAYSPERWEEK</span></a><span class='Parentheses'>) </span><span class='Operator'>+ 
</span>        <a href="localtime.c.html#LN1363"><span class='Ref_to_Func'>leaps_thru_end_of</span></a><span class='Parentheses'>(</span><a href="localtime.c.html#LN1378"><span class='Ref_To_Local'>y</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Parentheses'>) </span><span class='Operator'>- 
</span>        <a href="localtime.c.html#LN1363"><span class='Ref_to_Func'>leaps_thru_end_of</span></a><span class='Parentheses'>(</span><a href="private.h.html#LN139"><span class='Ref_to_Const'>EPOCH_YEAR</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Parentheses'>) </span><span class='Operator'>+ 
</span>        <a href="localtime.c.html#LN1376"><span class='Ref_To_Local'>idays</span></a><span class='Delimiter'>; 
</span>    <a href="localtime.c.html#LN1372"><span class='Ref_to_Parameter'>tmp</span></a><span class='Operator'>-&GT;</span><a href="../include/pgtime.h.html#LN32"><span class='Ref_to_Member'>tm_wday</span></a> <span class='Operator'>%= </span><a href="private.h.html#LN109"><span class='Ref_to_Const'>DAYSPERWEEK</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN1372"><span class='Ref_to_Parameter'>tmp</span></a><span class='Operator'>-&GT;</span><a href="../include/pgtime.h.html#LN32"><span class='Ref_to_Member'>tm_wday</span></a> <span class='Operator'>&LT; </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>        <a href="localtime.c.html#LN1372"><span class='Ref_to_Parameter'>tmp</span></a><span class='Operator'>-&GT;</span><a href="../include/pgtime.h.html#LN32"><span class='Ref_to_Member'>tm_wday</span></a> <span class='Operator'>+= </span><a href="private.h.html#LN109"><span class='Ref_to_Const'>DAYSPERWEEK</span></a><span class='Delimiter'>; 
</span>    <a href="localtime.c.html#LN1372"><span class='Ref_to_Parameter'>tmp</span></a><span class='Operator'>-&GT;</span><a href="../include/pgtime.h.html#LN28"><span class='Ref_to_Member'>tm_hour</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Keyword'>int</span><span class='Parentheses'>) (</span><a href="localtime.c.html#LN1377"><span class='Ref_To_Local'>rem</span></a> <span class='Operator'>/ </span><a href="private.h.html#LN112"><span class='Ref_to_Const'>SECSPERHOUR</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="localtime.c.html#LN1377"><span class='Ref_To_Local'>rem</span></a> <span class='Operator'>%= </span><a href="private.h.html#LN112"><span class='Ref_to_Const'>SECSPERHOUR</span></a><span class='Delimiter'>; 
</span>    <a href="localtime.c.html#LN1372"><span class='Ref_to_Parameter'>tmp</span></a><span class='Operator'>-&GT;</span><a href="../include/pgtime.h.html#LN27"><span class='Ref_to_Member'>tm_min</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Keyword'>int</span><span class='Parentheses'>) (</span><a href="localtime.c.html#LN1377"><span class='Ref_To_Local'>rem</span></a> <span class='Operator'>/ </span><a href="private.h.html#LN106"><span class='Ref_to_Const'>SECSPERMIN</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * A positive leap second requires a special representation. This uses 
     * "... ??:59:60" et seq. 
     */ 
</span>    <a href="localtime.c.html#LN1372"><span class='Ref_to_Parameter'>tmp</span></a><span class='Operator'>-&GT;</span><a href="../include/pgtime.h.html#LN26"><span class='Ref_to_Member'>tm_sec</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Keyword'>int</span><span class='Parentheses'>) (</span><a href="localtime.c.html#LN1377"><span class='Ref_To_Local'>rem</span></a> <span class='Operator'>% </span><a href="private.h.html#LN106"><span class='Ref_to_Const'>SECSPERMIN</span></a><span class='Parentheses'>) </span><span class='Operator'>+ </span><a href="localtime.c.html#LN1381"><span class='Ref_To_Local'>hit</span></a><span class='Delimiter'>; 
</span>    <a href="localtime.c.html#LN1379"><span class='Ref_To_Local'>ip</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN594"><span class='Ref_to_Global_Var'>mon_lengths</span></a><span class='Delimiter'>[</span><a href="private.h.html#LN142"><span class='Ref_to_Macro'>isleap</span></a><span class='Parentheses'>(</span><a href="localtime.c.html#LN1378"><span class='Ref_To_Local'>y</span></a><span class='Parentheses'>)</span><span class='Delimiter'>]; 
</span>    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN1372"><span class='Ref_to_Parameter'>tmp</span></a><span class='Operator'>-&GT;</span><a href="../include/pgtime.h.html#LN30"><span class='Ref_to_Member'>tm_mon</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="localtime.c.html#LN1376"><span class='Ref_To_Local'>idays</span></a> <span class='Operator'>&GT;= </span><a href="localtime.c.html#LN1379"><span class='Ref_To_Local'>ip</span></a><span class='Delimiter'>[</span><a href="localtime.c.html#LN1372"><span class='Ref_to_Parameter'>tmp</span></a><span class='Operator'>-&GT;</span><a href="../include/pgtime.h.html#LN30"><span class='Ref_to_Member'>tm_mon</span></a><span class='Delimiter'>]; </span><span class='Operator'>++</span><span class='Parentheses'>(</span><a href="localtime.c.html#LN1372"><span class='Ref_to_Parameter'>tmp</span></a><span class='Operator'>-&GT;</span><a href="../include/pgtime.h.html#LN30"><span class='Ref_to_Member'>tm_mon</span></a><span class='Parentheses'>))</span> 
        <a href="localtime.c.html#LN1376"><span class='Ref_To_Local'>idays</span></a> <span class='Operator'>-= </span><a href="localtime.c.html#LN1379"><span class='Ref_To_Local'>ip</span></a><span class='Delimiter'>[</span><a href="localtime.c.html#LN1372"><span class='Ref_to_Parameter'>tmp</span></a><span class='Operator'>-&GT;</span><a href="../include/pgtime.h.html#LN30"><span class='Ref_to_Member'>tm_mon</span></a><span class='Delimiter'>]; 
</span>    <a href="localtime.c.html#LN1372"><span class='Ref_to_Parameter'>tmp</span></a><span class='Operator'>-&GT;</span><a href="../include/pgtime.h.html#LN29"><span class='Ref_to_Member'>tm_mday</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='Keyword'>int</span><span class='Parentheses'>) (</span><a href="localtime.c.html#LN1376"><span class='Ref_To_Local'>idays</span></a> <span class='Operator'>+ </span><span class='Number'>1</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="localtime.c.html#LN1372"><span class='Ref_to_Parameter'>tmp</span></a><span class='Operator'>-&GT;</span><a href="../include/pgtime.h.html#LN34"><span class='Ref_to_Member'>tm_isdst</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <a href="localtime.c.html#LN1372"><span class='Ref_to_Parameter'>tmp</span></a><span class='Operator'>-&GT;</span><a href="../include/pgtime.h.html#LN35"><span class='Ref_to_Member'>tm_gmtoff</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN1371"><span class='Ref_to_Parameter'>offset</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <a href="localtime.c.html#LN1372"><span class='Ref_to_Parameter'>tmp</span></a><span class='Delimiter'>; 
</span> 
<a name="LN1499"></a><span class='Label'>out_of_range</span><span class='Operator'>: 
</span>    errno <span class='Operator'>= </span><a href="private.h.html#LN37"><span class='Ref_to_Const'>EOVERFLOW</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <span class='Null_Value'>NULL</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end timesub &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * Normalize logic courtesy Paul Eggert. 
 */ 
</span> 
<span class='Keyword'>static bool 
</span><a name="LN1509"></a><span class='Declare_Function'>increment_overflow</span><span class='Parentheses'>(</span><span class='Keyword'>int </span><span class='Operator'>*</span><span class='Declare_Parameter'>ip</span><span class='Delimiter'>, </span><span class='Keyword'>int </span><span class='Declare_Parameter'>j</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1511"></a>    <span class='Keyword'>int const</span>   <span class='Declare_Local'>i</span> <span class='Operator'>= *</span><a href="localtime.c.html#LN1509"><span class='Ref_to_Parameter'>ip</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/*---------- 
     * If i &GT;= 0 there can only be overflow if i + j &GT; INT_MAX 
     * or if j &GT; INT_MAX - i; given i &GT;= 0, INT_MAX - i cannot overflow. 
     * If i &LT; 0 there can only be overflow if i + j &LT; INT_MIN 
     * or if j &LT; INT_MIN - i; given i &LT; 0, INT_MIN - i cannot overflow. 
     *---------- 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="localtime.c.html#LN1511"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&GT;= </span><span class='Number'>0</span><span class='Parentheses'>) </span><span class='Operator'>? </span><span class='Parentheses'>(</span><a href="localtime.c.html#LN1509"><span class='Ref_to_Parameter'>j</span></a> <span class='Operator'>&GT; </span>INT_MAX <span class='Operator'>- </span><a href="localtime.c.html#LN1511"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>) </span><span class='Operator'>: </span><span class='Parentheses'>(</span><a href="localtime.c.html#LN1509"><span class='Ref_to_Parameter'>j</span></a> <span class='Operator'>&LT; </span>INT_MIN <span class='Operator'>- </span><a href="localtime.c.html#LN1511"><span class='Ref_To_Local'>i</span></a><span class='Parentheses'>))</span> 
        <span class='Control'>return</span> <span class='Boolean'>true</span><span class='Delimiter'>; 
</span>    <span class='Operator'>*</span><a href="localtime.c.html#LN1509"><span class='Ref_to_Parameter'>ip</span></a> <span class='Operator'>+= </span><a href="localtime.c.html#LN1509"><span class='Ref_to_Parameter'>j</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <span class='Boolean'>false</span><span class='Delimiter'>; 
} 
</span> 
<span class='Keyword'>static bool 
</span><a name="LN1527"></a><span class='Declare_Function'>increment_overflow_time</span><span class='Parentheses'>(</span><a href="../include/pgtime.h.html#LN22"><span class='Ref_to_Typedef'>pg_time_t</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>tp</span><span class='Delimiter'>, </span><a href="../include/c.h.html#LN255"><span class='Ref_to_Typedef'>int32</span></a> <span class='Declare_Parameter'>j</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Comment_Multi_Line'>/*---------- 
     * This is like 
     * 'if (! (time_t_min &LT;= *tp + j && *tp + j &LT;= time_t_max)) ...', 
     * except that it does the right thing even if *tp + j would overflow. 
     *---------- 
     */ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><span class='Parentheses'>(</span><a href="localtime.c.html#LN1527"><span class='Ref_to_Parameter'>j</span></a> <span class='Operator'>&LT; </span><span class='Number'>0</span> 
          <span class='Operator'>? </span><span class='Parentheses'>(</span><a href="private.h.html#LN70"><span class='Ref_to_Macro'>TYPE_SIGNED</span></a><span class='Parentheses'>(</span><a href="../include/pgtime.h.html#LN22"><span class='Ref_to_Typedef'>pg_time_t</span></a><span class='Parentheses'>) </span><span class='Operator'>? </span><a href="localtime.c.html#LN53"><span class='Ref_to_Global_Var'>time_t_min</span></a> <span class='Operator'>- </span><a href="localtime.c.html#LN1527"><span class='Ref_to_Parameter'>j</span></a> <span class='Operator'>&LT;= *</span><a href="localtime.c.html#LN1527"><span class='Ref_to_Parameter'>tp</span></a> <span class='Operator'>: -</span><span class='Number'>1</span> <span class='Operator'>- </span><a href="localtime.c.html#LN1527"><span class='Ref_to_Parameter'>j</span></a> <span class='Operator'>&LT; *</span><a href="localtime.c.html#LN1527"><span class='Ref_to_Parameter'>tp</span></a><span class='Parentheses'>)</span> 
          <span class='Operator'>: *</span><a href="localtime.c.html#LN1527"><span class='Ref_to_Parameter'>tp</span></a> <span class='Operator'>&LT;= </span><a href="localtime.c.html#LN54"><span class='Ref_to_Global_Var'>time_t_max</span></a> <span class='Operator'>- </span><a href="localtime.c.html#LN1527"><span class='Ref_to_Parameter'>j</span></a><span class='Parentheses'>))</span> 
        <span class='Control'>return</span> <span class='Boolean'>true</span><span class='Delimiter'>; 
</span>    <span class='Operator'>*</span><a href="localtime.c.html#LN1527"><span class='Ref_to_Parameter'>tp</span></a> <span class='Operator'>+= </span><a href="localtime.c.html#LN1527"><span class='Ref_to_Parameter'>j</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <span class='Boolean'>false</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * Find the next DST transition time in the given zone after the given time 
 * 
 * *timep and *tz are input arguments, the other parameters are output values. 
 * 
 * When the function result is 1, *boundary is set to the pg_time_t 
 * representation of the next DST transition time after *timep, 
 * *before_gmtoff and *before_isdst are set to the GMT offset and isdst 
 * state prevailing just before that boundary (in particular, the state 
 * prevailing at *timep), and *after_gmtoff and *after_isdst are set to 
 * the state prevailing just after that boundary. 
 * 
 * When the function result is 0, there is no known DST transition 
 * after *timep, but *before_gmtoff and *before_isdst indicate the GMT 
 * offset and isdst state prevailing at *timep.  (This would occur in 
 * DST-less time zones, or if a zone has permanently ceased using DST.) 
 * 
 * A function result of -1 indicates failure (this case does not actually 
 * occur in our current implementation). 
 */ 
</span><span class='Keyword'>int 
</span><a name="LN1564"></a><span class='Declare_Function'>pg_next_dst_boundary</span><span class='Parentheses'>(</span><span class='Keyword'>const </span><a href="../include/pgtime.h.html#LN22"><span class='Ref_to_Typedef'>pg_time_t</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>timep</span><span class='Delimiter'>, 
</span><a name="LN1565"></a>                     <span class='Keyword'>long int </span><span class='Operator'>*</span><span class='Declare_Parameter'>before_gmtoff</span><span class='Delimiter'>, 
</span><a name="LN1566"></a>                     <span class='Keyword'>int </span><span class='Operator'>*</span><span class='Declare_Parameter'>before_isdst</span><span class='Delimiter'>, 
</span><a name="LN1567"></a>                     <a href="../include/pgtime.h.html#LN22"><span class='Ref_to_Typedef'>pg_time_t</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>boundary</span><span class='Delimiter'>, 
</span><a name="LN1568"></a>                     <span class='Keyword'>long int </span><span class='Operator'>*</span><span class='Declare_Parameter'>after_gmtoff</span><span class='Delimiter'>, 
</span><a name="LN1569"></a>                     <span class='Keyword'>int </span><span class='Operator'>*</span><span class='Declare_Parameter'>after_isdst</span><span class='Delimiter'>, 
</span><a name="LN1570"></a>                     <span class='Keyword'>const </span><a href="pgtz.h.html#LN58"><span class='Ref_to_Struct'>pg_tz</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>tz</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1572"></a>    <span class='Keyword'>const </span><span class='Control'>struct</span> <a href="pgtz.h.html#LN40"><span class='Ref_to_Struct'>state</span></a> <span class='Operator'>*</span><span class='Declare_Local'>sp</span><span class='Delimiter'>; 
</span><a name="LN1573"></a>    <span class='Keyword'>const </span><span class='Control'>struct</span> <a href="pgtz.h.html#LN25"><span class='Ref_to_Struct'>ttinfo</span></a> <span class='Operator'>*</span><span class='Declare_Local'>ttisp</span><span class='Delimiter'>; 
</span><a name="LN1574"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>i</span><span class='Delimiter'>; 
</span><a name="LN1575"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>j</span><span class='Delimiter'>; 
</span><a name="LN1576"></a>    <span class='Keyword'>const </span><a href="../include/pgtime.h.html#LN22"><span class='Ref_to_Typedef'>pg_time_t</span></a> <span class='Declare_Local'>t</span> <span class='Operator'>= *</span><a href="localtime.c.html#LN1564"><span class='Ref_to_Parameter'>timep</span></a><span class='Delimiter'>; 
</span> 
    <a href="localtime.c.html#LN1572"><span class='Ref_To_Local'>sp</span></a> <span class='Operator'>= &</span><a href="localtime.c.html#LN1570"><span class='Ref_to_Parameter'>tz</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN62"><span class='Ref_to_Member'>state</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN1572"><span class='Ref_To_Local'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN43"><span class='Ref_to_Member'>timecnt</span></a> <span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* non-DST zone, use lowest-numbered standard type */ 
</span>        <a href="localtime.c.html#LN1574"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>        <span class='Control'>while</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN1572"><span class='Ref_To_Local'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN50"><span class='Ref_to_Member'>ttis</span></a><span class='Delimiter'>[</span><a href="localtime.c.html#LN1574"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="pgtz.h.html#LN28"><span class='Ref_to_Member'>tt_isdst</span></a><span class='Parentheses'>) 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>++</span><a href="localtime.c.html#LN1574"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&GT;= </span><a href="localtime.c.html#LN1572"><span class='Ref_To_Local'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN44"><span class='Ref_to_Member'>typecnt</span></a><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <a href="localtime.c.html#LN1574"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>        <a href="localtime.c.html#LN1573"><span class='Ref_To_Local'>ttisp</span></a> <span class='Operator'>= &</span><a href="localtime.c.html#LN1572"><span class='Ref_To_Local'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN50"><span class='Ref_to_Member'>ttis</span></a><span class='Delimiter'>[</span><a href="localtime.c.html#LN1574"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]; 
</span>        <span class='Operator'>*</span><a href="localtime.c.html#LN1565"><span class='Ref_to_Parameter'>before_gmtoff</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN1573"><span class='Ref_To_Local'>ttisp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN27"><span class='Ref_to_Member'>tt_gmtoff</span></a><span class='Delimiter'>; 
</span>        <span class='Operator'>*</span><a href="localtime.c.html#LN1566"><span class='Ref_to_Parameter'>before_isdst</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN1573"><span class='Ref_To_Local'>ttisp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN28"><span class='Ref_to_Member'>tt_isdst</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <span class='Number'>0</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>if</span> <span class='Parentheses'>((</span><a href="localtime.c.html#LN1572"><span class='Ref_To_Local'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN46"><span class='Ref_to_Member'>goback</span></a> <span class='Operator'>&& </span><a href="localtime.c.html#LN1576"><span class='Ref_To_Local'>t</span></a> <span class='Operator'>&LT; </span><a href="localtime.c.html#LN1572"><span class='Ref_To_Local'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN48"><span class='Ref_to_Member'>ats</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>]</span><span class='Parentheses'>) </span><span class='Operator'>|| 
</span>        <span class='Parentheses'>(</span><a href="localtime.c.html#LN1572"><span class='Ref_To_Local'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN47"><span class='Ref_to_Member'>goahead</span></a> <span class='Operator'>&& </span><a href="localtime.c.html#LN1576"><span class='Ref_To_Local'>t</span></a> <span class='Operator'>&GT; </span><a href="localtime.c.html#LN1572"><span class='Ref_To_Local'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN48"><span class='Ref_to_Member'>ats</span></a><span class='Delimiter'>[</span><a href="localtime.c.html#LN1572"><span class='Ref_To_Local'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN43"><span class='Ref_to_Member'>timecnt</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>]</span><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* For values outside the transition table, extrapolate */ 
</span><a name="LN1598"></a>        <a href="../include/pgtime.h.html#LN22"><span class='Ref_to_Typedef'>pg_time_t</span></a>   <span class='Declare_Local'>newt</span> <span class='Operator'>= </span><a href="localtime.c.html#LN1576"><span class='Ref_To_Local'>t</span></a><span class='Delimiter'>; 
</span><a name="LN1599"></a>        <a href="../include/pgtime.h.html#LN22"><span class='Ref_to_Typedef'>pg_time_t</span></a>   <span class='Declare_Local'>seconds</span><span class='Delimiter'>; 
</span><a name="LN1600"></a>        <a href="../include/pgtime.h.html#LN22"><span class='Ref_to_Typedef'>pg_time_t</span></a>   <span class='Declare_Local'>tcycles</span><span class='Delimiter'>; 
</span><a name="LN1601"></a>        <a href="../include/c.h.html#LN294"><span class='Ref_to_Typedef'>int64</span></a>       <span class='Declare_Local'>icycles</span><span class='Delimiter'>; 
</span><a name="LN1602"></a>        <span class='Keyword'>int</span>         <span class='Declare_Local'>result</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN1576"><span class='Ref_To_Local'>t</span></a> <span class='Operator'>&LT; </span><a href="localtime.c.html#LN1572"><span class='Ref_To_Local'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN48"><span class='Ref_to_Member'>ats</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>]</span><span class='Parentheses'>) 
</span>            <a href="localtime.c.html#LN1599"><span class='Ref_To_Local'>seconds</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN1572"><span class='Ref_To_Local'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN48"><span class='Ref_to_Member'>ats</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>] </span><span class='Operator'>- </span><a href="localtime.c.html#LN1576"><span class='Ref_To_Local'>t</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> 
            <a href="localtime.c.html#LN1599"><span class='Ref_To_Local'>seconds</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN1576"><span class='Ref_To_Local'>t</span></a> <span class='Operator'>- </span><a href="localtime.c.html#LN1572"><span class='Ref_To_Local'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN48"><span class='Ref_to_Member'>ats</span></a><span class='Delimiter'>[</span><a href="localtime.c.html#LN1572"><span class='Ref_To_Local'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN43"><span class='Ref_to_Member'>timecnt</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>]; 
</span>        <span class='Operator'>--</span><a href="localtime.c.html#LN1599"><span class='Ref_To_Local'>seconds</span></a><span class='Delimiter'>; 
</span>        <a href="localtime.c.html#LN1600"><span class='Ref_To_Local'>tcycles</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN1599"><span class='Ref_To_Local'>seconds</span></a> <span class='Operator'>/ </span><a href="private.h.html#LN104"><span class='Ref_to_Const'>YEARSPERREPEAT</span></a> <span class='Operator'>/ </span><a href="private.h.html#LN163"><span class='Ref_to_Const'>AVGSECSPERYEAR</span></a><span class='Delimiter'>; 
</span>        <span class='Operator'>++</span><a href="localtime.c.html#LN1600"><span class='Ref_To_Local'>tcycles</span></a><span class='Delimiter'>; 
</span>        <a href="localtime.c.html#LN1601"><span class='Ref_To_Local'>icycles</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN1600"><span class='Ref_To_Local'>tcycles</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN1600"><span class='Ref_To_Local'>tcycles</span></a> <span class='Operator'>- </span><a href="localtime.c.html#LN1601"><span class='Ref_To_Local'>icycles</span></a> <span class='Operator'>&GT;= </span><span class='Number'>1</span> <span class='Operator'>|| </span><a href="localtime.c.html#LN1601"><span class='Ref_To_Local'>icycles</span></a> <span class='Operator'>- </span><a href="localtime.c.html#LN1600"><span class='Ref_To_Local'>tcycles</span></a> <span class='Operator'>&GT;= </span><span class='Number'>1</span><span class='Parentheses'>) 
</span>            <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>; 
</span>        <a href="localtime.c.html#LN1599"><span class='Ref_To_Local'>seconds</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN1601"><span class='Ref_To_Local'>icycles</span></a><span class='Delimiter'>; 
</span>        <a href="localtime.c.html#LN1599"><span class='Ref_To_Local'>seconds</span></a> <span class='Operator'>*= </span><a href="private.h.html#LN104"><span class='Ref_to_Const'>YEARSPERREPEAT</span></a><span class='Delimiter'>; 
</span>        <a href="localtime.c.html#LN1599"><span class='Ref_To_Local'>seconds</span></a> <span class='Operator'>*= </span><a href="private.h.html#LN163"><span class='Ref_to_Const'>AVGSECSPERYEAR</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN1576"><span class='Ref_To_Local'>t</span></a> <span class='Operator'>&LT; </span><a href="localtime.c.html#LN1572"><span class='Ref_To_Local'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN48"><span class='Ref_to_Member'>ats</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>]</span><span class='Parentheses'>) 
</span>            <a href="localtime.c.html#LN1598"><span class='Ref_To_Local'>newt</span></a> <span class='Operator'>+= </span><a href="localtime.c.html#LN1599"><span class='Ref_To_Local'>seconds</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> 
            <a href="localtime.c.html#LN1598"><span class='Ref_To_Local'>newt</span></a> <span class='Operator'>-= </span><a href="localtime.c.html#LN1599"><span class='Ref_To_Local'>seconds</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN1598"><span class='Ref_To_Local'>newt</span></a> <span class='Operator'>&LT; </span><a href="localtime.c.html#LN1572"><span class='Ref_To_Local'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN48"><span class='Ref_to_Member'>ats</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>] </span><span class='Operator'>|| 
</span>            <a href="localtime.c.html#LN1598"><span class='Ref_To_Local'>newt</span></a> <span class='Operator'>&GT; </span><a href="localtime.c.html#LN1572"><span class='Ref_To_Local'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN48"><span class='Ref_to_Member'>ats</span></a><span class='Delimiter'>[</span><a href="localtime.c.html#LN1572"><span class='Ref_To_Local'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN43"><span class='Ref_to_Member'>timecnt</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>]</span><span class='Parentheses'>) 
</span>            <span class='Control'>return</span> <span class='Operator'>-</span><span class='Number'>1</span><span class='Delimiter'>;</span>          <span class='Comment_Single_Line'>/* "cannot happen" */ 
</span> 
        <a href="localtime.c.html#LN1602"><span class='Ref_To_Local'>result</span></a> <span class='Operator'>= </span><a href="../include/pgtime.h.html#LN49"><span class='Ref_to_Proto'>pg_next_dst_boundary</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="localtime.c.html#LN1598"><span class='Ref_To_Local'>newt</span></a><span class='Delimiter'>, </span><a href="localtime.c.html#LN1565"><span class='Ref_to_Parameter'>before_gmtoff</span></a><span class='Delimiter'>, 
</span>                                      <a href="localtime.c.html#LN1566"><span class='Ref_to_Parameter'>before_isdst</span></a><span class='Delimiter'>, 
</span>                                      <a href="localtime.c.html#LN1567"><span class='Ref_to_Parameter'>boundary</span></a><span class='Delimiter'>, 
</span>                                      <a href="localtime.c.html#LN1568"><span class='Ref_to_Parameter'>after_gmtoff</span></a><span class='Delimiter'>, 
</span>                                      <a href="localtime.c.html#LN1569"><span class='Ref_to_Parameter'>after_isdst</span></a><span class='Delimiter'>, 
</span>                                      <a href="localtime.c.html#LN1570"><span class='Ref_to_Parameter'>tz</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN1576"><span class='Ref_To_Local'>t</span></a> <span class='Operator'>&LT; </span><a href="localtime.c.html#LN1572"><span class='Ref_To_Local'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN48"><span class='Ref_to_Member'>ats</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>]</span><span class='Parentheses'>) 
</span>            <span class='Operator'>*</span><a href="localtime.c.html#LN1567"><span class='Ref_to_Parameter'>boundary</span></a> <span class='Operator'>-= </span><a href="localtime.c.html#LN1599"><span class='Ref_To_Local'>seconds</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>else</span> 
            <span class='Operator'>*</span><a href="localtime.c.html#LN1567"><span class='Ref_to_Parameter'>boundary</span></a> <span class='Operator'>+= </span><a href="localtime.c.html#LN1599"><span class='Ref_To_Local'>seconds</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <a href="localtime.c.html#LN1602"><span class='Ref_To_Local'>result</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if (sp-&GT;goback&&t&LT;sp-&GT;at... &raquo; </span> 
 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN1576"><span class='Ref_To_Local'>t</span></a> <span class='Operator'>&GT;= </span><a href="localtime.c.html#LN1572"><span class='Ref_To_Local'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN48"><span class='Ref_to_Member'>ats</span></a><span class='Delimiter'>[</span><a href="localtime.c.html#LN1572"><span class='Ref_To_Local'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN43"><span class='Ref_to_Member'>timecnt</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>]</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* No known transition &GT; t, so use last known segment's type */ 
</span>        <a href="localtime.c.html#LN1574"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN1572"><span class='Ref_To_Local'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN49"><span class='Ref_to_Member'>types</span></a><span class='Delimiter'>[</span><a href="localtime.c.html#LN1572"><span class='Ref_To_Local'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN43"><span class='Ref_to_Member'>timecnt</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>]; 
</span>        <a href="localtime.c.html#LN1573"><span class='Ref_To_Local'>ttisp</span></a> <span class='Operator'>= &</span><a href="localtime.c.html#LN1572"><span class='Ref_To_Local'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN50"><span class='Ref_to_Member'>ttis</span></a><span class='Delimiter'>[</span><a href="localtime.c.html#LN1574"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]; 
</span>        <span class='Operator'>*</span><a href="localtime.c.html#LN1565"><span class='Ref_to_Parameter'>before_gmtoff</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN1573"><span class='Ref_To_Local'>ttisp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN27"><span class='Ref_to_Member'>tt_gmtoff</span></a><span class='Delimiter'>; 
</span>        <span class='Operator'>*</span><a href="localtime.c.html#LN1566"><span class='Ref_to_Parameter'>before_isdst</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN1573"><span class='Ref_To_Local'>ttisp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN28"><span class='Ref_to_Member'>tt_isdst</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <span class='Number'>0</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN1576"><span class='Ref_To_Local'>t</span></a> <span class='Operator'>&LT; </span><a href="localtime.c.html#LN1572"><span class='Ref_To_Local'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN48"><span class='Ref_to_Member'>ats</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>]</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Comment_Multi_Line'>/* For "before", use lowest-numbered standard type */ 
</span>        <a href="localtime.c.html#LN1574"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>        <span class='Control'>while</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN1572"><span class='Ref_To_Local'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN50"><span class='Ref_to_Member'>ttis</span></a><span class='Delimiter'>[</span><a href="localtime.c.html#LN1574"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="pgtz.h.html#LN28"><span class='Ref_to_Member'>tt_isdst</span></a><span class='Parentheses'>) 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>++</span><a href="localtime.c.html#LN1574"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&GT;= </span><a href="localtime.c.html#LN1572"><span class='Ref_To_Local'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN44"><span class='Ref_to_Member'>typecnt</span></a><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                <a href="localtime.c.html#LN1574"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>                <span class='Control'>break</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>        <a href="localtime.c.html#LN1573"><span class='Ref_To_Local'>ttisp</span></a> <span class='Operator'>= &</span><a href="localtime.c.html#LN1572"><span class='Ref_To_Local'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN50"><span class='Ref_to_Member'>ttis</span></a><span class='Delimiter'>[</span><a href="localtime.c.html#LN1574"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]; 
</span>        <span class='Operator'>*</span><a href="localtime.c.html#LN1565"><span class='Ref_to_Parameter'>before_gmtoff</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN1573"><span class='Ref_To_Local'>ttisp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN27"><span class='Ref_to_Member'>tt_gmtoff</span></a><span class='Delimiter'>; 
</span>        <span class='Operator'>*</span><a href="localtime.c.html#LN1566"><span class='Ref_to_Parameter'>before_isdst</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN1573"><span class='Ref_To_Local'>ttisp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN28"><span class='Ref_to_Member'>tt_isdst</span></a><span class='Delimiter'>; 
</span>        <span class='Operator'>*</span><a href="localtime.c.html#LN1567"><span class='Ref_to_Parameter'>boundary</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN1572"><span class='Ref_To_Local'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN48"><span class='Ref_to_Member'>ats</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>]; 
</span>        <span class='Comment_Multi_Line'>/* And for "after", use the first segment's type */ 
</span>        <a href="localtime.c.html#LN1574"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN1572"><span class='Ref_To_Local'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN49"><span class='Ref_to_Member'>types</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>]; 
</span>        <a href="localtime.c.html#LN1573"><span class='Ref_To_Local'>ttisp</span></a> <span class='Operator'>= &</span><a href="localtime.c.html#LN1572"><span class='Ref_To_Local'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN50"><span class='Ref_to_Member'>ttis</span></a><span class='Delimiter'>[</span><a href="localtime.c.html#LN1574"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]; 
</span>        <span class='Operator'>*</span><a href="localtime.c.html#LN1568"><span class='Ref_to_Parameter'>after_gmtoff</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN1573"><span class='Ref_To_Local'>ttisp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN27"><span class='Ref_to_Member'>tt_gmtoff</span></a><span class='Delimiter'>; 
</span>        <span class='Operator'>*</span><a href="localtime.c.html#LN1569"><span class='Ref_to_Parameter'>after_isdst</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN1573"><span class='Ref_To_Local'>ttisp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN28"><span class='Ref_to_Member'>tt_isdst</span></a><span class='Delimiter'>; 
</span>        <span class='Control'>return</span> <span class='Number'>1</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end if t&LT;sp-&GT;ats[0] &raquo; </span> 
    <span class='Comment_Multi_Line'>/* Else search to find the boundary following t */ 
</span>    <span class='Delimiter'>{ 
</span><a name="LN1670"></a>        <span class='Keyword'>int</span>         <span class='Declare_Local'>lo</span> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>; 
</span><a name="LN1671"></a>        <span class='Keyword'>int</span>         <span class='Declare_Local'>hi</span> <span class='Operator'>= </span><a href="localtime.c.html#LN1572"><span class='Ref_To_Local'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN43"><span class='Ref_to_Member'>timecnt</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>while</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN1670"><span class='Ref_To_Local'>lo</span></a> <span class='Operator'>&LT; </span><a href="localtime.c.html#LN1671"><span class='Ref_To_Local'>hi</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span><a name="LN1675"></a>            <span class='Keyword'>int</span>         <span class='Declare_Local'>mid</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="localtime.c.html#LN1670"><span class='Ref_To_Local'>lo</span></a> <span class='Operator'>+ </span><a href="localtime.c.html#LN1671"><span class='Ref_To_Local'>hi</span></a><span class='Parentheses'>) </span><span class='Operator'>&GT;&GT; </span><span class='Number'>1</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN1576"><span class='Ref_To_Local'>t</span></a> <span class='Operator'>&LT; </span><a href="localtime.c.html#LN1572"><span class='Ref_To_Local'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN48"><span class='Ref_to_Member'>ats</span></a><span class='Delimiter'>[</span><a href="localtime.c.html#LN1675"><span class='Ref_To_Local'>mid</span></a><span class='Delimiter'>]</span><span class='Parentheses'>) 
</span>                <a href="localtime.c.html#LN1671"><span class='Ref_To_Local'>hi</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN1675"><span class='Ref_To_Local'>mid</span></a><span class='Delimiter'>; 
</span>            <span class='Control'>else</span> 
                <a href="localtime.c.html#LN1670"><span class='Ref_To_Local'>lo</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN1675"><span class='Ref_To_Local'>mid</span></a> <span class='Operator'>+ </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <a href="localtime.c.html#LN1574"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN1670"><span class='Ref_To_Local'>lo</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <a href="localtime.c.html#LN1575"><span class='Ref_To_Local'>j</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN1572"><span class='Ref_To_Local'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN49"><span class='Ref_to_Member'>types</span></a><span class='Delimiter'>[</span><a href="localtime.c.html#LN1574"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>]; 
</span>    <a href="localtime.c.html#LN1573"><span class='Ref_To_Local'>ttisp</span></a> <span class='Operator'>= &</span><a href="localtime.c.html#LN1572"><span class='Ref_To_Local'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN50"><span class='Ref_to_Member'>ttis</span></a><span class='Delimiter'>[</span><a href="localtime.c.html#LN1575"><span class='Ref_To_Local'>j</span></a><span class='Delimiter'>]; 
</span>    <span class='Operator'>*</span><a href="localtime.c.html#LN1565"><span class='Ref_to_Parameter'>before_gmtoff</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN1573"><span class='Ref_To_Local'>ttisp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN27"><span class='Ref_to_Member'>tt_gmtoff</span></a><span class='Delimiter'>; 
</span>    <span class='Operator'>*</span><a href="localtime.c.html#LN1566"><span class='Ref_to_Parameter'>before_isdst</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN1573"><span class='Ref_To_Local'>ttisp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN28"><span class='Ref_to_Member'>tt_isdst</span></a><span class='Delimiter'>; 
</span>    <span class='Operator'>*</span><a href="localtime.c.html#LN1567"><span class='Ref_to_Parameter'>boundary</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN1572"><span class='Ref_To_Local'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN48"><span class='Ref_to_Member'>ats</span></a><span class='Delimiter'>[</span><a href="localtime.c.html#LN1574"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]; 
</span>    <a href="localtime.c.html#LN1575"><span class='Ref_To_Local'>j</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN1572"><span class='Ref_To_Local'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN49"><span class='Ref_to_Member'>types</span></a><span class='Delimiter'>[</span><a href="localtime.c.html#LN1574"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]; 
</span>    <a href="localtime.c.html#LN1573"><span class='Ref_To_Local'>ttisp</span></a> <span class='Operator'>= &</span><a href="localtime.c.html#LN1572"><span class='Ref_To_Local'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN50"><span class='Ref_to_Member'>ttis</span></a><span class='Delimiter'>[</span><a href="localtime.c.html#LN1575"><span class='Ref_To_Local'>j</span></a><span class='Delimiter'>]; 
</span>    <span class='Operator'>*</span><a href="localtime.c.html#LN1568"><span class='Ref_to_Parameter'>after_gmtoff</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN1573"><span class='Ref_To_Local'>ttisp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN27"><span class='Ref_to_Member'>tt_gmtoff</span></a><span class='Delimiter'>; 
</span>    <span class='Operator'>*</span><a href="localtime.c.html#LN1569"><span class='Ref_to_Parameter'>after_isdst</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN1573"><span class='Ref_To_Local'>ttisp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN28"><span class='Ref_to_Member'>tt_isdst</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <span class='Number'>1</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end pg_next_dst_boundary &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * Identify a timezone abbreviation's meaning in the given zone 
 * 
 * Determine the GMT offset and DST flag associated with the abbreviation. 
 * This is generally used only when the abbreviation has actually changed 
 * meaning over time; therefore, we also take a UTC cutoff time, and return 
 * the meaning in use at or most recently before that time, or the meaning 
 * in first use after that time if the abbrev was never used before that. 
 * 
 * On success, returns true and sets *gmtoff and *isdst.  If the abbreviation 
 * was never used at all in this zone, returns false. 
 * 
 * Note: abbrev is matched case-sensitively; it should be all-upper-case. 
 */ 
</span><span class='Keyword'>bool 
</span><a name="LN1711"></a><span class='Declare_Function'>pg_interpret_timezone_abbrev</span><span class='Parentheses'>(</span><span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Parameter'>abbrev</span><span class='Delimiter'>, 
</span><a name="LN1712"></a>                             <span class='Keyword'>const </span><a href="../include/pgtime.h.html#LN22"><span class='Ref_to_Typedef'>pg_time_t</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>timep</span><span class='Delimiter'>, 
</span><a name="LN1713"></a>                             <span class='Keyword'>long int </span><span class='Operator'>*</span><span class='Declare_Parameter'>gmtoff</span><span class='Delimiter'>, 
</span><a name="LN1714"></a>                             <span class='Keyword'>int </span><span class='Operator'>*</span><span class='Declare_Parameter'>isdst</span><span class='Delimiter'>, 
</span><a name="LN1715"></a>                             <span class='Keyword'>const </span><a href="pgtz.h.html#LN58"><span class='Ref_to_Struct'>pg_tz</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>tz</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1717"></a>    <span class='Keyword'>const </span><span class='Control'>struct</span> <a href="pgtz.h.html#LN40"><span class='Ref_to_Struct'>state</span></a> <span class='Operator'>*</span><span class='Declare_Local'>sp</span><span class='Delimiter'>; 
</span><a name="LN1718"></a>    <span class='Keyword'>const char </span><span class='Operator'>*</span><span class='Declare_Local'>abbrs</span><span class='Delimiter'>; 
</span><a name="LN1719"></a>    <span class='Keyword'>const </span><span class='Control'>struct</span> <a href="pgtz.h.html#LN25"><span class='Ref_to_Struct'>ttinfo</span></a> <span class='Operator'>*</span><span class='Declare_Local'>ttisp</span><span class='Delimiter'>; 
</span><a name="LN1720"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>abbrind</span><span class='Delimiter'>; 
</span><a name="LN1721"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>cutoff</span><span class='Delimiter'>; 
</span><a name="LN1722"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>i</span><span class='Delimiter'>; 
</span><a name="LN1723"></a>    <span class='Keyword'>const </span><a href="../include/pgtime.h.html#LN22"><span class='Ref_to_Typedef'>pg_time_t</span></a> <span class='Declare_Local'>t</span> <span class='Operator'>= *</span><a href="localtime.c.html#LN1712"><span class='Ref_to_Parameter'>timep</span></a><span class='Delimiter'>; 
</span> 
    <a href="localtime.c.html#LN1717"><span class='Ref_To_Local'>sp</span></a> <span class='Operator'>= &</span><a href="localtime.c.html#LN1715"><span class='Ref_to_Parameter'>tz</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN62"><span class='Ref_to_Member'>state</span></a><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Locate the abbreviation in the zone's abbreviation list.  We assume 
     * there are not duplicates in the list. 
     */ 
</span>    <a href="localtime.c.html#LN1718"><span class='Ref_To_Local'>abbrs</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN1717"><span class='Ref_To_Local'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN51"><span class='Ref_to_Member'>chars</span></a><span class='Delimiter'>; 
</span>    <a href="localtime.c.html#LN1720"><span class='Ref_To_Local'>abbrind</span></a> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span>    <span class='Control'>while</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN1720"><span class='Ref_To_Local'>abbrind</span></a> <span class='Operator'>&LT; </span><a href="localtime.c.html#LN1717"><span class='Ref_To_Local'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN45"><span class='Ref_to_Member'>charcnt</span></a><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span>strcmp<span class='Parentheses'>(</span><a href="localtime.c.html#LN1711"><span class='Ref_to_Parameter'>abbrev</span></a><span class='Delimiter'>, </span><a href="localtime.c.html#LN1718"><span class='Ref_To_Local'>abbrs</span></a> <span class='Operator'>+ </span><a href="localtime.c.html#LN1720"><span class='Ref_To_Local'>abbrind</span></a><span class='Parentheses'>) </span><span class='Operator'>== </span><span class='Number'>0</span><span class='Parentheses'>)</span> 
            <span class='Control'>break</span><span class='Delimiter'>; 
</span>        <span class='Control'>while</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN1718"><span class='Ref_To_Local'>abbrs</span></a><span class='Delimiter'>[</span><a href="localtime.c.html#LN1720"><span class='Ref_To_Local'>abbrind</span></a><span class='Delimiter'>] </span><span class='Operator'>!= </span><span class='String'>'\0'</span><span class='Parentheses'>) 
</span>            <a href="localtime.c.html#LN1720"><span class='Ref_To_Local'>abbrind</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>        <a href="localtime.c.html#LN1720"><span class='Ref_To_Local'>abbrind</span></a><span class='Operator'>++</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN1720"><span class='Ref_To_Local'>abbrind</span></a> <span class='Operator'>&GT;= </span><a href="localtime.c.html#LN1717"><span class='Ref_To_Local'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN45"><span class='Ref_to_Member'>charcnt</span></a><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <span class='Boolean'>false</span><span class='Delimiter'>;</span>           <span class='Comment_Single_Line'>/* not there! */ 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Unlike pg_next_dst_boundary, we needn't sweat about extrapolation 
     * (goback/goahead zones).  Finding the newest or oldest meaning of the 
     * abbreviation should get us what we want, since extrapolation would just 
     * be repeating the newest or oldest meanings. 
     * 
     * Use binary search to locate the first transition &GT; cutoff time. 
     */ 
</span>    <span class='Delimiter'>{ 
</span><a name="LN1753"></a>        <span class='Keyword'>int</span>         <span class='Declare_Local'>lo</span> <span class='Operator'>= </span><span class='Number'>0</span><span class='Delimiter'>; 
</span><a name="LN1754"></a>        <span class='Keyword'>int</span>         <span class='Declare_Local'>hi</span> <span class='Operator'>= </span><a href="localtime.c.html#LN1717"><span class='Ref_To_Local'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN43"><span class='Ref_to_Member'>timecnt</span></a><span class='Delimiter'>; 
</span> 
        <span class='Control'>while</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN1753"><span class='Ref_To_Local'>lo</span></a> <span class='Operator'>&LT; </span><a href="localtime.c.html#LN1754"><span class='Ref_To_Local'>hi</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span><a name="LN1758"></a>            <span class='Keyword'>int</span>         <span class='Declare_Local'>mid</span> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="localtime.c.html#LN1753"><span class='Ref_To_Local'>lo</span></a> <span class='Operator'>+ </span><a href="localtime.c.html#LN1754"><span class='Ref_To_Local'>hi</span></a><span class='Parentheses'>) </span><span class='Operator'>&GT;&GT; </span><span class='Number'>1</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN1723"><span class='Ref_To_Local'>t</span></a> <span class='Operator'>&LT; </span><a href="localtime.c.html#LN1717"><span class='Ref_To_Local'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN48"><span class='Ref_to_Member'>ats</span></a><span class='Delimiter'>[</span><a href="localtime.c.html#LN1758"><span class='Ref_To_Local'>mid</span></a><span class='Delimiter'>]</span><span class='Parentheses'>) 
</span>                <a href="localtime.c.html#LN1754"><span class='Ref_To_Local'>hi</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN1758"><span class='Ref_To_Local'>mid</span></a><span class='Delimiter'>; 
</span>            <span class='Control'>else</span> 
                <a href="localtime.c.html#LN1753"><span class='Ref_To_Local'>lo</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN1758"><span class='Ref_To_Local'>mid</span></a> <span class='Operator'>+ </span><span class='Number'>1</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <a href="localtime.c.html#LN1721"><span class='Ref_To_Local'>cutoff</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN1753"><span class='Ref_To_Local'>lo</span></a><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Scan backwards to find the latest interval using the given abbrev 
     * before the cutoff time. 
     */ 
</span>    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN1722"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN1721"><span class='Ref_To_Local'>cutoff</span></a> <span class='Operator'>- </span><span class='Number'>1</span><span class='Delimiter'>; </span><a href="localtime.c.html#LN1722"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&GT;= </span><span class='Number'>0</span><span class='Delimiter'>; </span><a href="localtime.c.html#LN1722"><span class='Ref_To_Local'>i</span></a><span class='Operator'>--</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="localtime.c.html#LN1719"><span class='Ref_To_Local'>ttisp</span></a> <span class='Operator'>= &</span><a href="localtime.c.html#LN1717"><span class='Ref_To_Local'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN50"><span class='Ref_to_Member'>ttis</span></a><span class='Delimiter'>[</span><a href="localtime.c.html#LN1717"><span class='Ref_To_Local'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN49"><span class='Ref_to_Member'>types</span></a><span class='Delimiter'>[</span><a href="localtime.c.html#LN1722"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]]; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN1719"><span class='Ref_To_Local'>ttisp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN29"><span class='Ref_to_Member'>tt_abbrind</span></a> <span class='Operator'>== </span><a href="localtime.c.html#LN1720"><span class='Ref_To_Local'>abbrind</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Operator'>*</span><a href="localtime.c.html#LN1713"><span class='Ref_to_Parameter'>gmtoff</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN1719"><span class='Ref_To_Local'>ttisp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN27"><span class='Ref_to_Member'>tt_gmtoff</span></a><span class='Delimiter'>; 
</span>            <span class='Operator'>*</span><a href="localtime.c.html#LN1714"><span class='Ref_to_Parameter'>isdst</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN1719"><span class='Ref_To_Local'>ttisp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN28"><span class='Ref_to_Member'>tt_isdst</span></a><span class='Delimiter'>; 
</span>            <span class='Control'>return</span> <span class='Boolean'>true</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * Not there, so scan forwards to find the first one after. 
     */ 
</span>    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN1722"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN1721"><span class='Ref_To_Local'>cutoff</span></a><span class='Delimiter'>; </span><a href="localtime.c.html#LN1722"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="localtime.c.html#LN1717"><span class='Ref_To_Local'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN43"><span class='Ref_to_Member'>timecnt</span></a><span class='Delimiter'>; </span><a href="localtime.c.html#LN1722"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <a href="localtime.c.html#LN1719"><span class='Ref_To_Local'>ttisp</span></a> <span class='Operator'>= &</span><a href="localtime.c.html#LN1717"><span class='Ref_To_Local'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN50"><span class='Ref_to_Member'>ttis</span></a><span class='Delimiter'>[</span><a href="localtime.c.html#LN1717"><span class='Ref_To_Local'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN49"><span class='Ref_to_Member'>types</span></a><span class='Delimiter'>[</span><a href="localtime.c.html#LN1722"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]]; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN1719"><span class='Ref_To_Local'>ttisp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN29"><span class='Ref_to_Member'>tt_abbrind</span></a> <span class='Operator'>== </span><a href="localtime.c.html#LN1720"><span class='Ref_To_Local'>abbrind</span></a><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Operator'>*</span><a href="localtime.c.html#LN1713"><span class='Ref_to_Parameter'>gmtoff</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN1719"><span class='Ref_To_Local'>ttisp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN27"><span class='Ref_to_Member'>tt_gmtoff</span></a><span class='Delimiter'>; 
</span>            <span class='Operator'>*</span><a href="localtime.c.html#LN1714"><span class='Ref_to_Parameter'>isdst</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN1719"><span class='Ref_To_Local'>ttisp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN28"><span class='Ref_to_Member'>tt_isdst</span></a><span class='Delimiter'>; 
</span>            <span class='Control'>return</span> <span class='Boolean'>true</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>return</span> <span class='Boolean'>false</span><span class='Delimiter'>;</span>               <span class='Comment_Single_Line'>/* hm, not actually used in any interval? */ 
</span><span class='Delimiter'>}</span><span class='Auto_Annotations'> &laquo; end pg_interpret_timezone_abbrev &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * If the given timezone uses only one GMT offset, store that offset 
 * into *gmtoff and return true, else return false. 
 */ 
</span><span class='Keyword'>bool 
</span><a name="LN1805"></a><span class='Declare_Function'>pg_get_timezone_offset</span><span class='Parentheses'>(</span><span class='Keyword'>const </span><a href="pgtz.h.html#LN58"><span class='Ref_to_Struct'>pg_tz</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>tz</span><span class='Delimiter'>, </span><span class='Keyword'>long int </span><span class='Operator'>*</span><span class='Declare_Parameter'>gmtoff</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Comment_Multi_Line'>/* 
     * The zone could have more than one ttinfo, if it's historically used 
     * more than one abbreviation.  We return true as long as they all have 
     * the same gmtoff. 
     */ 
</span><a name="LN1812"></a>    <span class='Keyword'>const </span><span class='Control'>struct</span> <a href="pgtz.h.html#LN40"><span class='Ref_to_Struct'>state</span></a> <span class='Operator'>*</span><span class='Declare_Local'>sp</span><span class='Delimiter'>; 
</span><a name="LN1813"></a>    <span class='Keyword'>int</span>         <span class='Declare_Local'>i</span><span class='Delimiter'>; 
</span> 
    <a href="localtime.c.html#LN1812"><span class='Ref_To_Local'>sp</span></a> <span class='Operator'>= &</span><a href="localtime.c.html#LN1805"><span class='Ref_to_Parameter'>tz</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN62"><span class='Ref_to_Member'>state</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>for</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN1813"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>= </span><span class='Number'>1</span><span class='Delimiter'>; </span><a href="localtime.c.html#LN1813"><span class='Ref_To_Local'>i</span></a> <span class='Operator'>&LT; </span><a href="localtime.c.html#LN1812"><span class='Ref_To_Local'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN44"><span class='Ref_to_Member'>typecnt</span></a><span class='Delimiter'>; </span><a href="localtime.c.html#LN1813"><span class='Ref_To_Local'>i</span></a><span class='Operator'>++</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN1812"><span class='Ref_To_Local'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN50"><span class='Ref_to_Member'>ttis</span></a><span class='Delimiter'>[</span><a href="localtime.c.html#LN1813"><span class='Ref_To_Local'>i</span></a><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="pgtz.h.html#LN27"><span class='Ref_to_Member'>tt_gmtoff</span></a> <span class='Operator'>!= </span><a href="localtime.c.html#LN1812"><span class='Ref_To_Local'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN50"><span class='Ref_to_Member'>ttis</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="pgtz.h.html#LN27"><span class='Ref_to_Member'>tt_gmtoff</span></a><span class='Parentheses'>) 
</span>            <span class='Control'>return</span> <span class='Boolean'>false</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Operator'>*</span><a href="localtime.c.html#LN1805"><span class='Ref_to_Parameter'>gmtoff</span></a> <span class='Operator'>= </span><a href="localtime.c.html#LN1812"><span class='Ref_To_Local'>sp</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN50"><span class='Ref_to_Member'>ttis</span></a><span class='Delimiter'>[</span><span class='Number'>0</span><span class='Delimiter'>]</span><span class='Operator'>.</span><a href="pgtz.h.html#LN27"><span class='Ref_to_Member'>tt_gmtoff</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <span class='Boolean'>true</span><span class='Delimiter'>; 
}</span><span class='Auto_Annotations'> &laquo; end pg_get_timezone_offset &raquo; </span> 
 
<span class='Comment_Multi_Line'>/* 
 * Return the name of the current timezone 
 */ 
</span><span class='Keyword'>const char </span><span class='Operator'>* 
</span><a name="LN1829"></a><span class='Declare_Function'>pg_get_timezone_name</span><span class='Parentheses'>(</span><a href="pgtz.h.html#LN58"><span class='Ref_to_Struct'>pg_tz</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>tz</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><a href="localtime.c.html#LN1829"><span class='Ref_to_Parameter'>tz</span></a><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <a href="localtime.c.html#LN1829"><span class='Ref_to_Parameter'>tz</span></a><span class='Operator'>-&GT;</span><a href="pgtz.h.html#LN61"><span class='Ref_to_Member'>TZname</span></a><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> <span class='Null_Value'>NULL</span><span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Multi_Line'>/* 
 * Check whether timezone is acceptable. 
 * 
 * What we are doing here is checking for leap-second-aware timekeeping. 
 * We need to reject such TZ settings because they'll wreak havoc with our 
 * date/time arithmetic. 
 */ 
</span><span class='Keyword'>bool 
</span><a name="LN1844"></a><span class='Declare_Function'>pg_tz_acceptable</span><span class='Parentheses'>(</span><a href="pgtz.h.html#LN58"><span class='Ref_to_Struct'>pg_tz</span></a> <span class='Operator'>*</span><span class='Declare_Parameter'>tz</span><span class='Parentheses'>) 
</span><span class='Delimiter'>{ 
</span><a name="LN1846"></a>    <span class='Control'>struct</span> <a href="../include/pgtime.h.html#LN24"><span class='Ref_to_Struct'>pg_tm</span></a> <span class='Operator'>*</span><span class='Declare_Local'>tt</span><span class='Delimiter'>; 
</span><a name="LN1847"></a>    <a href="../include/pgtime.h.html#LN22"><span class='Ref_to_Typedef'>pg_time_t</span></a>   <span class='Declare_Local'>time2000</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Multi_Line'>/* 
     * To detect leap-second timekeeping, run pg_localtime for what should be 
     * GMT midnight, 2000-01-01.  Insist that the tm_sec value be zero; any 
     * other result has to be due to leap seconds. 
     */ 
</span>    <a href="localtime.c.html#LN1847"><span class='Ref_To_Local'>time2000</span></a> <span class='Operator'>= </span><span class='Parentheses'>(</span><a href="../include/datatype/timestamp.h.html#LN162"><span class='Ref_to_Const'>POSTGRES_EPOCH_JDATE</span></a> <span class='Operator'>- </span><a href="../include/datatype/timestamp.h.html#LN161"><span class='Ref_to_Const'>UNIX_EPOCH_JDATE</span></a><span class='Parentheses'>) </span><span class='Operator'>* </span><a href="../include/datatype/timestamp.h.html#LN85"><span class='Ref_to_Const'>SECS_PER_DAY</span></a><span class='Delimiter'>; 
</span>    <a href="localtime.c.html#LN1846"><span class='Ref_To_Local'>tt</span></a> <span class='Operator'>= </span><a href="../include/pgtime.h.html#LN47"><span class='Ref_to_Proto'>pg_localtime</span></a><span class='Parentheses'>(</span><span class='Operator'>&</span><a href="localtime.c.html#LN1847"><span class='Ref_To_Local'>time2000</span></a><span class='Delimiter'>, </span><a href="localtime.c.html#LN1844"><span class='Ref_to_Parameter'>tz</span></a><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><a href="localtime.c.html#LN1846"><span class='Ref_To_Local'>tt</span></a> <span class='Operator'>|| </span><a href="localtime.c.html#LN1846"><span class='Ref_To_Local'>tt</span></a><span class='Operator'>-&GT;</span><a href="../include/pgtime.h.html#LN26"><span class='Ref_to_Member'>tm_sec</span></a> <span class='Operator'>!= </span><span class='Number'>0</span><span class='Parentheses'>) 
</span>        <span class='Control'>return</span> <span class='Boolean'>false</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> <span class='Boolean'>true</span><span class='Delimiter'>; 
} 
</span></pre>
<table bgcolor='#c0c0c0' width='100%'><tr><td><a href='../../Contents.html'>Contents</a></td></tr>
</table><hr><p class='blurb' align='center'><a href='http://www.sourceinsight.com'>HTML Created by Source Insight Version 4.00.0084 Built on 2017-02-26</a></p>
</body></html>