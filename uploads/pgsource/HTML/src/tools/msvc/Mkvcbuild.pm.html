<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta name="generator" content="Source Insight Version 4.00.0084 Built on 2017-02-26">
<meta charset='UTF-8' />
<style type='text/css'><!--
TD {background-color: #C0C0C0; font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 70%; }
.blurb {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 70%; }
.filename {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 120%; font-weight: bold; }
.dirname {font-family: 'Verdana', 'Arial', 'Helvetica', Sans-Serif; font-size: 100%; font-weight: bold; margin-top: 2.5em;}
--></style>
<title>src\tools\msvc\Mkvcbuild.pm</title>
<LINK REL=StyleSheet HREF="../../../Perl_Source_File.css" TYPE='text/css' MEDIA=screen>
</head>
<body bgcolor=#ffffff>
<table bgcolor='#c0c0c0' width='100%'>
<tr><td><p class='filename'><b>src\tools\msvc\Mkvcbuild.pm</b></p></td>
<td align='right'>
Wed Jun 14 08:26:15 2017
</td></tr>
<tr><td><a href='../../../Contents.html'>Contents</a></td></tr>
</table>
<pre>
</span><span class='Keyword'>package </span>Mkvcbuild<span class='Delimiter'>; 
</span> 
<span class='Comment_Single_Line'># 
# Package that generates build files for msvc build 
# 
# src/tools/msvc/Mkvcbuild.pm 
# 
</span><span class='Control'>use</span> Carp<span class='Delimiter'>; 
</span><span class='Control'>use</span> Win32<span class='Delimiter'>; 
</span><span class='Control'>use</span> strict<span class='Delimiter'>; 
</span><span class='Control'>use</span> warnings<span class='Delimiter'>; 
</span><span class='Control'>use</span> Project<span class='Delimiter'>; 
</span><span class='Control'>use</span> Solution<span class='Delimiter'>; 
</span><span class='Control'>use</span> Cwd<span class='Delimiter'>; 
</span><span class='Control'>use</span> File<span class='Operator'>::</span>Copy<span class='Delimiter'>; 
</span><span class='Control'>use</span> Config<span class='Delimiter'>; 
</span><span class='Control'>use</span> VSObjectFactory<span class='Delimiter'>; 
</span><span class='Control'>use</span> List<span class='Operator'>::</span>Util <span class='Keyword'>qw</span><span class='String'>(first)</span><span class='Delimiter'>; 
</span> 
<span class='Control'>use</span> Exporter<span class='Delimiter'>; 
</span><span class='Keyword'>our </span><span class='Parentheses'>(</span>@ISA<span class='Delimiter'>, </span>@EXPORT_OK<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>@ISA       <span class='Operator'>= </span><span class='Keyword'>qw</span><span class='String'>(Exporter)</span><span class='Delimiter'>; 
</span>@EXPORT_OK <span class='Operator'>= </span><span class='Keyword'>qw</span><span class='String'>(Mkvcbuild)</span><span class='Delimiter'>; 
</span> 
<span class='Keyword'>my </span>$solution<span class='Delimiter'>; 
</span><span class='Keyword'>my </span>$libpgport<span class='Delimiter'>; 
</span><span class='Keyword'>my </span>$libpgcommon<span class='Delimiter'>; 
</span><span class='Keyword'>my </span>$libpgfeutils<span class='Delimiter'>; 
</span><span class='Keyword'>my </span>$postgres<span class='Delimiter'>; 
</span><span class='Keyword'>my </span>$libpq<span class='Delimiter'>; 
</span> 
<span class='Comment_Single_Line'># Set of variables for modules in contrib/ and src/test/modules/ 
</span><span class='Keyword'>my </span>$contrib_defines <span class='Operator'>= </span><span class='Delimiter'>{ </span><span class='String'>'refint'</span> <span class='Operator'>=&GT; </span><span class='String'>'REFINT_VERBOSE'</span> <span class='Delimiter'>}; 
</span><span class='Keyword'>my </span>@contrib_uselibpq <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='String'>'dblink'</span><span class='Delimiter'>, </span><span class='String'>'oid2name'</span><span class='Delimiter'>, </span><span class='String'>'postgres_fdw'</span><span class='Delimiter'>, </span><span class='String'>'vacuumlo'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><span class='Keyword'>my </span>@contrib_uselibpgport   <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='String'>'oid2name'</span><span class='Delimiter'>, </span><span class='String'>'pg_standby'</span><span class='Delimiter'>, </span><span class='String'>'vacuumlo'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><span class='Keyword'>my </span>@contrib_uselibpgcommon <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='String'>'oid2name'</span><span class='Delimiter'>, </span><span class='String'>'pg_standby'</span><span class='Delimiter'>, </span><span class='String'>'vacuumlo'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><span class='Keyword'>my </span>$contrib_extralibs      <span class='Operator'>= </span><span class='Keyword'>undef</span><span class='Delimiter'>; 
</span><span class='Keyword'>my </span>$contrib_extraincludes <span class='Operator'>= </span><span class='Delimiter'>{ </span><span class='String'>'dblink'</span> <span class='Operator'>=&GT; </span><span class='Delimiter'>[</span><span class='String'>'src/backend'</span><span class='Delimiter'>] }; 
</span><span class='Keyword'>my </span>$contrib_extrasource <span class='Operator'>= </span><span class='Delimiter'>{ 
</span>    <span class='String'>'cube'</span> <span class='Operator'>=&GT; </span><span class='Delimiter'>[ </span><span class='String'>'contrib/cube/cubescan.l'</span><span class='Delimiter'>, </span><span class='String'>'contrib/cube/cubeparse.y'</span> <span class='Delimiter'>], 
</span>    <span class='String'>'seg'</span>  <span class='Operator'>=&GT; </span><span class='Delimiter'>[ </span><span class='String'>'contrib/seg/segscan.l'</span><span class='Delimiter'>,</span>   <span class='String'>'contrib/seg/segparse.y'</span> <span class='Delimiter'>], }; 
</span><span class='Keyword'>my </span>@contrib_excludes <span class='Operator'>= </span><span class='Parentheses'>( 
</span>    <span class='String'>'commit_ts'</span><span class='Delimiter'>,</span>       <span class='String'>'hstore_plperl'</span><span class='Delimiter'>, 
</span>    <span class='String'>'hstore_plpython'</span><span class='Delimiter'>, </span><span class='String'>'intagg'</span><span class='Delimiter'>, 
</span>    <span class='String'>'ltree_plpython'</span><span class='Delimiter'>,</span>  <span class='String'>'pgcrypto'</span><span class='Delimiter'>, 
</span>    <span class='String'>'sepgsql'</span><span class='Delimiter'>,</span>         <span class='String'>'brin'</span><span class='Delimiter'>, 
</span>    <span class='String'>'test_extensions'</span><span class='Delimiter'>, </span><span class='String'>'test_pg_dump'</span><span class='Delimiter'>, 
</span>    <span class='String'>'snapshot_too_old'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
<span class='Comment_Single_Line'># Set of variables for frontend modules 
</span><span class='Keyword'>my </span>$frontend_defines <span class='Operator'>= </span><span class='Delimiter'>{ </span><span class='String'>'initdb'</span> <span class='Operator'>=&GT; </span><span class='String'>'FRONTEND'</span> <span class='Delimiter'>}; 
</span><span class='Keyword'>my </span>@frontend_uselibpq <span class='Operator'>= </span><span class='Parentheses'>(</span><span class='String'>'pg_ctl'</span><span class='Delimiter'>, </span><span class='String'>'pg_upgrade'</span><span class='Delimiter'>, </span><span class='String'>'pgbench'</span><span class='Delimiter'>, </span><span class='String'>'psql'</span><span class='Delimiter'>, </span><span class='String'>'initdb'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><span class='Keyword'>my </span>@frontend_uselibpgport <span class='Operator'>= </span><span class='Parentheses'>( 
</span>    <span class='String'>'pg_archivecleanup'</span><span class='Delimiter'>, </span><span class='String'>'pg_test_fsync'</span><span class='Delimiter'>, 
</span>    <span class='String'>'pg_test_timing'</span><span class='Delimiter'>,</span>    <span class='String'>'pg_upgrade'</span><span class='Delimiter'>, 
</span>    <span class='String'>'pg_waldump'</span><span class='Delimiter'>,</span>        <span class='String'>'pgbench'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><span class='Keyword'>my </span>@frontend_uselibpgcommon <span class='Operator'>= </span><span class='Parentheses'>( 
</span>    <span class='String'>'pg_archivecleanup'</span><span class='Delimiter'>, </span><span class='String'>'pg_test_fsync'</span><span class='Delimiter'>, 
</span>    <span class='String'>'pg_test_timing'</span><span class='Delimiter'>,</span>    <span class='String'>'pg_upgrade'</span><span class='Delimiter'>, 
</span>    <span class='String'>'pg_waldump'</span><span class='Delimiter'>,</span>        <span class='String'>'pgbench'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span><span class='Keyword'>my </span>$frontend_extralibs <span class='Operator'>= </span><span class='Delimiter'>{ 
</span>    <span class='String'>'initdb'</span>     <span class='Operator'>=&GT; </span><span class='Delimiter'>[</span><span class='String'>'ws2_32.lib'</span><span class='Delimiter'>], 
</span>    <span class='String'>'pg_restore'</span> <span class='Operator'>=&GT; </span><span class='Delimiter'>[</span><span class='String'>'ws2_32.lib'</span><span class='Delimiter'>], 
</span>    <span class='String'>'pgbench'</span>    <span class='Operator'>=&GT; </span><span class='Delimiter'>[</span><span class='String'>'ws2_32.lib'</span><span class='Delimiter'>], 
</span>    <span class='String'>'psql'</span>       <span class='Operator'>=&GT; </span><span class='Delimiter'>[</span><span class='String'>'ws2_32.lib'</span><span class='Delimiter'>] }; 
</span><span class='Keyword'>my </span>$frontend_extraincludes <span class='Operator'>= </span><span class='Delimiter'>{ 
</span>    <span class='String'>'initdb'</span> <span class='Operator'>=&GT; </span><span class='Delimiter'>[</span><span class='String'>'src/timezone'</span><span class='Delimiter'>], 
</span>    <span class='String'>'psql'</span>   <span class='Operator'>=&GT; </span><span class='Delimiter'>[</span><span class='String'>'src/backend'</span><span class='Delimiter'>] }; 
</span><span class='Keyword'>my </span>$frontend_extrasource <span class='Operator'>= </span><span class='Delimiter'>{ 
</span>    <span class='String'>'psql'</span> <span class='Operator'>=&GT; </span><span class='Delimiter'>[</span><span class='String'>'src/bin/psql/psqlscanslash.l'</span><span class='Delimiter'>], 
</span>    <span class='String'>'pgbench'</span> <span class='Operator'>=&GT; 
</span>      <span class='Delimiter'>[ </span><span class='String'>'src/bin/pgbench/exprscan.l'</span><span class='Delimiter'>, </span><span class='String'>'src/bin/pgbench/exprparse.y'</span> <span class='Delimiter'>] }; 
</span><span class='Keyword'>my </span>@frontend_excludes <span class='Operator'>= </span><span class='Parentheses'>( 
</span>    <span class='String'>'pgevent'</span><span class='Delimiter'>,</span>    <span class='String'>'pg_basebackup'</span><span class='Delimiter'>, </span><span class='String'>'pg_rewind'</span><span class='Delimiter'>, </span><span class='String'>'pg_dump'</span><span class='Delimiter'>, 
</span>    <span class='String'>'pg_waldump'</span><span class='Delimiter'>, </span><span class='String'>'scripts'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
<a name="LN76"></a><span class='Control'>sub</span> <span class='Declare_Function'>mkvcbuild</span> 
<span class='Delimiter'>{ 
</span>    <span class='Keyword'>our </span>$config <span class='Operator'>= </span><span class='Keyword'>shift</span><span class='Delimiter'>; 
</span> 
    <span class='Keyword'>chdir</span><span class='Parentheses'>(</span><span class='String'>'../../..'</span><span class='Parentheses'>) </span><span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>-</span>d <span class='String'>'../msvc'</span> <span class='Operator'>&& -</span>d <span class='String'>'../../../src'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>die</span> <span class='String'>'Must run from root or msvc directory'</span> 
      <span class='Control'>unless</span> <span class='Parentheses'>(</span><span class='Operator'>-</span>d <span class='String'>'src/tools/msvc'</span> <span class='Operator'>&& -</span>d <span class='String'>'src'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Keyword'>my </span>$vsVersion <span class='Operator'>= </span><a href="VSObjectFactory.pm.html#LN100"><span class='Ref_to_Func'>DetermineVisualStudioVersion</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span> 
    $solution <span class='Operator'>= </span><a href="VSObjectFactory.pm.html#LN22"><span class='Ref_to_Func'>CreateSolution</span></a><span class='Parentheses'>(</span>$vsVersion<span class='Delimiter'>, </span>$config<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Keyword'>our </span>@pgportfiles <span class='Operator'>= </span><span class='Keyword'>qw</span><span class='String'>( 
</span>      chklocale<span class='Operator'>.</span>c <span class='Keyword'>crypt</span><span class='Operator'>.</span>c fls<span class='Operator'>.</span>c fseeko<span class='Operator'>.</span>c getrusage<span class='Operator'>.</span>c inet_aton<span class='Operator'>.</span>c random<span class='Operator'>.</span>c 
      srandom<span class='Operator'>.</span>c getaddrinfo<span class='Operator'>.</span>c gettimeofday<span class='Operator'>.</span>c inet_net_ntop<span class='Operator'>.</span>c <span class='Keyword'>kill</span><span class='Operator'>.</span>c <span class='Keyword'>open</span><span class='Operator'>.</span>c 
      erand48<span class='Operator'>.</span>c snprintf<span class='Operator'>.</span>c strlcat<span class='Operator'>.</span>c strlcpy<span class='Operator'>.</span>c dirmod<span class='Operator'>.</span>c noblock<span class='Operator'>.</span>c path<span class='Operator'>.</span>c 
      pg_strong_random<span class='Operator'>.</span>c pgcheckdir<span class='Operator'>.</span>c pgmkdirp<span class='Operator'>.</span>c pgsleep<span class='Operator'>.</span>c pgstrcasecmp<span class='Operator'>.</span>c 
      pqsignal<span class='Operator'>.</span>c mkdtemp<span class='Operator'>.</span>c qsort<span class='Operator'>.</span>c qsort_arg<span class='Operator'>.</span>c quotes<span class='Operator'>.</span>c <span class='Keyword'>system</span><span class='Operator'>.</span>c 
      sprompt<span class='Operator'>.</span>c tar<span class='Operator'>.</span>c thread<span class='Operator'>.</span>c getopt<span class='Operator'>.</span>c getopt_long<span class='Operator'>.</span>c dirent<span class='Operator'>.</span>c 
      win32env<span class='Operator'>.</span>c win32error<span class='Operator'>.</span>c win32security<span class='Operator'>.</span>c win32setlocale<span class='Operator'>.</span>c<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Keyword'>push</span><span class='Parentheses'>(</span>@pgportfiles<span class='Delimiter'>, </span><span class='String'>'rint.c'</span><span class='Parentheses'>) </span><span class='Control'>if</span> <span class='Parentheses'>(</span>$vsVersion <span class='Operator'>&LT; </span><span class='String'>'12.00'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span>$vsVersion <span class='Operator'>&GT;= </span><span class='String'>'9.00'</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Keyword'>push</span><span class='Parentheses'>(</span>@pgportfiles<span class='Delimiter'>, </span><span class='String'>'pg_crc32c_choose.c'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Keyword'>push</span><span class='Parentheses'>(</span>@pgportfiles<span class='Delimiter'>, </span><span class='String'>'pg_crc32c_sse42.c'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Keyword'>push</span><span class='Parentheses'>(</span>@pgportfiles<span class='Delimiter'>, </span><span class='String'>'pg_crc32c_sb8.c'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Keyword'>push</span><span class='Parentheses'>(</span>@pgportfiles<span class='Delimiter'>, </span><span class='String'>'pg_crc32c_sb8.c'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Keyword'>our </span>@pgcommonallfiles <span class='Operator'>= </span><span class='Keyword'>qw</span><span class='String'>( 
</span>      base64<span class='Operator'>.</span>c config_info<span class='Operator'>.</span>c controldata_utils<span class='Operator'>.</span>c <span class='Keyword'>exec</span><span class='Operator'>.</span>c ip<span class='Operator'>.</span>c keywords<span class='Operator'>.</span>c 
      md5<span class='Operator'>.</span>c pg_lzcompress<span class='Operator'>.</span>c pgfnames<span class='Operator'>.</span>c psprintf<span class='Operator'>.</span>c relpath<span class='Operator'>.</span>c rmtree<span class='Operator'>.</span>c 
      saslprep<span class='Operator'>.</span>c scram<span class='Operator'>-</span>common<span class='Operator'>.</span>c string<span class='Operator'>.</span>c unicode_norm<span class='Operator'>.</span>c username<span class='Operator'>.</span>c 
      wait_error<span class='Operator'>.</span>c<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span>$solution<span class='Operator'>-&GT;</span><span class='Delimiter'>{</span>options<span class='Delimiter'>}</span><span class='Operator'>-&GT;</span><span class='Delimiter'>{</span>openssl<span class='Delimiter'>}</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Keyword'>push</span><span class='Parentheses'>(</span>@pgcommonallfiles<span class='Delimiter'>, </span><span class='String'>'sha2_openssl.c'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Keyword'>push</span><span class='Parentheses'>(</span>@pgcommonallfiles<span class='Delimiter'>, </span><span class='String'>'sha2.c'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Keyword'>our </span>@pgcommonfrontendfiles <span class='Operator'>= </span><span class='Parentheses'>( 
</span>        @pgcommonallfiles<span class='Delimiter'>, </span><span class='Keyword'>qw</span><span class='String'>(fe_memutils.c file_utils.c 
</span>          restricted_token<span class='Operator'>.</span>c<span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <span class='Keyword'>our </span>@pgcommonbkndfiles <span class='Operator'>= </span>@pgcommonallfiles<span class='Delimiter'>; 
</span> 
    <span class='Keyword'>our </span>@pgfeutilsfiles <span class='Operator'>= </span><span class='Keyword'>qw</span><span class='String'>( 
</span>      mbprint<span class='Operator'>.</span>c <span class='Keyword'>print</span><span class='Operator'>.</span>c psqlscan<span class='Operator'>.</span>l psqlscan<span class='Operator'>.</span>c simple_list<span class='Operator'>.</span>c string_utils<span class='Operator'>.</span>c<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    $libpgport <span class='Operator'>= </span>$solution<span class='Operator'>-&GT;</span><a href="Solution.pm.html#LN513"><span class='Ref_to_Func'>AddProject</span></a><span class='Parentheses'>(</span><span class='String'>'libpgport'</span><span class='Delimiter'>, </span><span class='String'>'lib'</span><span class='Delimiter'>, </span><span class='String'>'misc'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $libpgport<span class='Operator'>-&GT;</span><a href="MSBuildProject.pm.html#LN85"><span class='Ref_to_Func'>AddDefine</span></a><span class='Parentheses'>(</span><span class='String'>'FRONTEND'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $libpgport<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN47"><span class='Ref_to_Func'>AddFiles</span></a><span class='Parentheses'>(</span><span class='String'>'src/port'</span><span class='Delimiter'>, </span>@pgportfiles<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    $libpgcommon <span class='Operator'>= </span>$solution<span class='Operator'>-&GT;</span><a href="Solution.pm.html#LN513"><span class='Ref_to_Func'>AddProject</span></a><span class='Parentheses'>(</span><span class='String'>'libpgcommon'</span><span class='Delimiter'>, </span><span class='String'>'lib'</span><span class='Delimiter'>, </span><span class='String'>'misc'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $libpgcommon<span class='Operator'>-&GT;</span><a href="MSBuildProject.pm.html#LN85"><span class='Ref_to_Func'>AddDefine</span></a><span class='Parentheses'>(</span><span class='String'>'FRONTEND'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $libpgcommon<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN47"><span class='Ref_to_Func'>AddFiles</span></a><span class='Parentheses'>(</span><span class='String'>'src/common'</span><span class='Delimiter'>, </span>@pgcommonfrontendfiles<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    $libpgfeutils <span class='Operator'>= </span>$solution<span class='Operator'>-&GT;</span><a href="Solution.pm.html#LN513"><span class='Ref_to_Func'>AddProject</span></a><span class='Parentheses'>(</span><span class='String'>'libpgfeutils'</span><span class='Delimiter'>, </span><span class='String'>'lib'</span><span class='Delimiter'>, </span><span class='String'>'misc'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $libpgfeutils<span class='Operator'>-&GT;</span><a href="MSBuildProject.pm.html#LN85"><span class='Ref_to_Func'>AddDefine</span></a><span class='Parentheses'>(</span><span class='String'>'FRONTEND'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $libpgfeutils<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN140"><span class='Ref_to_Func'>AddIncludeDir</span></a><span class='Parentheses'>(</span><span class='String'>'src/interfaces/libpq'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $libpgfeutils<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN47"><span class='Ref_to_Func'>AddFiles</span></a><span class='Parentheses'>(</span><span class='String'>'src/fe_utils'</span><span class='Delimiter'>, </span>@pgfeutilsfiles<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    $postgres <span class='Operator'>= </span>$solution<span class='Operator'>-&GT;</span><a href="Solution.pm.html#LN513"><span class='Ref_to_Func'>AddProject</span></a><span class='Parentheses'>(</span><span class='String'>'postgres'</span><span class='Delimiter'>, </span><span class='String'>'exe'</span><span class='Delimiter'>, </span><span class='String'>''</span><span class='Delimiter'>, </span><span class='String'>'src/backend'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $postgres<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN140"><span class='Ref_to_Func'>AddIncludeDir</span></a><span class='Parentheses'>(</span><span class='String'>'src/backend'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $postgres<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN182"><span class='Ref_to_Func'>AddDir</span></a><span class='Parentheses'>(</span><span class='String'>'src/backend/port/win32'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $postgres<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN40"><span class='Ref_to_Func'>AddFile</span></a><span class='Parentheses'>(</span><span class='String'>'src/backend/utils/fmgrtab.c'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $postgres<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN58"><span class='Ref_to_Func'>ReplaceFile</span></a><span class='Parentheses'>( 
</span>        <span class='String'>'src/backend/port/dynloader.c'</span><span class='Delimiter'>, 
</span>        <span class='String'>'src/backend/port/dynloader/win32.c'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $postgres<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN58"><span class='Ref_to_Func'>ReplaceFile</span></a><span class='Parentheses'>(</span><span class='String'>'src/backend/port/pg_sema.c'</span><span class='Delimiter'>, 
</span>        <span class='String'>'src/backend/port/win32_sema.c'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $postgres<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN58"><span class='Ref_to_Func'>ReplaceFile</span></a><span class='Parentheses'>(</span><span class='String'>'src/backend/port/pg_shmem.c'</span><span class='Delimiter'>, 
</span>        <span class='String'>'src/backend/port/win32_shmem.c'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $postgres<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN47"><span class='Ref_to_Func'>AddFiles</span></a><span class='Parentheses'>(</span><span class='String'>'src/port'</span><span class='Delimiter'>,</span>   @pgportfiles<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $postgres<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN47"><span class='Ref_to_Func'>AddFiles</span></a><span class='Parentheses'>(</span><span class='String'>'src/common'</span><span class='Delimiter'>, </span>@pgcommonbkndfiles<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $postgres<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN182"><span class='Ref_to_Func'>AddDir</span></a><span class='Parentheses'>(</span><span class='String'>'src/timezone'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Single_Line'># We need source files from src/timezone, but that directory's resource 
</span>    <span class='Comment_Single_Line'># file pertains to "zic", not to the backend. 
</span>    $postgres<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN86"><span class='Ref_to_Func'>RemoveFile</span></a><span class='Parentheses'>(</span><span class='String'>'src/timezone/win32ver.rc'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $postgres<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN47"><span class='Ref_to_Func'>AddFiles</span></a><span class='Parentheses'>(</span><span class='String'>'src/backend/parser'</span><span class='Delimiter'>, </span><span class='String'>'scan.l'</span><span class='Delimiter'>, </span><span class='String'>'gram.y'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $postgres<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN47"><span class='Ref_to_Func'>AddFiles</span></a><span class='Parentheses'>(</span><span class='String'>'src/backend/bootstrap'</span><span class='Delimiter'>, </span><span class='String'>'bootscanner.l'</span><span class='Delimiter'>, 
</span>        <span class='String'>'bootparse.y'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $postgres<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN47"><span class='Ref_to_Func'>AddFiles</span></a><span class='Parentheses'>(</span><span class='String'>'src/backend/utils/misc'</span><span class='Delimiter'>, </span><span class='String'>'guc-file.l'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $postgres<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN47"><span class='Ref_to_Func'>AddFiles</span></a><span class='Parentheses'>( 
</span>        <span class='String'>'src/backend/replication'</span><span class='Delimiter'>, </span><span class='String'>'repl_scanner.l'</span><span class='Delimiter'>, 
</span>        <span class='String'>'repl_gram.y'</span><span class='Delimiter'>,</span>             <span class='String'>'syncrep_scanner.l'</span><span class='Delimiter'>, 
</span>        <span class='String'>'syncrep_gram.y'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $postgres<span class='Operator'>-&GT;</span><a href="MSBuildProject.pm.html#LN85"><span class='Ref_to_Func'>AddDefine</span></a><span class='Parentheses'>(</span><span class='String'>'BUILDING_DLL'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $postgres<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN124"><span class='Ref_to_Func'>AddLibrary</span></a><span class='Parentheses'>(</span><span class='String'>'secur32.lib'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $postgres<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN124"><span class='Ref_to_Func'>AddLibrary</span></a><span class='Parentheses'>(</span><span class='String'>'ws2_32.lib'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $postgres<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN124"><span class='Ref_to_Func'>AddLibrary</span></a><span class='Parentheses'>(</span><span class='String'>'wldap32.lib'</span><span class='Parentheses'>) </span><span class='Control'>if</span> <span class='Parentheses'>(</span>$solution<span class='Operator'>-&GT;</span><span class='Delimiter'>{</span>options<span class='Delimiter'>}</span><span class='Operator'>-&GT;</span><span class='Delimiter'>{</span>ldap<span class='Delimiter'>}</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $postgres<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN166"><span class='Ref_to_Func'>FullExportDLL</span></a><span class='Parentheses'>(</span><span class='String'>'postgres.lib'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
   <span class='Comment_Single_Line'># The OBJS scraper doesn't know about ifdefs, so remove be-secure-openssl.c 
</span>   <span class='Comment_Single_Line'># if building without OpenSSL 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span>$solution<span class='Operator'>-&GT;</span><span class='Delimiter'>{</span>options<span class='Delimiter'>}</span><span class='Operator'>-&GT;</span><span class='Delimiter'>{</span>openssl<span class='Delimiter'>}</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        $postgres<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN86"><span class='Ref_to_Func'>RemoveFile</span></a><span class='Parentheses'>(</span><span class='String'>'src/backend/libpq/be-secure-openssl.c'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Keyword'>my </span>$snowball <span class='Operator'>= </span>$solution<span class='Operator'>-&GT;</span><a href="Solution.pm.html#LN513"><span class='Ref_to_Func'>AddProject</span></a><span class='Parentheses'>(</span><span class='String'>'dict_snowball'</span><span class='Delimiter'>, </span><span class='String'>'dll'</span><span class='Delimiter'>, </span><span class='String'>''</span><span class='Delimiter'>, 
</span>        <span class='String'>'src/backend/snowball'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Single_Line'># This Makefile uses VPATH to find most source files in a subdirectory. 
</span>    $snowball<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN98"><span class='Ref_to_Func'>RelocateFiles</span></a><span class='Parentheses'>( 
</span>        <span class='String'>'src/backend/snowball/libstemmer'</span><span class='Delimiter'>, 
</span>        <span class='Control'>sub</span> <span class='Delimiter'>{ 
</span>            <span class='Control'>return</span> <span class='Keyword'>shift </span><span class='Operator'>!~ /(dict_snowball.c|win32ver.rc)$/</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>}</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $snowball<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN140"><span class='Ref_to_Func'>AddIncludeDir</span></a><span class='Parentheses'>(</span><span class='String'>'src/include/snowball'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $snowball<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN112"><span class='Ref_to_Func'>AddReference</span></a><span class='Parentheses'>(</span>$postgres<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Keyword'>my </span>$plpgsql <span class='Operator'>= 
</span>      $solution<span class='Operator'>-&GT;</span><a href="Solution.pm.html#LN513"><span class='Ref_to_Func'>AddProject</span></a><span class='Parentheses'>(</span><span class='String'>'plpgsql'</span><span class='Delimiter'>, </span><span class='String'>'dll'</span><span class='Delimiter'>, </span><span class='String'>'PLs'</span><span class='Delimiter'>, </span><span class='String'>'src/pl/plpgsql/src'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $plpgsql<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN47"><span class='Ref_to_Func'>AddFiles</span></a><span class='Parentheses'>(</span><span class='String'>'src/pl/plpgsql/src'</span><span class='Delimiter'>, </span><span class='String'>'pl_gram.y'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $plpgsql<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN112"><span class='Ref_to_Func'>AddReference</span></a><span class='Parentheses'>(</span>$postgres<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span>$solution<span class='Operator'>-&GT;</span><span class='Delimiter'>{</span>options<span class='Delimiter'>}</span><span class='Operator'>-&GT;</span><span class='Delimiter'>{</span>tcl<span class='Delimiter'>}</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Keyword'>my </span>$found <span class='Operator'>= </span>0<span class='Delimiter'>; 
</span>        <span class='Keyword'>my </span>$pltcl <span class='Operator'>= 
</span>          $solution<span class='Operator'>-&GT;</span><a href="Solution.pm.html#LN513"><span class='Ref_to_Func'>AddProject</span></a><span class='Parentheses'>(</span><span class='String'>'pltcl'</span><span class='Delimiter'>, </span><span class='String'>'dll'</span><span class='Delimiter'>, </span><span class='String'>'PLs'</span><span class='Delimiter'>, </span><span class='String'>'src/pl/tcl'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        $pltcl<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN140"><span class='Ref_to_Func'>AddIncludeDir</span></a><span class='Parentheses'>(</span>$solution<span class='Operator'>-&GT;</span><span class='Delimiter'>{</span>options<span class='Delimiter'>}</span><span class='Operator'>-&GT;</span><span class='Delimiter'>{</span>tcl<span class='Delimiter'>} </span><span class='Operator'>. </span><span class='String'>'/include'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        $pltcl<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN112"><span class='Ref_to_Func'>AddReference</span></a><span class='Parentheses'>(</span>$postgres<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Control'>for</span> <span class='Keyword'>my </span>$tclver <span class='Parentheses'>(</span><span class='Keyword'>qw</span><span class='String'>(86t 85 84)</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Keyword'>my </span>$tcllib <span class='Operator'>= </span>$solution<span class='Operator'>-&GT;</span><span class='Delimiter'>{</span>options<span class='Delimiter'>}</span><span class='Operator'>-&GT;</span><span class='Delimiter'>{</span>tcl<span class='Delimiter'>} </span><span class='Operator'>. </span><span class='String'>"/lib/tcl$tclver.lib"</span><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>-</span>e $tcllib<span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                $pltcl<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN124"><span class='Ref_to_Func'>AddLibrary</span></a><span class='Parentheses'>(</span>$tcllib<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                $found <span class='Operator'>= </span>1<span class='Delimiter'>; 
</span>                <span class='Control'>last</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>die</span> <span class='String'>"Unable to find $solution-&GT;{options}-&GT;{tcl}/lib/tcl&LT;version&GT;.lib"</span> 
          <span class='Control'>unless</span> $found<span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    $libpq <span class='Operator'>= </span>$solution<span class='Operator'>-&GT;</span><a href="Solution.pm.html#LN513"><span class='Ref_to_Func'>AddProject</span></a><span class='Parentheses'>(</span><span class='String'>'libpq'</span><span class='Delimiter'>, </span><span class='String'>'dll'</span><span class='Delimiter'>, </span><span class='String'>'interfaces'</span><span class='Delimiter'>, 
</span>        <span class='String'>'src/interfaces/libpq'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $libpq<span class='Operator'>-&GT;</span><a href="MSBuildProject.pm.html#LN85"><span class='Ref_to_Func'>AddDefine</span></a><span class='Parentheses'>(</span><span class='String'>'FRONTEND'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $libpq<span class='Operator'>-&GT;</span><a href="MSBuildProject.pm.html#LN85"><span class='Ref_to_Func'>AddDefine</span></a><span class='Parentheses'>(</span><span class='String'>'UNSAFE_STAT_OK'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $libpq<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN140"><span class='Ref_to_Func'>AddIncludeDir</span></a><span class='Parentheses'>(</span><span class='String'>'src/port'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $libpq<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN124"><span class='Ref_to_Func'>AddLibrary</span></a><span class='Parentheses'>(</span><span class='String'>'secur32.lib'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $libpq<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN124"><span class='Ref_to_Func'>AddLibrary</span></a><span class='Parentheses'>(</span><span class='String'>'ws2_32.lib'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $libpq<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN124"><span class='Ref_to_Func'>AddLibrary</span></a><span class='Parentheses'>(</span><span class='String'>'wldap32.lib'</span><span class='Parentheses'>) </span><span class='Control'>if</span> <span class='Parentheses'>(</span>$solution<span class='Operator'>-&GT;</span><span class='Delimiter'>{</span>options<span class='Delimiter'>}</span><span class='Operator'>-&GT;</span><span class='Delimiter'>{</span>ldap<span class='Delimiter'>}</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $libpq<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN175"><span class='Ref_to_Func'>UseDef</span></a><span class='Parentheses'>(</span><span class='String'>'src/interfaces/libpq/libpqdll.def'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $libpq<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN58"><span class='Ref_to_Func'>ReplaceFile</span></a><span class='Parentheses'>(</span><span class='String'>'src/interfaces/libpq/libpqrc.c'</span><span class='Delimiter'>, 
</span>        <span class='String'>'src/interfaces/libpq/libpq.rc'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $libpq<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN112"><span class='Ref_to_Func'>AddReference</span></a><span class='Parentheses'>(</span>$libpgport<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
   <span class='Comment_Single_Line'># The OBJS scraper doesn't know about ifdefs, so remove fe-secure-openssl.c 
</span>   <span class='Comment_Single_Line'># and sha2_openssl.c if building without OpenSSL, and remove sha2.c if 
</span>   <span class='Comment_Single_Line'># building with OpenSSL. 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span>$solution<span class='Operator'>-&GT;</span><span class='Delimiter'>{</span>options<span class='Delimiter'>}</span><span class='Operator'>-&GT;</span><span class='Delimiter'>{</span>openssl<span class='Delimiter'>}</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        $libpq<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN86"><span class='Ref_to_Func'>RemoveFile</span></a><span class='Parentheses'>(</span><span class='String'>'src/interfaces/libpq/fe-secure-openssl.c'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        $libpq<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN86"><span class='Ref_to_Func'>RemoveFile</span></a><span class='Parentheses'>(</span><span class='String'>'src/common/sha2_openssl.c'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        $libpq<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN86"><span class='Ref_to_Func'>RemoveFile</span></a><span class='Parentheses'>(</span><span class='String'>'src/common/sha2.c'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Keyword'>my </span>$libpqwalreceiver <span class='Operator'>= 
</span>      $solution<span class='Operator'>-&GT;</span><a href="Solution.pm.html#LN513"><span class='Ref_to_Func'>AddProject</span></a><span class='Parentheses'>(</span><span class='String'>'libpqwalreceiver'</span><span class='Delimiter'>, </span><span class='String'>'dll'</span><span class='Delimiter'>, </span><span class='String'>''</span><span class='Delimiter'>, 
</span>        <span class='String'>'src/backend/replication/libpqwalreceiver'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $libpqwalreceiver<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN140"><span class='Ref_to_Func'>AddIncludeDir</span></a><span class='Parentheses'>(</span><span class='String'>'src/interfaces/libpq'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $libpqwalreceiver<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN112"><span class='Ref_to_Func'>AddReference</span></a><span class='Parentheses'>(</span>$postgres<span class='Delimiter'>, </span>$libpq<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Keyword'>my </span>$pgoutput <span class='Operator'>= </span>$solution<span class='Operator'>-&GT;</span><a href="Solution.pm.html#LN513"><span class='Ref_to_Func'>AddProject</span></a><span class='Parentheses'>(</span><span class='String'>'pgoutput'</span><span class='Delimiter'>, </span><span class='String'>'dll'</span><span class='Delimiter'>, </span><span class='String'>''</span><span class='Delimiter'>, 
</span>        <span class='String'>'src/backend/replication/pgoutput'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $pgoutput<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN112"><span class='Ref_to_Func'>AddReference</span></a><span class='Parentheses'>(</span>$postgres<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Keyword'>my </span>$pgtypes <span class='Operator'>= </span>$solution<span class='Operator'>-&GT;</span><a href="Solution.pm.html#LN513"><span class='Ref_to_Func'>AddProject</span></a><span class='Parentheses'>( 
</span>        <span class='String'>'libpgtypes'</span><span class='Delimiter'>, </span><span class='String'>'dll'</span><span class='Delimiter'>, 
</span>        <span class='String'>'interfaces'</span><span class='Delimiter'>, </span><span class='String'>'src/interfaces/ecpg/pgtypeslib'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $pgtypes<span class='Operator'>-&GT;</span><a href="MSBuildProject.pm.html#LN85"><span class='Ref_to_Func'>AddDefine</span></a><span class='Parentheses'>(</span><span class='String'>'FRONTEND'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $pgtypes<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN112"><span class='Ref_to_Func'>AddReference</span></a><span class='Parentheses'>(</span>$libpgport<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $pgtypes<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN175"><span class='Ref_to_Func'>UseDef</span></a><span class='Parentheses'>(</span><span class='String'>'src/interfaces/ecpg/pgtypeslib/pgtypeslib.def'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $pgtypes<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN140"><span class='Ref_to_Func'>AddIncludeDir</span></a><span class='Parentheses'>(</span><span class='String'>'src/interfaces/ecpg/include'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Keyword'>my </span>$libecpg <span class='Operator'>= </span>$solution<span class='Operator'>-&GT;</span><a href="Solution.pm.html#LN513"><span class='Ref_to_Func'>AddProject</span></a><span class='Parentheses'>(</span><span class='String'>'libecpg'</span><span class='Delimiter'>, </span><span class='String'>'dll'</span><span class='Delimiter'>, </span><span class='String'>'interfaces'</span><span class='Delimiter'>, 
</span>        <span class='String'>'src/interfaces/ecpg/ecpglib'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $libecpg<span class='Operator'>-&GT;</span><a href="MSBuildProject.pm.html#LN85"><span class='Ref_to_Func'>AddDefine</span></a><span class='Parentheses'>(</span><span class='String'>'FRONTEND'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $libecpg<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN140"><span class='Ref_to_Func'>AddIncludeDir</span></a><span class='Parentheses'>(</span><span class='String'>'src/interfaces/ecpg/include'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $libecpg<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN140"><span class='Ref_to_Func'>AddIncludeDir</span></a><span class='Parentheses'>(</span><span class='String'>'src/interfaces/libpq'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $libecpg<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN140"><span class='Ref_to_Func'>AddIncludeDir</span></a><span class='Parentheses'>(</span><span class='String'>'src/port'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $libecpg<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN175"><span class='Ref_to_Func'>UseDef</span></a><span class='Parentheses'>(</span><span class='String'>'src/interfaces/ecpg/ecpglib/ecpglib.def'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $libecpg<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN124"><span class='Ref_to_Func'>AddLibrary</span></a><span class='Parentheses'>(</span><span class='String'>'ws2_32.lib'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $libecpg<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN112"><span class='Ref_to_Func'>AddReference</span></a><span class='Parentheses'>(</span>$libpq<span class='Delimiter'>, </span>$pgtypes<span class='Delimiter'>, </span>$libpgport<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Keyword'>my </span>$libecpgcompat <span class='Operator'>= </span>$solution<span class='Operator'>-&GT;</span><a href="Solution.pm.html#LN513"><span class='Ref_to_Func'>AddProject</span></a><span class='Parentheses'>( 
</span>        <span class='String'>'libecpg_compat'</span><span class='Delimiter'>, </span><span class='String'>'dll'</span><span class='Delimiter'>, 
</span>        <span class='String'>'interfaces'</span><span class='Delimiter'>,</span>     <span class='String'>'src/interfaces/ecpg/compatlib'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $libecpgcompat<span class='Operator'>-&GT;</span><a href="MSBuildProject.pm.html#LN85"><span class='Ref_to_Func'>AddDefine</span></a><span class='Parentheses'>(</span><span class='String'>'FRONTEND'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $libecpgcompat<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN140"><span class='Ref_to_Func'>AddIncludeDir</span></a><span class='Parentheses'>(</span><span class='String'>'src/interfaces/ecpg/include'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $libecpgcompat<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN140"><span class='Ref_to_Func'>AddIncludeDir</span></a><span class='Parentheses'>(</span><span class='String'>'src/interfaces/libpq'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $libecpgcompat<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN175"><span class='Ref_to_Func'>UseDef</span></a><span class='Parentheses'>(</span><span class='String'>'src/interfaces/ecpg/compatlib/compatlib.def'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $libecpgcompat<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN112"><span class='Ref_to_Func'>AddReference</span></a><span class='Parentheses'>(</span>$pgtypes<span class='Delimiter'>, </span>$libecpg<span class='Delimiter'>, </span>$libpgport<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Keyword'>my </span>$ecpg <span class='Operator'>= </span>$solution<span class='Operator'>-&GT;</span><a href="Solution.pm.html#LN513"><span class='Ref_to_Func'>AddProject</span></a><span class='Parentheses'>(</span><span class='String'>'ecpg'</span><span class='Delimiter'>, </span><span class='String'>'exe'</span><span class='Delimiter'>, </span><span class='String'>'interfaces'</span><span class='Delimiter'>, 
</span>        <span class='String'>'src/interfaces/ecpg/preproc'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $ecpg<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN140"><span class='Ref_to_Func'>AddIncludeDir</span></a><span class='Parentheses'>(</span><span class='String'>'src/interfaces/ecpg/include'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $ecpg<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN140"><span class='Ref_to_Func'>AddIncludeDir</span></a><span class='Parentheses'>(</span><span class='String'>'src/interfaces/libpq'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $ecpg<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN151"><span class='Ref_to_Func'>AddPrefixInclude</span></a><span class='Parentheses'>(</span><span class='String'>'src/interfaces/ecpg/preproc'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $ecpg<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN47"><span class='Ref_to_Func'>AddFiles</span></a><span class='Parentheses'>(</span><span class='String'>'src/interfaces/ecpg/preproc'</span><span class='Delimiter'>, </span><span class='String'>'pgc.l'</span><span class='Delimiter'>, </span><span class='String'>'preproc.y'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $ecpg<span class='Operator'>-&GT;</span><a href="MSBuildProject.pm.html#LN85"><span class='Ref_to_Func'>AddDefine</span></a><span class='Parentheses'>(</span><span class='String'>'ECPG_COMPILE'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $ecpg<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN112"><span class='Ref_to_Func'>AddReference</span></a><span class='Parentheses'>(</span>$libpgcommon<span class='Delimiter'>, </span>$libpgport<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Keyword'>my </span>$pgregress_ecpg <span class='Operator'>= 
</span>      $solution<span class='Operator'>-&GT;</span><a href="Solution.pm.html#LN513"><span class='Ref_to_Func'>AddProject</span></a><span class='Parentheses'>(</span><span class='String'>'pg_regress_ecpg'</span><span class='Delimiter'>, </span><span class='String'>'exe'</span><span class='Delimiter'>, </span><span class='String'>'misc'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $pgregress_ecpg<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN40"><span class='Ref_to_Func'>AddFile</span></a><span class='Parentheses'>(</span><span class='String'>'src/interfaces/ecpg/test/pg_regress_ecpg.c'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $pgregress_ecpg<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN40"><span class='Ref_to_Func'>AddFile</span></a><span class='Parentheses'>(</span><span class='String'>'src/test/regress/pg_regress.c'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $pgregress_ecpg<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN140"><span class='Ref_to_Func'>AddIncludeDir</span></a><span class='Parentheses'>(</span><span class='String'>'src/port'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $pgregress_ecpg<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN140"><span class='Ref_to_Func'>AddIncludeDir</span></a><span class='Parentheses'>(</span><span class='String'>'src/test/regress'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $pgregress_ecpg<span class='Operator'>-&GT;</span><a href="MSBuildProject.pm.html#LN85"><span class='Ref_to_Func'>AddDefine</span></a><span class='Parentheses'>(</span><span class='String'>'HOST_TUPLE="i686-pc-win32vc"'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $pgregress_ecpg<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN124"><span class='Ref_to_Func'>AddLibrary</span></a><span class='Parentheses'>(</span><span class='String'>'ws2_32.lib'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $pgregress_ecpg<span class='Operator'>-&GT;</span>AddDirResourceFile<span class='Parentheses'>(</span><span class='String'>'src/interfaces/ecpg/test'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $pgregress_ecpg<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN112"><span class='Ref_to_Func'>AddReference</span></a><span class='Parentheses'>(</span>$libpgcommon<span class='Delimiter'>, </span>$libpgport<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Keyword'>my </span>$isolation_tester <span class='Operator'>= 
</span>      $solution<span class='Operator'>-&GT;</span><a href="Solution.pm.html#LN513"><span class='Ref_to_Func'>AddProject</span></a><span class='Parentheses'>(</span><span class='String'>'isolationtester'</span><span class='Delimiter'>, </span><span class='String'>'exe'</span><span class='Delimiter'>, </span><span class='String'>'misc'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $isolation_tester<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN40"><span class='Ref_to_Func'>AddFile</span></a><span class='Parentheses'>(</span><span class='String'>'src/test/isolation/isolationtester.c'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $isolation_tester<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN40"><span class='Ref_to_Func'>AddFile</span></a><span class='Parentheses'>(</span><span class='String'>'src/test/isolation/specparse.y'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $isolation_tester<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN40"><span class='Ref_to_Func'>AddFile</span></a><span class='Parentheses'>(</span><span class='String'>'src/test/isolation/specscanner.l'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $isolation_tester<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN40"><span class='Ref_to_Func'>AddFile</span></a><span class='Parentheses'>(</span><span class='String'>'src/test/isolation/specparse.c'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $isolation_tester<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN140"><span class='Ref_to_Func'>AddIncludeDir</span></a><span class='Parentheses'>(</span><span class='String'>'src/test/isolation'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $isolation_tester<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN140"><span class='Ref_to_Func'>AddIncludeDir</span></a><span class='Parentheses'>(</span><span class='String'>'src/port'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $isolation_tester<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN140"><span class='Ref_to_Func'>AddIncludeDir</span></a><span class='Parentheses'>(</span><span class='String'>'src/test/regress'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $isolation_tester<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN140"><span class='Ref_to_Func'>AddIncludeDir</span></a><span class='Parentheses'>(</span><span class='String'>'src/interfaces/libpq'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $isolation_tester<span class='Operator'>-&GT;</span><a href="MSBuildProject.pm.html#LN85"><span class='Ref_to_Func'>AddDefine</span></a><span class='Parentheses'>(</span><span class='String'>'HOST_TUPLE="i686-pc-win32vc"'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $isolation_tester<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN124"><span class='Ref_to_Func'>AddLibrary</span></a><span class='Parentheses'>(</span><span class='String'>'ws2_32.lib'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $isolation_tester<span class='Operator'>-&GT;</span>AddDirResourceFile<span class='Parentheses'>(</span><span class='String'>'src/test/isolation'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $isolation_tester<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN112"><span class='Ref_to_Func'>AddReference</span></a><span class='Parentheses'>(</span>$libpq<span class='Delimiter'>, </span>$libpgcommon<span class='Delimiter'>, </span>$libpgport<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Keyword'>my </span>$pgregress_isolation <span class='Operator'>= 
</span>      $solution<span class='Operator'>-&GT;</span><a href="Solution.pm.html#LN513"><span class='Ref_to_Func'>AddProject</span></a><span class='Parentheses'>(</span><span class='String'>'pg_isolation_regress'</span><span class='Delimiter'>, </span><span class='String'>'exe'</span><span class='Delimiter'>, </span><span class='String'>'misc'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $pgregress_isolation<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN40"><span class='Ref_to_Func'>AddFile</span></a><span class='Parentheses'>(</span><span class='String'>'src/test/isolation/isolation_main.c'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $pgregress_isolation<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN40"><span class='Ref_to_Func'>AddFile</span></a><span class='Parentheses'>(</span><span class='String'>'src/test/regress/pg_regress.c'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $pgregress_isolation<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN140"><span class='Ref_to_Func'>AddIncludeDir</span></a><span class='Parentheses'>(</span><span class='String'>'src/port'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $pgregress_isolation<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN140"><span class='Ref_to_Func'>AddIncludeDir</span></a><span class='Parentheses'>(</span><span class='String'>'src/test/regress'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $pgregress_isolation<span class='Operator'>-&GT;</span><a href="MSBuildProject.pm.html#LN85"><span class='Ref_to_Func'>AddDefine</span></a><span class='Parentheses'>(</span><span class='String'>'HOST_TUPLE="i686-pc-win32vc"'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $pgregress_isolation<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN124"><span class='Ref_to_Func'>AddLibrary</span></a><span class='Parentheses'>(</span><span class='String'>'ws2_32.lib'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $pgregress_isolation<span class='Operator'>-&GT;</span>AddDirResourceFile<span class='Parentheses'>(</span><span class='String'>'src/test/isolation'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $pgregress_isolation<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN112"><span class='Ref_to_Func'>AddReference</span></a><span class='Parentheses'>(</span>$libpgcommon<span class='Delimiter'>, </span>$libpgport<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Single_Line'># src/bin 
</span>    <span class='Keyword'>my </span>$D<span class='Delimiter'>; 
</span>    <span class='Keyword'>opendir</span><span class='Parentheses'>(</span>$D<span class='Delimiter'>, </span><span class='String'>'src/bin'</span><span class='Parentheses'>) </span><span class='Operator'>|| </span>croak <span class='String'>"Could not opendir on src/bin!\n"</span><span class='Delimiter'>; 
</span>    <span class='Control'>while</span> <span class='Parentheses'>(</span><span class='Keyword'>my </span>$d <span class='Operator'>= </span><span class='Keyword'>readdir</span><span class='Parentheses'>(</span>$D<span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span>        <span class='Control'>next</span> <span class='Control'>if</span> <span class='Parentheses'>(</span>$d <span class='Operator'>=~ /^\./</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>next</span> <span class='Control'>unless</span> <span class='Parentheses'>(</span><span class='Operator'>-</span>f <span class='String'>"src/bin/$d/Makefile"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>next</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Keyword'>grep </span><span class='Delimiter'>{ </span><span class='Operator'>/^$d$/ </span><span class='Delimiter'>} </span>@frontend_excludes<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="Mkvcbuild.pm.html#LN678"><span class='Ref_to_Func'>AddSimpleFrontend</span></a><span class='Parentheses'>(</span>$d<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Keyword'>my </span>$pgbasebackup <span class='Operator'>= </span><a href="Mkvcbuild.pm.html#LN678"><span class='Ref_to_Func'>AddSimpleFrontend</span></a><span class='Parentheses'>(</span><span class='String'>'pg_basebackup'</span><span class='Delimiter'>, </span>1<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $pgbasebackup<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN40"><span class='Ref_to_Func'>AddFile</span></a><span class='Parentheses'>(</span><span class='String'>'src/bin/pg_basebackup/pg_basebackup.c'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $pgbasebackup<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN124"><span class='Ref_to_Func'>AddLibrary</span></a><span class='Parentheses'>(</span><span class='String'>'ws2_32.lib'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Keyword'>my </span>$pgreceivewal <span class='Operator'>= </span><a href="Mkvcbuild.pm.html#LN678"><span class='Ref_to_Func'>AddSimpleFrontend</span></a><span class='Parentheses'>(</span><span class='String'>'pg_basebackup'</span><span class='Delimiter'>, </span>1<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $pgreceivewal<span class='Operator'>-&GT;</span><span class='Delimiter'>{</span><a href="../../test/perl/PostgresNode.pm.html#LN216"><span class='Ref_to_Func'>name</span></a><span class='Delimiter'>} </span><span class='Operator'>= </span><span class='String'>'pg_receivewal'</span><span class='Delimiter'>; 
</span>    $pgreceivewal<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN40"><span class='Ref_to_Func'>AddFile</span></a><span class='Parentheses'>(</span><span class='String'>'src/bin/pg_basebackup/pg_receivewal.c'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $pgreceivewal<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN124"><span class='Ref_to_Func'>AddLibrary</span></a><span class='Parentheses'>(</span><span class='String'>'ws2_32.lib'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Keyword'>my </span>$pgrecvlogical <span class='Operator'>= </span><a href="Mkvcbuild.pm.html#LN678"><span class='Ref_to_Func'>AddSimpleFrontend</span></a><span class='Parentheses'>(</span><span class='String'>'pg_basebackup'</span><span class='Delimiter'>, </span>1<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $pgrecvlogical<span class='Operator'>-&GT;</span><span class='Delimiter'>{</span><a href="../../test/perl/PostgresNode.pm.html#LN216"><span class='Ref_to_Func'>name</span></a><span class='Delimiter'>} </span><span class='Operator'>= </span><span class='String'>'pg_recvlogical'</span><span class='Delimiter'>; 
</span>    $pgrecvlogical<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN40"><span class='Ref_to_Func'>AddFile</span></a><span class='Parentheses'>(</span><span class='String'>'src/bin/pg_basebackup/pg_recvlogical.c'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $pgrecvlogical<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN124"><span class='Ref_to_Func'>AddLibrary</span></a><span class='Parentheses'>(</span><span class='String'>'ws2_32.lib'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Keyword'>my </span>$pgrewind <span class='Operator'>= </span><a href="Mkvcbuild.pm.html#LN678"><span class='Ref_to_Func'>AddSimpleFrontend</span></a><span class='Parentheses'>(</span><span class='String'>'pg_rewind'</span><span class='Delimiter'>, </span>1<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $pgrewind<span class='Operator'>-&GT;</span><span class='Delimiter'>{</span><a href="../../test/perl/PostgresNode.pm.html#LN216"><span class='Ref_to_Func'>name</span></a><span class='Delimiter'>} </span><span class='Operator'>= </span><span class='String'>'pg_rewind'</span><span class='Delimiter'>; 
</span>    $pgrewind<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN40"><span class='Ref_to_Func'>AddFile</span></a><span class='Parentheses'>(</span><span class='String'>'src/backend/access/transam/xlogreader.c'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $pgrewind<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN124"><span class='Ref_to_Func'>AddLibrary</span></a><span class='Parentheses'>(</span><span class='String'>'ws2_32.lib'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $pgrewind<span class='Operator'>-&GT;</span><a href="MSBuildProject.pm.html#LN85"><span class='Ref_to_Func'>AddDefine</span></a><span class='Parentheses'>(</span><span class='String'>'FRONTEND'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Keyword'>my </span>$pgevent <span class='Operator'>= </span>$solution<span class='Operator'>-&GT;</span><a href="Solution.pm.html#LN513"><span class='Ref_to_Func'>AddProject</span></a><span class='Parentheses'>(</span><span class='String'>'pgevent'</span><span class='Delimiter'>, </span><span class='String'>'dll'</span><span class='Delimiter'>, </span><span class='String'>'bin'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $pgevent<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN47"><span class='Ref_to_Func'>AddFiles</span></a><span class='Parentheses'>(</span><span class='String'>'src/bin/pgevent'</span><span class='Delimiter'>, </span><span class='String'>'pgevent.c'</span><span class='Delimiter'>, </span><span class='String'>'pgmsgevent.rc'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $pgevent<span class='Operator'>-&GT;</span>AddResourceFile<span class='Parentheses'>(</span><span class='String'>'src/bin/pgevent'</span><span class='Delimiter'>, </span><span class='String'>'Eventlog message formatter'</span><span class='Delimiter'>, 
</span>        <span class='String'>'win32'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $pgevent<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN86"><span class='Ref_to_Func'>RemoveFile</span></a><span class='Parentheses'>(</span><span class='String'>'src/bin/pgevent/win32ver.rc'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $pgevent<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN175"><span class='Ref_to_Func'>UseDef</span></a><span class='Parentheses'>(</span><span class='String'>'src/bin/pgevent/pgevent.def'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $pgevent<span class='Operator'>-&GT;</span>DisableLinkerWarnings<span class='Parentheses'>(</span><span class='String'>'4104'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Keyword'>my </span>$pgdump <span class='Operator'>= </span><a href="Mkvcbuild.pm.html#LN678"><span class='Ref_to_Func'>AddSimpleFrontend</span></a><span class='Parentheses'>(</span><span class='String'>'pg_dump'</span><span class='Delimiter'>, </span>1<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $pgdump<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN140"><span class='Ref_to_Func'>AddIncludeDir</span></a><span class='Parentheses'>(</span><span class='String'>'src/backend'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $pgdump<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN40"><span class='Ref_to_Func'>AddFile</span></a><span class='Parentheses'>(</span><span class='String'>'src/bin/pg_dump/pg_dump.c'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $pgdump<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN40"><span class='Ref_to_Func'>AddFile</span></a><span class='Parentheses'>(</span><span class='String'>'src/bin/pg_dump/common.c'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $pgdump<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN40"><span class='Ref_to_Func'>AddFile</span></a><span class='Parentheses'>(</span><span class='String'>'src/bin/pg_dump/pg_dump_sort.c'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $pgdump<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN124"><span class='Ref_to_Func'>AddLibrary</span></a><span class='Parentheses'>(</span><span class='String'>'ws2_32.lib'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Keyword'>my </span>$pgdumpall <span class='Operator'>= </span><a href="Mkvcbuild.pm.html#LN678"><span class='Ref_to_Func'>AddSimpleFrontend</span></a><span class='Parentheses'>(</span><span class='String'>'pg_dump'</span><span class='Delimiter'>, </span>1<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Single_Line'># pg_dumpall doesn't use the files in the Makefile's $(OBJS), unlike 
</span>    <span class='Comment_Single_Line'># pg_dump and pg_restore. 
</span>    <span class='Comment_Single_Line'># So remove their sources from the object, keeping the other setup that 
</span>    <span class='Comment_Single_Line'># AddSimpleFrontend() has done. 
</span>    <span class='Keyword'>my </span>@nodumpall <span class='Operator'>= </span><span class='Keyword'>grep </span><span class='Delimiter'>{ </span><span class='Operator'>m</span><span class='String'>!src/bin/pg_dump/.*\.c$!</span> <span class='Delimiter'>} 
</span>      <span class='Keyword'>keys </span>%<span class='Delimiter'>{ </span>$pgdumpall<span class='Operator'>-&GT;</span><span class='Delimiter'>{</span>files<span class='Delimiter'>} }; 
</span>    <span class='Keyword'>delete </span>@<span class='Delimiter'>{ </span>$pgdumpall<span class='Operator'>-&GT;</span><span class='Delimiter'>{</span>files<span class='Delimiter'>} }{</span>@nodumpall<span class='Delimiter'>}; 
</span>    $pgdumpall<span class='Operator'>-&GT;</span><span class='Delimiter'>{</span><a href="../../test/perl/PostgresNode.pm.html#LN216"><span class='Ref_to_Func'>name</span></a><span class='Delimiter'>} </span><span class='Operator'>= </span><span class='String'>'pg_dumpall'</span><span class='Delimiter'>; 
</span>    $pgdumpall<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN140"><span class='Ref_to_Func'>AddIncludeDir</span></a><span class='Parentheses'>(</span><span class='String'>'src/backend'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $pgdumpall<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN40"><span class='Ref_to_Func'>AddFile</span></a><span class='Parentheses'>(</span><span class='String'>'src/bin/pg_dump/pg_dumpall.c'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $pgdumpall<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN40"><span class='Ref_to_Func'>AddFile</span></a><span class='Parentheses'>(</span><span class='String'>'src/bin/pg_dump/dumputils.c'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $pgdumpall<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN124"><span class='Ref_to_Func'>AddLibrary</span></a><span class='Parentheses'>(</span><span class='String'>'ws2_32.lib'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Keyword'>my </span>$pgrestore <span class='Operator'>= </span><a href="Mkvcbuild.pm.html#LN678"><span class='Ref_to_Func'>AddSimpleFrontend</span></a><span class='Parentheses'>(</span><span class='String'>'pg_dump'</span><span class='Delimiter'>, </span>1<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $pgrestore<span class='Operator'>-&GT;</span><span class='Delimiter'>{</span><a href="../../test/perl/PostgresNode.pm.html#LN216"><span class='Ref_to_Func'>name</span></a><span class='Delimiter'>} </span><span class='Operator'>= </span><span class='String'>'pg_restore'</span><span class='Delimiter'>; 
</span>    $pgrestore<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN140"><span class='Ref_to_Func'>AddIncludeDir</span></a><span class='Parentheses'>(</span><span class='String'>'src/backend'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $pgrestore<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN40"><span class='Ref_to_Func'>AddFile</span></a><span class='Parentheses'>(</span><span class='String'>'src/bin/pg_dump/pg_restore.c'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $pgrestore<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN124"><span class='Ref_to_Func'>AddLibrary</span></a><span class='Parentheses'>(</span><span class='String'>'ws2_32.lib'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Keyword'>my </span>$zic <span class='Operator'>= </span>$solution<span class='Operator'>-&GT;</span><a href="Solution.pm.html#LN513"><span class='Ref_to_Func'>AddProject</span></a><span class='Parentheses'>(</span><span class='String'>'zic'</span><span class='Delimiter'>, </span><span class='String'>'exe'</span><span class='Delimiter'>, </span><span class='String'>'utils'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $zic<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN47"><span class='Ref_to_Func'>AddFiles</span></a><span class='Parentheses'>(</span><span class='String'>'src/timezone'</span><span class='Delimiter'>, </span><span class='String'>'zic.c'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $zic<span class='Operator'>-&GT;</span>AddDirResourceFile<span class='Parentheses'>(</span><span class='String'>'src/timezone'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $zic<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN112"><span class='Ref_to_Func'>AddReference</span></a><span class='Parentheses'>(</span>$libpgcommon<span class='Delimiter'>, </span>$libpgport<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span>$solution<span class='Operator'>-&GT;</span><span class='Delimiter'>{</span>options<span class='Delimiter'>}</span><span class='Operator'>-&GT;</span><span class='Delimiter'>{</span>xml<span class='Delimiter'>}</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Keyword'>push </span>@contrib_excludes<span class='Delimiter'>, </span><span class='String'>'xml2'</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span>$solution<span class='Operator'>-&GT;</span><span class='Delimiter'>{</span>options<span class='Delimiter'>}</span><span class='Operator'>-&GT;</span><span class='Delimiter'>{</span>openssl<span class='Delimiter'>}</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Keyword'>push </span>@contrib_excludes<span class='Delimiter'>, </span><span class='String'>'sslinfo'</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span>$solution<span class='Operator'>-&GT;</span><span class='Delimiter'>{</span>options<span class='Delimiter'>}</span><span class='Operator'>-&GT;</span><span class='Delimiter'>{</span>uuid<span class='Delimiter'>}</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Keyword'>push </span>@contrib_excludes<span class='Delimiter'>, </span><span class='String'>'uuid-ossp'</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Single_Line'># AddProject() does not recognize the constructs used to populate OBJS in 
</span>    <span class='Comment_Single_Line'># the pgcrypto Makefile, so it will discover no files. 
</span>    <span class='Keyword'>my </span>$pgcrypto <span class='Operator'>= 
</span>      $solution<span class='Operator'>-&GT;</span><a href="Solution.pm.html#LN513"><span class='Ref_to_Func'>AddProject</span></a><span class='Parentheses'>(</span><span class='String'>'pgcrypto'</span><span class='Delimiter'>, </span><span class='String'>'dll'</span><span class='Delimiter'>, </span><span class='String'>'crypto'</span><span class='Delimiter'>, </span><span class='String'>'contrib/pgcrypto'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $pgcrypto<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN47"><span class='Ref_to_Func'>AddFiles</span></a><span class='Parentheses'>( 
</span>        <span class='String'>'contrib/pgcrypto'</span><span class='Delimiter'>, </span><span class='String'>'pgcrypto.c'</span><span class='Delimiter'>, 
</span>        <span class='String'>'px.c'</span><span class='Delimiter'>,</span>             <span class='String'>'px-hmac.c'</span><span class='Delimiter'>, 
</span>        <span class='String'>'px-crypt.c'</span><span class='Delimiter'>,</span>       <span class='String'>'crypt-gensalt.c'</span><span class='Delimiter'>, 
</span>        <span class='String'>'crypt-blowfish.c'</span><span class='Delimiter'>, </span><span class='String'>'crypt-des.c'</span><span class='Delimiter'>, 
</span>        <span class='String'>'crypt-md5.c'</span><span class='Delimiter'>,</span>      <span class='String'>'mbuf.c'</span><span class='Delimiter'>, 
</span>        <span class='String'>'pgp.c'</span><span class='Delimiter'>,</span>            <span class='String'>'pgp-armor.c'</span><span class='Delimiter'>, 
</span>        <span class='String'>'pgp-cfb.c'</span><span class='Delimiter'>,</span>        <span class='String'>'pgp-compress.c'</span><span class='Delimiter'>, 
</span>        <span class='String'>'pgp-decrypt.c'</span><span class='Delimiter'>,</span>    <span class='String'>'pgp-encrypt.c'</span><span class='Delimiter'>, 
</span>        <span class='String'>'pgp-info.c'</span><span class='Delimiter'>,</span>       <span class='String'>'pgp-mpi.c'</span><span class='Delimiter'>, 
</span>        <span class='String'>'pgp-pubdec.c'</span><span class='Delimiter'>,</span>     <span class='String'>'pgp-pubenc.c'</span><span class='Delimiter'>, 
</span>        <span class='String'>'pgp-pubkey.c'</span><span class='Delimiter'>,</span>     <span class='String'>'pgp-s2k.c'</span><span class='Delimiter'>, 
</span>        <span class='String'>'pgp-pgsql.c'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span>$solution<span class='Operator'>-&GT;</span><span class='Delimiter'>{</span>options<span class='Delimiter'>}</span><span class='Operator'>-&GT;</span><span class='Delimiter'>{</span>openssl<span class='Delimiter'>}</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        $pgcrypto<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN47"><span class='Ref_to_Func'>AddFiles</span></a><span class='Parentheses'>(</span><span class='String'>'contrib/pgcrypto'</span><span class='Delimiter'>, </span><span class='String'>'openssl.c'</span><span class='Delimiter'>, 
</span>            <span class='String'>'pgp-mpi-openssl.c'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        $pgcrypto<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN47"><span class='Ref_to_Func'>AddFiles</span></a><span class='Parentheses'>( 
</span>            <span class='String'>'contrib/pgcrypto'</span><span class='Delimiter'>, </span><span class='String'>'md5.c'</span><span class='Delimiter'>, 
</span>            <span class='String'>'sha1.c'</span><span class='Delimiter'>,</span>           <span class='String'>'internal.c'</span><span class='Delimiter'>, 
</span>            <span class='String'>'internal-sha2.c'</span><span class='Delimiter'>,</span>  <span class='String'>'blf.c'</span><span class='Delimiter'>, 
</span>            <span class='String'>'rijndael.c'</span><span class='Delimiter'>,</span>       <span class='String'>'pgp-mpi-internal.c'</span><span class='Delimiter'>, 
</span>            <span class='String'>'imath.c'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    $pgcrypto<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN112"><span class='Ref_to_Func'>AddReference</span></a><span class='Parentheses'>(</span>$postgres<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $pgcrypto<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN112"><span class='Ref_to_Func'>AddReference</span></a><span class='Parentheses'>(</span>$libpgcommon<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $pgcrypto<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN124"><span class='Ref_to_Func'>AddLibrary</span></a><span class='Parentheses'>(</span><span class='String'>'ws2_32.lib'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Keyword'>my </span>$mf <span class='Operator'>= </span>Project<span class='Operator'>::</span>read_file<span class='Parentheses'>(</span><span class='String'>'contrib/pgcrypto/Makefile'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <a href="Mkvcbuild.pm.html#LN800"><span class='Ref_to_Func'>GenerateContribSqlFiles</span></a><span class='Parentheses'>(</span><span class='String'>'pgcrypto'</span><span class='Delimiter'>, </span>$mf<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>foreach</span> <span class='Keyword'>my </span>$subdir <span class='Parentheses'>(</span><span class='String'>'contrib'</span><span class='Delimiter'>, </span><span class='String'>'src/test/modules'</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Keyword'>opendir</span><span class='Parentheses'>(</span>$D<span class='Delimiter'>, </span>$subdir<span class='Parentheses'>) </span><span class='Operator'>|| </span>croak <span class='String'>"Could not opendir on $subdir!\n"</span><span class='Delimiter'>; 
</span>        <span class='Control'>while</span> <span class='Parentheses'>(</span><span class='Keyword'>my </span>$d <span class='Operator'>= </span><span class='Keyword'>readdir</span><span class='Parentheses'>(</span>$D<span class='Parentheses'>))</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Control'>next</span> <span class='Control'>if</span> <span class='Parentheses'>(</span>$d <span class='Operator'>=~ /^\./</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>next</span> <span class='Control'>unless</span> <span class='Parentheses'>(</span><span class='Operator'>-</span>f <span class='String'>"$subdir/$d/Makefile"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Control'>next</span> <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Keyword'>grep </span><span class='Delimiter'>{ </span><span class='Operator'>/^$d$/ </span><span class='Delimiter'>} </span>@contrib_excludes<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="Mkvcbuild.pm.html#LN761"><span class='Ref_to_Func'>AddContrib</span></a><span class='Parentheses'>(</span>$subdir<span class='Delimiter'>, </span>$d<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Keyword'>closedir</span><span class='Parentheses'>(</span>$D<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Single_Line'># Build Perl and Python modules after contrib/ modules to satisfy some 
</span>    <span class='Comment_Single_Line'># dependencies with transform contrib modules, like hstore_plpython 
</span>    <span class='Comment_Single_Line'># ltree_plpython and hstore_plperl. 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span>$solution<span class='Operator'>-&GT;</span><span class='Delimiter'>{</span>options<span class='Delimiter'>}</span><span class='Operator'>-&GT;</span><span class='Delimiter'>{</span>python<span class='Delimiter'>}</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span> 
        <span class='Comment_Single_Line'># Attempt to get python version and location. 
</span>        <span class='Comment_Single_Line'># Assume python.exe in specified dir. 
</span>        <span class='Keyword'>my </span>$pythonprog <span class='Operator'>= </span><span class='String'>"import sys;print(sys.prefix);"</span> 
          <span class='Operator'>. </span><span class='String'>"print(str(sys.version_info[0])+str(sys.version_info[1]))"</span><span class='Delimiter'>; 
</span>        <span class='Keyword'>my </span>$prefixcmd <span class='Operator'>= 
</span>          $solution<span class='Operator'>-&GT;</span><span class='Delimiter'>{</span>options<span class='Delimiter'>}</span><span class='Operator'>-&GT;</span><span class='Delimiter'>{</span>python<span class='Delimiter'>} </span><span class='Operator'>. </span><span class='String'>"\\python -c \"$pythonprog\""</span><span class='Delimiter'>; 
</span>        <span class='Keyword'>my </span>$pyout <span class='Operator'>= `</span>$prefixcmd<span class='Operator'>`</span><span class='Delimiter'>; 
</span>        <span class='Control'>die</span> <span class='String'>"Could not query for python version!\n"</span> <span class='Control'>if</span> $<span class='Operator'>?</span><span class='Delimiter'>; 
</span>        <span class='Keyword'>my </span><span class='Parentheses'>(</span>$pyprefix<span class='Delimiter'>, </span>$pyver<span class='Parentheses'>) </span><span class='Operator'>= </span><span class='Keyword'>split</span><span class='Parentheses'>(</span><span class='Operator'>/\r?\n/</span><span class='Delimiter'>, </span>$pyout<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Single_Line'># Sometimes (always?) if python is not present, the execution 
</span>        <span class='Comment_Single_Line'># appears to work, but gives no data... 
</span>        <span class='Control'>die</span> <span class='String'>"Failed to query python for version information\n"</span> 
          <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><span class='Parentheses'>(</span><span class='Keyword'>defined</span><span class='Parentheses'>(</span>$pyprefix<span class='Parentheses'>) </span><span class='Operator'>&& </span><span class='Keyword'>defined</span><span class='Parentheses'>(</span>$pyver<span class='Parentheses'>)))</span><span class='Delimiter'>; 
</span> 
        <span class='Keyword'>my </span>$pymajorver <span class='Operator'>= </span><span class='Keyword'>substr</span><span class='Parentheses'>(</span>$pyver<span class='Delimiter'>, </span>0<span class='Delimiter'>, </span>1<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Keyword'>my </span>$plpython <span class='Operator'>= </span>$solution<span class='Operator'>-&GT;</span><a href="Solution.pm.html#LN513"><span class='Ref_to_Func'>AddProject</span></a><span class='Parentheses'>(</span><span class='String'>'plpython'</span> <span class='Operator'>. </span>$pymajorver<span class='Delimiter'>, 
</span>            <span class='String'>'dll'</span><span class='Delimiter'>, </span><span class='String'>'PLs'</span><span class='Delimiter'>, </span><span class='String'>'src/pl/plpython'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        $plpython<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN140"><span class='Ref_to_Func'>AddIncludeDir</span></a><span class='Parentheses'>(</span>$pyprefix <span class='Operator'>. </span><span class='String'>'/include'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        $plpython<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN124"><span class='Ref_to_Func'>AddLibrary</span></a><span class='Parentheses'>(</span>$pyprefix <span class='Operator'>. </span><span class='String'>"/Libs/python$pyver.lib"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        $plpython<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN112"><span class='Ref_to_Func'>AddReference</span></a><span class='Parentheses'>(</span>$postgres<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
        <span class='Comment_Single_Line'># Add transform modules dependent on plpython 
</span>        <span class='Keyword'>my </span>$hstore_plpython <span class='Operator'>= </span><a href="Mkvcbuild.pm.html#LN699"><span class='Ref_to_Func'>AddTransformModule</span></a><span class='Parentheses'>( 
</span>            <span class='String'>'hstore_plpython'</span> <span class='Operator'>. </span>$pymajorver<span class='Delimiter'>, </span><span class='String'>'contrib/hstore_plpython'</span><span class='Delimiter'>, 
</span>            <span class='String'>'plpython'</span> <span class='Operator'>. </span>$pymajorver<span class='Delimiter'>,</span>        <span class='String'>'src/pl/plpython'</span><span class='Delimiter'>, 
</span>            <span class='String'>'hstore'</span><span class='Delimiter'>,</span>                        <span class='String'>'contrib/hstore'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        $hstore_plpython<span class='Operator'>-&GT;</span><a href="MSBuildProject.pm.html#LN85"><span class='Ref_to_Func'>AddDefine</span></a><span class='Parentheses'>( 
</span>            <span class='String'>'PLPYTHON_LIBNAME="plpython'</span> <span class='Operator'>. </span>$pymajorver <span class='Operator'>. </span><span class='String'>'"'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Keyword'>my </span>$ltree_plpython <span class='Operator'>= </span><a href="Mkvcbuild.pm.html#LN699"><span class='Ref_to_Func'>AddTransformModule</span></a><span class='Parentheses'>( 
</span>            <span class='String'>'ltree_plpython'</span> <span class='Operator'>. </span>$pymajorver<span class='Delimiter'>, </span><span class='String'>'contrib/ltree_plpython'</span><span class='Delimiter'>, 
</span>            <span class='String'>'plpython'</span> <span class='Operator'>. </span>$pymajorver<span class='Delimiter'>,</span>       <span class='String'>'src/pl/plpython'</span><span class='Delimiter'>, 
</span>            <span class='String'>'ltree'</span><span class='Delimiter'>,</span>                        <span class='String'>'contrib/ltree'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        $ltree_plpython<span class='Operator'>-&GT;</span><a href="MSBuildProject.pm.html#LN85"><span class='Ref_to_Func'>AddDefine</span></a><span class='Parentheses'>( 
</span>            <span class='String'>'PLPYTHON_LIBNAME="plpython'</span> <span class='Operator'>. </span>$pymajorver <span class='Operator'>. </span><span class='String'>'"'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span>$solution<span class='Operator'>-&GT;</span><span class='Delimiter'>{</span>options<span class='Delimiter'>}</span><span class='Operator'>-&GT;</span><span class='Delimiter'>{</span>perl<span class='Delimiter'>}</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Keyword'>my </span>$plperlsrc <span class='Operator'>= </span><span class='String'>"src/pl/plperl/"</span><span class='Delimiter'>; 
</span>        <span class='Keyword'>my </span>$plperl <span class='Operator'>= 
</span>          $solution<span class='Operator'>-&GT;</span><a href="Solution.pm.html#LN513"><span class='Ref_to_Func'>AddProject</span></a><span class='Parentheses'>(</span><span class='String'>'plperl'</span><span class='Delimiter'>, </span><span class='String'>'dll'</span><span class='Delimiter'>, </span><span class='String'>'PLs'</span><span class='Delimiter'>, </span><span class='String'>'src/pl/plperl'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        $plperl<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN140"><span class='Ref_to_Func'>AddIncludeDir</span></a><span class='Parentheses'>(</span>$solution<span class='Operator'>-&GT;</span><span class='Delimiter'>{</span>options<span class='Delimiter'>}</span><span class='Operator'>-&GT;</span><span class='Delimiter'>{</span>perl<span class='Delimiter'>} </span><span class='Operator'>. </span><span class='String'>'/lib/CORE'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        $plperl<span class='Operator'>-&GT;</span><a href="MSBuildProject.pm.html#LN85"><span class='Ref_to_Func'>AddDefine</span></a><span class='Parentheses'>(</span><span class='String'>'PLPERL_HAVE_UID_GID'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>foreach</span> <span class='Keyword'>my </span>$xs <span class='Parentheses'>(</span><span class='String'>'SPI.xs'</span><span class='Delimiter'>, </span><span class='String'>'Util.xs'</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Parentheses'>(</span><span class='Keyword'>my </span>$xsc <span class='Operator'>= </span>$xs<span class='Parentheses'>) </span><span class='Operator'>=~ s</span><span class='String'>/\.xs/.c/</span><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span>Solution<span class='Operator'>::</span><a href="Solution.pm.html#LN80"><span class='Ref_to_Func'>IsNewer</span></a><span class='Parentheses'>(</span><span class='String'>"$plperlsrc$xsc"</span><span class='Delimiter'>, </span><span class='String'>"$plperlsrc$xs"</span><span class='Parentheses'>))</span> 
            <span class='Delimiter'>{ 
</span>                <span class='Keyword'>my </span>$xsubppdir <span class='Operator'>= </span>first <span class='Delimiter'>{ </span><span class='Operator'>-</span>e <span class='String'>"$_/ExtUtils/xsubpp"</span> <span class='Delimiter'>} </span>@INC<span class='Delimiter'>; 
</span>                <span class='Keyword'>print </span><span class='String'>"Building $plperlsrc$xsc...\n"</span><span class='Delimiter'>; 
</span>                <span class='Keyword'>system</span><span class='Parentheses'>( </span>$solution<span class='Operator'>-&GT;</span><span class='Delimiter'>{</span>options<span class='Delimiter'>}</span><span class='Operator'>-&GT;</span><span class='Delimiter'>{</span>perl<span class='Delimiter'>} 
</span>                      <span class='Operator'>. </span><span class='String'>'/bin/perl '</span> 
                      <span class='Operator'>. </span><span class='String'>"$xsubppdir/ExtUtils/xsubpp -typemap "</span> 
                      <span class='Operator'>. </span>$solution<span class='Operator'>-&GT;</span><span class='Delimiter'>{</span>options<span class='Delimiter'>}</span><span class='Operator'>-&GT;</span><span class='Delimiter'>{</span>perl<span class='Delimiter'>} 
</span>                      <span class='Operator'>. </span><span class='String'>'/lib/ExtUtils/typemap '</span> 
                      <span class='Operator'>. </span><span class='String'>"$plperlsrc$xs "</span> 
                      <span class='Operator'>. </span><span class='String'>"&GT;$plperlsrc$xsc"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <span class='Control'>if</span> <span class='Parentheses'>((</span><span class='Operator'>!</span><span class='Parentheses'>(</span><span class='Operator'>-</span>f <span class='String'>"$plperlsrc$xsc"</span><span class='Parentheses'>))</span> <span class='Operator'>|| -</span>z <span class='String'>"$plperlsrc$xsc"</span><span class='Parentheses'>)</span> 
                <span class='Delimiter'>{ 
</span>                    <span class='Keyword'>unlink</span><span class='Parentheses'>(</span><span class='String'>"$plperlsrc$xsc"</span><span class='Parentheses'>)</span><span class='Delimiter'>;</span>    <span class='Comment_Single_Line'># if zero size 
</span>                    <span class='Control'>die</span> <span class='String'>"Failed to create $xsc.\n"</span><span class='Delimiter'>; 
</span>                <span class='Delimiter'>} 
</span>            <span class='Delimiter'>} 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span>Solution<span class='Operator'>::</span><a href="Solution.pm.html#LN80"><span class='Ref_to_Func'>IsNewer</span></a><span class='Parentheses'>( 
</span>                <span class='String'>'src/pl/plperl/perlchunks.h'</span><span class='Delimiter'>, 
</span>                <span class='String'>'src/pl/plperl/plc_perlboot.pl'</span><span class='Parentheses'>) 
</span>            <span class='Operator'>|| </span>Solution<span class='Operator'>::</span><a href="Solution.pm.html#LN80"><span class='Ref_to_Func'>IsNewer</span></a><span class='Parentheses'>( 
</span>                <span class='String'>'src/pl/plperl/perlchunks.h'</span><span class='Delimiter'>, 
</span>                <span class='String'>'src/pl/plperl/plc_trusted.pl'</span><span class='Parentheses'>))</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Keyword'>print </span><span class='String'>'Building src/pl/plperl/perlchunks.h ...'</span> <span class='Operator'>. </span><span class='String'>"\n"</span><span class='Delimiter'>; 
</span>            <span class='Keyword'>my </span>$basedir <span class='Operator'>= </span>getcwd<span class='Delimiter'>; 
</span>            <span class='Keyword'>chdir </span><span class='String'>'src/pl/plperl'</span><span class='Delimiter'>; 
</span>            <span class='Keyword'>system</span><span class='Parentheses'>( </span>$solution<span class='Operator'>-&GT;</span><span class='Delimiter'>{</span>options<span class='Delimiter'>}</span><span class='Operator'>-&GT;</span><span class='Delimiter'>{</span>perl<span class='Delimiter'>} 
</span>                  <span class='Operator'>. </span><span class='String'>'/bin/perl '</span> 
                  <span class='Operator'>. </span><span class='String'>'text2macro.pl '</span> 
                  <span class='Operator'>. </span><span class='String'>'--strip="^(\#.*|\s*)$$" '</span> 
                  <span class='Operator'>. </span><span class='String'>'plc_perlboot.pl plc_trusted.pl '</span> 
                  <span class='Operator'>. </span><span class='String'>'&GT;perlchunks.h'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Keyword'>chdir </span>$basedir<span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>((</span><span class='Operator'>!</span><span class='Parentheses'>(</span><span class='Operator'>-</span>f <span class='String'>'src/pl/plperl/perlchunks.h'</span><span class='Parentheses'>))</span> 
                <span class='Operator'>|| -</span>z <span class='String'>'src/pl/plperl/perlchunks.h'</span><span class='Parentheses'>)</span> 
            <span class='Delimiter'>{ 
</span>                <span class='Keyword'>unlink</span><span class='Parentheses'>(</span><span class='String'>'src/pl/plperl/perlchunks.h'</span><span class='Parentheses'>)</span><span class='Delimiter'>;</span>    <span class='Comment_Single_Line'># if zero size 
</span>                <span class='Control'>die</span> <span class='String'>'Failed to create perlchunks.h'</span> <span class='Operator'>. </span><span class='String'>"\n"</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span>Solution<span class='Operator'>::</span><a href="Solution.pm.html#LN80"><span class='Ref_to_Func'>IsNewer</span></a><span class='Parentheses'>( 
</span>                <span class='String'>'src/pl/plperl/plperl_opmask.h'</span><span class='Delimiter'>, 
</span>                <span class='String'>'src/pl/plperl/plperl_opmask.pl'</span><span class='Parentheses'>))</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Keyword'>print </span><span class='String'>'Building src/pl/plperl/plperl_opmask.h ...'</span> <span class='Operator'>. </span><span class='String'>"\n"</span><span class='Delimiter'>; 
</span>            <span class='Keyword'>my </span>$basedir <span class='Operator'>= </span>getcwd<span class='Delimiter'>; 
</span>            <span class='Keyword'>chdir </span><span class='String'>'src/pl/plperl'</span><span class='Delimiter'>; 
</span>            <span class='Keyword'>system</span><span class='Parentheses'>( </span>$solution<span class='Operator'>-&GT;</span><span class='Delimiter'>{</span>options<span class='Delimiter'>}</span><span class='Operator'>-&GT;</span><span class='Delimiter'>{</span>perl<span class='Delimiter'>} 
</span>                  <span class='Operator'>. </span><span class='String'>'/bin/perl '</span> 
                  <span class='Operator'>. </span><span class='String'>'plperl_opmask.pl '</span> 
                  <span class='Operator'>. </span><span class='String'>'plperl_opmask.h'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Keyword'>chdir </span>$basedir<span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>((</span><span class='Operator'>!</span><span class='Parentheses'>(</span><span class='Operator'>-</span>f <span class='String'>'src/pl/plperl/plperl_opmask.h'</span><span class='Parentheses'>))</span> 
                <span class='Operator'>|| -</span>z <span class='String'>'src/pl/plperl/plperl_opmask.h'</span><span class='Parentheses'>)</span> 
            <span class='Delimiter'>{ 
</span>                <span class='Keyword'>unlink</span><span class='Parentheses'>(</span><span class='String'>'src/pl/plperl/plperl_opmask.h'</span><span class='Parentheses'>)</span><span class='Delimiter'>;</span>    <span class='Comment_Single_Line'># if zero size 
</span>                <span class='Control'>die</span> <span class='String'>'Failed to create plperl_opmask.h'</span> <span class='Operator'>. </span><span class='String'>"\n"</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>        <span class='Delimiter'>} 
</span>        $plperl<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN112"><span class='Ref_to_Func'>AddReference</span></a><span class='Parentheses'>(</span>$postgres<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Keyword'>my </span>$perl_path <span class='Operator'>= </span>$solution<span class='Operator'>-&GT;</span><span class='Delimiter'>{</span>options<span class='Delimiter'>}</span><span class='Operator'>-&GT;</span><span class='Delimiter'>{</span>perl<span class='Delimiter'>} </span><span class='Operator'>. </span><span class='String'>'\lib\CORE\perl*.lib'</span><span class='Delimiter'>; 
</span>        <span class='Keyword'>my </span>@perl_libs <span class='Operator'>= 
</span>          <span class='Keyword'>grep </span><span class='Delimiter'>{ </span><span class='Operator'>/perl\d+.lib$/ </span><span class='Delimiter'>} </span><span class='Keyword'>glob</span><span class='Parentheses'>(</span>$perl_path<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span>@perl_libs <span class='Operator'>== </span>1<span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            $plperl<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN124"><span class='Ref_to_Func'>AddLibrary</span></a><span class='Parentheses'>(</span>$perl_libs<span class='Delimiter'>[</span>0<span class='Delimiter'>]</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>        <span class='Control'>else</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Control'>die</span> 
<span class='String'>"could not identify perl library version matching pattern $perl_path\n"</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span> 
        <span class='Comment_Single_Line'># Add transform module dependent on plperl 
</span>        <span class='Keyword'>my </span>$hstore_plperl <span class='Operator'>= </span><a href="Mkvcbuild.pm.html#LN699"><span class='Ref_to_Func'>AddTransformModule</span></a><span class='Parentheses'>( 
</span>            <span class='String'>'hstore_plperl'</span><span class='Delimiter'>, </span><span class='String'>'contrib/hstore_plperl'</span><span class='Delimiter'>, 
</span>            <span class='String'>'plperl'</span><span class='Delimiter'>,</span>        <span class='String'>'src/pl/plperl'</span><span class='Delimiter'>, 
</span>            <span class='String'>'hstore'</span><span class='Delimiter'>,</span>        <span class='String'>'contrib/hstore'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        $hstore_plperl<span class='Operator'>-&GT;</span><a href="MSBuildProject.pm.html#LN85"><span class='Ref_to_Func'>AddDefine</span></a><span class='Parentheses'>(</span><span class='String'>'PLPERL_HAVE_UID_GID'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    $mf <span class='Operator'>= 
</span>      Project<span class='Operator'>::</span>read_file<span class='Parentheses'>(</span><span class='String'>'src/backend/utils/mb/conversion_procs/Makefile'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $mf <span class='Operator'>=~ s</span><span class='String'>{\\\r?\n}{}g; 
</span>    $mf <span class='Operator'>=~ m</span><span class='String'>{SUBDIRS\s*=\s*(.*)$}</span>m 
      <span class='Operator'>|| </span><span class='Control'>die</span> <span class='String'>'Could not match in conversion makefile'</span> <span class='Operator'>. </span><span class='String'>"\n"</span><span class='Delimiter'>; 
</span>    <span class='Control'>foreach</span> <span class='Keyword'>my </span>$sub <span class='Parentheses'>(</span><span class='Keyword'>split </span><span class='Operator'>/\s+/</span><span class='Delimiter'>, </span>$1<span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Keyword'>my </span>$dir <span class='Operator'>= </span><span class='String'>'src/backend/utils/mb/conversion_procs/'</span> <span class='Operator'>. </span>$sub<span class='Delimiter'>; 
</span>        <span class='Keyword'>my </span>$p <span class='Operator'>= </span>$solution<span class='Operator'>-&GT;</span><a href="Solution.pm.html#LN513"><span class='Ref_to_Func'>AddProject</span></a><span class='Parentheses'>(</span>$sub<span class='Delimiter'>, </span><span class='String'>'dll'</span><span class='Delimiter'>, </span><span class='String'>'conversion procs'</span><span class='Delimiter'>, </span>$dir<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        $p<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN40"><span class='Ref_to_Func'>AddFile</span></a><span class='Parentheses'>(</span><span class='String'>"$dir/$sub.c"</span><span class='Parentheses'>)</span><span class='Delimiter'>;</span>    <span class='Comment_Single_Line'># implicit source file 
</span>        $p<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN112"><span class='Ref_to_Func'>AddReference</span></a><span class='Parentheses'>(</span>$postgres<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    $mf <span class='Operator'>= </span>Project<span class='Operator'>::</span>read_file<span class='Parentheses'>(</span><span class='String'>'src/bin/scripts/Makefile'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $mf <span class='Operator'>=~ s</span><span class='String'>{\\\r?\n}{}g; 
</span>    $mf <span class='Operator'>=~ m</span><span class='String'>{PROGRAMS\s*=\s*(.*)$}</span>m 
      <span class='Operator'>|| </span><span class='Control'>die</span> <span class='String'>'Could not match in bin/scripts/Makefile'</span> <span class='Operator'>. </span><span class='String'>"\n"</span><span class='Delimiter'>; 
</span>    <span class='Control'>foreach</span> <span class='Keyword'>my </span>$prg <span class='Parentheses'>(</span><span class='Keyword'>split </span><span class='Operator'>/\s+/</span><span class='Delimiter'>, </span>$1<span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Keyword'>my </span>$proj <span class='Operator'>= </span>$solution<span class='Operator'>-&GT;</span><a href="Solution.pm.html#LN513"><span class='Ref_to_Func'>AddProject</span></a><span class='Parentheses'>(</span>$prg<span class='Delimiter'>, </span><span class='String'>'exe'</span><span class='Delimiter'>, </span><span class='String'>'bin'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        $mf <span class='Operator'>=~ m</span><span class='String'>{$prg\s*:\s*(.*)$}</span>m 
          <span class='Operator'>|| </span><span class='Control'>die</span> <span class='String'>'Could not find script define for $prg'</span> <span class='Operator'>. </span><span class='String'>"\n"</span><span class='Delimiter'>; 
</span>        <span class='Keyword'>my </span>@files <span class='Operator'>= </span><span class='Keyword'>split </span><span class='Operator'>/\s+/</span><span class='Delimiter'>, </span>$1<span class='Delimiter'>; 
</span>        <span class='Control'>foreach</span> <span class='Keyword'>my </span>$f <span class='Parentheses'>(</span>@files<span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            $f <span class='Operator'>=~ s</span><span class='String'>/\.o$/\.c/</span><span class='Delimiter'>; 
</span>            <span class='Control'>if</span> <span class='Parentheses'>(</span>$f <span class='Operator'>=~ /\.c$/</span><span class='Parentheses'>) 
</span>            <span class='Delimiter'>{ 
</span>                $proj<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN40"><span class='Ref_to_Func'>AddFile</span></a><span class='Parentheses'>(</span><span class='String'>'src/bin/scripts/'</span> <span class='Operator'>. </span>$f<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>        <span class='Delimiter'>} 
</span>        $proj<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN140"><span class='Ref_to_Func'>AddIncludeDir</span></a><span class='Parentheses'>(</span><span class='String'>'src/interfaces/libpq'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        $proj<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN112"><span class='Ref_to_Func'>AddReference</span></a><span class='Parentheses'>(</span>$libpq<span class='Delimiter'>, </span>$libpgfeutils<span class='Delimiter'>, </span>$libpgcommon<span class='Delimiter'>, </span>$libpgport<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        $proj<span class='Operator'>-&GT;</span>AddDirResourceFile<span class='Parentheses'>(</span><span class='String'>'src/bin/scripts'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        $proj<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN124"><span class='Ref_to_Func'>AddLibrary</span></a><span class='Parentheses'>(</span><span class='String'>'ws2_32.lib'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Single_Line'># Regression DLL and EXE 
</span>    <span class='Keyword'>my </span>$regress <span class='Operator'>= </span>$solution<span class='Operator'>-&GT;</span><a href="Solution.pm.html#LN513"><span class='Ref_to_Func'>AddProject</span></a><span class='Parentheses'>(</span><span class='String'>'regress'</span><span class='Delimiter'>, </span><span class='String'>'dll'</span><span class='Delimiter'>, </span><span class='String'>'misc'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $regress<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN40"><span class='Ref_to_Func'>AddFile</span></a><span class='Parentheses'>(</span><span class='String'>'src/test/regress/regress.c'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $regress<span class='Operator'>-&GT;</span>AddDirResourceFile<span class='Parentheses'>(</span><span class='String'>'src/test/regress'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $regress<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN112"><span class='Ref_to_Func'>AddReference</span></a><span class='Parentheses'>(</span>$postgres<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Keyword'>my </span>$pgregress <span class='Operator'>= </span>$solution<span class='Operator'>-&GT;</span><a href="Solution.pm.html#LN513"><span class='Ref_to_Func'>AddProject</span></a><span class='Parentheses'>(</span><span class='String'>'pg_regress'</span><span class='Delimiter'>, </span><span class='String'>'exe'</span><span class='Delimiter'>, </span><span class='String'>'misc'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $pgregress<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN40"><span class='Ref_to_Func'>AddFile</span></a><span class='Parentheses'>(</span><span class='String'>'src/test/regress/pg_regress.c'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $pgregress<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN40"><span class='Ref_to_Func'>AddFile</span></a><span class='Parentheses'>(</span><span class='String'>'src/test/regress/pg_regress_main.c'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $pgregress<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN140"><span class='Ref_to_Func'>AddIncludeDir</span></a><span class='Parentheses'>(</span><span class='String'>'src/port'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $pgregress<span class='Operator'>-&GT;</span><a href="MSBuildProject.pm.html#LN85"><span class='Ref_to_Func'>AddDefine</span></a><span class='Parentheses'>(</span><span class='String'>'HOST_TUPLE="i686-pc-win32vc"'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $pgregress<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN124"><span class='Ref_to_Func'>AddLibrary</span></a><span class='Parentheses'>(</span><span class='String'>'ws2_32.lib'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $pgregress<span class='Operator'>-&GT;</span>AddDirResourceFile<span class='Parentheses'>(</span><span class='String'>'src/test/regress'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $pgregress<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN112"><span class='Ref_to_Func'>AddReference</span></a><span class='Parentheses'>(</span>$libpgcommon<span class='Delimiter'>, </span>$libpgport<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Single_Line'># fix up pg_waldump once it's been set up 
</span>    <span class='Comment_Single_Line'># files symlinked on Unix are copied on windows 
</span>    <span class='Keyword'>my </span>$pg_waldump <span class='Operator'>= </span><a href="Mkvcbuild.pm.html#LN678"><span class='Ref_to_Func'>AddSimpleFrontend</span></a><span class='Parentheses'>(</span><span class='String'>'pg_waldump'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $pg_waldump<span class='Operator'>-&GT;</span><a href="MSBuildProject.pm.html#LN85"><span class='Ref_to_Func'>AddDefine</span></a><span class='Parentheses'>(</span><span class='String'>'FRONTEND'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>foreach</span> <span class='Keyword'>my </span>$xf <span class='Parentheses'>(</span><span class='Keyword'>glob</span><span class='Parentheses'>(</span><span class='String'>'src/backend/access/rmgrdesc/*desc.c'</span><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span>        $pg_waldump<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN40"><span class='Ref_to_Func'>AddFile</span></a><span class='Parentheses'>(</span>$xf<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    $pg_waldump<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN40"><span class='Ref_to_Func'>AddFile</span></a><span class='Parentheses'>(</span><span class='String'>'src/backend/access/transam/xlogreader.c'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    $solution<span class='Operator'>-&GT;</span><a href="Solution.pm.html#LN596"><span class='Ref_to_Func'>Save</span></a><span class='Parentheses'>()</span><span class='Delimiter'>; 
</span>    <span class='Control'>return</span> $solution<span class='Operator'>-&GT;</span><span class='Delimiter'>{</span>vcver<span class='Delimiter'>}; 
} 
</span> 
<span class='Comment_Single_Line'>##################### 
# Utility functions # 
##################### 
</span> 
<span class='Comment_Single_Line'># Add a simple frontend project (exe) 
</span><a name="LN678"></a><span class='Control'>sub</span> <span class='Declare_Function'>AddSimpleFrontend</span> 
<span class='Delimiter'>{ 
</span>    <span class='Keyword'>my </span>$n        <span class='Operator'>= </span><span class='Keyword'>shift</span><span class='Delimiter'>; 
</span>    <span class='Keyword'>my </span>$uselibpq <span class='Operator'>= </span><span class='Keyword'>shift</span><span class='Delimiter'>; 
</span> 
    <span class='Keyword'>my </span>$p <span class='Operator'>= </span>$solution<span class='Operator'>-&GT;</span><a href="Solution.pm.html#LN513"><span class='Ref_to_Func'>AddProject</span></a><span class='Parentheses'>(</span>$n<span class='Delimiter'>, </span><span class='String'>'exe'</span><span class='Delimiter'>, </span><span class='String'>'bin'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $p<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN182"><span class='Ref_to_Func'>AddDir</span></a><span class='Parentheses'>(</span><span class='String'>'src/bin/'</span> <span class='Operator'>. </span>$n<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $p<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN112"><span class='Ref_to_Func'>AddReference</span></a><span class='Parentheses'>(</span>$libpgfeutils<span class='Delimiter'>, </span>$libpgcommon<span class='Delimiter'>, </span>$libpgport<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span>$uselibpq<span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        $p<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN140"><span class='Ref_to_Func'>AddIncludeDir</span></a><span class='Parentheses'>(</span><span class='String'>'src/interfaces/libpq'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        $p<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN112"><span class='Ref_to_Func'>AddReference</span></a><span class='Parentheses'>(</span>$libpq<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Single_Line'># Adjust module definition using frontend variables 
</span>    <a href="Mkvcbuild.pm.html#LN856"><span class='Ref_to_Func'>AdjustFrontendProj</span></a><span class='Parentheses'>(</span>$p<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> $p<span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Single_Line'># Add a simple transform module 
</span><a name="LN699"></a><span class='Control'>sub</span> <span class='Declare_Function'>AddTransformModule</span> 
<span class='Delimiter'>{ 
</span>    <span class='Keyword'>my </span>$n              <span class='Operator'>= </span><span class='Keyword'>shift</span><span class='Delimiter'>; 
</span>    <span class='Keyword'>my </span>$n_src          <span class='Operator'>= </span><span class='Keyword'>shift</span><span class='Delimiter'>; 
</span>    <span class='Keyword'>my </span>$pl_proj_name   <span class='Operator'>= </span><span class='Keyword'>shift</span><span class='Delimiter'>; 
</span>    <span class='Keyword'>my </span>$pl_src         <span class='Operator'>= </span><span class='Keyword'>shift</span><span class='Delimiter'>; 
</span>    <span class='Keyword'>my </span>$transform_name <span class='Operator'>= </span><span class='Keyword'>shift</span><span class='Delimiter'>; 
</span>    <span class='Keyword'>my </span>$transform_src  <span class='Operator'>= </span><span class='Keyword'>shift</span><span class='Delimiter'>; 
</span> 
    <span class='Keyword'>my </span>$transform_proj <span class='Operator'>= </span><span class='Keyword'>undef</span><span class='Delimiter'>; 
</span>    <span class='Control'>foreach</span> <span class='Keyword'>my </span>$proj <span class='Parentheses'>(</span>@<span class='Delimiter'>{ </span>$solution<span class='Operator'>-&GT;</span><span class='Delimiter'>{</span>projects<span class='Delimiter'>}</span><span class='Operator'>-&GT;</span><span class='Delimiter'>{</span><span class='String'>'contrib'</span><span class='Delimiter'>} }</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span>$proj<span class='Operator'>-&GT;</span><span class='Delimiter'>{</span><a href="../../test/perl/PostgresNode.pm.html#LN216"><span class='Ref_to_Func'>name</span></a><span class='Delimiter'>} </span><span class='Operator'>eq </span>$transform_name<span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            $transform_proj <span class='Operator'>= </span>$proj<span class='Delimiter'>; 
</span>            <span class='Control'>last</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>die</span> <span class='String'>"could not find base module $transform_name for transform module $n"</span> 
      <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><span class='Keyword'>defined</span><span class='Parentheses'>(</span>$transform_proj<span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <span class='Keyword'>my </span>$pl_proj <span class='Operator'>= </span><span class='Keyword'>undef</span><span class='Delimiter'>; 
</span>    <span class='Control'>foreach</span> <span class='Keyword'>my </span>$proj <span class='Parentheses'>(</span>@<span class='Delimiter'>{ </span>$solution<span class='Operator'>-&GT;</span><span class='Delimiter'>{</span>projects<span class='Delimiter'>}</span><span class='Operator'>-&GT;</span><span class='Delimiter'>{</span><span class='String'>'PLs'</span><span class='Delimiter'>} }</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span>$proj<span class='Operator'>-&GT;</span><span class='Delimiter'>{</span><a href="../../test/perl/PostgresNode.pm.html#LN216"><span class='Ref_to_Func'>name</span></a><span class='Delimiter'>} </span><span class='Operator'>eq </span>$pl_proj_name<span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            $pl_proj <span class='Operator'>= </span>$proj<span class='Delimiter'>; 
</span>            <span class='Control'>last</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>die</span> <span class='String'>"could not find PL $pl_proj_name for transform module $n"</span> 
      <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Operator'>!</span><span class='Keyword'>defined</span><span class='Parentheses'>(</span>$pl_proj<span class='Parentheses'>))</span><span class='Delimiter'>; 
</span> 
    <span class='Keyword'>my </span>$p <span class='Operator'>= </span>$solution<span class='Operator'>-&GT;</span><a href="Solution.pm.html#LN513"><span class='Ref_to_Func'>AddProject</span></a><span class='Parentheses'>(</span>$n<span class='Delimiter'>, </span><span class='String'>'dll'</span><span class='Delimiter'>, </span><span class='String'>'contrib'</span><span class='Delimiter'>, </span>$n_src<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>for</span> <span class='Keyword'>my </span>$file <span class='Parentheses'>(</span><span class='Keyword'>glob</span><span class='Parentheses'>(</span><span class='String'>"$n_src/*.c"</span><span class='Parentheses'>))</span> 
    <span class='Delimiter'>{ 
</span>        $p<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN40"><span class='Ref_to_Func'>AddFile</span></a><span class='Parentheses'>(</span>$file<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    $p<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN112"><span class='Ref_to_Func'>AddReference</span></a><span class='Parentheses'>(</span>$postgres<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Comment_Single_Line'># Add PL dependencies 
</span>    $p<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN140"><span class='Ref_to_Func'>AddIncludeDir</span></a><span class='Parentheses'>(</span>$pl_src<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $p<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN112"><span class='Ref_to_Func'>AddReference</span></a><span class='Parentheses'>(</span>$pl_proj<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $p<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN140"><span class='Ref_to_Func'>AddIncludeDir</span></a><span class='Parentheses'>(</span>$pl_proj<span class='Operator'>-&GT;</span><span class='Delimiter'>{</span>includes<span class='Delimiter'>}</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>foreach</span> <span class='Keyword'>my </span>$pl_lib <span class='Parentheses'>(</span>@<span class='Delimiter'>{ </span>$pl_proj<span class='Operator'>-&GT;</span><span class='Delimiter'>{</span>libraries<span class='Delimiter'>} }</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        $p<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN124"><span class='Ref_to_Func'>AddLibrary</span></a><span class='Parentheses'>(</span>$pl_lib<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Single_Line'># Add base module dependencies 
</span>    $p<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN140"><span class='Ref_to_Func'>AddIncludeDir</span></a><span class='Parentheses'>(</span>$transform_src<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    $p<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN140"><span class='Ref_to_Func'>AddIncludeDir</span></a><span class='Parentheses'>(</span>$transform_proj<span class='Operator'>-&GT;</span><span class='Delimiter'>{</span>includes<span class='Delimiter'>}</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Control'>foreach</span> <span class='Keyword'>my </span>$trans_lib <span class='Parentheses'>(</span>@<span class='Delimiter'>{ </span>$transform_proj<span class='Operator'>-&GT;</span><span class='Delimiter'>{</span>libraries<span class='Delimiter'>} }</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        $p<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN124"><span class='Ref_to_Func'>AddLibrary</span></a><span class='Parentheses'>(</span>$trans_lib<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    $p<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN112"><span class='Ref_to_Func'>AddReference</span></a><span class='Parentheses'>(</span>$transform_proj<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>return</span> $p<span class='Delimiter'>; 
} 
</span> 
<span class='Comment_Single_Line'># Add a simple contrib project 
</span><a name="LN761"></a><span class='Control'>sub</span> <span class='Declare_Function'>AddContrib</span> 
<span class='Delimiter'>{ 
</span>    <span class='Keyword'>my </span>$subdir <span class='Operator'>= </span><span class='Keyword'>shift</span><span class='Delimiter'>; 
</span>    <span class='Keyword'>my </span>$n      <span class='Operator'>= </span><span class='Keyword'>shift</span><span class='Delimiter'>; 
</span>    <span class='Keyword'>my </span>$mf     <span class='Operator'>= </span>Project<span class='Operator'>::</span>read_file<span class='Parentheses'>(</span><span class='String'>"$subdir/$n/Makefile"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span>$mf <span class='Operator'>=~ /^MODULE_big\s*=\s*(.*)$/</span>mg<span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Keyword'>my </span>$dn <span class='Operator'>= </span>$1<span class='Delimiter'>; 
</span>        <span class='Keyword'>my </span>$proj <span class='Operator'>= </span>$solution<span class='Operator'>-&GT;</span><a href="Solution.pm.html#LN513"><span class='Ref_to_Func'>AddProject</span></a><span class='Parentheses'>(</span>$dn<span class='Delimiter'>, </span><span class='String'>'dll'</span><span class='Delimiter'>, </span><span class='String'>'contrib'</span><span class='Delimiter'>, </span><span class='String'>"$subdir/$n"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        $proj<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN112"><span class='Ref_to_Func'>AddReference</span></a><span class='Parentheses'>(</span>$postgres<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="Mkvcbuild.pm.html#LN846"><span class='Ref_to_Func'>AdjustContribProj</span></a><span class='Parentheses'>(</span>$proj<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>elsif</span> <span class='Parentheses'>(</span>$mf <span class='Operator'>=~ /^MODULES\s*=\s*(.*)$/</span>mg<span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>foreach</span> <span class='Keyword'>my </span>$mod <span class='Parentheses'>(</span><span class='Keyword'>split </span><span class='Operator'>/\s+/</span><span class='Delimiter'>, </span>$1<span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Keyword'>my </span>$proj <span class='Operator'>= 
</span>              $solution<span class='Operator'>-&GT;</span><a href="Solution.pm.html#LN513"><span class='Ref_to_Func'>AddProject</span></a><span class='Parentheses'>(</span>$mod<span class='Delimiter'>, </span><span class='String'>'dll'</span><span class='Delimiter'>, </span><span class='String'>'contrib'</span><span class='Delimiter'>, </span><span class='String'>"$subdir/$n"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Keyword'>my </span>$filename <span class='Operator'>= </span>$mod <span class='Operator'>. </span><span class='String'>'.c'</span><span class='Delimiter'>; 
</span>            $proj<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN40"><span class='Ref_to_Func'>AddFile</span></a><span class='Parentheses'>(</span><span class='String'>"$subdir/$n/$filename"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            $proj<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN112"><span class='Ref_to_Func'>AddReference</span></a><span class='Parentheses'>(</span>$postgres<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <a href="Mkvcbuild.pm.html#LN846"><span class='Ref_to_Func'>AdjustContribProj</span></a><span class='Parentheses'>(</span>$proj<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>elsif</span> <span class='Parentheses'>(</span>$mf <span class='Operator'>=~ /^PROGRAM\s*=\s*(.*)$/</span>mg<span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Keyword'>my </span>$proj <span class='Operator'>= </span>$solution<span class='Operator'>-&GT;</span><a href="Solution.pm.html#LN513"><span class='Ref_to_Func'>AddProject</span></a><span class='Parentheses'>(</span>$1<span class='Delimiter'>, </span><span class='String'>'exe'</span><span class='Delimiter'>, </span><span class='String'>'contrib'</span><span class='Delimiter'>, </span><span class='String'>"$subdir/$n"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <a href="Mkvcbuild.pm.html#LN846"><span class='Ref_to_Func'>AdjustContribProj</span></a><span class='Parentheses'>(</span>$proj<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>else</span> 
    <span class='Delimiter'>{ 
</span>        croak <span class='String'>"Could not determine contrib module type for $n\n"</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span> 
    <span class='Comment_Single_Line'># Are there any output data files to build? 
</span>    <a href="Mkvcbuild.pm.html#LN800"><span class='Ref_to_Func'>GenerateContribSqlFiles</span></a><span class='Parentheses'>(</span>$n<span class='Delimiter'>, </span>$mf<span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<a name="LN800"></a><span class='Control'>sub</span> <span class='Declare_Function'>GenerateContribSqlFiles</span> 
<span class='Delimiter'>{ 
</span>    <span class='Keyword'>my </span>$n  <span class='Operator'>= </span><span class='Keyword'>shift</span><span class='Delimiter'>; 
</span>    <span class='Keyword'>my </span>$mf <span class='Operator'>= </span><span class='Keyword'>shift</span><span class='Delimiter'>; 
</span>    $mf <span class='Operator'>=~ s</span><span class='String'>{\\\r?\n}{}g; 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span>$mf <span class='Operator'>=~ /^DATA_built\s*=\s*(.*)$/</span>mg<span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Keyword'>my </span>$l <span class='Operator'>= </span>$1<span class='Delimiter'>; 
</span> 
        <span class='Comment_Single_Line'># Strip out $(addsuffix) rules 
</span>        <span class='Control'>if</span> <span class='Parentheses'>(</span>index<span class='Parentheses'>(</span>$l<span class='Delimiter'>, </span><span class='String'>'$(addsuffix '</span><span class='Parentheses'>) </span><span class='Operator'>&GT;= </span>0<span class='Parentheses'>)</span> 
        <span class='Delimiter'>{ 
</span>            <span class='Keyword'>my </span>$pcount <span class='Operator'>= </span>0<span class='Delimiter'>; 
</span>            <span class='Keyword'>my </span>$i<span class='Delimiter'>; 
</span>            <span class='Control'>for</span> <span class='Parentheses'>(</span>$i <span class='Operator'>= </span>index<span class='Parentheses'>(</span>$l<span class='Delimiter'>, </span><span class='String'>'$(addsuffix '</span><span class='Parentheses'>) </span><span class='Operator'>+ </span>12<span class='Delimiter'>; </span>$i <span class='Operator'>&LT; </span><span class='Keyword'>length</span><span class='Parentheses'>(</span>$l<span class='Parentheses'>)</span><span class='Delimiter'>; </span>$i<span class='Operator'>++</span><span class='Parentheses'>)</span> 
            <span class='Delimiter'>{ 
</span>                $pcount<span class='Operator'>++ </span><span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Keyword'>substr</span><span class='Parentheses'>(</span>$l<span class='Delimiter'>, </span>$i<span class='Delimiter'>, </span>1<span class='Parentheses'>) </span><span class='Operator'>eq </span><span class='String'>'('</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                $pcount<span class='Operator'>-- </span><span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Keyword'>substr</span><span class='Parentheses'>(</span>$l<span class='Delimiter'>, </span>$i<span class='Delimiter'>, </span>1<span class='Parentheses'>) </span><span class='Operator'>eq </span><span class='String'>')'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <span class='Control'>last</span>      <span class='Control'>if</span> <span class='Parentheses'>(</span>$pcount <span class='Operator'>&LT; </span>0<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>            $l <span class='Operator'>= 
</span>              <span class='Keyword'>substr</span><span class='Parentheses'>(</span>$l<span class='Delimiter'>, </span>0<span class='Delimiter'>, </span>index<span class='Parentheses'>(</span>$l<span class='Delimiter'>, </span><span class='String'>'$(addsuffix '</span><span class='Parentheses'>))</span> <span class='Operator'>. </span><span class='Keyword'>substr</span><span class='Parentheses'>(</span>$l<span class='Delimiter'>, </span>$i <span class='Operator'>+ </span>1<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span> 
        <span class='Control'>foreach</span> <span class='Keyword'>my </span>$d <span class='Parentheses'>(</span><span class='Keyword'>split </span><span class='Operator'>/\s+/</span><span class='Delimiter'>, </span>$l<span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Keyword'>my </span>$in  <span class='Operator'>= </span><span class='String'>"$d.in"</span><span class='Delimiter'>; 
</span>            <span class='Keyword'>my </span>$out <span class='Operator'>= </span><span class='String'>"$d"</span><span class='Delimiter'>; 
</span> 
            <span class='Control'>if</span> <span class='Parentheses'>(</span>Solution<span class='Operator'>::</span><a href="Solution.pm.html#LN80"><span class='Ref_to_Func'>IsNewer</span></a><span class='Parentheses'>(</span><span class='String'>"contrib/$n/$out"</span><span class='Delimiter'>, </span><span class='String'>"contrib/$n/$in"</span><span class='Parentheses'>))</span> 
            <span class='Delimiter'>{ 
</span>                <span class='Keyword'>print </span><span class='String'>"Building $out from $in (contrib/$n)...\n"</span><span class='Delimiter'>; 
</span>                <span class='Keyword'>my </span>$cont <span class='Operator'>= </span>Project<span class='Operator'>::</span>read_file<span class='Parentheses'>(</span><span class='String'>"contrib/$n/$in"</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>                <span class='Keyword'>my </span>$dn   <span class='Operator'>= </span>$out<span class='Delimiter'>; 
</span>                $dn   <span class='Operator'>=~ s</span><span class='String'>/\.sql$//</span><span class='Delimiter'>; 
</span>                $cont <span class='Operator'>=~ s</span><span class='String'>/MODULE_PATHNAME/\$libdir\/$dn/</span>g<span class='Delimiter'>; 
</span>                <span class='Keyword'>my </span>$o<span class='Delimiter'>; 
</span>                <span class='Keyword'>open</span><span class='Parentheses'>(</span>$o<span class='Delimiter'>, </span><span class='String'>'&GT;'</span><span class='Delimiter'>, </span><span class='String'>"contrib/$n/$out"</span><span class='Parentheses'>) 
</span>                  <span class='Operator'>|| </span>croak <span class='String'>"Could not write to contrib/$n/$d"</span><span class='Delimiter'>; 
</span>                <span class='Keyword'>print </span>$o $cont<span class='Delimiter'>; 
</span>                <span class='Keyword'>close</span><span class='Parentheses'>(</span>$o<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>            <span class='Delimiter'>} 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>} 
} 
</span> 
<a name="LN846"></a><span class='Control'>sub</span> <span class='Declare_Function'>AdjustContribProj</span> 
<span class='Delimiter'>{ 
</span>    <span class='Keyword'>my </span>$proj <span class='Operator'>= </span><span class='Keyword'>shift</span><span class='Delimiter'>; 
</span>    <a href="Mkvcbuild.pm.html#LN866"><span class='Ref_to_Func'>AdjustModule</span></a><span class='Parentheses'>( 
</span>        $proj<span class='Delimiter'>,</span>                    $contrib_defines<span class='Delimiter'>, 
</span>        <span class='Operator'>\</span>@contrib_uselibpq<span class='Delimiter'>,</span>       <span class='Operator'>\</span>@contrib_uselibpgport<span class='Delimiter'>, 
</span>        <span class='Operator'>\</span>@contrib_uselibpgcommon<span class='Delimiter'>, </span>$contrib_extralibs<span class='Delimiter'>, 
</span>        $contrib_extrasource<span class='Delimiter'>,</span>     $contrib_extraincludes<span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<a name="LN856"></a><span class='Control'>sub</span> <span class='Declare_Function'>AdjustFrontendProj</span> 
<span class='Delimiter'>{ 
</span>    <span class='Keyword'>my </span>$proj <span class='Operator'>= </span><span class='Keyword'>shift</span><span class='Delimiter'>; 
</span>    <a href="Mkvcbuild.pm.html#LN866"><span class='Ref_to_Func'>AdjustModule</span></a><span class='Parentheses'>( 
</span>        $proj<span class='Delimiter'>,</span>                     $frontend_defines<span class='Delimiter'>, 
</span>        <span class='Operator'>\</span>@frontend_uselibpq<span class='Delimiter'>,</span>       <span class='Operator'>\</span>@frontend_uselibpgport<span class='Delimiter'>, 
</span>        <span class='Operator'>\</span>@frontend_uselibpgcommon<span class='Delimiter'>, </span>$frontend_extralibs<span class='Delimiter'>, 
</span>        $frontend_extrasource<span class='Delimiter'>,</span>     $frontend_extraincludes<span class='Parentheses'>)</span><span class='Delimiter'>; 
} 
</span> 
<a name="LN866"></a><span class='Control'>sub</span> <span class='Declare_Function'>AdjustModule</span> 
<span class='Delimiter'>{ 
</span>    <span class='Keyword'>my </span>$proj                  <span class='Operator'>= </span><span class='Keyword'>shift</span><span class='Delimiter'>; 
</span>    <span class='Keyword'>my </span>$module_defines        <span class='Operator'>= </span><span class='Keyword'>shift</span><span class='Delimiter'>; 
</span>    <span class='Keyword'>my </span>$module_uselibpq       <span class='Operator'>= </span><span class='Keyword'>shift</span><span class='Delimiter'>; 
</span>    <span class='Keyword'>my </span>$module_uselibpgport   <span class='Operator'>= </span><span class='Keyword'>shift</span><span class='Delimiter'>; 
</span>    <span class='Keyword'>my </span>$module_uselibpgcommon <span class='Operator'>= </span><span class='Keyword'>shift</span><span class='Delimiter'>; 
</span>    <span class='Keyword'>my </span>$module_extralibs      <span class='Operator'>= </span><span class='Keyword'>shift</span><span class='Delimiter'>; 
</span>    <span class='Keyword'>my </span>$module_extrasource    <span class='Operator'>= </span><span class='Keyword'>shift</span><span class='Delimiter'>; 
</span>    <span class='Keyword'>my </span>$module_extraincludes  <span class='Operator'>= </span><span class='Keyword'>shift</span><span class='Delimiter'>; 
</span>    <span class='Keyword'>my </span>$n                     <span class='Operator'>= </span>$proj<span class='Operator'>-&GT;</span><span class='Delimiter'>{</span><a href="../../test/perl/PostgresNode.pm.html#LN216"><span class='Ref_to_Func'>name</span></a><span class='Delimiter'>}; 
</span> 
    <span class='Control'>if</span> <span class='Parentheses'>(</span>$module_defines<span class='Operator'>-&GT;</span><span class='Delimiter'>{</span>$n<span class='Delimiter'>}</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>foreach</span> <span class='Keyword'>my </span>$d <span class='Parentheses'>(</span>$module_defines<span class='Operator'>-&GT;</span><span class='Delimiter'>{</span>$n<span class='Delimiter'>}</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            $proj<span class='Operator'>-&GT;</span><a href="MSBuildProject.pm.html#LN85"><span class='Ref_to_Func'>AddDefine</span></a><span class='Parentheses'>(</span>$d<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Keyword'>grep </span><span class='Delimiter'>{ </span><span class='Operator'>/^$n$/ </span><span class='Delimiter'>} </span>@<span class='Delimiter'>{</span>$module_uselibpq<span class='Delimiter'>}</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        $proj<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN140"><span class='Ref_to_Func'>AddIncludeDir</span></a><span class='Parentheses'>(</span><span class='String'>'src\interfaces\libpq'</span><span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        $proj<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN112"><span class='Ref_to_Func'>AddReference</span></a><span class='Parentheses'>(</span>$libpq<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Keyword'>grep </span><span class='Delimiter'>{ </span><span class='Operator'>/^$n$/ </span><span class='Delimiter'>} </span>@<span class='Delimiter'>{</span>$module_uselibpgport<span class='Delimiter'>}</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        $proj<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN112"><span class='Ref_to_Func'>AddReference</span></a><span class='Parentheses'>(</span>$libpgport<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span><span class='Keyword'>grep </span><span class='Delimiter'>{ </span><span class='Operator'>/^$n$/ </span><span class='Delimiter'>} </span>@<span class='Delimiter'>{</span>$module_uselibpgcommon<span class='Delimiter'>}</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        $proj<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN112"><span class='Ref_to_Func'>AddReference</span></a><span class='Parentheses'>(</span>$libpgcommon<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span>$module_extralibs<span class='Operator'>-&GT;</span><span class='Delimiter'>{</span>$n<span class='Delimiter'>}</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>foreach</span> <span class='Keyword'>my </span>$l <span class='Parentheses'>(</span>@<span class='Delimiter'>{ </span>$module_extralibs<span class='Operator'>-&GT;</span><span class='Delimiter'>{</span>$n<span class='Delimiter'>} }</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            $proj<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN124"><span class='Ref_to_Func'>AddLibrary</span></a><span class='Parentheses'>(</span>$l<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span>$module_extraincludes<span class='Operator'>-&GT;</span><span class='Delimiter'>{</span>$n<span class='Delimiter'>}</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>foreach</span> <span class='Keyword'>my </span>$i <span class='Parentheses'>(</span>@<span class='Delimiter'>{ </span>$module_extraincludes<span class='Operator'>-&GT;</span><span class='Delimiter'>{</span>$n<span class='Delimiter'>} }</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            $proj<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN140"><span class='Ref_to_Func'>AddIncludeDir</span></a><span class='Parentheses'>(</span>$i<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>} 
</span>    <span class='Control'>if</span> <span class='Parentheses'>(</span>$module_extrasource<span class='Operator'>-&GT;</span><span class='Delimiter'>{</span>$n<span class='Delimiter'>}</span><span class='Parentheses'>) 
</span>    <span class='Delimiter'>{ 
</span>        <span class='Control'>foreach</span> <span class='Keyword'>my </span>$i <span class='Parentheses'>(</span>@<span class='Delimiter'>{ </span>$module_extrasource<span class='Operator'>-&GT;</span><span class='Delimiter'>{</span>$n<span class='Delimiter'>} }</span><span class='Parentheses'>) 
</span>        <span class='Delimiter'>{ 
</span>            <span class='Keyword'>print </span><span class='String'>"Files $i\n"</span><span class='Delimiter'>; 
</span>            $proj<span class='Operator'>-&GT;</span><a href="Project.pm.html#LN40"><span class='Ref_to_Func'>AddFile</span></a><span class='Parentheses'>(</span>$i<span class='Parentheses'>)</span><span class='Delimiter'>; 
</span>        <span class='Delimiter'>} 
</span>    <span class='Delimiter'>} 
} 
</span> 
1<span class='Delimiter'>; 
</span></pre>
<table bgcolor='#c0c0c0' width='100%'><tr><td><a href='../../../Contents.html'>Contents</a></td></tr>
</table><hr><p class='blurb' align='center'><a href='http://www.sourceinsight.com'>HTML Created by Source Insight Version 4.00.0084 Built on 2017-02-26</a></p>
</body></html>